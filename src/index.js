const JSON5 = require("json5");
const pako = require("pako");
const wrtc = require("@koush/wrtc");
const { Crypto } = require("@peculiar/webcrypto");
const { performance } = require("perf_hooks");
const { HttpsProxyAgent } = require("https-proxy-agent");

const crypto = new Crypto();

var pT = Object.create;
var { getPrototypeOf: uT, defineProperty: zL, getOwnPropertyNames: lT } = Object;
var oT = Object.prototype.hasOwnProperty;
var oZ = (J, Q, Z) => {
    Z = J != null ? pT(uT(J)) : {};
    let $ = Q || !J || !J.__esModule ? zL(Z, "default", {
        value: J,
        enumerable: !0
    }) : Z;
    for (let q of lT(J))
        if (!oT.call($, q))
            zL($, q, {
                get: () => J[q],
                enumerable: !0
            });
    return $
}
    ;
var G5 = (J, Q) => () => (Q || J((Q = {
    exports: {}
}).exports, Q),
    Q.exports);
var WL = (J, Q) => {
    for (var Z in Q)
        zL(J, Z, {
            get: Q[Z],
            enumerable: !0,
            configurable: !0,
            set: ($) => Q[Z] = () => $
        })
}
    ;
var O = (J, Q) => () => (J && (Q = J(J = 0)),
    Q);
var p3 = G5((OL, IL) => {
    (function (J, Q) {
        typeof OL === "object" && typeof IL !== "undefined" ? IL.exports = Q() : typeof define === "function" && define.amd ? define(Q) : J.JSON5 = Q()
    }
    )(OL, function () {
        function J(Z0, G0) {
            return G0 = {
                exports: {}
            },
                Z0(G0, G0.exports),
                G0.exports
        }
        var Q = J(function (Z0) {
            var G0 = Z0.exports = typeof global != "undefined" && global.Math == Math ? global : typeof self != "undefined" && self.Math == Math ? self : Function("return this")();
            if (typeof __g == "number")
                __g = G0
        })
            , Z = J(function (Z0) {
                var G0 = Z0.exports = {
                    version: "2.6.5"
                };
                if (typeof __e == "number")
                    __e = G0
            })
            , $ = Z.version
            , q = function (Z0) {
                return typeof Z0 === "object" ? Z0 !== null : typeof Z0 === "function"
            }
            , K = function (Z0) {
                if (!q(Z0))
                    throw TypeError(Z0 + " is not an object!");
                return Z0
            }
            , V = function (Z0) {
                try {
                    return !!Z0()
                } catch (G0) {
                    return !0
                }
            }
            , z = !V(function () {
                return Object.defineProperty({}, "a", {
                    get: function () {
                        return 7
                    }
                }).a != 7
            })
            , W = Q.document
            , H = q(W) && q(W.createElement)
            , Y = function (Z0) {
                return H ? W.createElement(Z0) : {}
            }
            , U = !z && !V(function () {
                return Object.defineProperty(Y("div"), "a", {
                    get: function () {
                        return 7
                    }
                }).a != 7
            })
            , N = function (Z0, G0) {
                if (!q(Z0))
                    return Z0;
                var z8, Z8;
                if (G0 && typeof (z8 = Z0.toString) == "function" && !q(Z8 = z8.call(Z0)))
                    return Z8;
                if (typeof (z8 = Z0.valueOf) == "function" && !q(Z8 = z8.call(Z0)))
                    return Z8;
                if (!G0 && typeof (z8 = Z0.toString) == "function" && !q(Z8 = z8.call(Z0)))
                    return Z8;
                throw TypeError("Can't convert object to primitive value")
            }
            , j = Object.defineProperty
            , k = z ? Object.defineProperty : function Z0(G0, z8, Z8) {
                if (K(G0),
                    z8 = N(z8, !0),
                    K(Z8),
                    U)
                    try {
                        return j(G0, z8, Z8)
                    } catch (G8) { }
                if ("get" in Z8 || "set" in Z8)
                    throw TypeError("Accessors not supported!");
                if ("value" in Z8)
                    G0[z8] = Z8.value;
                return G0
            }
            , L = {
                f: k
            }
            , F = function (Z0, G0) {
                return {
                    enumerable: !(Z0 & 1),
                    configurable: !(Z0 & 2),
                    writable: !(Z0 & 4),
                    value: G0
                }
            }
            , P = z ? function (Z0, G0, z8) {
                return L.f(Z0, G0, F(1, z8))
            }
                : function (Z0, G0, z8) {
                    return Z0[G0] = z8,
                        Z0
                }
            , M = {}.hasOwnProperty
            , v = function (Z0, G0) {
                return M.call(Z0, G0)
            }
            , E = 0
            , n = Math.random()
            , u = function (Z0) {
                return "Symbol(".concat(Z0 === void 0 ? "" : Z0, ")_", (++E + n).toString(36))
            }
            , b = !1
            , i = J(function (Z0) {
                var G0 = "__core-js_shared__"
                    , z8 = Q[G0] || (Q[G0] = {});
                (Z0.exports = function (Z8, G8) {
                    return z8[Z8] || (z8[Z8] = G8 !== void 0 ? G8 : {})
                }
                )("versions", []).push({
                    version: Z.version,
                    mode: b ? "pure" : "global",
                    copyright: "© 2019 Denis Pushkarev (zloirock.ru)"
                })
            })
            , g = i("native-function-to-string", Function.toString)
            , l = J(function (Z0) {
                var G0 = u("src")
                    , z8 = "toString"
                    , Z8 = ("" + g).split(z8);
                Z.inspectSource = function (G8) {
                    return g.call(G8)
                }
                    ,
                    (Z0.exports = function (G8, t0, e8, m7) {
                        var L7 = typeof e8 == "function";
                        if (L7)
                            v(e8, "name") || P(e8, "name", t0);
                        if (G8[t0] === e8)
                            return;
                        if (L7)
                            v(e8, G0) || P(e8, G0, G8[t0] ? "" + G8[t0] : Z8.join(String(t0)));
                        if (G8 === Q)
                            G8[t0] = e8;
                        else if (!m7)
                            delete G8[t0],
                                P(G8, t0, e8);
                        else if (G8[t0])
                            G8[t0] = e8;
                        else
                            P(G8, t0, e8)
                    }
                    )(Function.prototype, z8, function G8() {
                        return typeof this == "function" && this[G0] || g.call(this)
                    })
            })
            , o = function (Z0) {
                if (typeof Z0 != "function")
                    throw TypeError(Z0 + " is not a function!");
                return Z0
            }
            , F0 = function (Z0, G0, z8) {
                if (o(Z0),
                    G0 === void 0)
                    return Z0;
                switch (z8) {
                    case 1:
                        return function (Z8) {
                            return Z0.call(G0, Z8)
                        }
                            ;
                    case 2:
                        return function (Z8, G8) {
                            return Z0.call(G0, Z8, G8)
                        }
                            ;
                    case 3:
                        return function (Z8, G8, t0) {
                            return Z0.call(G0, Z8, G8, t0)
                        }
                }
                return function () {
                    return Z0.apply(G0, arguments)
                }
            }
            , b0 = "prototype"
            , d0 = function (Z0, G0, z8) {
                var Z8 = Z0 & d0.F, G8 = Z0 & d0.G, t0 = Z0 & d0.S, e8 = Z0 & d0.P, m7 = Z0 & d0.B, L7 = G8 ? Q : t0 ? Q[G0] || (Q[G0] = {}) : (Q[G0] || {})[b0], fJ = G8 ? Z : Z[G0] || (Z[G0] = {}), B9 = fJ[b0] || (fJ[b0] = {}), f6, IJ, J7, Y5;
                if (G8)
                    z8 = G0;
                for (f6 in z8) {
                    if (IJ = !Z8 && L7 && L7[f6] !== void 0,
                        J7 = (IJ ? L7 : z8)[f6],
                        Y5 = m7 && IJ ? F0(J7, Q) : e8 && typeof J7 == "function" ? F0(Function.call, J7) : J7,
                        L7)
                        l(L7, f6, J7, Z0 & d0.U);
                    if (fJ[f6] != J7)
                        P(fJ, f6, Y5);
                    if (e8 && B9[f6] != J7)
                        B9[f6] = J7
                }
            };
        Q.core = Z,
            d0.F = 1,
            d0.G = 2,
            d0.S = 4,
            d0.P = 8,
            d0.B = 16,
            d0.W = 32,
            d0.U = 64,
            d0.R = 128;
        var H8 = d0
            , E0 = Math.ceil
            , v0 = Math.floor
            , G6 = function (Z0) {
                return isNaN(Z0 = +Z0) ? 0 : (Z0 > 0 ? v0 : E0)(Z0)
            }
            , I8 = function (Z0) {
                if (Z0 == null)
                    throw TypeError("Can't call method on  " + Z0);
                return Z0
            }
            , x0 = function (Z0) {
                return function (G0, z8) {
                    var Z8 = String(I8(G0)), G8 = G6(z8), t0 = Z8.length, e8, m7;
                    if (G8 < 0 || G8 >= t0)
                        return Z0 ? "" : void 0;
                    return e8 = Z8.charCodeAt(G8),
                        e8 < 55296 || e8 > 56319 || G8 + 1 === t0 || (m7 = Z8.charCodeAt(G8 + 1)) < 56320 || m7 > 57343 ? Z0 ? Z8.charAt(G8) : e8 : Z0 ? Z8.slice(G8, G8 + 2) : (e8 - 55296 << 10) + (m7 - 56320) + 65536
                }
            }
            , U8 = x0(!1);
        H8(H8.P, "String", {
            codePointAt: function Z0(G0) {
                return U8(this, G0)
            }
        });
        var t8 = Z.String.codePointAt
            , o8 = Math.max
            , c8 = Math.min
            , _8 = function (Z0, G0) {
                return Z0 = G6(Z0),
                    Z0 < 0 ? o8(Z0 + G0, 0) : c8(Z0, G0)
            }
            , R6 = String.fromCharCode
            , n8 = String.fromCodePoint;
        H8(H8.S + H8.F * (!!n8 && n8.length != 1), "String", {
            fromCodePoint: function Z0(G0) {
                var z8 = arguments, Z8 = [], G8 = arguments.length, t0 = 0, e8;
                while (G8 > t0) {
                    if (e8 = +z8[t0++],
                        _8(e8, 1114111) !== e8)
                        throw RangeError(e8 + " is not a valid code point");
                    Z8.push(e8 < 65536 ? R6(e8) : R6(((e8 -= 65536) >> 10) + 55296, e8 % 1024 + 56320))
                }
                return Z8.join("")
            }
        });
        var q6 = Z.String.fromCodePoint, K6 = /[\u1680\u2000-\u200A\u202F\u205F\u3000]/, k6 = /[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/, y6 = /[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/, S6 = {
            Space_Separator: K6,
            ID_Start: k6,
            ID_Continue: y6
        }, J8 = {
            isSpaceSeparator: function Z0(G0) {
                return typeof G0 === "string" && S6.Space_Separator.test(G0)
            },
            isIdStartChar: function Z0(G0) {
                return typeof G0 === "string" && (G0 >= "a" && G0 <= "z" || G0 >= "A" && G0 <= "Z" || G0 === "$" || G0 === "_" || S6.ID_Start.test(G0))
            },
            isIdContinueChar: function Z0(G0) {
                return typeof G0 === "string" && (G0 >= "a" && G0 <= "z" || G0 >= "A" && G0 <= "Z" || G0 >= "0" && G0 <= "9" || G0 === "$" || G0 === "_" || G0 === "‌" || G0 === "‍" || S6.ID_Continue.test(G0))
            },
            isDigit: function Z0(G0) {
                return typeof G0 === "string" && /[0-9]/.test(G0)
            },
            isHexDigit: function Z0(G0) {
                return typeof G0 === "string" && /[0-9A-Fa-f]/.test(G0)
            }
        }, L0, d8, d6, K8, h8, O0, h0, R8, X6, k0 = function Z0(G0, z8) {
            L0 = String(G0),
                d8 = "start",
                d6 = [],
                K8 = 0,
                h8 = 1,
                O0 = 0,
                h0 = void 0,
                R8 = void 0,
                X6 = void 0;
            do
                h0 = V0(),
                    N8[d8]();
            while (h0.type !== "eof");
            if (typeof z8 === "function")
                return U6({
                    "": X6
                }, "", z8);
            return X6
        };
        function U6(Z0, G0, z8) {
            var Z8 = Z0[G0];
            if (Z8 != null && typeof Z8 === "object")
                if (Array.isArray(Z8))
                    for (var G8 = 0; G8 < Z8.length; G8++) {
                        var t0 = String(G8)
                            , e8 = U6(Z8, t0, z8);
                        if (e8 === void 0)
                            delete Z8[t0];
                        else
                            Object.defineProperty(Z8, t0, {
                                value: e8,
                                writable: !0,
                                enumerable: !0,
                                configurable: !0
                            })
                    }
                else
                    for (var m7 in Z8) {
                        var L7 = U6(Z8, m7, z8);
                        if (L7 === void 0)
                            delete Z8[m7];
                        else
                            Object.defineProperty(Z8, m7, {
                                value: L7,
                                writable: !0,
                                enumerable: !0,
                                configurable: !0
                            })
                    }
            return z8.call(Z0, G0, Z8)
        }
        var V8, o0, C0, K0, J0;
        function V0() {
            V8 = "default",
                o0 = "",
                C0 = !1,
                K0 = 1;
            for (; ;) {
                J0 = t();
                var Z0 = X0[V8]();
                if (Z0)
                    return Z0
            }
        }
        function t() {
            if (L0[K8])
                return String.fromCodePoint(L0.codePointAt(K8))
        }
        function c() {
            var Z0 = t();
            if (Z0 === `
`)
                h8++,
                    O0 = 0;
            else if (Z0)
                O0 += Z0.length;
            else
                O0++;
            if (Z0)
                K8 += Z0.length;
            return Z0
        }
        var X0 = {
            default: function Z0() {
                switch (J0) {
                    case "\t":
                    case "\v":
                    case "\f":
                    case " ":
                    case " ":
                    case "\uFEFF":
                    case `
`:
                    case "\r":
                    case "\u2028":
                    case "\u2029":
                        c();
                        return;
                    case "/":
                        c(),
                            V8 = "comment";
                        return;
                    case void 0:
                        return c(),
                            A0("eof")
                }
                if (J8.isSpaceSeparator(J0)) {
                    c();
                    return
                }
                return X0[d8]()
            },
            comment: function Z0() {
                switch (J0) {
                    case "*":
                        c(),
                            V8 = "multiLineComment";
                        return;
                    case "/":
                        c(),
                            V8 = "singleLineComment";
                        return
                }
                throw H0(c())
            },
            multiLineComment: function Z0() {
                switch (J0) {
                    case "*":
                        c(),
                            V8 = "multiLineCommentAsterisk";
                        return;
                    case void 0:
                        throw H0(c())
                }
                c()
            },
            multiLineCommentAsterisk: function Z0() {
                switch (J0) {
                    case "*":
                        c();
                        return;
                    case "/":
                        c(),
                            V8 = "default";
                        return;
                    case void 0:
                        throw H0(c())
                }
                c(),
                    V8 = "multiLineComment"
            },
            singleLineComment: function Z0() {
                switch (J0) {
                    case `
`:
                    case "\r":
                    case "\u2028":
                    case "\u2029":
                        c(),
                            V8 = "default";
                        return;
                    case void 0:
                        return c(),
                            A0("eof")
                }
                c()
            },
            value: function Z0() {
                switch (J0) {
                    case "{":
                    case "[":
                        return A0("punctuator", c());
                    case "n":
                        return c(),
                            B0("ull"),
                            A0("null", null);
                    case "t":
                        return c(),
                            B0("rue"),
                            A0("boolean", !0);
                    case "f":
                        return c(),
                            B0("alse"),
                            A0("boolean", !1);
                    case "-":
                    case "+":
                        if (c() === "-")
                            K0 = -1;
                        V8 = "sign";
                        return;
                    case ".":
                        o0 = c(),
                            V8 = "decimalPointLeading";
                        return;
                    case "0":
                        o0 = c(),
                            V8 = "zero";
                        return;
                    case "1":
                    case "2":
                    case "3":
                    case "4":
                    case "5":
                    case "6":
                    case "7":
                    case "8":
                    case "9":
                        o0 = c(),
                            V8 = "decimalInteger";
                        return;
                    case "I":
                        return c(),
                            B0("nfinity"),
                            A0("numeric", 1 / 0);
                    case "N":
                        return c(),
                            B0("aN"),
                            A0("numeric", NaN);
                    case '"':
                    case "'":
                        C0 = c() === '"',
                            o0 = "",
                            V8 = "string";
                        return
                }
                throw H0(c())
            },
            identifierNameStartEscape: function Z0() {
                if (J0 !== "u")
                    throw H0(c());
                c();
                var G0 = $8();
                switch (G0) {
                    case "$":
                    case "_":
                        break;
                    default:
                        if (!J8.isIdStartChar(G0))
                            throw w8();
                        break
                }
                o0 += G0,
                    V8 = "identifierName"
            },
            identifierName: function Z0() {
                switch (J0) {
                    case "$":
                    case "_":
                    case "‌":
                    case "‍":
                        o0 += c();
                        return;
                    case "\\":
                        c(),
                            V8 = "identifierNameEscape";
                        return
                }
                if (J8.isIdContinueChar(J0)) {
                    o0 += c();
                    return
                }
                return A0("identifier", o0)
            },
            identifierNameEscape: function Z0() {
                if (J0 !== "u")
                    throw H0(c());
                c();
                var G0 = $8();
                switch (G0) {
                    case "$":
                    case "_":
                    case "‌":
                    case "‍":
                        break;
                    default:
                        if (!J8.isIdContinueChar(G0))
                            throw w8();
                        break
                }
                o0 += G0,
                    V8 = "identifierName"
            },
            sign: function Z0() {
                switch (J0) {
                    case ".":
                        o0 = c(),
                            V8 = "decimalPointLeading";
                        return;
                    case "0":
                        o0 = c(),
                            V8 = "zero";
                        return;
                    case "1":
                    case "2":
                    case "3":
                    case "4":
                    case "5":
                    case "6":
                    case "7":
                    case "8":
                    case "9":
                        o0 = c(),
                            V8 = "decimalInteger";
                        return;
                    case "I":
                        return c(),
                            B0("nfinity"),
                            A0("numeric", K0 * (1 / 0));
                    case "N":
                        return c(),
                            B0("aN"),
                            A0("numeric", NaN)
                }
                throw H0(c())
            },
            zero: function Z0() {
                switch (J0) {
                    case ".":
                        o0 += c(),
                            V8 = "decimalPoint";
                        return;
                    case "e":
                    case "E":
                        o0 += c(),
                            V8 = "decimalExponent";
                        return;
                    case "x":
                    case "X":
                        o0 += c(),
                            V8 = "hexadecimal";
                        return
                }
                return A0("numeric", K0 * 0)
            },
            decimalInteger: function Z0() {
                switch (J0) {
                    case ".":
                        o0 += c(),
                            V8 = "decimalPoint";
                        return;
                    case "e":
                    case "E":
                        o0 += c(),
                            V8 = "decimalExponent";
                        return
                }
                if (J8.isDigit(J0)) {
                    o0 += c();
                    return
                }
                return A0("numeric", K0 * Number(o0))
            },
            decimalPointLeading: function Z0() {
                if (J8.isDigit(J0)) {
                    o0 += c(),
                        V8 = "decimalFraction";
                    return
                }
                throw H0(c())
            },
            decimalPoint: function Z0() {
                switch (J0) {
                    case "e":
                    case "E":
                        o0 += c(),
                            V8 = "decimalExponent";
                        return
                }
                if (J8.isDigit(J0)) {
                    o0 += c(),
                        V8 = "decimalFraction";
                    return
                }
                return A0("numeric", K0 * Number(o0))
            },
            decimalFraction: function Z0() {
                switch (J0) {
                    case "e":
                    case "E":
                        o0 += c(),
                            V8 = "decimalExponent";
                        return
                }
                if (J8.isDigit(J0)) {
                    o0 += c();
                    return
                }
                return A0("numeric", K0 * Number(o0))
            },
            decimalExponent: function Z0() {
                switch (J0) {
                    case "+":
                    case "-":
                        o0 += c(),
                            V8 = "decimalExponentSign";
                        return
                }
                if (J8.isDigit(J0)) {
                    o0 += c(),
                        V8 = "decimalExponentInteger";
                    return
                }
                throw H0(c())
            },
            decimalExponentSign: function Z0() {
                if (J8.isDigit(J0)) {
                    o0 += c(),
                        V8 = "decimalExponentInteger";
                    return
                }
                throw H0(c())
            },
            decimalExponentInteger: function Z0() {
                if (J8.isDigit(J0)) {
                    o0 += c();
                    return
                }
                return A0("numeric", K0 * Number(o0))
            },
            hexadecimal: function Z0() {
                if (J8.isHexDigit(J0)) {
                    o0 += c(),
                        V8 = "hexadecimalInteger";
                    return
                }
                throw H0(c())
            },
            hexadecimalInteger: function Z0() {
                if (J8.isHexDigit(J0)) {
                    o0 += c();
                    return
                }
                return A0("numeric", K0 * Number(o0))
            },
            string: function Z0() {
                switch (J0) {
                    case "\\":
                        c(),
                            o0 += N0();
                        return;
                    case '"':
                        if (C0)
                            return c(),
                                A0("string", o0);
                        o0 += c();
                        return;
                    case "'":
                        if (!C0)
                            return c(),
                                A0("string", o0);
                        o0 += c();
                        return;
                    case `
`:
                    case "\r":
                        throw H0(c());
                    case "\u2028":
                    case "\u2029":
                        y8(J0);
                        break;
                    case void 0:
                        throw H0(c())
                }
                o0 += c()
            },
            start: function Z0() {
                switch (J0) {
                    case "{":
                    case "[":
                        return A0("punctuator", c())
                }
                V8 = "value"
            },
            beforePropertyName: function Z0() {
                switch (J0) {
                    case "$":
                    case "_":
                        o0 = c(),
                            V8 = "identifierName";
                        return;
                    case "\\":
                        c(),
                            V8 = "identifierNameStartEscape";
                        return;
                    case "}":
                        return A0("punctuator", c());
                    case '"':
                    case "'":
                        C0 = c() === '"',
                            V8 = "string";
                        return
                }
                if (J8.isIdStartChar(J0)) {
                    o0 += c(),
                        V8 = "identifierName";
                    return
                }
                throw H0(c())
            },
            afterPropertyName: function Z0() {
                if (J0 === ":")
                    return A0("punctuator", c());
                throw H0(c())
            },
            beforePropertyValue: function Z0() {
                V8 = "value"
            },
            afterPropertyValue: function Z0() {
                switch (J0) {
                    case ",":
                    case "}":
                        return A0("punctuator", c())
                }
                throw H0(c())
            },
            beforeArrayValue: function Z0() {
                if (J0 === "]")
                    return A0("punctuator", c());
                V8 = "value"
            },
            afterArrayValue: function Z0() {
                switch (J0) {
                    case ",":
                    case "]":
                        return A0("punctuator", c())
                }
                throw H0(c())
            },
            end: function Z0() {
                throw H0(c())
            }
        };
        function A0(Z0, G0) {
            return {
                type: Z0,
                value: G0,
                line: h8,
                column: O0
            }
        }
        function B0(Z0) {
            for (var G0 = 0, z8 = Z0; G0 < z8.length; G0 += 1) {
                var Z8 = z8[G0]
                    , G8 = t();
                if (G8 !== Z8)
                    throw H0(c());
                c()
            }
        }
        function N0() {
            var Z0 = t();
            switch (Z0) {
                case "b":
                    return c(),
                        "\b";
                case "f":
                    return c(),
                        "\f";
                case "n":
                    return c(),
                        `
`;
                case "r":
                    return c(),
                        "\r";
                case "t":
                    return c(),
                        "\t";
                case "v":
                    return c(),
                        "\v";
                case "0":
                    if (c(),
                        J8.isDigit(t()))
                        throw H0(c());
                    return "\x00";
                case "x":
                    return c(),
                        R0();
                case "u":
                    return c(),
                        $8();
                case `
`:
                case "\u2028":
                case "\u2029":
                    return c(),
                        "";
                case "\r":
                    if (c(),
                        t() === `
`)
                        c();
                    return "";
                case "1":
                case "2":
                case "3":
                case "4":
                case "5":
                case "6":
                case "7":
                case "8":
                case "9":
                    throw H0(c());
                case void 0:
                    throw H0(c())
            }
            return c()
        }
        function R0() {
            var Z0 = ""
                , G0 = t();
            if (!J8.isHexDigit(G0))
                throw H0(c());
            if (Z0 += c(),
                G0 = t(),
                !J8.isHexDigit(G0))
                throw H0(c());
            return Z0 += c(),
                String.fromCodePoint(parseInt(Z0, 16))
        }
        function $8() {
            var Z0 = ""
                , G0 = 4;
            while (G0-- > 0) {
                var z8 = t();
                if (!J8.isHexDigit(z8))
                    throw H0(c());
                Z0 += c()
            }
            return String.fromCodePoint(parseInt(Z0, 16))
        }
        var N8 = {
            start: function Z0() {
                if (h0.type === "eof")
                    throw p0();
                a()
            },
            beforePropertyName: function Z0() {
                switch (h0.type) {
                    case "identifier":
                    case "string":
                        R8 = h0.value,
                            d8 = "afterPropertyName";
                        return;
                    case "punctuator":
                        q0();
                        return;
                    case "eof":
                        throw p0()
                }
            },
            afterPropertyName: function Z0() {
                if (h0.type === "eof")
                    throw p0();
                d8 = "beforePropertyValue"
            },
            beforePropertyValue: function Z0() {
                if (h0.type === "eof")
                    throw p0();
                a()
            },
            beforeArrayValue: function Z0() {
                if (h0.type === "eof")
                    throw p0();
                if (h0.type === "punctuator" && h0.value === "]") {
                    q0();
                    return
                }
                a()
            },
            afterPropertyValue: function Z0() {
                if (h0.type === "eof")
                    throw p0();
                switch (h0.value) {
                    case ",":
                        d8 = "beforePropertyName";
                        return;
                    case "}":
                        q0()
                }
            },
            afterArrayValue: function Z0() {
                if (h0.type === "eof")
                    throw p0();
                switch (h0.value) {
                    case ",":
                        d8 = "beforeArrayValue";
                        return;
                    case "]":
                        q0()
                }
            },
            end: function Z0() { }
        };
        function a() {
            var Z0;
            switch (h0.type) {
                case "punctuator":
                    switch (h0.value) {
                        case "{":
                            Z0 = {};
                            break;
                        case "[":
                            Z0 = [];
                            break
                    }
                    break;
                case "null":
                case "boolean":
                case "numeric":
                case "string":
                    Z0 = h0.value;
                    break
            }
            if (X6 === void 0)
                X6 = Z0;
            else {
                var G0 = d6[d6.length - 1];
                if (Array.isArray(G0))
                    G0.push(Z0);
                else
                    Object.defineProperty(G0, R8, {
                        value: Z0,
                        writable: !0,
                        enumerable: !0,
                        configurable: !0
                    })
            }
            if (Z0 !== null && typeof Z0 === "object")
                if (d6.push(Z0),
                    Array.isArray(Z0))
                    d8 = "beforeArrayValue";
                else
                    d8 = "beforePropertyName";
            else {
                var z8 = d6[d6.length - 1];
                if (z8 == null)
                    d8 = "end";
                else if (Array.isArray(z8))
                    d8 = "afterArrayValue";
                else
                    d8 = "afterPropertyValue"
            }
        }
        function q0() {
            d6.pop();
            var Z0 = d6[d6.length - 1];
            if (Z0 == null)
                d8 = "end";
            else if (Array.isArray(Z0))
                d8 = "afterArrayValue";
            else
                d8 = "afterPropertyValue"
        }
        function H0(Z0) {
            if (Z0 === void 0)
                return k8("JSON5: invalid end of input at " + h8 + ":" + O0);
            return k8("JSON5: invalid character '" + j8(Z0) + "' at " + h8 + ":" + O0)
        }
        function p0() {
            return k8("JSON5: invalid end of input at " + h8 + ":" + O0)
        }
        function w8() {
            return O0 -= 5,
                k8("JSON5: invalid identifier character at " + h8 + ":" + O0)
        }
        function y8(Z0) { }
        function j8(Z0) {
            var G0 = {
                "'": "\\'",
                '"': "\\\"",
                "\\": "\\\\",
                "\b": "\\b",
                "\f": "\\f",
                "\n": "\\n",
                "\r": "\\r",
                "\t": "\\t",
                "\v": "\\v",
                "\x00": "\\0",
                "\u2028": "\\u2028",
                "\u2029": "\\u2029"
            };
            if (G0[Z0])
                return G0[Z0];
            if (Z0 < " ") {
                var z8 = Z0.charCodeAt(0).toString(16);
                return "\\x" + ("00" + z8).substring(z8.length)
            }
            return Z0
        }
        function k8(Z0) {
            var G0 = new SyntaxError(Z0);
            return G0.lineNumber = h8,
                G0.columnNumber = O0,
                G0
        }
        var W8 = function Z0(G0, z8, Z8) {
            var G8 = [], t0 = "", e8, m7, L7 = "", fJ;
            if (z8 != null && typeof z8 === "object" && !Array.isArray(z8))
                Z8 = z8.space,
                    fJ = z8.quote,
                    z8 = z8.replacer;
            if (typeof z8 === "function")
                m7 = z8;
            else if (Array.isArray(z8)) {
                e8 = [];
                for (var B9 = 0, f6 = z8; B9 < f6.length; B9 += 1) {
                    var IJ = f6[B9]
                        , J7 = void 0;
                    if (typeof IJ === "string")
                        J7 = IJ;
                    else if (typeof IJ === "number" || IJ instanceof String || IJ instanceof Number)
                        J7 = String(IJ);
                    if (J7 !== void 0 && e8.indexOf(J7) < 0)
                        e8.push(J7)
                }
            }
            if (Z8 instanceof Number)
                Z8 = Number(Z8);
            else if (Z8 instanceof String)
                Z8 = String(Z8);
            if (typeof Z8 === "number") {
                if (Z8 > 0)
                    Z8 = Math.min(10, Math.floor(Z8)),
                        L7 = "          ".substr(0, Z8)
            } else if (typeof Z8 === "string")
                L7 = Z8.substr(0, 10);
            return Y5("", {
                "": G0
            });
            function Y5(T6, R7) {
                var x8 = R7[T6];
                if (x8 != null) {
                    if (typeof x8.toJSON5 === "function")
                        x8 = x8.toJSON5(T6);
                    else if (typeof x8.toJSON === "function")
                        x8 = x8.toJSON(T6)
                }
                if (m7)
                    x8 = m7.call(R7, T6, x8);
                if (x8 instanceof Number)
                    x8 = Number(x8);
                else if (x8 instanceof String)
                    x8 = String(x8);
                else if (x8 instanceof Boolean)
                    x8 = x8.valueOf();
                switch (x8) {
                    case null:
                        return "null";
                    case !0:
                        return "true";
                    case !1:
                        return "false"
                }
                if (typeof x8 === "string")
                    return hJ(x8, !1);
                if (typeof x8 === "number")
                    return String(x8);
                if (typeof x8 === "object")
                    return Array.isArray(x8) ? f4(x8) : N1(x8);
                return
            }
            function hJ(T6) {
                var R7 = {
                    "'": 0.1,
                    '"': 0.2
                }
                    , x8 = {
                        "'": "\\'",
                        '"': "\\\"",
                        "\\": "\\\\",
                        "\b": "\\b",
                        "\f": "\\f",
                        "\n": "\\n",
                        "\r": "\\r",
                        "\t": "\\t",
                        "\v": "\\v",
                        "\x00": "\\0",
                        "\u2028": "\\u2028",
                        "\u2029": "\\u2029"
                    }
                    , b7 = "";
                for (var e7 = 0; e7 < T6.length; e7++) {
                    var c7 = T6[e7];
                    switch (c7) {
                        case "'":
                        case '"':
                            R7[c7]++,
                                b7 += c7;
                            continue;
                        case "\x00":
                            if (J8.isDigit(T6[e7 + 1])) {
                                b7 += "\\x00";
                                continue
                            }
                    }
                    if (x8[c7]) {
                        b7 += x8[c7];
                        continue
                    }
                    if (c7 < " ") {
                        var u5 = c7.charCodeAt(0).toString(16);
                        b7 += "\\x" + ("00" + u5).substring(u5.length);
                        continue
                    }
                    b7 += c7
                }
                var X5 = fJ || Object.keys(R7).reduce(function (tJ, l5) {
                    return R7[tJ] < R7[l5] ? tJ : l5
                });
                return b7 = b7.replace(new RegExp(X5, "g"), x8[X5]),
                    X5 + b7 + X5
            }
            function N1(T6) {
                if (G8.indexOf(T6) >= 0)
                    throw TypeError("Converting circular structure to JSON5");
                G8.push(T6);
                var R7 = t0;
                t0 = t0 + L7;
                var x8 = e8 || Object.keys(T6)
                    , b7 = [];
                for (var e7 = 0, c7 = x8; e7 < c7.length; e7 += 1) {
                    var u5 = c7[e7]
                        , X5 = Y5(u5, T6);
                    if (X5 !== void 0) {
                        var tJ = y4(u5) + ":";
                        if (L7 !== "")
                            tJ += " ";
                        tJ += X5,
                            b7.push(tJ)
                    }
                }
                var l5;
                if (b7.length === 0)
                    l5 = "{}";
                else {
                    var r9;
                    if (L7 === "")
                        r9 = b7.join(","),
                            l5 = "{" + r9 + "}";
                    else {
                        var h4 = `,
` + t0;
                        r9 = b7.join(h4),
                            l5 = `{
` + t0 + r9 + `,
` + R7 + "}"
                    }
                }
                return G8.pop(),
                    t0 = R7,
                    l5
            }
            function y4(T6) {
                if (T6.length === 0)
                    return hJ(T6, !0);
                var R7 = String.fromCodePoint(T6.codePointAt(0));
                if (!J8.isIdStartChar(R7))
                    return hJ(T6, !0);
                for (var x8 = R7.length; x8 < T6.length; x8++)
                    if (!J8.isIdContinueChar(String.fromCodePoint(T6.codePointAt(x8))))
                        return hJ(T6, !0);
                return T6
            }
            function f4(T6) {
                if (G8.indexOf(T6) >= 0)
                    throw TypeError("Converting circular structure to JSON5");
                G8.push(T6);
                var R7 = t0;
                t0 = t0 + L7;
                var x8 = [];
                for (var b7 = 0; b7 < T6.length; b7++) {
                    var e7 = Y5(String(b7), T6);
                    x8.push(e7 !== void 0 ? e7 : "null")
                }
                var c7;
                if (x8.length === 0)
                    c7 = "[]";
                else if (L7 === "") {
                    var u5 = x8.join(",");
                    c7 = "[" + u5 + "]"
                } else {
                    var X5 = `,
` + t0
                        , tJ = x8.join(X5);
                    c7 = `[
` + t0 + tJ + `,
` + R7 + "]"
                }
                return G8.pop(),
                    t0 = R7,
                    c7
            }
        }
            , P6 = {
                parse: k0,
                stringify: W8
            }
            , g7 = P6
            , j9 = g7;
        return j9
    })
}
);
function YE(J) {
    return {
        UR: (Q, Z, $, q) => J.onCollisionDiscVsDisc?.(Q, Z.n, $, q.n),
        MR: (Q, Z, $) => J.onCollisionDiscVsPlane?.(Q, Z.n, $),
        nR: (Q, Z, $) => J.onCollisionDiscVsSegment?.(Q, Z.n, $),
        NR: (Q, Z, $, q) => J._9?.(Q, Z.n, $, q),
        dO: (Q, Z, $) => J.g9?.(Q, Z, $)
    }
}
function XE(J) {
    return {
        UR: (Q, Z, $, q) => J._onCollisionDiscVsDisc?.(Q, Z.n, $, q.n),
        MR: (Q, Z, $) => J._onCollisionDiscVsPlane?.(Q, Z.n, $),
        nR: (Q, Z, $) => J._onCollisionDiscVsSegment?.(Q, Z.n, $),
        NR: (Q, Z, $, q) => J._onCollisionDiscVsVertex?.(Q, Z.n, $, q),
        dO: (Q, Z, $) => J._onModifyJoint?.(Q, Z, $)
    }
}
function UE() {
    return {
        UR: null,
        MR: null,
        nR: null,
        NR: null,
        dO: null
    }
}
function rL(J, Q, Z = null) {
    if (J <= 0)
        return Q.O;
    let $ = typeof Q.jR === "number" ? Q.jR : S1.maxExtrapolationFrames
        , q = J;
    if (q > $)
        q = $;
    let K = Q.Tx = Q.O.dY(++Q.Cx), V;
    if (Z != null)
        Q.$x.sh(Q.dj, Z),
            V = Q.$x.uy;
    else
        V = Q.dj.uy;
    let z = !!S1.allowOnlyPredictableEvents
        , W = 0
        , H = V.length
        , Y = q | 0
        , U = Q.f
        , N = U + Y;
    for (let j = U; j <= N; j++) {
        for (; W < H;) {
            let k = V[W];
            if (k.Zy > j)
                break;
            if (!z || k.Xj?.zy)
                k.H(K);
            W++
        }
        if (j !== N)
            K.Qy(1);
        else {
            let k = q - Y;
            if (S1.applyPartialFrameRemainder && k > 0)
                K.Qy(k)
        }
    }
    if (S1.clearTempQueueAfterRun)
        Q.$x.uy.length = 0;
    return K
}
var S1;
var NE = O(() => {
    S1 = {
        baseInputDelayFrames: 0,
        maxExtrapolationFrames: 30,
        applyPartialFrameRemainder: !0,
        clearTempQueueAfterRun: !0,
        allowOnlyPredictableEvents: !0
    }
}
);
var wE = G5((xY, gY) => {
    NE();
    var hY = (() => {
        var J = {}
            , Q = (V, z) => () => (z || V((z = {
                bL: {}
            }).bL, z),
                z.bL)
            , Z = Q((V, z) => {
                var W, H, Y, U, N, j, k, L, F, P, M = (H = (W = (v, E) => () => (E || v((E = {
                    bL: {}
                }).bL, E),
                    E.bL))((v, E) => {
                        function n(u, b) {
                            this.x = u,
                                this.y = b
                        }
                        n.prototype = {
                            Yz: function () {
                                this.x = -this.x,
                                    this.y = -this.y
                            }
                        },
                            E.bL = n
                    }
                    ),
                    Y = W((v, E) => {
                        var n = H();
                        E.bL = function (u) {
                            var { i: b = 32, z: i = 63, r: g = 1, iy: l = 0, hy: o = 0 } = u || {};
                            this.i = b,
                                this.z = i,
                                this.r = g,
                                this.h = new n(l, o)
                        }
                    }
                    ),
                    U = W((v, E) => {
                        function n(b) {
                            var { i = 32, z: g = 63, r: l = 1, ny: o = 0, v: F0 = null, s: b0 = null } = b || {};
                            this._p = this.gp = this.qy = null,
                                this.QR = 0,
                                this.fO = null,
                                this.v = F0,
                                this.s = b0,
                                this.ny = o,
                                this.r = l,
                                this.z = g,
                                this.i = i,
                                this.wy = 1 / 0
                        }
                        var u = H();
                        n.prototype = {
                            LO: function (b) {
                                if (0 > (b *= 0.017453292519943295)) {
                                    b = -b;
                                    var i = this.v;
                                    this.v = this.s,
                                        this.s = i,
                                        this.ny = -this.ny
                                }
                                0.17435839227423353 < b && 5.934119456780721 > b && (this.wy = 1 / Math.tan(b / 2))
                            },
                            jz: function () {
                                return isFinite(this.wy) ? 114.59155902616465 * Math.atan(1 / this.wy) : 0
                            },
                            UY: function () {
                                var b, i, g, l, { wy: o, s: { h: F0 }, v: { h: b0 } } = this;
                                isFinite(o) ? (g = 0.5 * (F0.x - b0.x),
                                    l = 0.5 * (F0.y - b0.y),
                                    b = b0.x + g - l * o,
                                    i = b0.y + l + g * o,
                                    g = b0.x - b,
                                    l = b0.y - i,
                                    this.QR = Math.sqrt(g * g + l * l),
                                    this._p = new u(i - b0.y, b0.x - b),
                                    this.gp = new u(F0.y - i, b - F0.x),
                                    0 >= o && (this._p.Yz(),
                                        this.gp.Yz()),
                                    this.fO = new u(b, i)) : (g = b0.x - F0.x,
                                        l = b0.y - F0.y,
                                        i = Math.sqrt(l * l + g * g),
                                        this.qy = new u(-l / i, g / i))
                            }
                        },
                            E.bL = n
                    }
                    ),
                    N = W((v, E) => {
                        var n = H();
                        E.bL = function (u) {
                            var { i: b = 32, z: i = 63, r: g = 1, xy: l = 0, zY: o = 0, lY: F0 = 0 } = u || {};
                            this.i = b,
                                this.z = i,
                                this.r = g,
                                this.xy = l,
                                this.qy = new n(o, F0)
                        }
                    }
                    ),
                    j = W((v, E) => {
                        function n(b) {
                            var { Rh: i = 0, xh: g = 0, zh: l = 0, lh: o = 0 } = b || {};
                            this.rY = new u(l, o),
                                this.iY = new u(i, g)
                        }
                        var u = H();
                        n.prototype = {
                            FR: function ({ x: b, y: i }, { x: g, y: l }) {
                                var { iY: { x: o, y: F0 }, rY: { x: b0, y: d0 } } = this
                                    , H8 = g - b
                                    , E0 = l - i;
                                return 0 < E0 * (o - b) - H8 * (F0 - i) != 0 < E0 * (b0 - b) - H8 * (d0 - i) && 0 < (E0 = d0 - F0) * (b - o) - (H8 = b0 - o) * (i - F0) != 0 < E0 * (g - o) - H8 * (l - F0)
                            }
                        },
                            E.bL = n
                    }
                    ),
                    k = W((v, E) => {
                        var n = H();
                        E.bL = function (u) {
                            var { i: b = 63, z: i = 63, N: g = 0.99, F: l = 1, r: o = 0.5, I: F0 = 10, y9: b0 = 0, Y9: d0 = 0, j9: H8 = 0, X9: E0 = 0, iy: v0 = 0, hy: G6 = 0 } = u || {};
                            this.i = b,
                                this.z = i,
                                this.N = g,
                                this.F = l,
                                this.r = o,
                                this.I = F0,
                                this.T = new n(b0, d0),
                                this.P = new n(H8, E0),
                                this.h = new n(v0, G6)
                        }
                    }
                    ),
                    L = W((v, E) => {
                        E.bL = function (n) {
                            var { $Y: u = 1 / 0, Cy: b = 100, dy: i = 100, ay: g = 0, vy: l = 0 } = n || {};
                            this.$Y = u,
                                this.Cy = b,
                                this.dy = i,
                                this.ay = g,
                                this.vy = l
                        }
                    }
                    ),
                    F = W((v, E) => {
                        function n(b) {
                            u.apply(this, [b])
                        }
                        var u = k();
                        n.prototype = {
                            Xz: function (b, i, g) {
                                var { P: l, F: o } = this;
                                l.x += b * i * o,
                                    l.y += b * g * o
                            },
                            rh: function (b, i) {
                                var { P: g } = this;
                                g.x += b,
                                    g.y += i
                            },
                            ih: function () {
                                var { x: b, y: i } = this.P;
                                return 0 < b * b + i * i
                            }
                        },
                            E.bL = n
                    }
                    ),
                    P = W((v, E) => {
                        function n() {
                            this.Z = [],
                                this.k = [],
                                this.M = [],
                                this.t = [],
                                this._y = []
                        }
                        n.prototype = {
                            Fy: function (u, b) {
                                var i, g, l, o, F0, b0, { Z: d0, M: H8, t: E0, k: v0, _y: G6 } = this;
                                d0.forEach(({ h: x0, P: U8, T: t8, N: o8 }) => {
                                    var { x: c8, y: _8 } = U8;
                                    x0.x += u * c8,
                                        x0.y += u * _8,
                                        U8.x = o8 * (c8 + t8.x),
                                        U8.y = o8 * (_8 + t8.y)
                                }
                                ),
                                    d0.forEach((x0, U8) => {
                                        var { r: t8, I: o8, z: c8, i: _8, F: R6, h: n8, P: q6 } = x0;
                                        for (i = U8 + 1; i < d0.length; i++)
                                            if ((l = d0[i]).z & _8 && l.i & c8) {
                                                var { h: K6, P: k6 } = l
                                                    , y6 = n8.x - K6.x
                                                    , S6 = n8.y - K6.y
                                                    , J8 = y6 * y6 + S6 * S6
                                                    , L0 = l.I + o8;
                                                if (0 < J8 && J8 <= L0 * L0) {
                                                    y6 /= J8 = Math.sqrt(J8),
                                                        S6 /= J8;
                                                    var d8 = R6 / (R6 + l.F);
                                                    J8 = (L0 -= J8) * d8,
                                                        n8.x += y6 * J8,
                                                        n8.y += S6 * J8,
                                                        L0 -= J8,
                                                        K6.x -= y6 * L0,
                                                        K6.y -= S6 * L0,
                                                        0 > (L0 = y6 * (q6.x - k6.x) + S6 * (q6.y - k6.y)) && (d8 *= L0 *= t8 * l.r + 1,
                                                            q6.x -= y6 * d8,
                                                            q6.y -= S6 * d8,
                                                            d8 = L0 - d8,
                                                            k6.x += y6 * d8,
                                                            k6.y += S6 * d8,
                                                            b?.UR?.(U8, x0, i, l))
                                                }
                                            }
                                        if (R6 != 0) {
                                            H8.forEach((K8, h8) => {
                                                if (K8.z & _8 && K8.i & c8) {
                                                    var { qy: { x: O0, y: h0 } } = K8;
                                                    0 < (o = K8.xy - (O0 * n8.x + h0 * n8.y) + o8) && (n8.x += O0 * o,
                                                        n8.y += h0 * o,
                                                        0 > (o = q6.x * O0 + q6.y * h0) && (o *= t8 * K8.r + 1,
                                                            q6.x -= o * O0,
                                                            q6.y -= o * h0,
                                                            b?.MR?.(U8, x0, h8)))
                                                }
                                            }
                                            ),
                                                E0.forEach((K8, h8) => {
                                                    if (K8.z & _8 && K8.i & c8) {
                                                        var O0, h0, R8, { x: X6, y: k0 } = n8;
                                                        if (isFinite(K8.wy)) {
                                                            if (O0 = X6 - (h0 = K8.fO).x,
                                                                h0 = k0 - h0.y,
                                                                R8 = K8._p,
                                                                L0 = K8.gp,
                                                                (0 < R8.x * O0 + R8.y * h0 && 0 < L0.x * O0 + L0.y * h0) == 0 >= K8.wy || (L0 = Math.sqrt(O0 * O0 + h0 * h0)) == 0)
                                                                return;
                                                            R8 = L0 - K8.QR,
                                                                O0 /= L0,
                                                                h0 /= L0
                                                        } else {
                                                            var { x: U6, y: V8 } = K8.v.h
                                                                , { x: o0, y: C0 } = K8.s.h;
                                                            if (R8 = X6 - o0,
                                                                L0 = k0 - C0,
                                                                0 >= (X6 - U6) * (h0 = o0 - U6) + (k0 - V8) * (O0 = C0 - V8) || 0 <= R8 * h0 + L0 * O0)
                                                                return;
                                                            R8 = (O0 = (h0 = K8.qy).x) * R8 + (h0 = h0.y) * L0
                                                        }
                                                        if ((L0 = K8.ny) == 0)
                                                            0 > R8 && (R8 = -R8,
                                                                O0 = -O0,
                                                                h0 = -h0);
                                                        else if (0 > L0 && (L0 = -L0,
                                                            R8 = -R8,
                                                            O0 = -O0,
                                                            h0 = -h0),
                                                            R8 < -L0)
                                                            return;
                                                        R8 >= o8 || (R8 = o8 - R8,
                                                            n8.x += O0 * R8,
                                                            n8.y += h0 * R8,
                                                            0 > (R8 = O0 * q6.x + h0 * q6.y) && (R8 *= t8 * K8.r + 1,
                                                                q6.x -= O0 * R8,
                                                                q6.y -= h0 * R8,
                                                                b?.nR?.(U8, x0, h8)))
                                                    }
                                                }
                                                );
                                            var d6 = o8 * o8;
                                            v0.forEach((K8, h8) => {
                                                if (K8.z & _8 && K8.i & c8 && (o = n8.x - K8.h.x,
                                                    F0 = n8.y - K8.h.y,
                                                    0 < (b0 = o * o + F0 * F0) && b0 <= d6)) {
                                                    b0 = Math.sqrt(b0),
                                                        o /= b0,
                                                        F0 /= b0,
                                                        b0 = o8 - b0,
                                                        n8.x += o * b0,
                                                        n8.y += F0 * b0;
                                                    var O0 = 0 > (b0 = o * q6.x + F0 * q6.y);
                                                    O0 && (b0 *= t8 * K8.r + 1,
                                                        q6.x -= o * b0,
                                                        q6.y -= F0 * b0),
                                                        b?.NR?.(U8, x0, h8, O0)
                                                }
                                            }
                                            )
                                        }
                                    }
                                    );
                                for (var I8 = 0; 2 > I8; I8++)
                                    G6.forEach(({ vy: x0, ay: U8, $Y: t8, dy: o8, Cy: c8 }, _8) => {
                                        if (x0 = d0[x0],
                                            U8 = d0[U8],
                                            x0 && U8) {
                                            var { h: R6, P: n8, F: q6 } = x0
                                                , { h: K6, P: k6, F: y6 } = U8;
                                            if (g = R6.x - K6.x,
                                                U8 = R6.y - K6.y,
                                                !(0 >= (l = Math.sqrt(g * g + U8 * U8)))) {
                                                if (g /= l,
                                                    U8 /= l,
                                                    (i = q6 / (q6 + y6)) != i && (i = 0.5),
                                                    o8 >= c8)
                                                    o = o8,
                                                        F0 = 0;
                                                else if (l <= o8)
                                                    o = o8,
                                                        F0 = 1;
                                                else {
                                                    if (!(l >= c8))
                                                        return;
                                                    o = c8,
                                                        F0 = -1
                                                }
                                                l = o - l,
                                                    isFinite(t8) ? (g *= i = t8 * l * 0.5,
                                                        U8 *= i,
                                                        n8.x += g * q6,
                                                        n8.y += U8 * q6,
                                                        k6.x -= g * y6,
                                                        k6.y -= U8 * y6,
                                                        b?.dO?.(_8, !1, !0)) : (o = l * i,
                                                            R6.x += g * o * 0.5,
                                                            R6.y += U8 * o * 0.5,
                                                            l -= o,
                                                            K6.x -= g * l * 0.5,
                                                            K6.y -= U8 * l * 0.5,
                                                            l = g * (n8.x - k6.x) + U8 * (n8.y - k6.y),
                                                            (t8 = 0 >= F0 * l) && (i *= l,
                                                                n8.x -= g * i,
                                                                n8.y -= U8 * i,
                                                                i = l - i,
                                                                k6.x += g * i,
                                                                k6.y += U8 * i),
                                                            b?.dO?.(_8, !0, t8))
                                            }
                                        }
                                    }
                                    )
                            },
                            Ap: function (u) {
                                this.Z.push(u)
                            },
                            eO: function (u) {
                                0 > (u = this.Z.indexOf(u)) || this.Z.splice(u, 1)
                            }
                        },
                            E.bL = n
                    }
                    ),
                    W((v, E) => {
                        E.bL = {
                            HX: H(),
                            kO: Y(),
                            $O: U(),
                            qO: N(),
                            hh: j(),
                            CO: k(),
                            TO: L(),
                            VR: F(),
                            BR: P()
                        }
                    }
                    )());
                typeof V < "u" ? (typeof z < "u" && z.bL && (V = z.bL = M),
                    V.pz = M) : typeof root < "u" ? root.nago = M : global.nago = M
            }
            )
            , $ = Q((V, z) => {
                function W(Q0, W0) {
                    return Q0(W0 = {
                        bL: {}
                    }, W0.bL),
                        W0.bL
                }
                Object.assign(J, {
                    qY: null,
                    JY: {
                        Sp: "www.luxball.online",
                        Oz: "peer.luxball.online",
                        tX: !0
                    },
                    OY: null,
                    Rz: 9,
                    WX: null,
                    KR: [{
                        urls: "stun:stun.l.google.com:19302"
                    }],
                    xz: "",
                    PO: "",
                    hY: null,
                    _Y: null,
                    cO: null,
                    Dp: null,
                    zz: null,
                    GR: null,
                    bp: null,
                    oO: null,
                    lz: null,
                    XX: null,
                    Jp: null,
                    cy: null,
                    rz: null,
                    Ny: null,
                    iz: null,
                    Zp: null,
                    aR: null
                });
                var H = W(function (Q0) {
                    Q0.bL = Q0.vR || (Q0.vR = {
                        wX: 0,
                        Lp: 1,
                        dp: 2,
                        hz: -1,
                        _z: 0,
                        gz: 1,
                        Az: 2,
                        Sz: 3,
                        Dz: 4,
                        bz: 0,
                        tO: 1,
                        Jz: 2,
                        Zz: 3,
                        fz: 4,
                        Lz: 5,
                        dz: 6,
                        ez: 7,
                        kz: 8,
                        $z: 9,
                        sR: 10,
                        qz: 12,
                        uR: 14,
                        Cz: 18,
                        Tz: 20,
                        Pz: 21,
                        cz: 22,
                        oz: 23,
                        Hz: 24,
                        tz: 25,
                        Wz: 26,
                        wz: 27,
                        Iz: 31,
                        Ez: 32,
                        Ij: 33,
                        mz: 36,
                        yx: 38,
                        Qz: 40,
                        Fz: 41,
                        Uz: 51,
                        Mz: 55,
                        nz: 56,
                        Yx: 59,
                        Nz: 2,
                        Vz: 6,
                        Bz: 17
                    })
                })
                    , Y = null;
                function U(Q0, W0 = null) {
                    this.abbr = Q0,
                        this.api = {
                            errors: {}
                        },
                        this.defineMetadata(W0)
                }
                Object.defineProperty(U, "current", {
                    get: function () {
                        return Y
                    },
                    set: function (Q0) {
                        Y = Q0,
                            U.gh?.(Q0)
                    }
                }),
                    U.prototype.defineMetadata = function (Q0) { }
                    ,
                    U.resolveText = function (Q0, W0) {
                        if (Q0) {
                            W0 = W0.map((d) => d?.p9 || d);
                            for (var U0, y = /\$([\d]+)\?\("([^"]*)":"([^"]*)"\)/gm, D = /\$([\d]+)/gm, f = "", x = 0; (U0 = y.exec(Q0)) != null;)
                                f += Q0.substring(x, U0.index) + (W0[U0[1] - 1] ? U0[2] : U0[3]),
                                    x = U0.index + U0[0].length;
                            for (f += Q0.substring(x),
                                Q0 = "",
                                x = 0; (U0 = D.exec(f)) != null;)
                                Q0 += f.substring(x, U0.index) + W0[U0[1] - 1],
                                    x = U0.index + U0[0].length;
                            return Q0 += f.substring(x)
                        }
                    }
                    ,
                    U.jx = (Q0, W0) => U.resolveText(Y?.api?.errors?.[Q0], W0 || []);
                var N = U
                    , j = W(function (Q0) {
                        var { E: W0 } = J
                            , { jx: U0 } = N;
                        function y() {
                            this.Kz = H.bz,
                                this.Gz = null;
                            var D = this;
                            this.toString = () => U0(D.Kz, D.Gz)
                        }
                        W0(y, [], ["code", "params"], []),
                            Q0.bL = Q0.Ah || (Q0.Ah = {
                                Vy: function (D, ...f) {
                                    var x = new y;
                                    return x.Kz = D,
                                        x.Gz = f,
                                        x
                                },
                                ep: y
                            })
                    })
                    , k = W(function (Q0) {
                        var { hY: W0, _Y: U0, cy: y, E: D } = J
                            , { Vy: f } = j;
                        function x(T, m = !1) {
                            this.$ = T,
                                this.Iy = m,
                                this._ = 0
                        }
                        function d(T, m = !1) {
                            this.$ = T,
                                this.Iy = m,
                                this._ = 0
                        }
                        function p(T) {
                            this.qp = [];
                            for (var m = 0; m < T; m++)
                                this.qp.push(0);
                            this.Cp = 0,
                                this.xx = 0
                        }
                        function Y0(T) {
                            this.eh = T,
                                this.Ky = [],
                                this.Tp = 0
                        }
                        function $0(T, m) {
                            this.yl = T,
                                this.Yl = m,
                                this.Pp = T,
                                this.lx = J.cy.now()
                        }
                        x.Ey = function (T, m) {
                            var e = T.getUint8(m)
                                , s0 = m;
                            if (128 & e)
                                if ((224 & e) == 192)
                                    e = (31 & e) << 6 | 63 & T.getUint8(m + 1),
                                        m += 2;
                                else if ((240 & e) == 224)
                                    e = (15 & e) << 12 | (63 & T.getUint8(m + 1)) << 6 | 63 & T.getUint8(m + 2),
                                        m += 3;
                                else if ((248 & e) == 240)
                                    e = (7 & e) << 18 | (63 & T.getUint8(m + 1)) << 12 | (63 & T.getUint8(m + 2)) << 6 | 63 & T.getUint8(m + 3),
                                        m += 4;
                                else if ((252 & e) == 248)
                                    e = (3 & e) << 24 | (63 & T.getUint8(m + 1)) << 18 | (63 & T.getUint8(m + 2)) << 12 | (63 & T.getUint8(m + 3)) << 6 | 63 & T.getUint8(m + 4),
                                        m += 5;
                                else {
                                    if ((254 & e) != 252)
                                        throw f(H.Tz, m, e);
                                    e = (1 & e) << 30 | (63 & T.getUint8(m + 1)) << 24 | (63 & T.getUint8(m + 2)) << 18 | (63 & T.getUint8(m + 3)) << 12 | (63 & T.getUint8(m + 4)) << 6 | 63 & T.getUint8(m + 5),
                                        m += 6
                                }
                            else
                                m++;
                            return {
                                Sh: e,
                                Dh: m - s0
                            }
                        }
                            ,
                            x.prototype = {
                                Uy: function (T) {
                                    if (T == null && (T = this.$.byteLength - this._),
                                        this._ + T > this.$.byteLength)
                                        throw f(H.Pz);
                                    var m = new Uint8Array(this.$.buffer, this.$.byteOffset + this._, T);
                                    return this._ += T,
                                        m
                                },
                                az: function (T) {
                                    var m = this.Uy(T);
                                    return T = new ArrayBuffer(T),
                                        new Uint8Array(T).set(m),
                                        T
                                },
                                kp: function () {
                                    return this.$.getInt8(this._++)
                                },
                                q: function () {
                                    return this.$.getUint8(this._++)
                                },
                                Xx: function () {
                                    var T = this.$.getInt16(this._, this.Iy);
                                    return this._ += 2,
                                        T
                                },
                                By: function () {
                                    var T = this.$.getUint16(this._, this.Iy);
                                    return this._ += 2,
                                        T
                                },
                                W: function () {
                                    var T = this.$.getInt32(this._, this.Iy);
                                    return this._ += 4,
                                        T
                                },
                                ry: function () {
                                    var T = this.$.getUint32(this._, this.Iy);
                                    return this._ += 4,
                                        T
                                },
                                px: function () {
                                    var T = this.$.getFloat32(this._, this.Iy);
                                    return this._ += 4,
                                        T
                                },
                                d: function () {
                                    var T = this.$.getFloat64(this._, this.Iy);
                                    return this._ += 8,
                                        T
                                },
                                Ey: function () {
                                    var T, { _: m, $: e } = this, s0 = 0, u0 = 0;
                                    do
                                        T = e.getUint8(m + s0),
                                            s0 < 5 && (u0 |= (127 & T) << 7 * s0 >>> 0),
                                            ++s0;
                                    while (128 & T);
                                    return this._ += s0,
                                        0 | u0
                                },
                                pX: function (T) {
                                    for (var m, { _: e, $: s0 } = this, u0 = "", p8 = e + T; e < p8;)
                                        e += (m = x.Ey(s0, e)).Dh,
                                            u0 += String.fromCodePoint(m.Sh);
                                    if (e != p8)
                                        throw f(H.cz, e - p8);
                                    return this._ = e,
                                        u0
                                },
                                gY: function () {
                                    var T = this.Ey();
                                    return T <= 0 ? null : this.pX(T - 1)
                                },
                                ZY: function () {
                                    return this.pX(this.Ey())
                                },
                                vz: function () {
                                    return this.pX(this.q())
                                },
                                $p: function () {
                                    return JSON.parse(this.ZY())
                                }
                            },
                            d.j = function (T = 16, m = !1) {
                                return new d(new DataView(new ArrayBuffer(T)), m)
                            }
                            ,
                            d.oy = function (T, m, e) {
                                var s0 = e;
                                if (T < 0)
                                    throw f(H.oz, T);
                                if (T < 128)
                                    m.setUint8(e, 127 & T),
                                        ++e;
                                else if (T < 2048)
                                    m.setUint8(e, T >> 6 & 31 | 192),
                                        m.setUint8(e + 1, 63 & T | 128),
                                        e += 2;
                                else if (T < 65536)
                                    m.setUint8(e, T >> 12 & 15 | 224),
                                        m.setUint8(e + 1, T >> 6 & 63 | 128),
                                        m.setUint8(e + 2, 63 & T | 128),
                                        e += 3;
                                else if (T < 2097152)
                                    m.setUint8(e, T >> 18 & 7 | 240),
                                        m.setUint8(e + 1, T >> 12 & 63 | 128),
                                        m.setUint8(e + 2, T >> 6 & 63 | 128),
                                        m.setUint8(e + 3, 63 & T | 128),
                                        e += 4;
                                else if (T < 67108864)
                                    m.setUint8(e, T >> 24 & 3 | 248),
                                        m.setUint8(e + 1, T >> 18 & 63 | 128),
                                        m.setUint8(e + 2, T >> 12 & 63 | 128),
                                        m.setUint8(e + 3, T >> 6 & 63 | 128),
                                        m.setUint8(e + 4, 63 & T | 128),
                                        e += 5;
                                else {
                                    if (!(T < -2147483648))
                                        throw f(H.Hz, T);
                                    m.setUint8(e, T >> 30 & 1 | 252),
                                        m.setUint8(e + 1, T >> 24 & 63 | 128),
                                        m.setUint8(e + 2, T >> 18 & 63 | 128),
                                        m.setUint8(e + 3, T >> 12 & 63 | 128),
                                        m.setUint8(e + 4, T >> 6 & 63 | 128),
                                        m.setUint8(e + 5, 63 & T | 128),
                                        e += 6
                                }
                                return e - s0
                            }
                            ,
                            d.bh = function (T) {
                                if (T < 0)
                                    throw f(H.tz, T);
                                if (T < 128)
                                    return 1;
                                if (T < 2048)
                                    return 2;
                                if (T < 65536)
                                    return 3;
                                if (T < 2097152)
                                    return 4;
                                if (T < 67108864)
                                    return 5;
                                if (T < -2147483648)
                                    return 6;
                                throw f(H.Wz, T)
                            }
                            ,
                            d.WO = function (T) {
                                for (var m = 0, e = T.length, s0 = 0; s0 < e; s0++)
                                    m += d.bh(T.charCodeAt(s0));
                                return m
                            }
                            ,
                            d.Jh = function (T) {
                                return (T >>>= 0) < 128 ? 1 : T < 16384 ? 2 : T < 2097152 ? 3 : T < 268435456 ? 4 : 5
                            }
                            ,
                            d.prototype = {
                                wO: function () {
                                    var T = new ArrayBuffer(this._)
                                        , m = new Uint8Array(this.$.buffer, this.$.byteOffset, this._);
                                    return new Uint8Array(T).set(m),
                                        T
                                },
                                my: function () {
                                    return new Uint8Array(this.$.buffer, this.$.byteOffset, this._)
                                },
                                OX: function () {
                                    return new DataView(this.$.buffer, this.$.byteOffset, this._)
                                },
                                Zh: function () {
                                    return new x(this.OX(), this.Iy)
                                },
                                Yj: function (T) {
                                    this.$.byteLength >= T || this.fh(2 * this.$.byteLength >= T ? 2 * this.$.byteLength : T)
                                },
                                fh: function (T) {
                                    if (T < 1)
                                        throw f(H.wz);
                                    if (!(this.$.byteLength >= T)) {
                                        var m = new Uint8Array(this.$.buffer);
                                        T = new ArrayBuffer(T),
                                            new Uint8Array(T).set(m),
                                            this.$ = new DataView(T)
                                    }
                                },
                                g: function (T) {
                                    var m = this._++;
                                    this.Yj(this._),
                                        this.$.setUint8(m, T)
                                },
                                Ox: function (T) {
                                    var m = this._;
                                    this._ += 2,
                                        this.Yj(this._),
                                        this.$.setInt16(m, T, this.Iy)
                                },
                                My: function (T) {
                                    var m = this._;
                                    this._ += 2,
                                        this.Yj(this._),
                                        this.$.setUint16(m, T, this.Iy)
                                },
                                m: function (T) {
                                    var m = this._;
                                    this._ += 4,
                                        this.Yj(this._),
                                        this.$.setInt32(m, T, this.Iy)
                                },
                                ey: function (T) {
                                    var m = this._;
                                    this._ += 4,
                                        this.Yj(this._),
                                        this.$.setUint32(m, T, this.Iy)
                                },
                                Rx: function (T) {
                                    var m = this._;
                                    this._ += 4,
                                        this.Yj(this._),
                                        this.$.setFloat32(m, T, this.Iy)
                                },
                                J: function (T) {
                                    var m = this._;
                                    this._ += 8,
                                        this.Yj(this._),
                                        this.$.setFloat64(m, T, this.Iy)
                                },
                                sy: function (T) {
                                    var m = this._;
                                    this._ += T.byteLength,
                                        this.Yj(this._),
                                        new Uint8Array(this.$.buffer, this.$.byteOffset, this.$.byteLength).set(T, m)
                                },
                                IO: function (T) {
                                    this.sy(new Uint8Array(T))
                                },
                                fY: function (T) {
                                    this.oy(d.WO(T)),
                                        this.EO(T)
                                },
                                AY: function (T) {
                                    T != null ? (this.oy(d.WO(T) + 1),
                                        this.EO(T)) : this.oy(0)
                                },
                                sz: function (T) {
                                    var m = d.WO(T);
                                    if (m > 255)
                                        throw null;
                                    this.g(m),
                                        this.EO(T)
                                },
                                mO: function (T) {
                                    this.fY(JSON.stringify(T))
                                },
                                EO: function (T) {
                                    var { _: m } = this
                                        , e = T.length;
                                    this.Yj(m + d.WO(T));
                                    for (var { $: s0 } = this, u0 = 0; u0 < e; u0++)
                                        m += d.oy(T.charCodeAt(u0), s0, m);
                                    this._ = m
                                },
                                oy: function (T) {
                                    var { _: m } = this;
                                    T >>>= 0,
                                        this.Yj(m + d.Jh(T));
                                    var { $: e } = this;
                                    e.setUint8(m, 128 | T),
                                        T >= 128 ? (e.setUint8(m + 1, T >> 7 | 128),
                                            T >= 16384 ? (e.setUint8(m + 2, T >> 14 | 128),
                                                T >= 2097152 ? (e.setUint8(m + 3, T >> 21 | 128),
                                                    T >= 268435456 ? (e.setUint8(m + 4, T >> 28 & 127),
                                                        T = 5) : (e.setUint8(m + 3, 127 & e.getUint8(m + 3)),
                                                            T = 4)) : (e.setUint8(m + 2, 127 & e.getUint8(m + 2)),
                                                                T = 3)) : (e.setUint8(m + 1, 127 & e.getUint8(m + 1)),
                                                                    T = 2)) : (e.setUint8(m, 127 & e.getUint8(m)),
                                                                        T = 1),
                                        this._ += T
                                }
                            },
                            p.prototype = {
                                Lh: function (T) {
                                    this.xx -= this.qp[this.Cp],
                                        this.qp[this.Cp] = T,
                                        this.xx += T,
                                        this.Cp++,
                                        this.Cp >= this.qp.length && (this.Cp = 0)
                                },
                                dh: function () {
                                    return this.xx / this.qp.length
                                }
                            },
                            Y0.prototype = {
                                uz: function (T) {
                                    this.Tp = 0;
                                    var m, e = 0;
                                    for (this.Ky.forEach((s0, u0) => {
                                        s0.zx++,
                                            s0.IX *= 0.97,
                                            this.Ky[e].zx < s0.zx && (e = u0),
                                            this.Tp += s0.IX
                                    }
                                    ),
                                        this.Ky.length >= this.eh ? (m = this.Ky[e],
                                            this.Tp -= m.IX,
                                            this.Ky.splice(e, 1)) : m = {},
                                        m.value = T,
                                        m.IX = 1,
                                        m.zx = 0,
                                        this.Tp += m.IX,
                                        T = 0; T < this.Ky.length && this.Ky[T].value <= m.value; ++T)
                                        ;
                                    this.Ky.splice(T, 0, m)
                                },
                                QO: function (T) {
                                    if (this.Ky.length == 0)
                                        return 0;
                                    if (this.Ky.length == 1)
                                        return this.Ky[0].value;
                                    T *= this.Tp;
                                    for (var m = this.Ky[0].IX, e = 0; e < this.Ky.length - 1 && !(m >= T);)
                                        m += this.Ky[++e].IX;
                                    return this.Ky[e].value
                                },
                                kh: function () {
                                    return this.Ky.length == 0 ? 0 : this.Ky[this.Ky.length - 1].value
                                }
                            },
                            $0.prototype = {
                                jl: function (T = 1) {
                                    return this.Fy(),
                                        !(T > this.Pp) && (this.Pp -= T,
                                            !0)
                                },
                                Fy: function () {
                                    var T = J.cy.now()
                                        , m = Math.floor((T - this.lx) / this.Yl);
                                    this.lx += m * this.Yl,
                                        this.Pp += m,
                                        this.Pp >= this.yl && (this.Pp = this.yl,
                                            this.lx = T)
                                }
                            };
                        let D0 = "0123456789ABCDEF";
                        var M0 = (T) => (T = parseInt(T),
                            isNaN(T) ? null : T)
                            , y0 = {
                                name: "Integer"
                            };
                        D(x, [], ["dataView", "littleEndian", "offset"], ["readUint8Array", "readArrayBuffer", "readInt8", "readUint8", "readInt16", "readUint16", "readInt32", "readUint32", "readFloat32", "readFloat64", "readUTF8Char", "readStringContents", "readNullableString", "readString", "readString2", "readJSON"]),
                            D(d, [], ["dataView", "littleEndian", "offset"], ["toArrayBuffer", "toUint8Array", "toDataView", "createStreamReader", "doubleSizeIfNecessary", "resize", "writeUint8", "writeInt16", "writeUint16", "writeInt32", "writeUint32", "writeFloat32", "writeFloat64", "writeUint8Array", "writeArrayBuffer", "writeString", "writeNullableString", "writeString2", "writeJSON", "writeStringContents", "writeUTF8Char"]),
                            d.create = d.j,
                            Q0.bL = Q0.$h || (Q0.$h = {
                                FO: (T, m, e) => T < m ? m : T > e ? e : T,
                                cp: function (T, m) {
                                    var e = T.indexOf(m);
                                    return !(e < 0) && (T.splice(e, 1),
                                        !0)
                                },
                                Ej: x,
                                mj: d,
                                qh: p,
                                Ch: Y0,
                                Th: $0,
                                UO: y0,
                                MO: (T, m) => {
                                    var e = m != null;
                                    if (e) {
                                        switch (m) {
                                            case Array:
                                                e = T instanceof Array;
                                                break;
                                            case Boolean:
                                                e = typeof T == "boolean";
                                                break;
                                            case Number:
                                                e = typeof T == "number";
                                                break;
                                            case y0:
                                                e = typeof T == "number" && (0 | T) === T;
                                                break;
                                            case String:
                                                e = typeof T == "string";
                                                break;
                                            default:
                                                e = !1
                                        }
                                        if (e)
                                            return T
                                    }
                                    throw f(H.Cz, JSON.stringify(T), m.name || JSON.stringify(m))
                                }
                                ,
                                nO: (T, m) => new Promise((e, s0) => {
                                    var u0 = J.hY(() => {
                                        s0("Timed out")
                                    }
                                        , m);
                                    T.then((p8) => {
                                        J._Y(u0),
                                            e(p8)
                                    }
                                        , (p8) => {
                                            J._Y(u0),
                                                s0(p8)
                                        }
                                    )
                                }
                                ),
                                jj: (T, m) => {
                                    var e = Object.create(T);
                                    for (var s0 in m)
                                        e[s0] = m[s0];
                                    return m.toString !== Object.prototype.toString && (e.toString = m.toString),
                                        e
                                }
                                ,
                                NO: (T) => {
                                    for (var m = "", e = 0; e < T.length;)
                                        m += String.fromCharCode(D0.indexOf(T.charAt(e++)) << 4 | D0.indexOf(T.charAt(e++)));
                                    return m
                                }
                                ,
                                VO: (T) => T.reduce((m, e) => m + String.fromCharCode(e), ""),
                                BO: M0,
                                O9: (T) => M0("0x" + T),
                                op: (T, m) => {
                                    var e = "";
                                    do
                                        e = D0.charAt(15 & T) + e,
                                            T >>>= 4;
                                    while (T > 0);
                                    if (m != null)
                                        for (; e.length < m;)
                                            e = "0" + e;
                                    return e
                                }
                                ,
                                KO: (T) => {
                                    var m;
                                    if (T?.includes(".")) {
                                        if ((m = T.split(".")).length > 4)
                                            return;
                                        for (; m.length < 4;)
                                            m.splice(0, 0, "");
                                        return m.reduce((p8, h6, D6) => {
                                            if (p8 != null) {
                                                var O8 = parseInt(h6.length > 0 ? h6 : "0");
                                                return isNaN(O8) || O8 < 0 || O8 > 255 ? null : p8 |= O8 << 24 - 8 * D6
                                            }
                                        }
                                            , 0)
                                    }
                                    if (T?.includes(":")) {
                                        m = T.split(":");
                                        var e = T.indexOf("::");
                                        if (e != T.lastIndexOf("::"))
                                            return;
                                        if (e >= 0) {
                                            var s0 = m.length;
                                            if (s0 > 9)
                                                return;
                                            ((e = m.findIndex((p8) => p8.length == 0)) == 0 || e == s0 - 2 && m[s0 - 1].length == 0) && (m.splice(e, 1),
                                                s0--),
                                                m[e] = "0";
                                            for (var u0 = 0; u0 < 8 - s0; u0++)
                                                m.splice(e + 1, 0, "0")
                                        }
                                        return m.length != 8 ? void 0 : m.reduce((p8, h6, D6) => {
                                            if (p8 != null) {
                                                var O8 = parseInt(h6, 16);
                                                if (!(isNaN(O8) || O8 < 0 || O8 > 65535))
                                                    return p8 |= BigInt(O8) << 112n - 16n * BigInt(D6)
                                            }
                                        }
                                            , 0n)
                                    }
                                }
                                ,
                                GO: (T) => {
                                    var m, e, s0 = T?.__proto__.constructor.name;
                                    if (s0 == "BigInt") {
                                        var u0 = {
                                            Hp: -1,
                                            MY: 0
                                        }
                                            , p8 = {
                                                Hp: -1,
                                                MY: 0
                                            };
                                        for (e = [],
                                            m = 0; m < 8; m++) {
                                            var h6 = 65535n & T;
                                            h6 == 0 ? (p8.MY == 0 && (p8.Hp = 7 - m),
                                                p8.MY++,
                                                p8.MY > u0.MY && (u0.MY = p8.MY,
                                                    u0.Hp = p8.Hp)) : p8.MY = 0,
                                                e.splice(0, 0, h6.toString(16)),
                                                T >>= 16n
                                        }
                                        u0.MY > 0 && (m = u0.Hp - u0.MY + 1,
                                            e.splice(m, u0.MY - 1),
                                            e[m] = "");
                                        var D6 = e.join(":");
                                        return D6.length == 0 ? D6 = "::" : D6.charAt(D6.length - 1) == ":" ? D6 += ":" : D6.charAt(0) == ":" && (D6 = ":" + D6),
                                            D6
                                    }
                                    if (s0 == "Number") {
                                        for (e = [],
                                            m = 0; m < 4; m++)
                                            e.splice(0, 0, "" + (255 & T)),
                                                T >>= 8;
                                        return e.join(".")
                                    }
                                }
                                ,
                                rx: (T) => {
                                    if (T.length == 43) {
                                        for (var m = 0n, e = 0, s0 = 252; e < 43; e++,
                                            s0 -= 6) {
                                            var u0 = T.charCodeAt(e);
                                            if (u0 == 45)
                                                u0 = 0;
                                            else if (u0 == 95)
                                                u0 = 63;
                                            else if (u0 >= 48 && u0 <= 57)
                                                u0 -= 47;
                                            else if (u0 >= 65 && u0 <= 90)
                                                u0 -= 54;
                                            else {
                                                if (!(u0 >= 97 && u0 <= 122))
                                                    return;
                                                u0 -= 60
                                            }
                                            m |= BigInt(u0) << BigInt(s0)
                                        }
                                        return m
                                    }
                                }
                                ,
                                ix: (T) => {
                                    var m = T?.__proto__.constructor.name;
                                    if (m == "BigInt") {
                                        for (var e = "", s0 = 0; s0 < 43; s0++) {
                                            if ((m = Number(63n & T)) == 0)
                                                m = 45;
                                            else if (m == 63)
                                                m = 95;
                                            else if (m >= 1 && m <= 10)
                                                m += 47;
                                            else if (m >= 11 && m <= 36)
                                                m += 54;
                                            else {
                                                if (!(m >= 37 && m <= 62))
                                                    return;
                                                m += 60
                                            }
                                            e = String.fromCharCode(m) + e,
                                                T >>= 6n
                                        }
                                        return e
                                    }
                                }
                                ,
                                aO: (T, m, e) => !((T ^ m) & e),
                                tp: (T, m, e = !0) => !T && e ? null : (typeof T == "string" && (T = JSON.parse(T)),
                                {
                                    lat: T?.lat || m?.lat || 40,
                                    lon: T?.lon || m?.lon || 40,
                                    flag: T?.flag || m?.flag || "tr"
                                }),
                                hx: function T(m, e = 1) {
                                    e <= 0 ? m() : Promise.resolve().then(() => {
                                        T(m, e - 1)
                                    }
                                    )
                                }
                            })
                    })
                    , { Ej: L, mj: F } = k
                    , { Vy: P } = j
                    , M = {
                        name: "ECDSA",
                        namedCurve: "P-256"
                    }
                    , v = {
                        name: "ECDSA",
                        hash: {
                            name: "SHA-256"
                        }
                    };
                function E() {
                    this.x = null,
                        this.y = null,
                        this._x = null,
                        this.gx = null
                }
                E.Ph = function () {
                    try {
                        return J.XX.generateKey(M, !0, ["sign", "verify"]).then(function (Q0) {
                            var W0 = Q0.privateKey;
                            return J.XX.exportKey("jwk", W0).then(function (U0) {
                                var y = new E;
                                return y.x = U0.x,
                                    y.y = U0.y,
                                    y._x = U0.d,
                                    y.gx = W0,
                                    y
                            })
                        })
                    } catch (Q0) {
                        return Promise.reject(Q0)
                    }
                }
                    ,
                    E.ch = function (Q0) {
                        var W0 = Q0.split(".");
                        if (W0.length != 4 || W0[0] != "idkey")
                            return Promise.reject(P(H.Uz));
                        var U0 = W0[1]
                            , y = W0[2]
                            , D = W0[3];
                        return function (f, x, d) {
                            try {
                                return J.XX.importKey("jwk", {
                                    crv: "P-256",
                                    ext: !0,
                                    key_ops: ["sign"],
                                    kty: "EC",
                                    d,
                                    x: f,
                                    y: x
                                }, M, !0, ["sign"])
                            } catch (p) {
                                return Promise.reject(p)
                            }
                        }(U0, y, D).then(function (f) {
                            var x = new E;
                            return x.x = U0,
                                x.y = y,
                                x._x = D,
                                x.gx = f,
                                x
                        })
                    }
                    ,
                    E.oh = function (Q0, W0) {
                        try {
                            var U0 = new L(new DataView(Q0.buffer, Q0.byteOffset, Q0.byteLength), !1);
                            U0.q();
                            var y = U0.Uy(U0.By())
                                , D = U0.Uy()
                                , f = (U0 = new L(new DataView(y.buffer, y.byteOffset, y.byteLength), !1)).ZY()
                                , x = U0.ZY()
                                , d = U0.Uy();
                            if (d.byteLength != W0.byteLength)
                                return Promise.reject(null);
                            for (var p = 0; p < d.byteLength; p++)
                                if (d[p] != W0[p])
                                    return Promise.reject(null);
                            return function (Y0, $0) {
                                try {
                                    return J.XX.importKey("jwk", {
                                        crv: "P-256",
                                        ext: !0,
                                        key_ops: ["verify"],
                                        kty: "EC",
                                        x: Y0,
                                        y: $0
                                    }, M, !0, ["verify"])
                                } catch (D0) {
                                    return Promise.reject(D0)
                                }
                            }(f, x).then(function (Y0) {
                                return J.XX.verify(v, Y0, D, y)
                            }).then(function (Y0) {
                                if (!Y0)
                                    throw null;
                                return f
                            })
                        } catch (Y0) {
                            return Promise.reject(Y0)
                        }
                    }
                    ,
                    E.prototype = {
                        Hh: function () {
                            return "idkey." + this.x + "." + this.y + "." + this._x
                        },
                        th: function (Q0) {
                            try {
                                var W0 = F.j(1024);
                                W0.g(1);
                                var U0 = W0._;
                                W0.My(0);
                                var y = W0._;
                                W0.fY(this.x),
                                    W0.fY(this.y),
                                    W0.sy(Q0);
                                var D = W0._ - y;
                                return W0.$.setUint16(U0, D, W0.Iy),
                                    J.XX.sign(v, this.gx, new Uint8Array(W0.$.buffer, W0.$.byteOffset + y, D)).then(function (f) {
                                        return W0.IO(f),
                                            W0.my()
                                    })
                            } catch (f) {
                                return Promise.reject(f)
                            }
                        }
                    };
                var n = E
                    , u = W(function (Q0) {
                        function W0(y, D, f, x, d, p, Y0) {
                            return new Promise(function ($0, D0) {
                                var M0 = {
                                    method: f,
                                    body: d
                                };
                                y != null && (M0.agent = y);
                                var y0 = Y0 || {};
                                p != null && Object.assign(y0, {
                                    "Content-type": p
                                }),
                                    M0.headers = {
                                        accept: "",
                                        "accept-language": "tr,en;q=0.9,en-GB;q=0.8,en-US;q=0.7",
                                        "content-type": "application/x-www-form-urlencoded",
                                        "sec-ch-ua":
                                            '" Not A;Brand";v="99", "Chromium";v="100", "Microsoft Edge";v="100"',
                                        "sec-ch-ua-mobile": "?0",
                                        "sec-ch-ua-platform": '"Windows"',
                                        "sec-fetch-dest": "empty",
                                        "sec-fetch-mode": "cors",
                                        "sec-fetch-site": "same-site",
                                        Referer: "https://luxball.online/",
                                        "Referrer-Policy": "strict-origin-when-cross-origin",
                                    },
                                    J.lz(D, M0).then(async (T) => {
                                        T.status >= 200 && T.status < 300 ? $0(await T[x]()) : D0("status: " + T.status)
                                    }
                                    ).catch((T) => {
                                        D0(T)
                                    }
                                    )
                            }
                            )
                        }
                        function U0(y, D, f, x) {
                            return W0(y, D, "GET", f, null, null, x)
                        }
                        Q0.bL = Q0.wh || (Q0.wh = {
                            Ax: (y) => U0(y, J.PO + "api/list", "arrayBuffer"),
                            Sx: (y) => function (D, f, x) {
                                return U0(D, f, "json", x).then(function (d) {
                                    if (d.error != null)
                                        throw d.error;
                                    return d.data
                                })
                            }(y, J.PO + "api/geo").then((D) => ({
                                lat: D.lat,
                                lon: D.lon,
                                flag: D.code.toLowerCase()
                            })),
                            Dx: ({ OY: y, CY: D, Ih: f = "" }, x, d) => function (p, Y0, $0, D0, M0) {
                                return W0(p, Y0, "POST", "json", $0, D0, M0).then(function (y0) {
                                    if (y0.error != null)
                                        throw y0.error;
                                    return y0.data
                                })
                            }(y, J.PO + "api/host", "token=" + D + "&rcr=" + f, "application/x-www-form-urlencoded", {
                                Accept: "*/*",
                                "Content-length": "11",
                                "Content-type": "application/x-www-form-urlencoded",
                                Priority: "u=1, i",
                                "User-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36"
                            }).then((p) => {
                                switch (p.action) {
                                    case "connect":
                                        x(p.url, p.token);
                                        break;
                                    case "recaptcha":
                                        d(p.sitekey)
                                }
                            }
                            ).catch((e) => console.log("errorWebSockets", e)),
                            Ol: function ({ Xl: y, CY: D, pl: f, OY: x, Wh: d, EX: p, nY: Y0, mX: $0, QX: D0 }) {
                                var M0;
                                if (x || J.qY?.HO) {
                                    var y0 = {};
                                    x && (y0.agent = x);
                                    var T = d || {};
                                    J.qY.HO && Object.assign(T, {
                                        Origin: (J.JY.tX ? "https" : "http") + "://" + J.JY.Sp
                                    }),
                                        y0.headers = T,
                                        M0 = new J.Jp(y + "?token=" + D, f, y0)
                                } else
                                    M0 = new J.Jp(y + "?token=" + D, f);
                                return M0.binaryType = "arraybuffer",
                                    M0.onopen = p,
                                    M0.onclose = Y0,
                                    M0.onerror = $0,
                                    M0.onmessage = D0,
                                    M0
                            }
                        })
                    })
                    , { Vy: b } = j
                    , { jj: i } = k;
                function g() {
                    this.YY = 0
                }
                function l() { }
                g.vO = new Map,
                    g.Eh = function (Q0) {
                        if (Q0.Xj == null)
                            throw b(H.Iz);
                        Q0.prototype.Xj = Q0.Xj,
                            g.vO.set(Q0.prototype.eventType, Q0)
                    }
                    ,
                    g.S = function (Q0, W0) {
                        var U0 = Q0?.FX?.prototype?.eventType;
                        if (U0 == null)
                            throw b(H.Ez);
                        W0.g(U0),
                            Q0.S(W0)
                    }
                    ,
                    g.D = function (Q0, W0) {
                        var U0 = l.sO(Q0.q());
                        return U0.Zy = 0,
                            U0.D(Q0, W0),
                            U0
                    }
                    ,
                    g.prototype = {
                        H: function () {
                            throw b(H.Ij)
                        },
                        D: function () {
                            throw b(H.Ij)
                        },
                        S: function () {
                            throw b(H.Ij)
                        },
                        copy: function () {
                            throw b(H.Ij)
                        },
                        FX: g
                    },
                    g.prototype.eventType = null,
                    l.V = g,
                    l.gy = function ({ X: Q0, zy: W0, jy: U0, Q: y, Ay: D, Sy: f, H: x, S: d, D: p }) {
                        function Y0() {
                            this.YY = 0,
                                y.call(this)
                        }
                        return Y0.j = function (...$0) {
                            return D(new Y0, ...$0)
                        }
                            ,
                            Y0.prototype = i(g.prototype, {
                                H: function ($0) {
                                    x.call(this, $0)
                                },
                                S: function ($0) {
                                    d.call(this, $0)
                                },
                                D: function ($0, D0) {
                                    p.call(this, $0, D0)
                                },
                                copy: function () {
                                    var $0 = Y0.j(...f.call(this));
                                    return $0.YY = this.YY,
                                        $0.Zy = this.Zy,
                                        $0.p = this.p,
                                        $0.uO = this.uO,
                                        to
                                },
                                FX: Y0
                            }),
                            Y0.prototype.eventType = Q0,
                            Y0.Xj = {
                                zy: W0,
                                jy: U0
                            },
                            g.Eh(Y0),
                            Y0
                    }
                    ,
                    l.Wp = function (Q0, W0) {
                        g.vO.delete(Q0.prototype.eventType),
                            Q0.prototype.eventType = W0,
                            g.vO.set(W0, Q0)
                    }
                    ,
                    l.sO = (Q0) => {
                        var W0 = g.vO.get(Q0);
                        if (W0) {
                            var U0 = Object.create(W0.prototype);
                            return U0.YY = 0,
                                U0
                        }
                    }
                    ,
                    l.bx = g.D,
                    l.Jx = g.S;
                var o = l
                    , F0 = W(function (Q0) {
                        var { Vy: W0 } = j
                            , { gy: U0 } = o
                            , y = U0({
                                X: H.Nz,
                                zy: !1,
                                jy: !1,
                                Q: function () {
                                    this.Ry = null
                                },
                                Ay: function (x, d) {
                                    return x.Ry = d,
                                        x
                                },
                                Sy: function () {
                                    var x = null;
                                    return this.Ry && (x = new ArrayBuffer(this.Ry.byteLength),
                                        new Uint8Array(x).set(new Uint8Array(this.Ry))),
                                        [x]
                                },
                                H: function (x) {
                                    x.mh(this.Ry)
                                },
                                S: function (x) {
                                    x.oy(this.Ry.byteLength),
                                        x.IO(this.Ry)
                                },
                                D: function (x) {
                                    this.Ry = x.az(x.Ey())
                                }
                            })
                            , D = U0({
                                X: H.Vz,
                                zy: !1,
                                jy: !1,
                                Q: function () {
                                    this.X = 0,
                                        this.pj = null,
                                        this.wp = !1,
                                        this.p = 0
                                },
                                Ay: function (x, d, p, Y0) {
                                    return x.X = d,
                                        x.pj = p,
                                        x.wp = Y0,
                                        x
                                },
                                Sy: function () {
                                    return [this.X, this.pj, this.wp]
                                },
                                H: function (x) {
                                    x.TY(this.p, 128) && x.Qh(x.G(this.X), this.pj, this.wp, x.G(this.p))
                                },
                                S: function (x) {
                                    this.pj != null && (this.pj = this.pj.substring(0, 100)),
                                        x.m(this.X),
                                        x.AY(this.pj),
                                        x.g(this.wp ? 1 : 0)
                                },
                                D: function (x) {
                                    if (this.X = x.W(),
                                        this.pj = x.gY(),
                                        this.wp = x.q() != 0,
                                        this.pj != null && this.pj.length > 100)
                                        throw W0(H.mz)
                                }
                            })
                            , f = U0({
                                X: H.Bz,
                                zy: !1,
                                jy: !1,
                                Q: function () {
                                    this.Lj = null,
                                        this.p = 0
                                },
                                Ay: function (x, d) {
                                    return x.Lj = d,
                                        x
                                },
                                Sy: function () {
                                    return [this.Lj.slice()]
                                },
                                H: function (x) {
                                    this.p == 0 && x.Fh(this.Lj)
                                },
                                S: function (x) {
                                    x.oy(this.Lj.length),
                                        this.Lj.forEach((d) => x.oy(d))
                                },
                                D: function (x) {
                                    var d = x.Ey();
                                    this.Lj = [];
                                    for (var p = 0; p < d; p++)
                                        this.Lj.push(x.Ey())
                                }
                            });
                        Q0.bL = Q0.Uh || (Q0.Uh = {
                            RX: y,
                            xX: D,
                            zX: f
                        })
                    });
                function b0() { }
                b0.Zx = function ({ Q: Q0, LY: W0 }) {
                    function U0() {
                        this.SY = -1,
                            this.u = null,
                            this.X = 0,
                            this.L = "Player",
                            this.UX = 0,
                            this.ky = null,
                            this.Oj = !1,
                            this.Qj = null,
                            this.Gy = null,
                            this.fx = null,
                            Q0?.call(this)
                    }
                    return U0.LY = function (y, D, f) {
                        y.X = D.X,
                            y.L = D.L,
                            y.UX = D.UX,
                            y.ky = D.ky,
                            y.Oj = D.Oj,
                            W0?.(y, D, f)
                    }
                        ,
                        U0.prototype = {
                            dY: function (y) {
                                return y != this.SY && (this.u || (this.u = new U0),
                                    this.SY = y,
                                    U0.LY(this.u, this, y)),
                                    this.u
                            }
                        },
                        U0
                }
                    ;
                var d0 = b0
                    , H8 = W(function (Q0) {
                        var { E: W0 } = J;
                        function U0() {
                            this.NY = 0,
                                this.L = "",
                                this.ky = "",
                                this.yR = 0,
                                this.YR = 0,
                                this.PY = !1,
                                this.Lx = 0,
                                this.o = 0
                        }
                        function y() {
                            this.Ry = null,
                                this.X = "",
                                this.xy = 1 / 0
                        }
                        U0.prototype = {
                            Rl: function () {
                                this.L = this.L.substring(0, 40),
                                    this.ky = this.ky.substring(0, 3)
                            },
                            S: function (D) {
                                this.Rl(),
                                    D.Iy = !0,
                                    D.My(this.NY),
                                    D.sz(this.L),
                                    D.sz(this.ky),
                                    D.Rx(this.yR),
                                    D.Rx(this.YR),
                                    D.g(this.PY ? 1 : 0),
                                    D.g(this.Lx),
                                    D.g(this.o),
                                    D.Iy = !1
                            },
                            D: function (D) {
                                D.Iy = !0,
                                    this.NY = D.By(),
                                    this.L = D.vz(),
                                    this.ky = D.vz(),
                                    this.yR = D.px(),
                                    this.YR = D.px(),
                                    this.PY = D.q() != 0,
                                    this.Lx = D.q(),
                                    this.o = D.q(),
                                    D.Iy = !1,
                                    this.Rl()
                            }
                        },
                            W0(U0, [], ["version", "name", "flag", "lat", "lon", "password", "maxPlayers", "players"], []),
                            W0(y, [], ["data", "id", "dist"], []),
                            Q0.bL = Q0.Mh || (Q0.Mh = {
                                xl: U0,
                                zl: y
                            })
                    })
                    , { Ej: E0, mj: v0 } = k
                    , { V: G6 } = o;
                function I8() { }
                I8.Kh = function (Q0, { Q: W0, Ip: U0, Ep: y, mp: D, dx: f, ex: x }) {
                    function d() {
                        this.R = new Q0.Rj(Q0),
                            this.xj = [],
                            this.MX = 0,
                            W0?.call(this)
                    }
                    return d.prototype = {
                        nh: function (p) {
                            var Y0 = 0
                                , $0 = new E0(new DataView(p.buffer), !1);
                            U0?.call(this, $0),
                                this.MX = $0.ry();
                            var D0, M0 = J.Ny.inflateRaw($0.Uy());
                            $0 = new E0(new DataView(M0.buffer, M0.byteOffset, M0.byteLength)),
                                y?.call(this, $0, this);
                            var y0 = null;
                            for (M0 = $0.Uy(),
                                $0 = new E0(new DataView(M0.buffer, M0.byteOffset, M0.byteLength), !1),
                                this.R.D($0); $0._ < $0.$.byteLength;)
                                Y0 += D0 = $0.Ey(),
                                    D0 = $0.By(),
                                    (y0 = G6.D($0, !0)).p = D0,
                                    y0.frameNo = Y0,
                                    this.xj.push(y0)
                        },
                        Nh: function () {
                            var p = v0.j(16384)
                                , Y0 = 0;
                            this.R.S(p),
                                this.xj.forEach((y0) => {
                                    var T = y0.frameNo;
                                    T < Y0 || (p.oy(T - Y0),
                                        Y0 = T,
                                        p.My(y0.p),
                                        G6.S(y0, p))
                                }
                                );
                            var $0 = v0.j(1000);
                            f?.call(this, $0, this),
                                $0.sy(p.my());
                            var D0 = J.Ny.deflateRaw($0.my())
                                , M0 = v0.j(D0.byteLength + 32);
                            return D?.call(this, M0),
                                M0.ey(this.MX),
                                M0.sy(D0),
                                M0.my()
                        },
                        Vh: function (p) {
                            var { R: Y0, xj: $0, MX: D0 } = this
                                , M0 = p?.beginFrameNo || 0;
                            M0 < 0 && (M0 = 0);
                            var y0 = p?.endFrameNo || D0 - 1;
                            if (y0 >= D0 && (y0 = D0 - 1),
                                !(y0 < M0)) {
                                for (var T = 0, m = 0, e = $0[0]; m < M0;) {
                                    for (; m == e?.frameNo;)
                                        e.H(Y0),
                                            e = $0[++T];
                                    m++,
                                        Y0.Qy(1)
                                }
                                ($0 = $0.filter((s0) => s0.frameNo >= M0 && s0.frameNo <= y0)).forEach((s0) => {
                                    s0.frameNo -= M0
                                }
                                ),
                                    this.xj = $0,
                                    x?.call(this, M0, y0),
                                    this.MX = y0 - M0 + 1
                            }
                        },
                        Bh: function (p) {
                            var { R: Y0, xj: $0, MX: D0 } = this
                                , M0 = p?.beginFrameNo || 0;
                            M0 < 0 && (M0 = 0);
                            var y0 = p?.endFrameNo || D0 - 1;
                            if (y0 >= D0 && (y0 = D0 - 1),
                                y0 < M0)
                                return Promise.resolve();
                            var T = 0
                                , m = 0
                                , e = $0[0];
                            return new Promise((s0, u0) => {
                                var p8 = _setInterval(() => {
                                    if (m >= M0)
                                        return _clearInterval(p8),
                                            ($0 = $0.filter((h6) => h6.frameNo >= M0 && h6.frameNo <= y0)).forEach((h6) => {
                                                h6.frameNo -= M0
                                            }
                                            ),
                                            this.xj = $0,
                                            x?.call(this, M0, y0),
                                            this.MX = y0 - M0 + 1,
                                            void s0();
                                    for (; m == e?.frameNo;)
                                        e.H(Y0),
                                            e = $0[++T];
                                    m++,
                                        Y0.Qy(1)
                                }
                                    , 0)
                            }
                            )
                        }
                    },
                        d
                }
                    ;
                var x0 = I8
                    , { V: U8 } = o
                    , { mj: t8 } = k;
                function o8() { }
                o8.ah = function ({ Q: Q0, mp: W0, lX: U0 }) {
                    function y(D) {
                        this.Gh = D?.f,
                            this.rX = t8.j(1000),
                            this.Qp = t8.j(16384),
                            this.R = D;
                        var f = this
                            , x = D.f;
                        D.O.S(this.Qp),
                            D.VY = (d) => {
                                var p = D.f;
                                f.Qp.oy(p - x),
                                    x = p,
                                    f.Qp.My(d.p),
                                    U8.S(d, f.Qp)
                            }
                            ,
                            Q0?.call(this)
                    }
                    return y.prototype = {
                        lX: function () {
                            this.R.VY = null,
                                U0?.call(this),
                                this.rX.sy(this.Qp.my());
                            var D = J.Ny.deflateRaw(this.rX.my())
                                , f = t8.j(D.byteLength + 32);
                            return W0?.call(this, f),
                                f.ey(this.R.f - this.Gh),
                                f.sy(D),
                                f.my()
                        }
                    },
                        y
                }
                    ;
                var c8 = o8;
                function _8() {
                    this.uy = []
                }
                _8.prototype = {
                    kx: function (Q0) {
                        var W0 = 0
                            , { Zy: U0, YY: y } = Q0;
                        this.uy.find((D) => {
                            var f = D.Zy;
                            if (f > U0)
                                return !0;
                            if (f == U0) {
                                if ((f = D.YY) > y)
                                    return !0;
                                f == y && y++
                            }
                            W0++
                        }
                        ),
                            Q0.YY = y,
                            this.uy.splice(W0, 0, Q0)
                    },
                    vh: function (Q0) {
                        var W0 = this.uy.findIndex((U0) => U0.Zy >= Q0);
                        W0 < 0 ? this.uy.length = 0 : this.uy.splice(0, W0)
                    },
                    sh: function (Q0, W0) {
                        var { uy: U0 } = this;
                        if (U0.length = 0,
                            Q0 = Q0.uy,
                            W0 = W0.uy,
                            Q0.length != 0)
                            if (W0.length != 0)
                                for (var y = 0, D = Q0.length, f = 0, x = W0.length; ;) {
                                    var d = Q0[y]
                                        , p = W0[f];
                                    if (d.Zy <= p.Zy) {
                                        if (U0.push(d),
                                            ++y >= D) {
                                            for (; f < x;)
                                                U0.push(W0[f++]);
                                            break
                                        }
                                    } else if (U0.push(p),
                                        ++f >= x) {
                                        for (; y < D;)
                                            U0.push(Q0[y++]);
                                        break
                                    }
                                }
                            else
                                Q0.forEach((Y0) => U0.push(Y0));
                        else
                            W0.forEach((Y0) => U0.push(Y0))
                    },
                    uh: function (Q0) {
                        var W0 = 0
                            , { uy: U0 } = this;
                        U0.forEach((y) => {
                            y.iX != Q0 && (U0[W0++] = y)
                        }
                        ),
                            U0.length = W0
                    },
                    y_: function (Q0) {
                        var W0 = this.uy.findIndex((U0) => U0.Zy >= Q0);
                        return W0 < 0 ? this.uy.length : W0
                    }
                };
                var R6 = _8
                    , { Vy: n8 } = j;
                function q6(Q0) {
                    this.$x = new R6,
                        this.hX = 0,
                        this.RY = 0,
                        this.dj = new R6,
                        this.cY = 0,
                        this.ej = 0,
                        this.BY = 0.06,
                        this.qx = 16.666666666666668,
                        this.jR = 120,
                        this.f = 0,
                        this.O = Q0,
                        this.Cx = 0,
                        this.Tx = null
                }
                q6.prototype = {
                    kj: function () {
                        throw n8(H.Ij)
                    },
                    zj: function (Q0 = 0) {
                        throw n8(H.Ij)
                    },
                    Fy: function () {
                        throw n8(H.Ij)
                    },
                    ll: function (Q0) {
                        this.Tx = null;
                        for (var W0, { uy: U0 } = this.dj, y = 0, D = U0.length, f = 0; f < Q0; f++) {
                            for (; y < D && (W0 = U0[y]).Zy == this.f;)
                                W0.H(this.O),
                                    this.VY?.(W0),
                                    this.RY++,
                                    y++;
                            this.O.Qy(1),
                                this.hX += this.RY,
                                this.RY = 0,
                                this.f++
                        }
                        for (; y < D && ((W0 = U0[y]).Zy == this.f && W0.YY == this.RY);)
                            W0.H(this.O),
                                this.VY?.(W0),
                                this.RY++,
                                y++;
                        U0.splice(0, y)
                    },
                    a: function (Q0) {
                        Q0.Zy == this.f && Q0.YY <= this.RY ? (Q0.YY = this.RY++,
                            Q0.H(this.O),
                            this.VY?.(Q0)) : this.dj.kx(Q0)
                    },
                    rl: function (Q0, W0) {
                        if (Q0 <= 0)
                            return this.O;
                        Q0 > this.jR && (Q0 = this.jR);
                        var U0, y = this.Tx = this.O.dY(++this.Cx);
                        W0 != null ? (this.$x.sh(this.dj, W0),
                            U0 = this.$x) : U0 = this.dj;
                        for (var D = 0, f = (U0 = U0.uy).length, x = 0 | Q0, d = this.f, p = d + x; d <= p; d++) {
                            for (; D < f;) {
                                var Y0 = U0[D];
                                if (Y0.Zy > d)
                                    break;
                                Y0.Xj.zy && Y0.H(y),
                                    D++
                            }
                            y.Qy(d != p ? 1 : Q0 - x)
                        }
                        return this.$x.uy.length = 0,
                            y
                    },
                    Y_: function (Q0) {
                        this.cY = Q0 * this.BY | 0,
                            this.O.Px?.(Q0)
                    }
                };
                var K6 = q6
                    , { ep: k6, Vy: y6 } = j
                    , { Ej: S6, jj: J8 } = k
                    , { V: L0 } = o;
                function d8() { }
                d8.j_ = function (Q0, { Ip: W0, Ep: U0, Fj: y, $j: D }) {
                    function f(d, p, Y0) {
                        this.XR = 0,
                            this.nX = -1,
                            this.lj = 0,
                            this.cx = 0,
                            this.rj = 0,
                            this.ox = 0,
                            K6.call(this, p);
                        var $0 = new S6(new DataView(d.buffer), !1);
                        W0?.call(this, $0),
                            this.Hx = $0.ry();
                        var D0 = J.Ny.inflateRaw($0.Uy());
                        this.NX = new S6(new DataView(D0.buffer, D0.byteOffset, D0.byteLength)),
                            U0?.call(this, this.NX),
                            D0 = this.NX.Uy(),
                            this.NX = new S6(new DataView(D0.buffer, D0.byteOffset, D0.byteLength), !1),
                            this.pR(),
                            this.cx = J.cy.now(),
                            this.ej = -1,
                            this.R9 = Y0,
                            this.VX = null,
                            this.tx = null
                    }
                    function x(d, p, Y0) {
                        var $0 = 0
                            , D0 = Y0?.requestAnimationFrame || J.bp
                            , M0 = Y0?.cancelAnimationFrame || J.oO
                            , y0 = p?.render
                            , T = y0 && function () {
                                d.nX > 0 || y0()
                            }
                            , m = function () {
                                $0 = D0(m),
                                    d.Fy(),
                                    T?.()
                            };
                        $0 = D0(m),
                            this.$j = function () {
                                D?.(d)
                            }
                            ,
                            this.Fj = function () {
                                y?.(d, p)
                            }
                            ,
                            this.Xy = function () {
                                M0($0),
                                    this.$j()
                            }
                            ,
                            this.pR = () => {
                                d.pR()
                            }
                    }
                    return f.prototype = J8(K6.prototype, {
                        il: function () {
                            var { NX: d } = this;
                            if (d.$.byteLength > d._) {
                                this.ox += d.Ey();
                                var p = d.By();
                                this.Fp = L0.D(d, !0),
                                    this.Fp.p = p
                            } else
                                this.Fp = null
                        },
                        kj: function () { },
                        zj: function (d = 0) {
                            this.Fy();
                            var p = this.O.dY(++this.Cx);
                            return p.Qy(this.lj + d * this.BY | 0),
                                p
                        },
                        Fy: function () {
                            var d = J.cy.now()
                                , p = d - this.cx;
                            this.cx = d;
                            var Y0 = !1
                                , $0 = !1;
                            this.nX >= 0 ? (this.rj += 1e4,
                                this.rj > this.nX && (this.rj = this.nX,
                                    this.nX = -1,
                                    Y0 = !0)) : this.rj += p * this.XR;
                            var D0 = this.Hx * this.qx;
                            for (this.rj > D0 && (this.rj = D0,
                                $0 = !0),
                                D0 = 0 | (p = this.rj * this.BY),
                                this.lj = p - D0; this.f < D0;) {
                                for (; this.Fp != null && this.ox == this.f;)
                                    this.Fp.H(this.O),
                                        this.VY?.(this.Fp),
                                        this.il();
                                this.f++,
                                    this.O.Qy(1)
                            }
                            Y0 && (this.VX.Fj(),
                                this.tx?.onDestinationTimeReached?.()),
                                $0 && (this.XR = 0,
                                    this.VX.$j(),
                                    this.tx?.onEnd?.())
                        },
                        hl: function (d) {
                            this.VX.$j(),
                                this.nX = d,
                                this.rj > d && this.pR()
                        },
                        pR: function () {
                            this.ox = 0,
                                this.NX._ = 0,
                                this.f = 0,
                                this.rj = 0,
                                this.O.D(this.NX),
                                this.il()
                        }
                    }),
                        function (d, p, Y0) {
                            var $0, D0 = new Q0.Rj(Q0);
                            try {
                                ($0 = new f(d, D0, p)).VX = new x($0, p, Y0)
                            } catch (y0) {
                                throw y0 instanceof k6 ? y0 : y6(H.Qz, y0)
                            }
                            var M0 = {
                                state: D0,
                                extrapolate: (y0) => $0.zj(y0),
                                getSpeed: () => $0.XR,
                                setSpeed: (y0) => {
                                    $0.VX.Fj(),
                                        $0.XR = y0
                                }
                                ,
                                getTime: () => $0.rj,
                                length: () => $0.qx * $0.Hx,
                                setTime: (y0) => {
                                    $0.hl(y0)
                                }
                                ,
                                getCurrentFrameNo: () => $0.f,
                                setCurrentFrameNo: (y0) => {
                                    $0.hl($0.qx * y0)
                                }
                                ,
                                destroy: () => {
                                    console.log("1")
                                    $0.VX.Xy()
                                }
                            };
                            return Object.defineProperty(M0, "gameState", {
                                get: () => D0.l
                            }),
                                Object.defineProperty(M0, "currentPlayerId", {
                                    get: () => $0.ej
                                }),
                                Object.defineProperty(M0, "maxFrameNo", {
                                    get: () => $0.Hx
                                }),
                                $0.tx = M0,
                                M0
                        }
                }
                    ;
                var d6 = d8
                    , { Kh: K8 } = x0
                    , { ah: h8 } = c8
                    , { j_: O0 } = d6;
                function h0() { }
                h0.Wx = function (Q0, { Ip: W0, mp: U0, Ry: { Q: y, Ep: D, dx: f, ex: x }, X_: { Q: d, lX: p }, p_: { Fj: Y0, $j: $0 } }) {
                    var D0 = K8(Q0, {
                        Q: y,
                        Ip: W0,
                        mp: U0,
                        Ep: D,
                        dx: f,
                        ex: x
                    });
                    return {
                        O_: D0,
                        R_: h8({
                            Q: d,
                            mp: U0,
                            lX: p
                        }),
                        x_: O0(Q0, {
                            Ip: W0,
                            Ep: D,
                            Fj: Y0,
                            $j: $0
                        }),
                        z_: function (M0) {
                            var y0 = new D0;
                            return y0.nh(M0),
                                y0
                        },
                        l_: function (M0) {
                            return M0.Nh()
                        },
                        r_: function (M0, y0) {
                            M0?.Vh(y0)
                        },
                        i_: function (M0, y0) {
                            return M0?.Bh(y0) || Promise.resolve()
                        }
                    }
                }
                    ;
                var R8 = h0
                    , { cp: X6, Ej: k0, mj: U6 } = k;
                function V8() { }
                V8.wx = function (Q0, { Q: W0, LY: U0, _X: y, Qy: D, h_: f, __: x }) {
                    function d() {
                        this.SY = -1,
                            this.u = null,
                            this.L = "",
                            this.o = [],
                            this.BX = Q0,
                            W0?.call(this)
                    }
                    return d.LY = function (p, Y0, $0) {
                        if (p.L = Y0.L,
                            Y0.o) {
                            p.o || (p.o = []);
                            for (var D0 = p.o, M0 = Y0.o, y0 = M0.length; D0.length > y0;)
                                D0.pop();
                            for (var T = 0; T < y0; T++)
                                D0[T] = M0[T].dY($0)
                        } else
                            p.o = null;
                        U0?.(p, Y0, $0)
                    }
                        ,
                        d.prototype = {
                            Fh: function (p) {
                                this.o.find((Y0, $0) => {
                                    if ($0 >= p.length)
                                        return !0;
                                    Y0.UX = p[$0]
                                }
                                ),
                                    this.Ix?.(p)
                            },
                            Qh: function (p, Y0, $0, D0) {
                                p?.X && (X6(this.o, p),
                                    y?.call(this, p),
                                    this._X?.(p, Y0, $0, D0))
                            },
                            g_: function (p, Y0, $0, D0, M0, y0) {
                                var T = new this.BX.gX;
                                T.X = p,
                                    T.L = Y0,
                                    T.ky = $0,
                                    T.Jy = D0,
                                    T.Qj = M0,
                                    T.Gy = y0,
                                    this.o.push(T),
                                    this.Up?.(T)
                            },
                            _l: function (p, Y0, $0) {
                                var D0 = this.G(p);
                                D0 && (D0.fx = Y0,
                                    this.Ex?.(p, Y0, $0))
                            },
                            G: function (p) {
                                return this.o.find((Y0) => Y0.X == p)
                            },
                            Qy: function (p) {
                                D?.call(this, p)
                            },
                            S: function (p) {
                                p.AY(this.L),
                                    f?.call(this, p)
                            },
                            D: function (p) {
                                this.L = p.gY(),
                                    x?.call(this, p)
                            },
                            gl: function () {
                                var p = 0
                                    , Y0 = U6.j();
                                for (this.S(Y0),
                                    Y0 = Y0.Zh(); Y0._ <= Y0.$.byteLength - 4;)
                                    p ^= Y0.W();
                                return p
                            },
                            A_: function () {
                                var p = U6.j(4);
                                return p.m(this.gl()),
                                    p.wO()
                            },
                            mh: function (p) {
                                this.Al?.(this.gl() != new k0(new DataView(p)).W())
                            },
                            TY: function (p) {
                                return p == 0 || this.G(p)?.oY
                            },
                            dY: function (p) {
                                return p != this.SY && (this.u || (this.u = new this.BX.Rj(this.BX)),
                                    this.SY = p,
                                    d.LY(this.u, this, p)),
                                    this.u
                            }
                        },
                        d
                }
                    ;
                var o0 = V8
                    , { E: C0 } = J
                    , { KO: K0, GO: J0, aO: V0, NO: t } = k
                    , c = 340282366920938463463374607431768211455n;
                function X0() {
                    this.OR = !1,
                        this.value = null,
                        this.HY = null
                }
                function A0() {
                    this.X = null,
                        this.B = null,
                        this.value = null
                }
                function B0() {
                    this.Uj = null,
                        this.HY = null
                }
                function N0() {
                    this.np = null,
                        this.mx = null,
                        this.AX = null,
                        this.Gy = null
                }
                X0.j = function (Q0, W0) {
                    if (Q0 == null)
                        return;
                    let U0 = new X0
                        , y = Q0.__proto__.constructor.name;
                    return U0.OR = y == "BigInt",
                        U0.value = Q0,
                        U0.HY = y != W0?.__proto__.constructor.name ? U0.OR ? c : -1 : W0,
                        U0
                }
                    ,
                    A0.j = function (Q0, W0, U0) {
                        var y = new A0;
                        return y.X = Q0,
                            y.B = W0,
                            y.value = U0,
                            y
                    }
                    ,
                    A0.prototype = {
                        Mp: function () {
                            var Q0 = new A0;
                            return Q0.X = this.X,
                                Q0.B = this.B,
                                Q0.value = this.value.Mp ? this.value.Mp() : this.value,
                                Q0
                        }
                    },
                    B0.j = function (Q0, W0) {
                        var U0 = new B0;
                        return U0.Uj = Q0,
                            U0.HY = W0,
                            U0
                    }
                    ,
                    N0.j = function (Q0, W0, U0, y) {
                        var D = new N0;
                        return D.np = Q0,
                            D.mx = W0,
                            D.AX = U0,
                            D.Gy = y,
                            D
                    }
                    ,
                    N0.prototype = {
                        Mp: function () {
                            var Q0 = new N0;
                            return Q0.np = this.np,
                                Q0.mx = this.mx,
                                Q0.AX = this.AX,
                                Q0.Gy = this.Gy,
                                Q0
                        }
                    },
                    C0(X0, [], ["ipv6", "value", "mask"], []),
                    C0(A0, [], ["id", "type", "value"], []),
                    C0(B0, [], ["ip", "mask"], []),
                    C0(N0, [], ["pId", "pName", "ips", "auth"], []);
                var R0 = function (Q0) {
                    var W0 = []
                        , U0 = 1
                        , y = new Set
                        , D = [];
                    this.RR = (d) => {
                        var p = Q0.SX.get(d?.X)?.py;
                        if (p && !(W0.findIndex(($0) => $0.B == H.wX && $0.value.np == d.X) > -1)) {
                            var Y0 = [];
                            return p.DX && Y0.push(t(p.DX)),
                                p.Np.forEach(($0) => {
                                    Y0.includes($0) || Y0.push($0)
                                }
                                ),
                                Y0.forEach(($0) => {
                                    var D0 = K0($0);
                                    D0 && D.push(X0.j(D0))
                                }
                                ),
                                y.add(d.Gy),
                                W0.push(A0.j(U0, H.wX, N0.j(d.X, d.name, Y0, d.Gy))),
                                U0++
                        }
                    }
                        ,
                        this.Sl = (...d) => d.map((p) => {
                            var Y0 = typeof p;
                            if (Y0 == "string")
                                p = {
                                    Uj: p
                                };
                            else {
                                if (Y0 != "object")
                                    return;
                                p = {
                                    Uj: p.ip,
                                    HY: p.mask
                                }
                            }
                            var $0 = K0(p.Uj);
                            if ($0 == null)
                                return;
                            let D0 = $0.__proto__.constructor.name == "BigInt";
                            var M0 = K0(p.HY);
                            $0.__proto__.constructor.name != M0?.__proto__.constructor.name && (M0 = D0 ? c : -1,
                                p.HY = J0(M0));
                            for (var y0 = 0; y0 < W0.length; y0++) {
                                let T = W0[y0];
                                if (T.B == H.Lp && $0 == K0(T.value.Uj) && M0 == K0(T.value.HY))
                                    return
                            }
                            return D.push(X0.j($0, M0)),
                                W0.push(A0.j(U0, H.Lp, B0.j(p.Uj, p.HY))),
                                U0++
                        }
                        ),
                        this.S_ = (...d) => d.map((p) => {
                            if (!y.has(p))
                                return W0.push(A0.j(U0, H.dp, p)),
                                    y.add(p),
                                    U0++
                        }
                        ),
                        this.Qx = (d) => {
                            let p = K0(d);
                            if (p == null)
                                return !1;
                            let Y0 = p.__proto__.constructor.name == "BigInt";
                            for (var $0 = 0; $0 < D.length; $0++) {
                                let D0 = D[$0];
                                if (Y0 == D0.OR && V0(p, D0.value, D0.HY))
                                    return !0
                            }
                            return !1
                        }
                        ,
                        this.D_ = (d) => y.has(d);
                    let f = (d, p) => {
                        let Y0 = K0(d);
                        if (Y0 == null)
                            return;
                        let $0 = Y0.__proto__.constructor.name == "BigInt";
                        var D0 = K0(p);
                        D0 == null && (D0 = $0 ? c : -1);
                        let M0 = D0 == ($0 ? c : -1);
                        for (var y0 = [], T = 0; T < D.length; T++) {
                            let m = D[T];
                            $0 == m.OR && Y0 == m.value && D0 == m.HY && y0.push(T)
                        }
                        for (; y0.length > 0;)
                            D.splice(y0.pop(), 1);
                        for (y0.length = 0,
                            W0.forEach((m, e) => {
                                M0 && m.B == H.wX && m.value.AX.findIndex((s0) => K0(s0) == Y0) > -1 ? (m.B = H.dp,
                                    m.value = m.value.Gy) : m.B == H.Lp && Y0 == K0(m.value.Uj) && D0 == K0(m.value.HY) && y0.push(e)
                            }
                            ); y0.length > 0;)
                            W0.splice(y0.pop(), 1)
                    }
                        , x = (d) => {
                            y.delete(d);
                            var p = []
                                , Y0 = [];
                            for (W0.forEach(($0, D0) => {
                                $0.B == H.wX && d == $0.value.Gy ? (Y0.splice(Y0.length, 0, ...$0.value.AX),
                                    p.push(D0)) : $0.B == H.dp && d == $0.value && p.push(D0)
                            }
                            ); p.length > 0;)
                                W0.splice(p.pop(), 1);
                            this.Sl(...Y0)
                        }
                        ;
                    this.b_ = (d) => {
                        var p = W0.findIndex((D0) => D0.X == d);
                        if (p < 0)
                            return !1;
                        var { B: Y0, value: $0 } = W0.splice(p, 1)[0];
                        switch (Y0) {
                            case H.wX:
                                $0.AX.forEach((D0) => {
                                    f(D0)
                                }
                                ),
                                    x($0.Gy);
                                break;
                            case H.Lp:
                                f($0.Uj, $0.HY);
                                break;
                            case H.dp:
                                x($0)
                        }
                        return !0
                    }
                        ,
                        this.Fx = (d) => {
                            var p = W0.findIndex(($0) => $0.B == 0 && $0.value?.np == d);
                            if (p < 0)
                                return !1;
                            var { value: Y0 } = W0.splice(p, 1)[0];
                            return Y0.AX.forEach(($0) => {
                                f($0)
                            }
                            ),
                                x(Y0.Gy),
                                !0
                        }
                        ,
                        this.J_ = () => {
                            y.clear(),
                                D.length = 0,
                                W0.length = 0
                        }
                        ,
                        this.Z_ = () => W0.map((d) => d.Mp())
                }
                    , $8 = W(function (Q0) {
                        function W0(U0) {
                            this.xR = !0,
                                U0.Dl(),
                                this.fy = U0.fy,
                                this.Mj = U0.Mj,
                                this.Np = U0.Np,
                                this.DX = U0.DX,
                                this.bl = J.cy.now();
                            var y, D = this;
                            (y = function () {
                                var f = 1e4 - (J.cy.now() - D.bl);
                                f <= 0 ? console.log("test") : (J._Y(D.Jl),
                                    D.Jl = J.hY(y, f + 1000))
                            }
                            )(),
                                this.fy.oniceconnectionstatechange = function () {
                                    var f = D.fy.iceConnectionState;

                                    console.log("icechange", f);
                                    f != "closed" && f != "failed" || D.Xy()
                                }
                                ,
                                this.fy.onicecandidateerror = function (e) {
                                    //console.log("error", e)
                                }
                                ,
                                this.Mj.forEach((f) => {
                                    f.onmessage = function (x) {
                                        D.xR && (D.bl = J.cy.now(),
                                            D.QX?.(x.data))
                                    }
                                        ,
                                        f.onerror = function (e) {
                                            //console.log(e)
                                        },
                                        f.onclose = function () {
                                            D.Xy()
                                        }
                                }
                                )
                        }
                        W0.prototype = {
                            DY: function (U0, y) {
                                if (this.xR) {
                                    var D = this.Mj[U0];
                                    if (D.readyState == "open")
                                        try {
                                            D.send(y.wO())
                                        } catch { }
                                }
                            },
                            Xy: function () {
                                J._Y(this.Jl),
                                    this.xR && (this.xR = !1,
                                        this.fy.close(),
                                        this.zR?.())
                            }
                        },
                            Q0.bL = Q0.f_ || (Q0.f_ = {
                                Zl: [{
                                    L: "c1",
                                    Ux: !0,
                                    Mx: !0
                                }, {
                                    L: "c2",
                                    Ux: !0,
                                    Mx: !1
                                }, {
                                    L: "c3",
                                    Ux: !1,
                                    Mx: !1
                                }],
                                fl: W0
                            })
                    })
                    , { E: N8 } = J
                    , { nO: a } = k;
                function q0(Q0, W0, U0) {
                    this.KX = null,
                        this.DX = null,
                        this.Np = [],
                        this.Ll = 0,
                        this.dl = !1,
                        this.lR = [],
                        this.Mj = [],
                        this.fy = W0 && new J.iz({
                            iceServers: W0
                        }, q0.L_);
                    var y = this;
                    this.nx = new Promise((D) => {
                        y.d_ = D
                    }
                    ),
                        this.X = Q0,
                        W0 && (this.fy.onicecandidate = function (D) {
                            D.candidate ? (D = D.candidate).candidate && (y.Nx?.(D),
                                y.lR.push(D)) : y.d_(y.lR)
                        }
                            ,
                            U0.forEach((D) => y.e_(D)))
                }
                q0.L_ = {
                    mandatory: {
                        OfferToReceiveAudio: !1,
                        OfferToReceiveVideo: !1
                    }
                },
                    q0.prototype = {
                        Vx: function (Q0 = 1e4) {
                            J._Y(this.KX),
                                this.KX = J.hY(this.rR.bind(this), Q0)
                        },
                        k_: function (Q0, W0) {
                            var U0 = this;
                            this.el(this.fy.setRemoteDescription(Q0).then(() => U0.fy.createAnswer()), W0, 500)
                        },
                        $_: function () {
                            this.el(this.fy.createOffer(), [], 1000)
                        },
                        el: function (Q0, W0, U0) {
                            var y = this;
                            Q0.then((D) => y.fy.setLocalDescription(D).then(() => D)).then((D) => (W0.forEach((f) => y.kl(f)),
                                a(y.nx, U0).then(() => D, () => D))).then((D) => {
                                    y.Vp(D)
                                }
                                ).catch(() => {
                                    y.iR()
                                }
                                )
                        },
                        e_: function (Q0) {
                            var W0 = this
                                , U0 = {
                                    id: this.Mj.length,
                                    negotiated: !0,
                                    ordered: Q0.Mx
                                };
                            Q0.Ux || (U0.maxRetransmits = 0);
                            var y = this.fy.createDataChannel(Q0.L, U0);
                            y.binaryType = "arraybuffer",
                                y.onopen = function () {
                                    W0.Mj.find((D) => D.readyState != "open") || W0.Bp?.()
                                }
                                ,
                                y.onclose = this.iR,
                                y.onmessage = this.iR,
                                this.Mj.push(y)
                        },
                        kl: function (Q0, W0) {
                            var U0 = this;
                            J.hY(() => {
                                U0.fy?.addIceCandidate(Q0).catch((y) => W0?.(y))
                            }
                                , this.Ll)
                        },
                        rR: function () {
                            this.iR()
                        },
                        iR: function () {
                            this.GX?.(),
                                this.Xy?.()
                        },
                        Xy: function () {
                            if (this.fy) {
                                this.Dl();
                                var Q0 = this.fy;
                                this.fy = null,
                                    Promise.resolve().then(() => Q0.close())
                            }
                        },
                        Dl: function () {
                            J._Y(this.KX),
                                this.Vp = this.Bp = this.Nx = this.GX = null,
                                this.fy.onicecandidate = null,
                                this.fy.onicecandidateerror = null,
                                this.fy.ondatachannel = null,
                                this.fy.onsignalingstatechange = null,
                                this.fy.oniceconnectionstatechange = null,
                                this.Mj.forEach((Q0) => {
                                    Q0.onopen = null,
                                        Q0.onclose = null,
                                        Q0.onmessage = null
                                }
                                )
                        }
                    },
                    N8(q0, [], [null, null, null, null, null, null, null, null, null, "id"], []);
                var H0 = q0
                    , { V: p0 } = o
                    , { Vy: w8 } = j
                    , { cp: y8, Ej: j8, mj: k8, qh: W8, Th: P6, FO: g7, jj: j9, VO: Z0, op: G0 } = k
                    , { RX: z8 } = F0
                    , { Zl: Z8, fl: G8 } = $8
                    , t0 = function (Q0) {
                        function W0(D, f) {
                            this.eY = D,
                                this.Bx = !1,
                                this.aX = !1,
                                this.hR = !1,
                                this.nj = null,
                                this.X = "",
                                this.Kx = null,
                                this.bX = new Map,
                                this.CY = f || "",
                                this._R()
                        }
                        function U0(D) {
                            this.cl = new W8(15),
                                this.R5 = 0,
                                this.ol = new Map,
                                this.t_ = new P6(100, 16),
                                this.Cj = !1,
                                this.UX = 0,
                                this.py = D;
                            var f = k8.j(8);
                            f.J(Math.random()),
                                this.Gp = f.my()
                        }
                        function y(D, f) {
                            this.gR = D,
                                this.PY = null,
                                this.JX = 32,
                                this.SX = new Map,
                                this.kY = [],
                                this.Nj = S1.baseInputDelayFrames,
                                this.W_ = 600,
                                K6.call(this, f),
                                this.w_ = 1,
                                this.Hl = 0,
                                this.uX = !1,
                                this.AR = !0,
                                this.ap = null,
                                this.yp = null,
                                this.ZX = 0,
                                this.Yy = null,
                                this.Dy = null
                        }
                        return W0.$l = function (D) {
                            try {
                                if ((D = D.candidate.split(" "))[6] != "typ")
                                    throw null;
                                if (D[7] == "srflx")
                                    return D[4]
                            } catch { }
                            return null
                        }
                            ,
                            W0.prototype = {
                                Xy: function () {
                                    if (J._Y(this.Kx),
                                        J._Y(this.vX),
                                        this.vX = null,
                                        J.Dp(this.ql),
                                        this.yy != null)
                                        try {
                                            this.yy.onmessage = null,
                                                this.yy.onerror = null,
                                                this.yy.onclose = null,
                                                this.yy.onopen = null,
                                                this.yy.close(),
                                                this.yy = null
                                        } catch { }
                                    this.Cl()
                                },
                                Gx: function (D) {
                                    if (this.nj || D) {
                                        var f = this;
                                        if (this.nj != null && D != null && this.nj.byteLength == D.byteLength) {
                                            var x = new Uint8Array(this.nj)
                                                , d = new Uint8Array(D);
                                            if (x.findIndex((p, Y0) => p != d[Y0]) < 0)
                                                return
                                        }
                                        this.nj = D.slice(0),
                                            this.hR = !0,
                                            this.yy != null && this.yy.readyState == 1 && !this.vX && (this.ax(),
                                                this.vX = J.hY(function () {
                                                    f.vX = null,
                                                        f.yy.readyState == 1 && f.hR && f.ax()
                                                }, 1e4))
                                    }
                                },
                                vx: function (D) {
                                    var f = this;
                                    function x() {
                                        f.yy != null && f.yy.readyState == 1 && f.aX != f.Bx && f.Tl(),
                                            f.Pl = null
                                    }
                                    this.aX = D,
                                        !this.Pl && (x(),
                                            this.Pl = J.hY(x, 1000))
                                },
                                _R: function (D) {
                                    var f = this;
                                    u.Dx({
                                        OY: f.eY.Dy.OY,
                                        CY: D || this.CY || ""
                                    }, (x, d) => {
                                        if (f.eY.gR.useRecaptchaToken = null,
                                            !x || !d)
                                            throw null;
                                        J.qY?.fp && (x = J.qY?.fp),
                                            x.endsWith("host") || (x.endsWith("/") || (x += "/"),
                                                x += "host"),
                                            f.yy = u.Ol({
                                                Xl: x,
                                                CY: d,
                                                pl: Q0?.(f.eY.Dy) || [],
                                                OY: f.eY.Dy.OY,
                                                Wh: {
                                                    "Cache-control": "no-cache",
                                                    Pragma: "no-cache",
                                                    "User-agent": "Mozilla/5.0 (globals NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36"
                                                },
                                                EX: function () {
                                                    f.q_()
                                                },
                                                nY: function (p) {
                                                    f.Kp(p.code != 4001)
                                                },
                                                mX: function (p) {
                                                    f.Kp(!0),
                                                        f.eY.Dy.nY?.(w8(H.Yx, p))
                                                },
                                                QX: f.sx.bind(f)
                                            })
                                    }
                                        , (x) => {
                                            if (!x)
                                                throw null;
                                            f.eY.gR.useRecaptchaToken = (d) => {
                                                f.eY.gR.useRecaptchaToken = null,
                                                    f._R(d)
                                            }
                                                ,
                                                f.Kp(!1),
                                                f.eY.Dy.nY?.(w8(H.yx, x))
                                        }
                                    ).catch(function (x) {
                                        f.eY.gR.useRecaptchaToken = null,
                                            f.Kp(!0),
                                            f.eY.Dy.nY?.(w8(H.Yx, x))
                                    })
                                },
                                q_: function () {
                                    var D = this;
                                    this.nj != null && this.ax(),
                                        this.aX != 0 && this.Tl(),
                                        this.ql = J.cO(function () {
                                            D.C_()
                                        }, 40000)
                                },
                                sx: function (D) {
                                    var f = new j8(new DataView(D.data), !1);
                                    switch (f.q()) {
                                        case 1:
                                            this.ux(f);
                                            break;
                                        case 4:
                                            this.y5(f);
                                            break;
                                        case 5:
                                            this.T_(f);
                                            break;
                                        case 6:
                                            this.P_(f);
                                            break;
                                        case 111:
                                            this.c_(f)
                                    }
                                },
                                c_: function (D, f) {
                                    var x = this;
                                    J.hY(() => {
                                        try {
                                            x.eY.Dy?.state._l(D.ry(), D.$p())
                                        } catch {
                                            f && x.sX(f, 4111)
                                        }
                                    }
                                        , 3000)
                                },
                                ux: function (D) {
                                    var f = D.ry()
                                        , x = Z0(D.Uy(D.q()));
                                    try {
                                        var d = (D = new j8(new DataView(J.Ny.inflateRaw(D.Uy()).buffer), !1)).q() != 0
                                            , p = D.ZY()
                                            , Y0 = [];
                                        D.$p().forEach(($0) => Y0.push(new J.Zp($0))),
                                            this.o_(f, x, p, Y0, D, d)
                                    } catch {
                                        this.sX(f, 0)
                                    }
                                },
                                o_: function (D, f, x, d, p, Y0) {
                                    var $0 = this;
                                    if (this.bX.size >= 16)
                                        this.sX(D, 4104);
                                    else if (this.tY.Qx(f))
                                        this.sX(D, 4102);
                                    else {
                                        for (var D0 = [], M0 = 0; M0 < d.length; M0++) {
                                            var y0 = W0.$l(d[M0]);
                                            if (y0 != null) {
                                                if (this.tY.Qx(y0))
                                                    return void this.sX(D, 4102);
                                                D0.push(y0)
                                            }
                                        }
                                        var T = this.Y5?.(p);
                                        if (T == null) {
                                            var m = new H0(D, J.KR, Z8);
                                            for (Y0 && (m.Ll = 2500),
                                                m.Np = D0,
                                                m.DX = "",
                                                M0 = 0; M0 < f.length; M0++)
                                                m.DX += G0(f.charCodeAt(M0));
                                            this.bX.set(D, m),
                                                m.GX = () => {
                                                    $0.qj(0, m, null),
                                                        $0.bX.delete(m.X)
                                                }
                                                ,
                                                m.Bp = () => {
                                                    $0.bX.delete(m.X),
                                                        $0.qj(0, m, null),
                                                        $0.j5?.(new G8(m))
                                                }
                                                ,
                                                m.Vp = (e) => {
                                                    $0.X5(m, e, m.lR, null),
                                                        m.nx.then(() => {
                                                            $0.qj(0, m, null)
                                                        }
                                                        ),
                                                        m.Nx = (s0) => {
                                                            $0.p5(m, s0)
                                                        }
                                                }
                                                ,
                                                m.Vx(),
                                                m.k_(new J.aR({
                                                    sdp: x,
                                                    type: "offer"
                                                }), d)
                                        } else
                                            this.sX(D, T)
                                    }
                                },
                                y5: function (D) {
                                    var f, x = D.ry();
                                    try {
                                        D = new j8(new DataView(J.Ny.inflateRaw(D.Uy()).buffer), !1),
                                            f = new J.Zp(D.$p())
                                    } catch {
                                        return
                                    }
                                    this.H_(x, f)
                                },
                                H_: function (D, f) {
                                    var x = this.bX.get(D);
                                    if (x) {
                                        var d = W0.$l(f);
                                        d != null && (x.Np.push(d),
                                            this.tY.Qx(d)) || x.kl(f)
                                    }
                                },
                                T_: function (D) {
                                    this.X = D.pX(D.q()),
                                        this.O5?.(this.X)
                                },
                                P_: function (D) {
                                    this.CY = D.pX(D.$.byteLength - D._)
                                },
                                qj: function (D, f, x) {
                                    if (!f.dl) {
                                        D == 0 && (f.dl = !0);
                                        var d = k8.j(32, !1);
                                        d.g(D),
                                            d.ey(f.X),
                                            x != null && d.sy(J.Ny.deflateRaw(x.my())),
                                            this.yy.send(d.OX())
                                    }
                                },
                                sX: function (D, f) {
                                    var x = k8.j(16, !1);
                                    x.g(0),
                                        x.ey(D),
                                        x.My(f),
                                        this.yy.send(x.OX())
                                },
                                C_: function () {
                                    var D = k8.j(1, !1);
                                    D.g(8),
                                        this.yy.send(D.OX())
                                },
                                ax: function () {
                                    this.hR = !1;
                                    var D = k8.j(256, !1);
                                    D.g(7),
                                        this.nj != null && D.IO(this.nj),
                                        this.yy.send(D.OX())
                                },
                                Tl: function () {
                                    var D = k8.j(2, !1);
                                    D.g(this.eY.Dy?.NY),
                                        D.g(this.aX ? 1 : 0),
                                        this.yy.send(D.OX()),
                                        this.Bx = this.aX,
                                        this.eY.Dy?._onRoomRecaptchaModeChange?.(this.aX)
                                },
                                X5: function (D, f, x, d) {
                                    var p = k8.j(32, !1);
                                    p.fY(f.sdp),
                                        p.mO(x),
                                        d != null && p.sy(d.my()),
                                        this.qj(1, D, p)
                                },
                                p5: function (D, f) {
                                    var x = k8.j(32, !1);
                                    x.mO(f),
                                        this.qj(4, D, x)
                                },
                                Cl: function () {
                                    for (var D of this.bX)
                                        D[1].Xy();
                                    this.bX.clear()
                                },
                                Kp: function (D) {
                                    this.Cl(),
                                        J._Y(this.vX),
                                        this.vX = null,
                                        this.hR = !1,
                                        J.Dp(this.ql),
                                        J._Y(this.Kx);
                                    var f = this;
                                    D && (this.Kx = J.hY(() => f._R(), 20000))
                                }
                            },
                            U0.prototype = {
                                DY: function (D, f = 0) {
                                    this.py.DY(f, D)
                                }
                            },
                            y.prototype = j9(K6.prototype, {
                                fX: function (D) {
                                    this.ZX = J.cy.now(),
                                        this.Yy = new W0(this, D),
                                        this.Yy.tY = new R0(this),
                                        this.Yy.Y5 = this.Y5.bind(this);
                                    var f = this;
                                    this.Yy.j5 = function (x) {
                                        f.j5(x)
                                    }
                                        ,
                                        this.Yy.O5 = function (x) {
                                            f.O5?.(x)
                                        }
                                },
                                Xy: function () {
                                    this.Yy.Xy(),
                                        this.kY.forEach(({ py: D }) => {
                                            D.zR = null,
                                                D.QX = null,
                                                D.Xy()
                                        }
                                        ),
                                        this.Dy = null
                                },
                                I_: function (D, f, x, d) {
                                    var p = this.SX.get(D.X);
                                    if (p) {
                                        d && this.Yy.tY.RR(D);
                                        var Y0 = k8.j();
                                        Y0.g(5),
                                            Y0.g(d ? 1 : 0),
                                            Y0.fY(f),
                                            Y0.fY(x || ""),
                                            p.DY(Y0),
                                            p.py.Xy()
                                    }
                                },
                                E_: function () {
                                    this.Yy.tY.J_() && this.Dy?._onBansClear?.()
                                },
                                m_: function (D) {
                                    this.Yy.tY.Fx(D) && this.Dy?._onBanClear?.(D)
                                },
                                Q_: function (D) {
                                    return this.Yy.tY.RR(D)
                                },
                                F_: function (...D) {
                                    return this.Yy.tY.Sl(...D)
                                },
                                U_: function (...D) {
                                    return this.Yy.tY.S_(...D)
                                },
                                M_: function (D) {
                                    return this.Yy.tY.b_(D)
                                },
                                Gx: function (D) {
                                    this.Yy.Gx(D)
                                },
                                vx: function (D) {
                                    this.Yy.vx(D)
                                },
                                kj: function (D) {
                                    D.Zy = D.Xj.jy ? this.f + this.Nj + this.cY : this.f,
                                        this.a(D),
                                        this.SR(!0),
                                        this.kY.length > 0 && this.vp(this.DR(D), 1)
                                },
                                tl: function (D, f, x) {
                                    if (D.p = f,
                                        x)
                                        D.H(this.O),
                                            this.n_(D, 1);
                                    else {
                                        if (this.kY.length == 0)
                                            return;
                                        D.Zy = D.Xj.jy ? this.f + this.Nj + this.cY : this.f,
                                            this.a(D),
                                            this.SR(),
                                            this.vp(this.DR(D), 1)
                                    }
                                },
                                x5: function (D, f, x) {
                                    if (f != 0) {
                                        var d = this.SX.get(f);
                                        if (d) {
                                            x || (D.p = 0);
                                            var p = k8.j();
                                            p.g(6),
                                                p0.S(D, p),
                                                d.DY(p, 0)
                                        }
                                    } else
                                        D.H(this.O)
                                },
                                Fy: function () {
                                    var D = ((J.cy.now() - this.ZX) * this.BY | 0) - this.f;
                                    D > 0 && this.ll(D),
                                        this.f - this.Wl >= 7 && this.SR(!0),
                                        this.f - this.Hl >= this.W_ && (this.SR(!0),
                                            this.N_())
                                },
                                zj: function (D = 0) {
                                    return this.cY < 0 && (this.cY = 0),
                                        rL((J.cy.now() - this.ZX + D) * this.BY - this.f + this.Nj + this.cY, this)
                                },
                                Y5: function (D) {
                                    if (!this.uX && this.kY.length >= this.JX)
                                        return 4100;
                                    try {
                                        if (D.By() != this.Dy?.NY)
                                            throw null
                                    } catch {
                                        return 4103
                                    }
                                    try {
                                        var f = D.gY();
                                        if (this.PY != null && f != this.PY)
                                            throw null
                                    } catch {
                                        return 4101
                                    }
                                },
                                j5: function (D) {
                                    var f = this;
                                    if (!this.uX && this.kY.length >= this.JX)
                                        D.Xy();
                                    else {
                                        var x = new U0(D);
                                        this.kY.push(x),
                                            D.QX = (p) => {
                                                f.V_(new j8(new DataView(p)), x)
                                            }
                                            ,
                                            D.zR = () => {
                                                y8(f.kY, x),
                                                    f.SX.delete(x.X),
                                                    f._X?.(x.X)
                                            }
                                            ;
                                        var d = k8.j(x.Gp.byteLength + 1);
                                        d.g(0),
                                            d.oy(x.Gp.byteLength),
                                            d.sy(x.Gp),
                                            x.DY(d)
                                    }
                                },
                                DR: function (D) {
                                    var f = k8.j();
                                    return f.g(2),
                                        this.z5(D, f),
                                        f
                                },
                                z5: function (D, f) {
                                    f.ey(D.Zy),
                                        f.oy(D.YY),
                                        f.My(D.p),
                                        f.ey(D.iX),
                                        p0.S(D, f)
                                },
                                SR: function (D) {
                                    if (!(this.f <= this.Wl || this.kY.length == 0)) {
                                        var f = k8.j();
                                        f.g(3),
                                            f.ey(this.f),
                                            f.ey(this.hX),
                                            this.vp(f, 2),
                                            D && this.B_?.(f),
                                            this.Wl = this.f
                                    }
                                },
                                vp: function (D, f = 0) {
                                    this.kY.forEach((x) => {
                                        x.Cj && x.DY(D, f)
                                    }
                                    )
                                },
                                n_: function (D) {
                                    var f = k8.j();
                                    f.g(6),
                                        p0.S(D, f);
                                    var x = this.Dy.sp;
                                    this.kY.forEach((d) => {
                                        d.Cj && x.has(d.X) && d.DY(f, 0)
                                    }
                                    )
                                },
                                K_: function (D) {
                                    var f = k8.j();
                                    f.g(1);
                                    var x = k8.j();
                                    x.My(D.X),
                                        x.ey(this.f),
                                        x.ey(this.hX),
                                        x.oy(this.RY),
                                        this.O.S(x);
                                    var d = this;
                                    this.dj.uy.forEach((p) => {
                                        d.z5(p, x)
                                    }
                                    ),
                                        f.sy(J.Ny.deflateRaw(x.my())),
                                        D.DY(f)
                                },
                                G_: function (D) {
                                    D.ey(this.f),
                                        D.ey(this.hX),
                                        D.oy(this.RY),
                                        this.O.S(D);
                                    var f = this;
                                    this.dj.uy.forEach((x) => {
                                        f.z5(x, D)
                                    }
                                    )
                                },
                                a_: function (D) {
                                    var f = this;
                                    J.hY(() => {
                                        f.O.o.forEach((x) => {
                                            x.fx && f.Dy.setPlayerIdentity(x.X, x.fx, D.X)
                                        }
                                        )
                                    }
                                        , 3000)
                                },
                                N_: function () {
                                    if (this.Hl = this.f,
                                        this.kY.length != 0) {
                                        var D = z8.j(this.O.A_());
                                        D.Zy = this.f,
                                            D.YY = this.RY++,
                                            D.p = 0,
                                            this.vp(this.DR(D))
                                    }
                                },
                                v_: function (D, f) {
                                    var x = this
                                        , d = D.Uy(D.Ey())
                                        , p = D.Uy(D.Ey())
                                        , Y0 = f.Gp;
                                    f.Gp = null,
                                        n.oh(d, Y0).catch(() => null).then(($0) => {
                                            try {
                                                if (x.Yy.tY.D_($0))
                                                    throw w8(H.nz, $0);
                                                if (x.kY.indexOf(f) < 0)
                                                    return;
                                                var D0 = x.w_++;
                                                f.X = D0,
                                                    x.SX.set(D0, f),
                                                    (x.Up?.(D0, new j8(new DataView(p.buffer, p.byteOffset, p.byteLength), !1), f.py.DX, $0)),
                                                    f.Cj = !0,
                                                    x.K_(f),
                                                    x.a_(f)
                                            } catch (M0) {
                                                x.mX(f, M0)
                                            }
                                        }
                                        )
                                },
                                V_: function (D, f) {
                                    this.Fy();
                                    try {
                                        if (!f.t_.jl())
                                            throw 1;
                                        var x = D.q();
                                        if (f.Cj)
                                            switch (x) {
                                                case 1:
                                                    this.s_(D, f);
                                                    break;
                                                case 2:
                                                    this.u_(D, f);
                                                    break;
                                                default:
                                                    throw 0
                                            }
                                        else {
                                            if (x != 0)
                                                throw 0;
                                            this.v_(D, f)
                                        }
                                        if (D.$.byteLength > D._)
                                            throw 2
                                    } catch (d) {
                                        this.mX(f, d)
                                    }
                                },
                                mX: function (D, f) {
                                    this.yg?.(f, D.X),
                                        this.SX.delete(D.X),
                                        y8(this.kY, D),
                                        D.Cj && this.Yg?.(D.X),
                                        D.py.Xy()
                                },
                                u_: function (D, f) {
                                    var x = D.d()
                                        , d = this.Dy?._modifyPlayerPing;
                                    d && (f.UX = d(f.X, D.Ey()));
                                    var p = k8.j();
                                    p.g(4),
                                        p.J((J.cy.now() - this.ZX) * this.BY + this.Nj),
                                        p.J(x),
                                        f.DY(p, 2)
                                },
                                s_: function (D, f) {
                                    var x = D.ry()
                                        , d = D.ry()
                                        , p = p0.D(D)
                                        , Y0 = p.Xj.bR;
                                    if (Y0 != null) {
                                        var $0 = f.ol.get(Y0);
                                        if ($0 || ($0 = new P6(Y0.JR, Y0.ZR),
                                            f.ol.set(Y0, $0)),
                                            !$0.jl())
                                            throw 3
                                    }
                                    var D0 = g7(x, this.f, this.f + 20);
                                    if (p.Xj.jy) {
                                        var M0 = this.f + this.Nj
                                            , y0 = x - M0;
                                        y0 < -this.Nj - 3 ? D0 = M0 : f.cl.Lh(g7(y0, -this.Nj, this.Nj)),
                                            D0 < M0 && f.cl.dh() < -0.85 && (D0 = M0),
                                            D0 < f.R5 && (D0 = f.R5),
                                            f.R5 = D0
                                    }
                                    p.p = f.X,
                                        p.iX = d,
                                        p.Zy = D0,
                                        this.Dy?.jg(p, x) && (this.a(p),
                                            this.vp(this.DR(p), 1))
                                }
                            }),
                            y
                    }
                    , { _z: e8, gz: m7, Az: L7, Sz: fJ, Dz: B9 } = H
                    , f6 = H
                    , { V: IJ } = o
                    , { Vy: J7 } = j
                    , { Ej: Y5, mj: hJ, Ch: N1, jj: y4 } = k
                    , { Zl: f4, fl: T6 } = $8
                    , R7 = {
                        4001: f6.Zz,
                        4004: f6.yx,
                        4100: f6.fz,
                        4101: f6.Lz,
                        4102: f6.dz,
                        4103: f6.ez
                    }
                    , x8 = function (Q0) {
                        function W0(y, D, f, x) {
                            this.Dy = y,
                                this.Cj = !1,
                                this.up = !1;
                            var d = this;
                            this.py = new H0(0, J.KR, f4),
                                this.py.GX = function () {
                                    d.yO(J7(f6.kz))
                                }
                                ,
                                this.py.Bp = function () {
                                    d.Bp?.(new T6(d.py)),
                                        d.py = null,
                                        d.rR()
                                }
                                ,
                                this.py.Vp = function (p) {
                                    d.wl = p;
                                    var Y0 = J.qY?.fp || J.xz;
                                    Y0.endsWith("client") || (Y0.endsWith("/") || (Y0 += "/"),
                                        Y0 += "client");
                                    var $0 = Q0?.(y.Dy) || [];
                                    if (y.OY || J.qY?.HO) {
                                        var D0 = {}
                                            , M0 = {
                                                "Cache-control": "no-cache",
                                                Pragma: "no-cache",
                                                "User-agent": "Mozilla/5.0 (globals NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36"
                                            };
                                        y.OY && (D0.agent = y.OY),
                                            J.qY.HO && Object.assign(M0, {
                                                Origin: (J.JY.tX ? "https" : "http") + "://" + J.JY.Sp
                                            }),
                                            D0.headers = M0,
                                            d.yy = new J.Jp(Y0 + "?id=" + D + (x == null ? "" : "&token=" + x), $0, D0)
                                    } else
                                        d.yy = new J.Jp(Y0 + "?id=" + D + (x == null ? "" : "&token=" + x), $0);
                                    d.yy.binaryType = "arraybuffer",
                                        d.yy.onclose = function (y0) {
                                            var T;
                                            d.Cj || d.yO((T = y0.code,
                                                R7[T] ? J7(R7[T]) : J7(f6.tO, T)))
                                        }
                                        ,
                                        d.yy.onerror = function (y0) {
                                            d.Cj || d.yO(J7(f6.uR))
                                        }
                                        ,
                                        d.yy.onmessage = d.sx.bind(d),
                                        d.yy.onopen = function () {
                                            d.Xg?.(),
                                                d.py.Vx(),
                                                d.X5(d.wl, d.py.lR, f),
                                                d.py.Nx = d.p5.bind(d),
                                                d.py.nx.then(function () {
                                                    d.qj(0, null)
                                                })
                                        }
                                }
                                ,
                                this.py.$_()
                        }
                        function U0(y, D) {
                            this.l5 = [],
                                this.YO = [],
                                this.fR = new R6,
                                this.Og = 1,
                                this.Il = 0,
                                this.LX = null,
                                this.r5 = new N1(50),
                                this.LR = new N1(50),
                                this.Rg = 1000,
                                K6.call(this, y),
                                this.dR = null,
                                this.xg = D,
                                this.Dy = null
                        }
                        return W0.prototype = {
                            pg: function () {
                                this.yO(J7(f6.sR))
                            },
                            rR: function () {
                                if (this.yy != null)
                                    try {
                                        this.yy.onclose = null,
                                            this.yy.onmessage = null,
                                            this.yy.onerror = null,
                                            this.yy.onopen = null,
                                            this.yy.close(),
                                            this.yy = null
                                    } catch { }
                                this.py != null && (this.py.Xy(),
                                    this.py = null)
                            },
                            yO: function (y) {
                                this.GX?.(y),
                                    this.rR()
                            },
                            sx: function (y) {
                                var D = new Y5(new DataView(y.data))
                                    , f = D.q();
                                switch (D.$.byteLength > D._ && (D = new Y5(new DataView(J.Ny.inflateRaw(D.Uy()).buffer), !1)),
                                f) {
                                    case 1:
                                        var x = []
                                            , d = D.ZY();
                                        D.$p().forEach((p) => {
                                            x.push(new J.Zp(p))
                                        }
                                        ),
                                            this.ux(d, x);
                                        break;
                                    case 4:
                                        this.y5(new J.Zp(D.$p()))
                                }
                            },
                            ux: function (y, D) {
                                var f = this;
                                this.py.Vx(this.up ? 1e4 : 4000),
                                    this.Cj = !0,
                                    this.Vp?.(),
                                    this.py.fy.setRemoteDescription(new J.aR({
                                        sdp: y,
                                        type: "answer"
                                    }), () => {
                                        D.forEach((x) => {
                                            f.py.fy?.addIceCandidate(x).catch(() => { }
                                            )
                                        }
                                        )
                                    }
                                        , () => {
                                            f.yO(J7(f6.uR))
                                        }
                                    )
                            },
                            y5: function (y) {
                                this.py.fy?.addIceCandidate(y).catch(() => { }
                                )
                            },
                            qj: function (y, D) {
                                if (this.yy) {
                                    var f = hJ.j(32, !1);
                                    f.g(y),
                                        D != null && f.sy(J.Ny.deflateRaw(D.my())),
                                        this.yy.send(f.OX())
                                }
                            },
                            X5: function (y, D, f) {
                                var x = hJ.j(32, !1);
                                x.g(this.up ? 1 : 0),
                                    x.fY(y.sdp),
                                    x.mO(D),
                                    f != null && x.sy(f.my()),
                                    this.qj(1, x)
                            },
                            p5: function (y) {
                                var D = hJ.j(32, !1);
                                D.mO(y),
                                    this.qj(4, D)
                            }
                        },
                            U0.prototype = y4(K6.prototype, {
                                fX: function (y, D, f, x) {
                                    var d = this;
                                    this.jO(e8);
                                    var p = hJ.j();
                                    p.My(this.Dy.NY),
                                        p.AY(D),
                                        this.Yy = new W0(this, y, p, f),
                                        this.Yy.up = x,
                                        this.Yy.Bp = function ($0) {
                                            d.Yy = null,
                                                d.py = $0,
                                                $0.QX = function (D0) {
                                                    d.zg(new Y5(new DataView(D0)))
                                                }
                                                ,
                                                $0.zR = function () {
                                                    d.LX != fJ && d.XO?.(J7(f6.tO)),
                                                        d.Xy()
                                                }
                                                ,
                                                d.KX = J.hY(function () {
                                                    d.XO?.(J7(f6.Jz)),
                                                        d.Xy()
                                                }, 1e4),
                                                d.jO(L7, d.py.fy.remoteDescription.sdp)
                                        }
                                        ,
                                        this.Yy.Xg = function () {
                                            d.jO(m7, d.Yy.wl.sdp)
                                        }
                                        ;
                                    var Y0 = !1;
                                    this.Yy.Vp = function () {
                                        Y0 = !0
                                    }
                                        ,
                                        this.Yy.GX = function ($0) {
                                            !x && d.LX == m7 && Y0 ? (d.Dy.eR?.(f6.hz),
                                                d.fX(y, D, f, !0)) : (d.Yy.GX = null,
                                                    d.XO?.($0),
                                                    d.Xy($0))
                                        }
                                },
                                Xy: function (y) {
                                    this.Yy != null && (this.Yy.pg(),
                                        this.Yy = null),
                                        J._Y(this.KX),
                                        this.py != null && (this.py.zR = null,
                                            this.py.Xy(),
                                            this.py = null),
                                        this.jO(B9, y || J7(f6.tO)),
                                        this.Dy = null
                                },
                                jO: function (y, D) {
                                    this.LX != y && (this.LX = y,
                                        this.Dy.eR?.(y, D),
                                        this.Yp?.(y, D))
                                },
                                El: function () {
                                    return this.LX == fJ
                                },
                                Fy: function () {
                                    this.El() && J.cy.now() - this.Il > this.Rg && this.lg(),
                                        this.lj = J.cy.now() * this.BY + this.r5.QO(0.5) - this.f,
                                        this.ml()
                                },
                                zj: function (y = 0) {
                                    return this.El() ? (this.cY < 0 && (this.cY = 0),
                                        rL((J.cy.now() + y) * this.BY + this.r5.QO(0.5) - this.f + this.cY, this, this.fR)) : this.O
                                },
                                ml: function () {
                                    this.lj < 0 && (this.lj = 0),
                                        this.lj > this.jR && (this.lj = this.jR)
                                },
                                zg: function (y) {
                                    switch (y.q()) {
                                        case 0:
                                            this.rg(y);
                                            break;
                                        case 1:
                                            this.ig(y);
                                            break;
                                        case 2:
                                            this.hg(y);
                                            break;
                                        case 3:
                                            this._g(y);
                                            break;
                                        case 4:
                                            this.gg(y);
                                            break;
                                        case 5:
                                            this.Ag(y);
                                            break;
                                        case 6:
                                            this.Sg(y)
                                    }
                                },
                                rg: function (y) {
                                    var D = this
                                        , f = y.Uy(y.Ey());
                                    (this.xg?.th(f) || Promise.resolve(null)).catch(() => null).then((x) => {
                                        D.Dg(x)
                                    }
                                    )
                                },
                                ig: function (y) {
                                    var D = J.Ny.inflateRaw(y.Uy());
                                    for (y = new Y5(new DataView(D.buffer, D.byteOffset, D.byteLength)),
                                        this.ej = y.By(),
                                        this.f = y.ry(),
                                        this.hX = y.ry(),
                                        this.RY = y.Ey(),
                                        this.lj = 10,
                                        this.O.D(y); y._ < y.$.byteLength;)
                                        this.a(this.Ql(y));
                                    J._Y(this.KX),
                                        this.jO(fJ)
                                },
                                Dg: function (y) {
                                    var D = hJ.j();
                                    D.g(0),
                                        y ? (D.oy(y.byteLength),
                                            D.sy(y)) : D.oy(0),
                                        D.oy(this.dR.byteLength),
                                        D.IO(this.dR),
                                        this.DY(D),
                                        this.dR = null
                                },
                                DY: function (y, D = 0) {
                                    this.py.DY(D, y)
                                },
                                Ql: function (y) {
                                    var D = y.ry()
                                        , f = y.Ey()
                                        , x = y.By()
                                        , d = y.ry()
                                        , p = IJ.D(y);
                                    return p.p = x,
                                        p.iX = d,
                                        p.Zy = D,
                                        p.YY = f,
                                        p
                                },
                                hg: function (y) {
                                    var D = this.Ql(y);
                                    this.a(D),
                                        D.p == this.ej && this.fR.uh(D.iX),
                                        this.Fl()
                                },
                                Sg: function (y) {
                                    var D = IJ.D(y);
                                    D.p = 0,
                                        D.iX = 0,
                                        D.H(this.O),
                                        this.VY?.(D)
                                },
                                _g: function (y) {
                                    this.YO.push({
                                        kR: y.ry(),
                                        bg: y.ry()
                                    }),
                                        this.Fl()
                                },
                                Fl: function () {
                                    if (this.LX == fJ) {
                                        var y = this;
                                        this.YO.forEach((f) => {
                                            f.kR <= y.f || f.bg == y.hX + y.RY + y.dj.y_(f.kR) && y.Jg(f.kR - y.f)
                                        }
                                        );
                                        var D = 0;
                                        this.YO.forEach((f) => {
                                            f.kR > y.f && (y.YO[D++] = f)
                                        }
                                        ),
                                            this.YO.length = D,
                                            this.fR.vh(this.f)
                                    }
                                },
                                Ag: function (y) {
                                    var D = y.q() != 0
                                        , f = y.ZY()
                                        , x = "";
                                    y.$.byteLength > y._ && (x = y.ZY()),
                                        this.Xy(J7(f6.qz, f, D, x))
                                },
                                gg: function (y) {
                                    var D = y.d()
                                        , f = y.d()
                                        , x = J.cy.now() - f;
                                    this.r5.uz(D - f * this.BY),
                                        this.LR.uz(x),
                                        D = 0,
                                        this.l5.findIndex((d) => {
                                            if (d > f)
                                                return !0;
                                            this.Zg?.(d < f ? -1 : x),
                                                D++
                                        }
                                        ),
                                        this.l5.splice(0, D)
                                },
                                lg: function () {
                                    var y = J.cy.now();
                                    this.Il = y,
                                        this.l5.push(y);
                                    var D = 0 | this.LR.QO(0.5)
                                        , f = this.Dy?._modifyClientPing;
                                    f && (D = f(D));
                                    var x = hJ.j();
                                    x.g(2),
                                        x.J(y),
                                        x.oy(D),
                                        this.DY(x, 2)
                                },
                                Jg: function (y) {
                                    this.ll(y),
                                        this.lj -= y,
                                        this.ml()
                                },
                                kj: function (y, D, f, x = !0) {
                                    if (!x || this.LX == fJ) {
                                        var d = this.Og++
                                            , p = 0;
                                        this.cY < 0 && (this.cY = 0),
                                            y.Xj.jy && (p = this.f + (0 | this.lj) + this.cY);
                                        var Y0 = hJ.j();
                                        Y0.g(1),
                                            Y0.ey(p),
                                            Y0.ey(d),
                                            IJ.S(y, Y0),
                                            this.DY(Y0),
                                            y.Xj.zy && (y.iX = d,
                                                y.p = this.ej,
                                                y.Zy = p,
                                                this.fR.kx(y))
                                    }
                                }
                            }),
                            U0
                    }
                    , { zz: b7 } = J
                    , { Vy: e7 } = j
                    , { tp: c7, mj: u5 } = k
                    , { xl: X5 } = H8
                    , { xX: tJ, zX: l5 } = F0;
                function r9() { }
                r9.i5 = function (Q0, { Q: W0, fg: U0, Lg: y, dg: D, eg: f, kg: x, $g: d, qg: p, Cg: Y0, Tg: $0, Pg: D0, cg: M0 }) {
                    let y0 = t0(y)
                        , T = x8(y);
                    function m(e, s0) {
                        this.Hy = s0 instanceof y0,
                            this.R = s0,
                            this.h5 = 0,
                            this.Bl = this.tg.bind(this),
                            W0?.call(this, e, s0)
                    }
                    return m.prototype = {
                        fX: function (e = 50) {
                            var s0 = this.R;
                            this.h5 = J.bp(this.Bl),
                                this.Wg = J.cO(() => {
                                    s0.Fy()
                                }
                                    , e)
                        },
                        tg: function () {
                            this.h5 = J.bp(this.Bl),
                                D0?.call(this),
                                this.R.Fy(),
                                M0?.call(this)
                        },
                        Xy: function () {
                            J.oO(this.h5),
                                J.Dp(this.Wg)
                        },
                        nY: function (e) {
                            e && b7?.(e.toString() || e)
                        },
                        C: function (e, s0) {
                            return this.Hy && (e.p = s0 || 0),
                                this.R.kj(e),
                                !0
                        }
                    },
                        m.wg = function (e, s0) {
                            var { id: u0, password: p8, token: h6, authObj: D6 } = e;
                            if (!u0 || !D6)
                                throw e7(H.Fz);
                            var O8 = U0(s0)
                                , N6 = {};
                            p8 == "" && (p8 = null);
                            try {
                                var F5 = O8.pO.up
                                    , p6 = new Q0.Rj(Q0)
                                    , V6 = new T(p6, D6);
                                V6.Ul = (LJ) => {
                                    V6.Ul = null,
                                        D?.(q7, LJ),
                                        q7.Ml?.call?.(q7, LJ)
                                }
                                    ;
                                var q7 = new Q0.jp(O8, V6);
                                V6.dR = f?.(O8.pO),
                                    V6.Dy = q7,
                                    V6.fX(u0, p8, h6, F5),
                                    N6.cancel = () => {
                                        V6.Yp = null,
                                            V6.XO = null,
                                            V6.Xy(e7(H.sR))
                                    }
                                    ;
                                var k9 = (LJ) => {
                                    N6.cancel = null,
                                        D?.(q7, LJ),
                                        V6.Ul?.(LJ)
                                }
                                    ;
                                V6.XO = (LJ) => {
                                    V6.XO = null,
                                        V6.Yp = null,
                                        k9(LJ)
                                }
                                    ,
                                    V6.Yp = (LJ) => {
                                        LJ == 3 && (N6.cancel = null,
                                            q7.fX(),
                                            q7.OO = u0,
                                            V6.Zg = (w1) => {
                                                q7._onPingChange?.(w1, V6.LR.QO(0.5), V6.LR.kh())
                                            }
                                            ,
                                            q7.nl = () => {
                                                V6.Yp = null,
                                                    V6.Xy(),
                                                    q7.Xy()
                                            }
                                            ,
                                            V6.Yp = (w1, m4) => {
                                                V6.Yp = null,
                                                    q7.Xy(),
                                                    q7.dX?.lX(),
                                                    k9(m4)
                                            }
                                            ,
                                            q7.Nl?.call?.(q7),
                                            q7.EX?.(q7),
                                            x?.(q7))
                                    }
                            } catch (LJ) {
                                N6.cancel = null;
                                var t9 = e7(H.$z, LJ);
                                D?.(q7, t9),
                                    q7.nY?.(t9)
                            }
                            return N6
                        }
                        ,
                        m.j = function (e, s0) {
                            var u0 = U0(s0)
                                , p8 = {}
                                , h6 = new Q0.Rj(Q0);
                            h6.L = e.name;
                            var D6, O8 = new y0(p8, h6);
                            O8.B_ = e.onHostSpecificDataSent,
                                O8.yg = e.onError,
                                O8.Tj = c7(e.geo, u0.pO.Tj, !1),
                                O8.Xp = !!e.noPlayer,
                                O8.Xp || ((D6 = new Q0.gX).L = u0.pO.Vl,
                                    D6.oY = !0,
                                    D6.ky = O8.Tj.flag,
                                    D6.Jy = u0.pO.Jy,
                                    D6.eX = !0,
                                    h6.o.push(D6)),
                                O8.uX = !!e.unlimitedPlayerCount,
                                O8.AR = !!e.showInRoomList,
                                O8.ap = e.playerCount,
                                O8.yp = e.fakePassword != null ? !!e.fakePassword : null,
                                O8.JX = (0 | e.maxPlayerCount) - (O8.Xp ? 0 : 1),
                                O8.PY = e.password == "" ? null : e.password;
                            var N6 = new Q0.jp(u0, O8);
                            N6.RO = function () {
                                if (O8.AR) {
                                    var p6 = new X5;
                                    p6.NY = N6.NY,
                                        p6.L = h6.L,
                                        p6.o = O8.ap != null ? O8.ap : h6.o.length,
                                        p6.Lx = O8.JX + (O8.Xp ? 0 : 1),
                                        p6.ky = O8.Tj.flag,
                                        p6.PY = O8.yp != null ? O8.yp : O8.PY != null,
                                        p6.yR = O8.Tj.lat,
                                        p6.YR = O8.Tj.lon;
                                    var V6 = u5.j(16);
                                    p6.S(V6),
                                        O8.Gx(V6.wO())
                                }
                            }
                                ,
                                O8.Dy = N6,
                                O8.fX(e.token),
                                N6.RO(),
                                N6.fX();
                            var F5 = J.cO(() => {
                                N6.C(l5.j(O8.O.o.map((p6) => {
                                    var V6 = O8.SX.get(p6.X);
                                    return V6 ? V6.UX : O8.O.og?.()
                                }
                                )))
                            }
                                , 3000);
                            return O8.Yg = function (p6) {
                                h6.G(p6) && N6.C(tJ.j(p6, e7(H.Mz).toString(), !1))
                            }
                                ,
                                O8.Up = async (p6, V6, q7, k9) => {
                                    var t9 = await d?.(N6, p6, V6, q7, k9);
                                    if (t9)
                                        throw t9;
                                    N6.RO()
                                }
                                ,
                                O8._X = function (p6) {
                                    h6.G(p6) && N6.C(tJ.j(p6, null, !1))
                                }
                                ,
                                O8.O5 = function (p6) {
                                    N6.OO = p6,
                                        p?.(N6)
                                }
                                ,
                                N6.Hg = function (p6, V6, q7, k9) {
                                    O8.I_(p6, V6, q7, k9)
                                }
                                ,
                                p8.cancel = N6.nl = function () {
                                    O8.Xy(),
                                        N6.Xy(),
                                        J.Dp(F5),
                                        Y0?.(N6),
                                        N6.Ml?.call?.(N6)
                                }
                                ,
                                N6.Nl?.call?.(N6),
                                N6.hostPing = 0,
                                N6.EX?.(N6),
                                $0?.(N6),
                                p8
                        }
                        ,
                        m
                }
                    ;
                var h4 = r9
                    , { jj: KY } = k;
                function VY() { }
                VY.g5 = function (Q0, { Q: W0, Fj: U0, $j: y }) {
                    function D(x) {
                        K6.call(this, x),
                            this.xj = [],
                            this.P = 1,
                            this.ZX = J.cy.now(),
                            this.Vj = !1
                    }
                    function f(x, d, p) {
                        var Y0 = 0
                            , $0 = p?.requestAnimationFrame || J.bp
                            , D0 = p?.cancelAnimationFrame || J.oO
                            , M0 = d?.render
                            , y0 = function () {
                                Y0 = $0(y0),
                                    x.Fy(),
                                    M0?.()
                            };
                        function T() {
                            Y0 = $0(y0),
                                U0?.(x, d)
                        }
                        function m() {
                            D0(Y0),
                                y?.(x)
                        }
                        this.initialize = T,
                            !p?.delayedInit && T(),
                            this.Xy = function () {
                                m()
                            }
                            ,
                            this.Gl = function (e) {
                                m(),
                                    x.O = e,
                                    T()
                            }
                    }
                    return D.prototype = KY(K6.prototype, {
                        kj: function () { },
                        zj: function (x = 0) {
                            this.Fy();
                            var d = this.O.dY(++this.Cx);
                            return d.Qy(x * this.BY | 0),
                                d
                        },
                        Fy: function () {
                            var x = this.xj;
                            this.xj = [];
                            for (var d = ((J.cy.now() - this.ZX) * this.BY * this.P | 0) - this.f, p = 0; p < d; p++)
                                this.f += 1,
                                    this.Vj || this.O.Qy(1);
                            x.forEach(this.a)
                        },
                        Kl: function (x) {
                            this.xj.push(x)
                        },
                        a: function (x) {
                            this.Ig?.(x) != 0 && (x.H(this.O),
                                this.VY?.(x))
                        },
                        _5: function (x) {
                            if (!(x < 0)) {
                                if (x == 0)
                                    return void (this.Vj = !0);
                                this.f = this.f * x / this.P | 0,
                                    this.P = x,
                                    this.Vj = !1
                            }
                        },
                        Qy: function (x) {
                            this.Vj && this.O.Qy(x)
                        }
                    }),
                    {
                        Eg: f,
                        mg: function (x, d) {
                            var p, Y0 = new Q0.Rj(Q0), $0 = new D(Y0), D0 = new f($0, x, d);
                            return p = {
                                state: Y0,
                                initialize: () => D0.initialize(),
                                extrapolate: (M0) => $0.zj(M0),
                                takeSnapshot: () => Y0.copy(),
                                useSnapshot: function (M0) {
                                    var y0 = M0.copy();
                                    D0.Gl(y0),
                                        Y0 = y0,
                                        p.state = y0
                                },
                                executeEvent: function (M0) {
                                    $0.Kl(M0)
                                },
                                applyEvent: function (M0) {
                                    $0.a(M0)
                                },
                                setSimulationSpeed: function (M0) {
                                    $0._5(M0)
                                },
                                runSteps: function (M0) {
                                    $0.Qy(M0)
                                },
                                destroy: D0.Xy
                            },
                                W0?.call(p, $0, d, x),
                                Object.defineProperty(p, "gameState", {
                                    get: () => Y0.l
                                }),
                                Object.defineProperty(p, "currentPlayerId", {
                                    get: () => 0
                                }),
                                Object.defineProperty(p, "currentFrameNo", {
                                    get: () => $0.f
                                }),
                                p
                        }
                    }
                }
                    ;
                var RI = VY
                    , { Ej: zY, jj: bI } = k
                    , { V: x4 } = o;
                function g4() { }
                g4.A5 = function (Q0, W0) {
                    function U0(y) {
                        K6.call(this, y),
                            this.P = 1,
                            this.ZX = J.cy.now(),
                            this.Vj = !1,
                            this.Qg = [],
                            this.xO = [],
                            this.maxFrameNo = 0
                    }
                    return U0.prototype = bI(K6.prototype, {
                        kj: function () { },
                        zj: function (y = 0) {
                            return this.O
                        },
                        Fy: function () {
                            var y = this.maxFrameNo;
                            if (!(this.f >= y))
                                do {
                                    var D = 0
                                        , f = this.xO[0];
                                    if (!f || this.f > f.Zy)
                                        break;
                                    for (; f?.Zy == this.f;)
                                        f.H(this.O),
                                            this.Qg.push(f),
                                            f = this.xO[++D];
                                    this.O.Qy(1),
                                        this.f++,
                                        this.xO.splice(0, D)
                                } while (this.f < y)
                        },
                        _5: function (y) {
                            if (!(y < 0)) {
                                if (y == 0)
                                    return void (this.Vj = !0);
                                this.f = this.f * y / this.P | 0,
                                    this.P = y,
                                    this.Vj = !1
                            }
                        },
                        Qy: function (y) {
                            this.Vj && this.O.Qy(y)
                        }
                    }),
                        function (y, D = {}, f) {
                            var x, d = new Q0.Rj(Q0), p = new U0(d), Y0 = new W0(p, D, f);
                            function $0(u0) {
                                u0.Zy == p.f && u0.YY <= p.RY ? (u0.YY = p.RY++,
                                    p.Kl(u0)) : p.dj.kx(u0)
                            }
                            var D0, M0, y0, T, m, e, s0 = new zY(new DataView(y.buffer, y.byteOffset, y.byteLength));
                            for (p.f = s0.ry(),
                                p.hX = s0.ry(),
                                p.RY = s0.Ey(),
                                d.D(s0); s0._ < s0.$.byteLength;)
                                $0((M0 = void 0,
                                    y0 = void 0,
                                    T = void 0,
                                    m = void 0,
                                    e = void 0,
                                    M0 = (D0 = s0).ry(),
                                    y0 = D0.Ey(),
                                    T = D0.By(),
                                    m = D0.ry(),
                                    (e = x4.D(D0)).p = T,
                                    e.iX = m,
                                    e.Zy = M0,
                                    e.YY = y0,
                                    e));
                            return y = null,
                                s0 = null,
                                x = {
                                    state: d,
                                    extrapolate: (u0) => p.zj(u0),
                                    readStream: (u0) => {
                                        if (p.maxFrameNo = u0.ry(),
                                            u0.$.byteLength != u0.$.byteOffset + u0._) {
                                            var p8, h6, D6, O8, N6, F5 = J.Ny.inflateRaw(new Uint8Array(u0.$.buffer, u0._));
                                            for (u0 = new zY(new DataView(F5.buffer, F5.byteOffset, F5.byteLength)); u0._ < F5.byteLength;)
                                                for (O8 = p.maxFrameNo - u0.By(),
                                                    p8 = u0.By(),
                                                    N6 = 0; N6 < p8; N6++)
                                                    h6 = u0.By(),
                                                        (D6 = x4.D(u0, !0)).p = h6,
                                                        D6.Zy = O8,
                                                        p.xO.push(D6)
                                        }
                                    }
                                    ,
                                    readImmediateStream: (u0) => {
                                        var p8 = p.maxFrameNo = u0.ry()
                                            , h6 = u0.By()
                                            , D6 = x4.D(u0, !0);
                                        D6.p = h6,
                                            D6.Zy = p8,
                                            p.xO.push(D6)
                                    }
                                    ,
                                    takeSnapshot: () => d.copy(),
                                    useSnapshot: function (u0) {
                                        var p8 = u0.copy();
                                        Y0.Gl(p8),
                                            d = x.state = p8
                                    },
                                    setSimulationSpeed: function (u0) {
                                        p._5(u0)
                                    },
                                    runSteps: function (u0) {
                                        p.Qy(u0)
                                    },
                                    destroy: Y0.Xy
                                },
                                Object.defineProperty(x, "gameState", {
                                    get: () => d.l
                                }),
                                Object.defineProperty(x, "currentPlayerId", {
                                    get: () => 0
                                }),
                                Object.defineProperty(x, "currentFrameNo", {
                                    get: () => p.f
                                }),
                                Object.defineProperty(x, "maxFrameNo", {
                                    get: () => p.maxFrameNo
                                }),
                                x
                        }
                }
                    ;
                var vI = g4;
                z.bL = (Q0, W0) => {
                    var U0 = ((S8, z7) => {
                        var f8 = J
                            , K7 = z7?.backend;
                        K7 && (K7.hostname != null && (f8.JY.Sp = K7.hostname),
                            K7.hostnameWs != null && (f8.JY.Oz = K7.hostnameWs),
                            K7.secure != null && (f8.JY.tX = K7.secure)),
                            K7 = z7?.proxy,
                            K7 && (f8.qY = {
                                _h: K7.HttpUrl,
                                fp: K7.WebSocketUrl,
                                HO: K7.WebSocketChangeOriginAllowed
                            }),
                            z7?.version != null && (f8.Rz = z7.version),
                            f8.xz = (f8.JY.tX ? "wss" : "ws") + "://" + f8.JY.Oz + "/",
                            f8.PO = f8?.qY?._h || (f8.JY.tX ? "https" : "http") + "://" + f8.JY.Sp + "/rs/",
                            z7?.stunServer != null && (f8.KR = [{
                                urls: z7.stunServer
                            }]),
                            f8.hY = setTimeout.bind(global),
                            f8._Y = clearTimeout.bind(global),
                            f8.cO = setInterval.bind(global),
                            f8.Dp = clearInterval.bind(global),
                            f8.zz = console.log.bind(global),
                            f8.GR = console.warn.bind(global),
                            f8.bp = setImmediate.bind(global),
                            f8.oO = setImmediate.bind(global),
                            f8.lz = fetch,
                            f8.XX = crypto.subtle,
                            f8.Jp = WebSocket,
                            f8.cy = performance,
                            f8.rz = JSON5,
                            f8.Ny = pako,
                            f8.OY = HttpsProxyAgent.proxyAgent,
                            f8.WX = z7?.identityToken;
                        var U5 = wrtc.webkitRTCPeerConnection || wrtc.mozRTCPeerConnection || wrtc.RTCPeerConnection
                            , xJ = wrtc.webkitRTCIceCandidate || wrtc.mozRTCIceCandidate || wrtc.RTCIceCandidate
                            , UJ = wrtc.webkitRTCSessionDescription || wrtc.mozRTCSessionDescription || wrtc.RTCSessionDescription;
                        return f8.iz = U5,
                            f8.Zp = xJ,
                            f8.aR = UJ,
                            f8
                    }
                    )(Q0, W0);
                    let y = H
                        , D = j
                        , f = N
                        , x = n
                        , { Ej: d, mj: p, UO: Y0, cp: $0, MO: D0, FO: M0, jj: y0, op: T, BO: m, KO: e, GO: s0, rx: u0, ix: p8, aO: h6, hx: D6, tp: O8, nO: N6, NO: F5, VO: p6 } = k
                        , V6 = u;
                    var { gy: q7, Wp: k9, sO: t9, bx: LJ, Jx: w1 } = o
                        , { RX: m4, xX: SI, zX: WY } = F0
                        , { Zx: TI } = d0
                        , { zl: HY, xl: yI } = H8
                        , { Wx: YY } = R8
                        , { wx: fI } = o0
                        , { i5: hI } = h4
                        , { g5: xI } = RI
                        , { A5: j1 } = vI;
                    return {
                        Y: U0,
                        Oy: {
                            zO: {
                                $R: d,
                                lO: p
                            },
                            V: {
                                gy: q7,
                                Wp: k9,
                                sO: t9,
                                bx: LJ,
                                Jx: w1,
                                S5: {
                                    RX: m4,
                                    xX: SI,
                                    zX: WY
                                }
                            },
                            wx: fI,
                            Zx: TI,
                            i5: hI,
                            Wx: YY,
                            g5: xI,
                            A5: j1,
                            zl: HY
                        },
                        Fg: {
                            gX: y.wX,
                            Ug: y.Lp,
                            Mg: y.dp
                        },
                        ng: {
                            Ng: y.hz,
                            Vg: y._z,
                            Bg: y.gz,
                            Kg: y.Az,
                            Gg: y.Sz,
                            ag: y.Dz
                        },
                        x9: {
                            z9: y.Nz,
                            l9: y.Vz,
                            r9: y.Bz
                        },
                        qR: {
                            cp: $0,
                            UO: Y0,
                            MO: D0,
                            FO: M0,
                            jj: y0,
                            vg: function () {
                                try {
                                    return x.Ph().then((S8) => [S8.Hh(), S8])
                                } catch (S8) {
                                    return Promise.reject(S8)
                                }
                            },
                            sg: function (S8) {
                                try {
                                    return x.ch(S8)
                                } catch (z7) {
                                    return Promise.reject(z7)
                                }
                            },
                            Ax: () => V6.Ax().then((S8) => {
                                var z7 = new d(new DataView(S8), !1);
                                z7.q();
                                for (var f8 = []; z7._ != z7.$.byteLength;) {
                                    var K7 = z7.pX(z7.By())
                                        , U5 = z7.az(z7.By());
                                    try {
                                        var xJ = new yI;
                                        xJ.D(new d(new DataView(U5), !1));
                                        var UJ = new HY;
                                        UJ.Ry = xJ,
                                            UJ.X = K7,
                                            f8.push(UJ)
                                    } catch { }
                                }
                                return f8
                            }
                            ),
                            ug: (S8, z7) => {
                                let f8 = Math.PI / 180
                                    , K7 = S8.lat
                                    , U5 = S8.lon;
                                z7.forEach((xJ) => {
                                    var { yR: UJ, YR: o5 } = xJ.Ry
                                        , cQ = Math.cos(f8 * (UJ - K7))
                                        , uZ = Math.cos(f8 * (UJ + K7));
                                    xJ.xy = 6378 * Math.acos((cQ - uZ + (cQ + uZ) * Math.cos(f8 * (o5 - U5))) / 2),
                                        isFinite(xJ.xy) || (xJ.xy = 22000)
                                }
                                )
                            }
                            ,
                            KO: e,
                            GO: s0,
                            rx: u0,
                            ix: p8,
                            aO: h6,
                            hx: D6,
                            Sx: V6.Sx,
                            tp: O8,
                            op: T,
                            BO: m,
                            nO: N6,
                            NO: F5,
                            VO: p6,
                            yA: function ({ token: S8 = "", rcr: z7 = "" }) {
                                return new Promise((f8) => {
                                    V6.Dx({
                                        CY: S8,
                                        Ih: z7
                                    }, (K7, U5) => {
                                        f8({
                                            code: 0,
                                            value: U5
                                        })
                                    }
                                        , (K7) => {
                                            f8({
                                                code: 1,
                                                value: K7
                                            })
                                        }
                                    ).catch((K7) => {
                                        f8({
                                            code: 2,
                                            value: K7
                                        })
                                    }
                                    )
                                }
                                )
                            },
                            YA: function ({ token: S8 = "", proxyAgent: z7 }) {
                                return new Promise((f8, K7) => {
                                    var U5, xJ;
                                    function UJ() {
                                        U5?.close(),
                                            U5 = null,
                                            xJ ? f8(xJ) : K7()
                                    }
                                    V6.Dx({
                                        CY: S8
                                    }, (o5, cQ) => {
                                        (!o5 || !cQ) && UJ(),
                                            U0.qY?.fp && (o5 = U0.qY?.fp),
                                            o5.endsWith("host") || (o5.endsWith("/") || (o5 += "/"),
                                                o5 += "host"),
                                            U5 = V6.Ol({
                                                Xl: o5,
                                                CY: cQ,
                                                OY: z7,
                                                pl: [],
                                                mX: UJ,
                                                nY: UJ,
                                                QX: (uZ) => {
                                                    var c4 = new d(new DataView(uZ.data), !1);
                                                    if (c4.q() === 5)
                                                        xJ = {
                                                            roomId: c4.pX(c4.q()),
                                                            newToken: cQ
                                                        },
                                                            UJ()
                                                }
                                            })
                                    }
                                        , () => UJ()).catch(() => UJ())
                                }
                                )
                            }
                        },
                        jA: f,
                        kX: {
                            ep: D.ep,
                            Vy: D.Vy,
                            XA: {
                                pA: y.bz,
                                OA: y.tO,
                                RA: y.Jz,
                                xA: y.Zz,
                                zA: y.fz,
                                lA: y.Lz,
                                rA: y.dz,
                                iA: y.ez,
                                hA: y.kz,
                                _A: y.$z,
                                gA: y.sR,
                                AA: y.qz,
                                SA: y.uR,
                                DA: y.Cz,
                                bA: y.Tz,
                                JA: y.Pz,
                                ZA: y.cz,
                                fA: y.oz,
                                LA: y.Hz,
                                dA: y.tz,
                                eA: y.Wz,
                                kA: y.wz,
                                $A: y.Iz,
                                qA: y.Qz,
                                CA: y.Ez,
                                TA: y.Ij,
                                PA: y.mz,
                                cA: y.yx,
                                oA: y.Fz,
                                HA: y.Uz,
                                tA: y.Mz,
                                WA: y.nz,
                                wA: y.Yx
                            }
                        }
                    }
                }
            }
            )
            , q = Q((V, z) => {
                function W(X, B) {
                    return X(B = {
                        bL: {}
                    }, B.bL),
                        B.bL
                }
                var H = W(function (X) {
                    X.bL = X.vR || (X.vR = {
                        al: 0,
                        vl: 1,
                        sl: 2,
                        ul: 3,
                        IA: 1,
                        EA: 2,
                        mA: 0,
                        QA: 1,
                        FA: 2,
                        UA: 0,
                        MA: 1,
                        nA: 0,
                        NA: 1,
                        VA: 2,
                        BA: 3,
                        KA: 4,
                        GA: 5,
                        aA: 6,
                        vA: 7,
                        sA: 8,
                        uA: 9,
                        yS: 10,
                        YS: 11,
                        jS: 12,
                        XS: 13,
                        pS: 14,
                        OS: 15,
                        RS: 16,
                        xS: 17,
                        zS: 18,
                        lS: 19,
                        rS: 20,
                        iS: 21,
                        hS: 22,
                        _S: 23,
                        gS: 24,
                        AS: 25,
                        SS: 26,
                        DS: 27,
                        bS: 28,
                        JS: 29,
                        ZS: 30,
                        fS: 31,
                        LS: -1,
                        dS: 0,
                        eS: 1,
                        yr: 15,
                        Yr: 16,
                        jr: 17,
                        Xr: 19,
                        pr: 28,
                        Or: 29,
                        Rr: 30,
                        xr: 34,
                        zr: 35,
                        CR: 37,
                        lr: 39,
                        rr: 42,
                        ir: 43,
                        hr: 44,
                        _r: 45,
                        gr: 46,
                        Ar: 47,
                        Sr: 48,
                        Dr: 49,
                        br: 50,
                        Jr: 57,
                        Zr: 58,
                        kS: 0,
                        $S: 1,
                        qS: 2,
                        CS: 3,
                        fr: 0,
                        Lr: 1,
                        dr: 2,
                        er: 3,
                        kr: 4,
                        $r: 5,
                        qr: 6,
                        Cr: 7,
                        Tr: 8,
                        Pr: 9,
                        cr: 10,
                        or: 11,
                        Hr: 12,
                        tr: 13,
                        Wr: 14,
                        wr: 15,
                        Ir: 16,
                        Er: 17,
                        mr: 18,
                        Qr: 19,
                        Fr: 20,
                        Ur: 21,
                        Mr: 22,
                        nr: 23,
                        Nr: 24,
                        Vr: 25,
                        Br: 26,
                        TS: 0,
                        PS: 1,
                        cS: 2,
                        oS: 3,
                        HS: 4,
                        tS: 5,
                        WS: 6,
                        wS: 7,
                        IS: 8,
                        ES: 9,
                        mS: 10,
                        QS: 11,
                        FS: 12,
                        US: 13,
                        MS: 14,
                        nS: 15,
                        NS: 16,
                        VS: 17,
                        BS: 18,
                        KS: 19,
                        GS: 20,
                        aS: 0,
                        Kr: 1,
                        vS: 2,
                        sS: 3,
                        uS: 4,
                        yD: 5,
                        YD: 6,
                        jD: 7,
                        XD: 8,
                        pD: 9,
                        OD: 10,
                        RD: 11,
                        xD: 12,
                        zD: 13,
                        lD: 14,
                        rD: 15,
                        iD: 16,
                        hD: 17,
                        _D: 18
                    })
                })
                    , { E: Y } = J;
                function U(X, B, I, _, s) {
                    this.X = X,
                        this.b = B,
                        this.Gr = I,
                        this.z = _,
                        this.i = s
                }
                U.spec = U.bY = new U(0, 16777215, 0, -1, 0),
                    U.red = U.Ty = new U(1, 15035990, -1, 8, 2),
                    U.blue = U.yY = new U(2, 5671397, 1, 16, 4),
                    U.byId = U.p = [U.bY, U.Ty, U.yY],
                    Y(U, [], ["id", "color", "defenseDir", "cMask", "cGroup"], []);
                var N = U
                    , { E: j, K: { kX: { Vy: k } } } = J;
                function L() {
                    this.$X = 0,
                        this.WY = 16777215,
                        this.KY = []
                }
                L.Pj = function (X, B, ...I) {
                    var _ = new L;
                    _.KY = [X.b];
                    var s = I.length;
                    if (s < 1)
                        return _;
                    if (_.$X = 256 * B / 360 | 0,
                        _.WY = I[0],
                        s > 1) {
                        s > 4 && (s = 4),
                            _.KY = [];
                        for (var r = 1; r < s; r++)
                            _.KY.push(I[r])
                    }
                    return _
                }
                    ,
                    L.prototype = {
                        S: function (X) {
                            X.g(this.$X),
                                X.m(this.WY),
                                X.g(this.KY.length),
                                this.KY.forEach((B) => {
                                    X.m(B)
                                }
                                )
                        },
                        D: function (X) {
                            this.$X = X.q(),
                                this.WY = X.W();
                            var B = X.q();
                            if (B > 3)
                                throw J.Vy(H.Xr);
                            this.KY = [];
                            for (var I = 0; I < B; I++)
                                this.KY.push(X.W())
                        },
                        copy: function () {
                            var X = new L;
                            return X.$X = this.$X,
                                X.WY = this.WY,
                                X.KY = this.KY.slice(),
                                X
                        }
                    },
                    j(L, [], ["angle", "text", "inner"], []),
                    Object.defineProperty(L.prototype, "angleDeg", {
                        get: function () {
                            return Math.ceil(360 * this.$X / 256)
                        },
                        set: function (X) {
                            this.$X = 256 * X / 360 | 0
                        }
                    });
                var F = L
                    , { E: P, K: { qR: { jj: M } }, pz: { HX: v, kO: E, $O: n, qO: u, hh: b, CO: i, TO: g, VR: l, BR: o } } = J
                    , F0 = 1 / Math.SQRT2;
                function b0(X) {
                    E.call(this, X),
                        this.X = 0
                }
                function d0(X) {
                    n.call(this, X),
                        this.by = X?.by == null || X.by,
                        this.b = X?.b == null ? 0 : X.b,
                        X?.cj != null && this.LO(X.cj)
                }
                function H8(X) {
                    u.call(this, X)
                }
                function E0(X) {
                    b.call(this, X),
                        this.c = X?.c == null ? N.bY : X.c
                }
                function v0(X) {
                    i.call(this, X),
                        this.b = X?.b == null ? 16777215 : X.b
                }
                function G6(X) {
                    g.call(this, X),
                        this.b = X?.b == null ? 0 : X.b
                }
                function I8(X) {
                    l.call(this, X),
                        this.n = null,
                        this.SY = -1,
                        this.u = null,
                        this.vr = 0,
                        this.b = X?.b == null ? 16777215 : X.b
                }
                function x0() {
                    o.call(this),
                        this.ty = [],
                        this.SY = -1,
                        this.u = null
                }
                b0.prototype = M(E.prototype, {
                    S: function (X) {
                        var B = this.h;
                        X.J(B.x),
                            X.J(B.y),
                            X.J(this.r),
                            X.m(this.z),
                            X.m(this.i)
                    },
                    D: function (X) {
                        var B = this.h;
                        B.x = X.d(),
                            B.y = X.d(),
                            this.r = X.d(),
                            this.z = X.W(),
                            this.i = X.W()
                    }
                }),
                    d0.prototype = M(n.prototype, {
                        S: function (X) {
                            var B = 0
                                , I = X._;
                            X.g(0),
                                X.g(this.v.X),
                                X.g(this.s.X),
                                this.ny != 0 && (B = 1,
                                    X.J(this.ny)),
                                this.wy != 1 / 0 && (B |= 2,
                                    X.J(this.wy)),
                                this.b != 0 && (B |= 4,
                                    X.m(this.b)),
                                this.by && (B |= 8),
                                X.$.setUint8(I, B),
                                X.J(this.r),
                                X.m(this.z),
                                X.m(this.i)
                        },
                        D: function (X, B) {
                            var I = X.q();
                            this.v = B[X.q()],
                                this.s = B[X.q()],
                                this.ny = 1 & I ? X.d() : 0,
                                this.wy = 2 & I ? X.d() : 1 / 0,
                                this.b = 4 & I ? X.W() : 0,
                                this.by = (8 & I) != 0,
                                this.r = X.d(),
                                this.z = X.W(),
                                this.i = X.W()
                        }
                    }),
                    H8.prototype = M(u.prototype, {
                        S: function (X) {
                            var B = this.qy;
                            X.J(B.x),
                                X.J(B.y),
                                X.J(this.xy),
                                X.J(this.r),
                                X.m(this.z),
                                X.m(this.i)
                        },
                        D: function (X) {
                            var B = this.qy;
                            B.x = X.d(),
                                B.y = X.d(),
                                this.xy = X.d(),
                                this.r = X.d(),
                                this.z = X.W(),
                                this.i = X.W()
                        }
                    }),
                    E0.prototype = M(b.prototype, {
                        FR: b.prototype.FR,
                        S: function (X) {
                            var B = this.iY;
                            X.J(B.x),
                                X.J(B.y),
                                B = this.rY,
                                X.J(B.x),
                                X.J(B.y),
                                X.g(this.c.X)
                        },
                        D: function (X) {
                            var B = this.iY;
                            B.x = X.d(),
                                B.y = X.d(),
                                (B = this.rY).x = X.d(),
                                B.y = X.d(),
                                this.c = N.p[X.kp()] || N.bY
                        }
                    }),
                    v0.prototype = M(i.prototype, {
                        S: function (X) {
                            var B = this.h;
                            X.J(B.x),
                                X.J(B.y),
                                B = this.P,
                                X.J(B.x),
                                X.J(B.y),
                                B = this.T,
                                X.J(B.x),
                                X.J(B.y),
                                X.J(this.I),
                                X.J(this.r),
                                X.J(this.F),
                                X.J(this.N),
                                X.ey(this.b),
                                X.m(this.z),
                                X.m(this.i)
                        },
                        D: function (X) {
                            var B = this.h;
                            B.x = X.d(),
                                B.y = X.d(),
                                (B = this.P).x = X.d(),
                                B.y = X.d(),
                                (B = this.T).x = X.d(),
                                B.y = X.d(),
                                this.I = X.d(),
                                this.r = X.d(),
                                this.F = X.d(),
                                this.N = X.d(),
                                this.b = X.ry(),
                                this.z = X.W(),
                                this.i = X.W()
                        },
                        gD: function () {
                            var X = new I8;
                            return this.ar(X),
                                X
                        },
                        ar: function (X) {
                            var B = X.h
                                , I = this.h;
                            B.x = I.x,
                                B.y = I.y,
                                B = X.P,
                                I = this.P,
                                B.x = I.x,
                                B.y = I.y,
                                B = X.T,
                                I = this.T,
                                B.x = I.x,
                                B.y = I.y,
                                X.I = this.I,
                                X.r = this.r,
                                X.F = this.F,
                                X.N = this.N,
                                X.b = this.b,
                                X.z = this.z,
                                X.i = this.i
                        }
                    }),
                    G6.prototype = M(g.prototype, {
                        S: function (X) {
                            X.g(this.vy),
                                X.g(this.ay),
                                X.J(this.dy),
                                X.J(this.Cy),
                                X.J(this.$Y),
                                X.m(this.b)
                        },
                        D: function (X) {
                            this.vy = X.q(),
                                this.ay = X.q(),
                                this.dy = X.d(),
                                this.Cy = X.d(),
                                this.$Y = X.d(),
                                this.b = X.W()
                        }
                    }),
                    I8.LY = function (X, B) {
                        X.I = B.I,
                            X.r = B.r,
                            X.F = B.F,
                            X.N = B.N,
                            X.b = B.b,
                            X.z = B.z,
                            X.i = B.i;
                        var I = X.h
                            , _ = B.h;
                        I.x = _.x,
                            I.y = _.y,
                            I = X.P,
                            _ = B.P,
                            I.x = _.x,
                            I.y = _.y,
                            I = X.T,
                            _ = B.T,
                            I.x = _.x,
                            I.y = _.y
                    }
                    ,
                    I8.prototype = M(l.prototype, {
                        S: function (X) {
                            var B = this.h;
                            X.J(B.x),
                                X.J(B.y),
                                B = this.P,
                                X.J(B.x),
                                X.J(B.y),
                                B = this.T,
                                X.J(B.x),
                                X.J(B.y),
                                X.J(this.I),
                                X.J(this.r),
                                X.J(this.F),
                                X.J(this.N),
                                X.ey(this.b),
                                X.m(this.z),
                                X.m(this.i)
                        },
                        D: function (X) {
                            var B = this.h;
                            B.x = X.d(),
                                B.y = X.d(),
                                (B = this.P).x = X.d(),
                                B.y = X.d(),
                                (B = this.T).x = X.d(),
                                B.y = X.d(),
                                this.I = X.d(),
                                this.r = X.d(),
                                this.F = X.d(),
                                this.N = X.d(),
                                this.b = X.ry(),
                                this.z = X.W(),
                                this.i = X.W()
                        },
                        dY: function (X) {
                            return X != this.SY && (this.u || (this.u = new I8),
                                this.SY = X,
                                I8.LY(this.u, this)),
                                this.u
                        }
                    }),
                    x0.LY = function (X, B, I) {
                        if (B.Z) {
                            X.Z || (X.Z = []);
                            for (var _, s = X.Z, r = B.Z, T0 = r.length; s.length > T0;)
                                s.pop();
                            for (T0 = 0,
                                _ = r.length; T0 < _; T0++)
                                s[T0] = r[T0].dY(I)
                        } else
                            X.Z = null;
                        X.k = B.k,
                            X.t = B.t,
                            X.M = B.M,
                            X._y = B._y
                    }
                    ,
                    x0.prototype = M(o.prototype, {
                        S: function (X) {
                            X.g(this.Z.length),
                                this.Z.forEach((B, I) => {
                                    B.vr = I,
                                        B.S(X)
                                }
                                )
                        },
                        D: function (X) {
                            this.Z = [];
                            for (var B = X.q(), I = 0; I < B; I++) {
                                var _ = new I8;
                                _.D(X),
                                    this.Ap(_)
                            }
                        },
                        dY: function (X) {
                            return X != this.SY && (this.u || (this.u = new x0),
                                this.SY = X,
                                x0.LY(this.u, this, X)),
                                this.u
                        },
                        AD: function (X, B, I) {
                            var _ = B.h
                                , s = X.h
                                , r = _.x - s.x;
                            if (_ = _.y - s.y,
                                !((s = Math.sqrt(r * r + _ * _)) - B.I - X.I >= 4)) {
                                var T0 = r / s
                                    , l0 = _ / s;
                                return B.Xz(I.Bj, T0, l0),
                                    X.Xz(-I.Kj, T0, l0),
                                    !0
                            }
                        },
                        SD: function (X, B) {
                            var I = X.Ly
                                , _ = ((8 & I) > 0) - ((4 & I) > 0)
                                , s = _ == 0
                                , r = ((2 & I) > 0) - ((1 & I) > 0)
                                , T0 = r == 0;
                            !s && !T0 && (_ *= F0,
                                r *= F0),
                                I = X.GY,
                                (!s || !T0) && (T0 = I ? B.Gj : B.aj,
                                    X.U.rh(_ * T0, r * T0)),
                                X.U.N = I ? B.vj : B.N
                        },
                        sr: function (X, B) {
                            X.U && (this.eO(X.U),
                                B?.(X),
                                X.U = null)
                        },
                        DD: function (X, B, I) {
                            X.Ly = 0;
                            var _ = X.U;
                            _ || ((_ = new I8).n = X.X,
                                X.U = _,
                                this.Ap(_),
                                I?.(X));
                            var s = B.aY;
                            _.b = 0,
                                _.I = s.I,
                                _.F = s.F,
                                _.N = s.N,
                                _.r = s.r,
                                _.z = 39,
                                _.i = X.c.i | s.i;
                            var r = X.c == N.Ty ? B.jY : B.XY;
                            r.length == 0 ? (_.h.x = X.c.Gr * B.vY,
                                _.h.y = 0) : (X = _.h,
                                    r = r[r.length - 1],
                                    X.x = r.x,
                                    X.y = r.y),
                                (r = _.P).x = 0,
                                r.y = 0,
                                _ = _.T,
                                s = s.T,
                                _.x = s.x,
                                _.y = s.y
                        }
                    }),
                    x0.bD = (X) => {
                        var B = new x0;
                        return B.k = X.k,
                            B.t = X.t,
                            B.ty = X.ty,
                            B.M = X.M,
                            B._y = X._y,
                            X.Z.forEach((I) => {
                                var _ = new I8;
                                return _.h.x = I.h.x,
                                    _.h.y = I.h.y,
                                    _.P.x = I.P.x,
                                    _.P.y = I.P.y,
                                    _.T.x = I.T.x,
                                    _.T.y = I.T.y,
                                    _.I = I.I,
                                    _.r = I.r,
                                    _.F = I.F,
                                    _.N = I.N,
                                    _.b = I.b,
                                    _.z = I.z,
                                    _.i = I.i,
                                    B.Ap(_),
                                    _
                            }
                            ),
                            B
                    }
                    ,
                    P(b0, [], ["cGroup", "cMask", "bCoef", "pos", "id"], []),
                    P(d0, [], ["normal", "v1Normal", "v0Normal", "arcRadius", "arcCenter", "v0", "v1", "bias", "bCoef", "cMask", "cGroup", "curveF", "vis", "color"], []),
                    P(H8, [], ["cGroup", "cMask", "bCoef", "dist", "normal"], []),
                    P(E0, [], ["p1", "p0", "team"], ["check"]),
                    P(v0, [], ["cGroup", "cMask", "damping", "invMass", "bCoef", "radius", "gravity", "speed", "pos", "color"], []),
                    P(G6, [], ["strength", "maxLength", "minLength", "d1", "d0", "color"], []),
                    P(I8, [], ["cGroup", "cMask", "damping", "invMass", "bCoef", "radius", "gravity", "speed", "pos", "playerId", null, "ext", null, "color"], []),
                    P(x0, [], ["discs", "vertices", "planes", "segments", "joints", "goals", null, "ext"], [null, null, null, "kickBall", null, null, null]);
                var U8 = {
                    HX: v,
                    kO: b0,
                    $O: d0,
                    qO: H8,
                    ur: E0,
                    CO: v0,
                    TO: G6,
                    VR: I8,
                    BR: x0
                }
                    , { K: { jA: t8 } } = J
                    , o8 = [];
                t8.yi = (X) => {
                    X && o8.push(X)
                }
                    ,
                    t8.Yi = (X) => {
                        if (X) {
                            var B = o8.indexOf(X);
                            B < 0 || o8.splice(B, 1)
                        }
                    }
                    ,
                    t8.gh = (X) => {
                        o8.forEach((B) => {
                            B._onLanguageChange?.(X?.abbr)
                        }
                        )
                    }
                    ;
                var c8 = t8
                    , { E: _8 } = J
                    , { HX: R6 } = U8;
                function n8() {
                    this.Kj = 0,
                        this.I = 15,
                        this.i = 0,
                        this.T = new R6(0, 0),
                        this.r = 0.5,
                        this.F = 0.5,
                        this.N = 0.96,
                        this.aj = 0.1,
                        this.Gj = 0.07,
                        this.vj = 0.96,
                        this.Bj = 5
                }
                n8.prototype = {
                    S: function (X) {
                        X.J(this.r),
                            X.J(this.F),
                            X.J(this.N),
                            X.J(this.aj),
                            X.J(this.Gj),
                            X.J(this.vj),
                            X.J(this.Bj);
                        var B = this.T;
                        X.J(B.x),
                            X.J(B.y),
                            X.m(this.i),
                            X.J(this.I),
                            X.J(this.Kj)
                    },
                    D: function (X) {
                        this.r = X.d(),
                            this.F = X.d(),
                            this.N = X.d(),
                            this.aj = X.d(),
                            this.Gj = X.d(),
                            this.vj = X.d(),
                            this.Bj = X.d();
                        var B = this.T;
                        B.x = X.d(),
                            B.y = X.d(),
                            this.i = X.W(),
                            this.I = X.d(),
                            this.Kj = X.d()
                    }
                },
                    _8(n8, [], ["kickback", "radius", "cGroup", "gravity", "bCoef", "invMass", "damping", "acceleration", "kickingAcceleration", "kickingDamping", "kickStrength"], []);
                var q6 = n8
                    , { E: K6, K: { kX: { Vy: k6 }, qR: { op: y6, BO: S6, UO: J8, MO: L0 }, Oy: { zO: { lO: d8 } } } } = J
                    , { HX: d6, kO: K8, $O: h8, qO: O0, ur: h0, CO: R8, TO: X6 } = U8;
                function k0() {
                    this.k = [],
                        this.t = [],
                        this.M = [],
                        this.ty = [],
                        this.Z = [],
                        this._y = [],
                        this.jY = [],
                        this.XY = [],
                        this.aY = new q6,
                        this.rO = 255,
                        this.sj = 0,
                        this.uj = 0,
                        this.qX = !0,
                        this.oj = !1,
                        this.L = "",
                        this.vY = 0,
                        this.ij = 0,
                        this.wY = 0,
                        this.hj = 0,
                        this._j = 0,
                        this.gj = 0,
                        this.Aj = 0,
                        this.Sj = 0,
                        this.pY = 0,
                        this.Hj = 0
                }
                var U6 = null;
                k0.D = function (X) {
                    var B = X.q();
                    return B == 255 ? ((B = new k0).D(X),
                        B) : k0.D5()[B]
                }
                    ,
                    k0.D5 = function () {
                        if (U6)
                            return U6;
                        U6 = [];
                        var X = new k0;
                        return X.yX("Classic", 420, 200, 370, 170, 64, 75),
                            U6.push(X),
                            (X = new k0).yX("Easy", 420, 200, 370, 170, 90, 75),
                            U6.push(X),
                            (X = new k0).yX("Small", 420, 200, 320, 130, 55, 70),
                            U6.push(X),
                            (X = new k0).yX("Big", 600, 270, 550, 240, 80, 80),
                            U6.push(X),
                            (X = new k0).yX("Rounded", 420, 200, 370, 170, 64, 75, 75),
                            U6.push(X),
                            (X = new k0).ji("Hockey", 420, 204, 398, 182, 68, 120, 75, 100),
                            U6.push(X),
                            (X = new k0).ji("Big Hockey", 600, 270, 550, 240, 90, 160, 75, 150),
                            U6.push(X),
                            (X = new k0).yX("Big Easy", 600, 270, 550, 240, 95, 80),
                            U6.push(X),
                            (X = new k0).yX("Big Rounded", 600, 270, 550, 240, 80, 75, 100),
                            U6.push(X),
                            (X = new k0).yX("Huge", 750, 350, 700, 320, 100, 80),
                            U6.push(X),
                            U6.forEach((B, I) => {
                                B.rO = I
                            }
                            ),
                            U6
                    }
                    ,
                    k0.JD = function (X, B) {
                        var I = B[X.trait];
                        I && Object.keys(I).forEach((_) => {
                            X[_] == null && (X[_] = I[_])
                        }
                        )
                    }
                    ,
                    k0.ZD = function (X) {
                        if (X == 63)
                            return ["all"];
                        var B = [];
                        return 2 & X && B.push("red"),
                            4 & X && B.push("blue"),
                            1 & X && B.push("ball"),
                            8 & X && B.push("redKO"),
                            16 & X && B.push("blueKO"),
                            32 & X && B.push("wall"),
                            64 & X && B.push("kick"),
                            128 & X && B.push("score"),
                            268435456 & X && B.push("c0"),
                            536870912 & X && B.push("c1"),
                            1073741824 & X && B.push("c2"),
                            -2147483648 & X && B.push("c3"),
                            B
                    }
                    ,
                    k0.tj = function (X) {
                        X = L0(X, Array);
                        var B = 0;
                        return X.forEach((I) => {
                            switch (I) {
                                case "ball":
                                    B |= 1;
                                    break;
                                case "red":
                                    B |= 2;
                                    break;
                                case "blue":
                                    B |= 4;
                                    break;
                                case "redKO":
                                    B |= 8;
                                    break;
                                case "blueKO":
                                    B |= 16;
                                    break;
                                case "wall":
                                    B |= 32;
                                    break;
                                case "kick":
                                    B |= 64;
                                    break;
                                case "score":
                                    B |= 128;
                                    break;
                                case "c0":
                                    B |= 268435456;
                                    break;
                                case "c1":
                                    B |= 536870912;
                                    break;
                                case "c2":
                                    B |= 1073741824;
                                    break;
                                case "c3":
                                    B |= -2147483648;
                                    break;
                                case "all":
                                    B |= 63
                            }
                        }
                        ),
                            B
                    }
                    ,
                    k0.sY = function (X, B, I, _) {
                        I != _ && (X[B] = k0.ZD(I))
                    }
                    ,
                    k0.pp = function (X, B, I) {
                        B != I && (B |= 0,
                            X.color = B < 0 ? "transparent" : y6(B))
                    }
                    ,
                    k0.Op = function (X) {
                        if (X == "transparent")
                            return -1;
                        if (typeof X == "string")
                            return S6("0x" + X);
                        if (X instanceof Array)
                            return ((0 | X[0]) << 16) + ((0 | X[1]) << 8) + (0 | X[2]);
                        throw k6(H.pr)
                    }
                    ,
                    k0.Xi = function (X) {
                        var B = {
                            x: X.h.x,
                            y: X.h.y
                        };
                        return k0.w(B, "bCoef", X.r, 1),
                            k0.sY(B, "cMask", X.z, 63),
                            k0.sY(B, "cGroup", X.i, 32),
                            B
                    }
                    ,
                    k0.fD = function (X) {
                        var B = new K8;
                        B.h.x = L0(X.x, Number),
                            B.h.y = L0(X.y, Number);
                        var I = X.bCoef;
                        return I != null && (B.r = L0(I, Number)),
                            (I = X.cMask) != null && (B.z = k0.tj(I)),
                            (I = X.cGroup) != null && (B.i = k0.tj(I)),
                            B
                    }
                    ,
                    k0.pi = function (X) {
                        var B = new K8;
                        B.h.x = L0(X.x, Number),
                            B.h.y = L0(X.y, Number);
                        var I = X.bCoef;
                        return I != null && (B.r = L0(I, Number)),
                            (I = X.cMask) != null && (B.z = L0(I, J8)),
                            (I = X.cGroup) != null && (B.i = L0(I, J8)),
                            B
                    }
                    ,
                    k0.LD = function (X, B) {
                        var I = {
                            v0: X.v.X,
                            v1: X.s.X
                        };
                        k0.w(I, "bias", X.ny, B.ny),
                            k0.w(I, "bCoef", X.r, B.r);
                        var _ = X.jz();
                        return k0.w(I, "curve", _, 0),
                            _ != 0 && (I.curveF = X.wy),
                            k0.w(I, "vis", X.by, B.by),
                            k0.sY(I, "cMask", X.z, B.z),
                            k0.sY(I, "cGroup", X.i, B.i),
                            k0.pp(I, X.b, B.b),
                            I
                    }
                    ,
                    k0.dD = function (X, B, I) {
                        var [_, s] = X.b5(B)
                            , r = {
                                v0: _,
                                v1: s
                            };
                        k0.w(r, "bias", B.ny, I.ny),
                            k0.w(r, "bCoef", B.r, I.r);
                        var T0 = B.jz();
                        return k0.w(r, "curve", T0, 0),
                            T0 != 0 && (r.curveF = B.wy),
                            k0.w(r, "vis", B.by, I.by),
                            k0.sY(r, "cMask", B.z, I.z),
                            k0.sY(r, "cGroup", B.i, I.i),
                            k0.pp(r, B.b, I.b),
                            r
                    }
                    ,
                    k0.eD = function (X, B) {
                        var I = new h8;
                        I.v = B[L0(X.v0, J8)],
                            I.s = B[L0(X.v1, J8)];
                        var _ = X.bias;
                        return _ != null && (I.ny = L0(_, Number)),
                            (_ = X.bCoef) != null && (I.r = L0(_, Number)),
                            (_ = X.curveF) != null ? I.wy = L0(_, Number) : (_ = X.curve) != null && I.LO(L0(_, Number)),
                            (_ = X.vis) != null && (I.by = L0(_, Boolean)),
                            (_ = X.cMask) != null && (I.z = k0.tj(_)),
                            (_ = X.cGroup) != null && (I.i = k0.tj(_)),
                            (_ = X.color) != null && (I.b = k0.Op(_)),
                            I
                    }
                    ,
                    k0.Oi = function (X, B) {
                        var I = new h8;
                        I.v = B[L0(X.v0, J8)],
                            I.s = B[L0(X.v1, J8)];
                        var _ = X.bias;
                        return _ != null && (I.ny = L0(_, Number)),
                            (_ = X.bCoef) != null && (I.r = L0(_, Number)),
                            (_ = X.curveF) != null ? I.wy = L0(_, Number) : (_ = X.curve) != null && I.LO(L0(_, Number)),
                            (_ = X.vis) != null && (I.by = L0(_, Boolean)),
                            (_ = X.cMask) != null && (I.z = L0(_, J8)),
                            (_ = X.cGroup) != null && (I.i = L0(_, J8)),
                            (_ = X.color) != null && (I.b = L0(_, J8)),
                            I
                    }
                    ,
                    k0.kD = function (X) {
                        var B = new h8;
                        B.v = X.v0,
                            B.s = X.v1;
                        var I = X.bias;
                        return I != null && (B.ny = L0(I, Number)),
                            (I = X.bCoef) != null && (B.r = L0(I, Number)),
                            (I = X.curveF) != null ? B.wy = L0(I, Number) : (I = X.curve) != null && B.LO(L0(I, Number)),
                            (I = X.vis) != null && (B.by = L0(I, Boolean)),
                            (I = X.cMask) != null && (B.z = L0(I, J8)),
                            (I = X.cGroup) != null && (B.i = L0(I, J8)),
                            (I = X.color) != null && (B.b = L0(I, J8)),
                            B
                    }
                    ,
                    k0.Ri = function (X) {
                        var B = {
                            d0: X.vy,
                            d1: X.ay,
                            length: X.dy >= X.Cy ? X.dy : [X.dy, X.Cy]
                        };
                        return k0.pp(B, X.b, 0),
                            k0.w(B, "strength", X.$Y, 1 / 0),
                            B
                    }
                    ,
                    k0.$D = function (X, B) {
                        var I = new X6
                            , _ = L0(X.d0, J8)
                            , s = L0(X.d1, J8)
                            , r = X.length;
                        if (_ < 0 || _ >= B.length || s < 0 || s >= B.length)
                            throw null;
                        return I.vy = _,
                            I.ay = s,
                            r == null ? (_ = B[_],
                                s = B[s],
                                I.Cy = I.dy = _ && s ? Math.sqrt((_.h.x - s.h.x) ** 2 + (_.h.y - s.h.y) ** 2) : 100) : r instanceof Array ? (I.dy = L0(r[0], Number),
                                    I.Cy = L0(r[1], Number)) : I.Cy = I.dy = L0(r, Number),
                            _ = X.strength,
                            I.$Y = _ == null || _ == "rigid" ? 1 / 0 : L0(_, Number),
                            (_ = X.color) != null && (I.b = k0.Op(_)),
                            I
                    }
                    ,
                    k0.xi = function (X, B) {
                        var I = new X6
                            , _ = L0(X.d0, J8)
                            , s = L0(X.d1, J8)
                            , r = X.length;
                        if (_ < 0 || _ >= B.length || s < 0 || s >= B.length)
                            throw null;
                        return I.vy = _,
                            I.ay = s,
                            r == null ? (_ = B[_],
                                s = B[s],
                                I.Cy = I.dy = _ && s ? Math.sqrt((_.h.x - s.h.x) ** 2 + (_.h.y - s.h.y) ** 2) : 100) : r instanceof Array ? (I.dy = L0(r[0], Number),
                                    I.Cy = L0(r[1], Number)) : I.Cy = I.dy = L0(r, Number),
                            _ = X.strength,
                            I.$Y = _ == null || _ == "rigid" ? 1 / 0 : L0(_, Number),
                            (_ = X.color) != null && (I.b = L0(_, J8)),
                            I
                    }
                    ,
                    k0.qD = function (X) {
                        var B = new X6
                            , I = X.d0
                            , _ = X.d1
                            , s = X.length;
                        return B.d0Obj = I,
                            B.d1Obj = _,
                            s == null ? B.Cy = B.dy = I && _ ? Math.sqrt((I.h.x - _.h.x) ** 2 + (I.h.y - _.h.y) ** 2) : 100 : s instanceof Array ? (B.dy = L0(s[0], Number),
                                B.Cy = L0(s[1], Number)) : B.Cy = B.dy = L0(s, Number),
                            I = X.strength,
                            B.$Y = I == null || I == "rigid" ? 1 / 0 : L0(I, Number),
                            (I = X.color) != null && (B.b = L0(I, J8)),
                            B
                    }
                    ,
                    k0.zi = function (X) {
                        var B = {
                            normal: [X.qy.x, X.qy.y],
                            dist: X.xy
                        };
                        return k0.w(B, "bCoef", X.r, 1),
                            k0.sY(B, "cMask", X.z, 63),
                            k0.sY(B, "cGroup", X.i, 32),
                            B
                    }
                    ,
                    k0.CD = function (X) {
                        var B = new O0
                            , I = L0(X.normal, Array)
                            , _ = L0(I[0], Number)
                            , s = L0(I[1], Number)
                            , r = Math.sqrt(_ * _ + s * s);
                        return B.qy.x = _ / r,
                            B.qy.y = s / r,
                            B.xy = L0(X.dist, Number),
                            (I = X.bCoef) != null && (B.r = L0(I, Number)),
                            (I = X.cMask) != null && (B.z = k0.tj(I)),
                            (I = X.cGroup) != null && (B.i = k0.tj(I)),
                            B
                    }
                    ,
                    k0.li = function (X) {
                        var B = new O0
                            , I = L0(X.normal, Array)
                            , _ = L0(I[0], Number)
                            , s = L0(I[1], Number)
                            , r = Math.sqrt(_ * _ + s * s);
                        return B.qy.x = _ / r,
                            B.qy.y = s / r,
                            B.xy = L0(X.dist, Number),
                            (I = X.bCoef) != null && (B.r = L0(I, Number)),
                            (I = X.cMask) != null && (B.z = L0(I, J8)),
                            (I = X.cGroup) != null && (B.i = L0(I, J8)),
                            B
                    }
                    ,
                    k0.ri = function (X) {
                        return {
                            p0: [X.iY.x, X.iY.y],
                            p1: [X.rY.x, X.rY.y],
                            team: X.c == N.Ty ? "red" : "blue"
                        }
                    }
                    ,
                    k0.J5 = function (X) {
                        var B = new h0
                            , I = L0(X.p0, Array);
                        switch (B.iY.x = I[0],
                        B.iY.y = I[1],
                        I = L0(X.p1, Array),
                        B.rY.x = I[0],
                        B.rY.y = I[1],
                        X.team) {
                            case "blue":
                                I = N.yY;
                                break;
                            case "red":
                                I = N.Ty;
                                break;
                            default:
                                throw k6(H.Or)
                        }
                        return B.c = I,
                            B
                    }
                    ,
                    k0.ii = function (X) {
                        var B = {};
                        return k0.w(B, "bCoef", X.r, 0.5),
                            k0.w(B, "invMass", X.F, 0.5),
                            k0.w(B, "damping", X.N, 0.96),
                            k0.w(B, "acceleration", X.aj, 0.1),
                            k0.w(B, "kickingAcceleration", X.Gj, 0.07),
                            k0.w(B, "kickingDamping", X.vj, 0.96),
                            k0.w(B, "kickStrength", X.Bj, 5),
                            k0.sY(B, "cGroup", X.i, 0),
                            (X.T.x != 0 || X.T.y != 0) && (B.gravity = [X.T.x, X.T.y]),
                            k0.w(B, "radius", X.I, 15),
                            k0.w(B, "kickback", X.Kj, 0),
                            B
                    }
                    ,
                    k0.TD = function (X) {
                        var B, I = new q6;
                        return (B = X.bCoef) != null && (I.r = L0(B, Number)),
                            (B = X.invMass) != null && (I.F = L0(B, Number)),
                            (B = X.damping) != null && (I.N = L0(B, Number)),
                            (B = X.acceleration) != null && (I.aj = L0(B, Number)),
                            (B = X.kickingAcceleration) != null && (I.Gj = L0(B, Number)),
                            (B = X.kickingDamping) != null && (I.vj = L0(B, Number)),
                            (B = X.kickStrength) != null && (I.Bj = L0(B, Number)),
                            (B = X.gravity) != null && (I.T.x = L0(B[0], Number),
                                I.T.y = L0(B[1], Number)),
                            (B = X.cGroup) != null && (I.i = k0.tj(B)),
                            (B = X.radius) != null && (I.I = L0(B, Number)),
                            (B = X.kickback) != null && (I.Kj = L0(B, Number)),
                            I
                    }
                    ,
                    k0.hi = function (X, B) {
                        var I = {};
                        return (X.h.x != B.h.x || X.h.y != B.h.y) && (I.pos = [X.h.x, X.h.y]),
                            (X.P.x != B.P.x || X.P.y != B.P.y) && (I.speed = [X.P.x, X.P.y]),
                            (X.T.x != B.T.x || X.T.y != B.T.y) && (I.gravity = [X.T.x, X.T.y]),
                            k0.w(I, "radius", X.I, B.I),
                            k0.w(I, "bCoef", X.r, B.r),
                            k0.w(I, "invMass", X.F, B.F),
                            k0.w(I, "damping", X.N, B.N),
                            k0.pp(I, X.b, B.b),
                            k0.sY(I, "cMask", X.z, B.z),
                            k0.sY(I, "cGroup", X.i, B.i),
                            I
                    }
                    ,
                    k0._i = function (X, B) {
                        var I;
                        return (I = X.pos) != null && (B.h.x = I[0],
                            B.h.y = I[1]),
                            (I = X.speed) != null && (B.P.x = I[0],
                                B.P.y = I[1]),
                            (I = X.gravity) != null && (B.T.x = I[0],
                                B.T.y = I[1]),
                            (I = X.radius) != null && (B.I = L0(I, Number)),
                            (I = X.bCoef) != null && (B.r = L0(I, Number)),
                            (I = X.invMass) != null && (B.F = L0(I, Number)),
                            (I = X.damping) != null && (B.N = L0(I, Number)),
                            (I = X.color) != null && (B.b = k0.Op(I)),
                            (I = X.cMask) != null && (B.z = k0.tj(I)),
                            (I = X.cGroup) != null && (B.i = k0.tj(I)),
                            B
                    }
                    ,
                    k0.Z5 = function (X, B) {
                        var I;
                        return (I = X.pos) != null && (B.h.x = I[0],
                            B.h.y = I[1]),
                            (I = X.speed) != null && (B.P.x = I[0],
                                B.P.y = I[1]),
                            (I = X.gravity) != null && (B.T.x = I[0],
                                B.T.y = I[1]),
                            (I = X.radius) != null && (B.I = L0(I, Number)),
                            (I = X.bCoef) != null && (B.r = L0(I, Number)),
                            (I = X.invMass) != null && (B.F = L0(I, Number)),
                            (I = X.damping) != null && (B.N = L0(I, Number)),
                            (I = X.color) != null && (B.b = L0(I, J8)),
                            (I = X.cMask) != null && (B.z = L0(I, J8)),
                            (I = X.cGroup) != null && (B.i = L0(I, J8)),
                            B
                    }
                    ,
                    k0.w = function (X, B, I, _) {
                        I != _ && (X[B] = I)
                    }
                    ,
                    k0.prototype = {
                        TR: function () {
                            var X = new R8;
                            return X.b = 16777215,
                                X.z = 63,
                                X.i = 193,
                                X.I = 10,
                                X.N = 0.99,
                                X.F = 1,
                                X.r = 0.5,
                                X
                        },
                        S: function (X) {
                            X.g(this.rO),
                                !this.f5() && (X.AY(this.L),
                                    X.m(this.wY),
                                    X.J(this._j),
                                    X.J(this.gj),
                                    X.J(this.Aj),
                                    X.J(this.Sj),
                                    X.J(this.Hj),
                                    X.m(this.hj),
                                    X.J(this.vY),
                                    X.J(this.ij),
                                    X.J(this.pY),
                                    this.aY.S(X),
                                    X.My(this.sj),
                                    X.g(this.uj),
                                    X.g(this.qX ? 1 : 0),
                                    X.g(this.oj ? 1 : 0),
                                    X.g(this.k.length),
                                    this.k.forEach((B, I) => {
                                        B.X = I,
                                            B.S(X)
                                    }
                                    ),
                                    X.g(this.t.length),
                                    this.t.forEach((B) => B.S(X)),
                                    X.g(this.M.length),
                                    this.M.forEach((B) => B.S(X)),
                                    X.g(this.ty.length),
                                    this.ty.forEach((B) => B.S(X)),
                                    X.g(this.Z.length),
                                    this.Z.forEach((B) => B.S(X)),
                                    X.g(this._y.length),
                                    this._y.forEach((B) => B.S(X)),
                                    X.g(this.jY.length),
                                    this.jY.forEach((B) => {
                                        X.J(B.x),
                                            X.J(B.y)
                                    }
                                    ),
                                    X.g(this.XY.length),
                                    this.XY.forEach((B) => {
                                        X.J(B.x),
                                            X.J(B.y)
                                    }
                                    ))
                        },
                        D: function (X) {
                            function B(_, s = !1, r = void 0) {
                                for (var T0 = [], l0 = X.q(), g0 = 0; g0 < l0; g0++) {
                                    var D8 = new _;
                                    D8.D(X, r),
                                        s && (D8.X = g0),
                                        T0.push(D8)
                                }
                                return T0
                            }
                            function I() {
                                for (var _ = [], s = X.q(), r = 0; r < s; r++)
                                    _.push(new d6(X.d(), X.d()));
                                return _
                            }
                            this.L = X.gY(),
                                this.wY = X.W(),
                                this._j = X.d(),
                                this.gj = X.d(),
                                this.Aj = X.d(),
                                this.Sj = X.d(),
                                this.Hj = X.d(),
                                this.hj = X.W(),
                                this.vY = X.d(),
                                this.ij = X.d(),
                                this.pY = X.d(),
                                this.aY.D(X),
                                this.sj = X.By(),
                                this.uj = X.q(),
                                this.qX = X.q() != 0,
                                this.oj = X.q() != 0,
                                this.k = B(K8, !0),
                                this.t = B(h8, !1, this.k),
                                this.M = B(O0),
                                this.ty = B(h0),
                                this.Z = B(R8),
                                this._y = B(X6),
                                this.jY = I(),
                                this.XY = I(),
                                this.UY()
                        },
                        UY: function () {
                            this.t.forEach((X) => X.UY())
                        },
                        f5: function () {
                            return this.rO != 255
                        },
                        Rp: function (X, B, I) {
                            return (X = X[B]) != null ? L0(X, Number) : I
                        },
                        PD: function (X, B, I) {
                            return (X = X[B]) != null ? L0(X, Boolean) : I
                        },
                        cD: function () {
                            return JSON.stringify(this.oD())
                        },
                        oD: function () {
                            var X, B, I = {
                                name: this.L,
                                width: this.vY,
                                height: this.ij,
                                ballPhysics: "disc0"
                            };
                            switch (I.vertexes = B = [],
                            this.k.forEach((_, s) => {
                                _.X = s,
                                    B.push(k0.Xi(_))
                            }
                            ),
                            I.segments = B = [],
                            X = new h8,
                            this.t.forEach((_) => B.push(k0.LD(_, X))),
                            I.planes = B = [],
                            this.M.forEach((_) => B.push(k0.zi(_))),
                            I.goals = B = [],
                            this.ty.forEach((_) => B.push(k0.ri(_))),
                            I.playerPhysics = k0.ii(this.aY),
                            X = new R8,
                            I.discs = B = [],
                            this.Z.forEach((_) => B.push(k0.hi(_, X))),
                            k0.w(I, "maxViewWidth", this.sj, 0),
                            k0.w(I, "cameraFollow", this.uj == 1 ? "player" : "", ""),
                            k0.w(I, "spawnDistance", this.pY, 200),
                            this._y.length > 0 && (I.joints = B = [],
                                this._y.forEach((_) => B.push(k0.Ri(_)))),
                            this.jY.length > 0 && (I.redSpawnPoints = B = [],
                                this.jY.forEach((_) => B.push([_.x, _.y]))),
                            this.XY.length > 0 && (I.blueSpawnPoints = B = [],
                                this.XY.forEach((_) => B.push([_.x, _.y]))),
                            k0.w(I, "kickOffReset", this.oj ? "full" : "partial", "partial"),
                            this.wY) {
                                case 1:
                                    X = "grass";
                                    break;
                                case 2:
                                    X = "hockey";
                                    break;
                                default:
                                    X = "none"
                            }
                            return I.bg = B = {},
                                k0.w(B, "type", X, "none"),
                                k0.w(B, "width", this._j, 0),
                                k0.w(B, "height", this.gj, 0),
                                k0.w(B, "kickOffRadius", this.Aj, 0),
                                k0.w(B, "cornerRadius", this.Sj, 0),
                                k0.pp(B, this.hj, 7441498),
                                k0.w(B, "goalLine", this.Hj, 0),
                                I
                        },
                        HD: function (X) {
                            var B = this;
                            X = J.rz.parse(X),
                                this.k = [],
                                this.t = [],
                                this.M = [],
                                this.ty = [],
                                this.Z = [],
                                this._y = [],
                                this.L = L0(X.name, String),
                                this.vY = L0(X.width, Number),
                                this.ij = L0(X.height, Number),
                                this.sj = 0 | this.Rp(X, "maxViewWidth", 0),
                                X.cameraFollow == "player" && (this.uj = 1),
                                this.pY = 200;
                            var I = X.spawnDistance;
                            I != null && (this.pY = L0(I, Number));
                            var _ = 0;
                            switch ((I = X.bg).type) {
                                case "grass":
                                    _ = 1;
                                    break;
                                case "hockey":
                                    _ = 2
                            }
                            this.wY = _,
                                this._j = this.Rp(I, "width", 0),
                                this.gj = this.Rp(I, "height", 0),
                                this.Aj = this.Rp(I, "kickOffRadius", 0),
                                this.Sj = this.Rp(I, "cornerRadius", 0),
                                this.hj = 7441498,
                                I.color != null && (this.hj = k0.Op(I.color)),
                                this.Hj = this.Rp(I, "goalLine", 0),
                                this.qX = this.PD(X, "canBeStored", !0),
                                this.oj = X.kickOffReset == "full";
                            var s = X.traits || {};
                            function r(l0) {
                                return new d6(L0(l0[0], Number), L0(l0[1], Number))
                            }
                            function T0(l0, g0, D8, J6 = !1) {
                                var P8 = X[g0];
                                J6 && P8 == null || (P8 = L0(P8, Array),
                                    P8?.forEach((Q7) => {
                                        try {
                                            k0.JD(Q7, s),
                                                l0.push(D8(Q7))
                                        } catch {
                                            throw k6(H.yr, g0, l0.length)
                                        }
                                    }
                                    ))
                            }
                            if ((_ = X.ballPhysics) != "disc0" && (_ == null ? this.Z.push(this.TR()) : ((_ = k0._i(_, this.TR())).i |= 192,
                                this.Z.push(_))),
                                T0(this.k, "vertexes", k0.fD),
                                T0(this.t, "segments", (l0) => k0.eD(l0, B.k)),
                                T0(this.ty, "goals", k0.J5),
                                T0(this.Z, "discs", (l0) => k0._i(l0, new R8)),
                                T0(this.M, "planes", k0.CD),
                                T0(this._y, "joints", (l0) => k0.$D(l0, B.Z), !0),
                                T0(this.jY, "redSpawnPoints", r, !0),
                                T0(this.XY, "blueSpawnPoints", r, !0),
                                (_ = X.playerPhysics) != null && (this.aY = k0.TD(_)),
                                this.k.length > 255 || this.t.length > 255 || this.M.length > 255 || this.ty.length > 255 || this.Z.length < 1 || this.Z.length > 255)
                                throw k6(H.Rr);
                            this.UY()
                        },
                        calculateHash: function () {
                            var X = d8.j(1024);
                            return this.S(X),
                                ((B) => {
                                    var I = 0;
                                    return B.forEach((_) => {
                                        I += _,
                                            I += I << 10,
                                            I ^= I >>> 6
                                    }
                                    ),
                                        I += I << 3,
                                        I ^= I >>> 11,
                                        0 | (I += I << 15)
                                }
                                )(X.my())
                        },
                        calculateChecksum: function () {
                            return this.f5() ? null : y6(this.calculateHash(), 8)
                        },
                        yX: function (X, B, I, _, s, r, T0, l0 = 0) {
                            this.L = X,
                                this.Z.push(this.TR()),
                                this.vY = B,
                                this.ij = I,
                                this.wY = 1,
                                this.hj = 7441498,
                                this._j = _,
                                this.gj = s,
                                this.Aj = T0,
                                this.Sj = l0,
                                this.pY = 0.75 * _,
                                this.pY > 400 && (this.pY = 400),
                                this.M.push(new O0({
                                    zY: 0,
                                    lY: 1,
                                    xy: -I,
                                    r: 0
                                })),
                                this.M.push(new O0({
                                    zY: 0,
                                    lY: -1,
                                    xy: -I,
                                    r: 0
                                })),
                                this.M.push(new O0({
                                    zY: 1,
                                    lY: 0,
                                    xy: -B,
                                    r: 0
                                })),
                                this.M.push(new O0({
                                    zY: -1,
                                    lY: 0,
                                    xy: -B,
                                    r: 0
                                })),
                                this.PR(_, 1, r, 13421823, N.yY),
                                this.PR(-_, -1, r, 16764108, N.Ty),
                                this.gi(T0, I),
                                this.M.push(new O0({
                                    zY: 0,
                                    lY: 1,
                                    xy: -s,
                                    z: 1
                                })),
                                this.M.push(new O0({
                                    zY: 0,
                                    lY: -1,
                                    xy: -s,
                                    z: 1
                                }));
                            var g0 = new K8({
                                iy: -_,
                                hy: -s,
                                z: 0
                            })
                                , D8 = new K8({
                                    iy: _,
                                    hy: -s,
                                    z: 0
                                })
                                , J6 = new K8({
                                    iy: _,
                                    hy: -r,
                                    z: 0
                                })
                                , P8 = new K8({
                                    iy: _,
                                    hy: r,
                                    z: 0
                                })
                                , Q7 = new K8({
                                    iy: _,
                                    hy: s,
                                    z: 0
                                })
                                , FJ = new K8({
                                    iy: -_,
                                    hy: s,
                                    z: 0
                                })
                                , ZJ = new K8({
                                    iy: -_,
                                    hy: r,
                                    z: 0
                                })
                                , N5 = new K8({
                                    iy: -_,
                                    hy: -r,
                                    z: 0
                                });
                            this.k.push(g0),
                                this.k.push(D8),
                                this.k.push(J6),
                                this.k.push(P8),
                                this.k.push(Q7),
                                this.k.push(FJ),
                                this.k.push(ZJ),
                                this.k.push(N5),
                                this.t.push(new h8({
                                    v: D8,
                                    s: J6,
                                    z: 1,
                                    by: !1
                                })),
                                this.t.push(new h8({
                                    v: P8,
                                    s: Q7,
                                    z: 1,
                                    by: !1
                                })),
                                this.t.push(new h8({
                                    v: FJ,
                                    s: ZJ,
                                    z: 1,
                                    by: !1
                                })),
                                this.t.push(new h8({
                                    v: N5,
                                    s: g0,
                                    z: 1,
                                    by: !1
                                })),
                                this.Ai(_, s, l0),
                                this.UY()
                        },
                        ji: function (X, B, I, _, s, r, T0, l0, g0) {
                            this.L = X,
                                this.Z.push(this.TR()),
                                this.vY = B,
                                this.ij = I,
                                this.wY = 2,
                                this._j = _,
                                this.gj = s,
                                this.Aj = l0,
                                this.Sj = g0,
                                this.Hj = T0,
                                this.pY = 0.75 * (_ - T0),
                                this.pY > 400 && (this.pY = 400),
                                this.M.push(new O0({
                                    zY: 0,
                                    lY: 1,
                                    xy: -I,
                                    r: 0
                                })),
                                this.M.push(new O0({
                                    zY: 0,
                                    lY: -1,
                                    xy: -I,
                                    r: 0
                                })),
                                this.M.push(new O0({
                                    zY: 1,
                                    lY: 0,
                                    xy: -B,
                                    r: 0
                                })),
                                this.M.push(new O0({
                                    zY: -1,
                                    lY: 0,
                                    xy: -B,
                                    r: 0
                                })),
                                this.PR(_ - T0, 1, r, 13421823, N.yY, 63),
                                this.PR(-_ + T0, -1, r, 16764108, N.Ty, 63),
                                this.gi(l0, I),
                                this.M.push(new O0({
                                    zY: 0,
                                    lY: 1,
                                    xy: -s,
                                    z: 1
                                })),
                                this.M.push(new O0({
                                    zY: 0,
                                    lY: -1,
                                    xy: -s,
                                    z: 1
                                })),
                                this.M.push(new O0({
                                    zY: 1,
                                    lY: 0,
                                    xy: -_,
                                    z: 1
                                })),
                                this.M.push(new O0({
                                    zY: -1,
                                    lY: 0,
                                    xy: -_,
                                    z: 1
                                })),
                                this.Ai(_, s, g0),
                                this.UY()
                        },
                        PR: function (X, B, I, _, s, r = 1, T0 = 32) {
                            var l0 = new K8({
                                iy: X + 8 * B,
                                hy: -I,
                                z: r,
                                i: T0,
                                r: 0.1
                            })
                                , g0 = new K8({
                                    iy: X + 8 * B,
                                    hy: I,
                                    z: r,
                                    i: T0,
                                    r: 0.1
                                })
                                , D8 = new K8({
                                    iy: X + 30 * B,
                                    hy: 22 - I,
                                    z: r,
                                    i: T0,
                                    r: 0.1
                                })
                                , J6 = new K8({
                                    iy: X + 30 * B,
                                    hy: I - 22,
                                    z: r,
                                    i: T0,
                                    r: 0.1
                                });
                            this.k.push(l0),
                                this.k.push(g0),
                                this.k.push(D8),
                                this.k.push(J6),
                                this.t.push(new h8({
                                    v: l0,
                                    s: D8,
                                    z: r,
                                    i: T0,
                                    r: 0.1,
                                    cj: 90 * B
                                })),
                                this.t.push(new h8({
                                    v: J6,
                                    s: D8,
                                    z: r,
                                    i: T0,
                                    r: 0.1
                                })),
                                this.t.push(new h8({
                                    v: J6,
                                    s: g0,
                                    z: r,
                                    i: T0,
                                    r: 0.1,
                                    cj: 90 * B
                                })),
                                this.Z.push(new R8({
                                    iy: X,
                                    hy: -I,
                                    F: 0,
                                    I: 8,
                                    b: _
                                })),
                                this.Z.push(new R8({
                                    iy: X,
                                    hy: I,
                                    F: 0,
                                    I: 8,
                                    b: _
                                })),
                                this.ty.push(new h0({
                                    Rh: X,
                                    xh: -I,
                                    zh: X,
                                    lh: I,
                                    c: s
                                }))
                        },
                        gi: function (X, B) {
                            var I = new K8({
                                iy: 0,
                                hy: -B,
                                r: 0.1,
                                i: 24,
                                z: 6
                            })
                                , _ = new K8({
                                    iy: 0,
                                    hy: -X,
                                    r: 0.1,
                                    i: 24,
                                    z: 6
                                })
                                , s = new K8({
                                    iy: 0,
                                    hy: X,
                                    r: 0.1,
                                    i: 24,
                                    z: 6
                                })
                                , r = new K8({
                                    iy: 0,
                                    hy: B,
                                    r: 0.1,
                                    i: 24,
                                    z: 6
                                });
                            this.k.push(I),
                                this.k.push(_),
                                this.k.push(s),
                                this.k.push(r),
                                this.t.push(new h8({
                                    v: I,
                                    s: _,
                                    r: 0.1,
                                    i: 24,
                                    z: 6,
                                    by: !1
                                })),
                                this.t.push(new h8({
                                    v: s,
                                    s: r,
                                    r: 0.1,
                                    i: 24,
                                    z: 6,
                                    by: !1
                                })),
                                this.t.push(new h8({
                                    v: _,
                                    s,
                                    r: 0.1,
                                    i: 8,
                                    z: 6,
                                    by: !1,
                                    cj: 180
                                })),
                                this.t.push(new h8({
                                    v: s,
                                    s: _,
                                    r: 0.1,
                                    i: 16,
                                    z: 6,
                                    by: !1,
                                    cj: 180
                                }))
                        },
                        Ai: function (X, B, I) {
                            if (!(I <= 0)) {
                                var _ = new K8({
                                    iy: -X + I,
                                    hy: -B,
                                    z: 0
                                })
                                    , s = new K8({
                                        iy: -X,
                                        hy: -B + I,
                                        z: 0
                                    })
                                    , r = new K8({
                                        iy: -X + I,
                                        hy: B,
                                        z: 0
                                    })
                                    , T0 = new K8({
                                        iy: -X,
                                        hy: B - I,
                                        z: 0
                                    })
                                    , l0 = new K8({
                                        iy: X - I,
                                        hy: B,
                                        z: 0
                                    })
                                    , g0 = new K8({
                                        iy: X,
                                        hy: B - I,
                                        z: 0
                                    })
                                    , D8 = new K8({
                                        iy: X - I,
                                        hy: -B,
                                        z: 0
                                    })
                                    , J6 = new K8({
                                        iy: X,
                                        hy: -B + I,
                                        z: 0
                                    });
                                this.k.push(_),
                                    this.k.push(s),
                                    this.k.push(r),
                                    this.k.push(T0),
                                    this.k.push(l0),
                                    this.k.push(g0),
                                    this.k.push(D8),
                                    this.k.push(J6),
                                    this.t.push(new h8({
                                        v: _,
                                        s,
                                        r: 1,
                                        z: 1,
                                        by: !1,
                                        cj: -90
                                    })),
                                    this.t.push(new h8({
                                        v: r,
                                        s: T0,
                                        r: 1,
                                        z: 1,
                                        by: !1,
                                        cj: 90
                                    })),
                                    this.t.push(new h8({
                                        v: l0,
                                        s: g0,
                                        r: 1,
                                        z: 1,
                                        by: !1,
                                        cj: -90
                                    })),
                                    this.t.push(new h8({
                                        v: D8,
                                        s: J6,
                                        r: 1,
                                        z: 1,
                                        by: !1,
                                        cj: 90
                                    }))
                            }
                        },
                        copy: function () {
                            var X = new k0
                                , B = this;
                            X.rO = B.rO,
                                X.L = B.L,
                                X.wY = B.wY,
                                X._j = B._j,
                                X.gj = B.gj,
                                X.Aj = B.Aj,
                                X.Sj = B.Sj,
                                X.Hj = B.Hj,
                                X.hj = B.hj,
                                X.vY = B.vY,
                                X.ij = B.ij,
                                X.pY = B.pY;
                            var I = X.aY
                                , _ = B.aY;
                            return I.r = _.r,
                                I.F = _.F,
                                I.N = _.N,
                                I.aj = _.aj,
                                I.Gj = _.Gj,
                                I.vj = _.vj,
                                I.Bj = _.Bj,
                                I.T.x = _.T.x,
                                I.T.y = _.T.y,
                                I.i = _.i,
                                I.I = _.I,
                                I.Kj = _.Kj,
                                X.sj = B.sj,
                                X.uj = B.uj,
                                X.qX = B.qX,
                                X.oj = B.oj,
                                X.k = B.k.map((s, r) => {
                                    var T0 = new K8;
                                    return T0.h.x = s.h.x,
                                        T0.h.y = s.h.y,
                                        T0.r = s.r,
                                        T0.z = s.z,
                                        T0.i = s.i,
                                        T0.X = r,
                                        T0
                                }
                                ),
                                X.t = B.t.map((s) => {
                                    var r = new h8
                                        , T0 = s.v
                                        , l0 = s.s
                                        , g0 = -1
                                        , D8 = -1;
                                    return B.k.forEach((J6, P8) => {
                                        J6 == T0 ? g0 = P8 : J6 == l0 && (D8 = P8)
                                    }
                                    ),
                                        r.v = X.k[g0],
                                        r.s = X.k[D8],
                                        r.ny = s.ny,
                                        r.wy = s.wy,
                                        r.b = s.b,
                                        r.by = s.by,
                                        r.r = s.r,
                                        r.z = s.z,
                                        r.i = s.i,
                                        r
                                }
                                ),
                                X.M = B.M.map((s) => {
                                    var r = new O0;
                                    return r.qy.x = s.qy.x,
                                        r.qy.y = s.qy.y,
                                        r.xy = s.xy,
                                        r.r = s.r,
                                        r.z = s.z,
                                        r.i = s.i,
                                        r
                                }
                                ),
                                X.ty = B.ty.map((s) => {
                                    var r = new h0;
                                    return r.iY.x = s.iY.x,
                                        r.iY.y = s.iY.y,
                                        r.rY.x = s.rY.x,
                                        r.rY.y = s.rY.y,
                                        r.c = s.c,
                                        r
                                }
                                ),
                                X.Z = B.Z.map((s) => {
                                    var r = new R8;
                                    return r.h.x = s.h.x,
                                        r.h.y = s.h.y,
                                        r.P.x = s.P.x,
                                        r.P.y = s.P.y,
                                        r.T.x = s.T.x,
                                        r.T.y = s.T.y,
                                        r.I = s.I,
                                        r.r = s.r,
                                        r.F = s.F,
                                        r.N = s.N,
                                        r.b = s.b,
                                        r.z = s.z,
                                        r.i = s.i,
                                        r
                                }
                                ),
                                X._y = B._y.map((s) => {
                                    var r = new X6;
                                    return r.vy = s.vy,
                                        r.ay = s.ay,
                                        r.dy = s.dy,
                                        r.Cy = s.Cy,
                                        r.$Y = s.$Y,
                                        r.b = s.b,
                                        r
                                }
                                ),
                                X.jY = B.jY.map((s) => new d6(s.x, s.y)),
                                X.XY = B.XY.map((s) => new d6(s.x, s.y)),
                                X.UY(),
                                X
                        }
                    },
                    Object.defineProperty(k0.prototype, "isCustom", {
                        get: function () {
                            return !this.f5()
                        }
                    }),
                    K6(k0, [], ["vertices", "segments", "planes", "goals", "discs", "joints", "redSpawnPoints", "blueSpawnPoints", "playerPhysics", "defaultStadiumId", "maxViewWidth", "cameraFollow", "canBeStored", "fullKickOffReset", "name", "width", "height", "bgType", "bgColor", "bgWidth", "bgHeight", "bgKickOffRadius", "bgCornerRadius", "spawnDistance", "bgGoalLine"], []);
                var V8 = k0
                    , { HX: o0, BR: C0, VR: K0 } = U8;
                function J0() {
                    this.SY = -1,
                        this.u = null,
                        this.xY = 0,
                        this.Dj = 0,
                        this.IY = 0,
                        this.EY = 0,
                        this.YX = N.Ty,
                        this.O = 0,
                        this.mY = 0,
                        this.A = new C0,
                        this.Py = 0,
                        this.Wy = 5,
                        this.e = null,
                        this.ly = null
                }
                var V0, t = [], c = [];
                for (V0 = 0; V0 < 256; V0++)
                    t.push(new o0(0, 0)),
                        c.push(0);
                J0.LY = function (X, B, I) {
                    X.ly = B.ly.dY(I),
                        X.Wy = B.Wy,
                        X.Py = B.Py,
                        X.A = B.A.dY(I),
                        X.mY = B.mY,
                        X.O = B.O,
                        X.EY = B.EY,
                        X.IY = B.IY,
                        X.Dj = B.Dj,
                        X.xY = B.xY,
                        X.e = B.e,
                        X.YX = B.YX
                }
                    ,
                    J0.prototype = {
                        tD: function (X) {
                            this.ly = X,
                                this.Wy = X.Wy,
                                this.Py = X.Py,
                                this.e = X.e,
                                this.A = C0.bD(X.e),
                                this.Si()
                        },
                        Di: function (X) {
                            X.c == N.bY ? this.A.sr(X, this.ly.xp) : this.A.DD(X, this.e, this.ly.L5)
                        },
                        WD: function (X, B) {
                            return this.e.ty.findIndex((I) => I.FR(X, B))
                        },
                        Qy: function (X) {
                            var B = this;
                            if (B.xY > 0)
                                B.xY < 120 && B.xY--;
                            else {
                                B.ly.d5?.();
                                var I = B.e.aY
                                    , _ = B.ly.o;
                                _.forEach((g0) => {
                                    var { U: D8 } = g0;
                                    if (D8) {
                                        if (16 & g0.Ly || (g0.GY = !1),
                                            g0.bj > 0 && g0.bj--,
                                            g0.Jj < B.ly.jX && g0.Jj++,
                                            g0.GY && g0.bj <= 0 && g0.Jj >= 0) {
                                            var J6 = !1;
                                            B.A.Z.forEach((P8) => {
                                                P8 != D8 && 64 & P8.i && B.A.AD(D8, P8, I) && (J6 = !0)
                                            }
                                            ),
                                                J6 && (B.ly.e5?.(g0),
                                                    g0.GY = !1,
                                                    g0.bj = B.ly.Wj,
                                                    g0.Jj -= B.ly.Zj)
                                        }
                                        B.A.SD(g0, I)
                                    }
                                }
                                );
                                var s = 0;
                                switch (B.A.Z.forEach((g0, D8) => {
                                    128 & g0.i && (c[s] = D8,
                                        (D8 = t[s]).x = g0.h.x,
                                        D8.y = g0.h.y,
                                        s++)
                                }
                                ),
                                B.A.Fy(X, B.ly),
                                B.O) {
                                    case 0:
                                        _.forEach((g0) => {
                                            g0.U && (g0.U.z = 39 | B.YX.z)
                                        }
                                        ),
                                            B.A.Z[0].ih() && (B.O = 1,
                                                B.ly.k5?.());
                                        break;
                                    case 1:
                                        B.Dj += 0.016666666666666666,
                                            _.forEach((g0) => {
                                                g0.U && (g0.U.z = 39)
                                            }
                                            );
                                        var r = -1;
                                        for (_ = B.A.Z,
                                            X = 0; X < s && r < 0; X++)
                                            r = B.WD(_[c[X]].h, t[X]);
                                        if (r >= 0) {
                                            var T0 = B.e.ty[r]
                                                , { c: l0 } = T0;
                                            B.O = 2,
                                                B.mY = 150,
                                                B.YX = l0,
                                                l0 == N.Ty ? B.IY++ : B.EY++,
                                                B.ly.$5?.(l0 == N.Ty ? N.yY : N.Ty, r, T0, c[X], _[c[X]]),
                                                B.ly.wD?.(l0.X)
                                        } else
                                            B.Py > 0 && B.Dj >= 60 * B.Py && B.EY != B.IY && (B.ly.q5?.(),
                                                B.bi());
                                        break;
                                    case 2:
                                        B.mY--,
                                            B.mY <= 0 && (B.Wy > 0 && (B.EY >= B.Wy || B.IY >= B.Wy) || B.Py > 0 && B.Dj >= 60 * B.Py && B.EY != B.IY ? B.bi() : (B.Si(),
                                                B.ly.C5?.()));
                                        break;
                                    case 3:
                                        B.mY--,
                                            B.mY <= 0 && B.ly.l != null && (B.ly.l = null,
                                                B.ly.o.forEach((g0) => {
                                                    g0.U && B.ly.xp?.(g0),
                                                        g0.U = null,
                                                        g0.QY = 0
                                                }
                                                ),
                                                B.ly.cR?.(null))
                                }
                            }
                        },
                        bi: function () {
                            this.mY = 300,
                                this.O = 3,
                                this.ly.T5?.(this.EY > this.IY ? N.Ty : N.yY)
                        },
                        Si: function () {
                            var X = this
                                , { Z: B, oj: I, jY: _, XY: s, pY: r } = X.e
                                , T0 = X.A.Z
                                , l0 = I ? B.length : 1;
                            X.O = 0;
                            for (var g0 = 0; g0 < l0; g0++)
                                B[g0].ar(T0[g0]);
                            var D8 = [0, 0, 0];
                            X.ly.o.forEach((J6) => {
                                X.Di(J6);
                                var { X: P8, Gr: Q7 } = J6.c;
                                if (P8 != 0) {
                                    var { h: FJ } = J6.U
                                        , ZJ = D8[P8]
                                        , N5 = P8 == 1 ? _ : s;
                                    N5.length == 0 ? (g0 = ZJ + 1 >> 1,
                                        1 & ZJ || (g0 = -g0),
                                        FJ.x = r * Q7,
                                        FJ.y = 55 * g0) : (ZJ >= N5.length && (ZJ = N5.length - 1),
                                            g0 = N5[ZJ],
                                            FJ.x = g0.x,
                                            FJ.y = g0.y),
                                        J6.QY = ++D8[P8]
                                }
                            }
                            )
                        },
                        S: function (X) {
                            this.A.S(X),
                                X.m(this.mY),
                                X.m(this.O),
                                X.m(this.EY),
                                X.m(this.IY),
                                X.J(this.Dj),
                                X.m(this.xY),
                                X.g(this.YX.X)
                        },
                        D: function (X, B) {
                            this.A.D(X),
                                this.mY = X.W(),
                                this.O = X.W(),
                                this.EY = X.W(),
                                this.IY = X.W(),
                                this.Dj = X.d(),
                                this.xY = X.W(),
                                this.YX = N.p[X.kp()] || N.bY,
                                this.ly = B,
                                this.Wy = B.Wy,
                                this.Py = B.Py,
                                this.e = B.e,
                                this.A.k = this.e.k,
                                this.A.t = this.e.t,
                                this.A.M = this.e.M,
                                this.A._y = this.e._y
                        },
                        dY: function (X) {
                            return X != this.SY && (this.u || (this.u = new J0),
                                this.SY = X,
                                J0.LY(this.u, this, X)),
                                this.u
                        },
                        copy: function (X) {
                            var B = new J0;
                            return B.A.Z = this.A.Z.map((I) => {
                                var _ = new K0;
                                return _.h.x = I.h.x,
                                    _.h.y = I.h.y,
                                    _.P.x = I.P.x,
                                    _.P.y = I.P.y,
                                    _.T.x = I.T.x,
                                    _.T.y = I.T.y,
                                    _.I = I.I,
                                    _.r = I.r,
                                    _.F = I.F,
                                    _.N = I.N,
                                    _.b = I.b,
                                    _.z = I.z,
                                    _.i = I.i,
                                    _.n = I.n,
                                    _
                            }
                            ),
                                B.mY = this.mY,
                                B.O = this.O,
                                B.EY = this.EY,
                                B.IY = this.IY,
                                B.Dj = this.Dj,
                                B.xY = this.xY,
                                B.YX = this.YX,
                                B.ly = X || this.ly,
                                B.Wy = B.ly.Wy,
                                B.Py = B.ly.Py,
                                B.e = B.ly.e,
                                B.A.k = B.e.k,
                                B.A.t = B.e.t,
                                B.A.M = B.e.M,
                                B.A._y = B.e._y,
                                B
                        }
                    },
                    J0.prototype.runSteps = J0.prototype.Qy,
                    Object.defineProperty(J0.prototype, "paused", {
                        get: function () {
                            return this.xY !== 0
                        }
                    }),
                    J.E(J0, [], [null, "ext", "pauseGameTickCounter", "timeElapsed", "blueScore", "redScore", "goalConcedingTeam", "state", "goalTickCounter", "physicsState", "timeLimit", "scoreLimit", "stadium", null], []);
                var X0 = J0
                    , A0 = W(function (X) {
                        var { K: { kX: { ep: B, Vy: I } } } = J;
                        X.bL = X.ID || (X.ID = {
                            ED: function (_) {
                                return "rgba(" + [(16711680 & _) >>> 16, (65280 & _) >>> 8, 255 & _].join() + ",255)"
                            },
                            Op: function (_) {
                                var s = _.match(/rgba?[ \t]*\([ \t]*(\d+),[ \t]*(\d+),[ \t]*(\d+)[ \t]*\)/);
                                if (!(s.length < 4)) {
                                    var r = parseInt(s[1])
                                        , T0 = parseInt(s[2])
                                        , l0 = parseInt(s[3]);
                                    if (!(r > 255 || T0 > 255 || l0 > 255))
                                        return r << 16 | T0 << 8 | l0
                                }
                            },
                            mD: function (_, s) {
                                return (J.JY.tX ? "https" : "http") + "://" + J.JY.Sp + "/play?c=" + _ + (s ? "&p=1" : "")
                            },
                            QD: function () {
                                return V8.D5()
                            },
                            FD: function (_) {
                                try {
                                    var s = new V8;
                                    return s.HD(_),
                                        s
                                } catch (r) {
                                    throw r instanceof B ? r : r instanceof SyntaxError ? I(H.Yr, r.lineNumber) : I(H.jr, r)
                                }
                            },
                            P5: function (_) {
                                return _.cD()
                            },
                            iO: function (_, s, r) {
                                return (r ? 16 : 0) | (_ > 0 ? 8 : _ < 0 ? 4 : 0) | (s > 0 ? 2 : s < 0 ? 1 : 0)
                            },
                            UD: function (_) {
                                return {
                                    dirX: ((8 & _) > 0) - ((4 & _) > 0),
                                    dirY: ((2 & _) > 0) - ((1 & _) > 0),
                                    kick: (16 & _) > 0
                                }
                            }
                        })
                    })
                    , { E: B0, K: { Oy: { V: { Wp: N0, S5: { zX: R0 } } } } } = J;
                N0(R0, H.Er),
                    B0(R0, [], [null, "pings", "byId"], []);
                var $8 = R0
                    , { E: N8, K: { Oy: { V: { Wp: a, S5: { xX: q0 } } } } } = J;
                a(q0, H.qr),
                    N8(q0, [], [null, "id", "reason", "ban", "byId"], []);
                var H0 = q0
                    , { E: p0, K: { Oy: { V: { Wp: w8, S5: { RX: y8 } } } } } = J;
                w8(y8, H.dr),
                    p0(y8, [], [null, "data"], []);
                var j8 = y8
                    , { E: k8, K: { kX: { Vy: W8 }, Oy: { V: { gy: P6 } } } } = J
                    , g7 = P6({
                        X: H.fr,
                        zy: !1,
                        jy: !1,
                        bR: {
                            JR: 10,
                            ZR: 900
                        },
                        Q: function () {
                            this.zp = "",
                                this.b = 0,
                                this.hO = 0,
                                this._O = 0,
                                this.p = 0,
                                this.uO = null
                        },
                        Ay: function (X, B, I, _, s) {
                            return X.zp = B,
                                X.b = I,
                                X.hO = _,
                                X._O = s,
                                X
                        },
                        Sy: function () {
                            return [this.zp, this.b, this.hO, this._O]
                        },
                        H: function (X) {
                            this.p == 0 && X.MD(this.zp, this.b, this.hO, this._O)
                        },
                        S: function (X) {
                            X.fY(this.zp.substring(0, 1000)),
                                X.m(this.b),
                                X.g(this.hO),
                                X.g(this._O)
                        },
                        D: function (X) {
                            if (this.zp = X.ZY(),
                                this.zp.length > 1000)
                                throw W8(H.xr);
                            this.b = X.W(),
                                this.hO = X.q(),
                                this._O = X.q()
                        }
                    });
                k8(g7, [], [null, "msg", "color", "style", "sound", "byId", "targetId"], []);
                var j9 = g7
                    , { E: Z0, K: { Oy: { V: { gy: G0 } } } } = J
                    , z8 = G0({
                        X: H.Lr,
                        zy: !1,
                        jy: !1,
                        Q: function () {
                            this.value = 0,
                                this.X = null,
                                this.lp = null,
                                this.p = 0
                        },
                        Ay: function (X, B, I, _) {
                            return X.value = B,
                                X.X = I,
                                X.lp = _,
                                X
                        },
                        Sy: function () {
                            return [this.value, this.X, this.lp]
                        },
                        H: function (X) {
                            this.X == null ? X.ND(this.p, this.value) : J.hY(() => {
                                try {
                                    X.nD?.(this.p, this.X, this.lp)
                                } catch { }
                            }
                                , 200)
                        },
                        S: function (X) {
                            X.g(this.value),
                                this.X != null && this.lp != null && (X.m(this.X),
                                    X.g(this.lp))
                        },
                        D: function (X, B) {
                            if (this.value = X.q(),
                                !B)
                                try {
                                    this.X = X.W(),
                                        this.lp = X.q()
                                } catch { }
                        }
                    });
                Z0(z8, [], [null, "value", "id", "mode", "byId"], []);
                var Z8 = z8
                    , { E: G8, K: { Oy: { V: { gy: t0 } } } } = J
                    , e8 = t0({
                        X: H.er,
                        zy: !0,
                        jy: !0,
                        Q: function () {
                            this.Ly = 0,
                                this.p = 0
                        },
                        Ay: function (X, B) {
                            return X.Ly = B,
                                X
                        },
                        Sy: function () {
                            return [this.Ly]
                        },
                        H: function (X) {
                            X.VD(this.p, this.Ly)
                        },
                        S: function (X) {
                            X.ey(this.Ly)
                        },
                        D: function (X) {
                            this.Ly = X.ry()
                        }
                    });
                G8(e8, [], [null, "input", "byId"], []);
                var m7 = e8
                    , { E: L7, K: { kX: { Vy: fJ }, Oy: { V: { gy: B9 } } } } = J
                    , f6 = B9({
                        X: H.kr,
                        zy: !1,
                        jy: !1,
                        bR: {
                            JR: 10,
                            ZR: 900
                        },
                        Q: function () {
                            this.WY = "",
                                this.p = 0,
                                this.uO = null
                        },
                        Ay: function (X, B) {
                            return X.WY = B,
                                X
                        },
                        Sy: function () {
                            return [this.WY]
                        },
                        H: function (X) {
                            X.BD(this.WY, this.p)
                        },
                        S: function (X) {
                            X.fY(this.WY.substring(0, 140))
                        },
                        D: function (X) {
                            if (this.WY = X.ZY(),
                                this.WY.length > 140)
                                throw fJ(H.zr)
                        }
                    });
                L7(f6, [], [null, "text", "byId", "targetId"], []);
                var IJ = f6
                    , { E: J7, K: { Oy: { V: { gy: Y5 } } } } = J
                    , hJ = Y5({
                        X: H.$r,
                        zy: !1,
                        jy: !1,
                        Q: function () {
                            this.X = 0,
                                this.L = "",
                                this.ky = "",
                                this.Jy = "",
                                this.Qj = "",
                                this.Gy = "",
                                this.p = 0
                        },
                        Ay: function (X, B, I, _, s, r, T0) {
                            return X.X = B,
                                X.L = I,
                                X.ky = _,
                                X.Jy = s,
                                X.Qj = r,
                                X.Gy = T0,
                                X
                        },
                        Sy: function () {
                            return [this.X, this.L, this.ky, this.Jy, this.Qj, this.Gy]
                        },
                        H: function (X) {
                            this.p == 0 && X.g_(this.X, this.L, this.ky, this.Jy, this.Qj, this.Gy)
                        },
                        S: function (X) {
                            X.m(this.X),
                                X.AY(this.L),
                                X.AY(this.ky),
                                X.AY(this.Jy)
                        },
                        D: function (X) {
                            this.X = X.W(),
                                this.L = X.gY(),
                                this.ky = X.gY(),
                                this.Jy = X.gY()
                        }
                    });
                J7(hJ, [], [null, "id", "name", "flag", "avatar", "conn", "auth", "byId"], []);
                var N1 = hJ
                    , { E: y4, K: { Oy: { V: { gy: f4 } } } } = J
                    , T6 = f4({
                        X: H.Cr,
                        zy: !1,
                        jy: !1,
                        Q: function () {
                            this.p = 0
                        },
                        Ay: function (X) {
                            return X
                        },
                        Sy: function () {
                            return []
                        },
                        H: function (X) {
                            X.TY(this.p, 32) && X.KD(X.G(this.p))
                        },
                        S: function () { },
                        D: function () { }
                    });
                y4(T6, [], [null, "byId"], []);
                var R7 = T6
                    , { E: x8, K: { Oy: { V: { gy: b7 } } } } = J
                    , e7 = b7({
                        X: H.Tr,
                        zy: !1,
                        jy: !1,
                        Q: function () {
                            this.p = 0
                        },
                        Ay: function (X) {
                            return X
                        },
                        Sy: function () {
                            return []
                        },
                        H: function (X) {
                            X.TY(this.p, 32) && X.GD(X.G(this.p))
                        },
                        S: function () { },
                        D: function () { }
                    });
                x8(e7, [], [null, "byId"], []);
                var c7 = e7
                    , { E: u5, K: { Oy: { V: { gy: X5 } } } } = J
                    , tJ = X5({
                        X: H.Pr,
                        zy: !0,
                        jy: !0,
                        Q: function () {
                            this.gO = !1,
                                this.p = 0
                        },
                        Ay: function (X, B) {
                            return X.gO = B,
                                X
                        },
                        Sy: function () {
                            return [this.gO]
                        },
                        H: function (X) {
                            X.TY(this.p, 16) && X.aD(this.gO, this.p)
                        },
                        S: function (X) {
                            X.g(this.gO ? 1 : 0)
                        },
                        D: function (X) {
                            this.gO = X.q() != 0
                        }
                    });
                u5(tJ, [], [null, "paused", "byId"], []);
                var l5 = tJ
                    , { E: r9, K: { Oy: { V: { gy: h4 } } } } = J
                    , KY = h4({
                        X: H.cr,
                        zy: !1,
                        jy: !1,
                        Q: function () {
                            this.B = 0,
                                this.FY = 0,
                                this.p = 0
                        },
                        Ay: function (X, B, I) {
                            return X.B = B,
                                X.FY = I,
                                X
                        },
                        Sy: function () {
                            return [this.B, this.FY]
                        },
                        H: function (X) {
                            if (X.TY(this.p, 2))
                                switch (this.B) {
                                    case 0:
                                        X.vD(this.FY, this.p);
                                        break;
                                    case 1:
                                        X.sD(this.FY, this.p)
                                }
                        },
                        S: function (X) {
                            X.m(this.B),
                                X.m(this.FY)
                        },
                        D: function (X) {
                            this.B = X.W(),
                                this.FY = X.W()
                        }
                    });
                r9(KY, [], [null, "type", "newValue", "byId"], []);
                var VY = KY
                    , { E: RI, K: { Oy: { zO: { lO: zY, $R: bI }, V: { gy: x4 } } } } = J
                    , g4 = x4({
                        X: H.or,
                        zy: !1,
                        jy: !1,
                        bR: {
                            JR: 10,
                            ZR: 2000
                        },
                        Q: function () {
                            this.e = null,
                                this.p = 0
                        },
                        Ay: function (X, B) {
                            return X.e = B,
                                X
                        },
                        Sy: function () {
                            return [this.e?.copy()]
                        },
                        H: function (X) {
                            X.TY(this.p, 8) && X.uD(this.e, this.p)
                        },
                        S: function (X) {
                            var B = zY.j();
                            this.e.S(B);
                            var I = J.Ny.deflateRaw(B.my());
                            X.My(I.byteLength),
                                X.sy(I)
                        },
                        D: function (X) {
                            var B = J.Ny.inflateRaw(X.Uy(X.By()));
                            this.e = V8.D(new bI(new DataView(B.buffer, B.byteOffset, B.byteLength)))
                        }
                    });
                RI(g4, [], [null, "stadium", "byId"], []);
                var vI = g4
                    , { E: Q0, K: { Oy: { V: { gy: W0 } } } } = J
                    , U0 = W0({
                        X: H.Hr,
                        zy: !1,
                        jy: !1,
                        Q: function () {
                            this.n = 0,
                                this.c = null,
                                this.p = 0
                        },
                        Ay: function (X, B, I) {
                            return X.n = B,
                                X.c = I,
                                X
                        },
                        Sy: function () {
                            return [this.n, this.c]
                        },
                        H: function (X) {
                            !X.TY(this.p, 1) && (this.n != this.p || X.wj || X.l != null) || X.oR(X.G(this.n), this.c, this.p)
                        },
                        S: function (X) {
                            X.m(this.n),
                                X.g(this.c.X)
                        },
                        D: function (X) {
                            this.n = X.W(),
                                this.c = N.p[X.kp()] || N.bY
                        }
                    });
                Q0(U0, [], [null, "playerId", "team", "byId"], []);
                var y = U0
                    , { E: D, K: { Oy: { V: { gy: f } } } } = J
                    , x = f({
                        X: H.tr,
                        zy: !1,
                        jy: !1,
                        Q: function () {
                            this.FY = 0,
                                this.p = 0
                        },
                        Ay: function (X, B) {
                            return X.FY = B,
                                X
                        },
                        Sy: function () {
                            return [this.FY]
                        },
                        H: function (X) {
                            X.TY(this.p, 2) && X.yb(this.FY, this.p)
                        },
                        S: function (X) {
                            X.g(this.FY ? 1 : 0)
                        },
                        D: function (X) {
                            this.FY = X.q() != 0
                        }
                    });
                D(x, [], [null, "newValue", "byId"], []);
                var d = x
                    , { E: p, K: { Oy: { V: { gy: Y0 } } } } = J
                    , $0 = Y0({
                        X: H.Wr,
                        zy: !1,
                        jy: !1,
                        Q: function () {
                            this.n = 0,
                                this.value = 0,
                                this.p = 0
                        },
                        Ay: function (X, B, I) {
                            return X.n = B,
                                X.value = I,
                                X
                        },
                        Sy: function () {
                            return [this.n, this.value]
                        },
                        H: function (X) {
                            X.TY(this.p, 4) && X.Yb(X.G(this.n), this.value, this.p)
                        },
                        S: function (X) {
                            X.m(this.n),
                                X.g(this.value ? 1 : 0)
                        },
                        D: function (X) {
                            this.n = X.W(),
                                this.value = X.q() != 0
                        }
                    });
                p($0, [], [null, "playerId", "value", "byId"], []);
                var D0 = $0
                    , { E: M0, K: { Oy: { V: { gy: y0 } } } } = J
                    , T = y0({
                        X: H.wr,
                        zy: !1,
                        jy: !1,
                        Q: function () {
                            this.p = 0
                        },
                        Ay: function (X) {
                            return X
                        },
                        Sy: function () {
                            return []
                        },
                        H: function (X) {
                            X.TY(this.p, 1) && X.jb(this.p)
                        },
                        S: function (X) { },
                        D: function (X) { }
                    });
                M0(T, [], [null, "byId"], []);
                var m = T
                    , { E: e, K: { Oy: { V: { gy: s0 } } } } = J
                    , u0 = s0({
                        X: H.Ir,
                        zy: !1,
                        jy: !1,
                        bR: {
                            JR: 2,
                            ZR: 1e4
                        },
                        Q: function () {
                            this.value = !1,
                                this.p = 0
                        },
                        Ay: function (X, B) {
                            return X.value = B,
                                X
                        },
                        Sy: function () {
                            return [this.value]
                        },
                        H: function (X) {
                            X.Xb(X.G(this.p), this.value)
                        },
                        S: function (X) {
                            X.g(this.value ? 1 : 0)
                        },
                        D: function (X) {
                            this.value = X.q() != 0
                        }
                    });
                e(u0, [], [null, "value", "byId"], []);
                var p8 = u0
                    , { E: h6, K: { Oy: { V: { gy: D6 } } } } = J
                    , O8 = D6({
                        X: H.mr,
                        zy: !1,
                        jy: !1,
                        Q: function () {
                            this.value = null,
                                this.p = 0
                        },
                        Ay: function (X, B) {
                            return X.value = B,
                                X
                        },
                        Sy: function () {
                            return [this.value]
                        },
                        H: function (X) {
                            X.pb(this.p, this.value)
                        },
                        S: function (X) {
                            X.AY(this.value)
                        },
                        D: function (X) {
                            this.value = X.gY(),
                                this.value && (this.value = this.value.substring(0, 2))
                        }
                    });
                h6(O8, [], [null, "value", "byId"], []);
                var N6 = O8
                    , { E: F5, K: { Oy: { V: { gy: p6 } } } } = J
                    , V6 = p6({
                        X: H.Qr,
                        zy: !1,
                        jy: !1,
                        Q: function () {
                            this.c = null,
                                this.rp = null,
                                this.p = 0
                        },
                        Ay: function (X, B, I) {
                            return X.c = B,
                                X.rp = I,
                                X
                        },
                        Sy: function () {
                            return [this.c, this.rp?.copy()]
                        },
                        H: function (X) {
                            X.TY(this.p, 2) && X.Ob(this.c.X, this.rp, this.p)
                        },
                        S: function (X) {
                            X.g(this.c.X),
                                this.rp.S(X)
                        },
                        D: function (X) {
                            this.c = N.p[X.kp()] || N.bY,
                                this.rp = new F,
                                this.rp.D(X)
                        }
                    });
                F5(V6, [], [null, "team", "colors", "byId"], []);
                var q7 = V6
                    , { E: k9, K: { Oy: { V: { gy: t9 } } } } = J
                    , LJ = t9({
                        X: H.Fr,
                        zy: !1,
                        jy: !1,
                        Q: function () {
                            this.CX = null,
                                this.AO = !0,
                                this.p = 0
                        },
                        Ay: function (X, B, I) {
                            var _ = new Set;
                            B.forEach((T0) => _.add(T0)),
                                B = [];
                            for (var s = (_ = _.values()).next(), r = 0; !s.done && r < 40; r++)
                                B.push(s.value),
                                    s = _.next();
                            return X.CX = B,
                                X.AO = I,
                                X
                        },
                        Sy: function () {
                            return [this.CX.slice(), this.AO]
                        },
                        H: function (X) {
                            this.p == 0 && X.Rb(this.CX, this.AO)
                        },
                        S: function (X) {
                            X.g(this.AO ? 1 : 0),
                                X.g(this.CX.length),
                                this.CX.forEach((B) => X.m(B))
                        },
                        D: function (X) {
                            this.CX = [],
                                this.AO = X.q() != 0;
                            for (var B = X.q(), I = 0; I < B; I++)
                                this.CX.push(X.W())
                        }
                    });
                k9(LJ, [], [null, "playerIdList", "moveToTop", "byId"], []);
                var w1 = LJ
                    , { E: m4, K: { Oy: { V: { gy: SI } } } } = J
                    , WY = SI({
                        X: H.Ur,
                        zy: !1,
                        jy: !1,
                        Q: function () {
                            this.SO = 0,
                                this.DO = 0,
                                this.bO = 0,
                                this.p = 0
                        },
                        Ay: function (X, B, I, _) {
                            return X.SO = B,
                                X.DO = I,
                                X.bO = _,
                                X
                        },
                        Sy: function () {
                            return [this.SO, this.DO, this.bO]
                        },
                        H: function (X) {
                            X.TY(this.p, 2) && X.Ji(this.SO, this.DO, this.bO, X.G(this.p))
                        },
                        S: function (X) {
                            X.m(this.SO),
                                X.m(this.DO),
                                X.m(this.bO)
                        },
                        D: function (X) {
                            this.SO = X.W(),
                                this.DO = X.W(),
                                this.bO = X.W()
                        }
                    });
                m4(WY, [], [null, "min", "rate", "burst", "byId"], []);
                var TI = WY
                    , { E: HY, K: { Oy: { V: { gy: yI } } } } = J
                    , YY = yI({
                        X: H.Mr,
                        zy: !1,
                        jy: !1,
                        Q: function () {
                            this.Jy = "",
                                this.n = 0,
                                this.p = 0
                        },
                        Ay: function (X, B, I) {
                            return X.n = B,
                                X.Jy = I,
                                X
                        },
                        Sy: function () {
                            return [this.n, this.Jy]
                        },
                        H: function (X) {
                            this.p == 0 && X.xb(this.n, this.Jy)
                        },
                        S: function (X) {
                            X.AY(this.Jy),
                                X.m(this.n)
                        },
                        D: function (X) {
                            this.Jy = X.gY()?.substring(0, 2),
                                this.n = X.W()
                        }
                    });
                HY(YY, [], [null, "avatar", "playerId", "byId"], []);
                var fI = YY
                    , { E: hI, K: { Oy: { V: { gy: xI } } } } = J
                    , j1 = xI({
                        X: H.nr,
                        zy: !1,
                        jy: !1,
                        Q: function () {
                            this.X = 0,
                                this.B = !1,
                                this.TX = null,
                                this.PX = null,
                                this.p = 0
                        },
                        Ay: function (X, B, I, _, s) {
                            return X.X = B,
                                X.B = I,
                                X.TX = _,
                                X.PX = s,
                                X
                        },
                        Sy: function () {
                            return [this.X, this.B, this.TX.slice(), this.PX.slice()]
                        },
                        H: function (X) {
                            this.p == 0 && X.zb(this.B, this.X, this.TX, this.PX)
                        },
                        S: function (X) {
                            X.m(this.X),
                                X.g(this.B ? 1 : 0);
                            var B = X._
                                , I = 0
                                , _ = 1;
                            X.My(0),
                                this.TX.forEach((s) => {
                                    s != null && (I |= _,
                                        X.Rx(s)),
                                        _ <<= 1
                                }
                                ),
                                this.PX.forEach((s) => {
                                    s != null && (I |= _,
                                        X.m(s)),
                                        _ <<= 1
                                }
                                ),
                                _ = X._,
                                X._ = B,
                                X.My(I),
                                X._ = _
                        },
                        D: function (X) {
                            this.X = X.W(),
                                this.B = X.q() != 0;
                            var B, I = X.By();
                            for (this.TX = [],
                                B = 0; B < 10; B++)
                                this.TX[B] = null,
                                    1 & I && (this.TX[B] = X.px()),
                                    I >>>= 1;
                            for (this.PX = [],
                                B = 0; B < 3; B++)
                                this.PX[B] = null,
                                    1 & I && (this.PX[B] = X.W()),
                                    I >>>= 1
                        }
                    });
                j1.Pj = function (X, B, I) {
                    var _ = [I.x, I.y, I.xspeed, I.yspeed, I.xgravity, I.ygravity, I.radius, I.bCoeff, I.invMass, I.damping];
                    _.forEach((r, T0) => {
                        r != null && (_[T0] = Math.fround(r))
                    }
                    );
                    var s = [I.color, I.cMask, I.cGroup];
                    return s.forEach((r, T0) => {
                        r != null && (s[T0] = 0 | r)
                    }
                    ),
                        j1.j(X, B, _, s)
                }
                    ,
                    hI(j1, [], [null, "id", "type", "data1", "data2", "byId"], []);
                var S8 = j1
                    , { E: z7, K: { Oy: { V: { gy: f8 } } } } = J
                    , K7 = f8({
                        X: H.Nr,
                        zy: !1,
                        jy: !1,
                        Q: function () {
                            this.B = 0,
                                this.Ry = null,
                                this.p = 0
                        },
                        Ay: function (X, B, I) {
                            return X.B = B,
                                X.Ry = I,
                                X
                        },
                        Sy: function () {
                            return [this.B, JSON.parse(JSON.stringify(this.Ry))]
                        },
                        H: function (X) {
                            X.lb(this.B, this.Ry, this.p)
                        },
                        S: function (X) {
                            X.ey(this.B),
                                X.fY(JSON.stringify(this.Ry))
                        },
                        D: function (X) {
                            this.B = X.ry(),
                                this.Ry = JSON.parse(X.ZY())
                        }
                    });
                z7(K7, [], [null, "type", "data", "byId"], []);
                var U5 = K7
                    , { E: xJ, K: { Oy: { V: { gy: UJ }, zO: { lO: o5, $R: cQ } } } } = J
                    , uZ = UJ({
                        X: H.Vr,
                        zy: !1,
                        jy: !1,
                        Q: function () {
                            this.B = 0,
                                this.Ry = null,
                                this.p = 0
                        },
                        Ay: function (X, B, I) {
                            return X.B = B,
                                X.Ry = I,
                                X
                        },
                        Sy: function () {
                            var X = new Uint8Array;
                            return X.set(this.Ry),
                                [this.B, X]
                        },
                        H: function (X) {
                            X.rb(this.B, this.Ry, this.p)
                        },
                        S: function (X) {
                            var B = o5.j();
                            B.ey(this.B),
                                B.sy(this.Ry);
                            var I = J.Ny.deflateRaw(B.my());
                            X.ey(I.byteLength),
                                X.sy(I)
                        },
                        D: function (X) {
                            var B = J.Ny.inflateRaw(X.Uy(X.ry()));
                            X = new cQ(new DataView(B.buffer, B.byteOffset, B.byteLength)),
                                this.B = X.ry(),
                                this.Ry = X.Uy()
                        }
                    });
                xJ(uZ, [], [null, "type", "data", "byId"], []);
                var c4 = uZ
                    , { E: NT, K: { Oy: { V: { gy: wT } } } } = J
                    , aD = wT({
                        X: H.Br,
                        zy: !1,
                        jy: !1,
                        Q: function () {
                            this.X = 0,
                                this.Ry = null,
                                this.p = 0
                        },
                        Ay: function (X, B, I) {
                            return X.X = B,
                                X.Ry = I,
                                X
                        },
                        Sy: function () {
                            return [this.X, JSON.parse(JSON.stringify(this.Ry))]
                        },
                        H: function (X) {
                            this.p == 0 && X._l(this.X, this.Ry, this.p)
                        },
                        S: function (X) {
                            X.ey(this.X),
                                X.fY(JSON.stringify(this.Ry))
                        },
                        D: function (X) {
                            this.X = X.ry(),
                                this.Ry = JSON.parse(X.ZY())
                        }
                    });
                NT(aD, [], [null, "id", "data", "byId"], []);
                var jT = aD
                    , rD = W(function (X) {
                        X.bL = X.ib || (X.ib = {
                            zX: $8,
                            xX: H0,
                            RX: j8,
                            Zi: j9,
                            fi: Z8,
                            Li: m7,
                            di: IJ,
                            ei: N1,
                            ki: R7,
                            $i: c7,
                            qi: l5,
                            Ci: VY,
                            Ti: vI,
                            Pi: y,
                            ci: d,
                            oi: D0,
                            Hi: m,
                            ti: p8,
                            Wi: N6,
                            wi: q7,
                            Ii: w1,
                            Ei: TI,
                            mi: fI,
                            Qi: S8,
                            Fi: U5,
                            Ui: c4,
                            Mi: jT
                        })
                    })
                    , BT = W(function (X) {
                        X.bL = X.hb || (X.hb = {
                            _b: (B, { x: I, y: _ }, s) => B.l?.A.k.findIndex((r) => {
                                var T0 = r.h.x - I
                                    , l0 = r.h.y - _;
                                return T0 * T0 + l0 * l0 <= s * s
                            }
                            ),
                            gb: (B, { x: I, y: _ }, s) => B.l?.A.t.findIndex((r) => {
                                var T0, l0, g0, D8, J6, P8, Q7;
                                if (0 * r.wy == 0) {
                                    if (l0 = I - r.fO.x,
                                        g0 = _ - r.fO.y,
                                        (r._p.x * l0 + r._p.y * g0 > 0 && r.gp.x * l0 + r.gp.y * g0 > 0) == r.wy <= 0)
                                        return !1;
                                    T0 = Math.sqrt(l0 * l0 + g0 * g0) - r.QR
                                } else {
                                    if (D8 = r.v.h,
                                        l0 = (J6 = r.s.h).x - D8.x,
                                        g0 = J6.y - D8.y,
                                        P8 = I - J6.x,
                                        Q7 = _ - J6.y,
                                        (I - D8.x) * l0 + (_ - D8.y) * g0 <= 0 || P8 * l0 + Q7 * g0 >= 0)
                                        return !1;
                                    T0 = r.qy.x * P8 + r.qy.y * Q7
                                }
                                return Math.abs(T0) < s
                            }
                            ),
                            Ab: (B, { x: I, y: _ }, s) => B.e.ty.findIndex((r) => {
                                var { iY: T0, rY: l0 } = r
                                    , g0 = l0.x - T0.x
                                    , D8 = l0.y - T0.y
                                    , J6 = I - l0.x
                                    , P8 = _ - l0.y;
                                if ((I - T0.x) * g0 + (_ - T0.y) * D8 <= 0 || J6 * g0 + P8 * D8 >= 0)
                                    return !1;
                                var Q7 = Math.sqrt(D8 * D8 + g0 * g0);
                                return Math.abs(J6 * D8 / Q7 - P8 * g0 / Q7) < s
                            }
                            ),
                            Sb: (B, { x: I, y: _ }, s) => B.l?.A.M.findIndex((r) => Math.abs(r.xy - (r.qy.x * I + r.qy.y * _)) < s),
                            Db: (B, { x: I, y: _ }, s) => {
                                var r = B.l?.A;
                                if (!r)
                                    return -1;
                                var T0 = r.Z;
                                return r._y.findIndex((l0) => {
                                    var g0 = T0[l0.ay];
                                    if (!g0)
                                        return !1;
                                    var D8 = T0[l0.vy];
                                    if (!D8)
                                        return !1;
                                    var J6 = g0.h
                                        , P8 = D8.h
                                        , Q7 = P8.x - J6.x
                                        , FJ = P8.y - J6.y
                                        , ZJ = I - P8.x
                                        , N5 = _ - P8.y;
                                    if ((I - J6.x) * Q7 + (_ - J6.y) * FJ <= 0 || ZJ * Q7 + N5 * FJ >= 0)
                                        return !1;
                                    var lZ = Math.sqrt(FJ * FJ + Q7 * Q7);
                                    return Math.abs(ZJ * FJ / lZ - N5 * Q7 / lZ) < s
                                }
                                )
                            }
                            ,
                            bb: (B, { x: I, y: _ }) => B.l?.A.Z.findIndex((s) => {
                                var r = s.h.x - I
                                    , T0 = s.h.y - _;
                                return r * r + T0 * T0 <= s.I * s.I
                            }
                            ),
                            Jb: (B, { x: I, y: _ }, s) => {
                                s || (s = B.l?.e.aY.I);
                                var r = s * s
                                    , T0 = B.l?.e.jY.findIndex((l0) => {
                                        var g0 = l0.x - I
                                            , D8 = l0.y - _;
                                        return g0 * g0 + D8 * D8 <= r
                                    }
                                    );
                                return T0 >= 0 ? [T0, 1] : (T0 = B.l?.e.XY.findIndex((l0) => {
                                    var g0 = l0.x - I
                                        , D8 = l0.y - _;
                                    return g0 * g0 + D8 * D8 <= r
                                }
                                ),
                                    T0 >= 0 ? [T0, 2] : [-1, -1])
                            }
                        })
                    })
                    , kT = W(function (X) {
                        var B = [];
                        function I(_, s) {
                            B.push({
                                L: _
                            })
                        }
                        I("PlayerObjectCreated"),
                            I("PlayerDiscCreated"),
                            I("PlayerDiscDestroyed"),
                            I("RoomLink"),
                            I("PlayerBallKick"),
                            I("TeamGoal"),
                            I("GameEnd"),
                            I("GameTick"),
                            I("PlayerSyncChange"),
                            I("Announcement"),
                            I("KickOff"),
                            I("AutoTeams"),
                            I("ScoreLimitChange"),
                            I("TimeLimitChange"),
                            I("PlayerAdminChange"),
                            I("PlayerAvatarChange"),
                            I("PlayerHeadlessAvatarChange"),
                            I("PlayersOrderChange"),
                            I("PlayerTeamChange"),
                            I("StadiumChange"),
                            I("TeamColorsChange"),
                            I("TeamsLockChange"),
                            I("PlayerJoin"),
                            I("GamePauseChange"),
                            I("PlayerChat"),
                            I("PlayerInputChange"),
                            I("PlayerChatIndicatorChange"),
                            I("PlayerLeave"),
                            I("SetDiscProperties"),
                            I("KickRateLimitChange"),
                            I("GameStart"),
                            I("GameStop"),
                            I("PingData"),
                            I("PingChange"),
                            I("CollisionDiscVsDisc"),
                            I("CollisionDiscVsSegment"),
                            I("CollisionDiscVsPlane"),
                            I("CollisionDiscVsVertex"),
                            I("ModifyJoint"),
                            I("TimeIsUp"),
                            I("PositionsReset"),
                            I("BansClear"),
                            I("BanClear"),
                            I("HandicapChange"),
                            I("RoomRecaptchaModeChange"),
                            I("RoomTokenChange"),
                            I("RoomRecordingChange"),
                            I("RoomPropertiesChange"),
                            I("CustomEvent"),
                            I("BinaryCustomEvent"),
                            I("IdentityEvent"),
                            I("PluginActiveChange"),
                            I("ConfigUpdate"),
                            I("RendererUpdate"),
                            I("PluginUpdate"),
                            I("LibraryUpdate"),
                            I("LanguageChange"),
                            J.JO || I("VariableValueChange"),
                            X.bL = X.c5 || (X.c5 = {
                                c5: B,
                                Zb: I,
                                fb: function (_) {
                                    var s = B.findIndex((r) => r.L == _);
                                    s < 0 || B.splice(s, 1)
                                }
                            })
                    })
                    , CT = W(function (X) {
                        var { Zi: B, fi: I, RX: _, Li: s, di: r, ei: T0, xX: l0, ki: g0, $i: D8, qi: J6, Ci: P8, Ti: Q7, Pi: FJ, ci: ZJ, oi: N5, Hi: lZ, ti: gI, zX: mI, Wi: cI, wi: dI, Ii: pI, Ei: uI, mi: j0, Qi: Q6, Fi: dQ, Ui: XY, Mi: lI } = rD;
                        X.bL = X.Lb || (X.Lb = {
                            create: (X8) => J.K.Oy.V.sO(X8),
                            createFromStream: (X8) => J.K.Oy.V.bx(X8, !0),
                            checkConsistency: (X8) => _.j(X8),
                            sendAnnouncement: (X8, g8 = -1, v7 = 0, e9 = 1) => B.j(X8, g8, v7, e9),
                            sendChatIndicator: (X8) => I.j(X8 ? 0 : 1),
                            sendInput: (X8) => s.j(X8),
                            sendChat: (X8) => r.j(X8),
                            joinRoom: (X8, g8, v7, e9, oI, JQ) => T0.j(X8, g8, v7, e9, oI, JQ),
                            setHeadlessAvatar: (X8, g8) => j0.j(X8, g8),
                            kickBanPlayer: (X8, g8, v7) => l0.j(X8, g8, v7),
                            reorderPlayers: (X8, g8) => pI.j(X8, g8),
                            startGame: () => g0.j(),
                            stopGame: () => D8.j(),
                            pauseResumeGame: (X8) => J6.j(X8),
                            setScoreLimit: (X8) => P8.j(0, X8),
                            setTimeLimit: (X8) => P8.j(1, X8),
                            setStadium: function (X8) {
                                Q7.j(X8);
                                let g8 = 0;
                                if (X8 && typeof X8 === "string")
                                    try {
                                        let v7 = JSON.parse(X8);
                                        if (v7.ballType !== void 0) {
                                            if (g8 = parseInt(v7.ballType),
                                                isNaN(g8) || g8 < 0 || g8 > 3)
                                                g8 = 0
                                        }
                                    } catch (v7) { }
                                if (this.stadium)
                                    this.stadium.ballType = g8;
                                try {
                                    this.sendCustomEvent("setBallType", g8)
                                } catch (v7) { }
                            },
                            setBallType: function (X8) {
                                let g8 = parseInt(X8);
                                if (isNaN(g8) || g8 < 0 || g8 > 3)
                                    X8 = 0;
                                if (this.stadium)
                                    this.stadium.ballType = g8;
                                try {
                                    this.sendCustomEvent("setBallType", g8)
                                } catch (v7) { }
                            },
                            setPlayerTeam: (X8, g8) => {
                                var v7 = N.p[g8];
                                if (v7)
                                    return FJ.j(X8, v7)
                            }
                            ,
                            setTeamsLock: (X8) => ZJ.j(X8),
                            setPlayerAdmin: (X8, g8) => N5.j(X8, g8),
                            autoTeams: () => lZ.j(),
                            setPlayerSync: (X8) => gI.j(X8),
                            ping: (X8) => {
                                var g8 = new mI;
                                return g8.Lj = X8,
                                    g8
                            }
                            ,
                            setAvatar: (X8) => cI.j(X8),
                            setTeamColors: (X8, g8) => {
                                var v7 = N.p[X8];
                                if (v7)
                                    return dI.j(v7, g8)
                            }
                            ,
                            setKickRateLimit: (X8, g8, v7) => uI.j(X8, g8, v7),
                            setDiscProperties: (X8, g8) => Q6.Pj(X8, !1, g8),
                            setPlayerDiscProperties: (X8, g8) => Q6.Pj(X8, !0, g8),
                            customEvent: (X8, g8) => dQ.j(X8, g8),
                            binaryCustomEvent: (X8, g8) => XY.j(X8, g8),
                            setPlayerIdentity: (X8, g8) => lI.j(X8, g8)
                        })
                    });
                function B1(X, B = null) {
                    this.L = X,
                        this.$y = null,
                        this.defineMetadata(B)
                }
                B1.prototype.defineMetadata = function (X) { }
                    ,
                    B1.prototype.defineVariable = function (X) {
                        var B = this
                            , I = X.name
                            , _ = X.value;
                        J.JO ? B[I] = _ : Object.defineProperty(B, I, {
                            get: () => _,
                            set: (s) => {
                                var r = _;
                                s != r && (_ = s,
                                    B.$y?._onVariableValueChange?.(B, I, r, _))
                            }
                        })
                    }
                    ,
                    B1.prototype.setVariableGUIProps = function (X, ...B) { }
                    ,
                    B1.addonType = H.ul,
                    J.E(B1, [], ["name", "room"], []);
                var OT = B1;
                function k1(X = null) {
                    this.$y = null,
                        this.defineMetadata(X)
                }
                k1.prototype.defineMetadata = function (X) { }
                    ,
                    k1.prototype.defineVariable = function (X) {
                        var B = this
                            , I = X.name
                            , _ = X.value;
                        J.JO ? B[I] = _ : Object.defineProperty(B, I, {
                            get: () => _,
                            set: (s) => {
                                var r = _;
                                s != r && (_ = s,
                                    B.$y?._onVariableValueChange?.(B, I, r, _))
                            }
                        })
                    }
                    ,
                    k1.prototype.setVariableGUIProps = function (X, ...B) { }
                    ,
                    k1.addonType = H.al,
                    J.E(k1, [], ["room"], []);
                var IT = k1;
                function C1(X, B = !1, I = null) {
                    this.L = X,
                        this.$y = null,
                        this.defineMetadata(I),
                        this.defineVariable({
                            name: "active",
                            description: "Whether this plugin is active or not.",
                            type: H.Kr,
                            value: B
                        })
                }
                C1.prototype.defineMetadata = function (X) { }
                    ,
                    C1.prototype.defineVariable = function (X) {
                        var B = this
                            , I = X.name
                            , _ = X.value;
                        J.JO ? B[I] = _ : Object.defineProperty(B, I, {
                            get: () => _,
                            set: (s) => {
                                var r = _;
                                s != r && (_ = s,
                                    B.$y?._onVariableValueChange?.(B, I, r, _))
                            }
                        })
                    }
                    ,
                    C1.prototype.setVariableGUIProps = function (X, ...B) { }
                    ,
                    C1.addonType = H.vl,
                    J.E(C1, [], ["name", "room"], []);
                var LT = C1;
                function O1(X = null) {
                    this.$y = null,
                        this.defineMetadata(X)
                }
                O1.prototype.defineMetadata = function (X) { }
                    ,
                    O1.prototype.defineVariable = function (X) {
                        var B = this
                            , I = X.name
                            , _ = X.value;
                        J.JO ? B[I] = _ : Object.defineProperty(B, I, {
                            get: () => _,
                            set: (s) => {
                                var r = _;
                                s != r && (_ = s,
                                    B.$y?._onVariableValueChange?.(B, I, r, _))
                            }
                        })
                    }
                    ,
                    O1.prototype.setVariableGUIProps = function (X, ...B) { }
                    ,
                    O1.addonType = H.sl,
                    J.E(O1, [], ["room"], []);
                var FT = O1
                    , GT = function () {
                        var { OY: X, WX: B, Rz: I, hY: _, Ny: s, E: r, K: T0 } = J;
                        let { kX: { Vy: l0 }, qR: { tp: g0, cp: D8, UO: J6, MO: P8, FO: Q7, jj: FJ }, Oy: { zO: { lO: ZJ, $R: N5 }, V: { Jx: lZ }, wx: gI, Zx: mI, i5: cI, Wx: dI, g5: pI, A5: uI } } = T0;
                        var j0 = H
                            , Q6 = N
                            , dQ = F
                            , { HX: XY, kO: lI, $O: X8, qO: g8, ur: v7, CO: e9, TO: oI } = U8
                            , JQ = c8
                            , C6 = V8
                            , tD = X0;
                        let { ED: PT, Op: DT, mD: eD, QD: AT, FD: ET, P5: MT, iO: _T, UD: RT } = A0;
                        var { Zi: J3, fi: I1, RX: hl, Li: UY, di: NY, ei: wY, xX: L1, ki: nI, $i: sI, qi: iI, Ci: F1, Ti: jY, Pi: C9, ci: aI, oi: rI, Hi: tI, ti: eI, zX: bT, Wi: BY, wi: JL, Ii: Q3, Ei: QL, mi: Z3, Qi: ZL, Fi: $L, Ui: qL, Mi: KL } = rD
                            , { _b: $3, gb: q3, Ab: K3, Sb: V3, Db: z3, bb: W3, Jb: vT } = BT
                            , { c5: ST, Zb: TT, fb: yT } = kT;
                        function H3(w) {
                            this.HR = 0,
                                this.db = w
                        }
                        H3.prototype = {
                            Fy: function () {
                                var w = this.db.iO;
                                !this.tR || this.HR == w || (this.HR = w,
                                    this.tR(UY.j(w)))
                            },
                            o5: function () {
                                !this.tR || this.HR == 0 || (this.HR = 0,
                                    this.tR(UY.j(0)))
                            }
                        };
                        let Y3 = {
                            lat: 40,
                            lon: 40,
                            flag: "tr"
                        };
                        function X3(w, C) {
                            w.O.WR == null && Object.assign(w.O, {
                                ...YE(C),
                                WR: (G) => C.onPlayerInputChange?.(G.X, G.Ly),
                                Up: (G) => C.onPlayerJoin?.(G),
                                e5: (G) => C.onPlayerBallKick?.(G?.X),
                                $5: (G, S, h, z0, P0) => C.onTeamGoal?.(G?.X, S, h, z0, P0),
                                T5: (G) => C.onGameEnd?.(G.X),
                                t5: (G) => C.onGameStart?.(G?.X),
                                d5: () => C.onGameTick?.(),
                                k5: () => C.onKickOff?.(),
                                wR: (G, S, h, z0, P0) => C.onAutoTeams?.(G, S, h, z0, P0),
                                W5: (G, S) => C.onTimeLimitChange?.(G, S),
                                w5: (G, S) => C.onScoreLimitChange?.(G, S),
                                L5: (G) => C.onPlayerDiscCreated?.(G),
                                xp: (G) => C.onPlayerDiscDestroyed?.(G),
                                I5: (G, S) => C.onPlayerAvatarChange?.(G, S),
                                E5: (G, S) => C.onPlayerHeadlessAvatarChange?.(G, S),
                                m5: (G, S) => C.onPlayersOrderChange?.(G, S),
                                IR: (G, S, h) => C.onPlayerTeamChange?.(G, S, h),
                                Q5: (G, S, h) => C.onTeamColorsChange?.(G, S, h),
                                F5: (G, S) => C.onTeamsLockChange?.(G, S),
                                U5: (G, S, h) => {
                                    if (C.onCustomEvent?.(G, S, h),
                                        G === "setBallType" && typeof S === "number") {
                                        let z0 = parseInt(S);
                                        if (!isNaN(z0) && z0 >= 0 && z0 <= 3) {
                                            if (C.stadium)
                                                C.stadium.ballType = z0
                                        }
                                    }
                                }
                                ,
                                M5: (G, S, h) => C.onBinaryCustomEvent?.(G, S, h),
                                Ex: (G, S, h) => C.onIdentityEvent?.(G, S, h),
                                n5: (G, S, h, z0) => C.onSetDiscProperties?.(G, S, h, z0),
                                Ix: (G) => C.onPingData?.(G),
                                Px: (G) => C.onHandicapChange?.(G),
                                q5: () => C.onTimeIsUp?.(),
                                C5: () => C.onPositionsReset?.(),
                                N5: (G, S) => C.onPlayerChat?.(G.X, S),
                                V5: (G, S, h, z0) => C.onAnnouncement?.(G, S, h, z0),
                                cR: (G) => C.onGameStop?.(G?.X),
                                B5: (G, S) => C.onStadiumChange?.(S, G?.X),
                                K5: (G) => C.onPlayerSyncChange?.(G?.X, G?.Oj),
                                G5: (G, S) => C.onPlayerAdminChange?.(S?.X, S?.oY, G?.X),
                                a5: (G, S, h, z0) => C.onKickRateLimitChange?.(S, h, z0, G?.X),
                                v5: (G, S) => C.onPlayerChatIndicatorChange?.(G?.X, !S),
                                s5: (G, S) => C.onGamePauseChange?.(S, G?.X),
                                _X: (G, S, h, z0) => {
                                    G.U && C.onPlayerDiscDestroyed?.(G),
                                        C.onPlayerLeave?.(G, S, h, z0?.X)
                                }
                            })
                        }
                        function U3(w) {
                            Object.assign(w.O, {
                                WR: null,
                                Up: null,
                                e5: null,
                                $5: null,
                                T5: null,
                                s5: null,
                                t5: null,
                                d5: null,
                                k5: null,
                                ...UE(),
                                wR: null,
                                W5: null,
                                w5: null,
                                I5: null,
                                L5: null,
                                xp: null,
                                E5: null,
                                m5: null,
                                IR: null,
                                Q5: null,
                                F5: null,
                                U5: null,
                                M5: null,
                                Ex: null,
                                n5: null,
                                Ix: null,
                                Px: null,
                                q5: null,
                                C5: null,
                                N5: null,
                                V5: null,
                                cR: null,
                                B5: null,
                                K5: null,
                                G5: null,
                                a5: null,
                                _X: null,
                                v5: null
                            })
                        }
                        this.jp = cI(this, {
                            Q: function (w, C) {
                                if (this.uY = w?.uY,
                                    this.cX = w?.cX || [],
                                    this.fj = w?.fj || [],
                                    this.Y = w?.Y || {},
                                    this.ni = null,
                                    this.iO = 0,
                                    this.Ni = !1,
                                    this.dX = null,
                                    this.Ly = new H3(this),
                                    this.OO = null,
                                    this.Vi = !1,
                                    this.sp = new Set,
                                    this.NY = w?.NY || 9,
                                    this.OY = w?.OY,
                                    this.WX = w?.WX,
                                    this.ZO = w?.ZO,
                                    this.H5 = w?.H5,
                                    this.EX = w?.EX,
                                    this.nY = w?.nY,
                                    this.eR = w?.eR,
                                    w) {
                                    var G = this;
                                    Object.assign(C.O, {
                                        WR: (S) => G._onPlayerInputChange?.(S.X, S.Ly),
                                        e5: (S) => G._onPlayerBallKick?.(S?.X),
                                        $5: (S, h, z0, P0, I0) => G._onTeamGoal?.(S?.X, h, z0, P0, I0),
                                        T5: (S) => G._onGameEnd?.(S.X),
                                        t5: (S) => G._onGameStart?.(S?.X),
                                        d5: () => G._onGameTick?.(),
                                        k5: () => G._onKickOff?.(),
                                        ...XE(G),
                                        wR: (S, h, z0, P0, I0) => G._onAutoTeams?.(S, h, z0, P0, I0),
                                        W5: (S, h) => G._onTimeLimitChange?.(S, h),
                                        w5: (S, h) => G._onScoreLimitChange?.(S, h),
                                        L5: (S) => G._onPlayerDiscCreated?.(S),
                                        xp: (S) => G._onPlayerDiscDestroyed?.(S),
                                        I5: (S, h) => G._onPlayerAvatarChange?.(S, h),
                                        E5: (S, h) => G._onPlayerHeadlessAvatarChange?.(S, h),
                                        m5: (S, h) => G._onPlayersOrderChange?.(S, h),
                                        IR: (S, h, z0) => G._onPlayerTeamChange?.(S, h, z0),
                                        Q5: (S, h, z0) => G._onTeamColorsChange?.(S, h, z0),
                                        F5: (S, h) => G._onTeamsLockChange?.(S, h),
                                        U5: (S, h, z0) => {
                                            if (G._onCustomEvent?.(S, h, z0),
                                                S === "setBallType" && typeof h === "number") {
                                                let P0 = parseInt(h);
                                                if (!isNaN(P0) && P0 >= 0 && P0 <= 3) {
                                                    if (G.stadium)
                                                        G.stadium.ballType = P0
                                                }
                                            }
                                        }
                                        ,
                                        M5: (S, h, z0) => G._onBinaryCustomEvent?.(S, h, z0),
                                        Ex: (S, h, z0) => G._onIdentityEvent?.(S, h, z0 || 0),
                                        n5: (S, h, z0, P0) => G._onSetDiscProperties?.(S, h, z0, P0),
                                        Ix: (S) => G._onPingData?.(S),
                                        og: () => G.hostPing || 0,
                                        o5: () => G.Ly.o5(),
                                        Px: (S) => G._onHandicapChange?.(S),
                                        q5: () => G._onTimeIsUp?.(),
                                        C5: () => G._onPositionsReset?.(),
                                        N5: (S, h) => G._onPlayerChat?.(S.X, h),
                                        V5: (S, h, z0, P0) => G._onAnnouncement?.(S, h, z0, P0),
                                        cR: (S) => G._onGameStop?.(S?.X),
                                        B5: (S, h) => G._onStadiumChange?.(h, S?.X),
                                        K5: (S) => G._onPlayerSyncChange?.(S?.X, S?.Oj),
                                        G5: (S, h) => G._onPlayerAdminChange?.(h?.X, h?.oY, S?.X),
                                        a5: (S, h, z0, P0) => G._onKickRateLimitChange?.(h, z0, P0, S?.X),
                                        v5: (S, h) => G._onPlayerChatIndicatorChange?.(S?.X, !h),
                                        Al: (S) => {
                                            S != G.Vi && (G.Vi = S,
                                                G.C(eI.j(S)))
                                        }
                                        ,
                                        s5: (S, h) => {
                                            G._onGamePauseChange?.(h, S?.X)
                                        }
                                        ,
                                        Up: (S) => {
                                            G._onPlayerJoin?.(S),
                                                G._onPlayerObjectCreated?.(S)
                                        }
                                        ,
                                        _X: (S, h, z0, P0) => {
                                            S.U && G._onPlayerDiscDestroyed?.(S),
                                                G.RO?.(S.X),
                                                h != null && G.Hg?.(S, h, P0?.L, z0),
                                                G._onPlayerLeave?.(S, h, z0, P0?.X),
                                                G.sp.delete(S.X)
                                        }
                                        ,
                                        nD: (S, h, z0) => {
                                            var P0;
                                            G.Hy ? (P0 = C.O.G(S)) && z0 == 1 && (P0.eX = !0,
                                                G.sp.add(P0.X)) : z0 == 0 && (G.sp.add(S),
                                                    (P0 = C.O.G(S)) && (P0.eX = !0),
                                                    C.eb = !0,
                                                    (P0 = C.O.G(h)) && (P0.eX = !0),
                                                    G.sp.add(h),
                                                    C.kj(I1.j(1, h, 1), 0, !0, !1))
                                        }
                                    }),
                                        this.Ly.tR = (S) => G.C(S),
                                        Object.defineProperties(this, {
                                            sdp: {
                                                get: () => G.Hy ? null : C.py.fy.remoteDescription.sdp
                                            },
                                            currentPlayerId: {
                                                get: () => C.ej
                                            },
                                            currentPlayer: {
                                                get: () => C.O.G(C.ej)
                                            },
                                            state: {
                                                get: () => C.O
                                            },
                                            stateExt: {
                                                get: () => C.O?.u
                                            },
                                            gameState: {
                                                get: () => C.O?.l
                                            },
                                            gameStateExt: {
                                                get: () => C.O?.l?.u
                                            },
                                            currentFrameNo: {
                                                get: () => C.f
                                            },
                                            banList: {
                                                get: () => C.Yy?.tY?.Z_()
                                            },
                                            token: {
                                                get: () => C.Yy?.CY,
                                                set: (S) => {
                                                    var h = C.Yy;
                                                    h && (h.CY = S,
                                                        h.Kp(),
                                                        G.OO = null,
                                                        _(() => {
                                                            h._R(),
                                                                G._onRoomTokenChange?.(h.CY)
                                                        }
                                                            , 20000))
                                                }
                                            },
                                            requireRecaptcha: {
                                                get: () => C.Yy?.Bx,
                                                set: (S) => C.Yy?.vx(S)
                                            },
                                            name: {
                                                get: () => C.O.L
                                            },
                                            password: {
                                                get: () => C.PY
                                            },
                                            geo: {
                                                get: () => C.Tj
                                            },
                                            maxPlayerCount: {
                                                get: () => C.JX == null ? null : C.JX + (C.Xp ? 0 : 1)
                                            },
                                            fakePassword: {
                                                get: () => C.yp
                                            },
                                            fixedPlayerCount: {
                                                get: () => C.ap
                                            },
                                            showInRoomList: {
                                                get: () => C.AR
                                            },
                                            unlimitedPlayerCount: {
                                                get: () => C.uX
                                            },
                                            link: {
                                                get: () => eD(G.OO, C.PY != null)
                                            },
                                            timeLimit: {
                                                get: () => C.O.Py
                                            },
                                            scoreLimit: {
                                                get: () => C.O.Wy
                                            },
                                            redScore: {
                                                get: () => {
                                                    var S = C.O?.l;
                                                    return (S?.u || S)?.EY
                                                }
                                            },
                                            blueScore: {
                                                get: () => {
                                                    var S = C.O?.l;
                                                    return (S?.u || S)?.IY
                                                }
                                            },
                                            timeElapsed: {
                                                get: () => {
                                                    var S = C.O?.l;
                                                    return (S?.u || S)?.Dj
                                                }
                                            },
                                            stadium: {
                                                get: () => C.O.e
                                            },
                                            players: {
                                                get: () => C.O.o
                                            }
                                        })
                                }
                            },
                            fg: function (w) {
                                var C = w.storage || {}
                                    , G = {};
                                return G.up = C.crappy_router || !1,
                                    G.Vl = C.player_name || "Guest",
                                    G.Jy = C.avatar || null,
                                    G.Tj = g0(C.geo || Y3, Y3),
                                {
                                    NY: w.version == null ? I : w.version,
                                    OY: w.proxyAgent || X,
                                    WX: w.identityToken || B,
                                    ZO: w.noPluginMechanism,
                                    uY: w.renderer,
                                    Y: w.config || {},
                                    cX: w.libraries || [],
                                    fj: w.plugins || [],
                                    H5: w.preInit,
                                    EX: w.onOpen,
                                    nY: w.onClose,
                                    eR: w.onConnInfo,
                                    pO: G
                                }
                            },
                            Lg: function (w) {
                                var { WX: C } = w;
                                if (C) {
                                    if (!J.qY) {
                                        J.GR(JQ.jx(j0.Jr) || "NoProxyIdentityProblem");
                                        var G = JQ.jx(j0.Zr);
                                        return void (G && J.GR(G))
                                    }
                                    return [C]
                                }
                            },
                            eg: function (w) {
                                var C = ZJ.j();
                                return C.fY(w.Vl),
                                    C.fY(w.Tj.flag),
                                    C.AY(w.Jy),
                                    C.wO()
                            },
                            kg: function (w) {
                                JQ.yi(w);
                                var C = w._onPlayerObjectCreated;
                                C && w.R.O.o.forEach(C),
                                    (C = w._onPlayerDiscCreated) && w.R.O.o.filter((G) => G.U != null).forEach(C)
                            },
                            dg: function (w, C) {
                                JQ.Yi(w)
                            },
                            $g: async function (w, C, G, S, h) {
                                var z0 = G.ZY();
                                if (z0.length > 25)
                                    return l0(j0.rr, S, h, z0);
                                var P0 = G.ZY();
                                if (P0.length > 3)
                                    return l0(j0.ir, S, h, z0, P0);
                                var I0 = G.gY();
                                if (I0?.length > 2)
                                    return l0(j0.hr, S, h, z0, P0, I0);
                                var S0 = w._modifyPlayerData;
                                if (S0) {
                                    var q8 = await S0(C, z0, P0, I0, S, h);
                                    if (!q8)
                                        return l0(j0._r, S, h, z0, P0, I0);
                                    [z0, P0, I0] = q8
                                }
                                var b8 = wY.j(C, z0, P0, I0, S, h);
                                if (!w.C(b8))
                                    return l0(j0.gr, b8);
                                w.R.x5(I1.j(0, C, 0), C, !0)
                            },
                            qg: function (w) {
                                w._onRoomLink?.(eD(w.OO, w.R.PY != null))
                            },
                            Cg: function (w, C) {
                                JQ.Yi(w)
                            },
                            Tg: function (w) {
                                JQ.yi(w);
                                var C = w._onPlayerObjectCreated;
                                C && w.R.O.o.forEach(C),
                                    (C = w._onPlayerDiscCreated) && w.R.O.o.filter((G) => G.U != null).forEach(C)
                            },
                            Pg: function () {
                                this.Ly.Fy()
                            },
                            cg: function () {
                                this.ZO || this.uY?.render?.()
                            }
                        }),
                            Object.assign(this.jp.prototype, {
                                C: function (w, C) {
                                    if (this.u5(w, void 0, C) != 0)
                                        return this.R.kj(w),
                                            !0
                                },
                                Bi: function (w, C) {
                                    if (C != null) {
                                        if (this.u5(w, C) != 0) {
                                            var G = this;
                                            Promise.resolve().then(() => {
                                                G.R.x5(w, C)
                                            }
                                            )
                                        }
                                    } else
                                        this.C(w)
                                },
                                yz: function (w, C) {
                                    if ((C == null || this.R.O.G(C)?.eX) && this.u5(w, C) != 0)
                                        if (this.Hy)
                                            if (C != null) {
                                                var G = this;
                                                Promise.resolve().then(() => {
                                                    G.R.x5(w, C)
                                                }
                                                )
                                            } else
                                                this.R.tl(w, 0, !0);
                                        else
                                            this.R.eb && this.R.kj(w)
                                },
                                i9: function () {
                                    this.R.dj.uy.length = 0
                                },
                                Ji: function (w, C, G) {
                                    this.C(QL.j(w, C, G))
                                },
                                Ki: function (w, C) {
                                    C && this.C(C9.j(w, C))
                                },
                                jg: function (w, C) {
                                    return (w.__proto__.FX != jY || w.e.Z.length != 0) && (!!this.Gi(w, this.R.f, C) && (w.__proto__.FX != $L && w.__proto__.FX != qL && w.__proto__.FX != KL || (this.R.tl(w, w.p, !0),
                                        !1)))
                                },
                                setProperties: function (w) {
                                    if (this.Hy && w) {
                                        var C = {};
                                        if (w.hasOwnProperty("name") && (C.name = this.R.O.L = w.name || ""),
                                            w.hasOwnProperty("password") && (C.password = this.R.PY = w.password),
                                            w.hasOwnProperty("fakePassword") && (C.fakePassword = this.R.yp = w.fakePassword),
                                            w.hasOwnProperty("geo")) {
                                            C.geo = w.geo;
                                            var G = g0(w.geo, this.R.Tj, !1);
                                            this.R.Xp || (this.R.O.G(0).ky = G.flag)
                                        }
                                        w.hasOwnProperty("unlimitedPlayerCount") && (C.unlimitedPlayerCount = this.R.uX = !!w.unlimitedPlayerCount),
                                            w.hasOwnProperty("showInRoomList") && (C.showInRoomList = this.R.AR = !!w.showInRoomList),
                                            w.hasOwnProperty("playerCount") && (C.playerCount = this.R.ap = w.playerCount),
                                            w.hasOwnProperty("maxPlayerCount") && (C.maxPlayerCount = this.R.JX = w.maxPlayerCount == null ? null : w.maxPlayerCount - (this.R.Xp ? 0 : 1)),
                                            this.RO?.(),
                                            this._onRoomPropertiesChange?.(C)
                                    }
                                },
                                sendCustomEvent: function (w, C, G) {
                                    this.yz($L.j(w, C), G)
                                },
                                sendBinaryCustomEvent: function (w, C, G) {
                                    this.yz(qL.j(w, C), G)
                                },
                                setPlayerIdentity: function (w, C, G) {
                                    this.yz(KL.j(w, C), G)
                                },
                                setHandicap: function (w) {
                                    this.R.Y_(w)
                                },
                                clearBan: function (w) {
                                    this.Hy && this.R.m_(w)
                                },
                                clearBans: function () {
                                    this.Hy && this.R.E_()
                                },
                                addPlayerBan: function (w) {
                                    if (this.Hy) {
                                        var C = this.R.O.o.filter((G) => G.X == w)[0];
                                        if (C)
                                            return this.R.Q_(C)
                                    }
                                },
                                addIpBan: function (...w) {
                                    if (this.Hy)
                                        return this.R.F_(...w)
                                },
                                addAuthBan: function (...w) {
                                    if (this.Hy)
                                        return this.R.U_(...w)
                                },
                                removeBan: function (w) {
                                    if (this.Hy)
                                        return this.R.M_(w)
                                },
                                sendChat: function (w, C) {
                                    this.Hy ? this.Bi(NY.j(w), C) : this.C(NY.j(w))
                                },
                                sendChatIndicator: function (w) {
                                    this.Ni != w && (this.C(I1.j(w ? 0 : 1)),
                                        this.Ni = w)
                                },
                                sendAnnouncement: function (w, C, G = -1, S = "", h = 1) {
                                    this.Hy && this.Bi(J3.j(w, G, {
                                        bold: 1,
                                        italic: 2,
                                        small: 3,
                                        "small-bold": 4,
                                        "small-italic": 5
                                    }[S] || 0, h), C)
                                },
                                setDiscProperties: function (w, C) {
                                    this.Hy && this.C(ZL.Pj(w, !1, C))
                                },
                                setPlayerDiscProperties: function (w, C) {
                                    this.Hy && this.C(ZL.Pj(w, !0, C))
                                },
                                getKeyState: function () {
                                    return this.iO
                                },
                                setKeyState: function (w, C = !0) {
                                    this.iO = w,
                                        C && this.Ly.Fy()
                                },
                                extrapolate: function (w, C = !1) {
                                    return C ? this.R.zj(w) : this.R.Tx || this.R.zj(w)
                                },
                                startGame: function () {
                                    this.C(nI.j())
                                },
                                stopGame: function () {
                                    this.C(sI.j())
                                },
                                pauseGame: function () {
                                    this.R.O.l && this.C(iI.j(this.R.O.l.xY != 120))
                                },
                                autoTeams: function () {
                                    this.C(tI.j())
                                },
                                lockTeams: function () {
                                    this.C(aI.j(!this.R.O?.wj))
                                },
                                isGamePaused: function () {
                                    return this.R.O?.l?.xY == 120
                                },
                                resetTeams: function () {
                                    this.ai((w) => w.c.X != 0)
                                },
                                startRecording: function () {
                                    return this.dX == null && (this.dX = new w3(this.R),
                                        this._onRoomRecordingChange?.(!0),
                                        !0)
                                },
                                stopRecording: function () {
                                    if (this.dX == null)
                                        return null;
                                    var w = this.dX.lX();
                                    return this.dX = null,
                                        this._onRoomRecordingChange?.(w),
                                        w
                                },
                                isRecording: function () {
                                    return this.dX != null
                                },
                                randTeams: function () {
                                    var w = []
                                        , C = 0
                                        , G = 0;
                                    function S() {
                                        return w.splice(Math.random() * w.length | 0, 1)[0]
                                    }
                                    if (this.R.O.o.forEach((h) => {
                                        h.c == Q6.Ty ? C++ : h.c == Q6.yY ? G++ : w.push(h.X)
                                    }
                                    ),
                                        w.length != 0) {
                                        if (w.length == 1)
                                            return void this.C(C9.j(S(), Math.random() < 0.5 ? Q6.Ty : Q6.yY));
                                        if (G == C)
                                            return this.C(C9.j(S(), Q6.Ty)),
                                                void this.C(C9.j(S(), Q6.yY));
                                        this.C(C9.j(S(), G > C ? Q6.Ty : Q6.yY))
                                    }
                                },
                                setSync: function (w) {
                                    this.R.O.Al(w)
                                },
                                leave: function () {
                                    this.nl()
                                },
                                setCurrentStadium: function (w) {
                                    this.C(jY.j(w))
                                },
                                setTimeLimit: function (w) {
                                    this.C(F1.j(1, w))
                                },
                                setScoreLimit: function (w) {
                                    this.C(F1.j(0, w))
                                },
                                changeTeam: function (w) {
                                    this.Ki(this.R.ej, Q6.p[w])
                                },
                                resetTeam: function (w) {
                                    this.ai((C) => C.c.X == w)
                                },
                                setPlayerTeam: function (w, C) {
                                    this.Ki(w, Q6.p[C])
                                },
                                setPlayerAdmin: function (w, C) {
                                    this.C(rI.j(w, C))
                                },
                                kickPlayer: function (w, C, G) {
                                    this.C(L1.j(w, C || "", G))
                                },
                                setAvatar: function (w) {
                                    this.C(BY.j(w?.substr(0, 2) || ""))
                                },
                                setPlayerAvatar: function (w, C, G) {
                                    !this.Hy && (G || w != this.R.ej) || this.C(G ? Z3.j(w, C) : BY.j(C), G ? 0 : w)
                                },
                                reorderPlayers: function (w, C) {
                                    this.C(Q3.j(w, C))
                                },
                                setChatIndicatorActive: function (w) {
                                    this.C(I1.j(w ? 0 : 1))
                                },
                                setTeamColors: function (w, C, ...G) {
                                    var S = Q6.p[w];
                                    if (!S)
                                        throw l0(j0.CR);
                                    this.C(JL.j(S, dQ.Pj(S, C, ...G)))
                                },
                                setUnlimitedPlayerCount: function (w) {
                                    this.Hy && (this.R.uX = w)
                                },
                                setFakePassword: function (w) {
                                    this.Hy && (this.R.yp = w,
                                        this.RO?.())
                                },
                                getPlayer: function (w) {
                                    return this.R.O.G(w)
                                },
                                getBall: function (w = !1) {
                                    var C = this.R.O?.l;
                                    return (w && C?.u || C)?.A.Z[0]
                                },
                                getDiscs: function (w = !1) {
                                    var C = this.R.O?.l;
                                    return (w && C?.u || C)?.A.Z
                                },
                                getDisc: function (w, C = !1) {
                                    var G = this.R.O?.l;
                                    return (C && G?.u || G)?.A.Z[w]
                                },
                                getPlayerDisc: function (w, C = !1) {
                                    var G = this.R.O?.l
                                        , S = (C && G?.u || G)?.A.Z
                                        , h = this.R.O?.e.Z;
                                    if (S && h) {
                                        for (var z0 = h.length; z0 < S.length; z0++)
                                            if (S[z0].n == w)
                                                return S[z0]
                                    }
                                },
                                getPlayerDisc_exp: function (w) {
                                    return this.R.O?.G(w)?.U
                                },
                                fakePlayerJoin: function (w, C, G, S, h, z0) {
                                    this.C(wY.j(w, C, G, S, h, z0))
                                },
                                fakePlayerLeave: function (w) {
                                    var C = this.R.O.G(w);
                                    if (C)
                                        return this.C(L1.j(w, null, !0)),
                                        {
                                            id: C.X,
                                            name: C.L,
                                            flag: C.ky,
                                            avatar: C.Jy,
                                            conn: C.Qj,
                                            auth: C.Gy
                                        }
                                },
                                fakeSendPlayerInput: function (w, C) {
                                    this.C(UY.j(w), C)
                                },
                                fakeSendPlayerChat: function (w, C) {
                                    this.C(NY.j(w), C)
                                },
                                fakeSetPlayerChatIndicator: function (w, C) {
                                    this.C(I1.j(w ? 0 : 1), C)
                                },
                                fakeSetPlayerAvatar: function (w, C) {
                                    this.C(BY.j(w), C)
                                },
                                fakeSetStadium: function (w, C) {
                                    this.C(jY.j(w), C)
                                },
                                fakeStartGame: function (w) {
                                    this.C(nI.j(), w)
                                },
                                fakeStopGame: function (w) {
                                    this.C(sI.j(), w)
                                },
                                fakeSetGamePaused: function (w, C) {
                                    this.C(iI.j(w), C)
                                },
                                fakeSetScoreLimit: function (w, C) {
                                    this.C(F1.j(0, w), C)
                                },
                                fakeSetTimeLimit: function (w, C) {
                                    this.C(F1.j(1, w), C)
                                },
                                fakeSetTeamsLock: function (w, C) {
                                    this.C(aI.j(w), C)
                                },
                                fakeAutoTeams: function (w) {
                                    this.C(tI.j(), w)
                                },
                                fakeSetPlayerTeam: function (w, C, G) {
                                    var S = Q6.p[C];
                                    S && this.C(C9.j(w, S), G)
                                },
                                fakeSetKickRateLimit: function (w, C, G, S) {
                                    this.C(QL.j(w, C, G), S)
                                },
                                fakeSetTeamColors: function (w, C, G, S) {
                                    var h = Q6.p[w];
                                    if (!h)
                                        throw l0(j0.CR);
                                    this.C(JL.j(h, dQ.Pj(h, C, ...G)), S)
                                },
                                fakeSetPlayerAdmin: function (w, C, G) {
                                    this.C(rI.j(w, C), G)
                                },
                                fakeKickPlayer: function (w, C, G, S) {
                                    this.C(L1.j(w, C, G), S)
                                },
                                fakeSetPlayerSync: function (w, C) {
                                    this.C(eI.j(w), C)
                                },
                                takeSnapshot: function () {
                                    return this.R.O?.copy()
                                },
                                exportStadium: function () {
                                    return this.R.O?.P5()
                                },
                                createVertex: function (w) {
                                    return this.R.O?.vi(w)
                                },
                                createSegment: function (w) {
                                    return this.R.O?.si(w)
                                },
                                createSegmentFromObj: function (w) {
                                    return this.R.O?.kb(w)
                                },
                                createGoal: function (w) {
                                    return this.R.O?.ui(w)
                                },
                                createPlane: function (w) {
                                    return this.R.O?.yh(w)
                                },
                                createDisc: function (w) {
                                    return this.R.O?.Yh(w)
                                },
                                createJoint: function (w) {
                                    return this.R.O?.jh(w)
                                },
                                createJointFromObj: function (w) {
                                    return this.R.O?.$b(w)
                                },
                                addVertex: function (w) {
                                    return this.R.O?.qb(w)
                                },
                                addSegment: function (w) {
                                    return this.R.O?.Cb(w)
                                },
                                addGoal: function (w) {
                                    return this.R.O?.Tb(w)
                                },
                                addPlane: function (w) {
                                    return this.R.O?.Pb(w)
                                },
                                addDisc: function (w) {
                                    return this.R.O?.Ap(w)
                                },
                                addJoint: function (w) {
                                    return this.R.O?.cb(w)
                                },
                                addSpawnPoint: function (w) {
                                    return this.R.O?.ob(w)
                                },
                                addPlayer: function (w) {
                                    return this.R.O?.RR(w)
                                },
                                findVertexIndicesOfSegmentObj: function (w) {
                                    return this.R.O?.b5(w)
                                },
                                findVertexIndicesOfSegment: function (w) {
                                    return this.R.O?.Hb(w)
                                },
                                updateVertex: function (w, C) {
                                    return this.R.O?.tb(w, C)
                                },
                                updateSegment: function (w, C) {
                                    return this.R.O?.Wb(w, C)
                                },
                                updateGoal: function (w, C) {
                                    return this.R.O?.wb(w, C)
                                },
                                updatePlane: function (w, C) {
                                    return this.R.O?.Ib(w, C)
                                },
                                updateDisc: function (w, C) {
                                    return this.R.O?.Eb(w, C)
                                },
                                updateDiscObj: function (w, C) {
                                    return this.R.O?.ER(w, C)
                                },
                                updateJoint: function (w, C) {
                                    return this.R.O?.mb(w, C)
                                },
                                updateSpawnPoint: function (w, C, G) {
                                    return this.R.O?.Qb(w, C, G)
                                },
                                updatePlayer: function (w, C) {
                                    return this.R.O?.Fb(w, C)
                                },
                                removeVertex: function (w) {
                                    return this.R.O?.Ub(w)
                                },
                                removeSegment: function (w) {
                                    return this.R.O?.Mb(w)
                                },
                                removeGoal: function (w) {
                                    return this.R.O?.nb(w)
                                },
                                removePlane: function (w) {
                                    return this.R.O?.Nb(w)
                                },
                                removeDisc: function (w) {
                                    return this.R.O?.eO(w)
                                },
                                removeJoint: function (w) {
                                    return this.R.O?.Vb(w)
                                },
                                removeSpawnPoint: function (w, C) {
                                    return this.R.O?.Bb(w, C)
                                },
                                removePlayer: function (w) {
                                    return this.R.O?.Fx(w)
                                },
                                updateStadiumPlayerPhysics: function (w) {
                                    return this.R.O?.Kb(w)
                                },
                                updateStadiumBg: function (w) {
                                    return this.R.O?.Gb(w)
                                },
                                updateStadiumGeneral: function (w) {
                                    return this.R.O?.ab(w)
                                },
                                ai: function (w, C = Q6.bY) {
                                    var G = this;
                                    this.R.O.o.slice().forEach((S) => {
                                        w(S) && G.C(C9.j(S.X, C))
                                    }
                                    )
                                },
                                Gi: function (w, C, G) {
                                    var S = this._onOperationReceived;
                                    if (!S)
                                        return !0;
                                    var h = w.eventType;
                                    return h == null || S(h, w, C, G)
                                },
                                u5: function (w, C, G) {
                                    if (this.Hy)
                                        return w.p = G || 0,
                                            w.uO = C,
                                            this.Gi(w, this.R.f, null)
                                },
                                Nl: function () {
                                    var w = null
                                        , C = this.uY
                                        , G = this.Y
                                        , S = this;
                                    if (!this.ZO) {
                                        let h = function (I0, S0, q8) {
                                            for (var b8 = 0, s8 = 0; b8 < I0.length && s8 < S0.length;) {
                                                for (; b8 < I0.length && s8 < S0.length && I0[b8] == S0[s8] && I0[b8] != q8;)
                                                    b8++,
                                                        s8++;
                                                if (I0[b8] == q8)
                                                    break;
                                                for (; b8 < I0.length && s8 < S0.length && I0[b8] != S0[s8] && I0[b8] != q8;)
                                                    b8++;
                                                if (I0[b8] == q8)
                                                    break
                                            }
                                            S0[s8] != q8 && S0.splice(s8, 0, q8)
                                        }
                                            , z0 = function (I0) {
                                                Object.defineProperty(S, I0, {
                                                    get: () => G[I0],
                                                    set(S0) {
                                                        G[I0] = S0
                                                    }
                                                })
                                            }
                                            , P0 = function (I0) {
                                                z0(I0 + "Before"),
                                                    z0(I0),
                                                    z0(I0 + "After")
                                            };
                                        this.librariesMap = this.cX.reduce((I0, S0) => (I0[S0.L] = S0,
                                            I0), {}),
                                            this.pluginsMap = this.fj.reduce((I0, S0) => (I0[S0.L] = S0,
                                                I0), {}),
                                            this.ni = w = this.fj.filter((I0) => I0.active),
                                            this.setConfig = function (I0) {
                                                var S0 = G;
                                                S0.finalize?.(),
                                                    S0.$y = null,
                                                    (I0 = I0 || {}).$y = S,
                                                    I0.initialize?.(),
                                                    G = S.Y = I0,
                                                    S._onConfigUpdate?.(S0, I0)
                                            }
                                            ,
                                            this.mixConfig = function (I0) {
                                                Object.keys(I0).forEach((S0) => {
                                                    var q8 = I0[S0];
                                                    if (typeof q8 == "function") {
                                                        var b8 = G[S0];
                                                        b8 ? typeof b8 == "function" && (G[S0] = function (...s8) {
                                                            b8(...s8),
                                                                q8(...s8)
                                                        }
                                                        ) : G[S0] = q8
                                                    }
                                                }
                                                )
                                            }
                                            ,
                                            this.setRenderer = function (I0) {
                                                var S0 = C;
                                                S0 && (S0.finalize?.(),
                                                    S0.$y = null),
                                                    I0 && (I0.$y = S,
                                                        I0.initialize?.()),
                                                    C = S.uY = I0,
                                                    S._onRendererUpdate?.(S0, I0)
                                            }
                                            ,
                                            this.setPluginActive = function (I0, S0) {
                                                var q8, b8 = S.fj.filter((s8) => s8.L == I0)[0];
                                                if (b8 && b8.active != S0)
                                                    if (S0) {
                                                        if ((q8 = w.findIndex((s8) => s8.L == I0)) >= 0)
                                                            return;
                                                        h(S.fj, w, b8),
                                                            b8.active = S0,
                                                            S._onPluginActiveChange?.(b8)
                                                    } else {
                                                        if ((q8 = w.findIndex((s8) => s8.L == I0)) < 0)
                                                            return;
                                                        b8.active = S0,
                                                            S._onPluginActiveChange?.(b8),
                                                            w.splice(q8, 1)
                                                    }
                                            }
                                            ,
                                            this._modifyPlayerData = async (I0, S0, q8, b8, s8, d7) => {
                                                var S7, QQ, u6 = [S0, q8, b8];
                                                if (G.modifyPlayerDataBefore && ((QQ = G.modifyPlayerDataBefore(I0, u6[0], u6[1], u6[2], s8, d7)) instanceof Promise && (QQ = await QQ),
                                                    [u6, S7] = QQ),
                                                    S7 !== !1) {
                                                    for (var VL = 0; VL < w.length; VL++) {
                                                        var j3 = w[VL];
                                                        j3.modifyPlayerData && u6 && ((u6 = j3.modifyPlayerData(I0, u6[0], u6[1], u6[2], s8, d7, S7)) instanceof Promise && (u6 = await u6))
                                                    }
                                                    G.modifyPlayerData && u6 && ((u6 = G.modifyPlayerData(I0, u6[0], u6[1], u6[2], s8, d7, S7)) instanceof Promise && (u6 = await u6)),
                                                        G.modifyPlayerDataAfter && u6 && ((u6 = G.modifyPlayerDataAfter(I0, u6[0], u6[1], u6[2], s8, d7, S7)) instanceof Promise && (u6 = await u6))
                                                }
                                                return u6
                                            }
                                            ,
                                            P0("modifyPlayerData"),
                                            this._modifyPlayerPing = function (I0, S0) {
                                                var q8;
                                                return G.modifyPlayerPingBefore && ([S0, q8] = G.modifyPlayerPingBefore(I0, S0)),
                                                    q8 !== !1 && (w.forEach((b8) => {
                                                        b8.modifyPlayerPing && (S0 = b8.modifyPlayerPing(I0, S0, q8))
                                                    }
                                                    ),
                                                        G.modifyPlayerPing && (S0 = G.modifyPlayerPing(I0, S0, q8)),
                                                        G.modifyPlayerPingAfter && (S0 = G.modifyPlayerPingAfter(I0, S0, q8))),
                                                    S0
                                            }
                                            ,
                                            P0("modifyPlayerPing"),
                                            this._modifyClientPing = function (I0) {
                                                var S0;
                                                return G.modifyClientPingBefore && ([I0, S0] = G.modifyClientPingBefore(I0)),
                                                    S0 !== !1 && (w.forEach((q8) => {
                                                        q8.modifyClientPing && (I0 = q8.modifyClientPing(I0, S0))
                                                    }
                                                    ),
                                                        G.modifyClientPing && (I0 = G.modifyClientPing(I0, S0)),
                                                        G.modifyClientPingAfter && (I0 = G.modifyClientPingAfter(I0, S0))),
                                                    I0
                                            }
                                            ,
                                            P0("modifyClientPing"),
                                            this._onOperationReceived = function (I0, S0, q8, b8) {
                                                var s8, d7 = G.onBeforeOperationReceived?.(I0, S0, q8, b8), S7 = d7 !== !1;
                                                return w.forEach((QQ) => {
                                                    s8 = QQ.onOperationReceived,
                                                        S7 && s8 && !s8(I0, S0, q8, b8, d7) && (S7 = !1)
                                                }
                                                ),
                                                    s8 = G.onOperationReceived,
                                                    S7 && s8 && !s8(I0, S0, q8, b8, d7) && (S7 = !1),
                                                    s8 = G.onAfterOperationReceived,
                                                    S7 && s8 && !s8(I0, S0, q8, b8, d7) && (S7 = !1),
                                                    S7
                                            }
                                            ,
                                            z0("onBeforeOperationReceived"),
                                            z0("onOperationReceived"),
                                            z0("onAfterOperationReceived"),
                                            ST.forEach(({ L: I0, h9: S0 }) => {
                                                (function (q8, b8) {
                                                    S["_on" + q8] = function (...s8) {
                                                        var d7 = G["onBefore" + q8]?.(...s8);
                                                        d7 !== !1 && (w.forEach((S7) => {
                                                            S7["on" + q8]?.(...s8, d7)
                                                        }
                                                        ),
                                                            G["on" + q8]?.(...s8, d7),
                                                            C?.["on" + q8]?.(...s8, d7),
                                                            G["onAfter" + q8]?.(...s8, d7))
                                                    }
                                                        ,
                                                        z0("onBefore" + q8),
                                                        z0("on" + q8),
                                                        z0("onAfter" + q8)
                                                }
                                                )(I0)
                                            }
                                            )
                                    }
                                    this.H5?.(this),
                                        this.ZO || (this.cX.forEach((h) => {
                                            h.$y = S,
                                                h.initialize?.()
                                        }
                                        ),
                                            this.Y.$y = this,
                                            this.Y.initialize?.(),
                                            this.uY && (this.uY.$y = this,
                                                this.uY.initialize?.()),
                                            this.fj.forEach((h) => {
                                                h.$y = S,
                                                    h.initialize?.()
                                            }
                                            ),
                                            this.ni.forEach((h) => {
                                                S._onPluginActiveChange?.(h)
                                            }
                                            ))
                                },
                                Ml: function (w) {
                                    this.fj?.forEach((C) => {
                                        C.finalize?.(),
                                            C.$y = null
                                    }
                                    ),
                                        this.uY && (this.uY.finalize?.(),
                                            this.uY.$y = null),
                                        this.Y.finalize?.(),
                                        this.Y.$y = null,
                                        this.cX?.forEach((C) => {
                                            C.finalize?.(),
                                                C.$y = null
                                        }
                                        ),
                                        this.nY?.(w)
                                },
                                updatePlugin: function (w, C) {
                                    var G = this.fj[w];
                                    if (!G)
                                        throw l0(j0.Ar, w);
                                    var { L: S, active: h } = G;
                                    if (S != C.L)
                                        throw l0(j0.Sr);
                                    var z0 = this.setPluginActive;
                                    h && z0(S, !1),
                                        G.finalize?.(),
                                        G.$y = null,
                                        this.fj[w] = C,
                                        this.pluginsMap[S] = C,
                                        C.$y = this,
                                        C.initialize?.(),
                                        this._onPluginUpdate?.(G, C),
                                        h && (C.active = !1,
                                            z0(S, !0))
                                },
                                updateLibrary: function (w, C) {
                                    var G = this.cX[w];
                                    if (!G)
                                        throw l0(j0.Dr, w);
                                    var { L: S } = G;
                                    if (S != C.L)
                                        throw l0(j0.br);
                                    G.finalize?.(),
                                        G.$y = null,
                                        this.cX[w] = C,
                                        this.librariesMap[S] = C,
                                        C.$y = this,
                                        C.initialize?.(),
                                        this._onLibraryUpdate?.(G, C)
                                },
                                startStreaming: function ({ immediate: w = !0, onClientCount: C, emitData: G }) {
                                    if (this.Hy && !this.isRecording() && !this.R.VY) {
                                        var S = new Map
                                            , h = ZJ.j(16384)
                                            , z0 = 0
                                            , P0 = this;
                                        return {
                                            onOpen: () => {
                                                P0.R.VY = function (I0) {
                                                    if (w)
                                                        return h.g(2),
                                                            h.ey(P0.R.f),
                                                            h.My(I0.p),
                                                            lZ(I0, h),
                                                            G?.(h.my()),
                                                            void (h._ = 0);
                                                    var S0 = S.get(P0.R.f);
                                                    S0 || (S0 = [],
                                                        S.set(P0.R.f, S0)),
                                                        S0.push(I0)
                                                }
                                            }
                                            ,
                                            onDataReceived: (I0) => {
                                                var S0 = (I0 = new DataView(I0.buffer, I0.byteOffset, I0.byteLength)).getUint8(0);
                                                switch (I0 = I0.getUint16(1),
                                                S0) {
                                                    case 0:
                                                        z0 = I0,
                                                            C?.(I0);
                                                        break;
                                                    case 1:
                                                        var q8 = ZJ.j();
                                                        q8.g(1),
                                                            q8.My(I0);
                                                        var b8 = ZJ.j();
                                                        P0.R.G_(b8),
                                                            q8.sy(s.deflateRaw(b8.my())),
                                                            G?.(q8.my())
                                                }
                                            }
                                            ,
                                            interval: () => {
                                                for (var I0 = S.keys(), S0 = I0.next(), q8 = P0.R.f; !S0.done;) {
                                                    var b8 = S0.value
                                                        , s8 = S.get(b8);
                                                    h.My(q8 - b8),
                                                        h.My(s8.length),
                                                        s8.forEach((u6) => {
                                                            h.My(u6.p),
                                                                lZ(u6, h)
                                                        }
                                                        ),
                                                        S0 = I0.next()
                                                }
                                                S.clear();
                                                var d7 = h.my();
                                                if (h._ = 0,
                                                    z0 != 0) {
                                                    d7 = s.deflateRaw(d7);
                                                    var S7 = new Uint8Array(d7.byteLength + 5)
                                                        , QQ = new DataView(S7.buffer, S7.byteOffset, S7.byteLength);
                                                    QQ.setUint8(0, 0),
                                                        QQ.setUint32(1, q8),
                                                        S7.set(d7, 5),
                                                        G?.(S7)
                                                }
                                            }
                                        }
                                    }
                                },
                                stopStreaming: function () {
                                    !this.Hy || this.isRecording() || !this.R.VY || (this.R.VY = null)
                                }
                            }),
                            this.gX = mI({
                                Q: function () {
                                    this.c = Q6.bY,
                                        this.U = null,
                                        this.bj = 0,
                                        this.Jj = 0,
                                        this.GY = !1,
                                        this.Ly = 0,
                                        this.ip = 0,
                                        this.oX = null,
                                        this.Jy = null,
                                        this.QY = 0,
                                        this.oY = !1,
                                        this.eX = !1
                                },
                                LY: function (w, C, G) {
                                    w.oY = C.oY,
                                        w.QY = C.QY,
                                        w.Jy = C.Jy,
                                        w.oX = C.oX,
                                        w.ip = C.ip,
                                        w.Ly = C.Ly,
                                        w.GY = C.GY,
                                        w.Jj = C.Jj,
                                        w.bj = C.bj,
                                        w.U = C.U == null ? null : C.U.dY(G),
                                        w.U && (w.U.n = w.X),
                                        w.c = C.c
                                }
                            }),
                            this.Rj = gI(this, {
                                Q: function () {
                                    this.l = null,
                                        this.e = C6.D5()[0],
                                        this.Wj = 2,
                                        this.Zj = 0,
                                        this.jX = 1,
                                        this.Py = 3,
                                        this.Wy = 3,
                                        this.wj = !1,
                                        this.yj = [null, new dQ, new dQ],
                                        this.yj[1].KY.push(Q6.Ty.b),
                                        this.yj[2].KY.push(Q6.yY.b)
                                },
                                LY: function (w, C, G) {
                                    w.l = C.l?.dY(G),
                                        w.wj = C.wj,
                                        w.Wy = C.Wy,
                                        w.Py = C.Py,
                                        w.jX = C.jX,
                                        w.Zj = C.Zj,
                                        w.Wj = C.Wj,
                                        w.e = C.e,
                                        w.yj = C.yj
                                },
                                Qy: function (w) {
                                    this.l?.Qy(w)
                                },
                                _X: function (w) {
                                    this.l?.A.eO(w.U)
                                },
                                h_: function (w) {
                                    w.g(this.wj ? 1 : 0),
                                        w.m(this.Wy),
                                        w.m(this.Py),
                                        w.Ox(this.jX),
                                        w.g(this.Zj),
                                        w.g(this.Wj),
                                        this.e.S(w),
                                        w.g(this.l ? 1 : 0),
                                        this.l?.S(w),
                                        w.g(this.o.length),
                                        this.o.forEach((C) => {
                                            w.g(C.oY ? 1 : 0),
                                                w.m(C.QY),
                                                w.AY(C.Jy),
                                                w.AY(C.oX),
                                                w.g(C.Oj ? 1 : 0),
                                                w.AY(C.ky),
                                                w.m(C.ip),
                                                w.AY(C.L),
                                                w.m(C.Ly),
                                                w.oy(C.X),
                                                w.g(C.GY ? 1 : 0),
                                                w.Ox(C.Jj),
                                                w.g(C.bj),
                                                w.g(C.c.X),
                                                w.Ox(C.U == null ? -1 : C.U.vr)
                                        }
                                        ),
                                        this.yj[1].S(w),
                                        this.yj[2].S(w)
                                },
                                __: function (w) {
                                    this.wj = w.q() != 0,
                                        this.Wy = w.W(),
                                        this.Py = w.W(),
                                        this.jX = w.Xx(),
                                        this.Zj = w.q(),
                                        this.Wj = w.q(),
                                        this.e = C6.D(w),
                                        this.l = null,
                                        w.q() != 0 && (this.l = new tD,
                                            this.l.D(w, this));
                                    for (var C = this.l?.A.Z, G = w.q(); this.o.length > G;)
                                        this.o.pop();
                                    for (var S = 0; S < G; S++) {
                                        var h = new this.BX.gX;
                                        h.oY = w.q() != 0,
                                            h.QY = w.W(),
                                            h.Jy = w.gY(),
                                            h.oX = w.gY(),
                                            h.Oj = w.q() != 0,
                                            h.ky = w.gY(),
                                            h.ip = w.W(),
                                            h.L = w.gY(),
                                            h.Ly = w.W(),
                                            h.X = w.Ey(),
                                            h.GY = w.q() != 0,
                                            h.Jj = w.Xx(),
                                            h.bj = w.q(),
                                            h.c = Q6.p[w.kp()] || Q6.bY;
                                        var z0 = w.Xx();
                                        h.U = C?.[z0],
                                            h.U && (h.U.n = h.X),
                                            this.o[S] = h
                                    }
                                    this.yj[1].D(w),
                                        this.yj[2].D(w)
                                }
                            }),
                            Object.assign(this.Rj.prototype, {
                                KD: function (w) {
                                    this.l == null && (this.l = new tD,
                                        this.o.forEach((C) => {
                                            C.U = null,
                                                C.QY = 0
                                        }
                                        ),
                                        this.l.tD(this),
                                        this.t5?.(w))
                                },
                                GD: function (w) {
                                    var C = this;
                                    C.l && (C.l = null,
                                        C.o.forEach((G) => {
                                            G.U && C.xp?.(G),
                                                G.U = null,
                                                G.QY = 0
                                        }
                                        ),
                                        C.o5?.(),
                                        C.cR?.(w))
                                },
                                yb: function (w, C) {
                                    this.wj = w,
                                        this.F5?.(w, C)
                                },
                                Ob: function (w, C, G) {
                                    w != Q6.bY.X && (this.yj[w] = C,
                                        this.Q5?.(w, C, G))
                                },
                                uD: function (w, C) {
                                    this.l == null && (this.e = w,
                                        this.B5?.(this.G(C), w))
                                },
                                oR: function (w, C, G, S) {
                                    if (w && w.c != C) {
                                        if (w.c = C,
                                            D8(this.o, w),
                                            this.o.push(w),
                                            !this.l)
                                            return void (S || this.IR?.(w.X, C.X, G));
                                        this.l.A.sr(w, this.xp),
                                            this.l.Di(w);
                                        var h = 0;
                                        do
                                            h++;
                                        while (this.o.find((z0) => z0 != w && z0.c == w.c && z0.QY == h));
                                        w.QY = h,
                                            S || this.IR?.(w.X, C.X, G)
                                    }
                                },
                                Xb: function (w, C) {
                                    !w || C == w.Oj || (w.Oj = C,
                                        this.K5?.(w))
                                },
                                Yb: function (w, C, G) {
                                    !w || w.X == 0 || w.oY == C || (w.oY = C,
                                        this.G5?.(this.G(G), w))
                                },
                                Ji: function (w, C, G, S) {
                                    this.Wj = Q7(w, 0, 255),
                                        this.Zj = Q7(C, 0, 255),
                                        G = Q7(G, 0, 100),
                                        this.jX = this.Zj * G,
                                        this.a5?.(S, this.Wj, this.Zj, G)
                                },
                                xb: function (w, C) {
                                    var G = this.G(w);
                                    G && (G.oX = C,
                                        this.E5?.(w, C))
                                },
                                vD: function (w, C) {
                                    this.l == null && (this.Wy = Q7(w, 0, 99),
                                        this.w5?.(this.Wy, C))
                                },
                                sD: function (w, C) {
                                    this.l == null && (this.Py = Q7(w, 0, 99),
                                        this.W5?.(this.Py, C))
                                },
                                zb: function (w, C, G, S) {
                                    if (this.l) {
                                        var h = w ? this.G(C)?.U : this.l.A.Z[C];
                                        h && (G[0] != null && (h.h.x = G[0]),
                                            G[1] != null && (h.h.y = G[1]),
                                            G[2] != null && (h.P.x = G[2]),
                                            G[3] != null && (h.P.y = G[3]),
                                            G[4] != null && (h.T.x = G[4]),
                                            G[5] != null && (h.T.y = G[5]),
                                            G[6] != null && (h.I = G[6]),
                                            G[7] != null && (h.r = G[7]),
                                            G[8] != null && (h.F = G[8]),
                                            G[9] != null && (h.N = G[9]),
                                            S[0] != null && (h.b = S[0]),
                                            S[1] != null && (h.z = S[1]),
                                            S[2] != null && (h.i = S[2]),
                                            this.n5?.(C, w, G, S))
                                    }
                                },
                                pb: function (w, C) {
                                    var G = this.G(w);
                                    G && (G.Jy = C,
                                        this.I5?.(w, C))
                                },
                                VD: function (w, C) {
                                    var G = this.G(w);
                                    G && (!(16 & G.Ly) && 16 & C && (G.GY = !0),
                                        G.Ly = C,
                                        this.WR?.(G))
                                },
                                ND: function (w, C) {
                                    var G = this.G(w);
                                    G && this.v5?.(G, C)
                                },
                                BD: function (w, C) {
                                    var G = this.G(C);
                                    G && this.N5?.(G, w)
                                },
                                MD: function (w, C, G, S) {
                                    this.V5?.(w, C, G, S)
                                },
                                Rb: function (w, C) {
                                    var G = new Map
                                        , S = []
                                        , h = [];
                                    this.o.forEach((I0) => G.set(I0.X, I0)),
                                        w.forEach((I0) => {
                                            var S0 = G.get(I0);
                                            S0 && (G.delete(I0),
                                                S.push(S0))
                                        }
                                        ),
                                        h = [];
                                    for (var z0 = G.values(), P0 = z0.next(); !P0.done;)
                                        h.push(P0.value),
                                            P0 = z0.next();
                                    this.o = C ? S.concat(h) : h.concat(S),
                                        this.m5?.(w, C)
                                },
                                aD: function (w, C) {
                                    var G = this.l;
                                    if (G) {
                                        var S = G.xY == 120;
                                        w ? G.xY = 120 : S && (G.xY = 119),
                                            w != S && this.s5?.(this.G(C), w)
                                    }
                                },
                                lb: function (w, C, G) {
                                    G != 0 && !this.G(G) || this.U5?.(w, C, G)
                                },
                                rb: function (w, C, G) {
                                    G != 0 && !this.G(G) || this.M5?.(w, C, G)
                                },
                                jb: function (w) {
                                    var C = []
                                        , G = 0
                                        , S = 0;
                                    this.o.forEach((P0) => {
                                        P0.c == Q6.bY && C.push(P0),
                                            P0.c == Q6.Ty ? ++G : P0.c == Q6.yY && ++S
                                    }
                                    );
                                    var h = C.length;
                                    if (h != 0)
                                        if (S == G)
                                            h >= 2 && (this.oR(C[0], Q6.Ty, w, !0),
                                                this.oR(C[1], Q6.yY, w, !0),
                                                this.wR?.(C[0].X, Q6.Ty.X, C[1].X, Q6.yY.X, w));
                                        else {
                                            var z0 = S > G ? Q6.Ty : Q6.yY;
                                            this.oR(C[0], z0, w, !0),
                                                this.wR?.(C[0].X, z0.X, null, null, w)
                                        }
                                },
                                Xh: function (w) {
                                    this.wD = w
                                },
                                copy: function () {
                                    var w = new this.BX.Rj;
                                    return w.L = this.L,
                                        w.wj = this.wj,
                                        w.Wy = this.Wy,
                                        w.Py = this.Py,
                                        w.jX = this.jX,
                                        w.Zj = this.Zj,
                                        w.Wj = this.Wj,
                                        w.e = this.e?.copy(),
                                        w.l = this.l?.copy(w),
                                        w.o = [],
                                        this.o.forEach((C, G) => {
                                            var S = new this.BX.gX;
                                            if (S.oY = C.oY,
                                                S.QY = C.QY,
                                                S.Jy = C.Jy,
                                                S.oX = C.oX,
                                                S.Oj = C.Oj,
                                                S.ky = C.ky,
                                                S.ip = C.ip,
                                                S.L = C.L,
                                                S.Ly = C.Ly,
                                                S.X = C.X,
                                                S.GY = C.GY,
                                                S.Jj = C.Jj,
                                                S.bj = C.bj,
                                                S.c = C.c,
                                                S.Gy = C.Gy,
                                                S.Qj = C.Qj,
                                                S.eX = C.eX,
                                                w.l && C.U) {
                                                var h = C.U.n
                                                    , z0 = w.l.A.Z.findIndex((P0) => P0.n == h);
                                                z0 > -1 && (S.U = w.l.A.Z[z0])
                                            }
                                            w.o[G] = S
                                        }
                                        ),
                                        this.yj.forEach((C, G) => {
                                            w.yj[G] = C?.copy()
                                        }
                                        ),
                                        w
                                },
                                P5: function () {
                                    if (this.l) {
                                        var { e: w, A: C } = this.l
                                            , G = new X8
                                            , S = new e9
                                            , h = {}
                                            , z0 = w.jY.map((q8) => [q8.x, q8.y])
                                            , P0 = w.XY.map((q8) => [q8.x, q8.y])
                                            , I0 = C._y.map(C6.Ri);
                                        C6.w(h, "type", w.wY == 1 ? "grass" : w.wY == 2 ? "hockey" : "none", "none"),
                                            C6.w(h, "width", w._j, 0),
                                            C6.w(h, "height", w.gj, 0),
                                            C6.w(h, "kickOffRadius", w.Aj, 0),
                                            C6.w(h, "cornerRadius", w.Sj, 0),
                                            C6.pp(h, w.hj, 7441498),
                                            w.wY == 2 && C6.w(h, "goalLine", w.Hj, 0);
                                        var S0 = {
                                            name: w.L,
                                            width: w.vY,
                                            height: w.ij,
                                            vertexes: C.k.map((q8, b8) => {
                                                var s8 = C6.Xi(q8);
                                                return s8.id = b8,
                                                    s8
                                            }
                                            ),
                                            segments: C.t.map((q8) => C6.dD(this, q8, G)),
                                            planes: C.M.map(C6.zi),
                                            goals: w.ty.map(C6.ri),
                                            discs: C.Z.map((q8) => C6.hi(q8, S)),
                                            bg: h,
                                            playerPhysics: C6.ii(w.aY),
                                            ballPhysics: "disc0"
                                        };
                                        return C6.w(S0, "maxViewWidth", w.sj, 0),
                                            C6.w(S0, "cameraFollow", w.uj == 1 ? "player" : "", ""),
                                            C6.w(S0, "spawnDistance", w.pY, 200),
                                            I0.length > 0 && (S0.joints = I0),
                                            z0.length > 0 && (S0.redSpawnPoints = z0),
                                            P0.length > 0 && (S0.blueSpawnPoints = P0),
                                            C6.w(S0, "kickOffReset", w.oj ? "full" : "partial", "partial"),
                                            w.qX || (S0.canBeStored = !1),
                                            S0
                                    }
                                },
                                vi: function (w) {
                                    return C6.pi(w)
                                },
                                si: function (w) {
                                    var C = C6.Oi(w, this.l.A.k);
                                    return C.UY(),
                                        C
                                },
                                kb: function (w) {
                                    var C = C6.kD(w);
                                    return C.UY(),
                                        C
                                },
                                ui: function (w) {
                                    return C6.J5(w)
                                },
                                yh: function (w) {
                                    return C6.li(w)
                                },
                                Yh: function (w) {
                                    return C6.Z5(w, new e9).gD()
                                },
                                jh: function (w) {
                                    return C6.xi(w, this.l.A.Z)
                                },
                                $b: function (w) {
                                    return C6.qD(w, this.l.A.Z)
                                },
                                qb: function (w) {
                                    this.l.A.k.push(this.vi(w))
                                },
                                Cb: function (w) {
                                    this.l.A.t.push(this.si(w))
                                },
                                Tb: function (w) {
                                    this.l.e.ty.push(this.ui(w))
                                },
                                Pb: function (w) {
                                    this.l.A.M.push(this.yh(w))
                                },
                                Ap: function (w) {
                                    var C = this.Yh(w)
                                        , G = this.l.A.Z.findIndex((z0) => z0.n != null);
                                    G < 0 && (G = this.l.A.Z.length),
                                        this.l.A.Z.splice(G, 0, C);
                                    for (var S = this.l.A._y, h = this.l.A.Z.length - 2; h >= G; h--)
                                        S.forEach((z0) => {
                                            z0.vy == h && z0.vy++,
                                                z0.ay == h && z0.ay++
                                        }
                                        )
                                },
                                cb: function (w) {
                                    this.l.A._y.push(this.jh(w))
                                },
                                ob: function (w) {
                                    var C;
                                    w.team == "red" ? C = this.l.e.jY : w.team == "blue" && (C = this.l.e.XY),
                                        C && C.push(new XY(w.x, w.y))
                                },
                                RR: function (w) {
                                    var { team: C, id: G, name: S, avatar: h, flag: z0 } = w
                                        , P0 = C == "spec" ? Q6.bY : C == "red" ? Q6.Ty : C == "blue" ? Q6.yY : null;
                                    if (P0) {
                                        var I0 = wY.j(G, S, z0, h, "fakeConn", "fakeAuth");
                                        I0.p = 0,
                                            I0.H(this),
                                            C != "spec" && ((I0 = C9.j(G, P0)).p = 0,
                                                I0.H(this),
                                                this.ER(this.G(G).U, w))
                                    }
                                },
                                b5: function (w) {
                                    var { v: C, s: G } = w
                                        , S = -1
                                        , h = -1;
                                    return this.l.A.k.forEach((z0, P0) => {
                                        z0 == C ? S = P0 : z0 == G && (h = P0)
                                    }
                                    ),
                                        [S, h]
                                },
                                Hb: function (w) {
                                    return this.b5(this.l.A.t[w])
                                },
                                tb: function (w, C) {
                                    var G = this.l.A.k[w];
                                    if (G) {
                                        var S = C6.pi(C);
                                        C.hasOwnProperty("x") && (G.h.x = S.h.x),
                                            C.hasOwnProperty("y") && (G.h.y = S.h.y),
                                            C.hasOwnProperty("bCoef") && (G.r = S.r),
                                            C.hasOwnProperty("cMask") && (G.z = S.z),
                                            C.hasOwnProperty("cGroup") && (G.i = S.i),
                                            this.l.A.t.forEach((h) => {
                                                (h.s == G || h.v == G) && h.UY()
                                            }
                                            )
                                    }
                                },
                                Wb: function (w, C) {
                                    var G = this.l.A.t[w];
                                    if (G) {
                                        var S = C6.Oi(C, this.l.A.k);
                                        (C.hasOwnProperty("v0") || C.hasOwnProperty("curve")) && (G.v = S.v),
                                            (C.hasOwnProperty("v1") || C.hasOwnProperty("curve")) && (G.s = S.s),
                                            (C.hasOwnProperty("bias") || C.hasOwnProperty("curve")) && (G.ny = S.ny),
                                            (C.hasOwnProperty("curveF") || C.hasOwnProperty("curve")) && (G.wy = S.wy),
                                            C.hasOwnProperty("vis") && (G.by = S.by),
                                            C.hasOwnProperty("color") && (G.b = S.b),
                                            C.hasOwnProperty("bCoef") && (G.r = S.r),
                                            C.hasOwnProperty("cMask") && (G.z = S.z),
                                            C.hasOwnProperty("cGroup") && (G.i = S.i),
                                            G.UY()
                                    }
                                },
                                wb: function (w, C) {
                                    var G = this.l.e.ty[w];
                                    if (G) {
                                        var S = C6.J5(C);
                                        C.hasOwnProperty("p0") && (G.iY = S.iY),
                                            C.hasOwnProperty("p1") && (G.rY = S.rY),
                                            C.hasOwnProperty("team") && (G.c = S.c)
                                    }
                                },
                                Ib: function (w, C) {
                                    var G = this.l.A.M[w];
                                    if (G) {
                                        var S = C6.li(C);
                                        C.hasOwnProperty("normal") && (G.qy = S.qy),
                                            C.hasOwnProperty("dist") && (G.xy = S.xy),
                                            C.hasOwnProperty("bCoef") && (G.r = S.r),
                                            C.hasOwnProperty("cMask") && (G.z = S.z),
                                            C.hasOwnProperty("cGroup") && (G.i = S.i)
                                    }
                                },
                                Eb: function (w, C) {
                                    this.ER(this.l.A.Z[w], C)
                                },
                                ER: function (w, C) {
                                    if (w) {
                                        var G = C6.Z5(C, new e9);
                                        C.hasOwnProperty("pos") && (w.h = G.h),
                                            C.hasOwnProperty("speed") && (w.P = G.P),
                                            C.hasOwnProperty("gravity") && (w.T = G.T),
                                            C.hasOwnProperty("radius") && (w.I = G.I),
                                            C.hasOwnProperty("invMass") && (w.F = G.F),
                                            C.hasOwnProperty("damping") && (w.N = G.N),
                                            C.hasOwnProperty("color") && (w.b = G.b),
                                            C.hasOwnProperty("bCoef") && (w.r = G.r),
                                            C.hasOwnProperty("cMask") && (w.z = G.z),
                                            C.hasOwnProperty("cGroup") && (w.i = G.i)
                                    }
                                },
                                mb: function (w, C) {
                                    var G = this.l.A._y[w];
                                    if (G) {
                                        var S = C6.xi(C, this.l.A.Z);
                                        C.hasOwnProperty("d0") && (G.vy = S.vy),
                                            C.hasOwnProperty("d1") && (G.ay = S.ay),
                                            C.hasOwnProperty("color") && (G.b = S.b),
                                            C.hasOwnProperty("strength") && (G.$Y = S.$Y),
                                            C.hasOwnProperty("length") && (G.Cy = S.Cy,
                                                G.dy = S.dy)
                                    }
                                },
                                Qb: function (w, C, G) {
                                    var S, h, z0;
                                    (C == "red" ? S = this.l.e.jY : C == "blue" && (S = this.l.e.XY),
                                        G.team == "red" ? h = this.l.e.jY : G.team == "blue" && (h = this.l.e.XY),
                                        S && h) && ((z0 = S == h ? S[w] : S.splice(w, 1)[0]) && (G.hasOwnProperty("x") && (z0.x = G.x),
                                            G.hasOwnProperty("y") && (z0.y = G.y),
                                            S != h && h.push(z0)))
                                },
                                Fb: function (w, C) {
                                    var G = this.G(w);
                                    if (G) {
                                        var S = null;
                                        if (C.hasOwnProperty("team") && (S = C.team == "spec" ? Q6.bY : C.team == "red" ? Q6.Ty : C.team == "blue" ? Q6.yY : null),
                                            C.hasOwnProperty("name") && (G.L = C.name),
                                            C.hasOwnProperty("flag") && (G.ky = C.flag),
                                            C.hasOwnProperty("avatar") && (G.Jy = C.avatar),
                                            S != null) {
                                            var h = C9.j(w, S);
                                            h.p = 0,
                                                h.H(this)
                                        }
                                        G.U != null && this.ER(G.U, C)
                                    }
                                },
                                Ub: function (w) {
                                    var C = this.l.A.k.splice(w, 1)[0];
                                    if (C) {
                                        var G = this.l.A.t
                                            , S = [];
                                        G.forEach((h, z0) => {
                                            (h.s == C || h.v == C) && S.unshift(z0)
                                        }
                                        ),
                                            S.forEach((h) => G.splice(h, 1))
                                    }
                                },
                                Mb: function (w) {
                                    this.l.A.t.splice(w, 1)
                                },
                                nb: function (w) {
                                    this.l.e.ty.splice(w, 1)
                                },
                                Nb: function (w) {
                                    this.l.A.M.splice(w, 1)
                                },
                                eO: function (w) {
                                    this.l.A.Z.splice(w, 1);
                                    var C = this.l.A._y
                                        , G = [];
                                    C.forEach((h, z0) => {
                                        (h.vy == w || h.ay == w) && G.unshift(z0)
                                    }
                                    ),
                                        G.forEach((h) => C.splice(h, 1));
                                    for (var S = w + 1; S <= this.l.A.Z.length; S++)
                                        C.forEach((h) => {
                                            h.vy == S && h.vy--,
                                                h.ay == S && h.ay--
                                        }
                                        )
                                },
                                Vb: function (w) {
                                    this.l.A._y.splice(w, 1)
                                },
                                Bb: function (w, C) {
                                    var G;
                                    C == "red" ? G = this.l.e.jY : C == "blue" && (G = this.l.e.XY),
                                        G && G.splice(w, 1)
                                },
                                Fx: function (w) {
                                    var C = L1.j(w, null, !0);
                                    C.p = 0,
                                        C.H(this)
                                },
                                Kb: function (w) {
                                    var C = this.l?.e.aY;
                                    if (C) {
                                        var G = C6.Z5(w, new e9);
                                        w.hasOwnProperty("radius") && (C.I = G.I),
                                            w.hasOwnProperty("gravity") && (C.T = G.T),
                                            w.hasOwnProperty("invMass") && (C.F = G.F),
                                            w.hasOwnProperty("bCoef") && (C.r = G.r),
                                            w.hasOwnProperty("cGroup") && (C.i = G.i),
                                            w.hasOwnProperty("damping") && (C.N = G.N),
                                            w.hasOwnProperty("kickingDamping") && (C.vj = P8(w.kickingDamping, Number)),
                                            w.hasOwnProperty("acceleration") && (C.aj = P8(w.acceleration, Number)),
                                            w.hasOwnProperty("kickingAcceleration") && (C.Gj = P8(w.kickingAcceleration, Number)),
                                            w.hasOwnProperty("kickStrength") && (C.Bj = P8(w.kickStrength, Number)),
                                            w.hasOwnProperty("kickback") && (C.Kj = P8(w.kickback, Number))
                                    }
                                },
                                Gb: function (w) {
                                    var C = this.l?.e;
                                    C && (w.hasOwnProperty("type") && (C.wY = P8(w.type, J6)),
                                        w.hasOwnProperty("width") && (C._j = P8(w.width, Number)),
                                        w.hasOwnProperty("height") && (C.gj = P8(w.height, Number)),
                                        w.hasOwnProperty("kickOffRadius") && (C.Aj = P8(w.kickOffRadius, Number)),
                                        w.hasOwnProperty("cornerRadius") && (C.Sj = P8(w.cornerRadius, Number)),
                                        w.hasOwnProperty("color") && (C.hj = P8(w.color, J6)),
                                        w.hasOwnProperty("goalLine") && (C.Hj = P8(w.goalLine, Number)))
                                },
                                ab: function (w) {
                                    var C = this.l?.e;
                                    C && (w.hasOwnProperty("name") && (C.L = P8(w.name, String)),
                                        w.hasOwnProperty("width") && (C.vY = P8(w.width, Number)),
                                        w.hasOwnProperty("height") && (C.ij = P8(w.height, Number)),
                                        w.hasOwnProperty("maxViewWidth") && (C.sj = P8(w.maxViewWidth, Number)),
                                        w.hasOwnProperty("cameraFollow") && (C.uj = P8(w.cameraFollow, J6)),
                                        w.hasOwnProperty("spawnDistance") && (C.pY = P8(w.spawnDistance, Number)),
                                        w.hasOwnProperty("kickOffReset") && (C.oj = P8(w.kickOffReset, Boolean)),
                                        w.hasOwnProperty("canBeStored") && (C.qX = P8(w.canBeStored, Boolean)))
                                }
                            }),
                            r(this.jp, [], ["isHost", null, null, null, "renderer", "libraries", "plugins", "config"], [null, null, null, null, "executeEvent", null, null, "clearEvents", "setKickRateLimit"]),
                            r(this.gX, [], [null, "ext", "id", "name", "ping", "flag", "sync", "conn", "auth", "identity", "team", "disc", "kickRateMinTickCounter", "kickRateMaxTickCounter", "isKicking", "input", null, "headlessAvatar", "avatar", "avatarNumber", "isAdmin", "customClient"], []),
                            r(this.Rj, [this], [null, "ext", "name", "players", null, "gameState", "stadium", "kickRate_min", "kickRate_rate", "kickRate_max", "timeLimit", "scoreLimit", "teamsLocked", "teamColors"], ["setPings", "forceLeaveRoom", "forceJoinRoom", "setPlayerIdentity", "getPlayer", "runSteps", null, null, null, null, null, null, null, "startGame", "stopGame", "setTeamsLock", "setTeamColors", "setStadium", "setPlayerTeam", "setPlayerSync", "setPlayerAdmin", "setKickRateLimit", "setHeadlessAvatar", "setScoreLimit", "setTimeLimit", "setDiscProperties", "setAvatar", "setPlayerInput", "setPlayerChatIndicator", "sendChat", "sendAnnouncement", "reorderPlayers", "setGamePaused", "applyCustomEvent", "applyBinaryCustomEvent", "applyAutoTeams", null, null, "exportStadium", "createVertex", "createSegment", "createSegmentFromObj", "createGoal", "createPlane", "createDisc", "createJoint", "createJointFromObj", "addVertex", "addSegment", "addGoal", "addPlane", "addDisc", "addJoint", "addSpawnPoint", "addPlayer", "findVertexIndicesOfSegmentObj", "findVertexIndicesOfSegment", "updateVertex", "updateSegment", "updateGoal", "updatePlane", "updateDisc", "updateDiscObj", "updateJoint", "updateSpawnPoint", "updatePlayer", "removeVertex", "removeSegment", "removeGoal", "removePlane", "removeDisc", "removeJoint", "removeSpawnPoint", "removePlayer", "updateStadiumPlayerPhysics", "updateStadiumBg", "updateStadiumGeneral"]);
                        var { O_: N3, R_: w3, x_: fT, z_: hT, l_: xT, r_: gT, i_: mT } = dI(this, {
                            Ip: function (w) {
                                if (w.ry() != 1212305970)
                                    throw "";
                                var C = w.ry();
                                if (C != 3)
                                    throw l0(j0.lr, C)
                            },
                            mp: function (w) {
                                w.EO("HBR2"),
                                    w.ey(3)
                            },
                            Ry: {
                                Q: function () {
                                    this.hp = [],
                                        this.NY = 3
                                },
                                Ep: function (w, C) {
                                    var G = w.By();
                                    if (C)
                                        for (var S = 0, h = 0; h < G; h++)
                                            S += w.Ey(),
                                                C.hp.push({
                                                    frameNo: S,
                                                    teamId: w.q()
                                                });
                                    else
                                        for (h = 0; h < G; h++)
                                            w.Ey(),
                                                w.q()
                                },
                                dx: function (w, C) {
                                    w.My(C.hp.length);
                                    var G = 0;
                                    C.hp.forEach((S) => {
                                        w.oy(S.frameNo - G),
                                            w.g(S.teamId),
                                            G = S.frameNo
                                    }
                                    )
                                },
                                ex: function (w, C) {
                                    this.hp = this.hp.filter((G) => G.frameNo >= w && G.frameNo <= C),
                                        this.hp.forEach((G) => {
                                            G.frameNo -= w
                                        }
                                        )
                                }
                            },
                            X_: {
                                Q: function () {
                                    this.ph = 0,
                                        this.rX.My(0);
                                    var w = this.R.f
                                        , C = this;
                                    this.R.O.Xh((G) => {
                                        var S = C.R.f;
                                        C.rX.oy(S - w),
                                            C.rX.g(G),
                                            C.ph++,
                                            w = S
                                    }
                                    )
                                },
                                lX: function () {
                                    this.R.O.Xh(null),
                                        this.rX.$.setUint16(0, this.ph, this.rX.Iy)
                                }
                            },
                            p_: {
                                Fj: X3,
                                $j: U3
                            }
                        });
                        r(N3, [], ["roomData", "events", "totalFrames", "goalMarkers", "version"], []);
                        var { Eg: cT, mg: dT } = pI(this, {
                            Q: function (w, C, G) {
                                w.Ig = G?.filterEvents;
                                var S = null;
                                Object.assign(this, {
                                    startRecording: function () {
                                        return S == null && (S = new w3(w),
                                            G.onRoomRecordingChange?.(!0),
                                            !0)
                                    },
                                    stopRecording: function () {
                                        if (S == null)
                                            return null;
                                        var h = S.lX();
                                        return S = null,
                                            G.onRoomRecordingChange?.(h),
                                            h
                                    },
                                    isRecording: function () {
                                        return S != null
                                    },
                                    playerJoin: function (h, z0, P0, I0, S0, q8) {
                                        var b8 = wY.j(h, z0, P0, I0, S0, q8);
                                        b8.p = 0,
                                            w.a(b8)
                                    },
                                    playerLeave: function (h) {
                                        if (w.O.G(h)) {
                                            var z0 = L1.j(h, null, !0);
                                            z0.p = 0,
                                                w.a(z0)
                                        }
                                    },
                                    playerInput: function (h, z0) {
                                        var P0 = UY.j(h);
                                        P0.p = z0,
                                            w.a(P0)
                                    },
                                    playerChat: function (h, z0) {
                                        var P0 = NY.j(h);
                                        P0.p = z0,
                                            w.a(P0)
                                    },
                                    setKeyState: function (h) {
                                        this.playerInput(h, C?.controlledPlayerId || 0)
                                    },
                                    setPlayerChatIndicator: function (h, z0) {
                                        var P0 = I1.j(h);
                                        P0.p = z0,
                                            w.a(P0)
                                    },
                                    setPlayerAvatar: function (h, z0, P0) {
                                        var I0;
                                        h ? (I0 = Z3.j(P0, z0)).p = 0 : (I0 = BY.j(z0)).p = P0,
                                            w.a(I0)
                                    },
                                    setCurrentStadium: function (h, z0) {
                                        var P0 = jY.j(h);
                                        P0.p = z0,
                                            w.a(P0)
                                    },
                                    sendAnnouncement: function (h, z0 = -1, P0 = 0, I0 = 1, S0, q8) {
                                        var b8 = J3.j(h, z0, P0, I0);
                                        b8.p = q8,
                                            w.a(b8)
                                    },
                                    startGame: function (h) {
                                        var z0 = nI.j();
                                        z0.p = h,
                                            w.a(z0)
                                    },
                                    stopGame: function (h) {
                                        var z0 = sI.j();
                                        z0.p = h,
                                            w.a(z0)
                                    },
                                    setGamePaused: function (h, z0) {
                                        var P0 = iI.j(h);
                                        P0.p = z0,
                                            w.a(P0)
                                    },
                                    setScoreLimit: function (h, z0) {
                                        var P0 = F1.j(0, h);
                                        P0.p = z0,
                                            w.a(P0)
                                    },
                                    setTimeLimit: function (h, z0) {
                                        var P0 = F1.j(1, h);
                                        P0.p = z0,
                                            w.a(P0)
                                    },
                                    setTeamsLock: function (h, z0) {
                                        var P0 = aI.j(h);
                                        P0.p = z0,
                                            w.a(P0)
                                    },
                                    autoTeams: function (h) {
                                        var z0 = tI.j();
                                        z0.p = h,
                                            w.a(z0)
                                    },
                                    setPlayerTeam: function (h, z0, P0) {
                                        var I0 = Q6.p[z0];
                                        if (I0) {
                                            var S0 = C9.j(h, I0);
                                            S0.p = P0,
                                                w.a(S0)
                                        }
                                    },
                                    setKickRateLimit: function (h, z0, P0, I0) {
                                        var S0 = QL.j(h, z0, P0);
                                        S0.p = I0,
                                            w.a(S0)
                                    },
                                    setTeamColors: function (h, z0, P0, I0) {
                                        var S0 = Q6.p[h];
                                        if (!S0)
                                            throw l0(j0.CR);
                                        var q8 = JL.j(S0, dQ.Pj(S0, z0, ...P0));
                                        q8.p = I0,
                                            w.a(q8)
                                    },
                                    setPlayerAdmin: function (h, z0, P0) {
                                        var I0 = rI.j(h, z0);
                                        I0.p = P0,
                                            w.a(I0)
                                    },
                                    kickPlayer: function (h, z0, P0, I0) {
                                        var S0 = L1.j(h, z0, P0);
                                        S0.p = I0,
                                            w.a(S0)
                                    },
                                    setPlayerSync: function (h, z0) {
                                        var P0 = eI.j(h);
                                        P0.p = z0,
                                            w.a(P0)
                                    },
                                    sendPingData: function (h, z0) {
                                        var P0 = new bT;
                                        P0.Lj = w.O.o.map(h),
                                            P0.p = z0,
                                            w.a(P0)
                                    },
                                    setDiscProperties: function (h, z0, P0, I0) {
                                        var S0 = ZL.Pj(h, z0, P0);
                                        S0.p = I0,
                                            w.a(S0)
                                    },
                                    sendCustomEvent: function (h, z0, P0) {
                                        var I0 = $L.j(h, z0);
                                        I0.p = P0,
                                            w.a(I0)
                                    },
                                    sendBinaryCustomEvent: function (h, z0, P0) {
                                        var I0 = qL.j(h, z0);
                                        I0.p = P0,
                                            w.a(I0)
                                    },
                                    setPlayerIdentity: function (h, z0, P0) {
                                        var I0 = KL.j(h, z0);
                                        I0.p = P0,
                                            w.a(I0)
                                    },
                                    reorderPlayers: function (h, z0, P0) {
                                        var I0 = Q3.j(h, z0);
                                        I0.p = P0,
                                            w.a(I0)
                                    }
                                })
                            },
                            Fj: X3,
                            $j: U3
                        });
                        this.bL = {
                            AddonType: {
                                RoomConfig: j0.al,
                                Plugin: j0.vl,
                                Renderer: j0.sl,
                                Library: j0.ul
                            },
                            AllowFlags: {
                                JoinRoom: j0.IA,
                                CreateRoom: j0.EA
                            },
                            BackgroundType: {
                                None: j0.mA,
                                Grass: j0.QA,
                                Hockey: j0.FA
                            },
                            CameraFollow: {
                                None: j0.UA,
                                Player: j0.MA
                            },
                            CollisionFlags: {
                                ball: j0.nA,
                                red: j0.NA,
                                blue: j0.VA,
                                redKO: j0.BA,
                                blueKO: j0.KA,
                                wall: j0.GA,
                                kick: j0.aA,
                                score: j0.vA,
                                free1: j0.sA,
                                free2: j0.uA,
                                free3: j0.yS,
                                free4: j0.YS,
                                free5: j0.jS,
                                free6: j0.XS,
                                free7: j0.pS,
                                free8: j0.OS,
                                free9: j0.RS,
                                free10: j0.xS,
                                free11: j0.zS,
                                free12: j0.lS,
                                free13: j0.rS,
                                free14: j0.iS,
                                free15: j0.hS,
                                free16: j0._S,
                                free17: j0.gS,
                                free18: j0.AS,
                                free19: j0.SS,
                                free20: j0.DS,
                                c0: j0.bS,
                                c1: j0.JS,
                                c2: j0.ZS,
                                c3: j0.fS
                            },
                            Direction: {
                                Backward: j0.LS,
                                Still: j0.dS,
                                Forward: j0.eS
                            },
                            GamePlayState: {
                                BeforeKickOff: j0.kS,
                                Playing: j0.$S,
                                AfterGoal: j0.qS,
                                Ending: j0.CS
                            },
                            OperationType: {
                                SendAnnouncement: j0.fr,
                                SendChatIndicator: j0.Lr,
                                CheckConsistency: j0.dr,
                                SendInput: j0.er,
                                SendChat: j0.kr,
                                JoinRoom: j0.$r,
                                KickBanPlayer: j0.qr,
                                StartGame: j0.Cr,
                                StopGame: j0.Tr,
                                PauseResumeGame: j0.Pr,
                                SetGamePlayLimit: j0.cr,
                                SetStadium: j0.or,
                                SetPlayerTeam: j0.Hr,
                                SetTeamsLock: j0.tr,
                                SetPlayerAdmin: j0.Wr,
                                AutoTeams: j0.wr,
                                SetPlayerSync: j0.Ir,
                                Ping: j0.Er,
                                SetAvatar: j0.mr,
                                SetTeamColors: j0.Qr,
                                ReorderPlayers: j0.Fr,
                                SetKickRateLimit: j0.Ur,
                                SetHeadlessAvatar: j0.Mr,
                                SetDiscProperties: j0.nr,
                                CustomEvent: j0.Nr,
                                BinaryCustomEvent: j0.Vr,
                                SetPlayerIdentity: j0.Br
                            },
                            PlayerPositionInGame: {
                                None: j0.TS,
                                GK: j0.PS,
                                SW: j0.cS,
                                WBL: j0.oS,
                                DL: j0.HS,
                                DC: j0.tS,
                                DR: j0.WS,
                                WBR: j0.wS,
                                DML: j0.IS,
                                DMC: j0.ES,
                                DMR: j0.mS,
                                ML: j0.QS,
                                MC: j0.FS,
                                MR: j0.US,
                                AML: j0.MS,
                                AMC: j0.nS,
                                AMR: j0.NS,
                                FL: j0.VS,
                                FC: j0.BS,
                                FR: j0.KS,
                                ST: j0.GS
                            },
                            VariableType: {
                                Void: j0.aS,
                                Boolean: j0.Kr,
                                Integer: j0.vS,
                                Number: j0.sS,
                                String: j0.uS,
                                Color: j0.yD,
                                CollisionFlags: j0.YD,
                                Coordinate: j0.jD,
                                Team: j0.XD,
                                TeamWithSpec: j0.pD,
                                BgType: j0.OD,
                                CameraFollow: j0.RD,
                                KickOffReset: j0.xD,
                                Flag: j0.zD,
                                File: j0.lD,
                                PlayerId: j0.rD,
                                Keys: j0.iD,
                                Progress: j0.hD,
                                PlayerPositionInGame: j0._D
                            },
                            Callback: {
                                add: TT,
                                remove: yT
                            },
                            Utils: {
                                numberToColor: PT,
                                colorToNumber: DT,
                                getDefaultStadiums: AT,
                                parseStadium: ET,
                                exportStadium: MT,
                                keyState: _T,
                                reverseKeyState: RT
                            },
                            EventFactory: CT,
                            Room: {
                                create: this.jp.j,
                                join: this.jp.wg,
                                sandbox: dT,
                                streamWatcher: uI(this, cT)
                            },
                            Replay: {
                                ReplayData: N3,
                                read: fT,
                                readAll: hT,
                                writeAll: xT,
                                trim: gT,
                                trimAsync: mT
                            },
                            Query: {
                                getVertexIndexAtMapCoord: $3,
                                getSegmentIndexAtMapCoord: q3,
                                getGoalIndexAtMapCoord: K3,
                                getPlaneIndexAtMapCoord: V3,
                                getJointIndexAtMapCoord: z3,
                                getDiscIndexAtMapCoord: W3,
                                getSpawnPointIndexAtMapCoord: vT,
                                getVertexAtMapCoord: (w, C, G) => w.l?.A.k[$3(w, C, G)],
                                getSegmentAtMapCoord: (w, C, G) => w.l?.A.t[q3(w, C, G)],
                                getGoalAtMapCoord: (w, C, G) => w.e.ty[K3(w, C, G)],
                                getPlaneAtMapCoord: (w, C, G) => w.l?.A.M[V3(w, C, G)],
                                getJointAtMapCoord: (w, C, G) => w.l?.A._y[z3(w, C, G)],
                                getDiscAtMapCoord: (w, C) => w.l?.A.Z[W3(w, C)]
                            },
                            Library: OT,
                            RoomConfig: IT,
                            Plugin: LT,
                            Renderer: FT,
                            Language: JQ,
                            Impl: {
                                Core: {
                                    Point: XY,
                                    TeamColors: dQ,
                                    Team: Q6
                                },
                                Stadium: {
                                    Vertex: lI,
                                    Segment: X8,
                                    Plane: g8,
                                    Goal: v7,
                                    Disc: e9,
                                    Joint: oI,
                                    Stadium: C6
                                }
                            },
                            Errors: {
                                ErrorCodes: {
                                    StadiumParseError: j0.yr,
                                    StadiumParseSyntaxError: j0.Yr,
                                    StadiumParseUnknownError: j0.jr,
                                    TeamColorsReadError: j0.Xr,
                                    BadColorError: j0.pr,
                                    BadTeamError: j0.Or,
                                    StadiumLimitsExceededError: j0.Rr,
                                    AnnouncementActionMessageTooLongError: j0.xr,
                                    ChatActionMessageTooLongError: j0.zr,
                                    ChangeTeamColorsInvalidTeamIdError: j0.CR,
                                    ReplayFileVersionMismatchError: j0.lr,
                                    PlayerNameTooLongError: j0.rr,
                                    PlayerCountryTooLongError: j0.ir,
                                    PlayerAvatarTooLongError: j0.hr,
                                    PlayerJoinBlockedByMPDError: j0._r,
                                    PlayerJoinBlockedByORError: j0.gr,
                                    PluginNotFoundError: j0.Ar,
                                    PluginNameChangeNotAllowedError: j0.Sr,
                                    LibraryNotFoundError: j0.Dr,
                                    LibraryNameChangeNotAllowedError: j0.br,
                                    NoProxyIdentityProblem: j0.Jr,
                                    NoProxyIdentitySolution: j0.Zr
                                }
                            }
                        }
                    };
                z.bL = GT
            }
            )
            , K = Q((V, z) => {
                function W(L) {
                    return function (F) {
                        return !!F && typeof F == "object"
                    }(L) && !function (F) {
                        var P = Object.prototype.toString.call(F);
                        return P === "[object RegExp]" || P === "[object Date]"
                    }(L)
                }
                function H(L, F) {
                    return F.Mp !== !1 && F.mR(L) ? k(function (P) {
                        return Array.isArray(P) ? [] : {}
                    }(L), L, F) : L
                }
                function Y(L, F, P) {
                    return L.concat(F).map(function (M) {
                        return H(M, P)
                    })
                }
                function U(L) {
                    return Object.keys(L).concat(function (F) {
                        return Object.getOwnPropertySymbols ? Object.getOwnPropertySymbols(F).filter((P) => Object.propertyIsEnumerable.call(F, P)) : []
                    }(L))
                }
                function N(L, F) {
                    try {
                        return F in L
                    } catch {
                        return !1
                    }
                }
                function j(L, F, P) {
                    var M = {};
                    return P.mR(L) && U(L).forEach((v) => {
                        M[v] = H(L[v], P)
                    }
                    ),
                        U(F).forEach((v) => {
                            (function (E, n) {
                                return N(E, n) && !(Object.hasOwnProperty.call(E, n) && Object.propertyIsEnumerable.call(E, n))
                            }
                            )(L, v) || (M[v] = N(L, v) && P.mR(F[v]) ? function (E, n) {
                                if (!n.vb)
                                    return k;
                                var u = n.vb(E);
                                return typeof u == "function" ? u : k
                            }(v, P)(L[v], F[v], P) : H(F[v], P))
                        }
                        ),
                        M
                }
                function k(L, F, P) {
                    (P = P || {}).Oh = P.Oh || Y,
                        P.mR = P.mR || W,
                        P.A9 = H;
                    var M = Array.isArray(F);
                    return !M === Array.isArray(L) ? H(F, P) : M ? P.Oh(L, F, P) : j(L, F, P)
                }
                J = {
                    pz: Z(),
                    sb: k,
                    E: (L, F, P, M) => {
                        var v = new L(...F)
                            , E = Object.keys(v)
                            , n = Object.keys(L.prototype)
                            , u = E.concat(n);
                        P.forEach((b, i) => {
                            if (b && !u.includes(b)) {
                                var g = E[i];
                                g && (u.push(b),
                                    Object.defineProperty(L.prototype, b, {
                                        get: function () {
                                            return this[g]
                                        },
                                        set: function (l) {
                                            this[g] = l
                                        }
                                    }))
                            }
                        }
                        ),
                            M.forEach((b, i) => {
                                if (b && !u.includes(b)) {
                                    var g = n[i];
                                    g && (u.push(b),
                                        L.prototype[b] = L.prototype[g])
                                }
                            }
                            )
                    }
                },
                    z.bL = (L, F) => {
                        var P = $()(L, F)
                            , M = P.Y;
                        return M.K = P,
                            F?.noVariableValueChangeEvent != null && (M.JO = F.noVariableValueChangeEvent),
                            M.ub = q(),
                            M
                    }
            }
            );
        return Q((V, z) => {
            var W = K();
            z.bL = (H, Y) => {
                var U = W(H, Y)
                    , { Oy: { zO: { lO: N, $R: j } }, Fg: k, ng: L, qR: { vg: F, sg: P, Ax: M, ug: v, KO: E, GO: n, rx: u, ix: b, aO: i, hx: g, Sx: l, tp: o, op: F0, BO: b0, nO: d0, NO: H8, VO: E0, yA: v0, YA: G6 }, kX: { ep: I8, XA: x0 } } = U.K
                    , U8 = new U.ub(U);
                return J.sb({
                    version: "1.0.0",
                    BanEntryType: {
                        Player: k.gX,
                        IP: k.Ug,
                        Auth: k.Mg
                    },
                    ConnectionState: {
                        TryingReverseConnection: L.Ng,
                        ConnectingToMaster: L.Vg,
                        ConnectingToPeer: L.Bg,
                        AwaitingState: L.Kg,
                        Active: L.Gg,
                        ConnectionFailed: L.ag
                    },
                    Utils: {
                        generateAuth: F,
                        authFromKey: P,
                        getRoomList: M,
                        calculateAllRoomDistances: v,
                        ipToNumber: E,
                        numberToIp: n,
                        authToNumber: u,
                        numberToAuth: b,
                        compareBits: i,
                        runAfterGameTick: g,
                        getGeo: l,
                        parseGeo: o,
                        numberToHexString: F0,
                        parseHexInt: b0,
                        promiseWithTimeout: d0,
                        hexStrToNumber: H8,
                        byteArrayToIp: E0,
                        refreshRoomToken: v0,
                        generateRoomId: G6
                    },
                    Errors: {
                        HBError: I8,
                        ErrorCodes: {
                            Empty: x0.pA,
                            ConnectionClosed: x0.OA,
                            GameStateTimeout: x0.RA,
                            RoomClosed: x0.xA,
                            RoomFull: x0.zA,
                            WrongPassword: x0.lA,
                            BannedBefore: x0.rA,
                            IncompatibleVersion: x0.iA,
                            FailedHost: x0.hA,
                            Unknown: x0._A,
                            Cancelled: x0.gA,
                            KickedNow: x0.AA,
                            MasterConnectionError: x0.SA,
                            ObjectCastError: x0.DA,
                            UTF8CharacterDecodeError: x0.bA,
                            ReadTooMuchError: x0.JA,
                            ReadWrongStringLengthError: x0.ZA,
                            EncodeUTF8CharNegativeError: x0.fA,
                            EncodeUTF8CharTooLargeError: x0.LA,
                            CalculateLengthOfUTF8CharNegativeError: x0.dA,
                            CalculateLengthOfUTF8CharTooLargeError: x0.eA,
                            BufferResizeParameterTooSmallError: x0.kA,
                            MissingActionConfigError: x0.$A,
                            UnregisteredActionError: x0.CA,
                            MissingImplementationError: x0.TA,
                            KickBanReasonTooLongError: x0.PA,
                            MissingRecaptchaCallbackError: x0.cA,
                            ReplayFileReadError: x0.qA,
                            JoinRoomNullIdAuthError: x0.oA,
                            AuthFromKeyInvalidIdFormatError: x0.HA,
                            BadActorError: x0.tA,
                            AuthBannedError: x0.WA,
                            FailedToCreateRoom: x0.wA
                        }
                    },
                    Impl: {
                        Stream: {
                            Reader: j,
                            Writer: N
                        }
                    }
                }, U8.bL)
            }
        }
        )()
    }
    )();
    typeof xY != "undefined" ? (typeof gY != "undefined" && gY.exports && (xY = gY.exports = hY),
        xY.API = hY) : typeof root != "undefined" ? root.API = hY : global.API = hY
}
);
var BE = G5((al, jE) => {
    jE.exports = function (J) {
        let { Language: Q, Errors: { ErrorCodes: Z } } = J;
        Object.setPrototypeOf(this, Q.prototype),
            Q.call(this, "GB", {
                name: "English",
                version: "0.1",
                author: "abc",
                description: "Default language"
            }),
            this.api = {
                errors: {
                    [Z.Empty]: "",
                    [Z.ConnectionClosed]: 'Connection closed$1?(" $1":"")',
                    [Z.GameStateTimeout]: "Game state timeout",
                    [Z.RoomClosed]: "The room was closed.",
                    [Z.RoomFull]: "The room is full.",
                    [Z.WrongPassword]: "Wrong password.",
                    [Z.BannedBefore]: "You are banned from this room.",
                    [Z.IncompatibleVersion]: "Incompatible game version.",
                    [Z.FailedHost]: "Failed to connect to room host.",
                    [Z.Unknown]: "An error ocurred while attempting to join the room.",
                    [Z.Cancelled]: "Cancelled",
                    [Z.FailedPeer]: "Failed to connect to peer.",
                    [Z.KickedNow]: 'You were $2?("banned":"kicked")$3?(" by $3":"")$1?(" ($1)":"")',
                    [Z.Failed]: "Failed",
                    [Z.MasterConnectionError]: "Master connection error",
                    [Z.StadiumParseError]: 'Error in "$1" index: $2',
                    [Z.StadiumParseSyntaxError]: "SyntaxError in line: $1",
                    [Z.StadiumParseUnknownError]: "Error loading stadium file.",
                    [Z.ObjectCastError]: "Cannot cast $1 to $2",
                    [Z.TeamColorsReadError]: "Too many",
                    [Z.UTF8CharacterDecodeError]: "Cannot decode UTF8 character at offset $1: charCode ($2) is invalid",
                    [Z.ReadTooMuchError]: "Read too much",
                    [Z.ReadWrongStringLengthError]: "Actual string length differs from the specified: $1 bytes",
                    [Z.EncodeUTF8CharNegativeError]: "Cannot encode UTF8 character: charCode ($1) is negative",
                    [Z.EncodeUTF8CharTooLargeError]: "Cannot encode UTF8 character: charCode ($1) is too large (>= 0x80000000)",
                    [Z.CalculateLengthOfUTF8CharNegativeError]: "Cannot calculate length of UTF8 character: charCode ($1) is negative",
                    [Z.CalculateLengthOfUTF8CharTooLargeError]: "Cannot calculate length of UTF8 character: charCode ($1) is too large (>= 0x80000000)",
                    [Z.BufferResizeParameterTooSmallError]: "Can't resize buffer to a capacity lower than 1",
                    [Z.BadColorError]: "Bad color",
                    [Z.BadTeamError]: "Bad team value",
                    [Z.StadiumLimitsExceededError]: "Error",
                    [Z.MissingActionConfigError]: "Class doesn't have a config",
                    [Z.UnregisteredActionError]: "Tried to pack unregistered action",
                    [Z.MissingImplementationError]: "Missing implementation",
                    [Z.AnnouncementActionMessageTooLongError]: "Message too long",
                    [Z.ChatActionMessageTooLongError]: "Message too long",
                    [Z.KickBanReasonTooLongError]: "String too long",
                    [Z.ChangeTeamColorsInvalidTeamIdError]: "Invalid team id",
                    [Z.MissingRecaptchaCallbackError]: "Recaptcha requested. Set a working recaptcha token while creating/joining a room.",
                    [Z.ReplayFileVersionMismatchError]: "The replay data is of a different version",
                    [Z.ReplayFileReadError]: "Couldn't load replay data.",
                    [Z.JoinRoomNullIdAuthError]: "Id and authObj cannot be null. (inside 1st parameter)",
                    [Z.PlayerNameTooLongError]: "Name too long",
                    [Z.PlayerCountryTooLongError]: "Country too long",
                    [Z.PlayerAvatarTooLongError]: "Avatar too long",
                    [Z.PlayerJoinBlockedByMPDError]: "Player join not allowed: $3 $4 $5 $1 $2",
                    [Z.PlayerJoinBlockedByORError]: "Player join event blocked by OperationReceived: $1",
                    [Z.AuthFromKeyInvalidIdFormatError]: "Invalid id format",
                    [Z.BadActorError]: "Bad Actor",
                    [Z.AuthBannedError]: "Auth banned: $1",
                    [Z.FailedToCreateRoom]: "An error ocurred while attempting to create the room. ($1)"
                }
            }
    }
}
);
var R, JF = (J) => {
    if (typeof J === "function" || typeof J === "object" && J.extension) {
        if (!J.extension)
            throw new Error("Extension class must have an extension object");
        J = {
            ...typeof J.extension !== "object" ? {
                type: J.extension
            } : J.extension,
            ref: J
        }
    }
    if (typeof J === "object")
        J = {
            ...J
        };
    else
        throw new Error("Invalid extension type");
    if (typeof J.type === "string")
        J.type = [J.type];
    return J
}
    , y1 = (J, Q) => JF(J).priority ?? Q, e0;
var w0 = O(() => {
    R = ((J) => {
        return J.Application = "application",
            J.WebGLPipes = "webgl-pipes",
            J.WebGLPipesAdaptor = "webgl-pipes-adaptor",
            J.WebGLSystem = "webgl-system",
            J.WebGPUPipes = "webgpu-pipes",
            J.WebGPUPipesAdaptor = "webgpu-pipes-adaptor",
            J.WebGPUSystem = "webgpu-system",
            J.CanvasSystem = "canvas-system",
            J.CanvasPipesAdaptor = "canvas-pipes-adaptor",
            J.CanvasPipes = "canvas-pipes",
            J.Asset = "asset",
            J.LoadParser = "load-parser",
            J.ResolveParser = "resolve-parser",
            J.CacheParser = "cache-parser",
            J.DetectionParser = "detection-parser",
            J.MaskEffect = "mask-effect",
            J.BlendMode = "blend-mode",
            J.TextureSource = "texture-source",
            J.Environment = "environment",
            J.ShapeBuilder = "shape-builder",
            J.Batcher = "batcher",
            J
    }
    )(R || {}),
        e0 = {
            _addHandlers: {},
            _removeHandlers: {},
            _queue: {},
            remove(...J) {
                return J.map(JF).forEach((Q) => {
                    Q.type.forEach((Z) => this._removeHandlers[Z]?.(Q))
                }
                ),
                    this
            },
            add(...J) {
                return J.map(JF).forEach((Q) => {
                    Q.type.forEach((Z) => {
                        let $ = this._addHandlers
                            , q = this._queue;
                        if (!$[Z])
                            q[Z] = q[Z] || [],
                                q[Z]?.push(Q);
                        else
                            $[Z]?.(Q)
                    }
                    )
                }
                ),
                    this
            },
            handle(J, Q, Z) {
                let $ = this._addHandlers
                    , q = this._removeHandlers;
                if ($[J] || q[J])
                    throw new Error(`Extension type ${J} already has a handler`);
                $[J] = Q,
                    q[J] = Z;
                let K = this._queue;
                if (K[J])
                    K[J]?.forEach((V) => Q(V)),
                        delete K[J];
                return this
            },
            handleByMap(J, Q) {
                return this.handle(J, (Z) => {
                    if (Z.name)
                        Q[Z.name] = Z.ref
                }
                    , (Z) => {
                        if (Z.name)
                            delete Q[Z.name]
                    }
                )
            },
            handleByNamedList(J, Q, Z = -1) {
                return this.handle(J, ($) => {
                    if (Q.findIndex((K) => K.name === $.name) >= 0)
                        return;
                    Q.push({
                        name: $.name,
                        value: $.ref
                    }),
                        Q.sort((K, V) => y1(V.value, Z) - y1(K.value, Z))
                }
                    , ($) => {
                        let q = Q.findIndex((K) => K.name === $.name);
                        if (q !== -1)
                            Q.splice(q, 1)
                    }
                )
            },
            handleByList(J, Q, Z = -1) {
                return this.handle(J, ($) => {
                    if (Q.includes($.ref))
                        return;
                    Q.push($.ref),
                        Q.sort((q, K) => y1(K, Z) - y1(q, Z))
                }
                    , ($) => {
                        let q = Q.indexOf($.ref);
                        if (q !== -1)
                            Q.splice(q, 1)
                    }
                )
            },
            mixin(J, ...Q) {
                for (let Z of Q)
                    Object.defineProperties(J.prototype, Object.getOwnPropertyDescriptors(Z))
            }
        }
}
);
var PE = G5((Wo, QF) => {
    var Jx = Object.prototype.hasOwnProperty
        , mJ = "~";
    function HV() { }
    if (Object.create) {
        if (HV.prototype = Object.create(null),
            !new HV().__proto__)
            mJ = !1
    }
    function Qx(J, Q, Z) {
        this.fn = J,
            this.context = Q,
            this.once = Z || !1
    }
    function GE(J, Q, Z, $, q) {
        if (typeof Z !== "function")
            throw new TypeError("The listener must be a function");
        var K = new Qx(Z, $ || J, q)
            , V = mJ ? mJ + Q : Q;
        if (!J._events[V])
            J._events[V] = K,
                J._eventsCount++;
        else if (!J._events[V].fn)
            J._events[V].push(K);
        else
            J._events[V] = [J._events[V], K];
        return J
    }
    function mY(J, Q) {
        if (--J._eventsCount === 0)
            J._events = new HV;
        else
            delete J._events[Q]
    }
    function PJ() {
        this._events = new HV,
            this._eventsCount = 0
    }
    PJ.prototype.eventNames = function J() {
        var Q = [], Z, $;
        if (this._eventsCount === 0)
            return Q;
        for ($ in Z = this._events)
            if (Jx.call(Z, $))
                Q.push(mJ ? $.slice(1) : $);
        if (Object.getOwnPropertySymbols)
            return Q.concat(Object.getOwnPropertySymbols(Z));
        return Q
    }
        ;
    PJ.prototype.listeners = function J(Q) {
        var Z = mJ ? mJ + Q : Q
            , $ = this._events[Z];
        if (!$)
            return [];
        if ($.fn)
            return [$.fn];
        for (var q = 0, K = $.length, V = new Array(K); q < K; q++)
            V[q] = $[q].fn;
        return V
    }
        ;
    PJ.prototype.listenerCount = function J(Q) {
        var Z = mJ ? mJ + Q : Q
            , $ = this._events[Z];
        if (!$)
            return 0;
        if ($.fn)
            return 1;
        return $.length
    }
        ;
    PJ.prototype.emit = function J(Q, Z, $, q, K, V) {
        var z = mJ ? mJ + Q : Q;
        if (!this._events[z])
            return !1;
        var W = this._events[z], H = arguments.length, Y, U;
        if (W.fn) {
            if (W.once)
                this.removeListener(Q, W.fn, void 0, !0);
            switch (H) {
                case 1:
                    return W.fn.call(W.context),
                        !0;
                case 2:
                    return W.fn.call(W.context, Z),
                        !0;
                case 3:
                    return W.fn.call(W.context, Z, $),
                        !0;
                case 4:
                    return W.fn.call(W.context, Z, $, q),
                        !0;
                case 5:
                    return W.fn.call(W.context, Z, $, q, K),
                        !0;
                case 6:
                    return W.fn.call(W.context, Z, $, q, K, V),
                        !0
            }
            for (U = 1,
                Y = new Array(H - 1); U < H; U++)
                Y[U - 1] = arguments[U];
            W.fn.apply(W.context, Y)
        } else {
            var N = W.length, j;
            for (U = 0; U < N; U++) {
                if (W[U].once)
                    this.removeListener(Q, W[U].fn, void 0, !0);
                switch (H) {
                    case 1:
                        W[U].fn.call(W[U].context);
                        break;
                    case 2:
                        W[U].fn.call(W[U].context, Z);
                        break;
                    case 3:
                        W[U].fn.call(W[U].context, Z, $);
                        break;
                    case 4:
                        W[U].fn.call(W[U].context, Z, $, q);
                        break;
                    default:
                        if (!Y)
                            for (j = 1,
                                Y = new Array(H - 1); j < H; j++)
                                Y[j - 1] = arguments[j];
                        W[U].fn.apply(W[U].context, Y)
                }
            }
        }
        return !0
    }
        ;
    PJ.prototype.on = function J(Q, Z, $) {
        return GE(this, Q, Z, $, !1)
    }
        ;
    PJ.prototype.once = function J(Q, Z, $) {
        return GE(this, Q, Z, $, !0)
    }
        ;
    PJ.prototype.removeListener = function J(Q, Z, $, q) {
        var K = mJ ? mJ + Q : Q;
        if (!this._events[K])
            return this;
        if (!Z)
            return mY(this, K),
                this;
        var V = this._events[K];
        if (V.fn) {
            if (V.fn === Z && (!q || V.once) && (!$ || V.context === $))
                mY(this, K)
        } else {
            for (var z = 0, W = [], H = V.length; z < H; z++)
                if (V[z].fn !== Z || q && !V[z].once || $ && V[z].context !== $)
                    W.push(V[z]);
            if (W.length)
                this._events[K] = W.length === 1 ? W[0] : W;
            else
                mY(this, K)
        }
        return this
    }
        ;
    PJ.prototype.removeAllListeners = function J(Q) {
        var Z;
        if (Q) {
            if (Z = mJ ? mJ + Q : Q,
                this._events[Z])
                mY(this, Z)
        } else
            this._events = new HV,
                this._eventsCount = 0;
        return this
    }
        ;
    PJ.prototype.off = PJ.prototype.removeListener;
    PJ.prototype.addListener = PJ.prototype.on;
    PJ.prefixed = mJ;
    PJ.EventEmitter = PJ;
    if (typeof QF !== "undefined")
        QF.exports = PJ
}
);
var DE, o6;
var wJ = O(() => {
    DE = oZ(PE(), 1),
        o6 = DE.default
}
);
var Zx, zQ = function (J) {
    return typeof J == "string" ? J.length > 0 : typeof J == "number"
}, KJ = function (J, Q, Z) {
    return Q === void 0 && (Q = 0),
        Z === void 0 && (Z = Math.pow(10, Q)),
        Math.round(Z * J) / Z + 0
}, A5 = function (J, Q, Z) {
    return Q === void 0 && (Q = 0),
        Z === void 0 && (Z = 1),
        J > Z ? Z : J > Q ? J : Q
}, SE = function (J) {
    return (J = isFinite(J) ? J % 360 : 0) > 0 ? J : J + 360
}, AE = function (J) {
    return {
        r: A5(J.r, 0, 255),
        g: A5(J.g, 0, 255),
        b: A5(J.b, 0, 255),
        a: A5(J.a)
    }
}, ZF = function (J) {
    return {
        r: KJ(J.r),
        g: KJ(J.g),
        b: KJ(J.b),
        a: KJ(J.a, 3)
    }
}, $x, cY = function (J) {
    var Q = J.toString(16);
    return Q.length < 2 ? "0" + Q : Q
}, TE = function (J) {
    var { r: Q, g: Z, b: $, a: q } = J
        , K = Math.max(Q, Z, $)
        , V = K - Math.min(Q, Z, $)
        , z = V ? K === Q ? (Z - $) / V : K === Z ? 2 + ($ - Q) / V : 4 + (Q - Z) / V : 0;
    return {
        h: 60 * (z < 0 ? z + 6 : z),
        s: K ? V / K * 100 : 0,
        v: K / 255 * 100,
        a: q
    }
}, yE = function (J) {
    var { h: Q, s: Z, v: $, a: q } = J;
    Q = Q / 360 * 6,
        Z /= 100,
        $ /= 100;
    var K = Math.floor(Q)
        , V = $ * (1 - Z)
        , z = $ * (1 - (Q - K) * Z)
        , W = $ * (1 - (1 - Q + K) * Z)
        , H = K % 6;
    return {
        r: 255 * [$, z, V, V, W, $][H],
        g: 255 * [W, $, $, z, V, V][H],
        b: 255 * [V, V, W, $, $, z][H],
        a: q
    }
}, EE = function (J) {
    return {
        h: SE(J.h),
        s: A5(J.s, 0, 100),
        l: A5(J.l, 0, 100),
        a: A5(J.a)
    }
}, ME = function (J) {
    return {
        h: KJ(J.h),
        s: KJ(J.s),
        l: KJ(J.l),
        a: KJ(J.a, 3)
    }
}, _E = function (J) {
    return yE((Z = (Q = J).s,
    {
        h: Q.h,
        s: (Z *= (($ = Q.l) < 50 ? $ : 100 - $) / 100) > 0 ? 2 * Z / ($ + Z) * 100 : 0,
        v: $ + Z,
        a: Q.a
    }));
    var Q, Z, $
}, YV = function (J) {
    return {
        h: (Q = TE(J)).h,
        s: (q = (200 - (Z = Q.s)) * ($ = Q.v) / 100) > 0 && q < 200 ? Z * $ / 100 / (q <= 100 ? q : 200 - q) * 100 : 0,
        l: q / 2,
        a: Q.a
    };
    var Q, Z, $, q
}, qx, Kx, Vx, zx, KF, RE = function (J, Q) {
    for (var Z = 0; Z < Q.length; Z++) {
        var $ = Q[Z][0](J);
        if ($)
            return [$, Q[Z][1]]
    }
    return [null, void 0]
}, Wx = function (J) {
    return typeof J == "string" ? RE(J.trim(), KF.string) : typeof J == "object" && J !== null ? RE(J, KF.object) : [null, void 0]
}, $F = function (J, Q) {
    var Z = YV(J);
    return {
        h: Z.h,
        s: A5(Z.s + 100 * Q, 0, 100),
        l: Z.l,
        a: Z.a
    }
}, qF = function (J) {
    return (299 * J.r + 587 * J.g + 114 * J.b) / 1000 / 255
}, bE = function (J, Q) {
    var Z = YV(J);
    return {
        h: Z.h,
        s: Z.s,
        l: A5(Z.l + 100 * Q, 0, 100),
        a: Z.a
    }
}, VF, B5 = function (J) {
    return J instanceof VF ? J : new VF(J)
}, vE, dY = function (J) {
    J.forEach(function (Q) {
        vE.indexOf(Q) < 0 && (Q(VF, KF),
            vE.push(Q))
    })
};
var zF = O(() => {
    Zx = {
        grad: 0.9,
        turn: 360,
        rad: 360 / (2 * Math.PI)
    },
        $x = /^#([0-9a-f]{3,8})$/i,
        qx = /^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,
        Kx = /^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,
        Vx = /^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,
        zx = /^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,
        KF = {
            string: [[function (J) {
                var Q = $x.exec(J);
                return Q ? (J = Q[1]).length <= 4 ? {
                    r: parseInt(J[0] + J[0], 16),
                    g: parseInt(J[1] + J[1], 16),
                    b: parseInt(J[2] + J[2], 16),
                    a: J.length === 4 ? KJ(parseInt(J[3] + J[3], 16) / 255, 2) : 1
                } : J.length === 6 || J.length === 8 ? {
                    r: parseInt(J.substr(0, 2), 16),
                    g: parseInt(J.substr(2, 2), 16),
                    b: parseInt(J.substr(4, 2), 16),
                    a: J.length === 8 ? KJ(parseInt(J.substr(6, 2), 16) / 255, 2) : 1
                } : null : null
            }
                , "hex"], [function (J) {
                    var Q = Vx.exec(J) || zx.exec(J);
                    return Q ? Q[2] !== Q[4] || Q[4] !== Q[6] ? null : AE({
                        r: Number(Q[1]) / (Q[2] ? 0.39215686274509803 : 1),
                        g: Number(Q[3]) / (Q[4] ? 0.39215686274509803 : 1),
                        b: Number(Q[5]) / (Q[6] ? 0.39215686274509803 : 1),
                        a: Q[7] === void 0 ? 1 : Number(Q[7]) / (Q[8] ? 100 : 1)
                    }) : null
                }
                , "rgb"], [function (J) {
                    var Q = qx.exec(J) || Kx.exec(J);
                    if (!Q)
                        return null;
                    var Z, $, q = EE({
                        h: (Z = Q[1],
                            $ = Q[2],
                            $ === void 0 && ($ = "deg"),
                            Number(Z) * (Zx[$] || 1)),
                        s: Number(Q[3]),
                        l: Number(Q[4]),
                        a: Q[5] === void 0 ? 1 : Number(Q[5]) / (Q[6] ? 100 : 1)
                    });
                    return _E(q)
                }
                , "hsl"]],
            object: [[function (J) {
                var { r: Q, g: Z, b: $, a: q } = J
                    , K = q === void 0 ? 1 : q;
                return zQ(Q) && zQ(Z) && zQ($) ? AE({
                    r: Number(Q),
                    g: Number(Z),
                    b: Number($),
                    a: Number(K)
                }) : null
            }
                , "rgb"], [function (J) {
                    var { h: Q, s: Z, l: $, a: q } = J
                        , K = q === void 0 ? 1 : q;
                    if (!zQ(Q) || !zQ(Z) || !zQ($))
                        return null;
                    var V = EE({
                        h: Number(Q),
                        s: Number(Z),
                        l: Number($),
                        a: Number(K)
                    });
                    return _E(V)
                }
                , "hsl"], [function (J) {
                    var { h: Q, s: Z, v: $, a: q } = J
                        , K = q === void 0 ? 1 : q;
                    if (!zQ(Q) || !zQ(Z) || !zQ($))
                        return null;
                    var V = function (z) {
                        return {
                            h: SE(z.h),
                            s: A5(z.s, 0, 100),
                            v: A5(z.v, 0, 100),
                            a: A5(z.a)
                        }
                    }({
                        h: Number(Q),
                        s: Number(Z),
                        v: Number($),
                        a: Number(K)
                    });
                    return yE(V)
                }
                , "hsv"]]
        },
        VF = function () {
            function J(Q) {
                this.parsed = Wx(Q)[0],
                    this.rgba = this.parsed || {
                        r: 0,
                        g: 0,
                        b: 0,
                        a: 1
                    }
            }
            return J.prototype.isValid = function () {
                return this.parsed !== null
            }
                ,
                J.prototype.brightness = function () {
                    return KJ(qF(this.rgba), 2)
                }
                ,
                J.prototype.isDark = function () {
                    return qF(this.rgba) < 0.5
                }
                ,
                J.prototype.isLight = function () {
                    return qF(this.rgba) >= 0.5
                }
                ,
                J.prototype.toHex = function () {
                    return Q = ZF(this.rgba),
                        Z = Q.r,
                        $ = Q.g,
                        q = Q.b,
                        V = (K = Q.a) < 1 ? cY(KJ(255 * K)) : "",
                        "#" + cY(Z) + cY($) + cY(q) + V;
                    var Q, Z, $, q, K, V
                }
                ,
                J.prototype.toRgb = function () {
                    return ZF(this.rgba)
                }
                ,
                J.prototype.toRgbString = function () {
                    return Q = ZF(this.rgba),
                        Z = Q.r,
                        $ = Q.g,
                        q = Q.b,
                        (K = Q.a) < 1 ? "rgba(" + Z + ", " + $ + ", " + q + ", " + K + ")" : "rgb(" + Z + ", " + $ + ", " + q + ")";
                    var Q, Z, $, q, K
                }
                ,
                J.prototype.toHsl = function () {
                    return ME(YV(this.rgba))
                }
                ,
                J.prototype.toHslString = function () {
                    return Q = ME(YV(this.rgba)),
                        Z = Q.h,
                        $ = Q.s,
                        q = Q.l,
                        (K = Q.a) < 1 ? "hsla(" + Z + ", " + $ + "%, " + q + "%, " + K + ")" : "hsl(" + Z + ", " + $ + "%, " + q + "%)";
                    var Q, Z, $, q, K
                }
                ,
                J.prototype.toHsv = function () {
                    return Q = TE(this.rgba),
                    {
                        h: KJ(Q.h),
                        s: KJ(Q.s),
                        v: KJ(Q.v),
                        a: KJ(Q.a, 3)
                    };
                    var Q
                }
                ,
                J.prototype.invert = function () {
                    return B5({
                        r: 255 - (Q = this.rgba).r,
                        g: 255 - Q.g,
                        b: 255 - Q.b,
                        a: Q.a
                    });
                    var Q
                }
                ,
                J.prototype.saturate = function (Q) {
                    return Q === void 0 && (Q = 0.1),
                        B5($F(this.rgba, Q))
                }
                ,
                J.prototype.desaturate = function (Q) {
                    return Q === void 0 && (Q = 0.1),
                        B5($F(this.rgba, -Q))
                }
                ,
                J.prototype.grayscale = function () {
                    return B5($F(this.rgba, -1))
                }
                ,
                J.prototype.lighten = function (Q) {
                    return Q === void 0 && (Q = 0.1),
                        B5(bE(this.rgba, Q))
                }
                ,
                J.prototype.darken = function (Q) {
                    return Q === void 0 && (Q = 0.1),
                        B5(bE(this.rgba, -Q))
                }
                ,
                J.prototype.rotate = function (Q) {
                    return Q === void 0 && (Q = 15),
                        this.hue(this.hue() + Q)
                }
                ,
                J.prototype.alpha = function (Q) {
                    return typeof Q == "number" ? B5({
                        r: (Z = this.rgba).r,
                        g: Z.g,
                        b: Z.b,
                        a: Q
                    }) : KJ(this.rgba.a, 3);
                    var Z
                }
                ,
                J.prototype.hue = function (Q) {
                    var Z = YV(this.rgba);
                    return typeof Q == "number" ? B5({
                        h: Q,
                        s: Z.s,
                        l: Z.l,
                        a: Z.a
                    }) : KJ(Z.h)
                }
                ,
                J.prototype.isEqual = function (Q) {
                    return this.toHex() === B5(Q).toHex()
                }
                ,
                J
        }(),
        vE = []
}
);
function XV(J, Q) {
    var Z = {
        white: "#ffffff",
        bisque: "#ffe4c4",
        blue: "#0000ff",
        cadetblue: "#5f9ea0",
        chartreuse: "#7fff00",
        chocolate: "#d2691e",
        coral: "#ff7f50",
        antiquewhite: "#faebd7",
        aqua: "#00ffff",
        azure: "#f0ffff",
        whitesmoke: "#f5f5f5",
        papayawhip: "#ffefd5",
        plum: "#dda0dd",
        blanchedalmond: "#ffebcd",
        black: "#000000",
        gold: "#ffd700",
        goldenrod: "#daa520",
        gainsboro: "#dcdcdc",
        cornsilk: "#fff8dc",
        cornflowerblue: "#6495ed",
        burlywood: "#deb887",
        aquamarine: "#7fffd4",
        beige: "#f5f5dc",
        crimson: "#dc143c",
        cyan: "#00ffff",
        darkblue: "#00008b",
        darkcyan: "#008b8b",
        darkgoldenrod: "#b8860b",
        darkkhaki: "#bdb76b",
        darkgray: "#a9a9a9",
        darkgreen: "#006400",
        darkgrey: "#a9a9a9",
        peachpuff: "#ffdab9",
        darkmagenta: "#8b008b",
        darkred: "#8b0000",
        darkorchid: "#9932cc",
        darkorange: "#ff8c00",
        darkslateblue: "#483d8b",
        gray: "#808080",
        darkslategray: "#2f4f4f",
        darkslategrey: "#2f4f4f",
        deeppink: "#ff1493",
        deepskyblue: "#00bfff",
        wheat: "#f5deb3",
        firebrick: "#b22222",
        floralwhite: "#fffaf0",
        ghostwhite: "#f8f8ff",
        darkviolet: "#9400d3",
        magenta: "#ff00ff",
        green: "#008000",
        dodgerblue: "#1e90ff",
        grey: "#808080",
        honeydew: "#f0fff0",
        hotpink: "#ff69b4",
        blueviolet: "#8a2be2",
        forestgreen: "#228b22",
        lawngreen: "#7cfc00",
        indianred: "#cd5c5c",
        indigo: "#4b0082",
        fuchsia: "#ff00ff",
        brown: "#a52a2a",
        maroon: "#800000",
        mediumblue: "#0000cd",
        lightcoral: "#f08080",
        darkturquoise: "#00ced1",
        lightcyan: "#e0ffff",
        ivory: "#fffff0",
        lightyellow: "#ffffe0",
        lightsalmon: "#ffa07a",
        lightseagreen: "#20b2aa",
        linen: "#faf0e6",
        mediumaquamarine: "#66cdaa",
        lemonchiffon: "#fffacd",
        lime: "#00ff00",
        khaki: "#f0e68c",
        mediumseagreen: "#3cb371",
        limegreen: "#32cd32",
        mediumspringgreen: "#00fa9a",
        lightskyblue: "#87cefa",
        lightblue: "#add8e6",
        midnightblue: "#191970",
        lightpink: "#ffb6c1",
        mistyrose: "#ffe4e1",
        moccasin: "#ffe4b5",
        mintcream: "#f5fffa",
        lightslategray: "#778899",
        lightslategrey: "#778899",
        navajowhite: "#ffdead",
        navy: "#000080",
        mediumvioletred: "#c71585",
        powderblue: "#b0e0e6",
        palegoldenrod: "#eee8aa",
        oldlace: "#fdf5e6",
        paleturquoise: "#afeeee",
        mediumturquoise: "#48d1cc",
        mediumorchid: "#ba55d3",
        rebeccapurple: "#663399",
        lightsteelblue: "#b0c4de",
        mediumslateblue: "#7b68ee",
        thistle: "#d8bfd8",
        tan: "#d2b48c",
        orchid: "#da70d6",
        mediumpurple: "#9370db",
        purple: "#800080",
        pink: "#ffc0cb",
        skyblue: "#87ceeb",
        springgreen: "#00ff7f",
        palegreen: "#98fb98",
        red: "#ff0000",
        yellow: "#ffff00",
        slateblue: "#6a5acd",
        lavenderblush: "#fff0f5",
        peru: "#cd853f",
        palevioletred: "#db7093",
        violet: "#ee82ee",
        teal: "#008080",
        slategray: "#708090",
        slategrey: "#708090",
        aliceblue: "#f0f8ff",
        darkseagreen: "#8fbc8f",
        darkolivegreen: "#556b2f",
        greenyellow: "#adff2f",
        seagreen: "#2e8b57",
        seashell: "#fff5ee",
        tomato: "#ff6347",
        silver: "#c0c0c0",
        sienna: "#a0522d",
        lavender: "#e6e6fa",
        lightgreen: "#90ee90",
        orange: "#ffa500",
        orangered: "#ff4500",
        steelblue: "#4682b4",
        royalblue: "#4169e1",
        turquoise: "#40e0d0",
        yellowgreen: "#9acd32",
        salmon: "#fa8072",
        saddlebrown: "#8b4513",
        sandybrown: "#f4a460",
        rosybrown: "#bc8f8f",
        darksalmon: "#e9967a",
        lightgoldenrodyellow: "#fafad2",
        snow: "#fffafa",
        lightgrey: "#d3d3d3",
        lightgray: "#d3d3d3",
        dimgray: "#696969",
        dimgrey: "#696969",
        olivedrab: "#6b8e23",
        olive: "#808000"
    }
        , $ = {};
    for (var q in Z)
        $[Z[q]] = q;
    var K = {};
    J.prototype.toName = function (V) {
        if (!(this.rgba.a || this.rgba.r || this.rgba.g || this.rgba.b))
            return "transparent";
        var z, W, H = $[this.toHex()];
        if (H)
            return H;
        if (V == null ? void 0 : V.closest) {
            var Y = this.toRgb()
                , U = 1 / 0
                , N = "black";
            if (!K.length)
                for (var j in Z)
                    K[j] = new J(Z[j]).toRgb();
            for (var k in Z) {
                var L = (z = Y,
                    W = K[k],
                    Math.pow(z.r - W.r, 2) + Math.pow(z.g - W.g, 2) + Math.pow(z.b - W.b, 2));
                L < U && (U = L,
                    N = k)
            }
            return N
        }
    }
        ,
        Q.string.push([function (V) {
            var z = V.toLowerCase()
                , W = z === "transparent" ? "#0000" : Z[z];
            return W ? new J(W).toRgb() : null
        }
            , "name"])
}
var f1 = class J {
    constructor(Q = 16777215) {
        this._value = null,
            this._components = new Float32Array(4),
            this._components.fill(1),
            this._int = 16777215,
            this.value = Q
    }
    get red() {
        return this._components[0]
    }
    get green() {
        return this._components[1]
    }
    get blue() {
        return this._components[2]
    }
    get alpha() {
        return this._components[3]
    }
    setValue(Q) {
        return this.value = Q,
            this
    }
    set value(Q) {
        if (Q instanceof J)
            this._value = this._cloneSource(Q._value),
                this._int = Q._int,
                this._components.set(Q._components);
        else if (Q === null)
            throw new Error("Cannot set Color#value to null");
        else if (this._value === null || !this._isSourceEqual(this._value, Q))
            this._value = this._cloneSource(Q),
                this._normalize(this._value)
    }
    get value() {
        return this._value
    }
    _cloneSource(Q) {
        if (typeof Q === "string" || typeof Q === "number" || Q instanceof Number || Q === null)
            return Q;
        else if (Array.isArray(Q) || ArrayBuffer.isView(Q))
            return Q.slice(0);
        else if (typeof Q === "object" && Q !== null)
            return {
                ...Q
            };
        return Q
    }
    _isSourceEqual(Q, Z) {
        let $ = typeof Q;
        if ($ !== typeof Z)
            return !1;
        else if ($ === "number" || $ === "string" || Q instanceof Number)
            return Q === Z;
        else if (Array.isArray(Q) && Array.isArray(Z) || ArrayBuffer.isView(Q) && ArrayBuffer.isView(Z)) {
            if (Q.length !== Z.length)
                return !1;
            return Q.every((K, V) => K === Z[V])
        } else if (Q !== null && Z !== null) {
            let K = Object.keys(Q)
                , V = Object.keys(Z);
            if (K.length !== V.length)
                return !1;
            return K.every((z) => Q[z] === Z[z])
        }
        return Q === Z
    }
    toRgba() {
        let [Q, Z, $, q] = this._components;
        return {
            r: Q,
            g: Z,
            b: $,
            a: q
        }
    }
    toRgb() {
        let [Q, Z, $] = this._components;
        return {
            r: Q,
            g: Z,
            b: $
        }
    }
    toRgbaString() {
        let [Q, Z, $] = this.toUint8RgbArray();
        return `rgba(${Q},${Z},${$},${this.alpha})`
    }
    toUint8RgbArray(Q) {
        let [Z, $, q] = this._components;
        if (!this._arrayRgb)
            this._arrayRgb = [];
        return Q || (Q = this._arrayRgb),
            Q[0] = Math.round(Z * 255),
            Q[1] = Math.round($ * 255),
            Q[2] = Math.round(q * 255),
            Q
    }
    toArray(Q) {
        if (!this._arrayRgba)
            this._arrayRgba = [];
        Q || (Q = this._arrayRgba);
        let [Z, $, q, K] = this._components;
        return Q[0] = Z,
            Q[1] = $,
            Q[2] = q,
            Q[3] = K,
            Q
    }
    toRgbArray(Q) {
        if (!this._arrayRgb)
            this._arrayRgb = [];
        Q || (Q = this._arrayRgb);
        let [Z, $, q] = this._components;
        return Q[0] = Z,
            Q[1] = $,
            Q[2] = q,
            Q
    }
    toNumber() {
        return this._int
    }
    toBgrNumber() {
        let [Q, Z, $] = this.toUint8RgbArray();
        return ($ << 16) + (Z << 8) + Q
    }
    toLittleEndianNumber() {
        let Q = this._int;
        return (Q >> 16) + (Q & 65280) + ((Q & 255) << 16)
    }
    multiply(Q) {
        let [Z, $, q, K] = J._temp.setValue(Q)._components;
        return this._components[0] *= Z,
            this._components[1] *= $,
            this._components[2] *= q,
            this._components[3] *= K,
            this._refreshInt(),
            this._value = null,
            this
    }
    premultiply(Q, Z = !0) {
        if (Z)
            this._components[0] *= Q,
                this._components[1] *= Q,
                this._components[2] *= Q;
        return this._components[3] = Q,
            this._refreshInt(),
            this._value = null,
            this
    }
    toPremultiplied(Q, Z = !0) {
        if (Q === 1)
            return -16777216 + this._int;
        if (Q === 0)
            return Z ? 0 : this._int;
        let $ = this._int >> 16 & 255
            , q = this._int >> 8 & 255
            , K = this._int & 255;
        if (Z)
            $ = $ * Q + 0.5 | 0,
                q = q * Q + 0.5 | 0,
                K = K * Q + 0.5 | 0;
        return (Q * 255 << 24) + ($ << 16) + (q << 8) + K
    }
    toHex() {
        let Q = this._int.toString(16);
        return `#${"000000".substring(0, 6 - Q.length) + Q}`
    }
    toHexa() {
        let Z = Math.round(this._components[3] * 255).toString(16);
        return this.toHex() + "00".substring(0, 2 - Z.length) + Z
    }
    setAlpha(Q) {
        return this._components[3] = this._clamp(Q),
            this
    }
    _normalize(Q) {
        let Z, $, q, K;
        if ((typeof Q === "number" || Q instanceof Number) && Q >= 0 && Q <= 16777215) {
            let V = Q;
            Z = (V >> 16 & 255) / 255,
                $ = (V >> 8 & 255) / 255,
                q = (V & 255) / 255,
                K = 1
        } else if ((Array.isArray(Q) || Q instanceof Float32Array) && Q.length >= 3 && Q.length <= 4)
            Q = this._clamp(Q),
                [Z, $, q, K = 1] = Q;
        else if ((Q instanceof Uint8Array || Q instanceof Uint8ClampedArray) && Q.length >= 3 && Q.length <= 4)
            Q = this._clamp(Q, 0, 255),
                [Z, $, q, K = 255] = Q,
                Z /= 255,
                $ /= 255,
                q /= 255,
                K /= 255;
        else if (typeof Q === "string" || typeof Q === "object") {
            if (typeof Q === "string") {
                let z = J.HEX_PATTERN.exec(Q);
                if (z)
                    Q = `#${z[2]}`
            }
            let V = B5(Q);
            if (V.isValid())
                ({ r: Z, g: $, b: q, a: K } = V.rgba),
                    Z /= 255,
                    $ /= 255,
                    q /= 255
        }
        if (Z !== void 0)
            this._components[0] = Z,
                this._components[1] = $,
                this._components[2] = q,
                this._components[3] = K,
                this._refreshInt();
        else
            throw new Error(`Unable to convert color ${Q}`)
    }
    _refreshInt() {
        this._clamp(this._components);
        let [Q, Z, $] = this._components;
        this._int = (Q * 255 << 16) + (Z * 255 << 8) + ($ * 255 | 0)
    }
    _clamp(Q, Z = 0, $ = 1) {
        if (typeof Q === "number")
            return Math.min(Math.max(Q, Z), $);
        return Q.forEach((q, K) => {
            Q[K] = Math.min(Math.max(q, Z), $)
        }
        ),
            Q
    }
    static isColorLike(Q) {
        return typeof Q === "number" || typeof Q === "string" || Q instanceof Number || Q instanceof J || Array.isArray(Q) || Q instanceof Uint8Array || Q instanceof Uint8ClampedArray || Q instanceof Float32Array || Q.r !== void 0 && Q.g !== void 0 && Q.b !== void 0 || Q.r !== void 0 && Q.g !== void 0 && Q.b !== void 0 && Q.a !== void 0 || Q.h !== void 0 && Q.s !== void 0 && Q.l !== void 0 || Q.h !== void 0 && Q.s !== void 0 && Q.l !== void 0 && Q.a !== void 0 || Q.h !== void 0 && Q.s !== void 0 && Q.v !== void 0 || Q.h !== void 0 && Q.s !== void 0 && Q.v !== void 0 && Q.a !== void 0
    }
}
    , E8;
var T7 = O(() => {
    zF();
    dY([XV]);
    f1.shared = new f1;
    f1._temp = new f1;
    f1.HEX_PATTERN = /^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;
    E8 = f1
}
);
var pY;
var uY = O(() => {
    pY = {
        cullArea: null,
        cullable: !1,
        cullableChildren: !0
    }
}
);
var lY, oY, nY;
var UV = O(() => {
    lY = Math.PI * 2,
        oY = 180 / Math.PI,
        nY = Math.PI / 180
}
);
class z6 {
    constructor(J = 0, Q = 0) {
        this.x = 0,
            this.y = 0,
            this.x = J,
            this.y = Q
    }
    clone() {
        return new z6(this.x, this.y)
    }
    copyFrom(J) {
        return this.set(J.x, J.y),
            this
    }
    copyTo(J) {
        return J.set(this.x, this.y),
            J
    }
    equals(J) {
        return J.x === this.x && J.y === this.y
    }
    set(J = 0, Q = J) {
        return this.x = J,
            this.y = Q,
            this
    }
    toString() {
        return `[pixi.js/math:Point x=${this.x} y=${this.y}]`
    }
    static get shared() {
        return WF.x = 0,
            WF.y = 0,
            WF
    }
}
var WF;
var cJ = O(() => {
    WF = new z6
}
);
class f0 {
    constructor(J = 1, Q = 0, Z = 0, $ = 1, q = 0, K = 0) {
        this.array = null,
            this.a = J,
            this.b = Q,
            this.c = Z,
            this.d = $,
            this.tx = q,
            this.ty = K
    }
    fromArray(J) {
        this.a = J[0],
            this.b = J[1],
            this.c = J[3],
            this.d = J[4],
            this.tx = J[2],
            this.ty = J[5]
    }
    set(J, Q, Z, $, q, K) {
        return this.a = J,
            this.b = Q,
            this.c = Z,
            this.d = $,
            this.tx = q,
            this.ty = K,
            this
    }
    toArray(J, Q) {
        if (!this.array)
            this.array = new Float32Array(9);
        let Z = Q || this.array;
        if (J)
            Z[0] = this.a,
                Z[1] = this.b,
                Z[2] = 0,
                Z[3] = this.c,
                Z[4] = this.d,
                Z[5] = 0,
                Z[6] = this.tx,
                Z[7] = this.ty,
                Z[8] = 1;
        else
            Z[0] = this.a,
                Z[1] = this.c,
                Z[2] = this.tx,
                Z[3] = this.b,
                Z[4] = this.d,
                Z[5] = this.ty,
                Z[6] = 0,
                Z[7] = 0,
                Z[8] = 1;
        return Z
    }
    apply(J, Q) {
        Q = Q || new z6;
        let { x: Z, y: $ } = J;
        return Q.x = this.a * Z + this.c * $ + this.tx,
            Q.y = this.b * Z + this.d * $ + this.ty,
            Q
    }
    applyInverse(J, Q) {
        Q = Q || new z6;
        let Z = this.a
            , $ = this.b
            , q = this.c
            , K = this.d
            , V = this.tx
            , z = this.ty
            , W = 1 / (Z * K + q * -$)
            , H = J.x
            , Y = J.y;
        return Q.x = K * W * H + -q * W * Y + (z * q - V * K) * W,
            Q.y = Z * W * Y + -$ * W * H + (-z * Z + V * $) * W,
            Q
    }
    translate(J, Q) {
        return this.tx += J,
            this.ty += Q,
            this
    }
    scale(J, Q) {
        return this.a *= J,
            this.d *= Q,
            this.c *= J,
            this.b *= Q,
            this.tx *= J,
            this.ty *= Q,
            this
    }
    rotate(J) {
        let Q = Math.cos(J)
            , Z = Math.sin(J)
            , $ = this.a
            , q = this.c
            , K = this.tx;
        return this.a = $ * Q - this.b * Z,
            this.b = $ * Z + this.b * Q,
            this.c = q * Q - this.d * Z,
            this.d = q * Z + this.d * Q,
            this.tx = K * Q - this.ty * Z,
            this.ty = K * Z + this.ty * Q,
            this
    }
    append(J) {
        let Q = this.a
            , Z = this.b
            , $ = this.c
            , q = this.d;
        return this.a = J.a * Q + J.b * $,
            this.b = J.a * Z + J.b * q,
            this.c = J.c * Q + J.d * $,
            this.d = J.c * Z + J.d * q,
            this.tx = J.tx * Q + J.ty * $ + this.tx,
            this.ty = J.tx * Z + J.ty * q + this.ty,
            this
    }
    appendFrom(J, Q) {
        let { a: Z, b: $, c: q, d: K, tx: V, ty: z } = J
            , W = Q.a
            , H = Q.b
            , Y = Q.c
            , U = Q.d;
        return this.a = Z * W + $ * Y,
            this.b = Z * H + $ * U,
            this.c = q * W + K * Y,
            this.d = q * H + K * U,
            this.tx = V * W + z * Y + Q.tx,
            this.ty = V * H + z * U + Q.ty,
            this
    }
    setTransform(J, Q, Z, $, q, K, V, z, W) {
        return this.a = Math.cos(V + W) * q,
            this.b = Math.sin(V + W) * q,
            this.c = -Math.sin(V - z) * K,
            this.d = Math.cos(V - z) * K,
            this.tx = J - (Z * this.a + $ * this.c),
            this.ty = Q - (Z * this.b + $ * this.d),
            this
    }
    prepend(J) {
        let Q = this.tx;
        if (J.a !== 1 || J.b !== 0 || J.c !== 0 || J.d !== 1) {
            let Z = this.a
                , $ = this.c;
            this.a = Z * J.a + this.b * J.c,
                this.b = Z * J.b + this.b * J.d,
                this.c = $ * J.a + this.d * J.c,
                this.d = $ * J.b + this.d * J.d
        }
        return this.tx = Q * J.a + this.ty * J.c + J.tx,
            this.ty = Q * J.b + this.ty * J.d + J.ty,
            this
    }
    decompose(J) {
        let Q = this.a
            , Z = this.b
            , $ = this.c
            , q = this.d
            , K = J.pivot
            , V = -Math.atan2(-$, q)
            , z = Math.atan2(Z, Q)
            , W = Math.abs(V + z);
        if (W < 0.00001 || Math.abs(lY - W) < 0.00001)
            J.rotation = z,
                J.skew.x = J.skew.y = 0;
        else
            J.rotation = 0,
                J.skew.x = V,
                J.skew.y = z;
        return J.scale.x = Math.sqrt(Q * Q + Z * Z),
            J.scale.y = Math.sqrt($ * $ + q * q),
            J.position.x = this.tx + (K.x * Q + K.y * $),
            J.position.y = this.ty + (K.x * Z + K.y * q),
            J
    }
    invert() {
        let J = this.a
            , Q = this.b
            , Z = this.c
            , $ = this.d
            , q = this.tx
            , K = J * $ - Q * Z;
        return this.a = $ / K,
            this.b = -Q / K,
            this.c = -Z / K,
            this.d = J / K,
            this.tx = (Z * this.ty - $ * q) / K,
            this.ty = -(J * this.ty - Q * q) / K,
            this
    }
    isIdentity() {
        return this.a === 1 && this.b === 0 && this.c === 0 && this.d === 1 && this.tx === 0 && this.ty === 0
    }
    identity() {
        return this.a = 1,
            this.b = 0,
            this.c = 0,
            this.d = 1,
            this.tx = 0,
            this.ty = 0,
            this
    }
    clone() {
        let J = new f0;
        return J.a = this.a,
            J.b = this.b,
            J.c = this.c,
            J.d = this.d,
            J.tx = this.tx,
            J.ty = this.ty,
            J
    }
    copyTo(J) {
        return J.a = this.a,
            J.b = this.b,
            J.c = this.c,
            J.d = this.d,
            J.tx = this.tx,
            J.ty = this.ty,
            J
    }
    copyFrom(J) {
        return this.a = J.a,
            this.b = J.b,
            this.c = J.c,
            this.d = J.d,
            this.tx = J.tx,
            this.ty = J.ty,
            this
    }
    equals(J) {
        return J.a === this.a && J.b === this.b && J.c === this.c && J.d === this.d && J.tx === this.tx && J.ty === this.ty
    }
    toString() {
        return `[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`
    }
    static get IDENTITY() {
        return Yx.identity()
    }
    static get shared() {
        return Hx.identity()
    }
}
var Hx, Yx;
var Z6 = O(() => {
    UV();
    cJ();
    Hx = new f0,
        Yx = new f0
}
);
class g6 {
    constructor(J, Q, Z) {
        this._x = Q || 0,
            this._y = Z || 0,
            this._observer = J
    }
    clone(J) {
        return new g6(J ?? this._observer, this._x, this._y)
    }
    set(J = 0, Q = J) {
        if (this._x !== J || this._y !== Q)
            this._x = J,
                this._y = Q,
                this._observer._onUpdate(this);
        return this
    }
    copyFrom(J) {
        if (this._x !== J.x || this._y !== J.y)
            this._x = J.x,
                this._y = J.y,
                this._observer._onUpdate(this);
        return this
    }
    copyTo(J) {
        return J.set(this._x, this._y),
            J
    }
    equals(J) {
        return J.x === this._x && J.y === this._y
    }
    toString() {
        return `[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`
    }
    get x() {
        return this._x
    }
    set x(J) {
        if (this._x !== J)
            this._x = J,
                this._observer._onUpdate(this)
    }
    get y() {
        return this._y
    }
    set y(J) {
        if (this._y !== J)
            this._y = J,
                this._observer._onUpdate(this)
    }
}
var WQ = () => { }
    ;
function i8(J = "default") {
    if (HF[J] === void 0)
        HF[J] = -1;
    return ++HF[J]
}
var HF;
var l7 = O(() => {
    HF = {
        default: -1
    }
}
);
function c0(J, Q, Z = 3) {
    if (fE[Q])
        return;
    let $ = new Error().stack;
    if (typeof $ === "undefined")
        ;
    else
        $ = $.split(`
`).splice(Z).join(`
`);
    fE[Q] = !0
}
var fE, Y8 = "8.0.0", sY = "8.3.4";
var O6 = O(() => {
    fE = {}
}
);
function m0(...J) {
    if (YF === hE)
        return;
    YF++
}
var YF = 0
    , hE = 500;
var B6 = () => { }
    ;
class iQ {
    constructor(J, Q) {
        if (this._pool = [],
            this._count = 0,
            this._index = 0,
            this._classType = J,
            Q)
            this.prepopulate(Q)
    }
    prepopulate(J) {
        for (let Q = 0; Q < J; Q++)
            this._pool[this._index++] = new this._classType;
        this._count += J
    }
    get(J) {
        let Q;
        if (this._index > 0)
            Q = this._pool[--this._index];
        else
            Q = new this._classType;
        return Q.init?.(J),
            Q
    }
    return(J) {
        J.reset?.(),
            this._pool[this._index++] = J
    }
    get totalSize() {
        return this._count
    }
    get totalFree() {
        return this._index
    }
    get totalUsed() {
        return this._count - this._index
    }
    clear() {
        this._pool.length = 0,
            this._index = 0
    }
}
var NV = () => { }
    ;
class iY {
    constructor() {
        this._poolsByClass = new Map
    }
    prepopulate(J, Q) {
        this.getPool(J).prepopulate(Q)
    }
    get(J, Q) {
        return this.getPool(J).get(Q)
    }
    return(J) {
        this.getPool(J.constructor).return(J)
    }
    getPool(J) {
        if (!this._poolsByClass.has(J))
            this._poolsByClass.set(J, new iQ(J));
        return this._poolsByClass.get(J)
    }
    stats() {
        let J = {};
        return this._poolsByClass.forEach((Q) => {
            let Z = J[Q._classType.name] ? Q._classType.name + Q._classType.ID : Q._classType.name;
            J[Z] = {
                free: Q.totalFree,
                used: Q.totalUsed,
                size: Q.totalSize
            }
        }
        ),
            J
    }
}
var V7;
var s5 = O(() => {
    NV();
    V7 = new iY
}
);
var aY;
var rY = O(() => {
    O6();
    aY = {
        get isCachedAsTexture() {
            return !!this.renderGroup?.isCachedAsTexture
        },
        cacheAsTexture(J) {
            if (typeof J === "boolean" && J === !1)
                this.disableRenderGroup();
            else
                this.enableRenderGroup(),
                    this.renderGroup.enableCacheAsTexture(J === !0 ? {} : J)
        },
        updateCacheTexture() {
            this.renderGroup?.updateCacheTexture()
        },
        get cacheAsBitmap() {
            return this.isCachedAsTexture
        },
        set cacheAsBitmap(J) {
            c0("v8.6.0", "cacheAsBitmap is deprecated, use cacheAsTexture instead."),
                this.cacheAsTexture(J)
        }
    }
}
);
function h1(J, Q, Z) {
    let $ = J.length, q;
    if (Q >= $ || Z === 0)
        return;
    Z = Q + Z > $ ? $ - Q : Z;
    let K = $ - Z;
    for (q = Q; q < K; ++q)
        J[q] = J[q + Z];
    J.length = K
}
var wV = () => { }
    ;
var tY;
var eY = O(() => {
    wV();
    O6();
    tY = {
        allowChildren: !0,
        removeChildren(J = 0, Q) {
            let Z = Q ?? this.children.length
                , $ = Z - J
                , q = [];
            if ($ > 0 && $ <= Z) {
                for (let V = Z - 1; V >= J; V--) {
                    let z = this.children[V];
                    if (!z)
                        continue;
                    q.push(z),
                        z.parent = null
                }
                h1(this.children, J, Z);
                let K = this.renderGroup || this.parentRenderGroup;
                if (K)
                    K.removeChildren(q);
                for (let V = 0; V < q.length; ++V) {
                    let z = q[V];
                    z.parentRenderLayer?.detach(z),
                        this.emit("childRemoved", z, this, V),
                        q[V].emit("removed", this)
                }
                if (q.length > 0)
                    this._didViewChangeTick++;
                return q
            } else if ($ === 0 && this.children.length === 0)
                return q;
            throw new RangeError("removeChildren: numeric values are outside the acceptable range.")
        },
        removeChildAt(J) {
            let Q = this.getChildAt(J);
            return this.removeChild(Q)
        },
        getChildAt(J) {
            if (J < 0 || J >= this.children.length)
                throw new Error(`getChildAt: Index (${J}) does not exist.`);
            return this.children[J]
        },
        setChildIndex(J, Q) {
            if (Q < 0 || Q >= this.children.length)
                throw new Error(`The index ${Q} supplied is out of bounds ${this.children.length}`);
            this.getChildIndex(J),
                this.addChildAt(J, Q)
        },
        getChildIndex(J) {
            let Q = this.children.indexOf(J);
            if (Q === -1)
                throw new Error("The supplied Container must be a child of the caller");
            return Q
        },
        addChildAt(J, Q) {
            if (!this.allowChildren)
                c0(Y8, "addChildAt: Only Containers will be allowed to add children in v8.0.0");
            let { children: Z } = this;
            if (Q < 0 || Q > Z.length)
                throw new Error(`${J}addChildAt: The index ${Q} supplied is out of bounds ${Z.length}`);
            if (J.parent) {
                let q = J.parent.children.indexOf(J);
                if (J.parent === this && q === Q)
                    return J;
                if (q !== -1)
                    J.parent.children.splice(q, 1)
            }
            if (Q === Z.length)
                Z.push(J);
            else
                Z.splice(Q, 0, J);
            J.parent = this,
                J.didChange = !0,
                J._updateFlags = 15;
            let $ = this.renderGroup || this.parentRenderGroup;
            if ($)
                $.addChild(J);
            if (this.sortableChildren)
                this.sortDirty = !0;
            return this.emit("childAdded", J, this, Q),
                J.emit("added", this),
                J
        },
        swapChildren(J, Q) {
            if (J === Q)
                return;
            let Z = this.getChildIndex(J)
                , $ = this.getChildIndex(Q);
            this.children[Z] = Q,
                this.children[$] = J;
            let q = this.renderGroup || this.parentRenderGroup;
            if (q)
                q.structureDidChange = !0;
            this._didContainerChangeTick++
        },
        removeFromParent() {
            this.parent?.removeChild(this)
        },
        reparentChild(...J) {
            if (J.length === 1)
                return this.reparentChildAt(J[0], this.children.length);
            return J.forEach((Q) => this.reparentChildAt(Q, this.children.length)),
                J[0]
        },
        reparentChildAt(J, Q) {
            if (J.parent === this)
                return this.setChildIndex(J, Q),
                    J;
            let Z = J.worldTransform.clone();
            J.removeFromParent(),
                this.addChildAt(J, Q);
            let $ = this.worldTransform.clone();
            return $.invert(),
                Z.prepend($),
                J.setFromMatrix(Z),
                J
        },
        replaceChild(J, Q) {
            J.updateLocalTransform(),
                this.addChildAt(Q, this.getChildIndex(J)),
                Q.setFromMatrix(J.localTransform),
                Q.updateLocalTransform(),
                this.removeChild(J)
        }
    }
}
);
var JX;
var QX = O(() => {
    JX = {
        collectRenderables(J, Q, Z) {
            if (this.parentRenderLayer && this.parentRenderLayer !== Z || this.globalDisplayStatus < 7 || !this.includeInBuild)
                return;
            if (this.sortableChildren)
                this.sortChildren();
            if (this.isSimple)
                this.collectRenderablesSimple(J, Q, Z);
            else if (this.renderGroup)
                Q.renderPipes.renderGroup.addRenderGroup(this.renderGroup, J);
            else
                this.collectRenderablesWithEffects(J, Q, Z)
        },
        collectRenderablesSimple(J, Q, Z) {
            let $ = this.children
                , q = $.length;
            for (let K = 0; K < q; K++)
                $[K].collectRenderables(J, Q, Z)
        },
        collectRenderablesWithEffects(J, Q, Z) {
            let { renderPipes: $ } = Q;
            for (let q = 0; q < this.effects.length; q++) {
                let K = this.effects[q];
                $[K.pipe].push(K, this, J)
            }
            this.collectRenderablesSimple(J, Q, Z);
            for (let q = this.effects.length - 1; q >= 0; q--) {
                let K = this.effects[q];
                $[K.pipe].pop(K, this, J)
            }
        }
    }
}
);
class P9 {
    constructor() {
        this.pipe = "filter",
            this.priority = 1
    }
    destroy() {
        for (let J = 0; J < this.filters.length; J++)
            this.filters[J].destroy();
        this.filters = null,
            this.filterArea = null
    }
}
var x1 = () => { }
    ;
class ZX {
    constructor() {
        this._effectClasses = [],
            this._tests = [],
            this._initialized = !1
    }
    init() {
        if (this._initialized)
            return;
        this._initialized = !0,
            this._effectClasses.forEach((J) => {
                this.add({
                    test: J.test,
                    maskClass: J
                })
            }
            )
    }
    add(J) {
        this._tests.push(J)
    }
    getMaskEffect(J) {
        if (!this._initialized)
            this.init();
        for (let Q = 0; Q < this._tests.length; Q++) {
            let Z = this._tests[Q];
            if (Z.test(J))
                return V7.get(Z.maskClass, J)
        }
        return J
    }
    returnMaskEffect(J) {
        V7.return(J)
    }
}
var g1;
var jV = O(() => {
    w0();
    s5();
    g1 = new ZX;
    e0.handleByList(R.MaskEffect, g1._effectClasses)
}
);
var $X;
var qX = O(() => {
    x1();
    jV();
    $X = {
        _maskEffect: null,
        _maskOptions: {
            inverse: !1
        },
        _filterEffect: null,
        effects: [],
        _markStructureAsChanged() {
            let J = this.renderGroup || this.parentRenderGroup;
            if (J)
                J.structureDidChange = !0
        },
        addEffect(J) {
            if (this.effects.indexOf(J) !== -1)
                return;
            this.effects.push(J),
                this.effects.sort((Z, $) => Z.priority - $.priority),
                this._markStructureAsChanged(),
                this._updateIsSimple()
        },
        removeEffect(J) {
            let Q = this.effects.indexOf(J);
            if (Q === -1)
                return;
            this.effects.splice(Q, 1),
                this._markStructureAsChanged(),
                this._updateIsSimple()
        },
        set mask(J) {
            let Q = this._maskEffect;
            if (Q?.mask === J)
                return;
            if (Q)
                this.removeEffect(Q),
                    g1.returnMaskEffect(Q),
                    this._maskEffect = null;
            if (J === null || J === void 0)
                return;
            this._maskEffect = g1.getMaskEffect(J),
                this.addEffect(this._maskEffect)
        },
        get mask() {
            return this._maskEffect?.mask
        },
        setMask(J) {
            if (this._maskOptions = {
                ...this._maskOptions,
                ...J
            },
                J.mask)
                this.mask = J.mask;
            this._markStructureAsChanged()
        },
        set filters(J) {
            if (!Array.isArray(J) && J)
                J = [J];
            let Q = this._filterEffect || (this._filterEffect = new P9);
            J = J;
            let Z = J?.length > 0
                , $ = Q.filters?.length > 0
                , q = Z !== $;
            if (J = Array.isArray(J) ? J.slice(0) : J,
                Q.filters = Object.freeze(J),
                q)
                if (Z)
                    this.addEffect(Q);
                else
                    this.removeEffect(Q),
                        Q.filters = J ?? null
        },
        get filters() {
            return this._filterEffect?.filters
        },
        set filterArea(J) {
            this._filterEffect || (this._filterEffect = new P9),
                this._filterEffect.filterArea = J
        },
        get filterArea() {
            return this._filterEffect?.filterArea
        }
    }
}
);
var KX;
var VX = O(() => {
    O6();
    KX = {
        label: null,
        get name() {
            return c0(Y8, "Container.name property has been removed, use Container.label instead"),
                this.label
        },
        set name(J) {
            c0(Y8, "Container.name property has been removed, use Container.label instead"),
                this.label = J
        },
        getChildByName(J, Q = !1) {
            return this.getChildByLabel(J, Q)
        },
        getChildByLabel(J, Q = !1) {
            let Z = this.children;
            for (let $ = 0; $ < Z.length; $++) {
                let q = Z[$];
                if (q.label === J || J instanceof RegExp && J.test(q.label))
                    return q
            }
            if (Q)
                for (let $ = 0; $ < Z.length; $++) {
                    let K = Z[$].getChildByLabel(J, !0);
                    if (K)
                        return K
                }
            return null
        },
        getChildrenByLabel(J, Q = !1, Z = []) {
            let $ = this.children;
            for (let q = 0; q < $.length; q++) {
                let K = $[q];
                if (K.label === J || J instanceof RegExp && J.test(K.label))
                    Z.push(K)
            }
            if (Q)
                for (let q = 0; q < $.length; q++)
                    $[q].getChildrenByLabel(J, !0, Z);
            return Z
        }
    }
}
);
class v8 {
    constructor(J = 0, Q = 0, Z = 0, $ = 0) {
        this.type = "rectangle",
            this.x = Number(J),
            this.y = Number(Q),
            this.width = Number(Z),
            this.height = Number($)
    }
    get left() {
        return this.x
    }
    get right() {
        return this.x + this.width
    }
    get top() {
        return this.y
    }
    get bottom() {
        return this.y + this.height
    }
    isEmpty() {
        return this.left === this.right || this.top === this.bottom
    }
    static get EMPTY() {
        return new v8(0, 0, 0, 0)
    }
    clone() {
        return new v8(this.x, this.y, this.width, this.height)
    }
    copyFromBounds(J) {
        return this.x = J.minX,
            this.y = J.minY,
            this.width = J.maxX - J.minX,
            this.height = J.maxY - J.minY,
            this
    }
    copyFrom(J) {
        return this.x = J.x,
            this.y = J.y,
            this.width = J.width,
            this.height = J.height,
            this
    }
    copyTo(J) {
        return J.copyFrom(this),
            J
    }
    contains(J, Q) {
        if (this.width <= 0 || this.height <= 0)
            return !1;
        if (J >= this.x && J < this.x + this.width) {
            if (Q >= this.y && Q < this.y + this.height)
                return !0
        }
        return !1
    }
    strokeContains(J, Q, Z, $ = 0.5) {
        let { width: q, height: K } = this;
        if (q <= 0 || K <= 0)
            return !1;
        let V = this.x
            , z = this.y
            , W = Z * (1 - $)
            , H = Z - W
            , Y = V - W
            , U = V + q + W
            , N = z - W
            , j = z + K + W
            , k = V + H
            , L = V + q - H
            , F = z + H
            , P = z + K - H;
        return J >= Y && J <= U && Q >= N && Q <= j && !(J > k && J < L && Q > F && Q < P)
    }
    intersects(J, Q) {
        if (!Q) {
            let b = this.x < J.x ? J.x : this.x;
            if ((this.right > J.right ? J.right : this.right) <= b)
                return !1;
            let g = this.y < J.y ? J.y : this.y;
            return (this.bottom > J.bottom ? J.bottom : this.bottom) > g
        }
        let Z = this.left
            , $ = this.right
            , q = this.top
            , K = this.bottom;
        if ($ <= Z || K <= q)
            return !1;
        let V = zX[0].set(J.left, J.top)
            , z = zX[1].set(J.left, J.bottom)
            , W = zX[2].set(J.right, J.top)
            , H = zX[3].set(J.right, J.bottom);
        if (W.x <= V.x || z.y <= V.y)
            return !1;
        let Y = Math.sign(Q.a * Q.d - Q.b * Q.c);
        if (Y === 0)
            return !1;
        if (Q.apply(V, V),
            Q.apply(z, z),
            Q.apply(W, W),
            Q.apply(H, H),
            Math.max(V.x, z.x, W.x, H.x) <= Z || Math.min(V.x, z.x, W.x, H.x) >= $ || Math.max(V.y, z.y, W.y, H.y) <= q || Math.min(V.y, z.y, W.y, H.y) >= K)
            return !1;
        let U = Y * (z.y - V.y)
            , N = Y * (V.x - z.x)
            , j = U * Z + N * q
            , k = U * $ + N * q
            , L = U * Z + N * K
            , F = U * $ + N * K;
        if (Math.max(j, k, L, F) <= U * V.x + N * V.y || Math.min(j, k, L, F) >= U * H.x + N * H.y)
            return !1;
        let P = Y * (V.y - W.y)
            , M = Y * (W.x - V.x)
            , v = P * Z + M * q
            , E = P * $ + M * q
            , n = P * Z + M * K
            , u = P * $ + M * K;
        if (Math.max(v, E, n, u) <= P * V.x + M * V.y || Math.min(v, E, n, u) >= P * H.x + M * H.y)
            return !1;
        return !0
    }
    pad(J = 0, Q = J) {
        return this.x -= J,
            this.y -= Q,
            this.width += J * 2,
            this.height += Q * 2,
            this
    }
    fit(J) {
        let Q = Math.max(this.x, J.x)
            , Z = Math.min(this.x + this.width, J.x + J.width)
            , $ = Math.max(this.y, J.y)
            , q = Math.min(this.y + this.height, J.y + J.height);
        return this.x = Q,
            this.width = Math.max(Z - Q, 0),
            this.y = $,
            this.height = Math.max(q - $, 0),
            this
    }
    ceil(J = 1, Q = 0.001) {
        let Z = Math.ceil((this.x + this.width - Q) * J) / J
            , $ = Math.ceil((this.y + this.height - Q) * J) / J;
        return this.x = Math.floor((this.x + Q) * J) / J,
            this.y = Math.floor((this.y + Q) * J) / J,
            this.width = Z - this.x,
            this.height = $ - this.y,
            this
    }
    scale(J, Q = J) {
        return this.x *= J,
            this.y *= Q,
            this.width *= J,
            this.height *= Q,
            this
    }
    enlarge(J) {
        let Q = Math.min(this.x, J.x)
            , Z = Math.max(this.x + this.width, J.x + J.width)
            , $ = Math.min(this.y, J.y)
            , q = Math.max(this.y + this.height, J.y + J.height);
        return this.x = Q,
            this.width = Z - Q,
            this.y = $,
            this.height = q - $,
            this
    }
    getBounds(J) {
        return J || (J = new v8),
            J.copyFrom(this),
            J
    }
    containsRect(J) {
        if (this.width <= 0 || this.height <= 0)
            return !1;
        let { x: Q, y: Z } = J
            , $ = J.x + J.width
            , q = J.y + J.height;
        return Q >= this.x && Q < this.x + this.width && Z >= this.y && Z < this.y + this.height && $ >= this.x && $ < this.x + this.width && q >= this.y && q < this.y + this.height
    }
    set(J, Q, Z, $) {
        return this.x = J,
            this.y = Q,
            this.width = Z,
            this.height = $,
            this
    }
    toString() {
        return `[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`
    }
}
var zX;
var E7 = O(() => {
    cJ();
    zX = [new z6, new z6, new z6, new z6]
}
);
class E6 {
    constructor(J = 1 / 0, Q = 1 / 0, Z = -1 / 0, $ = -1 / 0) {
        this.minX = 1 / 0,
            this.minY = 1 / 0,
            this.maxX = -1 / 0,
            this.maxY = -1 / 0,
            this.matrix = xE,
            this.minX = J,
            this.minY = Q,
            this.maxX = Z,
            this.maxY = $
    }
    isEmpty() {
        return this.minX > this.maxX || this.minY > this.maxY
    }
    get rectangle() {
        if (!this._rectangle)
            this._rectangle = new v8;
        let J = this._rectangle;
        if (this.minX > this.maxX || this.minY > this.maxY)
            J.x = 0,
                J.y = 0,
                J.width = 0,
                J.height = 0;
        else
            J.copyFromBounds(this);
        return J
    }
    clear() {
        return this.minX = 1 / 0,
            this.minY = 1 / 0,
            this.maxX = -1 / 0,
            this.maxY = -1 / 0,
            this.matrix = xE,
            this
    }
    set(J, Q, Z, $) {
        this.minX = J,
            this.minY = Q,
            this.maxX = Z,
            this.maxY = $
    }
    addFrame(J, Q, Z, $, q) {
        q || (q = this.matrix);
        let { a: K, b: V, c: z, d: W, tx: H, ty: Y } = q
            , U = this.minX
            , N = this.minY
            , j = this.maxX
            , k = this.maxY
            , L = K * J + z * Q + H
            , F = V * J + W * Q + Y;
        if (L < U)
            U = L;
        if (F < N)
            N = F;
        if (L > j)
            j = L;
        if (F > k)
            k = F;
        if (L = K * Z + z * Q + H,
            F = V * Z + W * Q + Y,
            L < U)
            U = L;
        if (F < N)
            N = F;
        if (L > j)
            j = L;
        if (F > k)
            k = F;
        if (L = K * J + z * $ + H,
            F = V * J + W * $ + Y,
            L < U)
            U = L;
        if (F < N)
            N = F;
        if (L > j)
            j = L;
        if (F > k)
            k = F;
        if (L = K * Z + z * $ + H,
            F = V * Z + W * $ + Y,
            L < U)
            U = L;
        if (F < N)
            N = F;
        if (L > j)
            j = L;
        if (F > k)
            k = F;
        this.minX = U,
            this.minY = N,
            this.maxX = j,
            this.maxY = k
    }
    addRect(J, Q) {
        this.addFrame(J.x, J.y, J.x + J.width, J.y + J.height, Q)
    }
    addBounds(J, Q) {
        this.addFrame(J.minX, J.minY, J.maxX, J.maxY, Q)
    }
    addBoundsMask(J) {
        this.minX = this.minX > J.minX ? this.minX : J.minX,
            this.minY = this.minY > J.minY ? this.minY : J.minY,
            this.maxX = this.maxX < J.maxX ? this.maxX : J.maxX,
            this.maxY = this.maxY < J.maxY ? this.maxY : J.maxY
    }
    applyMatrix(J) {
        let Q = this.minX
            , Z = this.minY
            , $ = this.maxX
            , q = this.maxY
            , { a: K, b: V, c: z, d: W, tx: H, ty: Y } = J
            , U = K * Q + z * Z + H
            , N = V * Q + W * Z + Y;
        this.minX = U,
            this.minY = N,
            this.maxX = U,
            this.maxY = N,
            U = K * $ + z * Z + H,
            N = V * $ + W * Z + Y,
            this.minX = U < this.minX ? U : this.minX,
            this.minY = N < this.minY ? N : this.minY,
            this.maxX = U > this.maxX ? U : this.maxX,
            this.maxY = N > this.maxY ? N : this.maxY,
            U = K * Q + z * q + H,
            N = V * Q + W * q + Y,
            this.minX = U < this.minX ? U : this.minX,
            this.minY = N < this.minY ? N : this.minY,
            this.maxX = U > this.maxX ? U : this.maxX,
            this.maxY = N > this.maxY ? N : this.maxY,
            U = K * $ + z * q + H,
            N = V * $ + W * q + Y,
            this.minX = U < this.minX ? U : this.minX,
            this.minY = N < this.minY ? N : this.minY,
            this.maxX = U > this.maxX ? U : this.maxX,
            this.maxY = N > this.maxY ? N : this.maxY
    }
    fit(J) {
        if (this.minX < J.left)
            this.minX = J.left;
        if (this.maxX > J.right)
            this.maxX = J.right;
        if (this.minY < J.top)
            this.minY = J.top;
        if (this.maxY > J.bottom)
            this.maxY = J.bottom;
        return this
    }
    fitBounds(J, Q, Z, $) {
        if (this.minX < J)
            this.minX = J;
        if (this.maxX > Q)
            this.maxX = Q;
        if (this.minY < Z)
            this.minY = Z;
        if (this.maxY > $)
            this.maxY = $;
        return this
    }
    pad(J, Q = J) {
        return this.minX -= J,
            this.maxX += J,
            this.minY -= Q,
            this.maxY += Q,
            this
    }
    ceil() {
        return this.minX = Math.floor(this.minX),
            this.minY = Math.floor(this.minY),
            this.maxX = Math.ceil(this.maxX),
            this.maxY = Math.ceil(this.maxY),
            this
    }
    clone() {
        return new E6(this.minX, this.minY, this.maxX, this.maxY)
    }
    scale(J, Q = J) {
        return this.minX *= J,
            this.minY *= Q,
            this.maxX *= J,
            this.maxY *= Q,
            this
    }
    get x() {
        return this.minX
    }
    set x(J) {
        let Q = this.maxX - this.minX;
        this.minX = J,
            this.maxX = J + Q
    }
    get y() {
        return this.minY
    }
    set y(J) {
        let Q = this.maxY - this.minY;
        this.minY = J,
            this.maxY = J + Q
    }
    get width() {
        return this.maxX - this.minX
    }
    set width(J) {
        this.maxX = this.minX + J
    }
    get height() {
        return this.maxY - this.minY
    }
    set height(J) {
        this.maxY = this.minY + J
    }
    get left() {
        return this.minX
    }
    get right() {
        return this.maxX
    }
    get top() {
        return this.minY
    }
    get bottom() {
        return this.maxY
    }
    get isPositive() {
        return this.maxX - this.minX > 0 && this.maxY - this.minY > 0
    }
    get isValid() {
        return this.minX + this.minY !== 1 / 0
    }
    addVertexData(J, Q, Z, $) {
        let q = this.minX
            , K = this.minY
            , V = this.maxX
            , z = this.maxY;
        $ || ($ = this.matrix);
        let { a: W, b: H, c: Y, d: U, tx: N, ty: j } = $;
        for (let k = Q; k < Z; k += 2) {
            let L = J[k]
                , F = J[k + 1]
                , P = W * L + Y * F + N
                , M = H * L + U * F + j;
            q = P < q ? P : q,
                K = M < K ? M : K,
                V = P > V ? P : V,
                z = M > z ? M : z
        }
        this.minX = q,
            this.minY = K,
            this.maxX = V,
            this.maxY = z
    }
    containsPoint(J, Q) {
        if (this.minX <= J && this.minY <= Q && this.maxX >= J && this.maxY >= Q)
            return !0;
        return !1
    }
    toString() {
        return `[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`
    }
    copyFrom(J) {
        return this.minX = J.minX,
            this.minY = J.minY,
            this.maxX = J.maxX,
            this.maxY = J.maxY,
            this
    }
}
var xE;
var VJ = O(() => {
    Z6();
    E7();
    xE = new f0
}
);
var M7, dJ;
var HQ = O(() => {
    Z6();
    NV();
    VJ();
    M7 = new iQ(f0),
        dJ = new iQ(E6)
}
);
var Xx, WX;
var HX = O(() => {
    Z6();
    VJ();
    HQ();
    Xx = new f0,
        WX = {
            getFastGlobalBounds(J, Q) {
                if (Q || (Q = new E6),
                    Q.clear(),
                    this._getGlobalBoundsRecursive(!!J, Q, this.parentRenderLayer),
                    !Q.isValid)
                    Q.set(0, 0, 0, 0);
                let Z = this.renderGroup || this.parentRenderGroup;
                return Q.applyMatrix(Z.worldTransform),
                    Q
            },
            _getGlobalBoundsRecursive(J, Q, Z) {
                let $ = Q;
                if (J && this.parentRenderLayer && this.parentRenderLayer !== Z)
                    return;
                if (this.localDisplayStatus !== 7 || !this.measurable)
                    return;
                let q = !!this.effects.length;
                if (this.renderGroup || q)
                    $ = dJ.get().clear();
                if (this.boundsArea)
                    Q.addRect(this.boundsArea, this.worldTransform);
                else {
                    if (this.renderPipeId) {
                        let V = this.bounds;
                        $.addFrame(V.minX, V.minY, V.maxX, V.maxY, this.groupTransform)
                    }
                    let K = this.children;
                    for (let V = 0; V < K.length; V++)
                        K[V]._getGlobalBoundsRecursive(J, $, Z)
                }
                if (q) {
                    let K = !1
                        , V = this.renderGroup || this.parentRenderGroup;
                    for (let z = 0; z < this.effects.length; z++)
                        if (this.effects[z].addBounds) {
                            if (!K)
                                K = !0,
                                    $.applyMatrix(V.worldTransform);
                            this.effects[z].addBounds($, !0)
                        }
                    if (K)
                        $.applyMatrix(V.worldTransform.copyTo(Xx).invert());
                    Q.addBounds($),
                        dJ.return($)
                } else if (this.renderGroup)
                    Q.addBounds($, this.relativeGroupTransform),
                        dJ.return($)
            }
        }
}
);
function D9(J, Q, Z) {
    Z.clear();
    let $, q;
    if (J.parent)
        if (!Q)
            q = M7.get().identity(),
                $ = m1(J, q);
        else
            $ = J.parent.worldTransform;
    else
        $ = f0.IDENTITY;
    if (gE(J, Z, $, Q),
        q)
        M7.return(q);
    if (!Z.isValid)
        Z.set(0, 0, 0, 0);
    return Z
}
function gE(J, Q, Z, $) {
    if (!J.visible || !J.measurable)
        return;
    let q;
    if (!$)
        J.updateLocalTransform(),
            q = M7.get(),
            q.appendFrom(J.localTransform, Z);
    else
        q = J.worldTransform;
    let K = Q
        , V = !!J.effects.length;
    if (V)
        Q = dJ.get().clear();
    if (J.boundsArea)
        Q.addRect(J.boundsArea, q);
    else {
        if (J.bounds)
            Q.matrix = q,
                Q.addBounds(J.bounds);
        for (let z = 0; z < J.children.length; z++)
            gE(J.children[z], Q, q, $)
    }
    if (V) {
        for (let z = 0; z < J.effects.length; z++)
            J.effects[z].addBounds?.(Q);
        K.addBounds(Q, f0.IDENTITY),
            dJ.return(Q)
    }
    if (!$)
        M7.return(q)
}
function m1(J, Q) {
    let Z = J.parent;
    if (Z)
        m1(Z, Q),
            Z.updateLocalTransform(),
            Q.append(Z.localTransform);
    return Q
}
var aQ = O(() => {
    Z6();
    HQ()
}
);
function c1(J, Q) {
    if (J === 16777215 || !Q)
        return Q;
    if (Q === 16777215 || !J)
        return J;
    let Z = J >> 16 & 255
        , $ = J >> 8 & 255
        , q = J & 255
        , K = Q >> 16 & 255
        , V = Q >> 8 & 255
        , z = Q & 255
        , W = Z * K / 255 | 0
        , H = $ * V / 255 | 0
        , Y = q * z / 255 | 0;
    return (W << 16) + (H << 8) + Y
}
var BV = () => { }
    ;
function rQ(J, Q) {
    if (J === mE)
        return Q;
    if (Q === mE)
        return J;
    return c1(J, Q)
}
var mE = 16777215;
var kV = O(() => {
    BV()
}
);
function YQ(J) {
    return ((J & 255) << 16) + (J & 65280) + (J >> 16 & 255)
}
var YX;
var CV = O(() => {
    Z6();
    aQ();
    HQ();
    kV();
    YX = {
        getGlobalAlpha(J) {
            if (J) {
                if (this.renderGroup)
                    return this.renderGroup.worldAlpha;
                if (this.parentRenderGroup)
                    return this.parentRenderGroup.worldAlpha * this.alpha;
                return this.alpha
            }
            let Q = this.alpha
                , Z = this.parent;
            while (Z)
                Q *= Z.alpha,
                    Z = Z.parent;
            return Q
        },
        getGlobalTransform(J = new f0, Q) {
            if (Q)
                return J.copyFrom(this.worldTransform);
            this.updateLocalTransform();
            let Z = m1(this, M7.get().identity());
            return J.appendFrom(this.localTransform, Z),
                M7.return(Z),
                J
        },
        getGlobalTint(J) {
            if (J) {
                if (this.renderGroup)
                    return YQ(this.renderGroup.worldColor);
                if (this.parentRenderGroup)
                    return YQ(rQ(this.localColor, this.parentRenderGroup.worldColor));
                return this.tint
            }
            let Q = this.localColor
                , Z = this.parent;
            while (Z)
                Q = rQ(Q, Z.localColor),
                    Z = Z.parent;
            return YQ(Q)
        }
    }
}
);
function tQ(J, Q, Z) {
    if (Q.clear(),
        Z || (Z = f0.IDENTITY),
        cE(J, Q, Z, J, !0),
        !Q.isValid)
        Q.set(0, 0, 0, 0);
    return Q
}
function cE(J, Q, Z, $, q) {
    let K;
    if (!q) {
        if (!J.visible || !J.measurable)
            return;
        J.updateLocalTransform();
        let W = J.localTransform;
        K = M7.get(),
            K.appendFrom(W, Z)
    } else
        K = M7.get(),
            K = Z.copyTo(K);
    let V = Q
        , z = !!J.effects.length;
    if (z)
        Q = dJ.get().clear();
    if (J.boundsArea)
        Q.addRect(J.boundsArea, K);
    else {
        if (J.renderPipeId)
            Q.matrix = K,
                Q.addBounds(J.bounds);
        let W = J.children;
        for (let H = 0; H < W.length; H++)
            cE(W[H], Q, K, $, !1)
    }
    if (z) {
        for (let W = 0; W < J.effects.length; W++)
            J.effects[W].addLocalBounds?.(Q, $);
        V.addBounds(Q, f0.IDENTITY),
            dJ.return(Q)
    }
    M7.return(K)
}
var d1 = O(() => {
    Z6();
    HQ()
}
);
function OV(J, Q) {
    let Z = J.children;
    for (let $ = 0; $ < Z.length; $++) {
        let q = Z[$]
            , K = q.uid
            , V = (q._didViewChangeTick & 65535) << 16 | q._didContainerChangeTick & 65535
            , z = Q.index;
        if (Q.data[z] !== K || Q.data[z + 1] !== V)
            Q.data[Q.index] = K,
                Q.data[Q.index + 1] = V,
                Q.didChange = !0;
        if (Q.index = z + 2,
            q.children.length)
            OV(q, Q)
    }
    return Q.didChange
}
var XX = () => { }
    ;
var Ux, UX;
var NX = O(() => {
    Z6();
    VJ();
    aQ();
    d1();
    XX();
    Ux = new f0,
        UX = {
            _localBoundsCacheId: -1,
            _localBoundsCacheData: null,
            _setWidth(J, Q) {
                let Z = Math.sign(this.scale.x) || 1;
                if (Q !== 0)
                    this.scale.x = J / Q * Z;
                else
                    this.scale.x = Z
            },
            _setHeight(J, Q) {
                let Z = Math.sign(this.scale.y) || 1;
                if (Q !== 0)
                    this.scale.y = J / Q * Z;
                else
                    this.scale.y = Z
            },
            getLocalBounds() {
                if (!this._localBoundsCacheData)
                    this._localBoundsCacheData = {
                        data: [],
                        index: 1,
                        didChange: !1,
                        localBounds: new E6
                    };
                let J = this._localBoundsCacheData;
                if (J.index = 1,
                    J.didChange = !1,
                    J.data[0] !== this._didViewChangeTick)
                    J.didChange = !0,
                        J.data[0] = this._didViewChangeTick;
                if (OV(this, J),
                    J.didChange)
                    tQ(this, J.localBounds, Ux);
                return J.localBounds
            },
            getBounds(J, Q) {
                return D9(this, J, Q || new E6)
            }
        }
}
);
var wX;
var jX = O(() => {
    wX = {
        _onRender: null,
        set onRender(J) {
            let Q = this.renderGroup || this.parentRenderGroup;
            if (!J) {
                if (this._onRender)
                    Q?.removeOnRender(this);
                this._onRender = null;
                return
            }
            if (!this._onRender)
                Q?.addOnRender(this);
            this._onRender = J
        },
        get onRender() {
            return this._onRender
        }
    }
}
);
function Nx(J, Q) {
    return J._zIndex - Q._zIndex
}
var BX;
var kX = O(() => {
    BX = {
        _zIndex: 0,
        sortDirty: !1,
        sortableChildren: !1,
        get zIndex() {
            return this._zIndex
        },
        set zIndex(J) {
            if (this._zIndex === J)
                return;
            this._zIndex = J,
                this.depthOfChildModified()
        },
        depthOfChildModified() {
            if (this.parent)
                this.parent.sortableChildren = !0,
                    this.parent.sortDirty = !0;
            if (this.parentRenderGroup)
                this.parentRenderGroup.structureDidChange = !0
        },
        sortChildren() {
            if (!this.sortDirty)
                return;
            this.sortDirty = !1,
                this.children.sort(Nx)
        }
    }
}
);
var CX;
var OX = O(() => {
    cJ();
    HQ();
    CX = {
        getGlobalPosition(J = new z6, Q = !1) {
            if (this.parent)
                this.parent.toGlobal(this._position, J, Q);
            else
                J.x = this._position.x,
                    J.y = this._position.y;
            return J
        },
        toGlobal(J, Q, Z = !1) {
            let $ = this.getGlobalTransform(M7.get(), Z);
            return Q = $.apply(J, Q),
                M7.return($),
                Q
        },
        toLocal(J, Q, Z, $) {
            if (Q)
                J = Q.toGlobal(J, Z, $);
            let q = this.getGlobalTransform(M7.get(), $);
            return Z = q.applyInverse(J, Z),
                M7.return(q),
                Z
        }
    }
}
);
class Z$ {
    constructor() {
        this.uid = i8("instructionSet"),
            this.instructions = [],
            this.instructionSize = 0,
            this.renderables = [],
            this.gcTick = 0
    }
    reset() {
        this.instructionSize = 0
    }
    add(J) {
        this.instructions[this.instructionSize++] = J
    }
    log() {
        this.instructions.length = this.instructionSize
    }
}
var IV = O(() => {
    l7()
}
);
function i5(J) {
    return J += J === 0 ? 1 : 0,
        --J,
        J |= J >>> 1,
        J |= J >>> 2,
        J |= J >>> 4,
        J |= J >>> 8,
        J |= J >>> 16,
        J + 1
}
function LV(J) {
    return !(J & J - 1) && !!J
}
var $$ = () => { }
    ;
function J5(J) {
    let Q = {};
    for (let Z in J)
        if (J[Z] !== void 0)
            Q[Z] = J[Z];
    return Q
}
var XQ = () => { }
    ;
function wx(J) {
    let Q = dE[J];
    if (Q === void 0)
        dE[J] = i8("resource");
    return Q
}
var dE, pE, o7;
var A9 = O(() => {
    wJ();
    l7();
    O6();
    dE = Object.create(null);
    pE = class J extends o6 {
        constructor(Q = {}) {
            super();
            this._resourceType = "textureSampler",
                this._touched = 0,
                this._maxAnisotropy = 1,
                this.destroyed = !1,
                Q = {
                    ...J.defaultOptions,
                    ...Q
                },
                this.addressMode = Q.addressMode,
                this.addressModeU = Q.addressModeU ?? this.addressModeU,
                this.addressModeV = Q.addressModeV ?? this.addressModeV,
                this.addressModeW = Q.addressModeW ?? this.addressModeW,
                this.scaleMode = Q.scaleMode,
                this.magFilter = Q.magFilter ?? this.magFilter,
                this.minFilter = Q.minFilter ?? this.minFilter,
                this.mipmapFilter = Q.mipmapFilter ?? this.mipmapFilter,
                this.lodMinClamp = Q.lodMinClamp,
                this.lodMaxClamp = Q.lodMaxClamp,
                this.compare = Q.compare,
                this.maxAnisotropy = Q.maxAnisotropy ?? 1
        }
        set addressMode(Q) {
            this.addressModeU = Q,
                this.addressModeV = Q,
                this.addressModeW = Q
        }
        get addressMode() {
            return this.addressModeU
        }
        set wrapMode(Q) {
            c0(Y8, "TextureStyle.wrapMode is now TextureStyle.addressMode"),
                this.addressMode = Q
        }
        get wrapMode() {
            return this.addressMode
        }
        set scaleMode(Q) {
            this.magFilter = Q,
                this.minFilter = Q,
                this.mipmapFilter = Q
        }
        get scaleMode() {
            return this.magFilter
        }
        set maxAnisotropy(Q) {
            if (this._maxAnisotropy = Math.min(Q, 16),
                this._maxAnisotropy > 1)
                this.scaleMode = "linear"
        }
        get maxAnisotropy() {
            return this._maxAnisotropy
        }
        get _resourceId() {
            return this._sharedResourceId || this._generateResourceId()
        }
        update() {
            this.emit("change", this),
                this._sharedResourceId = null
        }
        _generateResourceId() {
            let Q = `${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;
            return this._sharedResourceId = wx(Q),
                this._resourceId
        }
        destroy() {
            this.destroyed = !0,
                this.emit("destroy", this),
                this.emit("change", this),
                this.removeAllListeners()
        }
    }
        ;
    pE.defaultOptions = {
        addressMode: "clamp-to-edge",
        scaleMode: "linear"
    };
    o7 = pE
}
);
var uE, $6;
var n7 = O(() => {
    wJ();
    $$();
    XQ();
    l7();
    A9();
    uE = class J extends o6 {
        constructor(Q = {}) {
            super();
            if (this.options = Q,
                this.uid = i8("textureSource"),
                this._resourceType = "textureSource",
                this._resourceId = i8("resource"),
                this.uploadMethodId = "unknown",
                this._resolution = 1,
                this.pixelWidth = 1,
                this.pixelHeight = 1,
                this.width = 1,
                this.height = 1,
                this.sampleCount = 1,
                this.mipLevelCount = 1,
                this.autoGenerateMipmaps = !1,
                this.format = "rgba8unorm",
                this.dimension = "2d",
                this.antialias = !1,
                this._touched = 0,
                this._batchTick = -1,
                this._textureBindLocation = -1,
                Q = {
                    ...J.defaultOptions,
                    ...Q
                },
                this.label = Q.label ?? "",
                this.resource = Q.resource,
                this.autoGarbageCollect = Q.autoGarbageCollect,
                this._resolution = Q.resolution,
                Q.width)
                this.pixelWidth = Q.width * this._resolution;
            else
                this.pixelWidth = this.resource ? this.resourceWidth ?? 1 : 1;
            if (Q.height)
                this.pixelHeight = Q.height * this._resolution;
            else
                this.pixelHeight = this.resource ? this.resourceHeight ?? 1 : 1;
            this.width = this.pixelWidth / this._resolution,
                this.height = this.pixelHeight / this._resolution,
                this.format = Q.format,
                this.dimension = Q.dimensions,
                this.mipLevelCount = Q.mipLevelCount,
                this.autoGenerateMipmaps = Q.autoGenerateMipmaps,
                this.sampleCount = Q.sampleCount,
                this.antialias = Q.antialias,
                this.alphaMode = Q.alphaMode,
                this.style = new o7(J5(Q)),
                this.destroyed = !1,
                this._refreshPOT()
        }
        get source() {
            return this
        }
        get style() {
            return this._style
        }
        set style(Q) {
            if (this.style === Q)
                return;
            this._style?.off("change", this._onStyleChange, this),
                this._style = Q,
                this._style?.on("change", this._onStyleChange, this),
                this._onStyleChange()
        }
        set maxAnisotropy(Q) {
            this._style.maxAnisotropy = Q
        }
        get maxAnisotropy() {
            return this._style.maxAnisotropy
        }
        get addressMode() {
            return this._style.addressMode
        }
        set addressMode(Q) {
            this._style.addressMode = Q
        }
        get repeatMode() {
            return this._style.addressMode
        }
        set repeatMode(Q) {
            this._style.addressMode = Q
        }
        get magFilter() {
            return this._style.magFilter
        }
        set magFilter(Q) {
            this._style.magFilter = Q
        }
        get minFilter() {
            return this._style.minFilter
        }
        set minFilter(Q) {
            this._style.minFilter = Q
        }
        get mipmapFilter() {
            return this._style.mipmapFilter
        }
        set mipmapFilter(Q) {
            this._style.mipmapFilter = Q
        }
        get lodMinClamp() {
            return this._style.lodMinClamp
        }
        set lodMinClamp(Q) {
            this._style.lodMinClamp = Q
        }
        get lodMaxClamp() {
            return this._style.lodMaxClamp
        }
        set lodMaxClamp(Q) {
            this._style.lodMaxClamp = Q
        }
        _onStyleChange() {
            this.emit("styleChange", this)
        }
        update() {
            if (this.resource) {
                let Q = this._resolution;
                if (this.resize(this.resourceWidth / Q, this.resourceHeight / Q))
                    return
            }
            this.emit("update", this)
        }
        destroy() {
            if (this.destroyed = !0,
                this.emit("destroy", this),
                this.emit("change", this),
                this._style)
                this._style.destroy(),
                    this._style = null;
            this.uploadMethodId = null,
                this.resource = null,
                this.removeAllListeners()
        }
        unload() {
            this._resourceId = i8("resource"),
                this.emit("change", this),
                this.emit("unload", this)
        }
        get resourceWidth() {
            let { resource: Q } = this;
            return Q.naturalWidth || Q.videoWidth || Q.displayWidth || Q.width
        }
        get resourceHeight() {
            let { resource: Q } = this;
            return Q.naturalHeight || Q.videoHeight || Q.displayHeight || Q.height
        }
        get resolution() {
            return this._resolution
        }
        set resolution(Q) {
            if (this._resolution === Q)
                return;
            this._resolution = Q,
                this.width = this.pixelWidth / Q,
                this.height = this.pixelHeight / Q
        }
        resize(Q, Z, $) {
            $ || ($ = this._resolution),
                Q || (Q = this.width),
                Z || (Z = this.height);
            let q = Math.round(Q * $)
                , K = Math.round(Z * $);
            if (this.width = q / $,
                this.height = K / $,
                this._resolution = $,
                this.pixelWidth === q && this.pixelHeight === K)
                return !1;
            return this._refreshPOT(),
                this.pixelWidth = q,
                this.pixelHeight = K,
                this.emit("resize", this),
                this._resourceId = i8("resource"),
                this.emit("change", this),
                !0
        }
        updateMipmaps() {
            if (this.autoGenerateMipmaps && this.mipLevelCount > 1)
                this.emit("updateMipmaps", this)
        }
        set wrapMode(Q) {
            this._style.wrapMode = Q
        }
        get wrapMode() {
            return this._style.wrapMode
        }
        set scaleMode(Q) {
            this._style.scaleMode = Q
        }
        get scaleMode() {
            return this._style.scaleMode
        }
        _refreshPOT() {
            this.isPowerOfTwo = LV(this.pixelWidth) && LV(this.pixelHeight)
        }
        static test(Q) {
            throw new Error("Unimplemented")
        }
    }
        ;
    uE.defaultOptions = {
        resolution: 1,
        format: "bgra8unorm",
        alphaMode: "premultiply-alpha-on-upload",
        dimensions: "2d",
        mipLevelCount: 1,
        autoGenerateMipmaps: !1,
        sampleCount: 1,
        antialias: !1,
        autoGarbageCollect: !1
    };
    $6 = uE
}
);
function jx() {
    for (let J = 0; J < 16; J++) {
        let Q = [];
        XF.push(Q);
        for (let Z = 0; Z < 16; Z++) {
            let $ = IX(q$[J] * q$[Z] + V$[J] * K$[Z])
                , q = IX(K$[J] * q$[Z] + z$[J] * K$[Z])
                , K = IX(q$[J] * V$[Z] + V$[J] * z$[Z])
                , V = IX(K$[J] * V$[Z] + z$[J] * z$[Z]);
            for (let z = 0; z < 16; z++)
                if (q$[z] === $ && K$[z] === q && V$[z] === K && z$[z] === V) {
                    Q.push(z);
                    break
                }
        }
    }
    for (let J = 0; J < 16; J++) {
        let Q = new f0;
        Q.set(q$[J], K$[J], V$[J], z$[J], 0, 0),
            lE.push(Q)
    }
}
var q$, K$, V$, z$, XF, lE, IX, b6;
var p1 = O(() => {
    Z6();
    q$ = [1, 1, 0, -1, -1, -1, 0, 1, 1, 1, 0, -1, -1, -1, 0, 1],
        K$ = [0, 1, 1, 1, 0, -1, -1, -1, 0, 1, 1, 1, 0, -1, -1, -1],
        V$ = [0, -1, -1, -1, 0, 1, 1, 1, 0, 1, 1, 1, 0, -1, -1, -1],
        z$ = [1, 1, 0, -1, -1, -1, 0, 1, -1, -1, 0, 1, 1, 1, 0, -1],
        XF = [],
        lE = [],
        IX = Math.sign;
    jx();
    b6 = {
        E: 0,
        SE: 1,
        S: 2,
        SW: 3,
        W: 4,
        NW: 5,
        N: 6,
        NE: 7,
        MIRROR_VERTICAL: 8,
        MAIN_DIAGONAL: 10,
        MIRROR_HORIZONTAL: 12,
        REVERSE_DIAGONAL: 14,
        uX: (J) => q$[J],
        uY: (J) => K$[J],
        vX: (J) => V$[J],
        vY: (J) => z$[J],
        inv: (J) => {
            if (J & 8)
                return J & 15;
            return -J & 7
        }
        ,
        add: (J, Q) => XF[J][Q],
        sub: (J, Q) => XF[J][b6.inv(Q)],
        rotate180: (J) => J ^ 4,
        isVertical: (J) => (J & 3) === 2,
        byDirection: (J, Q) => {
            if (Math.abs(J) * 2 <= Math.abs(Q)) {
                if (Q >= 0)
                    return b6.S;
                return b6.N
            } else if (Math.abs(Q) * 2 <= Math.abs(J)) {
                if (J > 0)
                    return b6.E;
                return b6.W
            } else if (Q > 0) {
                if (J > 0)
                    return b6.SE;
                return b6.SW
            } else if (J > 0)
                return b6.NE;
            return b6.NW
        }
        ,
        matrixAppendRotationInv: (J, Q, Z = 0, $ = 0) => {
            let q = lE[b6.inv(Q)];
            q.tx = Z,
                q.ty = $,
                J.append(q)
        }
        ,
        transformRectCoords: (J, Q, Z, $) => {
            let { x: q, y: K, width: V, height: z } = J
                , { x: W, y: H, width: Y, height: U } = Q;
            if (Z === b6.E)
                return $.set(q + W, K + H, V, z),
                    $;
            else if (Z === b6.S)
                return $.set(Y - K - z + W, q + H, z, V);
            else if (Z === b6.W)
                return $.set(Y - q - V + W, U - K - z + H, V, z);
            else if (Z === b6.N)
                return $.set(K + W, U - q - V + H, z, V);
            return $.set(q + W, K + H, V, z)
        }
    }
}
);
var FV = () => { }
    ;
var LX = () => { }
    ;
var eQ;
var GV = O(() => {
    w0();
    n7();
    eQ = class eQ extends $6 {
        constructor(J) {
            let Q = J.resource || new Float32Array(J.width * J.height * 4)
                , Z = J.format;
            if (!Z)
                if (Q instanceof Float32Array)
                    Z = "rgba32float";
                else if (Q instanceof Int32Array)
                    Z = "rgba32uint";
                else if (Q instanceof Uint32Array)
                    Z = "rgba32uint";
                else if (Q instanceof Int16Array)
                    Z = "rgba16uint";
                else if (Q instanceof Uint16Array)
                    Z = "rgba16uint";
                else if (Q instanceof Int8Array)
                    Z = "bgra8unorm";
                else
                    Z = "bgra8unorm";
            super({
                ...J,
                resource: Q,
                format: Z
            });
            this.uploadMethodId = "buffer"
        }
        static test(J) {
            return J instanceof Int8Array || J instanceof Uint8Array || J instanceof Uint8ClampedArray || J instanceof Int16Array || J instanceof Uint16Array || J instanceof Int32Array || J instanceof Uint32Array || J instanceof Float32Array
        }
    }
        ;
    eQ.extension = R.TextureSource
}
);
class W$ {
    constructor(J, Q) {
        if (this.mapCoord = new f0,
            this.uClampFrame = new Float32Array(4),
            this.uClampOffset = new Float32Array(2),
            this._textureID = -1,
            this._updateID = 0,
            this.clampOffset = 0,
            typeof Q === "undefined")
            this.clampMargin = J.width < 10 ? 0 : 0.5;
        else
            this.clampMargin = Q;
        this.isSimple = !1,
            this.texture = J
    }
    get texture() {
        return this._texture
    }
    set texture(J) {
        if (this.texture === J)
            return;
        this._texture?.removeListener("update", this.update, this),
            this._texture = J,
            this._texture.addListener("update", this.update, this),
            this.update()
    }
    multiplyUvs(J, Q) {
        if (Q === void 0)
            Q = J;
        let Z = this.mapCoord;
        for (let $ = 0; $ < J.length; $ += 2) {
            let q = J[$]
                , K = J[$ + 1];
            Q[$] = q * Z.a + K * Z.c + Z.tx,
                Q[$ + 1] = q * Z.b + K * Z.d + Z.ty
        }
        return Q
    }
    update() {
        let J = this._texture;
        this._updateID++;
        let Q = J.uvs;
        this.mapCoord.set(Q.x1 - Q.x0, Q.y1 - Q.y0, Q.x3 - Q.x0, Q.y3 - Q.y0, Q.x0, Q.y0);
        let { orig: Z, trim: $ } = J;
        if ($)
            oE.set(Z.width / $.width, 0, 0, Z.height / $.height, -$.x / $.width, -$.y / $.height),
                this.mapCoord.append(oE);
        let q = J.source
            , K = this.uClampFrame
            , V = this.clampMargin / q._resolution
            , z = this.clampOffset / q._resolution;
        return K[0] = (J.frame.x + V + z) / q.width,
            K[1] = (J.frame.y + V + z) / q.height,
            K[2] = (J.frame.x + J.frame.width - V + z) / q.width,
            K[3] = (J.frame.y + J.frame.height - V + z) / q.height,
            this.uClampOffset[0] = this.clampOffset / q.pixelWidth,
            this.uClampOffset[1] = this.clampOffset / q.pixelHeight,
            this.isSimple = J.frame.width === q.width && J.frame.height === q.height && J.rotate === 0,
            !0
    }
}
var oE;
var PV = O(() => {
    Z6();
    oE = new f0
}
);
var _0;
var W6 = O(() => {
    wJ();
    p1();
    E7();
    l7();
    O6();
    LX();
    GV();
    n7();
    PV();
    _0 = class _0 extends o6 {
        constructor({ source: J, label: Q, frame: Z, orig: $, trim: q, defaultAnchor: K, defaultBorders: V, rotate: z, dynamic: W } = {}) {
            super();
            if (this.uid = i8("texture"),
                this.uvs = {
                    x0: 0,
                    y0: 0,
                    x1: 0,
                    y1: 0,
                    x2: 0,
                    y2: 0,
                    x3: 0,
                    y3: 0
                },
                this.frame = new v8,
                this.noFrame = !1,
                this.dynamic = !1,
                this.isTexture = !0,
                this.label = Q,
                this.source = J?.source ?? new $6,
                this.noFrame = !Z,
                Z)
                this.frame.copyFrom(Z);
            else {
                let { width: H, height: Y } = this._source;
                this.frame.width = H,
                    this.frame.height = Y
            }
            this.orig = $ || this.frame,
                this.trim = q,
                this.rotate = z ?? 0,
                this.defaultAnchor = K,
                this.defaultBorders = V,
                this.destroyed = !1,
                this.dynamic = W || !1,
                this.updateUvs()
        }
        set source(J) {
            if (this._source)
                this._source.off("resize", this.update, this);
            this._source = J,
                J.on("resize", this.update, this),
                this.emit("update", this)
        }
        get source() {
            return this._source
        }
        get textureMatrix() {
            if (!this._textureMatrix)
                this._textureMatrix = new W$(this);
            return this._textureMatrix
        }
        get width() {
            return this.orig.width
        }
        get height() {
            return this.orig.height
        }
        updateUvs() {
            let { uvs: J, frame: Q } = this
                , { width: Z, height: $ } = this._source
                , q = Q.x / Z
                , K = Q.y / $
                , V = Q.width / Z
                , z = Q.height / $
                , W = this.rotate;
            if (W) {
                let H = V / 2
                    , Y = z / 2
                    , U = q + H
                    , N = K + Y;
                W = b6.add(W, b6.NW),
                    J.x0 = U + H * b6.uX(W),
                    J.y0 = N + Y * b6.uY(W),
                    W = b6.add(W, 2),
                    J.x1 = U + H * b6.uX(W),
                    J.y1 = N + Y * b6.uY(W),
                    W = b6.add(W, 2),
                    J.x2 = U + H * b6.uX(W),
                    J.y2 = N + Y * b6.uY(W),
                    W = b6.add(W, 2),
                    J.x3 = U + H * b6.uX(W),
                    J.y3 = N + Y * b6.uY(W)
            } else
                J.x0 = q,
                    J.y0 = K,
                    J.x1 = q + V,
                    J.y1 = K,
                    J.x2 = q + V,
                    J.y2 = K + z,
                    J.x3 = q,
                    J.y3 = K + z
        }
        destroy(J = !1) {
            if (this._source) {
                if (J)
                    this._source.destroy(),
                        this._source = null
            }
            this._textureMatrix = null,
                this.destroyed = !0,
                this.emit("destroy", this),
                this.removeAllListeners()
        }
        update() {
            if (this.noFrame)
                this.frame.width = this._source.width,
                    this.frame.height = this._source.height;
            this.updateUvs(),
                this.emit("update", this)
        }
        get baseTexture() {
            return c0(Y8, "Texture.baseTexture is now Texture.source"),
                this._source
        }
    }
        ;
    _0.EMPTY = new _0({
        label: "EMPTY",
        source: new $6({
            label: "EMPTY"
        })
    });
    _0.EMPTY.destroy = FV;
    _0.WHITE = new _0({
        source: new eQ({
            resource: new Uint8Array([255, 255, 255, 255]),
            width: 1,
            height: 1,
            alphaMode: "premultiply-alpha-on-upload",
            label: "WHITE"
        }),
        label: "WHITE"
    });
    _0.WHITE.destroy = FV
}
);
class FX {
    constructor(J) {
        this._poolKeyHash = Object.create(null),
            this._texturePool = {},
            this.textureOptions = J || {},
            this.enableFullScreen = !1,
            this.textureStyle = new o7(this.textureOptions)
    }
    createTexture(J, Q, Z) {
        let $ = new $6({
            ...this.textureOptions,
            width: J,
            height: Q,
            resolution: 1,
            antialias: Z,
            autoGarbageCollect: !1
        });
        return new _0({
            source: $,
            label: `texturePool_${Bx++}`
        })
    }
    getOptimalTexture(J, Q, Z = 1, $) {
        let q = Math.ceil(J * Z - 0.000001)
            , K = Math.ceil(Q * Z - 0.000001);
        q = i5(q),
            K = i5(K);
        let V = (q << 17) + (K << 1) + ($ ? 1 : 0);
        if (!this._texturePool[V])
            this._texturePool[V] = [];
        let z = this._texturePool[V].pop();
        if (!z)
            z = this.createTexture(q, K, $);
        return z.source._resolution = Z,
            z.source.width = q / Z,
            z.source.height = K / Z,
            z.source.pixelWidth = q,
            z.source.pixelHeight = K,
            z.frame.x = 0,
            z.frame.y = 0,
            z.frame.width = J,
            z.frame.height = Q,
            z.updateUvs(),
            this._poolKeyHash[z.uid] = V,
            z
    }
    getSameSizeTexture(J, Q = !1) {
        let Z = J.source;
        return this.getOptimalTexture(J.width, J.height, Z._resolution, Q)
    }
    returnTexture(J, Q = !1) {
        let Z = this._poolKeyHash[J.uid];
        if (Q)
            J.source.style = this.textureStyle;
        this._texturePool[Z].push(J)
    }
    clear(J) {
        if (J = J !== !1,
            J)
            for (let Q in this._texturePool) {
                let Z = this._texturePool[Q];
                if (Z)
                    for (let $ = 0; $ < Z.length; $++)
                        Z[$].destroy(!0)
            }
        this._texturePool = {}
    }
}
var Bx = 0, m6;
var E5 = O(() => {
    $$();
    n7();
    W6();
    A9();
    m6 = new FX
}
);
class DV {
    constructor() {
        this.renderPipeId = "renderGroup",
            this.root = null,
            this.canBundle = !1,
            this.renderGroupParent = null,
            this.renderGroupChildren = [],
            this.worldTransform = new f0,
            this.worldColorAlpha = 4294967295,
            this.worldColor = 16777215,
            this.worldAlpha = 1,
            this.childrenToUpdate = Object.create(null),
            this.updateTick = 0,
            this.gcTick = 0,
            this.childrenRenderablesToUpdate = {
                list: [],
                index: 0
            },
            this.structureDidChange = !0,
            this.instructionSet = new Z$,
            this._onRenderContainers = [],
            this.textureNeedsUpdate = !0,
            this.isCachedAsTexture = !1,
            this._matrixDirty = 7
    }
    init(J) {
        if (this.root = J,
            J._onRender)
            this.addOnRender(J);
        J.didChange = !0;
        let Q = J.children;
        for (let Z = 0; Z < Q.length; Z++) {
            let $ = Q[Z];
            $._updateFlags = 15,
                this.addChild($)
        }
    }
    enableCacheAsTexture(J = {}) {
        this.textureOptions = J,
            this.isCachedAsTexture = !0,
            this.textureNeedsUpdate = !0
    }
    disableCacheAsTexture() {
        if (this.isCachedAsTexture = !1,
            this.texture)
            m6.returnTexture(this.texture),
                this.texture = null
    }
    updateCacheTexture() {
        this.textureNeedsUpdate = !0
    }
    reset() {
        this.renderGroupChildren.length = 0;
        for (let J in this.childrenToUpdate) {
            let Q = this.childrenToUpdate[J];
            Q.list.fill(null),
                Q.index = 0
        }
        this.childrenRenderablesToUpdate.index = 0,
            this.childrenRenderablesToUpdate.list.fill(null),
            this.root = null,
            this.updateTick = 0,
            this.structureDidChange = !0,
            this._onRenderContainers.length = 0,
            this.renderGroupParent = null,
            this.disableCacheAsTexture()
    }
    get localTransform() {
        return this.root.localTransform
    }
    addRenderGroupChild(J) {
        if (J.renderGroupParent)
            J.renderGroupParent._removeRenderGroupChild(J);
        J.renderGroupParent = this,
            this.renderGroupChildren.push(J)
    }
    _removeRenderGroupChild(J) {
        let Q = this.renderGroupChildren.indexOf(J);
        if (Q > -1)
            this.renderGroupChildren.splice(Q, 1);
        J.renderGroupParent = null
    }
    addChild(J) {
        if (this.structureDidChange = !0,
            J.parentRenderGroup = this,
            J.updateTick = -1,
            J.parent === this.root)
            J.relativeRenderGroupDepth = 1;
        else
            J.relativeRenderGroupDepth = J.parent.relativeRenderGroupDepth + 1;
        if (J.didChange = !0,
            this.onChildUpdate(J),
            J.renderGroup) {
            this.addRenderGroupChild(J.renderGroup);
            return
        }
        if (J._onRender)
            this.addOnRender(J);
        let Q = J.children;
        for (let Z = 0; Z < Q.length; Z++)
            this.addChild(Q[Z])
    }
    removeChild(J) {
        if (this.structureDidChange = !0,
            J._onRender) {
            if (!J.renderGroup)
                this.removeOnRender(J)
        }
        if (J.parentRenderGroup = null,
            J.renderGroup) {
            this._removeRenderGroupChild(J.renderGroup);
            return
        }
        let Q = J.children;
        for (let Z = 0; Z < Q.length; Z++)
            this.removeChild(Q[Z])
    }
    removeChildren(J) {
        for (let Q = 0; Q < J.length; Q++)
            this.removeChild(J[Q])
    }
    onChildUpdate(J) {
        let Q = this.childrenToUpdate[J.relativeRenderGroupDepth];
        if (!Q)
            Q = this.childrenToUpdate[J.relativeRenderGroupDepth] = {
                index: 0,
                list: []
            };
        Q.list[Q.index++] = J
    }
    updateRenderable(J) {
        if (J.globalDisplayStatus < 7)
            return;
        this.instructionSet.renderPipes[J.renderPipeId].updateRenderable(J),
            J.didViewUpdate = !1
    }
    onChildViewUpdate(J) {
        this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++] = J
    }
    get isRenderable() {
        return this.root.localDisplayStatus === 7 && this.worldAlpha > 0
    }
    addOnRender(J) {
        this._onRenderContainers.push(J)
    }
    removeOnRender(J) {
        this._onRenderContainers.splice(this._onRenderContainers.indexOf(J), 1)
    }
    runOnRender(J) {
        for (let Q = 0; Q < this._onRenderContainers.length; Q++)
            this._onRenderContainers[Q]._onRender(J)
    }
    destroy() {
        this.disableCacheAsTexture(),
            this.renderGroupParent = null,
            this.root = null,
            this.childrenRenderablesToUpdate = null,
            this.childrenToUpdate = null,
            this.renderGroupChildren = null,
            this._onRenderContainers = null,
            this.instructionSet = null
    }
    getChildren(J = []) {
        let Q = this.root.children;
        for (let Z = 0; Z < Q.length; Z++)
            this._getChildren(Q[Z], J);
        return J
    }
    _getChildren(J, Q = []) {
        if (Q.push(J),
            J.renderGroup)
            return Q;
        let Z = J.children;
        for (let $ = 0; $ < Z.length; $++)
            this._getChildren(Z[$], Q);
        return Q
    }
    invalidateMatrices() {
        this._matrixDirty = 7
    }
    get inverseWorldTransform() {
        if ((this._matrixDirty & 1) === 0)
            return this._inverseWorldTransform;
        return this._matrixDirty &= -2,
            this._inverseWorldTransform || (this._inverseWorldTransform = new f0),
            this._inverseWorldTransform.copyFrom(this.worldTransform).invert()
    }
    get textureOffsetInverseTransform() {
        if ((this._matrixDirty & 2) === 0)
            return this._textureOffsetInverseTransform;
        return this._matrixDirty &= -3,
            this._textureOffsetInverseTransform || (this._textureOffsetInverseTransform = new f0),
            this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x, -this._textureBounds.y)
    }
    get inverseParentTextureTransform() {
        if ((this._matrixDirty & 4) === 0)
            return this._inverseParentTextureTransform;
        this._matrixDirty &= -5;
        let J = this._parentCacheAsTextureRenderGroup;
        if (J)
            return this._inverseParentTextureTransform || (this._inverseParentTextureTransform = new f0),
                this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(J.inverseWorldTransform).translate(-J._textureBounds.x, -J._textureBounds.y);
        return this.worldTransform
    }
    get cacheToLocalTransform() {
        if (!this._parentCacheAsTextureRenderGroup)
            return null;
        return this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform
    }
}
var GX = O(() => {
    Z6();
    IV();
    E5()
}
);
function H$(J, Q, Z = {}) {
    for (let $ in Q)
        if (!Z[$] && Q[$] !== void 0)
            J[$] = Q[$]
}
var AV = () => { }
    ;
var UF, PX, NF, DX, Y$ = 1, u1 = 2, JZ = 4, m8;
var zJ = O(() => {
    wJ();
    T7();
    uY();
    w0();
    Z6();
    UV();
    WQ();
    l7();
    O6();
    B6();
    s5();
    rY();
    eY();
    QX();
    qX();
    VX();
    HX();
    CV();
    NX();
    jX();
    kX();
    OX();
    GX();
    AV();
    UF = new g6(null),
        PX = new g6(null),
        NF = new g6(null, 1, 1),
        DX = new g6(null);
    m8 = class m8 extends o6 {
        constructor(J = {}) {
            super();
            this.uid = i8("renderable"),
                this._updateFlags = 15,
                this.renderGroup = null,
                this.parentRenderGroup = null,
                this.parentRenderGroupIndex = 0,
                this.didChange = !1,
                this.didViewUpdate = !1,
                this.relativeRenderGroupDepth = 0,
                this.children = [],
                this.parent = null,
                this.includeInBuild = !0,
                this.measurable = !0,
                this.isSimple = !0,
                this.updateTick = -1,
                this.localTransform = new f0,
                this.relativeGroupTransform = new f0,
                this.groupTransform = this.relativeGroupTransform,
                this.destroyed = !1,
                this._position = new g6(this, 0, 0),
                this._scale = NF,
                this._pivot = PX,
                this._origin = DX,
                this._skew = UF,
                this._cx = 1,
                this._sx = 0,
                this._cy = 0,
                this._sy = 1,
                this._rotation = 0,
                this.localColor = 16777215,
                this.localAlpha = 1,
                this.groupAlpha = 1,
                this.groupColor = 16777215,
                this.groupColorAlpha = 4294967295,
                this.localBlendMode = "inherit",
                this.groupBlendMode = "normal",
                this.localDisplayStatus = 7,
                this.globalDisplayStatus = 7,
                this._didContainerChangeTick = 0,
                this._didViewChangeTick = 0,
                this._didLocalTransformChangeId = -1,
                this.effects = [],
                H$(this, J, {
                    children: !0,
                    parent: !0,
                    effects: !0
                }),
                J.children?.forEach((Q) => this.addChild(Q)),
                J.parent?.addChild(this)
        }
        static mixin(J) {
            c0("8.8.0", "Container.mixin is deprecated, please use extensions.mixin instead."),
                e0.mixin(m8, J)
        }
        set _didChangeId(J) {
            this._didViewChangeTick = J >> 12 & 4095,
                this._didContainerChangeTick = J & 4095
        }
        get _didChangeId() {
            return this._didContainerChangeTick & 4095 | (this._didViewChangeTick & 4095) << 12
        }
        addChild(...J) {
            if (!this.allowChildren)
                c0(Y8, "addChild: Only Containers will be allowed to add children in v8.0.0");
            if (J.length > 1) {
                for (let $ = 0; $ < J.length; $++)
                    this.addChild(J[$]);
                return J[0]
            }
            let Q = J[0]
                , Z = this.renderGroup || this.parentRenderGroup;
            if (Q.parent === this) {
                if (this.children.splice(this.children.indexOf(Q), 1),
                    this.children.push(Q),
                    Z)
                    Z.structureDidChange = !0;
                return Q
            }
            if (Q.parent)
                Q.parent.removeChild(Q);
            if (this.children.push(Q),
                this.sortableChildren)
                this.sortDirty = !0;
            if (Q.parent = this,
                Q.didChange = !0,
                Q._updateFlags = 15,
                Z)
                Z.addChild(Q);
            if (this.emit("childAdded", Q, this, this.children.length - 1),
                Q.emit("added", this),
                this._didViewChangeTick++,
                Q._zIndex !== 0)
                Q.depthOfChildModified();
            return Q
        }
        removeChild(...J) {
            if (J.length > 1) {
                for (let $ = 0; $ < J.length; $++)
                    this.removeChild(J[$]);
                return J[0]
            }
            let Q = J[0]
                , Z = this.children.indexOf(Q);
            if (Z > -1) {
                if (this._didViewChangeTick++,
                    this.children.splice(Z, 1),
                    this.renderGroup)
                    this.renderGroup.removeChild(Q);
                else if (this.parentRenderGroup)
                    this.parentRenderGroup.removeChild(Q);
                if (Q.parentRenderLayer)
                    Q.parentRenderLayer.detach(Q);
                Q.parent = null,
                    this.emit("childRemoved", Q, this, Z),
                    Q.emit("removed", this)
            }
            return Q
        }
        _onUpdate(J) {
            if (J) {
                if (J === this._skew)
                    this._updateSkew()
            }
            if (this._didContainerChangeTick++,
                this.didChange)
                return;
            if (this.didChange = !0,
                this.parentRenderGroup)
                this.parentRenderGroup.onChildUpdate(this)
        }
        set isRenderGroup(J) {
            if (!!this.renderGroup === J)
                return;
            if (J)
                this.enableRenderGroup();
            else
                this.disableRenderGroup()
        }
        get isRenderGroup() {
            return !!this.renderGroup
        }
        enableRenderGroup() {
            if (this.renderGroup)
                return;
            let J = this.parentRenderGroup;
            J?.removeChild(this),
                this.renderGroup = V7.get(DV, this),
                this.groupTransform = f0.IDENTITY,
                J?.addChild(this),
                this._updateIsSimple()
        }
        disableRenderGroup() {
            if (!this.renderGroup)
                return;
            let J = this.parentRenderGroup;
            J?.removeChild(this),
                V7.return(this.renderGroup),
                this.renderGroup = null,
                this.groupTransform = this.relativeGroupTransform,
                J?.addChild(this),
                this._updateIsSimple()
        }
        _updateIsSimple() {
            this.isSimple = !this.renderGroup && this.effects.length === 0
        }
        get worldTransform() {
            if (this._worldTransform || (this._worldTransform = new f0),
                this.renderGroup)
                this._worldTransform.copyFrom(this.renderGroup.worldTransform);
            else if (this.parentRenderGroup)
                this._worldTransform.appendFrom(this.relativeGroupTransform, this.parentRenderGroup.worldTransform);
            return this._worldTransform
        }
        get x() {
            return this._position.x
        }
        set x(J) {
            this._position.x = J
        }
        get y() {
            return this._position.y
        }
        set y(J) {
            this._position.y = J
        }
        get position() {
            return this._position
        }
        set position(J) {
            this._position.copyFrom(J)
        }
        get rotation() {
            return this._rotation
        }
        set rotation(J) {
            if (this._rotation !== J)
                this._rotation = J,
                    this._onUpdate(this._skew)
        }
        get angle() {
            return this.rotation * oY
        }
        set angle(J) {
            this.rotation = J * nY
        }
        get pivot() {
            if (this._pivot === PX)
                this._pivot = new g6(this, 0, 0);
            return this._pivot
        }
        set pivot(J) {
            if (this._pivot === PX) {
                if (this._pivot = new g6(this, 0, 0),
                    this._origin !== DX)
                    m0("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")
            }
            typeof J === "number" ? this._pivot.set(J) : this._pivot.copyFrom(J)
        }
        get skew() {
            if (this._skew === UF)
                this._skew = new g6(this, 0, 0);
            return this._skew
        }
        set skew(J) {
            if (this._skew === UF)
                this._skew = new g6(this, 0, 0);
            this._skew.copyFrom(J)
        }
        get scale() {
            if (this._scale === NF)
                this._scale = new g6(this, 1, 1);
            return this._scale
        }
        set scale(J) {
            if (this._scale === NF)
                this._scale = new g6(this, 0, 0);
            if (typeof J === "string")
                J = parseFloat(J);
            typeof J === "number" ? this._scale.set(J) : this._scale.copyFrom(J)
        }
        get origin() {
            if (this._origin === DX)
                this._origin = new g6(this, 0, 0);
            return this._origin
        }
        set origin(J) {
            if (this._origin === DX) {
                if (this._origin = new g6(this, 0, 0),
                    this._pivot !== PX)
                    m0("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")
            }
            typeof J === "number" ? this._origin.set(J) : this._origin.copyFrom(J)
        }
        get width() {
            return Math.abs(this.scale.x * this.getLocalBounds().width)
        }
        set width(J) {
            let Q = this.getLocalBounds().width;
            this._setWidth(J, Q)
        }
        get height() {
            return Math.abs(this.scale.y * this.getLocalBounds().height)
        }
        set height(J) {
            let Q = this.getLocalBounds().height;
            this._setHeight(J, Q)
        }
        getSize(J) {
            if (!J)
                J = {};
            let Q = this.getLocalBounds();
            return J.width = Math.abs(this.scale.x * Q.width),
                J.height = Math.abs(this.scale.y * Q.height),
                J
        }
        setSize(J, Q) {
            let Z = this.getLocalBounds();
            if (typeof J === "object")
                Q = J.height ?? J.width,
                    J = J.width;
            else
                Q ?? (Q = J);
            J !== void 0 && this._setWidth(J, Z.width),
                Q !== void 0 && this._setHeight(Q, Z.height)
        }
        _updateSkew() {
            let J = this._rotation
                , Q = this._skew;
            this._cx = Math.cos(J + Q._y),
                this._sx = Math.sin(J + Q._y),
                this._cy = -Math.sin(J - Q._x),
                this._sy = Math.cos(J - Q._x)
        }
        updateTransform(J) {
            return this.position.set(typeof J.x === "number" ? J.x : this.position.x, typeof J.y === "number" ? J.y : this.position.y),
                this.scale.set(typeof J.scaleX === "number" ? J.scaleX || 1 : this.scale.x, typeof J.scaleY === "number" ? J.scaleY || 1 : this.scale.y),
                this.rotation = typeof J.rotation === "number" ? J.rotation : this.rotation,
                this.skew.set(typeof J.skewX === "number" ? J.skewX : this.skew.x, typeof J.skewY === "number" ? J.skewY : this.skew.y),
                this.pivot.set(typeof J.pivotX === "number" ? J.pivotX : this.pivot.x, typeof J.pivotY === "number" ? J.pivotY : this.pivot.y),
                this.origin.set(typeof J.originX === "number" ? J.originX : this.origin.x, typeof J.originY === "number" ? J.originY : this.origin.y),
                this
        }
        setFromMatrix(J) {
            J.decompose(this)
        }
        updateLocalTransform() {
            let J = this._didContainerChangeTick;
            if (this._didLocalTransformChangeId === J)
                return;
            this._didLocalTransformChangeId = J;
            let Q = this.localTransform
                , Z = this._scale
                , $ = this._pivot
                , q = this._origin
                , K = this._position
                , V = Z._x
                , z = Z._y
                , W = $._x
                , H = $._y
                , Y = -q._x
                , U = -q._y;
            Q.a = this._cx * V,
                Q.b = this._sx * V,
                Q.c = this._cy * z,
                Q.d = this._sy * z,
                Q.tx = K._x - (W * Q.a + H * Q.c) + (Y * Q.a + U * Q.c) - Y,
                Q.ty = K._y - (W * Q.b + H * Q.d) + (Y * Q.b + U * Q.d) - U
        }
        set alpha(J) {
            if (J === this.localAlpha)
                return;
            this.localAlpha = J,
                this._updateFlags |= Y$,
                this._onUpdate()
        }
        get alpha() {
            return this.localAlpha
        }
        set tint(J) {
            let Z = E8.shared.setValue(J ?? 16777215).toBgrNumber();
            if (Z === this.localColor)
                return;
            this.localColor = Z,
                this._updateFlags |= Y$,
                this._onUpdate()
        }
        get tint() {
            return YQ(this.localColor)
        }
        set blendMode(J) {
            if (this.localBlendMode === J)
                return;
            if (this.parentRenderGroup)
                this.parentRenderGroup.structureDidChange = !0;
            this._updateFlags |= u1,
                this.localBlendMode = J,
                this._onUpdate()
        }
        get blendMode() {
            return this.localBlendMode
        }
        get visible() {
            return !!(this.localDisplayStatus & 2)
        }
        set visible(J) {
            let Q = J ? 2 : 0;
            if ((this.localDisplayStatus & 2) === Q)
                return;
            if (this.parentRenderGroup)
                this.parentRenderGroup.structureDidChange = !0;
            this._updateFlags |= JZ,
                this.localDisplayStatus ^= 2,
                this._onUpdate()
        }
        get culled() {
            return !(this.localDisplayStatus & 4)
        }
        set culled(J) {
            let Q = J ? 0 : 4;
            if ((this.localDisplayStatus & 4) === Q)
                return;
            if (this.parentRenderGroup)
                this.parentRenderGroup.structureDidChange = !0;
            this._updateFlags |= JZ,
                this.localDisplayStatus ^= 4,
                this._onUpdate()
        }
        get renderable() {
            return !!(this.localDisplayStatus & 1)
        }
        set renderable(J) {
            let Q = J ? 1 : 0;
            if ((this.localDisplayStatus & 1) === Q)
                return;
            if (this._updateFlags |= JZ,
                this.localDisplayStatus ^= 1,
                this.parentRenderGroup)
                this.parentRenderGroup.structureDidChange = !0;
            this._onUpdate()
        }
        get isRenderable() {
            return this.localDisplayStatus === 7 && this.groupAlpha > 0
        }
        destroy(J = !1) {
            if (this.destroyed)
                return;
            this.destroyed = !0;
            let Q;
            if (this.children.length)
                Q = this.removeChildren(0, this.children.length);
            if (this.removeFromParent(),
                this.parent = null,
                this._maskEffect = null,
                this._filterEffect = null,
                this.effects = null,
                this._position = null,
                this._scale = null,
                this._pivot = null,
                this._origin = null,
                this._skew = null,
                this.emit("destroyed", this),
                this.removeAllListeners(),
                (typeof J === "boolean" ? J : J?.children) && Q)
                for (let $ = 0; $ < Q.length; ++$)
                    Q[$].destroy(J);
            this.renderGroup?.destroy(),
                this.renderGroup = null
        }
    }
        ;
    e0.mixin(m8, tY, WX, CX, wX, UX, $X, KX, BX, pY, aY, YX, JX)
}
);
var jJ;
var UQ = O(() => {
    jJ = ((J) => {
        return J[J.INTERACTION = 50] = "INTERACTION",
            J[J.HIGH = 25] = "HIGH",
            J[J.NORMAL = 0] = "NORMAL",
            J[J.LOW = -25] = "LOW",
            J[J.UTILITY = -50] = "UTILITY",
            J
    }
    )(jJ || {})
}
);
class X$ {
    constructor(J, Q = null, Z = 0, $ = !1) {
        this.next = null,
            this.previous = null,
            this._destroyed = !1,
            this._fn = J,
            this._context = Q,
            this.priority = Z,
            this._once = $
    }
    match(J, Q = null) {
        return this._fn === J && this._context === Q
    }
    emit(J) {
        if (this._fn)
            if (this._context)
                this._fn.call(this._context, J);
            else
                this._fn(J);
        let Q = this.next;
        if (this._once)
            this.destroy(!0);
        if (this._destroyed)
            this.next = null;
        return Q
    }
    connect(J) {
        if (this.previous = J,
            J.next)
            J.next.previous = this;
        this.next = J.next,
            J.next = this
    }
    destroy(J = !1) {
        if (this._destroyed = !0,
            this._fn = null,
            this._context = null,
            this.previous)
            this.previous.next = this.next;
        if (this.next)
            this.next.previous = this.previous;
        let Q = this.next;
        return this.next = J ? null : Q,
            this.previous = null,
            Q
    }
}
var AX = () => { }
    ;
var nE = class J {
    constructor() {
        this.autoStart = !1,
            this.deltaTime = 1,
            this.lastTime = -1,
            this.speed = 1,
            this.started = !1,
            this._requestId = null,
            this._maxElapsedMS = 100,
            this._minElapsedMS = 0,
            this._protected = !1,
            this._lastFrame = -1,
            this._head = new X$(null, null, 1 / 0),
            this.deltaMS = 1 / J.targetFPMS,
            this.elapsedMS = 1 / J.targetFPMS,
            this._tick = (Q) => {
                if (this._requestId = null,
                    this.started) {
                    if (this.update(Q),
                        this.started && this._requestId === null && this._head.next)
                        this._requestId = requestAnimationFrame(this._tick)
                }
            }
    }
    _requestIfNeeded() {
        if (this._requestId === null && this._head.next)
            this.lastTime = performance.now(),
                this._lastFrame = this.lastTime,
                this._requestId = requestAnimationFrame(this._tick)
    }
    _cancelIfNeeded() {
        if (this._requestId !== null)
            cancelAnimationFrame(this._requestId),
                this._requestId = null
    }
    _startIfPossible() {
        if (this.started)
            this._requestIfNeeded();
        else if (this.autoStart)
            this.start()
    }
    add(Q, Z, $ = jJ.NORMAL) {
        return this._addListener(new X$(Q, Z, $))
    }
    addOnce(Q, Z, $ = jJ.NORMAL) {
        return this._addListener(new X$(Q, Z, $, !0))
    }
    _addListener(Q) {
        let Z = this._head.next
            , $ = this._head;
        if (!Z)
            Q.connect($);
        else {
            while (Z) {
                if (Q.priority > Z.priority) {
                    Q.connect($);
                    break
                }
                $ = Z,
                    Z = Z.next
            }
            if (!Q.previous)
                Q.connect($)
        }
        return this._startIfPossible(),
            this
    }
    remove(Q, Z) {
        let $ = this._head.next;
        while ($)
            if ($.match(Q, Z))
                $ = $.destroy();
            else
                $ = $.next;
        if (!this._head.next)
            this._cancelIfNeeded();
        return this
    }
    get count() {
        if (!this._head)
            return 0;
        let Q = 0
            , Z = this._head;
        while (Z = Z.next)
            Q++;
        return Q
    }
    start() {
        if (!this.started)
            this.started = !0,
                this._requestIfNeeded()
    }
    stop() {
        if (this.started)
            this.started = !1,
                this._cancelIfNeeded()
    }
    destroy() {
        if (!this._protected) {
            this.stop();
            let Q = this._head.next;
            while (Q)
                Q = Q.destroy(!0);
            this._head.destroy(),
                this._head = null
        }
    }
    update(Q = performance.now()) {
        let Z;
        if (Q > this.lastTime) {
            if (Z = this.elapsedMS = Q - this.lastTime,
                Z > this._maxElapsedMS)
                Z = this._maxElapsedMS;
            if (Z *= this.speed,
                this._minElapsedMS) {
                let K = Q - this._lastFrame | 0;
                if (K < this._minElapsedMS)
                    return;
                this._lastFrame = Q - K % this._minElapsedMS
            }
            this.deltaMS = Z,
                this.deltaTime = this.deltaMS * J.targetFPMS;
            let $ = this._head
                , q = $.next;
            while (q)
                q = q.emit(this);
            if (!$.next)
                this._cancelIfNeeded()
        } else
            this.deltaTime = this.deltaMS = this.elapsedMS = 0;
        this.lastTime = Q
    }
    get FPS() {
        return 1000 / this.elapsedMS
    }
    get minFPS() {
        return 1000 / this._maxElapsedMS
    }
    set minFPS(Q) {
        let Z = Math.min(this.maxFPS, Q)
            , $ = Math.min(Math.max(0, Z) / 1000, J.targetFPMS);
        this._maxElapsedMS = 1 / $
    }
    get maxFPS() {
        if (this._minElapsedMS)
            return Math.round(1000 / this._minElapsedMS);
        return 0
    }
    set maxFPS(Q) {
        if (Q === 0)
            this._minElapsedMS = 0;
        else {
            let Z = Math.max(this.minFPS, Q);
            this._minElapsedMS = 1 / (Z / 1000)
        }
    }
    static get shared() {
        if (!J._shared) {
            let Q = J._shared = new J;
            Q.autoStart = !0,
                Q._protected = !0
        }
        return J._shared
    }
    static get system() {
        if (!J._system) {
            let Q = J._system = new J;
            Q.autoStart = !0,
                Q._protected = !0
        }
        return J._system
    }
}
    , n6;
var E9 = O(() => {
    UQ();
    AX();
    nE.targetFPMS = 0.06;
    n6 = nE
}
);
class QZ {
    constructor(J) {
        if (this._lastTransform = "",
            this._observer = null,
            this._tickerAttached = !1,
            this.updateTranslation = () => {
                if (!this._canvas)
                    return;
                let Q = this._canvas.getBoundingClientRect()
                    , Z = this._canvas.width
                    , $ = this._canvas.height
                    , q = Q.width / Z * this._renderer.resolution
                    , K = Q.height / $ * this._renderer.resolution
                    , V = Q.left
                    , z = Q.top
                    , W = `translate(${V}px, ${z}px) scale(${q}, ${K})`;
                if (W !== this._lastTransform)
                    this._domElement.style.transform = W,
                        this._lastTransform = W
            }
            ,
            this._domElement = J.domElement,
            this._renderer = J.renderer,
            globalThis.OffscreenCanvas && this._renderer.canvas instanceof OffscreenCanvas)
            return;
        this._canvas = this._renderer.canvas,
            this._attachObserver()
    }
    get canvas() {
        return this._canvas
    }
    ensureAttached() {
        if (!this._domElement.parentNode && this._canvas.parentNode)
            this._canvas.parentNode.appendChild(this._domElement),
                this.updateTranslation()
    }
    _attachObserver() {
        if ("ResizeObserver" in globalThis) {
            if (this._observer)
                this._observer.disconnect(),
                    this._observer = null;
            this._observer = new ResizeObserver((J) => {
                for (let Q of J) {
                    if (Q.target !== this._canvas)
                        continue;
                    let Z = this.canvas.width
                        , $ = this.canvas.height
                        , q = Q.contentRect.width / Z * this._renderer.resolution
                        , K = Q.contentRect.height / $ * this._renderer.resolution;
                    if (this._lastScaleX !== q || this._lastScaleY !== K)
                        this.updateTranslation(),
                            this._lastScaleX = q,
                            this._lastScaleY = K
                }
            }
            ),
                this._observer.observe(this._canvas)
        } else if (!this._tickerAttached)
            n6.shared.add(this.updateTranslation, this, jJ.HIGH)
    }
    destroy() {
        if (this._observer)
            this._observer.disconnect(),
                this._observer = null;
        else if (this._tickerAttached)
            n6.shared.remove(this.updateTranslation);
        this._domElement = null,
            this._renderer = null,
            this._canvas = null,
            this._tickerAttached = !1,
            this._lastTransform = "",
            this._lastScaleX = null,
            this._lastScaleY = null
    }
}
var l1 = O(() => {
    UQ();
    E9()
}
);
class M9 {
    constructor(J) {
        this.bubbles = !0,
            this.cancelBubble = !0,
            this.cancelable = !1,
            this.composed = !1,
            this.defaultPrevented = !1,
            this.eventPhase = M9.prototype.NONE,
            this.propagationStopped = !1,
            this.propagationImmediatelyStopped = !1,
            this.layer = new z6,
            this.page = new z6,
            this.NONE = 0,
            this.CAPTURING_PHASE = 1,
            this.AT_TARGET = 2,
            this.BUBBLING_PHASE = 3,
            this.manager = J
    }
    get layerX() {
        return this.layer.x
    }
    get layerY() {
        return this.layer.y
    }
    get pageX() {
        return this.page.x
    }
    get pageY() {
        return this.page.y
    }
    get data() {
        return this
    }
    composedPath() {
        if (this.manager && (!this.path || this.path[this.path.length - 1] !== this.target))
            this.path = this.target ? this.manager.propagationPath(this.target) : [];
        return this.path
    }
    initEvent(J, Q, Z) {
        throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")
    }
    initUIEvent(J, Q, Z, $, q) {
        throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")
    }
    preventDefault() {
        if (this.nativeEvent instanceof Event && this.nativeEvent.cancelable)
            this.nativeEvent.preventDefault();
        this.defaultPrevented = !0
    }
    stopImmediatePropagation() {
        this.propagationImmediatelyStopped = !0
    }
    stopPropagation() {
        this.propagationStopped = !0
    }
}
var o1 = O(() => {
    cJ()
}
);
function kx(J) {
    return function (Q) {
        return Q.test(J)
    }
}
function ZZ(J) {
    var Q = {
        userAgent: "",
        platform: "",
        maxTouchPoints: 0
    };
    if (!J && typeof navigator !== "undefined")
        Q = {
            userAgent: navigator.userAgent,
            platform: navigator.platform,
            maxTouchPoints: navigator.maxTouchPoints || 0
        };
    else if (typeof J === "string")
        Q.userAgent = J;
    else if (J && J.userAgent)
        Q = {
            userAgent: J.userAgent,
            platform: J.platform,
            maxTouchPoints: J.maxTouchPoints || 0
        };
    var Z = Q.userAgent
        , $ = Z.split("[FBAN");
    if (typeof $[1] !== "undefined")
        Z = $[0];
    if ($ = Z.split("Twitter"),
        typeof $[1] !== "undefined")
        Z = $[0];
    var q = kx(Z)
        , K = {
            apple: {
                phone: q(wF) && !q(NQ),
                ipod: q(sE),
                tablet: !q(wF) && (q(iE) || qM(Q)) && !q(NQ),
                universal: q(aE),
                device: (q(wF) || q(sE) || q(iE) || q(aE) || qM(Q)) && !q(NQ)
            },
            amazon: {
                phone: q(n1),
                tablet: !q(n1) && q(EX),
                device: q(n1) || q(EX)
            },
            android: {
                phone: !q(NQ) && q(n1) || !q(NQ) && q(jF),
                tablet: !q(NQ) && !q(n1) && !q(jF) && (q(EX) || q(rE)),
                device: !q(NQ) && (q(n1) || q(EX) || q(jF) || q(rE)) || q(/\bokhttp\b/i)
            },
            globals: {
                phone: q(NQ),
                tablet: q(tE),
                device: q(NQ) || q(tE)
            },
            other: {
                blackberry: q(eE),
                blackberry10: q(JM),
                opera: q(QM),
                firefox: q($M),
                chrome: q(ZM),
                device: q(eE) || q(JM) || q(QM) || q($M) || q(ZM)
            },
            any: !1,
            phone: !1,
            tablet: !1
        };
    return K.any = K.apple.device || K.android.device || K.globals.device || K.other.device,
        K.phone = K.apple.phone || K.android.phone || K.globals.phone,
        K.tablet = K.apple.tablet || K.android.tablet || K.globals.tablet,
        K
}
var wF, sE, iE, aE, jF, rE, n1, EX, NQ, tE, eE, JM, QM, ZM, $M, qM = function (J) {
    return typeof J !== "undefined" && J.platform === "MacIntel" && typeof J.maxTouchPoints === "number" && J.maxTouchPoints > 1 && typeof MSStream === "undefined"
};
var BF = O(() => {
    wF = /iPhone/i,
        sE = /iPod/i,
        iE = /iPad/i,
        aE = /\biOS-universal(?:.+)Mac\b/i,
        jF = /\bAndroid(?:.+)Mobile\b/i,
        rE = /Android/i,
        n1 = /(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,
        EX = /Silk/i,
        NQ = /globals Phone/i,
        tE = /\bglobals(?:.+)ARM\b/i,
        eE = /BlackBerry/i,
        JM = /BB10/i,
        QM = /Opera Mini/i,
        ZM = /\b(CriOS|Chrome)(?:.+)Mobile/i,
        $M = /Mobile(?:.+)Firefox\b/i
}
);
var kF = O(() => {
    BF();
    BF()
}
);
var Cx, MX;
var _X = O(() => {
    kF();
    Cx = ZZ.default ?? ZZ,
        MX = Cx(globalThis.navigator)
}
);
var Ox = 9, KM = 100, Ix = 0, Lx = 0, VM = 2, zM = 1, Fx = -1000, Gx = -1000, Px = 2, CF = class J {
    constructor(Q, Z = MX) {
        if (this._mobileInfo = Z,
            this.debug = !1,
            this._activateOnTab = !0,
            this._deactivateOnMouseMove = !0,
            this._isActive = !1,
            this._isMobileAccessibility = !1,
            this._div = null,
            this._pool = [],
            this._renderId = 0,
            this._children = [],
            this._androidUpdateCount = 0,
            this._androidUpdateFrequency = 500,
            this._hookDiv = null,
            Z.tablet || Z.phone)
            this._createTouchHook();
        this._renderer = Q
    }
    get isActive() {
        return this._isActive
    }
    get isMobileAccessibility() {
        return this._isMobileAccessibility
    }
    get hookDiv() {
        return this._hookDiv
    }
    _createTouchHook() {
        let Q = document.createElement("button");
        Q.style.width = `${zM}px`,
            Q.style.height = `${zM}px`,
            Q.style.position = "absolute",
            Q.style.top = `${Fx}px`,
            Q.style.left = `${Gx}px`,
            Q.style.zIndex = Px.toString(),
            Q.style.backgroundColor = "#FF0000",
            Q.title = "select to enable accessibility for this content",
            Q.addEventListener("focus", () => {
                this._isMobileAccessibility = !0,
                    this._activate(),
                    this._destroyTouchHook()
            }
            ),
            document.body.appendChild(Q),
            this._hookDiv = Q
    }
    _destroyTouchHook() {
        if (!this._hookDiv)
            return;
        document.body.removeChild(this._hookDiv),
            this._hookDiv = null
    }
    _activate() {
        if (this._isActive)
            return;
        if (this._isActive = !0,
            !this._div)
            this._div = document.createElement("div"),
                this._div.style.position = "absolute",
                this._div.style.top = `${Ix}px`,
                this._div.style.left = `${Lx}px`,
                this._div.style.pointerEvents = "none",
                this._div.style.zIndex = VM.toString(),
                this._canvasObserver = new QZ({
                    domElement: this._div,
                    renderer: this._renderer
                });
        if (this._activateOnTab)
            this._onKeyDown = this._onKeyDown.bind(this),
                globalThis.addEventListener("keydown", this._onKeyDown, !1);
        if (this._deactivateOnMouseMove)
            this._onMouseMove = this._onMouseMove.bind(this),
                globalThis.document.addEventListener("mousemove", this._onMouseMove, !0);
        let Q = this._renderer.view.canvas;
        if (!Q.parentNode) {
            let Z = new MutationObserver(() => {
                if (Q.parentNode)
                    Z.disconnect(),
                        this._canvasObserver.ensureAttached(),
                        this._initAccessibilitySetup()
            }
            );
            Z.observe(document.body, {
                childList: !0,
                subtree: !0
            })
        } else
            this._canvasObserver.ensureAttached(),
                this._initAccessibilitySetup()
    }
    _initAccessibilitySetup() {
        if (this._renderer.runners.postrender.add(this),
            this._renderer.lastObjectRendered)
            this._updateAccessibleObjects(this._renderer.lastObjectRendered)
    }
    _deactivate() {
        if (!this._isActive || this._isMobileAccessibility)
            return;
        if (this._isActive = !1,
            globalThis.document.removeEventListener("mousemove", this._onMouseMove, !0),
            this._activateOnTab)
            globalThis.addEventListener("keydown", this._onKeyDown, !1);
        this._renderer.runners.postrender.remove(this);
        for (let Q of this._children) {
            if (Q._accessibleDiv && Q._accessibleDiv.parentNode)
                Q._accessibleDiv.parentNode.removeChild(Q._accessibleDiv),
                    Q._accessibleDiv = null;
            Q._accessibleActive = !1
        }
        if (this._pool.forEach((Q) => {
            if (Q.parentNode)
                Q.parentNode.removeChild(Q)
        }
        ),
            this._div && this._div.parentNode)
            this._div.parentNode.removeChild(this._div);
        this._pool = [],
            this._children = []
    }
    _updateAccessibleObjects(Q) {
        if (!Q.visible || !Q.accessibleChildren)
            return;
        if (Q.accessible) {
            if (!Q._accessibleActive)
                this._addChild(Q);
            Q._renderId = this._renderId
        }
        let Z = Q.children;
        if (Z)
            for (let $ = 0; $ < Z.length; $++)
                this._updateAccessibleObjects(Z[$])
    }
    init(Q) {
        let $ = {
            accessibilityOptions: {
                ...J.defaultOptions,
                ...Q?.accessibilityOptions || {}
            }
        };
        if (this.debug = $.accessibilityOptions.debug,
            this._activateOnTab = $.accessibilityOptions.activateOnTab,
            this._deactivateOnMouseMove = $.accessibilityOptions.deactivateOnMouseMove,
            $.accessibilityOptions.enabledByDefault)
            this._activate();
        else if (this._activateOnTab)
            this._onKeyDown = this._onKeyDown.bind(this),
                globalThis.addEventListener("keydown", this._onKeyDown, !1);
        this._renderer.runners.postrender.remove(this)
    }
    postrender() {
        let Q = performance.now();
        if (this._mobileInfo.android.device && Q < this._androidUpdateCount)
            return;
        if (this._androidUpdateCount = Q + this._androidUpdateFrequency,
            !this._renderer.renderingToScreen || !this._renderer.view.canvas)
            return;
        let Z = new Set;
        if (this._renderer.lastObjectRendered) {
            this._updateAccessibleObjects(this._renderer.lastObjectRendered);
            for (let $ of this._children)
                if ($._renderId === this._renderId)
                    Z.add(this._children.indexOf($))
        }
        for (let $ = this._children.length - 1; $ >= 0; $--) {
            let q = this._children[$];
            if (!Z.has($)) {
                if (q._accessibleDiv && q._accessibleDiv.parentNode)
                    q._accessibleDiv.parentNode.removeChild(q._accessibleDiv),
                        this._pool.push(q._accessibleDiv),
                        q._accessibleDiv = null;
                q._accessibleActive = !1,
                    h1(this._children, $, 1)
            }
        }
        if (this._renderer.renderingToScreen)
            this._canvasObserver.ensureAttached();
        for (let $ = 0; $ < this._children.length; $++) {
            let q = this._children[$];
            if (!q._accessibleActive || !q._accessibleDiv)
                continue;
            let K = q._accessibleDiv
                , V = q.hitArea || q.getBounds().rectangle;
            if (q.hitArea) {
                let z = q.worldTransform;
                K.style.left = `${z.tx + V.x * z.a}px`,
                    K.style.top = `${z.ty + V.y * z.d}px`,
                    K.style.width = `${V.width * z.a}px`,
                    K.style.height = `${V.height * z.d}px`
            } else
                this._capHitArea(V),
                    K.style.left = `${V.x}px`,
                    K.style.top = `${V.y}px`,
                    K.style.width = `${V.width}px`,
                    K.style.height = `${V.height}px`
        }
        this._renderId++
    }
    _updateDebugHTML(Q) {
        Q.innerHTML = `type: ${Q.type}</br> title : ${Q.title}</br> tabIndex: ${Q.tabIndex}`
    }
    _capHitArea(Q) {
        if (Q.x < 0)
            Q.width += Q.x,
                Q.x = 0;
        if (Q.y < 0)
            Q.height += Q.y,
                Q.y = 0;
        let { width: Z, height: $ } = this._renderer;
        if (Q.x + Q.width > Z)
            Q.width = Z - Q.x;
        if (Q.y + Q.height > $)
            Q.height = $ - Q.y
    }
    _addChild(Q) {
        let Z = this._pool.pop();
        if (!Z) {
            if (Q.accessibleType === "button")
                Z = document.createElement("button");
            else if (Z = document.createElement(Q.accessibleType),
                Z.style.cssText = `
                        color: transparent;
                        pointer-events: none;
                        padding: 0;
                        margin: 0;
                        border: 0;
                        outline: 0;
                        background: transparent;
                        box-sizing: border-box;
                        user-select: none;
                        -webkit-user-select: none;
                        -moz-user-select: none;
                        -ms-user-select: none;
                    `,
                Q.accessibleText)
                Z.innerText = Q.accessibleText;
            if (Z.style.width = `${KM}px`,
                Z.style.height = `${KM}px`,
                Z.style.backgroundColor = this.debug ? "rgba(255,255,255,0.5)" : "transparent",
                Z.style.position = "absolute",
                Z.style.zIndex = VM.toString(),
                Z.style.borderStyle = "none",
                navigator.userAgent.toLowerCase().includes("chrome"))
                Z.setAttribute("aria-live", "off");
            else
                Z.setAttribute("aria-live", "polite");
            if (navigator.userAgent.match(/rv:.*Gecko\//))
                Z.setAttribute("aria-relevant", "additions");
            else
                Z.setAttribute("aria-relevant", "text");
            Z.addEventListener("click", this._onClick.bind(this)),
                Z.addEventListener("focus", this._onFocus.bind(this)),
                Z.addEventListener("focusout", this._onFocusOut.bind(this))
        }
        if (Z.style.pointerEvents = Q.accessiblePointerEvents,
            Z.type = Q.accessibleType,
            Q.accessibleTitle && Q.accessibleTitle !== null)
            Z.title = Q.accessibleTitle;
        else if (!Q.accessibleHint || Q.accessibleHint === null)
            Z.title = `container ${Q.tabIndex}`;
        if (Q.accessibleHint && Q.accessibleHint !== null)
            Z.setAttribute("aria-label", Q.accessibleHint);
        if (this.debug)
            this._updateDebugHTML(Z);
        if (Q._accessibleActive = !0,
            Q._accessibleDiv = Z,
            Z.container = Q,
            this._children.push(Q),
            this._div.appendChild(Q._accessibleDiv),
            Q.interactive)
            Q._accessibleDiv.tabIndex = Q.tabIndex
    }
    _dispatchEvent(Q, Z) {
        let { container: $ } = Q.target
            , q = this._renderer.events.rootBoundary
            , K = Object.assign(new M9(q), {
                target: $
            });
        q.rootTarget = this._renderer.lastObjectRendered,
            Z.forEach((V) => q.dispatchEvent(K, V))
    }
    _onClick(Q) {
        this._dispatchEvent(Q, ["click", "pointertap", "tap"])
    }
    _onFocus(Q) {
        if (!Q.target.getAttribute("aria-live"))
            Q.target.setAttribute("aria-live", "assertive");
        this._dispatchEvent(Q, ["mouseover"])
    }
    _onFocusOut(Q) {
        if (!Q.target.getAttribute("aria-live"))
            Q.target.setAttribute("aria-live", "polite");
        this._dispatchEvent(Q, ["mouseout"])
    }
    _onKeyDown(Q) {
        if (Q.keyCode !== Ox || !this._activateOnTab)
            return;
        this._activate()
    }
    _onMouseMove(Q) {
        if (Q.movementX === 0 && Q.movementY === 0)
            return;
        this._deactivate()
    }
    destroy() {
        if (this._deactivate(),
            this._destroyTouchHook(),
            this._canvasObserver?.destroy(),
            this._canvasObserver = null,
            this._div = null,
            this._pool = null,
            this._children = null,
            this._renderer = null,
            this._activateOnTab)
            globalThis.removeEventListener("keydown", this._onKeyDown)
    }
    setAccessibilityEnabled(Q) {
        if (Q)
            this._activate();
        else
            this._deactivate()
    }
}
    , RX;
var bX = O(() => {
    l1();
    o1();
    w0();
    _X();
    wV();
    CF.extension = {
        type: [R.WebGLSystem, R.WebGPUSystem],
        name: "accessibility"
    };
    CF.defaultOptions = {
        enabledByDefault: !1,
        debug: !1,
        activateOnTab: !0,
        deactivateOnMouseMove: !0
    };
    RX = CF
}
);
var vX;
var SX = O(() => {
    vX = {
        accessible: !1,
        accessibleTitle: null,
        accessibleHint: null,
        tabIndex: 0,
        accessibleType: "button",
        accessibleText: null,
        accessiblePointerEvents: "auto",
        accessibleChildren: !0,
        _accessibleActive: !1,
        _accessibleDiv: null,
        _renderId: -1
    }
}
);
var WM = O(() => {
    w0();
    zJ();
    bX();
    SX();
    e0.add(RX);
    e0.mixin(m8, vX)
}
);
class s1 {
    static init(J) {
        Object.defineProperty(this, "resizeTo", {
            set(Q) {
                if (globalThis.removeEventListener("resize", this.queueResize),
                    this._resizeTo = Q,
                    Q)
                    globalThis.addEventListener("resize", this.queueResize),
                        this.resize()
            },
            get() {
                return this._resizeTo
            }
        }),
            this.queueResize = () => {
                if (!this._resizeTo)
                    return;
                this._cancelResize(),
                    this._resizeId = requestAnimationFrame(() => this.resize())
            }
            ,
            this._cancelResize = () => {
                if (this._resizeId)
                    cancelAnimationFrame(this._resizeId),
                        this._resizeId = null
            }
            ,
            this.resize = () => {
                if (!this._resizeTo)
                    return;
                this._cancelResize();
                let Q, Z;
                if (this._resizeTo === globalThis.global)
                    Q = globalThis.innerWidth,
                        Z = globalThis.innerHeight;
                else {
                    let { clientWidth: $, clientHeight: q } = this._resizeTo;
                    Q = $,
                        Z = q
                }
                this.renderer.resize(Q, Z),
                    this.render()
            }
            ,
            this._resizeId = null,
            this._resizeTo = null,
            this.resizeTo = J.resizeTo || null
    }
    static destroy() {
        globalThis.removeEventListener("resize", this.queueResize),
            this._cancelResize(),
            this._cancelResize = null,
            this.queueResize = null,
            this.resizeTo = null,
            this.resize = null
    }
}
var TX = O(() => {
    w0();
    s1.extension = R.Application
}
);
class i1 {
    static init(J) {
        if (J = Object.assign({
            autoStart: !0,
            sharedTicker: !1
        }, J),
            Object.defineProperty(this, "ticker", {
                set(Q) {
                    if (this._ticker)
                        this._ticker.remove(this.render, this);
                    if (this._ticker = Q,
                        Q)
                        Q.add(this.render, this, jJ.LOW)
                },
                get() {
                    return this._ticker
                }
            }),
            this.stop = () => {
                this._ticker.stop()
            }
            ,
            this.start = () => {
                this._ticker.start()
            }
            ,
            this._ticker = null,
            this.ticker = J.sharedTicker ? n6.shared : new n6,
            J.autoStart)
            this.start()
    }
    static destroy() {
        if (this._ticker) {
            let J = this._ticker;
            this.ticker = null,
                J.destroy()
        }
    }
}
var yX = O(() => {
    w0();
    UQ();
    E9();
    i1.extension = R.Application
}
);
var OF = O(() => {
    w0();
    TX();
    yX();
    e0.add(s1);
    e0.add(i1)
}
);
class HM {
    constructor() {
        this.interactionFrequency = 10,
            this._deltaTime = 0,
            this._didMove = !1,
            this._tickerAdded = !1,
            this._pauseUpdate = !0
    }
    init(J) {
        this.removeTickerListener(),
            this.events = J,
            this.interactionFrequency = 10,
            this._deltaTime = 0,
            this._didMove = !1,
            this._tickerAdded = !1,
            this._pauseUpdate = !0
    }
    get pauseUpdate() {
        return this._pauseUpdate
    }
    set pauseUpdate(J) {
        this._pauseUpdate = J
    }
    addTickerListener() {
        if (this._tickerAdded || !this.domElement)
            return;
        n6.system.add(this._tickerUpdate, this, jJ.INTERACTION),
            this._tickerAdded = !0
    }
    removeTickerListener() {
        if (!this._tickerAdded)
            return;
        n6.system.remove(this._tickerUpdate, this),
            this._tickerAdded = !1
    }
    pointerMoved() {
        this._didMove = !0
    }
    _update() {
        if (!this.domElement || this._pauseUpdate)
            return;
        if (this._didMove) {
            this._didMove = !1;
            return
        }
        let J = this.events._rootPointerEvent;
        if (this.events.supportsTouchEvents && J.pointerType === "touch")
            return;
        globalThis.document.dispatchEvent(this.events.supportsPointerEvents ? new PointerEvent("pointermove", {
            clientX: J.clientX,
            clientY: J.clientY,
            pointerType: J.pointerType,
            pointerId: J.pointerId
        }) : new MouseEvent("mousemove", {
            clientX: J.clientX,
            clientY: J.clientY
        }))
    }
    _tickerUpdate(J) {
        if (this._deltaTime += J.deltaTime,
            this._deltaTime < this.interactionFrequency)
            return;
        this._deltaTime = 0,
            this._update()
    }
}
var M5;
var EV = O(() => {
    UQ();
    E9();
    M5 = new HM
}
);
var _9;
var a1 = O(() => {
    cJ();
    o1();
    _9 = class _9 extends M9 {
        constructor() {
            super(...arguments);
            this.client = new z6,
                this.movement = new z6,
                this.offset = new z6,
                this.global = new z6,
                this.screen = new z6
        }
        get clientX() {
            return this.client.x
        }
        get clientY() {
            return this.client.y
        }
        get x() {
            return this.clientX
        }
        get y() {
            return this.clientY
        }
        get movementX() {
            return this.movement.x
        }
        get movementY() {
            return this.movement.y
        }
        get offsetX() {
            return this.offset.x
        }
        get offsetY() {
            return this.offset.y
        }
        get globalX() {
            return this.global.x
        }
        get globalY() {
            return this.global.y
        }
        get screenX() {
            return this.screen.x
        }
        get screenY() {
            return this.screen.y
        }
        getLocalPosition(J, Q, Z) {
            return J.worldTransform.applyInverse(Z || this.global, Q)
        }
        getModifierState(J) {
            return "getModifierState" in this.nativeEvent && this.nativeEvent.getModifierState(J)
        }
        initMouseEvent(J, Q, Z, $, q, K, V, z, W, H, Y, U, N, j, k) {
            throw new Error("Method not implemented.")
        }
    }
}
);
var DJ;
var MV = O(() => {
    a1();
    DJ = class DJ extends _9 {
        constructor() {
            super(...arguments);
            this.width = 0,
                this.height = 0,
                this.isPrimary = !1
        }
        getCoalescedEvents() {
            if (this.type === "pointermove" || this.type === "mousemove" || this.type === "touchmove")
                return [this];
            return []
        }
        getPredictedEvents() {
            throw new Error("getPredictedEvents is not supported!")
        }
    }
}
);
var a5;
var _V = O(() => {
    a1();
    a5 = class a5 extends _9 {
        constructor() {
            super(...arguments);
            this.DOM_DELTA_PIXEL = 0,
                this.DOM_DELTA_LINE = 1,
                this.DOM_DELTA_PAGE = 2
        }
    }
        ;
    a5.DOM_DELTA_PIXEL = 0;
    a5.DOM_DELTA_LINE = 1;
    a5.DOM_DELTA_PAGE = 2
}
);
class bV {
    constructor(J) {
        this.dispatch = new o6,
            this.moveOnAll = !1,
            this.enableGlobalMoveEvents = !0,
            this.mappingState = {
                trackingData: {}
            },
            this.eventPool = new Map,
            this._allInteractiveElements = [],
            this._hitElements = [],
            this._isPointerMoveEvent = !1,
            this.rootTarget = J,
            this.hitPruneFn = this.hitPruneFn.bind(this),
            this.hitTestFn = this.hitTestFn.bind(this),
            this.mapPointerDown = this.mapPointerDown.bind(this),
            this.mapPointerMove = this.mapPointerMove.bind(this),
            this.mapPointerOut = this.mapPointerOut.bind(this),
            this.mapPointerOver = this.mapPointerOver.bind(this),
            this.mapPointerUp = this.mapPointerUp.bind(this),
            this.mapPointerUpOutside = this.mapPointerUpOutside.bind(this),
            this.mapWheel = this.mapWheel.bind(this),
            this.mappingTable = {},
            this.addEventMapping("pointerdown", this.mapPointerDown),
            this.addEventMapping("pointermove", this.mapPointerMove),
            this.addEventMapping("pointerout", this.mapPointerOut),
            this.addEventMapping("pointerleave", this.mapPointerOut),
            this.addEventMapping("pointerover", this.mapPointerOver),
            this.addEventMapping("pointerup", this.mapPointerUp),
            this.addEventMapping("pointerupoutside", this.mapPointerUpOutside),
            this.addEventMapping("wheel", this.mapWheel)
    }
    addEventMapping(J, Q) {
        if (!this.mappingTable[J])
            this.mappingTable[J] = [];
        this.mappingTable[J].push({
            fn: Q,
            priority: 0
        }),
            this.mappingTable[J].sort((Z, $) => Z.priority - $.priority)
    }
    dispatchEvent(J, Q) {
        J.propagationStopped = !1,
            J.propagationImmediatelyStopped = !1,
            this.propagate(J, Q),
            this.dispatch.emit(Q || J.type, J)
    }
    mapEvent(J) {
        if (!this.rootTarget)
            return;
        let Q = this.mappingTable[J.type];
        if (Q)
            for (let Z = 0, $ = Q.length; Z < $; Z++)
                Q[Z].fn(J);
        else
            m0(`[EventBoundary]: Event mapping not defined for ${J.type}`)
    }
    hitTest(J, Q) {
        M5.pauseUpdate = !0;
        let $ = this._isPointerMoveEvent && this.enableGlobalMoveEvents ? "hitTestMoveRecursive" : "hitTestRecursive"
            , q = this[$](this.rootTarget, this.rootTarget.eventMode, Ax.set(J, Q), this.hitTestFn, this.hitPruneFn);
        return q && q[0]
    }
    propagate(J, Q) {
        if (!J.target)
            return;
        let Z = J.composedPath();
        J.eventPhase = J.CAPTURING_PHASE;
        for (let $ = 0, q = Z.length - 1; $ < q; $++)
            if (J.currentTarget = Z[$],
                this.notifyTarget(J, Q),
                J.propagationStopped || J.propagationImmediatelyStopped)
                return;
        if (J.eventPhase = J.AT_TARGET,
            J.currentTarget = J.target,
            this.notifyTarget(J, Q),
            J.propagationStopped || J.propagationImmediatelyStopped)
            return;
        J.eventPhase = J.BUBBLING_PHASE;
        for (let $ = Z.length - 2; $ >= 0; $--)
            if (J.currentTarget = Z[$],
                this.notifyTarget(J, Q),
                J.propagationStopped || J.propagationImmediatelyStopped)
                return
    }
    all(J, Q, Z = this._allInteractiveElements) {
        if (Z.length === 0)
            return;
        J.eventPhase = J.BUBBLING_PHASE;
        let $ = Array.isArray(Q) ? Q : [Q];
        for (let q = Z.length - 1; q >= 0; q--)
            $.forEach((K) => {
                J.currentTarget = Z[q],
                    this.notifyTarget(J, K)
            }
            )
    }
    propagationPath(J) {
        let Q = [J];
        for (let Z = 0; Z < Dx && (J !== this.rootTarget && J.parent); Z++) {
            if (!J.parent)
                throw new Error("Cannot find propagation path to disconnected target");
            Q.push(J.parent),
                J = J.parent
        }
        return Q.reverse(),
            Q
    }
    hitTestMoveRecursive(J, Q, Z, $, q, K = !1) {
        let V = !1;
        if (this._interactivePrune(J))
            return null;
        if (J.eventMode === "dynamic" || Q === "dynamic")
            M5.pauseUpdate = !1;
        if (J.interactiveChildren && J.children) {
            let H = J.children;
            for (let Y = H.length - 1; Y >= 0; Y--) {
                let U = H[Y]
                    , N = this.hitTestMoveRecursive(U, this._isInteractive(Q) ? Q : U.eventMode, Z, $, q, K || q(J, Z));
                if (N) {
                    if (N.length > 0 && !N[N.length - 1].parent)
                        continue;
                    let j = J.isInteractive();
                    if (N.length > 0 || j) {
                        if (j)
                            this._allInteractiveElements.push(J);
                        N.push(J)
                    }
                    if (this._hitElements.length === 0)
                        this._hitElements = N;
                    V = !0
                }
            }
        }
        let z = this._isInteractive(Q)
            , W = J.isInteractive();
        if (W && W)
            this._allInteractiveElements.push(J);
        if (K || this._hitElements.length > 0)
            return null;
        if (V)
            return this._hitElements;
        if (z && (!q(J, Z) && $(J, Z)))
            return W ? [J] : [];
        return null
    }
    hitTestRecursive(J, Q, Z, $, q) {
        if (this._interactivePrune(J) || q(J, Z))
            return null;
        if (J.eventMode === "dynamic" || Q === "dynamic")
            M5.pauseUpdate = !1;
        if (J.interactiveChildren && J.children) {
            let z = J.children
                , W = Z;
            for (let H = z.length - 1; H >= 0; H--) {
                let Y = z[H]
                    , U = this.hitTestRecursive(Y, this._isInteractive(Q) ? Q : Y.eventMode, W, $, q);
                if (U) {
                    if (U.length > 0 && !U[U.length - 1].parent)
                        continue;
                    let N = J.isInteractive();
                    if (U.length > 0 || N)
                        U.push(J);
                    return U
                }
            }
        }
        let K = this._isInteractive(Q)
            , V = J.isInteractive();
        if (K && $(J, Z))
            return V ? [J] : [];
        return null
    }
    _isInteractive(J) {
        return J === "static" || J === "dynamic"
    }
    _interactivePrune(J) {
        if (!J || !J.visible || !J.renderable || !J.measurable)
            return !0;
        if (J.eventMode === "none")
            return !0;
        if (J.eventMode === "passive" && !J.interactiveChildren)
            return !0;
        return !1
    }
    hitPruneFn(J, Q) {
        if (J.hitArea) {
            if (J.worldTransform.applyInverse(Q, RV),
                !J.hitArea.contains(RV.x, RV.y))
                return !0
        }
        if (J.effects && J.effects.length)
            for (let Z = 0; Z < J.effects.length; Z++) {
                let $ = J.effects[Z];
                if ($.containsPoint) {
                    if (!$.containsPoint(Q, this.hitTestFn))
                        return !0
                }
            }
        return !1
    }
    hitTestFn(J, Q) {
        if (J.hitArea)
            return !0;
        if (J?.containsPoint)
            return J.worldTransform.applyInverse(Q, RV),
                J.containsPoint(RV);
        return !1
    }
    notifyTarget(J, Q) {
        if (!J.currentTarget.isInteractive())
            return;
        Q ?? (Q = J.type);
        let Z = `on${Q}`;
        J.currentTarget[Z]?.(J);
        let $ = J.eventPhase === J.CAPTURING_PHASE || J.eventPhase === J.AT_TARGET ? `${Q}capture` : Q;
        if (this._notifyListeners(J, $),
            J.eventPhase === J.AT_TARGET)
            this._notifyListeners(J, Q)
    }
    mapPointerDown(J) {
        if (!(J instanceof DJ)) {
            m0("EventBoundary cannot map a non-pointer event as a pointer event");
            return
        }
        let Q = this.createPointerEvent(J);
        if (this.dispatchEvent(Q, "pointerdown"),
            Q.pointerType === "touch")
            this.dispatchEvent(Q, "touchstart");
        else if (Q.pointerType === "mouse" || Q.pointerType === "pen") {
            let $ = Q.button === 2;
            this.dispatchEvent(Q, $ ? "rightdown" : "mousedown")
        }
        let Z = this.trackingData(J.pointerId);
        Z.pressTargetsByButton[J.button] = Q.composedPath(),
            this.freeEvent(Q)
    }
    mapPointerMove(J) {
        if (!(J instanceof DJ)) {
            m0("EventBoundary cannot map a non-pointer event as a pointer event");
            return
        }
        this._allInteractiveElements.length = 0,
            this._hitElements.length = 0,
            this._isPointerMoveEvent = !0;
        let Q = this.createPointerEvent(J);
        this._isPointerMoveEvent = !1;
        let Z = Q.pointerType === "mouse" || Q.pointerType === "pen"
            , $ = this.trackingData(J.pointerId)
            , q = this.findMountedTarget($.overTargets);
        if ($.overTargets?.length > 0 && q !== Q.target) {
            let z = J.type === "mousemove" ? "mouseout" : "pointerout"
                , W = this.createPointerEvent(J, z, q);
            if (this.dispatchEvent(W, "pointerout"),
                Z)
                this.dispatchEvent(W, "mouseout");
            if (!Q.composedPath().includes(q)) {
                let H = this.createPointerEvent(J, "pointerleave", q);
                H.eventPhase = H.AT_TARGET;
                while (H.target && !Q.composedPath().includes(H.target)) {
                    if (H.currentTarget = H.target,
                        this.notifyTarget(H),
                        Z)
                        this.notifyTarget(H, "mouseleave");
                    H.target = H.target.parent
                }
                this.freeEvent(H)
            }
            this.freeEvent(W)
        }
        if (q !== Q.target) {
            let z = J.type === "mousemove" ? "mouseover" : "pointerover"
                , W = this.clonePointerEvent(Q, z);
            if (this.dispatchEvent(W, "pointerover"),
                Z)
                this.dispatchEvent(W, "mouseover");
            let H = q?.parent;
            while (H && H !== this.rootTarget.parent) {
                if (H === Q.target)
                    break;
                H = H.parent
            }
            if (!H || H === this.rootTarget.parent) {
                let U = this.clonePointerEvent(Q, "pointerenter");
                U.eventPhase = U.AT_TARGET;
                while (U.target && U.target !== q && U.target !== this.rootTarget.parent) {
                    if (U.currentTarget = U.target,
                        this.notifyTarget(U),
                        Z)
                        this.notifyTarget(U, "mouseenter");
                    U.target = U.target.parent
                }
                this.freeEvent(U)
            }
            this.freeEvent(W)
        }
        let K = []
            , V = this.enableGlobalMoveEvents ?? !0;
        if (this.moveOnAll ? K.push("pointermove") : this.dispatchEvent(Q, "pointermove"),
            V && K.push("globalpointermove"),
            Q.pointerType === "touch")
            this.moveOnAll ? K.splice(1, 0, "touchmove") : this.dispatchEvent(Q, "touchmove"),
                V && K.push("globaltouchmove");
        if (Z)
            this.moveOnAll ? K.splice(1, 0, "mousemove") : this.dispatchEvent(Q, "mousemove"),
                V && K.push("globalmousemove"),
                this.cursor = Q.target?.cursor;
        if (K.length > 0)
            this.all(Q, K);
        this._allInteractiveElements.length = 0,
            this._hitElements.length = 0,
            $.overTargets = Q.composedPath(),
            this.freeEvent(Q)
    }
    mapPointerOver(J) {
        if (!(J instanceof DJ)) {
            m0("EventBoundary cannot map a non-pointer event as a pointer event");
            return
        }
        let Q = this.trackingData(J.pointerId)
            , Z = this.createPointerEvent(J)
            , $ = Z.pointerType === "mouse" || Z.pointerType === "pen";
        if (this.dispatchEvent(Z, "pointerover"),
            $)
            this.dispatchEvent(Z, "mouseover");
        if (Z.pointerType === "mouse")
            this.cursor = Z.target?.cursor;
        let q = this.clonePointerEvent(Z, "pointerenter");
        q.eventPhase = q.AT_TARGET;
        while (q.target && q.target !== this.rootTarget.parent) {
            if (q.currentTarget = q.target,
                this.notifyTarget(q),
                $)
                this.notifyTarget(q, "mouseenter");
            q.target = q.target.parent
        }
        Q.overTargets = Z.composedPath(),
            this.freeEvent(Z),
            this.freeEvent(q)
    }
    mapPointerOut(J) {
        if (!(J instanceof DJ)) {
            m0("EventBoundary cannot map a non-pointer event as a pointer event");
            return
        }
        let Q = this.trackingData(J.pointerId);
        if (Q.overTargets) {
            let Z = J.pointerType === "mouse" || J.pointerType === "pen"
                , $ = this.findMountedTarget(Q.overTargets)
                , q = this.createPointerEvent(J, "pointerout", $);
            if (this.dispatchEvent(q),
                Z)
                this.dispatchEvent(q, "mouseout");
            let K = this.createPointerEvent(J, "pointerleave", $);
            K.eventPhase = K.AT_TARGET;
            while (K.target && K.target !== this.rootTarget.parent) {
                if (K.currentTarget = K.target,
                    this.notifyTarget(K),
                    Z)
                    this.notifyTarget(K, "mouseleave");
                K.target = K.target.parent
            }
            Q.overTargets = null,
                this.freeEvent(q),
                this.freeEvent(K)
        }
        this.cursor = null
    }
    mapPointerUp(J) {
        if (!(J instanceof DJ)) {
            m0("EventBoundary cannot map a non-pointer event as a pointer event");
            return
        }
        let Q = performance.now()
            , Z = this.createPointerEvent(J);
        if (this.dispatchEvent(Z, "pointerup"),
            Z.pointerType === "touch")
            this.dispatchEvent(Z, "touchend");
        else if (Z.pointerType === "mouse" || Z.pointerType === "pen") {
            let V = Z.button === 2;
            this.dispatchEvent(Z, V ? "rightup" : "mouseup")
        }
        let $ = this.trackingData(J.pointerId)
            , q = this.findMountedTarget($.pressTargetsByButton[J.button])
            , K = q;
        if (q && !Z.composedPath().includes(q)) {
            let V = q;
            while (V && !Z.composedPath().includes(V)) {
                if (Z.currentTarget = V,
                    this.notifyTarget(Z, "pointerupoutside"),
                    Z.pointerType === "touch")
                    this.notifyTarget(Z, "touchendoutside");
                else if (Z.pointerType === "mouse" || Z.pointerType === "pen") {
                    let z = Z.button === 2;
                    this.notifyTarget(Z, z ? "rightupoutside" : "mouseupoutside")
                }
                V = V.parent
            }
            delete $.pressTargetsByButton[J.button],
                K = V
        }
        if (K) {
            let V = this.clonePointerEvent(Z, "click");
            if (V.target = K,
                V.path = null,
                !$.clicksByButton[J.button])
                $.clicksByButton[J.button] = {
                    clickCount: 0,
                    target: V.target,
                    timeStamp: Q
                };
            let z = $.clicksByButton[J.button];
            if (z.target === V.target && Q - z.timeStamp < 200)
                ++z.clickCount;
            else
                z.clickCount = 1;
            if (z.target = V.target,
                z.timeStamp = Q,
                V.detail = z.clickCount,
                V.pointerType === "mouse") {
                let W = V.button === 2;
                this.dispatchEvent(V, W ? "rightclick" : "click")
            } else if (V.pointerType === "touch")
                this.dispatchEvent(V, "tap");
            this.dispatchEvent(V, "pointertap"),
                this.freeEvent(V)
        }
        this.freeEvent(Z)
    }
    mapPointerUpOutside(J) {
        if (!(J instanceof DJ)) {
            m0("EventBoundary cannot map a non-pointer event as a pointer event");
            return
        }
        let Q = this.trackingData(J.pointerId)
            , Z = this.findMountedTarget(Q.pressTargetsByButton[J.button])
            , $ = this.createPointerEvent(J);
        if (Z) {
            let q = Z;
            while (q) {
                if ($.currentTarget = q,
                    this.notifyTarget($, "pointerupoutside"),
                    $.pointerType === "touch")
                    this.notifyTarget($, "touchendoutside");
                else if ($.pointerType === "mouse" || $.pointerType === "pen")
                    this.notifyTarget($, $.button === 2 ? "rightupoutside" : "mouseupoutside");
                q = q.parent
            }
            delete Q.pressTargetsByButton[J.button]
        }
        this.freeEvent($)
    }
    mapWheel(J) {
        if (!(J instanceof a5)) {
            m0("EventBoundary cannot map a non-wheel event as a wheel event");
            return
        }
        let Q = this.createWheelEvent(J);
        this.dispatchEvent(Q),
            this.freeEvent(Q)
    }
    findMountedTarget(J) {
        if (!J)
            return null;
        let Q = J[0];
        for (let Z = 1; Z < J.length; Z++)
            if (J[Z].parent === Q)
                Q = J[Z];
            else
                break;
        return Q
    }
    createPointerEvent(J, Q, Z) {
        let $ = this.allocateEvent(DJ);
        if (this.copyPointerData(J, $),
            this.copyMouseData(J, $),
            this.copyData(J, $),
            $.nativeEvent = J.nativeEvent,
            $.originalEvent = J,
            $.target = Z ?? this.hitTest($.global.x, $.global.y) ?? this._hitElements[0],
            typeof Q === "string")
            $.type = Q;
        return $
    }
    createWheelEvent(J) {
        let Q = this.allocateEvent(a5);
        return this.copyWheelData(J, Q),
            this.copyMouseData(J, Q),
            this.copyData(J, Q),
            Q.nativeEvent = J.nativeEvent,
            Q.originalEvent = J,
            Q.target = this.hitTest(Q.global.x, Q.global.y),
            Q
    }
    clonePointerEvent(J, Q) {
        let Z = this.allocateEvent(DJ);
        return Z.nativeEvent = J.nativeEvent,
            Z.originalEvent = J.originalEvent,
            this.copyPointerData(J, Z),
            this.copyMouseData(J, Z),
            this.copyData(J, Z),
            Z.target = J.target,
            Z.path = J.composedPath().slice(),
            Z.type = Q ?? Z.type,
            Z
    }
    copyWheelData(J, Q) {
        Q.deltaMode = J.deltaMode,
            Q.deltaX = J.deltaX,
            Q.deltaY = J.deltaY,
            Q.deltaZ = J.deltaZ
    }
    copyPointerData(J, Q) {
        if (!(J instanceof DJ && Q instanceof DJ))
            return;
        Q.pointerId = J.pointerId,
            Q.width = J.width,
            Q.height = J.height,
            Q.isPrimary = J.isPrimary,
            Q.pointerType = J.pointerType,
            Q.pressure = J.pressure,
            Q.tangentialPressure = J.tangentialPressure,
            Q.tiltX = J.tiltX,
            Q.tiltY = J.tiltY,
            Q.twist = J.twist
    }
    copyMouseData(J, Q) {
        if (!(J instanceof _9 && Q instanceof _9))
            return;
        Q.altKey = J.altKey,
            Q.button = J.button,
            Q.buttons = J.buttons,
            Q.client.copyFrom(J.client),
            Q.ctrlKey = J.ctrlKey,
            Q.metaKey = J.metaKey,
            Q.movement.copyFrom(J.movement),
            Q.screen.copyFrom(J.screen),
            Q.shiftKey = J.shiftKey,
            Q.global.copyFrom(J.global)
    }
    copyData(J, Q) {
        Q.isTrusted = J.isTrusted,
            Q.srcElement = J.srcElement,
            Q.timeStamp = performance.now(),
            Q.type = J.type,
            Q.detail = J.detail,
            Q.view = J.view,
            Q.which = J.which,
            Q.layer.copyFrom(J.layer),
            Q.page.copyFrom(J.page)
    }
    trackingData(J) {
        if (!this.mappingState.trackingData[J])
            this.mappingState.trackingData[J] = {
                pressTargetsByButton: {},
                clicksByButton: {},
                overTarget: null
            };
        return this.mappingState.trackingData[J]
    }
    allocateEvent(J) {
        if (!this.eventPool.has(J))
            this.eventPool.set(J, []);
        let Q = this.eventPool.get(J).pop() || new J(this);
        return Q.eventPhase = Q.NONE,
            Q.currentTarget = null,
            Q.defaultPrevented = !1,
            Q.path = null,
            Q.target = null,
            Q
    }
    freeEvent(J) {
        if (J.manager !== this)
            throw new Error("It is illegal to free an event not managed by this EventBoundary!");
        let Q = J.constructor;
        if (!this.eventPool.has(Q))
            this.eventPool.set(Q, []);
        this.eventPool.get(Q).push(J)
    }
    _notifyListeners(J, Q) {
        let Z = J.currentTarget._events[Q];
        if (!Z)
            return;
        if ("fn" in Z) {
            if (Z.once)
                J.currentTarget.removeListener(Q, Z.fn, void 0, !0);
            Z.fn.call(Z.context, J)
        } else
            for (let $ = 0, q = Z.length; $ < q && !J.propagationImmediatelyStopped; $++) {
                if (Z[$].once)
                    J.currentTarget.removeListener(Q, Z[$].fn, void 0, !0);
                Z[$].fn.call(Z[$].context, J)
            }
    }
}
var Dx = 2048, Ax, RV;
var fX = O(() => {
    wJ();
    cJ();
    B6();
    EV();
    a1();
    MV();
    _V();
    Ax = new z6,
        RV = new z6
}
);
var Ex = 1, Mx, IF = class J {
    constructor(Q) {
        this.supportsTouchEvents = "ontouchstart" in globalThis,
            this.supportsPointerEvents = !!globalThis.PointerEvent,
            this.domElement = null,
            this.resolution = 1,
            this.renderer = Q,
            this.rootBoundary = new bV(null),
            M5.init(this),
            this.autoPreventDefault = !0,
            this._eventsAdded = !1,
            this._rootPointerEvent = new DJ(null),
            this._rootWheelEvent = new a5(null),
            this.cursorStyles = {
                default: "inherit",
                pointer: "pointer"
            },
            this.features = new Proxy({
                ...J.defaultEventFeatures
            }, {
                set: (Z, $, q) => {
                    if ($ === "globalMove")
                        this.rootBoundary.enableGlobalMoveEvents = q;
                    return Z[$] = q,
                        !0
                }
            }),
            this._onPointerDown = this._onPointerDown.bind(this),
            this._onPointerMove = this._onPointerMove.bind(this),
            this._onPointerUp = this._onPointerUp.bind(this),
            this._onPointerOverOut = this._onPointerOverOut.bind(this),
            this.onWheel = this.onWheel.bind(this)
    }
    static get defaultEventMode() {
        return this._defaultEventMode
    }
    init(Q) {
        let { canvas: Z, resolution: $ } = this.renderer;
        this.setTargetElement(Z),
            this.resolution = $,
            J._defaultEventMode = Q.eventMode ?? "passive",
            Object.assign(this.features, Q.eventFeatures ?? {}),
            this.rootBoundary.enableGlobalMoveEvents = this.features.globalMove
    }
    resolutionChange(Q) {
        this.resolution = Q
    }
    destroy() {
        this.setTargetElement(null),
            this.renderer = null,
            this._currentCursor = null
    }
    setCursor(Q) {
        Q || (Q = "default");
        let Z = !0;
        if (globalThis.OffscreenCanvas && this.domElement instanceof OffscreenCanvas)
            Z = !1;
        if (this._currentCursor === Q)
            return;
        this._currentCursor = Q;
        let $ = this.cursorStyles[Q];
        if ($)
            switch (typeof $) {
                case "string":
                    if (Z)
                        this.domElement.style.cursor = $;
                    break;
                case "function":
                    $(Q);
                    break;
                case "object":
                    if (Z)
                        Object.assign(this.domElement.style, $);
                    break
            }
        else if (Z && typeof Q === "string" && !Object.prototype.hasOwnProperty.call(this.cursorStyles, Q))
            this.domElement.style.cursor = Q
    }
    get pointer() {
        return this._rootPointerEvent
    }
    _onPointerDown(Q) {
        if (!this.features.click)
            return;
        this.rootBoundary.rootTarget = this.renderer.lastObjectRendered;
        let Z = this._normalizeToPointerData(Q);
        if (this.autoPreventDefault && Z[0].isNormalized) {
            if (Q.cancelable || !("cancelable" in Q))
                Q.preventDefault()
        }
        for (let $ = 0, q = Z.length; $ < q; $++) {
            let K = Z[$]
                , V = this._bootstrapEvent(this._rootPointerEvent, K);
            this.rootBoundary.mapEvent(V)
        }
        this.setCursor(this.rootBoundary.cursor)
    }
    _onPointerMove(Q) {
        if (!this.features.move)
            return;
        this.rootBoundary.rootTarget = this.renderer.lastObjectRendered,
            M5.pointerMoved();
        let Z = this._normalizeToPointerData(Q);
        for (let $ = 0, q = Z.length; $ < q; $++) {
            let K = this._bootstrapEvent(this._rootPointerEvent, Z[$]);
            this.rootBoundary.mapEvent(K)
        }
        this.setCursor(this.rootBoundary.cursor)
    }
    _onPointerUp(Q) {
        if (!this.features.click)
            return;
        this.rootBoundary.rootTarget = this.renderer.lastObjectRendered;
        let Z = Q.target;
        if (Q.composedPath && Q.composedPath().length > 0)
            Z = Q.composedPath()[0];
        let $ = Z !== this.domElement ? "outside" : ""
            , q = this._normalizeToPointerData(Q);
        for (let K = 0, V = q.length; K < V; K++) {
            let z = this._bootstrapEvent(this._rootPointerEvent, q[K]);
            z.type += $,
                this.rootBoundary.mapEvent(z)
        }
        this.setCursor(this.rootBoundary.cursor)
    }
    _onPointerOverOut(Q) {
        if (!this.features.click)
            return;
        this.rootBoundary.rootTarget = this.renderer.lastObjectRendered;
        let Z = this._normalizeToPointerData(Q);
        for (let $ = 0, q = Z.length; $ < q; $++) {
            let K = this._bootstrapEvent(this._rootPointerEvent, Z[$]);
            this.rootBoundary.mapEvent(K)
        }
        this.setCursor(this.rootBoundary.cursor)
    }
    onWheel(Q) {
        if (!this.features.wheel)
            return;
        let Z = this.normalizeWheelEvent(Q);
        this.rootBoundary.rootTarget = this.renderer.lastObjectRendered,
            this.rootBoundary.mapEvent(Z)
    }
    setTargetElement(Q) {
        this._removeEvents(),
            this.domElement = Q,
            M5.domElement = Q,
            this._addEvents()
    }
    _addEvents() {
        if (this._eventsAdded || !this.domElement)
            return;
        M5.addTickerListener();
        let Q = this.domElement.style;
        if (Q) {
            if (globalThis.navigator.msPointerEnabled)
                Q.msContentZooming = "none",
                    Q.msTouchAction = "none";
            else if (this.supportsPointerEvents)
                Q.touchAction = "none"
        }
        if (this.supportsPointerEvents)
            globalThis.document.addEventListener("pointermove", this._onPointerMove, !0),
                this.domElement.addEventListener("pointerdown", this._onPointerDown, !0),
                this.domElement.addEventListener("pointerleave", this._onPointerOverOut, !0),
                this.domElement.addEventListener("pointerover", this._onPointerOverOut, !0),
                globalThis.addEventListener("pointerup", this._onPointerUp, !0);
        else if (globalThis.document.addEventListener("mousemove", this._onPointerMove, !0),
            this.domElement.addEventListener("mousedown", this._onPointerDown, !0),
            this.domElement.addEventListener("mouseout", this._onPointerOverOut, !0),
            this.domElement.addEventListener("mouseover", this._onPointerOverOut, !0),
            globalThis.addEventListener("mouseup", this._onPointerUp, !0),
            this.supportsTouchEvents)
            this.domElement.addEventListener("touchstart", this._onPointerDown, !0),
                this.domElement.addEventListener("touchend", this._onPointerUp, !0),
                this.domElement.addEventListener("touchmove", this._onPointerMove, !0);
        this.domElement.addEventListener("wheel", this.onWheel, {
            passive: !0,
            capture: !0
        }),
            this._eventsAdded = !0
    }
    _removeEvents() {
        if (!this._eventsAdded || !this.domElement)
            return;
        M5.removeTickerListener();
        let Q = this.domElement.style;
        if (Q) {
            if (globalThis.navigator.msPointerEnabled)
                Q.msContentZooming = "",
                    Q.msTouchAction = "";
            else if (this.supportsPointerEvents)
                Q.touchAction = ""
        }
        if (this.supportsPointerEvents)
            globalThis.document.removeEventListener("pointermove", this._onPointerMove, !0),
                this.domElement.removeEventListener("pointerdown", this._onPointerDown, !0),
                this.domElement.removeEventListener("pointerleave", this._onPointerOverOut, !0),
                this.domElement.removeEventListener("pointerover", this._onPointerOverOut, !0),
                globalThis.removeEventListener("pointerup", this._onPointerUp, !0);
        else if (globalThis.document.removeEventListener("mousemove", this._onPointerMove, !0),
            this.domElement.removeEventListener("mousedown", this._onPointerDown, !0),
            this.domElement.removeEventListener("mouseout", this._onPointerOverOut, !0),
            this.domElement.removeEventListener("mouseover", this._onPointerOverOut, !0),
            globalThis.removeEventListener("mouseup", this._onPointerUp, !0),
            this.supportsTouchEvents)
            this.domElement.removeEventListener("touchstart", this._onPointerDown, !0),
                this.domElement.removeEventListener("touchend", this._onPointerUp, !0),
                this.domElement.removeEventListener("touchmove", this._onPointerMove, !0);
        this.domElement.removeEventListener("wheel", this.onWheel, !0),
            this.domElement = null,
            this._eventsAdded = !1
    }
    mapPositionToPoint(Q, Z, $) {
        let q = this.domElement.isConnected ? this.domElement.getBoundingClientRect() : {
            x: 0,
            y: 0,
            width: this.domElement.width,
            height: this.domElement.height,
            left: 0,
            top: 0
        }
            , K = 1 / this.resolution;
        Q.x = (Z - q.left) * (this.domElement.width / q.width) * K,
            Q.y = ($ - q.top) * (this.domElement.height / q.height) * K
    }
    _normalizeToPointerData(Q) {
        let Z = [];
        if (this.supportsTouchEvents && Q instanceof TouchEvent)
            for (let $ = 0, q = Q.changedTouches.length; $ < q; $++) {
                let K = Q.changedTouches[$];
                if (typeof K.button === "undefined")
                    K.button = 0;
                if (typeof K.buttons === "undefined")
                    K.buttons = 1;
                if (typeof K.isPrimary === "undefined")
                    K.isPrimary = Q.touches.length === 1 && Q.type === "touchstart";
                if (typeof K.width === "undefined")
                    K.width = K.radiusX || 1;
                if (typeof K.height === "undefined")
                    K.height = K.radiusY || 1;
                if (typeof K.tiltX === "undefined")
                    K.tiltX = 0;
                if (typeof K.tiltY === "undefined")
                    K.tiltY = 0;
                if (typeof K.pointerType === "undefined")
                    K.pointerType = "touch";
                if (typeof K.pointerId === "undefined")
                    K.pointerId = K.identifier || 0;
                if (typeof K.pressure === "undefined")
                    K.pressure = K.force || 0.5;
                if (typeof K.twist === "undefined")
                    K.twist = 0;
                if (typeof K.tangentialPressure === "undefined")
                    K.tangentialPressure = 0;
                if (typeof K.layerX === "undefined")
                    K.layerX = K.offsetX = K.clientX;
                if (typeof K.layerY === "undefined")
                    K.layerY = K.offsetY = K.clientY;
                K.isNormalized = !0,
                    K.type = Q.type,
                    Z.push(K)
            }
        else if (!globalThis.MouseEvent || Q instanceof MouseEvent && (!this.supportsPointerEvents || !(Q instanceof globalThis.PointerEvent))) {
            let $ = Q;
            if (typeof $.isPrimary === "undefined")
                $.isPrimary = !0;
            if (typeof $.width === "undefined")
                $.width = 1;
            if (typeof $.height === "undefined")
                $.height = 1;
            if (typeof $.tiltX === "undefined")
                $.tiltX = 0;
            if (typeof $.tiltY === "undefined")
                $.tiltY = 0;
            if (typeof $.pointerType === "undefined")
                $.pointerType = "mouse";
            if (typeof $.pointerId === "undefined")
                $.pointerId = Ex;
            if (typeof $.pressure === "undefined")
                $.pressure = 0.5;
            if (typeof $.twist === "undefined")
                $.twist = 0;
            if (typeof $.tangentialPressure === "undefined")
                $.tangentialPressure = 0;
            $.isNormalized = !0,
                Z.push($)
        } else
            Z.push(Q);
        return Z
    }
    normalizeWheelEvent(Q) {
        let Z = this._rootWheelEvent;
        return this._transferMouseData(Z, Q),
            Z.deltaX = Q.deltaX,
            Z.deltaY = Q.deltaY,
            Z.deltaZ = Q.deltaZ,
            Z.deltaMode = Q.deltaMode,
            this.mapPositionToPoint(Z.screen, Q.clientX, Q.clientY),
            Z.global.copyFrom(Z.screen),
            Z.offset.copyFrom(Z.screen),
            Z.nativeEvent = Q,
            Z.type = Q.type,
            Z
    }
    _bootstrapEvent(Q, Z) {
        if (Q.originalEvent = null,
            Q.nativeEvent = Z,
            Q.pointerId = Z.pointerId,
            Q.width = Z.width,
            Q.height = Z.height,
            Q.isPrimary = Z.isPrimary,
            Q.pointerType = Z.pointerType,
            Q.pressure = Z.pressure,
            Q.tangentialPressure = Z.tangentialPressure,
            Q.tiltX = Z.tiltX,
            Q.tiltY = Z.tiltY,
            Q.twist = Z.twist,
            this._transferMouseData(Q, Z),
            this.mapPositionToPoint(Q.screen, Z.clientX, Z.clientY),
            Q.global.copyFrom(Q.screen),
            Q.offset.copyFrom(Q.screen),
            Q.isTrusted = Z.isTrusted,
            Q.type === "pointerleave")
            Q.type = "pointerout";
        if (Q.type.startsWith("mouse"))
            Q.type = Q.type.replace("mouse", "pointer");
        if (Q.type.startsWith("touch"))
            Q.type = Mx[Q.type] || Q.type;
        return Q
    }
    _transferMouseData(Q, Z) {
        Q.isTrusted = Z.isTrusted,
            Q.srcElement = Z.srcElement,
            Q.timeStamp = performance.now(),
            Q.type = Z.type,
            Q.altKey = Z.altKey,
            Q.button = Z.button,
            Q.buttons = Z.buttons,
            Q.client.x = Z.clientX,
            Q.client.y = Z.clientY,
            Q.ctrlKey = Z.ctrlKey,
            Q.metaKey = Z.metaKey,
            Q.movement.x = Z.movementX,
            Q.movement.y = Z.movementY,
            Q.page.x = Z.pageX,
            Q.page.y = Z.pageY,
            Q.relatedTarget = null,
            Q.shiftKey = Z.shiftKey
    }
}
    , r1;
var vV = O(() => {
    w0();
    fX();
    EV();
    MV();
    _V();
    Mx = {
        touchstart: "pointerdown",
        touchend: "pointerup",
        touchendoutside: "pointerupoutside",
        touchmove: "pointermove",
        touchcancel: "pointercancel"
    };
    IF.extension = {
        name: "events",
        type: [R.WebGLSystem, R.CanvasSystem, R.WebGPUSystem],
        priority: -1
    };
    IF.defaultEventFeatures = {
        move: !0,
        globalMove: !0,
        click: !0,
        wheel: !0
    };
    r1 = IF
}
);
var hX;
var xX = O(() => {
    vV();
    o1();
    hX = {
        onclick: null,
        onmousedown: null,
        onmouseenter: null,
        onmouseleave: null,
        onmousemove: null,
        onglobalmousemove: null,
        onmouseout: null,
        onmouseover: null,
        onmouseup: null,
        onmouseupoutside: null,
        onpointercancel: null,
        onpointerdown: null,
        onpointerenter: null,
        onpointerleave: null,
        onpointermove: null,
        onglobalpointermove: null,
        onpointerout: null,
        onpointerover: null,
        onpointertap: null,
        onpointerup: null,
        onpointerupoutside: null,
        onrightclick: null,
        onrightdown: null,
        onrightup: null,
        onrightupoutside: null,
        ontap: null,
        ontouchcancel: null,
        ontouchend: null,
        ontouchendoutside: null,
        ontouchmove: null,
        onglobaltouchmove: null,
        ontouchstart: null,
        onwheel: null,
        get interactive() {
            return this.eventMode === "dynamic" || this.eventMode === "static"
        },
        set interactive(J) {
            this.eventMode = J ? "static" : "passive"
        },
        _internalEventMode: void 0,
        get eventMode() {
            return this._internalEventMode ?? r1.defaultEventMode
        },
        set eventMode(J) {
            this._internalEventMode = J
        },
        isInteractive() {
            return this.eventMode === "static" || this.eventMode === "dynamic"
        },
        interactiveChildren: !0,
        hitArea: null,
        addEventListener(J, Q, Z) {
            let $ = typeof Z === "boolean" && Z || typeof Z === "object" && Z.capture
                , q = typeof Z === "object" ? Z.signal : void 0
                , K = typeof Z === "object" ? Z.once === !0 : !1
                , V = typeof Q === "function" ? void 0 : Q;
            J = $ ? `${J}capture` : J;
            let z = typeof Q === "function" ? Q : Q.handleEvent
                , W = this;
            if (q)
                q.addEventListener("abort", () => {
                    W.off(J, z, V)
                }
                );
            if (K)
                W.once(J, z, V);
            else
                W.on(J, z, V)
        },
        removeEventListener(J, Q, Z) {
            let $ = typeof Z === "boolean" && Z || typeof Z === "object" && Z.capture
                , q = typeof Q === "function" ? void 0 : Q;
            J = $ ? `${J}capture` : J,
                Q = typeof Q === "function" ? Q : Q.handleEvent,
                this.off(J, Q, q)
        },
        dispatchEvent(J) {
            if (!(J instanceof M9))
                throw new Error("Container cannot propagate events outside of the Federated Events API");
            return J.defaultPrevented = !1,
                J.path = null,
                J.target = this,
                J.manager.dispatchEvent(J),
                !J.defaultPrevented
        }
    }
}
);
var YM = O(() => {
    w0();
    zJ();
    vV();
    xX();
    e0.add(r1);
    e0.mixin(m8, hX)
}
);
class t1 {
    constructor(J) {
        this._attachedDomElements = [],
            this._renderer = J,
            this._renderer.runners.postrender.add(this),
            this._renderer.runners.init.add(this),
            this._domElement = document.createElement("div"),
            this._domElement.style.position = "absolute",
            this._domElement.style.top = "0",
            this._domElement.style.left = "0",
            this._domElement.style.pointerEvents = "none",
            this._domElement.style.zIndex = "1000"
    }
    init() {
        this._canvasObserver = new QZ({
            domElement: this._domElement,
            renderer: this._renderer
        })
    }
    addRenderable(J, Q) {
        if (!this._attachedDomElements.includes(J))
            this._attachedDomElements.push(J)
    }
    updateRenderable(J) { }
    validateRenderable(J) {
        return !0
    }
    postrender() {
        let J = this._attachedDomElements;
        if (J.length === 0) {
            this._domElement.remove();
            return
        }
        this._canvasObserver.ensureAttached();
        for (let Q = 0; Q < J.length; Q++) {
            let Z = J[Q]
                , $ = Z.element;
            if (!Z.parent || Z.globalDisplayStatus < 7)
                $?.remove(),
                    J.splice(Q, 1),
                    Q--;
            else {
                if (!this._domElement.contains($))
                    $.style.position = "absolute",
                        $.style.pointerEvents = "auto",
                        this._domElement.appendChild($);
                let { worldTransform: q, _anchor: K } = Z
                    , V = Z.width * K.x
                    , z = Z.height * K.y;
                $.style.transformOrigin = `${V}px ${z}px`,
                    $.style.transform = `matrix(${q.a}, ${q.b}, ${q.c}, ${q.d}, ${q.tx - V}, ${q.ty - z})`,
                    $.style.opacity = Z.groupAlpha.toString()
            }
        }
    }
    destroy() {
        this._renderer.runners.postrender.remove(this);
        for (let J = 0; J < this._attachedDomElements.length; J++)
            this._attachedDomElements[J].element?.remove();
        this._attachedDomElements.length = 0,
            this._domElement.remove(),
            this._canvasObserver.destroy(),
            this._renderer = null
    }
}
var gX = O(() => {
    w0();
    l1();
    t1.extension = {
        type: [R.WebGLPipes, R.WebGPUPipes, R.CanvasPipes],
        name: "dom"
    }
}
);
var JJ;
var _5 = O(() => {
    VJ();
    zJ();
    JJ = class JJ extends m8 {
        constructor(J) {
            super(J);
            this.canBundle = !0,
                this.allowChildren = !1,
                this._roundPixels = 0,
                this._lastUsed = -1,
                this._gpuData = Object.create(null),
                this._bounds = new E6(0, 1, 0, 0),
                this._boundsDirty = !0
        }
        get bounds() {
            if (!this._boundsDirty)
                return this._bounds;
            return this.updateBounds(),
                this._boundsDirty = !1,
                this._bounds
        }
        get roundPixels() {
            return !!this._roundPixels
        }
        set roundPixels(J) {
            this._roundPixels = J ? 1 : 0
        }
        containsPoint(J) {
            let Q = this.bounds
                , { x: Z, y: $ } = J;
            return Z >= Q.minX && Z <= Q.maxX && $ >= Q.minY && $ <= Q.maxY
        }
        onViewUpdate() {
            if (this._didViewChangeTick++,
                this._boundsDirty = !0,
                this.didViewUpdate)
                return;
            this.didViewUpdate = !0;
            let J = this.renderGroup || this.parentRenderGroup;
            if (J)
                J.onChildViewUpdate(this)
        }
        destroy(J) {
            super.destroy(J),
                this._bounds = null;
            for (let Q in this._gpuData)
                this._gpuData[Q].destroy?.();
            this._gpuData = null
        }
        collectRenderablesSimple(J, Q, Z) {
            let { renderPipes: $ } = Q;
            $.blendMode.setBlendMode(this, this.groupBlendMode, J),
                $[this.renderPipeId].addRenderable(this, J),
                this.didViewUpdate = !1;
            let K = this.children
                , V = K.length;
            for (let z = 0; z < V; z++)
                K[z].collectRenderables(J, Q, Z)
        }
    }
}
);
var mX = O(() => {
    cJ();
    _5()
}
);
var LF = O(() => {
    l1();
    mX();
    gX()
}
);
var UM = O(() => {
    w0();
    gX();
    LF();
    l1();
    mX();
    e0.add(t1)
}
);
var X7;
var Q5 = O(() => {
    X7 = ((J) => {
        return J[J.Low = 0] = "Low",
            J[J.Normal = 1] = "Normal",
            J[J.High = 2] = "High",
            J
    }
    )(X7 || {})
}
);
var cX;
var dX = O(() => {
    cX = {
        createCanvas: (J, Q) => {
            let Z = document.createElement("canvas");
            return Z.width = J,
                Z.height = Q,
                Z
        }
        ,
        createImage: () => new Image,
        getCanvasRenderingContext2D: () => CanvasRenderingContext2D,
        getWebGLRenderingContext: () => WebGLRenderingContext,
        getNavigator: () => navigator,
        getBaseUrl: () => document.baseURI ?? global.location.href,
        getFontFaceSet: () => document.fonts,
        fetch: (J, Q) => fetch(J, Q).catch((e) => console.log(e)),
        parseXML: (J) => {
            return new DOMParser().parseFromString(J, "text/xml")
        }
    }
}
);
var NM, a0;
var M6 = O(() => {
    dX();
    NM = cX,
        a0 = {
            get() {
                return NM
            },
            set(J) {
                NM = J
            }
        }
}
);
function r5(J) {
    if (typeof J !== "string")
        throw new TypeError(`Path must be a string. Received ${JSON.stringify(J)}`)
}
function SV(J) {
    return J.split("?")[0].split("#")[0]
}
function _x(J) {
    return J.replace(/[.*+?^${}()|[\]\\]/g, "\\$&")
}
function Rx(J, Q, Z) {
    return J.replace(new RegExp(_x(Q), "g"), Z)
}
function bx(J, Q) {
    let Z = ""
        , $ = 0
        , q = -1
        , K = 0
        , V = -1;
    for (let z = 0; z <= J.length; ++z) {
        if (z < J.length)
            V = J.charCodeAt(z);
        else if (V === 47)
            break;
        else
            V = 47;
        if (V === 47) {
            if (q === z - 1 || K === 1)
                ;
            else if (q !== z - 1 && K === 2) {
                if (Z.length < 2 || $ !== 2 || Z.charCodeAt(Z.length - 1) !== 46 || Z.charCodeAt(Z.length - 2) !== 46) {
                    if (Z.length > 2) {
                        let W = Z.lastIndexOf("/");
                        if (W !== Z.length - 1) {
                            if (W === -1)
                                Z = "",
                                    $ = 0;
                            else
                                Z = Z.slice(0, W),
                                    $ = Z.length - 1 - Z.lastIndexOf("/");
                            q = z,
                                K = 0;
                            continue
                        }
                    } else if (Z.length === 2 || Z.length === 1) {
                        Z = "",
                            $ = 0,
                            q = z,
                            K = 0;
                        continue
                    }
                }
                if (Q) {
                    if (Z.length > 0)
                        Z += "/..";
                    else
                        Z = "..";
                    $ = 2
                }
            } else {
                if (Z.length > 0)
                    Z += `/${J.slice(q + 1, z)}`;
                else
                    Z = J.slice(q + 1, z);
                $ = z - q - 1
            }
            q = z,
                K = 0
        } else if (V === 46 && K !== -1)
            ++K;
        else
            K = -1
    }
    return Z
}
var y7;
var wQ = O(() => {
    M6();
    y7 = {
        toPosix(J) {
            return Rx(J, "\\", "/")
        },
        isUrl(J) {
            return /^https?:/.test(this.toPosix(J))
        },
        isDataUrl(J) {
            return /^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(J)
        },
        isBlobUrl(J) {
            return J.startsWith("blob:")
        },
        hasProtocol(J) {
            return /^[^/:]+:/.test(this.toPosix(J))
        },
        getProtocol(J) {
            r5(J),
                J = this.toPosix(J);
            let Q = /^file:\/\/\//.exec(J);
            if (Q)
                return Q[0];
            let Z = /^[^/:]+:\/{0,2}/.exec(J);
            if (Z)
                return Z[0];
            return ""
        },
        toAbsolute(J, Q, Z) {
            if (r5(J),
                this.isDataUrl(J) || this.isBlobUrl(J))
                return J;
            let $ = SV(this.toPosix(Q ?? a0.get().getBaseUrl()))
                , q = SV(this.toPosix(Z ?? this.rootname($)));
            if (J = this.toPosix(J),
                J.startsWith("/"))
                return y7.join(q, J.slice(1));
            return this.isAbsolute(J) ? J : this.join($, J)
        },
        normalize(J) {
            if (r5(J),
                J.length === 0)
                return ".";
            if (this.isDataUrl(J) || this.isBlobUrl(J))
                return J;
            J = this.toPosix(J);
            let Q = ""
                , Z = J.startsWith("/");
            if (this.hasProtocol(J))
                Q = this.rootname(J),
                    J = J.slice(Q.length);
            let $ = J.endsWith("/");
            if (J = bx(J, !1),
                J.length > 0 && $)
                J += "/";
            if (Z)
                return `/${J}`;
            return Q + J
        },
        isAbsolute(J) {
            if (r5(J),
                J = this.toPosix(J),
                this.hasProtocol(J))
                return !0;
            return J.startsWith("/")
        },
        join(...J) {
            if (J.length === 0)
                return ".";
            let Q;
            for (let Z = 0; Z < J.length; ++Z) {
                let $ = J[Z];
                if (r5($),
                    $.length > 0)
                    if (Q === void 0)
                        Q = $;
                    else {
                        let q = J[Z - 1] ?? "";
                        if (this.joinExtensions.includes(this.extname(q).toLowerCase()))
                            Q += `/../${$}`;
                        else
                            Q += `/${$}`
                    }
            }
            if (Q === void 0)
                return ".";
            return this.normalize(Q)
        },
        dirname(J) {
            if (r5(J),
                J.length === 0)
                return ".";
            J = this.toPosix(J);
            let Q = J.charCodeAt(0)
                , Z = Q === 47
                , $ = -1
                , q = !0
                , K = this.getProtocol(J)
                , V = J;
            J = J.slice(K.length);
            for (let z = J.length - 1; z >= 1; --z)
                if (Q = J.charCodeAt(z),
                    Q === 47) {
                    if (!q) {
                        $ = z;
                        break
                    }
                } else
                    q = !1;
            if ($ === -1)
                return Z ? "/" : this.isUrl(V) ? K + J : K;
            if (Z && $ === 1)
                return "//";
            return K + J.slice(0, $)
        },
        rootname(J) {
            r5(J),
                J = this.toPosix(J);
            let Q = "";
            if (J.startsWith("/"))
                Q = "/";
            else
                Q = this.getProtocol(J);
            if (this.isUrl(J)) {
                let Z = J.indexOf("/", Q.length);
                if (Z !== -1)
                    Q = J.slice(0, Z);
                else
                    Q = J;
                if (!Q.endsWith("/"))
                    Q += "/"
            }
            return Q
        },
        basename(J, Q) {
            if (r5(J),
                Q)
                r5(Q);
            J = SV(this.toPosix(J));
            let Z = 0, $ = -1, q = !0, K;
            if (Q !== void 0 && Q.length > 0 && Q.length <= J.length) {
                if (Q.length === J.length && Q === J)
                    return "";
                let V = Q.length - 1
                    , z = -1;
                for (K = J.length - 1; K >= 0; --K) {
                    let W = J.charCodeAt(K);
                    if (W === 47) {
                        if (!q) {
                            Z = K + 1;
                            break
                        }
                    } else {
                        if (z === -1)
                            q = !1,
                                z = K + 1;
                        if (V >= 0)
                            if (W === Q.charCodeAt(V)) {
                                if (--V === -1)
                                    $ = K
                            } else
                                V = -1,
                                    $ = z
                    }
                }
                if (Z === $)
                    $ = z;
                else if ($ === -1)
                    $ = J.length;
                return J.slice(Z, $)
            }
            for (K = J.length - 1; K >= 0; --K)
                if (J.charCodeAt(K) === 47) {
                    if (!q) {
                        Z = K + 1;
                        break
                    }
                } else if ($ === -1)
                    q = !1,
                        $ = K + 1;
            if ($ === -1)
                return "";
            return J.slice(Z, $)
        },
        extname(J) {
            r5(J),
                J = SV(this.toPosix(J));
            let Q = -1
                , Z = 0
                , $ = -1
                , q = !0
                , K = 0;
            for (let V = J.length - 1; V >= 0; --V) {
                let z = J.charCodeAt(V);
                if (z === 47) {
                    if (!q) {
                        Z = V + 1;
                        break
                    }
                    continue
                }
                if ($ === -1)
                    q = !1,
                        $ = V + 1;
                if (z === 46) {
                    if (Q === -1)
                        Q = V;
                    else if (K !== 1)
                        K = 1
                } else if (Q !== -1)
                    K = -1
            }
            if (Q === -1 || $ === -1 || K === 0 || K === 1 && Q === $ - 1 && Q === Z + 1)
                return "";
            return J.slice(Q, $)
        },
        parse(J) {
            r5(J);
            let Q = {
                root: "",
                dir: "",
                base: "",
                ext: "",
                name: ""
            };
            if (J.length === 0)
                return Q;
            J = SV(this.toPosix(J));
            let Z = J.charCodeAt(0), $ = this.isAbsolute(J), q, K = "";
            if (Q.root = this.rootname(J),
                $ || this.hasProtocol(J))
                q = 1;
            else
                q = 0;
            let V = -1
                , z = 0
                , W = -1
                , H = !0
                , Y = J.length - 1
                , U = 0;
            for (; Y >= q; --Y) {
                if (Z = J.charCodeAt(Y),
                    Z === 47) {
                    if (!H) {
                        z = Y + 1;
                        break
                    }
                    continue
                }
                if (W === -1)
                    H = !1,
                        W = Y + 1;
                if (Z === 46) {
                    if (V === -1)
                        V = Y;
                    else if (U !== 1)
                        U = 1
                } else if (V !== -1)
                    U = -1
            }
            if (V === -1 || W === -1 || U === 0 || U === 1 && V === W - 1 && V === z + 1) {
                if (W !== -1)
                    if (z === 0 && $)
                        Q.base = Q.name = J.slice(1, W);
                    else
                        Q.base = Q.name = J.slice(z, W)
            } else {
                if (z === 0 && $)
                    Q.name = J.slice(1, V),
                        Q.base = J.slice(1, W);
                else
                    Q.name = J.slice(z, V),
                        Q.base = J.slice(z, W);
                Q.ext = J.slice(V, W)
            }
            if (Q.dir = this.dirname(J),
                K)
                Q.dir = K + Q.dir;
            return Q
        },
        sep: "/",
        delimiter: ":",
        joinExtensions: [".html"]
    }
}
);
var BJ = (J, Q, Z = !1) => {
    if (!Array.isArray(J))
        J = [J];
    if (!Q)
        return J;
    return J.map(($) => {
        if (typeof $ === "string" || Z)
            return Q($);
        return $
    }
    )
}
    ;
var U$ = () => { }
    ;
function wM(J, Q, Z, $, q) {
    let K = Q[Z];
    for (let V = 0; V < K.length; V++) {
        let z = K[V];
        if (Z < Q.length - 1)
            wM(J.replace($[Z], z), Q, Z + 1, $, q);
        else
            q.push(J.replace($[Z], z))
    }
}
function pX(J) {
    let Q = /\{(.*?)\}/g
        , Z = J.match(Q)
        , $ = [];
    if (Z) {
        let q = [];
        Z.forEach((K) => {
            let V = K.substring(1, K.length - 1).split(",");
            q.push(V)
        }
        ),
            wM(J, q, 0, Z, $)
    } else
        $.push(J);
    return $
}
var uX = () => { }
    ;
var jQ = (J) => !Array.isArray(J);
var e1 = () => { }
    ;
class AJ {
    constructor() {
        this._defaultBundleIdentifierOptions = {
            connector: "-",
            createBundleAssetId: (J, Q) => `${J}${this._bundleIdConnector}${Q}`,
            extractAssetIdFromBundle: (J, Q) => Q.replace(`${J}${this._bundleIdConnector}`, "")
        },
            this._bundleIdConnector = this._defaultBundleIdentifierOptions.connector,
            this._createBundleAssetId = this._defaultBundleIdentifierOptions.createBundleAssetId,
            this._extractAssetIdFromBundle = this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,
            this._assetMap = {},
            this._preferredOrder = [],
            this._parsers = [],
            this._resolverHash = {},
            this._bundles = {}
    }
    setBundleIdentifier(J) {
        if (this._bundleIdConnector = J.connector ?? this._bundleIdConnector,
            this._createBundleAssetId = J.createBundleAssetId ?? this._createBundleAssetId,
            this._extractAssetIdFromBundle = J.extractAssetIdFromBundle ?? this._extractAssetIdFromBundle,
            this._extractAssetIdFromBundle("foo", this._createBundleAssetId("foo", "bar")) !== "bar")
            throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")
    }
    prefer(...J) {
        J.forEach((Q) => {
            if (this._preferredOrder.push(Q),
                !Q.priority)
                Q.priority = Object.keys(Q.params)
        }
        ),
            this._resolverHash = {}
    }
    set basePath(J) {
        this._basePath = J
    }
    get basePath() {
        return this._basePath
    }
    set rootPath(J) {
        this._rootPath = J
    }
    get rootPath() {
        return this._rootPath
    }
    get parsers() {
        return this._parsers
    }
    reset() {
        this.setBundleIdentifier(this._defaultBundleIdentifierOptions),
            this._assetMap = {},
            this._preferredOrder = [],
            this._resolverHash = {},
            this._rootPath = null,
            this._basePath = null,
            this._manifest = null,
            this._bundles = {},
            this._defaultSearchParams = null
    }
    setDefaultSearchParams(J) {
        if (typeof J === "string")
            this._defaultSearchParams = J;
        else {
            let Q = J;
            this._defaultSearchParams = Object.keys(Q).map((Z) => `${encodeURIComponent(Z)}=${encodeURIComponent(Q[Z])}`).join("&")
        }
    }
    getAlias(J) {
        let { alias: Q, src: Z } = J;
        return BJ(Q || Z, (q) => {
            if (typeof q === "string")
                return q;
            if (Array.isArray(q))
                return q.map((K) => K?.src ?? K);
            if (q?.src)
                return q.src;
            return q
        }
            , !0)
    }
    addManifest(J) {
        if (this._manifest)
            m0("[Resolver] Manifest already exists, this will be overwritten");
        this._manifest = J,
            J.bundles.forEach((Q) => {
                this.addBundle(Q.name, Q.assets)
            }
            )
    }
    addBundle(J, Q) {
        let Z = []
            , $ = Q;
        if (!Array.isArray(Q))
            $ = Object.entries(Q).map(([q, K]) => {
                if (typeof K === "string" || Array.isArray(K))
                    return {
                        alias: q,
                        src: K
                    };
                return {
                    alias: q,
                    ...K
                }
            }
            );
        $.forEach((q) => {
            let { src: K, alias: V } = q, z;
            if (typeof V === "string") {
                let W = this._createBundleAssetId(J, V);
                Z.push(W),
                    z = [V, W]
            } else {
                let W = V.map((H) => this._createBundleAssetId(J, H));
                Z.push(...W),
                    z = [...V, ...W]
            }
            this.add({
                ...q,
                ...{
                    alias: z,
                    src: K
                }
            })
        }
        ),
            this._bundles[J] = Z
    }
    add(J) {
        let Q = [];
        if (Array.isArray(J))
            Q.push(...J);
        else
            Q.push(J);
        let Z;
        Z = (q) => {
            if (this.hasKey(q))
                m0(`[Resolver] already has key: ${q} overwriting`)
        }
            ,
            BJ(Q).forEach((q) => {
                let { src: K } = q
                    , { data: V, format: z, loadParser: W, parser: H } = q
                    , Y = BJ(K).map((j) => {
                        if (typeof j === "string")
                            return pX(j);
                        return Array.isArray(j) ? j : [j]
                    }
                    )
                    , U = this.getAlias(q);
                Array.isArray(U) ? U.forEach(Z) : Z(U);
                let N = [];
                Y.forEach((j) => {
                    j.forEach((k) => {
                        let L = {};
                        if (typeof k !== "object") {
                            L.src = k;
                            for (let F = 0; F < this._parsers.length; F++) {
                                let P = this._parsers[F];
                                if (P.test(k)) {
                                    L = P.parse(k);
                                    break
                                }
                            }
                        } else {
                            if (V = k.data ?? V,
                                z = k.format ?? z,
                                k.loadParser || k.parser)
                                W = k.loadParser ?? W,
                                    H = k.parser ?? H;
                            L = {
                                ...L,
                                ...k
                            }
                        }
                        if (!U)
                            throw new Error(`[Resolver] alias is undefined for this asset: ${L.src}`);
                        L = this._buildResolvedAsset(L, {
                            aliases: U,
                            data: V,
                            format: z,
                            loadParser: W,
                            parser: H
                        }),
                            N.push(L)
                    }
                    )
                }
                ),
                    U.forEach((j) => {
                        this._assetMap[j] = N
                    }
                    )
            }
            )
    }
    resolveBundle(J) {
        let Q = jQ(J);
        J = BJ(J);
        let Z = {};
        return J.forEach(($) => {
            let q = this._bundles[$];
            if (q) {
                let K = this.resolve(q)
                    , V = {};
                for (let z in K) {
                    let W = K[z];
                    V[this._extractAssetIdFromBundle($, z)] = W
                }
                Z[$] = V
            }
        }
        ),
            Q ? Z[J[0]] : Z
    }
    resolveUrl(J) {
        let Q = this.resolve(J);
        if (typeof J !== "string") {
            let Z = {};
            for (let $ in Q)
                Z[$] = Q[$].src;
            return Z
        }
        return Q.src
    }
    resolve(J) {
        let Q = jQ(J);
        J = BJ(J);
        let Z = {};
        return J.forEach(($) => {
            if (!this._resolverHash[$])
                if (this._assetMap[$]) {
                    let q = this._assetMap[$]
                        , K = this._getPreferredOrder(q);
                    K?.priority.forEach((V) => {
                        K.params[V].forEach((z) => {
                            let W = q.filter((H) => {
                                if (H[V])
                                    return H[V] === z;
                                return !1
                            }
                            );
                            if (W.length)
                                q = W
                        }
                        )
                    }
                    ),
                        this._resolverHash[$] = q[0]
                } else
                    this._resolverHash[$] = this._buildResolvedAsset({
                        alias: [$],
                        src: $
                    }, {});
            Z[$] = this._resolverHash[$]
        }
        ),
            Q ? Z[J[0]] : Z
    }
    hasKey(J) {
        return !!this._assetMap[J]
    }
    hasBundle(J) {
        return !!this._bundles[J]
    }
    _getPreferredOrder(J) {
        for (let Q = 0; Q < J.length; Q++) {
            let Z = J[Q]
                , $ = this._preferredOrder.find((q) => q.params.format.includes(Z.format));
            if ($)
                return $
        }
        return this._preferredOrder[0]
    }
    _appendDefaultSearchParams(J) {
        if (!this._defaultSearchParams)
            return J;
        let Q = /\?/.test(J) ? "&" : "?";
        return `${J}${Q}${this._defaultSearchParams}`
    }
    _buildResolvedAsset(J, Q) {
        let { aliases: Z, data: $, loadParser: q, parser: K, format: V } = Q;
        if (this._basePath || this._rootPath)
            J.src = y7.toAbsolute(J.src, this._basePath, this._rootPath);
        return J.alias = Z ?? J.alias ?? [J.src],
            J.src = this._appendDefaultSearchParams(J.src),
            J.data = {
                ...$ || {},
                ...J.data
            },
            J.loadParser = q ?? J.loadParser,
            J.parser = K ?? J.parser,
            J.format = V ?? J.format ?? FF(J.src),
            J
    }
}
function FF(J) {
    return J.split(".").pop().split("?").shift().split("#").shift()
}
var BQ = O(() => {
    B6();
    wQ();
    U$();
    uX();
    e1();
    AJ.RETINA_PREFIX = /@([0-9\.]+)x/
}
);
var N$ = (J, Q) => {
    let Z = Q.split("?")[1];
    if (Z)
        J += `?${Z}`;
    return J
}
    ;
var TV = () => { }
    ;
var jM = class J {
    constructor(Q, Z) {
        this.linkedSheets = [];
        let $ = Q;
        if (Q?.source instanceof $6)
            $ = {
                texture: Q,
                data: Z
            };
        let { texture: q, data: K, cachePrefix: V = "" } = $;
        this.cachePrefix = V,
            this._texture = q instanceof _0 ? q : null,
            this.textureSource = q.source,
            this.textures = {},
            this.animations = {},
            this.data = K;
        let z = parseFloat(K.meta.scale);
        if (z)
            this.resolution = z,
                q.source.resolution = this.resolution;
        else
            this.resolution = q.source._resolution;
        this._frames = this.data.frames,
            this._frameKeys = Object.keys(this._frames),
            this._batchIndex = 0,
            this._callback = null
    }
    parse() {
        return new Promise((Q) => {
            if (this._callback = Q,
                this._batchIndex = 0,
                this._frameKeys.length <= J.BATCH_SIZE)
                this._processFrames(0),
                    this._processAnimations(),
                    this._parseComplete();
            else
                this._nextBatch()
        }
        )
    }
    _processFrames(Q) {
        let Z = Q
            , $ = J.BATCH_SIZE;
        while (Z - Q < $ && Z < this._frameKeys.length) {
            let q = this._frameKeys[Z]
                , K = this._frames[q]
                , V = K.frame;
            if (V) {
                let z = null
                    , W = null
                    , H = K.trimmed !== !1 && K.sourceSize ? K.sourceSize : K.frame
                    , Y = new v8(0, 0, Math.floor(H.w) / this.resolution, Math.floor(H.h) / this.resolution);
                if (K.rotated)
                    z = new v8(Math.floor(V.x) / this.resolution, Math.floor(V.y) / this.resolution, Math.floor(V.h) / this.resolution, Math.floor(V.w) / this.resolution);
                else
                    z = new v8(Math.floor(V.x) / this.resolution, Math.floor(V.y) / this.resolution, Math.floor(V.w) / this.resolution, Math.floor(V.h) / this.resolution);
                if (K.trimmed !== !1 && K.spriteSourceSize)
                    W = new v8(Math.floor(K.spriteSourceSize.x) / this.resolution, Math.floor(K.spriteSourceSize.y) / this.resolution, Math.floor(V.w) / this.resolution, Math.floor(V.h) / this.resolution);
                this.textures[q] = new _0({
                    source: this.textureSource,
                    frame: z,
                    orig: Y,
                    trim: W,
                    rotate: K.rotated ? 2 : 0,
                    defaultAnchor: K.anchor,
                    defaultBorders: K.borders,
                    label: q.toString()
                })
            }
            Z++
        }
    }
    _processAnimations() {
        let Q = this.data.animations || {};
        for (let Z in Q) {
            this.animations[Z] = [];
            for (let $ = 0; $ < Q[Z].length; $++) {
                let q = Q[Z][$];
                this.animations[Z].push(this.textures[q])
            }
        }
    }
    _parseComplete() {
        let Q = this._callback;
        this._callback = null,
            this._batchIndex = 0,
            Q.call(this, this.textures)
    }
    _nextBatch() {
        this._processFrames(this._batchIndex * J.BATCH_SIZE),
            this._batchIndex++,
            setTimeout(() => {
                if (this._batchIndex * J.BATCH_SIZE < this._frameKeys.length)
                    this._nextBatch();
                else
                    this._processAnimations(),
                        this._parseComplete()
            }
                , 0)
    }
    destroy(Q = !1) {
        for (let Z in this.textures)
            this.textures[Z].destroy();
        if (this._frames = null,
            this._frameKeys = null,
            this.data = null,
            this.textures = null,
            Q)
            this._texture?.destroy(),
                this.textureSource.destroy();
        this._texture = null,
            this.textureSource = null,
            this.linkedSheets = []
    }
}
    , yV;
var lX = O(() => {
    E7();
    n7();
    W6();
    jM.BATCH_SIZE = 1000;
    yV = jM
}
);
function BM(J, Q, Z) {
    let $ = {};
    if (J.forEach((q) => {
        $[q] = Q
    }
    ),
        Object.keys(Q.textures).forEach((q) => {
            $[`${Q.cachePrefix}${q}`] = Q.textures[q]
        }
        ),
        !Z) {
        let q = y7.dirname(J[0]);
        Q.linkedSheets.forEach((K, V) => {
            let z = BM([`${q}/${Q.data.meta.related_multi_packs[V]}`], K, !0);
            Object.assign($, z)
        }
        )
    }
    return $
}
var vx, oX;
var nX = O(() => {
    Q5();
    BQ();
    TV();
    w0();
    W6();
    wQ();
    lX();
    vx = ["jpg", "png", "jpeg", "avif", "webp", "basis", "etc2", "bc7", "bc6h", "bc5", "bc4", "bc3", "bc2", "bc1", "eac", "astc"];
    oX = {
        extension: R.Asset,
        cache: {
            test: (J) => J instanceof yV,
            getCacheableAssets: (J, Q) => BM(J, Q, !1)
        },
        resolver: {
            extension: {
                type: R.ResolveParser,
                name: "resolveSpritesheet"
            },
            test: (J) => {
                let Z = J.split("?")[0].split(".")
                    , $ = Z.pop()
                    , q = Z.pop();
                return $ === "json" && vx.includes(q)
            }
            ,
            parse: (J) => {
                let Q = J.split(".");
                return {
                    resolution: parseFloat(AJ.RETINA_PREFIX.exec(J)?.[1] ?? "1"),
                    format: Q[Q.length - 2],
                    src: J
                }
            }
        },
        loader: {
            name: "spritesheetLoader",
            id: "spritesheet",
            extension: {
                type: R.LoadParser,
                priority: X7.Normal,
                name: "spritesheetLoader"
            },
            async testParse(J, Q) {
                return y7.extname(Q.src).toLowerCase() === ".json" && !!J.frames
            },
            async parse(J, Q, Z) {
                let { texture: $, imageFilename: q, textureOptions: K, cachePrefix: V } = Q?.data ?? {}
                    , z = y7.dirname(Q.src);
                if (z && z.lastIndexOf("/") !== z.length - 1)
                    z += "/";
                let W;
                if ($ instanceof _0)
                    W = $;
                else {
                    let U = N$(z + (q ?? J.meta.image), Q.src);
                    W = (await Z.load([{
                        src: U,
                        data: K
                    }]))[U]
                }
                let H = new yV({
                    texture: W.source,
                    data: J,
                    cachePrefix: V
                });
                await H.parse();
                let Y = J?.meta?.related_multi_packs;
                if (Array.isArray(Y)) {
                    let U = [];
                    for (let j of Y) {
                        if (typeof j !== "string")
                            continue;
                        let k = z + j;
                        if (Q.data?.ignoreMultiPack)
                            continue;
                        k = N$(k, Q.src),
                            U.push(Z.load({
                                src: k,
                                data: {
                                    textureOptions: K,
                                    ignoreMultiPack: !0
                                }
                            }))
                    }
                    let N = await Promise.all(U);
                    H.linkedSheets = N,
                        N.forEach((j) => {
                            j.linkedSheets = [H].concat(H.linkedSheets.filter((k) => k !== j))
                        }
                        )
                }
                return H
            },
            async unload(J, Q, Z) {
                await Z.unload(J.textureSource._sourceOrigin),
                    J.destroy(!1)
            }
        }
    }
}
);
var sX = O(() => {
    w0();
    nX();
    e0.add(oX)
}
);
function Jq(J, Q, Z) {
    let { width: $, height: q } = Z.orig
        , K = Z.trim;
    if (K) {
        let { width: V, height: z } = K;
        J.minX = K.x - Q._x * $,
            J.maxX = J.minX + V,
            J.minY = K.y - Q._y * q,
            J.maxY = J.minY + z
    } else
        J.minX = -Q._x * $,
            J.maxX = J.minX + $,
            J.minY = -Q._y * q,
            J.maxY = J.minY + q
}
var fV = () => { }
    ;
var WJ;
var kQ = O(() => {
    WQ();
    W6();
    fV();
    O6();
    _5();
    WJ = class WJ extends JJ {
        constructor(J = _0.EMPTY) {
            if (J instanceof _0)
                J = {
                    texture: J
                };
            let { texture: Q = _0.EMPTY, anchor: Z, roundPixels: $, width: q, height: K, ...V } = J;
            super({
                label: "Sprite",
                ...V
            });
            if (this.renderPipeId = "sprite",
                this.batched = !0,
                this._visualBounds = {
                    minX: 0,
                    maxX: 1,
                    minY: 0,
                    maxY: 0
                },
                this._anchor = new g6({
                    _onUpdate: () => {
                        this.onViewUpdate()
                    }
                }),
                Z)
                this.anchor = Z;
            else if (Q.defaultAnchor)
                this.anchor = Q.defaultAnchor;
            if (this.texture = Q,
                this.allowChildren = !1,
                this.roundPixels = $ ?? !1,
                q !== void 0)
                this.width = q;
            if (K !== void 0)
                this.height = K
        }
        static from(J, Q = !1) {
            if (J instanceof _0)
                return new WJ(J);
            return new WJ(_0.from(J, Q))
        }
        set texture(J) {
            J || (J = _0.EMPTY);
            let Q = this._texture;
            if (Q === J)
                return;
            if (Q && Q.dynamic)
                Q.off("update", this.onViewUpdate, this);
            if (J.dynamic)
                J.on("update", this.onViewUpdate, this);
            if (this._texture = J,
                this._width)
                this._setWidth(this._width, this._texture.orig.width);
            if (this._height)
                this._setHeight(this._height, this._texture.orig.height);
            this.onViewUpdate()
        }
        get texture() {
            return this._texture
        }
        get visualBounds() {
            return Jq(this._visualBounds, this._anchor, this._texture),
                this._visualBounds
        }
        get sourceBounds() {
            return c0("8.6.1", "Sprite.sourceBounds is deprecated, use visualBounds instead."),
                this.visualBounds
        }
        updateBounds() {
            let J = this._anchor
                , Q = this._texture
                , Z = this._bounds
                , { width: $, height: q } = Q.orig;
            Z.minX = -J._x * $,
                Z.maxX = Z.minX + $,
                Z.minY = -J._y * q,
                Z.maxY = Z.minY + q
        }
        destroy(J = !1) {
            if (super.destroy(J),
                typeof J === "boolean" ? J : J?.texture) {
                let Z = typeof J === "boolean" ? J : J?.textureSource;
                this._texture.destroy(Z)
            }
            this._texture = null,
                this._visualBounds = null,
                this._bounds = null,
                this._anchor = null,
                this._gpuData = null
        }
        get anchor() {
            return this._anchor
        }
        set anchor(J) {
            typeof J === "number" ? this._anchor.set(J) : this._anchor.copyFrom(J)
        }
        get width() {
            return Math.abs(this.scale.x) * this._texture.orig.width
        }
        set width(J) {
            this._setWidth(J, this._texture.orig.width),
                this._width = J
        }
        get height() {
            return Math.abs(this.scale.y) * this._texture.orig.height
        }
        set height(J) {
            this._setHeight(J, this._texture.orig.height),
                this._height = J
        }
        getSize(J) {
            return J || (J = {}),
                J.width = Math.abs(this.scale.x) * this._texture.orig.width,
                J.height = Math.abs(this.scale.y) * this._texture.orig.height,
                J
        }
        setSize(J, Q) {
            if (typeof J === "object")
                Q = J.height ?? J.width,
                    J = J.width;
            else
                Q ?? (Q = J);
            J !== void 0 && this._setWidth(J, this._texture.orig.width),
                Q !== void 0 && this._setHeight(Q, this._texture.orig.height)
        }
    }
}
);
function w$(J, Q, Z) {
    let $ = Sx;
    J.measurable = !0,
        D9(J, Z, $),
        Q.addBoundsMask($),
        J.measurable = !1
}
var Sx;
var Qq = O(() => {
    VJ();
    aQ();
    Sx = new E6
}
);
function j$(J, Q, Z) {
    let $ = dJ.get();
    J.measurable = !0;
    let q = M7.get().identity()
        , K = kM(J, Z, q);
    tQ(J, $, K),
        J.measurable = !1,
        Q.addBoundsMask($),
        M7.return(q),
        dJ.return($)
}
function kM(J, Q, Z) {
    if (!J)
        return m0("Mask bounds, renderable is not inside the root container"),
            Z;
    if (J !== Q)
        kM(J.parent, Q, Z),
            J.updateLocalTransform(),
            Z.append(J.localTransform);
    return Z
}
var Zq = O(() => {
    d1();
    HQ();
    B6()
}
);
class $q {
    constructor(J) {
        if (this.priority = 0,
            this.inverse = !1,
            this.pipe = "alphaMask",
            J?.mask)
            this.init(J.mask)
    }
    init(J) {
        this.mask = J,
            this.renderMaskToTexture = !(J instanceof WJ),
            this.mask.renderable = this.renderMaskToTexture,
            this.mask.includeInBuild = !this.renderMaskToTexture,
            this.mask.measurable = !1
    }
    reset() {
        this.mask.measurable = !0,
            this.mask = null
    }
    addBounds(J, Q) {
        if (!this.inverse)
            w$(this.mask, J, Q)
    }
    addLocalBounds(J, Q) {
        j$(this.mask, J, Q)
    }
    containsPoint(J, Q) {
        let Z = this.mask;
        return Q(Z, J)
    }
    destroy() {
        this.reset()
    }
    static test(J) {
        return J instanceof WJ
    }
}
var iX = O(() => {
    w0();
    kQ();
    Qq();
    Zq();
    $q.extension = R.MaskEffect
}
);
class qq {
    constructor(J) {
        if (this.priority = 0,
            this.pipe = "colorMask",
            J?.mask)
            this.init(J.mask)
    }
    init(J) {
        this.mask = J
    }
    destroy() { }
    static test(J) {
        return typeof J === "number"
    }
}
var aX = O(() => {
    w0();
    qq.extension = R.MaskEffect
}
);
class Kq {
    constructor(J) {
        if (this.priority = 0,
            this.pipe = "stencilMask",
            J?.mask)
            this.init(J.mask)
    }
    init(J) {
        this.mask = J,
            this.mask.includeInBuild = !1,
            this.mask.measurable = !1
    }
    reset() {
        this.mask.measurable = !0,
            this.mask.includeInBuild = !0,
            this.mask = null
    }
    addBounds(J, Q) {
        w$(this.mask, J, Q)
    }
    addLocalBounds(J, Q) {
        j$(this.mask, J, Q)
    }
    containsPoint(J, Q) {
        let Z = this.mask;
        return Q(Z, J)
    }
    destroy() {
        this.reset()
    }
    static test(J) {
        return J instanceof m8
    }
}
var rX = O(() => {
    w0();
    zJ();
    Qq();
    Zq();
    Kq.extension = R.MaskEffect
}
);
var kJ;
var $Z = O(() => {
    M6();
    w0();
    n7();
    kJ = class kJ extends $6 {
        constructor(J) {
            if (!J.resource)
                J.resource = a0.get().createCanvas();
            if (!J.width) {
                if (J.width = J.resource.width,
                    !J.autoDensity)
                    J.width /= J.resolution
            }
            if (!J.height) {
                if (J.height = J.resource.height,
                    !J.autoDensity)
                    J.height /= J.resolution
            }
            super(J);
            this.uploadMethodId = "image",
                this.autoDensity = J.autoDensity,
                this.resizeCanvas(),
                this.transparent = !!J.transparent
        }
        resizeCanvas() {
            if (this.autoDensity && "style" in this.resource)
                this.resource.style.width = `${this.width}px`,
                    this.resource.style.height = `${this.height}px`;
            if (this.resource.width !== this.pixelWidth || this.resource.height !== this.pixelHeight)
                this.resource.width = this.pixelWidth,
                    this.resource.height = this.pixelHeight
        }
        resize(J = this.width, Q = this.height, Z = this._resolution) {
            let $ = super.resize(J, Q, Z);
            if ($)
                this.resizeCanvas();
            return $
        }
        static test(J) {
            return globalThis.HTMLCanvasElement && J instanceof HTMLCanvasElement || globalThis.OffscreenCanvas && J instanceof OffscreenCanvas
        }
        get context2D() {
            return this._context2D || (this._context2D = this.resource.getContext("2d"))
        }
    }
        ;
    kJ.extension = R.TextureSource
}
);
var pJ;
var qZ = O(() => {
    w0();
    n7();
    pJ = class pJ extends $6 {
        constructor(J) {
            super(J);
            this.uploadMethodId = "image",
                this.autoGarbageCollect = !0
        }
        static test(J) {
            return globalThis.HTMLImageElement && J instanceof HTMLImageElement || typeof ImageBitmap !== "undefined" && J instanceof ImageBitmap || globalThis.VideoFrame && J instanceof VideoFrame
        }
    }
        ;
    pJ.extension = R.TextureSource
}
);
async function Vq() {
    return GF ?? (GF = (async () => {
        let Q = a0.get().createCanvas(1, 1).getContext("webgl");
        if (!Q)
            return "premultiply-alpha-on-upload";
        let Z = await new Promise((V) => {
            let z = document.createElement("video");
            z.onloadeddata = () => V(z),
                z.onerror = () => V(null),
                z.autoplay = !1,
                z.crossOrigin = "anonymous",
                z.preload = "auto",
                z.src = "data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",
                z.load()
        }
        );
        if (!Z)
            return "premultiply-alpha-on-upload";
        let $ = Q.createTexture();
        Q.bindTexture(Q.TEXTURE_2D, $);
        let q = Q.createFramebuffer();
        Q.bindFramebuffer(Q.FRAMEBUFFER, q),
            Q.framebufferTexture2D(Q.FRAMEBUFFER, Q.COLOR_ATTACHMENT0, Q.TEXTURE_2D, $, 0),
            Q.pixelStorei(Q.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !1),
            Q.pixelStorei(Q.UNPACK_COLORSPACE_CONVERSION_WEBGL, Q.NONE),
            Q.texImage2D(Q.TEXTURE_2D, 0, Q.RGBA, Q.RGBA, Q.UNSIGNED_BYTE, Z);
        let K = new Uint8Array(4);
        return Q.readPixels(0, 0, 1, 1, Q.RGBA, Q.UNSIGNED_BYTE, K),
            Q.deleteFramebuffer(q),
            Q.deleteTexture($),
            Q.getExtension("WEBGL_lose_context")?.loseContext(),
            K[0] <= K[3] ? "premultiplied-alpha" : "premultiply-alpha-on-upload"
    }
    )()),
        GF
}
var GF;
var hV = O(() => {
    M6()
}
);
var tX, CQ;
var xV = O(() => {
    w0();
    E9();
    hV();
    n7();
    tX = class J extends $6 {
        constructor(Q) {
            super(Q);
            if (this.isReady = !1,
                this.uploadMethodId = "video",
                Q = {
                    ...J.defaultOptions,
                    ...Q
                },
                this._autoUpdate = !0,
                this._isConnectedToTicker = !1,
                this._updateFPS = Q.updateFPS || 0,
                this._msToNextUpdate = 0,
                this.autoPlay = Q.autoPlay !== !1,
                this.alphaMode = Q.alphaMode ?? "premultiply-alpha-on-upload",
                this._videoFrameRequestCallback = this._videoFrameRequestCallback.bind(this),
                this._videoFrameRequestCallbackHandle = null,
                this._load = null,
                this._resolve = null,
                this._reject = null,
                this._onCanPlay = this._onCanPlay.bind(this),
                this._onCanPlayThrough = this._onCanPlayThrough.bind(this),
                this._onError = this._onError.bind(this),
                this._onPlayStart = this._onPlayStart.bind(this),
                this._onPlayStop = this._onPlayStop.bind(this),
                this._onSeeked = this._onSeeked.bind(this),
                Q.autoLoad !== !1)
                this.load()
        }
        updateFrame() {
            if (this.destroyed)
                return;
            if (this._updateFPS) {
                let Q = n6.shared.elapsedMS * this.resource.playbackRate;
                this._msToNextUpdate = Math.floor(this._msToNextUpdate - Q)
            }
            if (!this._updateFPS || this._msToNextUpdate <= 0)
                this._msToNextUpdate = this._updateFPS ? Math.floor(1000 / this._updateFPS) : 0;
            if (this.isValid)
                this.update()
        }
        _videoFrameRequestCallback() {
            if (this.updateFrame(),
                this.destroyed)
                this._videoFrameRequestCallbackHandle = null;
            else
                this._videoFrameRequestCallbackHandle = this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)
        }
        get isValid() {
            return !!this.resource.videoWidth && !!this.resource.videoHeight
        }
        async load() {
            if (this._load)
                return this._load;
            let Q = this.resource
                , Z = this.options;
            if ((Q.readyState === Q.HAVE_ENOUGH_DATA || Q.readyState === Q.HAVE_FUTURE_DATA) && Q.width && Q.height)
                Q.complete = !0;
            if (Q.addEventListener("play", this._onPlayStart),
                Q.addEventListener("pause", this._onPlayStop),
                Q.addEventListener("seeked", this._onSeeked),
                !this._isSourceReady()) {
                if (!Z.preload)
                    Q.addEventListener("canplay", this._onCanPlay);
                Q.addEventListener("canplaythrough", this._onCanPlayThrough),
                    Q.addEventListener("error", this._onError, !0)
            } else
                this._mediaReady();
            return this.alphaMode = await Vq(),
                this._load = new Promise(($, q) => {
                    if (this.isValid)
                        $(this);
                    else {
                        if (this._resolve = $,
                            this._reject = q,
                            Z.preloadTimeoutMs !== void 0)
                            this._preloadTimeout = setTimeout(() => {
                                this._onError(new ErrorEvent(`Preload exceeded timeout of ${Z.preloadTimeoutMs}ms`))
                            }
                            );
                        Q.load()
                    }
                }
                ),
                this._load
        }
        _onError(Q) {
            if (this.resource.removeEventListener("error", this._onError, !0),
                this.emit("error", Q),
                this._reject)
                this._reject(Q),
                    this._reject = null,
                    this._resolve = null
        }
        _isSourcePlaying() {
            let Q = this.resource;
            return !Q.paused && !Q.ended
        }
        _isSourceReady() {
            return this.resource.readyState > 2
        }
        _onPlayStart() {
            if (!this.isValid)
                this._mediaReady();
            this._configureAutoUpdate()
        }
        _onPlayStop() {
            this._configureAutoUpdate()
        }
        _onSeeked() {
            if (this._autoUpdate && !this._isSourcePlaying())
                this._msToNextUpdate = 0,
                    this.updateFrame(),
                    this._msToNextUpdate = 0
        }
        _onCanPlay() {
            this.resource.removeEventListener("canplay", this._onCanPlay),
                this._mediaReady()
        }
        _onCanPlayThrough() {
            if (this.resource.removeEventListener("canplaythrough", this._onCanPlay),
                this._preloadTimeout)
                clearTimeout(this._preloadTimeout),
                    this._preloadTimeout = void 0;
            this._mediaReady()
        }
        _mediaReady() {
            let Q = this.resource;
            if (this.isValid)
                this.isReady = !0,
                    this.resize(Q.videoWidth, Q.videoHeight);
            if (this._msToNextUpdate = 0,
                this.updateFrame(),
                this._msToNextUpdate = 0,
                this._resolve)
                this._resolve(this),
                    this._resolve = null,
                    this._reject = null;
            if (this._isSourcePlaying())
                this._onPlayStart();
            else if (this.autoPlay)
                this.resource.play()
        }
        destroy() {
            this._configureAutoUpdate();
            let Q = this.resource;
            if (Q)
                Q.removeEventListener("play", this._onPlayStart),
                    Q.removeEventListener("pause", this._onPlayStop),
                    Q.removeEventListener("seeked", this._onSeeked),
                    Q.removeEventListener("canplay", this._onCanPlay),
                    Q.removeEventListener("canplaythrough", this._onCanPlayThrough),
                    Q.removeEventListener("error", this._onError, !0),
                    Q.pause(),
                    Q.src = "",
                    Q.load();
            super.destroy()
        }
        get autoUpdate() {
            return this._autoUpdate
        }
        set autoUpdate(Q) {
            if (Q !== this._autoUpdate)
                this._autoUpdate = Q,
                    this._configureAutoUpdate()
        }
        get updateFPS() {
            return this._updateFPS
        }
        set updateFPS(Q) {
            if (Q !== this._updateFPS)
                this._updateFPS = Q,
                    this._configureAutoUpdate()
        }
        _configureAutoUpdate() {
            if (this._autoUpdate && this._isSourcePlaying())
                if (!this._updateFPS && this.resource.requestVideoFrameCallback) {
                    if (this._isConnectedToTicker)
                        n6.shared.remove(this.updateFrame, this),
                            this._isConnectedToTicker = !1,
                            this._msToNextUpdate = 0;
                    if (this._videoFrameRequestCallbackHandle === null)
                        this._videoFrameRequestCallbackHandle = this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)
                } else {
                    if (this._videoFrameRequestCallbackHandle !== null)
                        this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),
                            this._videoFrameRequestCallbackHandle = null;
                    if (!this._isConnectedToTicker)
                        n6.shared.add(this.updateFrame, this),
                            this._isConnectedToTicker = !0,
                            this._msToNextUpdate = 0
                }
            else {
                if (this._videoFrameRequestCallbackHandle !== null)
                    this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),
                        this._videoFrameRequestCallbackHandle = null;
                if (this._isConnectedToTicker)
                    n6.shared.remove(this.updateFrame, this),
                        this._isConnectedToTicker = !1,
                        this._msToNextUpdate = 0
            }
        }
        static test(Q) {
            return globalThis.HTMLVideoElement && Q instanceof HTMLVideoElement
        }
    }
        ;
    tX.extension = R.TextureSource;
    tX.defaultOptions = {
        ...$6.defaultOptions,
        autoLoad: !0,
        autoPlay: !0,
        updateFPS: 0,
        crossorigin: !0,
        loop: !1,
        muted: !0,
        playsinline: !0,
        preload: !1
    };
    tX.MIME_TYPES = {
        ogv: "video/ogg",
        mov: "video/quicktime",
        m4v: "video/mp4"
    };
    CQ = tX
}
);
class CM {
    constructor() {
        this._parsers = [],
            this._cache = new Map,
            this._cacheMap = new Map
    }
    reset() {
        this._cacheMap.clear(),
            this._cache.clear()
    }
    has(J) {
        return this._cache.has(J)
    }
    get(J) {
        let Q = this._cache.get(J);
        if (!Q)
            m0(`[Assets] Asset id ${J} was not found in the Cache`);
        return Q
    }
    set(J, Q) {
        let Z = BJ(J), $;
        for (let z = 0; z < this.parsers.length; z++) {
            let W = this.parsers[z];
            if (W.test(Q)) {
                $ = W.getCacheableAssets(Z, Q);
                break
            }
        }
        let q = new Map(Object.entries($ || {}));
        if (!$)
            Z.forEach((z) => {
                q.set(z, Q)
            }
            );
        let K = [...q.keys()]
            , V = {
                cacheKeys: K,
                keys: Z
            };
        Z.forEach((z) => {
            this._cacheMap.set(z, V)
        }
        ),
            K.forEach((z) => {
                let W = $ ? $[z] : Q;
                if (this._cache.has(z) && this._cache.get(z) !== W)
                    m0("[Cache] already has key:", z);
                this._cache.set(z, q.get(z))
            }
            )
    }
    remove(J) {
        if (!this._cacheMap.has(J)) {
            m0(`[Assets] Asset id ${J} was not found in the Cache`);
            return
        }
        let Q = this._cacheMap.get(J);
        Q.cacheKeys.forEach(($) => {
            this._cache.delete($)
        }
        ),
            Q.keys.forEach(($) => {
                this._cacheMap.delete($)
            }
            )
    }
    get parsers() {
        return this._parsers
    }
}
var H6;
var t5 = O(() => {
    B6();
    U$();
    H6 = new CM
}
);
function OM(J = {}) {
    let Q = J && J.resource
        , Z = Q ? J.resource : J
        , $ = Q ? J : {
            resource: J
        };
    for (let q = 0; q < PF.length; q++) {
        let K = PF[q];
        if (K.test(Z))
            return new K($)
    }
    throw new Error(`Could not find a source type for resource: ${$.resource}`)
}
function DF(J = {}, Q = !1) {
    let Z = J && J.resource
        , $ = Z ? J.resource : J
        , q = Z ? J : {
            resource: J
        };
    if (!Q && H6.has($))
        return H6.get($);
    let K = new _0({
        source: OM(q)
    });
    if (K.on("destroy", () => {
        if (H6.has($))
            H6.remove($)
    }
    ),
        !Q)
        H6.set($, K);
    return K
}
function AF(J, Q = !1) {
    if (typeof J === "string")
        return H6.get(J);
    else if (J instanceof $6)
        return new _0({
            source: J
        });
    return DF(J, Q)
}
var PF;
var eX = O(() => {
    t5();
    w0();
    n7();
    W6();
    PF = [];
    e0.handleByList(R.TextureSource, PF);
    _0.from = AF;
    $6.from = OM
}
);
var J2 = O(() => {
    w0();
    iX();
    aX();
    rX();
    GV();
    $Z();
    qZ();
    xV();
    eX();
    jV();
    e0.add($q, qq, Kq, CQ, pJ, kJ, eQ)
}
);
class QJ {
    constructor(J) {
        this.resources = Object.create(null),
            this._dirty = !0;
        let Q = 0;
        for (let Z in J) {
            let $ = J[Z];
            this.setResource($, Q++)
        }
        this._updateKey()
    }
    _updateKey() {
        if (!this._dirty)
            return;
        this._dirty = !1;
        let J = []
            , Q = 0;
        for (let Z in this.resources)
            J[Q++] = this.resources[Z]._resourceId;
        this._key = J.join("|")
    }
    setResource(J, Q) {
        let Z = this.resources[Q];
        if (J === Z)
            return;
        if (Z)
            J.off?.("change", this.onResourceChange, this);
        J.on?.("change", this.onResourceChange, this),
            this.resources[Q] = J,
            this._dirty = !0
    }
    getResource(J) {
        return this.resources[J]
    }
    _touch(J) {
        let Q = this.resources;
        for (let Z in Q)
            Q[Z]._touched = J
    }
    destroy() {
        let J = this.resources;
        for (let Q in J)
            J[Q].off?.("change", this.onResourceChange, this);
        this.resources = null
    }
    onResourceChange(J) {
        if (this._dirty = !0,
            J.destroyed) {
            let Q = this.resources;
            for (let Z in Q)
                if (Q[Z] === J)
                    Q[Z] = null
        } else
            this._updateKey()
    }
}
var R9 = () => { }
    ;
function KZ(J, Q, Z) {
    let $ = 2166136261;
    for (let q = 0; q < Q; q++)
        $ ^= J[q].uid,
            $ = Math.imul($, 16777619),
            $ >>>= 0;
    return IM[$] || Tx(J, Q, $, Z)
}
function Tx(J, Q, Z, $) {
    let q = {}
        , K = 0;
    for (let z = 0; z < $; z++) {
        let W = z < Q ? J[z] : _0.EMPTY.source;
        q[K++] = W.source,
            q[K++] = W.style
    }
    let V = new QJ(q);
    return IM[Z] = V,
        V
}
var IM;
var zq = O(() => {
    R9();
    W6();
    IM = {}
}
);
class e5 {
    constructor(J) {
        if (typeof J === "number")
            this.rawBinaryData = new ArrayBuffer(J);
        else if (J instanceof Uint8Array)
            this.rawBinaryData = J.buffer;
        else
            this.rawBinaryData = J;
        this.uint32View = new Uint32Array(this.rawBinaryData),
            this.float32View = new Float32Array(this.rawBinaryData),
            this.size = this.rawBinaryData.byteLength
    }
    get int8View() {
        if (!this._int8View)
            this._int8View = new Int8Array(this.rawBinaryData);
        return this._int8View
    }
    get uint8View() {
        if (!this._uint8View)
            this._uint8View = new Uint8Array(this.rawBinaryData);
        return this._uint8View
    }
    get int16View() {
        if (!this._int16View)
            this._int16View = new Int16Array(this.rawBinaryData);
        return this._int16View
    }
    get int32View() {
        if (!this._int32View)
            this._int32View = new Int32Array(this.rawBinaryData);
        return this._int32View
    }
    get float64View() {
        if (!this._float64Array)
            this._float64Array = new Float64Array(this.rawBinaryData);
        return this._float64Array
    }
    get bigUint64View() {
        if (!this._bigUint64Array)
            this._bigUint64Array = new BigUint64Array(this.rawBinaryData);
        return this._bigUint64Array
    }
    view(J) {
        return this[`${J}View`]
    }
    destroy() {
        this.rawBinaryData = null,
            this._int8View = null,
            this._uint8View = null,
            this._int16View = null,
            this.uint16View = null,
            this._int32View = null,
            this.uint32View = null,
            this.float32View = null
    }
    static sizeOf(J) {
        switch (J) {
            case "int8":
            case "uint8":
                return 1;
            case "int16":
            case "uint16":
                return 2;
            case "int32":
            case "uint32":
            case "float32":
                return 4;
            default:
                throw new Error(`${J} isn't a valid view type`)
        }
    }
}
var gV = () => { }
    ;
function B$(J, Q) {
    let Z = J.byteLength / 8 | 0
        , $ = new Float64Array(J, 0, Z);
    new Float64Array(Q, 0, Z).set($);
    let K = J.byteLength - Z * 8;
    if (K > 0) {
        let V = new Uint8Array(J, Z * 8, K);
        new Uint8Array(Q, Z * 8, K).set(V)
    }
}
var mV = () => { }
    ;
var Q2, Z7;
var OQ = O(() => {
    Q2 = {
        normal: "normal-npm",
        add: "add-npm",
        screen: "screen-npm"
    },
        Z7 = ((J) => {
            return J[J.DISABLED = 0] = "DISABLED",
                J[J.RENDERING_MASK_ADD = 1] = "RENDERING_MASK_ADD",
                J[J.MASK_ACTIVE = 2] = "MASK_ACTIVE",
                J[J.INVERSE_MASK_ACTIVE = 3] = "INVERSE_MASK_ACTIVE",
                J[J.RENDERING_MASK_REMOVE = 4] = "RENDERING_MASK_REMOVE",
                J[J.NONE = 5] = "NONE",
                J
        }
        )(Z7 || {})
}
);
function J9(J, Q) {
    if (Q.alphaMode === "no-premultiply-alpha")
        return Q2[J] || J;
    return J
}
var k$ = O(() => {
    OQ()
}
);
function Wq() {
    if (!Z2 || Z2?.isContextLost())
        Z2 = a0.get().createCanvas().getContext("webgl", {});
    return Z2
}
var Z2;
var cV = O(() => {
    M6()
}
);
function fx(J) {
    let Q = "";
    for (let Z = 0; Z < J; ++Z) {
        if (Z > 0)
            Q += `
else `;
        if (Z < J - 1)
            Q += `if(test == ${Z}.0){}`
    }
    return Q
}
function Hq(J, Q) {
    if (J === 0)
        throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");
    let Z = Q.createShader(Q.FRAGMENT_SHADER);
    try {
        while (!0) {
            let $ = yx.replace(/%forloop%/gi, fx(J));
            if (Q.shaderSource(Z, $),
                Q.compileShader(Z),
                !Q.getShaderParameter(Z, Q.COMPILE_STATUS))
                J = J / 2 | 0;
            else
                break
        }
    } finally {
        Q.deleteShader(Z)
    }
    return J
}
var yx;
var dV = O(() => {
    yx = ["precision mediump float;", "void main(void){", "float test = 0.1;", "%forloop%", "gl_FragColor = vec4(0.0);", "}"].join(`
`)
}
);
function $2() {
    if (Yq)
        return Yq;
    let J = Wq();
    return Yq = J.getParameter(J.MAX_TEXTURE_IMAGE_UNITS),
        Yq = Hq(Yq, J),
        J.getExtension("WEBGL_lose_context")?.loseContext(),
        Yq
}
var Yq = null;
var q2 = O(() => {
    cV();
    dV()
}
);
class pV {
    constructor() {
        this.ids = Object.create(null),
            this.textures = [],
            this.count = 0
    }
    clear() {
        for (let J = 0; J < this.count; J++) {
            let Q = this.textures[J];
            this.textures[J] = null,
                this.ids[Q.uid] = null
        }
        this.count = 0
    }
}
var K2 = () => { }
    ;
class V2 {
    constructor() {
        this.renderPipeId = "batch",
            this.action = "startBatch",
            this.start = 0,
            this.size = 0,
            this.textures = new pV,
            this.blendMode = "normal",
            this.topology = "triangle-strip",
            this.canBundle = !0
    }
    destroy() {
        this.textures = null,
            this.gpuBindGroup = null,
            this.bindGroup = null,
            this.batcher = null
    }
}
function LM() {
    return EF > 0 ? GM[--EF] : new V2
}
function FM(J) {
    GM[EF++] = J
}
var GM, EF = 0, uV = 0, PM = class J {
    constructor(Q) {
        if (this.uid = i8("batcher"),
            this.dirty = !0,
            this.batchIndex = 0,
            this.batches = [],
            this._elements = [],
            Q = {
                ...J.defaultOptions,
                ...Q
            },
            !Q.maxTextures)
            c0("v8.8.0", "maxTextures is a required option for Batcher now, please pass it in the options"),
                Q.maxTextures = $2();
        let { maxTextures: Z, attributesInitialSize: $, indicesInitialSize: q } = Q;
        this.attributeBuffer = new e5($ * 4),
            this.indexBuffer = new Uint16Array(q),
            this.maxTextures = Z
    }
    begin() {
        this.elementSize = 0,
            this.elementStart = 0,
            this.indexSize = 0,
            this.attributeSize = 0;
        for (let Q = 0; Q < this.batchIndex; Q++)
            FM(this.batches[Q]);
        this.batchIndex = 0,
            this._batchIndexStart = 0,
            this._batchIndexSize = 0,
            this.dirty = !0
    }
    add(Q) {
        this._elements[this.elementSize++] = Q,
            Q._indexStart = this.indexSize,
            Q._attributeStart = this.attributeSize,
            Q._batcher = this,
            this.indexSize += Q.indexSize,
            this.attributeSize += Q.attributeSize * this.vertexSize
    }
    checkAndUpdateTexture(Q, Z) {
        let $ = Q._batch.textures.ids[Z._source.uid];
        if (!$ && $ !== 0)
            return !1;
        return Q._textureId = $,
            Q.texture = Z,
            !0
    }
    updateElement(Q) {
        this.dirty = !0;
        let Z = this.attributeBuffer;
        if (Q.packAsQuad)
            this.packQuadAttributes(Q, Z.float32View, Z.uint32View, Q._attributeStart, Q._textureId);
        else
            this.packAttributes(Q, Z.float32View, Z.uint32View, Q._attributeStart, Q._textureId)
    }
    break(Q) {
        let Z = this._elements;
        if (!Z[this.elementStart])
            return;
        let $ = LM()
            , q = $.textures;
        q.clear();
        let K = Z[this.elementStart]
            , V = J9(K.blendMode, K.texture._source)
            , z = K.topology;
        if (this.attributeSize * 4 > this.attributeBuffer.size)
            this._resizeAttributeBuffer(this.attributeSize * 4);
        if (this.indexSize > this.indexBuffer.length)
            this._resizeIndexBuffer(this.indexSize);
        let W = this.attributeBuffer.float32View
            , H = this.attributeBuffer.uint32View
            , Y = this.indexBuffer
            , U = this._batchIndexSize
            , N = this._batchIndexStart
            , j = "startBatch"
            , k = this.maxTextures;
        for (let L = this.elementStart; L < this.elementSize; ++L) {
            let F = Z[L];
            Z[L] = null;
            let M = F.texture._source
                , v = J9(F.blendMode, M)
                , E = V !== v || z !== F.topology;
            if (M._batchTick === uV && !E) {
                if (F._textureId = M._textureBindLocation,
                    U += F.indexSize,
                    F.packAsQuad)
                    this.packQuadAttributes(F, W, H, F._attributeStart, F._textureId),
                        this.packQuadIndex(Y, F._indexStart, F._attributeStart / this.vertexSize);
                else
                    this.packAttributes(F, W, H, F._attributeStart, F._textureId),
                        this.packIndex(F, Y, F._indexStart, F._attributeStart / this.vertexSize);
                F._batch = $;
                continue
            }
            if (M._batchTick = uV,
                q.count >= k || E)
                this._finishBatch($, N, U - N, q, V, z, Q, j),
                    j = "renderBatch",
                    N = U,
                    V = v,
                    z = F.topology,
                    $ = LM(),
                    q = $.textures,
                    q.clear(),
                    ++uV;
            if (F._textureId = M._textureBindLocation = q.count,
                q.ids[M.uid] = q.count,
                q.textures[q.count++] = M,
                F._batch = $,
                U += F.indexSize,
                F.packAsQuad)
                this.packQuadAttributes(F, W, H, F._attributeStart, F._textureId),
                    this.packQuadIndex(Y, F._indexStart, F._attributeStart / this.vertexSize);
            else
                this.packAttributes(F, W, H, F._attributeStart, F._textureId),
                    this.packIndex(F, Y, F._indexStart, F._attributeStart / this.vertexSize)
        }
        if (q.count > 0)
            this._finishBatch($, N, U - N, q, V, z, Q, j),
                N = U,
                ++uV;
        this.elementStart = this.elementSize,
            this._batchIndexStart = N,
            this._batchIndexSize = U
    }
    _finishBatch(Q, Z, $, q, K, V, z, W) {
        Q.gpuBindGroup = null,
            Q.bindGroup = null,
            Q.action = W,
            Q.batcher = this,
            Q.textures = q,
            Q.blendMode = K,
            Q.topology = V,
            Q.start = Z,
            Q.size = $,
            ++uV,
            this.batches[this.batchIndex++] = Q,
            z.add(Q)
    }
    finish(Q) {
        this.break(Q)
    }
    ensureAttributeBuffer(Q) {
        if (Q * 4 <= this.attributeBuffer.size)
            return;
        this._resizeAttributeBuffer(Q * 4)
    }
    ensureIndexBuffer(Q) {
        if (Q <= this.indexBuffer.length)
            return;
        this._resizeIndexBuffer(Q)
    }
    _resizeAttributeBuffer(Q) {
        let Z = Math.max(Q, this.attributeBuffer.size * 2)
            , $ = new e5(Z);
        B$(this.attributeBuffer.rawBinaryData, $.rawBinaryData),
            this.attributeBuffer = $
    }
    _resizeIndexBuffer(Q) {
        let Z = this.indexBuffer
            , $ = Math.max(Q, Z.length * 1.5);
        $ += $ % 2;
        let q = $ > 65535 ? new Uint32Array($) : new Uint16Array($);
        if (q.BYTES_PER_ELEMENT !== Z.BYTES_PER_ELEMENT)
            for (let K = 0; K < Z.length; K++)
                q[K] = Z[K];
        else
            B$(Z.buffer, q.buffer);
        this.indexBuffer = q
    }
    packQuadIndex(Q, Z, $) {
        Q[Z] = $ + 0,
            Q[Z + 1] = $ + 1,
            Q[Z + 2] = $ + 2,
            Q[Z + 3] = $ + 0,
            Q[Z + 4] = $ + 2,
            Q[Z + 5] = $ + 3
    }
    packIndex(Q, Z, $, q) {
        let { indices: K, indexSize: V, indexOffset: z, attributeOffset: W } = Q;
        for (let H = 0; H < V; H++)
            Z[$++] = q + K[H + z] - W
    }
    destroy() {
        for (let Q = 0; Q < this.batches.length; Q++)
            FM(this.batches[Q]);
        this.batches = null;
        for (let Q = 0; Q < this._elements.length; Q++)
            this._elements[Q]._batch = null;
        this._elements = null,
            this.indexBuffer = null,
            this.attributeBuffer.destroy(),
            this.attributeBuffer = null
    }
}
    , z2;
var W2 = O(() => {
    l7();
    gV();
    O6();
    mV();
    k$();
    q2();
    K2();
    GM = [];
    PM.defaultOptions = {
        maxTextures: null,
        attributesInitialSize: 4,
        indicesInitialSize: 6
    };
    z2 = PM
}
);
var a8;
var Q9 = O(() => {
    a8 = ((J) => {
        return J[J.MAP_READ = 1] = "MAP_READ",
            J[J.MAP_WRITE = 2] = "MAP_WRITE",
            J[J.COPY_SRC = 4] = "COPY_SRC",
            J[J.COPY_DST = 8] = "COPY_DST",
            J[J.INDEX = 16] = "INDEX",
            J[J.VERTEX = 32] = "VERTEX",
            J[J.UNIFORM = 64] = "UNIFORM",
            J[J.STORAGE = 128] = "STORAGE",
            J[J.INDIRECT = 256] = "INDIRECT",
            J[J.QUERY_RESOLVE = 512] = "QUERY_RESOLVE",
            J[J.STATIC = 1024] = "STATIC",
            J
    }
    )(a8 || {})
}
);
var P7;
var b9 = O(() => {
    wJ();
    l7();
    Q9();
    P7 = class P7 extends o6 {
        constructor(J) {
            let { data: Q, size: Z } = J
                , { usage: $, label: q, shrinkToFit: K } = J;
            super();
            if (this.uid = i8("buffer"),
                this._resourceType = "buffer",
                this._resourceId = i8("resource"),
                this._touched = 0,
                this._updateID = 1,
                this._dataInt32 = null,
                this.shrinkToFit = !0,
                this.destroyed = !1,
                Q instanceof Array)
                Q = new Float32Array(Q);
            this._data = Q,
                Z ?? (Z = Q?.byteLength);
            let V = !!Q;
            this.descriptor = {
                size: Z,
                usage: $,
                mappedAtCreation: V,
                label: q
            },
                this.shrinkToFit = K ?? !0
        }
        get data() {
            return this._data
        }
        set data(J) {
            this.setDataWithSize(J, J.length, !0)
        }
        get dataInt32() {
            if (!this._dataInt32)
                this._dataInt32 = new Int32Array(this.data.buffer);
            return this._dataInt32
        }
        get static() {
            return !!(this.descriptor.usage & a8.STATIC)
        }
        set static(J) {
            if (J)
                this.descriptor.usage |= a8.STATIC;
            else
                this.descriptor.usage &= ~a8.STATIC
        }
        setDataWithSize(J, Q, Z) {
            if (this._updateID++,
                this._updateSize = Q * J.BYTES_PER_ELEMENT,
                this._data === J) {
                if (Z)
                    this.emit("update", this);
                return
            }
            let $ = this._data;
            if (this._data = J,
                this._dataInt32 = null,
                !$ || $.length !== J.length) {
                if (!this.shrinkToFit && $ && J.byteLength < $.byteLength) {
                    if (Z)
                        this.emit("update", this)
                } else
                    this.descriptor.size = J.byteLength,
                        this._resourceId = i8("resource"),
                        this.emit("change", this);
                return
            }
            if (Z)
                this.emit("update", this)
        }
        update(J) {
            this._updateSize = J ?? this._updateSize,
                this._updateID++,
                this.emit("update", this)
        }
        destroy() {
            this.destroyed = !0,
                this.emit("destroy", this),
                this.emit("change", this),
                this._data = null,
                this.descriptor = null,
                this.removeAllListeners()
        }
    }
}
);
function lV(J, Q) {
    if (!(J instanceof P7)) {
        let Z = Q ? a8.INDEX : a8.VERTEX;
        if (J instanceof Array)
            if (Q)
                J = new Uint32Array(J),
                    Z = a8.INDEX | a8.COPY_DST;
            else
                J = new Float32Array(J),
                    Z = a8.VERTEX | a8.COPY_DST;
        J = new P7({
            data: J,
            label: Q ? "index-mesh-buffer" : "vertex-mesh-buffer",
            usage: Z
        })
    }
    return J
}
var H2 = O(() => {
    b9();
    Q9()
}
);
function Y2(J, Q, Z) {
    let $ = J.getAttribute(Q);
    if (!$)
        return Z.minX = 0,
            Z.minY = 0,
            Z.maxX = 0,
            Z.maxY = 0,
            Z;
    let q = $.buffer.data
        , K = 1 / 0
        , V = 1 / 0
        , z = -1 / 0
        , W = -1 / 0
        , H = q.BYTES_PER_ELEMENT
        , Y = ($.offset || 0) / H
        , U = ($.stride || 8) / H;
    for (let N = Y; N < q.length; N += U) {
        let j = q[N]
            , k = q[N + 1];
        if (j > z)
            z = j;
        if (k > W)
            W = k;
        if (j < K)
            K = j;
        if (k < V)
            V = k
    }
    return Z.minX = K,
        Z.minY = V,
        Z.maxX = z,
        Z.maxY = W,
        Z
}
var X2 = () => { }
    ;
function hx(J) {
    if (J instanceof P7 || Array.isArray(J) || J.BYTES_PER_ELEMENT)
        J = {
            buffer: J
        };
    return J.buffer = lV(J.buffer, !1),
        J
}
var uJ;
var IQ = O(() => {
    wJ();
    VJ();
    l7();
    b9();
    H2();
    X2();
    uJ = class uJ extends o6 {
        constructor(J = {}) {
            super();
            this.uid = i8("geometry"),
                this._layoutKey = 0,
                this.instanceCount = 1,
                this._bounds = new E6,
                this._boundsDirty = !0;
            let { attributes: Q, indexBuffer: Z, topology: $ } = J;
            if (this.buffers = [],
                this.attributes = {},
                Q)
                for (let q in Q)
                    this.addAttribute(q, Q[q]);
            if (this.instanceCount = J.instanceCount ?? 1,
                Z)
                this.addIndex(Z);
            this.topology = $ || "triangle-list"
        }
        onBufferUpdate() {
            this._boundsDirty = !0,
                this.emit("update", this)
        }
        getAttribute(J) {
            return this.attributes[J]
        }
        getIndex() {
            return this.indexBuffer
        }
        getBuffer(J) {
            return this.getAttribute(J).buffer
        }
        getSize() {
            for (let J in this.attributes) {
                let Q = this.attributes[J];
                return Q.buffer.data.length / (Q.stride / 4 || Q.size)
            }
            return 0
        }
        addAttribute(J, Q) {
            let Z = hx(Q);
            if (this.buffers.indexOf(Z.buffer) === -1)
                this.buffers.push(Z.buffer),
                    Z.buffer.on("update", this.onBufferUpdate, this),
                    Z.buffer.on("change", this.onBufferUpdate, this);
            this.attributes[J] = Z
        }
        addIndex(J) {
            this.indexBuffer = lV(J, !0),
                this.buffers.push(this.indexBuffer)
        }
        get bounds() {
            if (!this._boundsDirty)
                return this._bounds;
            return this._boundsDirty = !1,
                Y2(this, "aPosition", this._bounds)
        }
        destroy(J = !1) {
            if (this.emit("destroy", this),
                this.removeAllListeners(),
                J)
                this.buffers.forEach((Q) => Q.destroy());
            this.attributes = null,
                this.buffers = null,
                this.indexBuffer = null,
                this._bounds = null
        }
    }
}
);
var xx, gx, oV;
var U2 = O(() => {
    b9();
    Q9();
    IQ();
    xx = new Float32Array(1),
        gx = new Uint32Array(1);
    oV = class oV extends uJ {
        constructor() {
            let Q = new P7({
                data: xx,
                label: "attribute-batch-buffer",
                usage: a8.VERTEX | a8.COPY_DST,
                shrinkToFit: !1
            })
                , Z = new P7({
                    data: gx,
                    label: "index-batch-buffer",
                    usage: a8.INDEX | a8.COPY_DST,
                    shrinkToFit: !1
                })
                , $ = 24;
            super({
                attributes: {
                    aPosition: {
                        buffer: Q,
                        format: "float32x2",
                        stride: 24,
                        offset: 0
                    },
                    aUV: {
                        buffer: Q,
                        format: "float32x2",
                        stride: 24,
                        offset: 8
                    },
                    aColor: {
                        buffer: Q,
                        format: "unorm8x4",
                        stride: 24,
                        offset: 16
                    },
                    aTextureIdAndRound: {
                        buffer: Q,
                        format: "uint16x2",
                        stride: 24,
                        offset: 20
                    }
                },
                indexBuffer: Z
            })
        }
    }
}
);
function Z9(J, Q) {
    let Z = DM[J];
    if (Z === void 0) {
        if (MF[Q] === void 0)
            MF[Q] = 1;
        DM[J] = Z = MF[Q]++
    }
    return Z
}
var MF, DM;
var C$ = O(() => {
    MF = Object.create(null),
        DM = Object.create(null)
}
);
function w2() {
    if (!N2) {
        N2 = "mediump";
        let J = Wq();
        if (J) {
            if (J.getShaderPrecisionFormat)
                N2 = J.getShaderPrecisionFormat(J.FRAGMENT_SHADER, J.HIGH_FLOAT).precision ? "highp" : "mediump"
        }
    }
    return N2
}
var N2;
var j2 = O(() => {
    cV()
}
);
function B2(J, Q, Z) {
    if (Q)
        return J;
    if (Z)
        return J = J.replace("out vec4 finalColor;", ""),
            `

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${J}
        `;
    return `

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${J}
        `
}
var k2 = () => { }
    ;
function C2(J, Q, Z) {
    let $ = Z ? Q.maxSupportedFragmentPrecision : Q.maxSupportedVertexPrecision;
    if (J.substring(0, 9) !== "precision") {
        let q = Z ? Q.requestedFragmentPrecision : Q.requestedVertexPrecision;
        if (q === "highp" && $ !== "highp")
            q = "mediump";
        return `precision ${q} float;
${J}`
    } else if ($ !== "highp" && J.substring(0, 15) === "precision highp")
        return J.replace("precision highp", "precision mediump");
    return J
}
var O2 = () => { }
    ;
function I2(J, Q) {
    if (!Q)
        return J;
    return `#version 300 es
${J}`
}
var L2 = () => { }
    ;
function F2(J, { name: Q = "pixi-program" }, Z = !0) {
    Q = Q.replace(/\s+/g, "-"),
        Q += Z ? "-fragment" : "-vertex";
    let $ = Z ? mx : cx;
    if ($[Q])
        $[Q]++,
            Q += `-${$[Q]}`;
    else
        $[Q] = 1;
    if (J.indexOf("#define SHADER_NAME") !== -1)
        return J;
    return `${`#define SHADER_NAME ${Q}`}
${J}`
}
var mx, cx;
var G2 = O(() => {
    mx = {},
        cx = {}
}
);
function P2(J, Q) {
    if (!Q)
        return J;
    return J.replace("#version 300 es", "")
}
var D2 = () => { }
    ;
var _F, RF, AM = class J {
    constructor(Q) {
        Q = {
            ...J.defaultOptions,
            ...Q
        };
        let Z = Q.fragment.indexOf("#version 300 es") !== -1
            , $ = {
                stripVersion: Z,
                ensurePrecision: {
                    requestedFragmentPrecision: Q.preferredFragmentPrecision,
                    requestedVertexPrecision: Q.preferredVertexPrecision,
                    maxSupportedVertexPrecision: "highp",
                    maxSupportedFragmentPrecision: w2()
                },
                setProgramName: {
                    name: Q.name
                },
                addProgramDefines: Z,
                insertVersion: Z
            }
            , q = Q.fragment
            , K = Q.vertex;
        Object.keys(_F).forEach((V) => {
            let z = $[V];
            q = _F[V](q, z, !0),
                K = _F[V](K, z, !1)
        }
        ),
            this.fragment = q,
            this.vertex = K,
            this.transformFeedbackVaryings = Q.transformFeedbackVaryings,
            this._key = Z9(`${this.vertex}:${this.fragment}`, "gl-program")
    }
    destroy() {
        this.fragment = null,
            this.vertex = null,
            this._attributeData = null,
            this._uniformData = null,
            this._uniformBlockData = null,
            this.transformFeedbackVaryings = null
    }
    static from(Q) {
        let Z = `${Q.vertex}:${Q.fragment}`;
        if (!RF[Z])
            RF[Z] = new J(Q);
        return RF[Z]
    }
}
    , j7;
var lJ = O(() => {
    C$();
    j2();
    k2();
    O2();
    L2();
    G2();
    D2();
    _F = {
        stripVersion: P2,
        ensurePrecision: C2,
        addProgramDefines: B2,
        setProgramName: F2,
        insertVersion: I2
    },
        RF = Object.create(null);
    AM.defaultOptions = {
        preferredVertexPrecision: "highp",
        preferredFragmentPrecision: "mediump"
    };
    j7 = AM
}
);
function EJ(J) {
    return EM[J] ?? EM.float32
}
var EM;
var LQ = O(() => {
    EM = {
        uint8x2: {
            size: 2,
            stride: 2,
            normalised: !1
        },
        uint8x4: {
            size: 4,
            stride: 4,
            normalised: !1
        },
        sint8x2: {
            size: 2,
            stride: 2,
            normalised: !1
        },
        sint8x4: {
            size: 4,
            stride: 4,
            normalised: !1
        },
        unorm8x2: {
            size: 2,
            stride: 2,
            normalised: !0
        },
        unorm8x4: {
            size: 4,
            stride: 4,
            normalised: !0
        },
        snorm8x2: {
            size: 2,
            stride: 2,
            normalised: !0
        },
        snorm8x4: {
            size: 4,
            stride: 4,
            normalised: !0
        },
        uint16x2: {
            size: 2,
            stride: 4,
            normalised: !1
        },
        uint16x4: {
            size: 4,
            stride: 8,
            normalised: !1
        },
        sint16x2: {
            size: 2,
            stride: 4,
            normalised: !1
        },
        sint16x4: {
            size: 4,
            stride: 8,
            normalised: !1
        },
        unorm16x2: {
            size: 2,
            stride: 4,
            normalised: !0
        },
        unorm16x4: {
            size: 4,
            stride: 8,
            normalised: !0
        },
        snorm16x2: {
            size: 2,
            stride: 4,
            normalised: !0
        },
        snorm16x4: {
            size: 4,
            stride: 8,
            normalised: !0
        },
        float16x2: {
            size: 2,
            stride: 4,
            normalised: !1
        },
        float16x4: {
            size: 4,
            stride: 8,
            normalised: !1
        },
        float32: {
            size: 1,
            stride: 4,
            normalised: !1
        },
        float32x2: {
            size: 2,
            stride: 8,
            normalised: !1
        },
        float32x3: {
            size: 3,
            stride: 12,
            normalised: !1
        },
        float32x4: {
            size: 4,
            stride: 16,
            normalised: !1
        },
        uint32: {
            size: 1,
            stride: 4,
            normalised: !1
        },
        uint32x2: {
            size: 2,
            stride: 8,
            normalised: !1
        },
        uint32x3: {
            size: 3,
            stride: 12,
            normalised: !1
        },
        uint32x4: {
            size: 4,
            stride: 16,
            normalised: !1
        },
        sint32: {
            size: 1,
            stride: 4,
            normalised: !1
        },
        sint32x2: {
            size: 2,
            stride: 8,
            normalised: !1
        },
        sint32x3: {
            size: 3,
            stride: 12,
            normalised: !1
        },
        sint32x4: {
            size: 4,
            stride: 16,
            normalised: !1
        }
    }
}
);
function A2({ source: J, entryPoint: Q }) {
    let Z = {}
        , $ = J.indexOf(`fn ${Q}`);
    if ($ !== -1) {
        let q = J.indexOf("->", $);
        if (q !== -1) {
            let K = J.substring($, q), V = /@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g, z;
            while ((z = V.exec(K)) !== null) {
                let W = dx[z[3]] ?? "float32";
                Z[z[2]] = {
                    location: parseInt(z[1], 10),
                    format: W,
                    stride: EJ(W).stride,
                    offset: 0,
                    instance: !1,
                    start: 0
                }
            }
        }
    }
    return Z
}
var dx;
var E2 = O(() => {
    LQ();
    dx = {
        f32: "float32",
        "vec2<f32>": "float32x2",
        "vec3<f32>": "float32x3",
        "vec4<f32>": "float32x4",
        vec2f: "float32x2",
        vec3f: "float32x3",
        vec4f: "float32x4",
        i32: "sint32",
        "vec2<i32>": "sint32x2",
        "vec3<i32>": "sint32x3",
        "vec4<i32>": "sint32x4",
        u32: "uint32",
        "vec2<u32>": "uint32x2",
        "vec3<u32>": "uint32x3",
        "vec4<u32>": "uint32x4",
        bool: "uint32",
        "vec2<bool>": "uint32x2",
        "vec3<bool>": "uint32x3",
        "vec4<bool>": "uint32x4"
    }
}
);
function Xq(J) {
    let Q = /(^|[^/])@(group|binding)\(\d+\)[^;]+;/g
        , Z = /@group\((\d+)\)/
        , $ = /@binding\((\d+)\)/
        , q = /var(<[^>]+>)? (\w+)/
        , K = /:\s*(\w+)/
        , V = /struct\s+(\w+)\s*{([^}]+)}/g
        , z = /(\w+)\s*:\s*([\w\<\>]+)/g
        , W = /struct\s+(\w+)/
        , H = J.match(Q)?.map((U) => ({
            group: parseInt(U.match(Z)[1], 10),
            binding: parseInt(U.match($)[1], 10),
            name: U.match(q)[2],
            isUniform: U.match(q)[1] === "<uniform>",
            type: U.match(K)[1]
        }));
    if (!H)
        return {
            groups: [],
            structs: []
        };
    let Y = J.match(V)?.map((U) => {
        let N = U.match(W)[1]
            , j = U.match(z).reduce((k, L) => {
                let [F, P] = L.split(":");
                return k[F.trim()] = P.trim(),
                    k
            }
                , {});
        if (!j)
            return null;
        return {
            name: N,
            members: j
        }
    }
    ).filter(({ name: U }) => H.some((N) => N.type === U)) ?? [];
    return {
        groups: H,
        structs: Y
    }
}
var M2 = () => { }
    ;
var VZ;
var _2 = O(() => {
    VZ = ((J) => {
        return J[J.VERTEX = 1] = "VERTEX",
            J[J.FRAGMENT = 2] = "FRAGMENT",
            J[J.COMPUTE = 4] = "COMPUTE",
            J
    }
    )(VZ || {})
}
);
function R2({ groups: J }) {
    let Q = [];
    for (let Z = 0; Z < J.length; Z++) {
        let $ = J[Z];
        if (!Q[$.group])
            Q[$.group] = [];
        if ($.isUniform)
            Q[$.group].push({
                binding: $.binding,
                visibility: VZ.VERTEX | VZ.FRAGMENT,
                buffer: {
                    type: "uniform"
                }
            });
        else if ($.type === "sampler")
            Q[$.group].push({
                binding: $.binding,
                visibility: VZ.FRAGMENT,
                sampler: {
                    type: "filtering"
                }
            });
        else if ($.type === "texture_2d")
            Q[$.group].push({
                binding: $.binding,
                visibility: VZ.FRAGMENT,
                texture: {
                    sampleType: "float",
                    viewDimension: "2d",
                    multisampled: !1
                }
            })
    }
    return Q
}
var b2 = O(() => {
    _2()
}
);
function v2({ groups: J }) {
    let Q = [];
    for (let Z = 0; Z < J.length; Z++) {
        let $ = J[Z];
        if (!Q[$.group])
            Q[$.group] = {};
        Q[$.group][$.name] = $.binding
    }
    return Q
}
var S2 = () => { }
    ;
function T2(J, Q) {
    let Z = new Set
        , $ = new Set
        , q = [...J.structs, ...Q.structs].filter((V) => {
            if (Z.has(V.name))
                return !1;
            return Z.add(V.name),
                !0
        }
        )
        , K = [...J.groups, ...Q.groups].filter((V) => {
            let z = `${V.name}-${V.binding}`;
            if ($.has(z))
                return !1;
            return $.add(z),
                !0
        }
        );
    return {
        structs: q,
        groups: K
    }
}
var y2 = () => { }
    ;
class B7 {
    constructor(J) {
        this._layoutKey = 0,
            this._attributeLocationsKey = 0;
        let { fragment: Q, vertex: Z, layout: $, gpuLayout: q, name: K } = J;
        if (this.name = K,
            this.fragment = Q,
            this.vertex = Z,
            Q.source === Z.source) {
            let V = Xq(Q.source);
            this.structsAndGroups = V
        } else {
            let V = Xq(Z.source)
                , z = Xq(Q.source);
            this.structsAndGroups = T2(V, z)
        }
        this.layout = $ ?? v2(this.structsAndGroups),
            this.gpuLayout = q ?? R2(this.structsAndGroups),
            this.autoAssignGlobalUniforms = this.layout[0]?.globalUniforms !== void 0,
            this.autoAssignLocalUniforms = this.layout[1]?.localUniforms !== void 0,
            this._generateProgramKey()
    }
    _generateProgramKey() {
        let { vertex: J, fragment: Q } = this
            , Z = J.source + Q.source + J.entryPoint + Q.entryPoint;
        this._layoutKey = Z9(Z, "program")
    }
    get attributeData() {
        return this._attributeData ?? (this._attributeData = A2(this.vertex)),
            this._attributeData
    }
    destroy() {
        this.gpuLayout = null,
            this.layout = null,
            this.structsAndGroups = null,
            this.fragment = null,
            this.vertex = null
    }
    static from(J) {
        let Q = `${J.vertex.source}:${J.fragment.source}:${J.fragment.entryPoint}:${J.vertex.entryPoint}`;
        if (!bF[Q])
            bF[Q] = new B7(J);
        return bF[Q]
    }
}
var bF;
var Z5 = O(() => {
    C$();
    E2();
    M2();
    b2();
    S2();
    y2();
    bF = Object.create(null)
}
);
function nV(J, Q, Z) {
    if (J)
        for (let $ in J) {
            let q = $.toLocaleLowerCase()
                , K = Q[q];
            if (K) {
                let V = J[$];
                if ($ === "header")
                    V = V.replace(/@in\s+[^;]+;\s*/g, "").replace(/@out\s+[^;]+;\s*/g, "");
                if (Z)
                    K.push(`//----${Z}----//`);
                K.push(V)
            } else
                m0(`${$} placement hook does not exist in shader`)
        }
}
var f2 = O(() => {
    B6()
}
);
function sV(J) {
    let Q = {};
    return (J.match(px)?.map(($) => $.replace(/[{()}]/g, "")) ?? []).forEach(($) => {
        Q[$] = []
    }
    ),
        Q
}
var px;
var h2 = O(() => {
    px = /\{\{(.*?)\}\}/g
}
);
function MM(J, Q) {
    let Z, $ = /@in\s+([^;]+);/g;
    while ((Z = $.exec(J)) !== null)
        Q.push(Z[1])
}
function iV(J, Q, Z = !1) {
    let $ = [];
    MM(Q, $),
        J.forEach((z) => {
            if (z.header)
                MM(z.header, $)
        }
        );
    let q = $;
    if (Z)
        q.sort();
    let K = q.map((z, W) => `       @location(${W}) ${z},`).join(`
`)
        , V = Q.replace(/@in\s+[^;]+;\s*/g, "");
    return V = V.replace("{{in}}", `
${K}
`),
        V
}
var x2 = () => { }
    ;
function _M(J, Q) {
    let Z, $ = /@out\s+([^;]+);/g;
    while ((Z = $.exec(J)) !== null)
        Q.push(Z[1])
}
function ux(J) {
    let Z = /\b(\w+)\s*:/g.exec(J);
    return Z ? Z[1] : ""
}
function lx(J) {
    let Q = /@.*?\s+/g;
    return J.replace(Q, "")
}
function g2(J, Q) {
    let Z = [];
    _M(Q, Z),
        J.forEach((W) => {
            if (W.header)
                _M(W.header, Z)
        }
        );
    let $ = 0
        , q = Z.sort().map((W) => {
            if (W.indexOf("builtin") > -1)
                return W;
            return `@location(${$++}) ${W}`
        }
        ).join(`,
`)
        , K = Z.sort().map((W) => `       var ${lx(W)};`).join(`
`)
        , V = `return VSOutput(
            ${Z.sort().map((W) => ` ${ux(W)}`).join(`,
`)});`
        , z = Q.replace(/@out\s+[^;]+;\s*/g, "");
    return z = z.replace("{{struct}}", `
${q}
`),
        z = z.replace("{{start}}", `
${K}
`),
        z = z.replace("{{return}}", `
${V}
`),
        z
}
var m2 = () => { }
    ;
function aV(J, Q) {
    let Z = J;
    for (let $ in Q) {
        let q = Q[$];
        if (q.join(`
`).length)
            Z = Z.replace(`{{${$}}}`, `//-----${$} START-----//
${q.join(`
`)}
//----${$} FINISH----//`);
        else
            Z = Z.replace(`{{${$}}}`, "")
    }
    return Z
}
var c2 = () => { }
    ;
function d2({ template: J, bits: Q }) {
    let Z = RM(J, Q);
    if (zZ[Z])
        return zZ[Z];
    let { vertex: $, fragment: q } = nx(J, Q);
    return zZ[Z] = bM($, q, Q),
        zZ[Z]
}
function p2({ template: J, bits: Q }) {
    let Z = RM(J, Q);
    if (zZ[Z])
        return zZ[Z];
    return zZ[Z] = bM(J.vertex, J.fragment, Q),
        zZ[Z]
}
function nx(J, Q) {
    let Z = Q.map((V) => V.vertex).filter((V) => !!V)
        , $ = Q.map((V) => V.fragment).filter((V) => !!V)
        , q = iV(Z, J.vertex, !0);
    q = g2(Z, q);
    let K = iV($, J.fragment, !0);
    return {
        vertex: q,
        fragment: K
    }
}
function RM(J, Q) {
    return Q.map((Z) => {
        if (!vF.has(Z))
            vF.set(Z, ox++);
        return vF.get(Z)
    }
    ).sort((Z, $) => Z - $).join("-") + J.vertex + J.fragment
}
function bM(J, Q, Z) {
    let $ = sV(J)
        , q = sV(Q);
    return Z.forEach((K) => {
        nV(K.vertex, $, K.name),
            nV(K.fragment, q, K.name)
    }
    ),
    {
        vertex: aV(J, $),
        fragment: aV(Q, q)
    }
}
var zZ, vF, ox = 0;
var u2 = O(() => {
    f2();
    h2();
    x2();
    m2();
    c2();
    zZ = Object.create(null),
        vF = new Map
}
);
var l2 = `
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`
    , o2 = `
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`
    , n2 = `
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`
    , s2 = `

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`;
var i2 = () => { }
    ;
var a2, r2;
var t2 = O(() => {
    a2 = {
        name: "global-uniforms-bit",
        vertex: {
            header: `
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `
        }
    },
        r2 = {
            name: "global-uniforms-bit",
            vertex: {
                header: `
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `
            }
        }
}
);
function R5({ bits: J, name: Q }) {
    let Z = d2({
        template: {
            fragment: o2,
            vertex: l2
        },
        bits: [a2, ...J]
    });
    return B7.from({
        name: Q,
        vertex: {
            source: Z.vertex,
            entryPoint: "main"
        },
        fragment: {
            source: Z.fragment,
            entryPoint: "main"
        }
    })
}
function b5({ bits: J, name: Q }) {
    return new j7({
        name: Q,
        ...p2({
            template: {
                vertex: n2,
                fragment: s2
            },
            bits: [r2, ...J]
        })
    })
}
var v9 = O(() => {
    lJ();
    Z5();
    u2();
    i2();
    t2()
}
);
var WZ, HZ;
var O$ = O(() => {
    WZ = {
        name: "color-bit",
        vertex: {
            header: `
            @in aColor: vec4<f32>;
        `,
            main: `
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `
        }
    },
        HZ = {
            name: "color-bit",
            vertex: {
                header: `
            in vec4 aColor;
        `,
                main: `
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `
            }
        }
}
);
function sx(J) {
    let Q = [];
    if (J === 1)
        Q.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),
            Q.push("@group(1) @binding(1) var textureSampler1: sampler;");
    else {
        let Z = 0;
        for (let $ = 0; $ < J; $++)
            Q.push(`@group(1) @binding(${Z++}) var textureSource${$ + 1}: texture_2d<f32>;`),
                Q.push(`@group(1) @binding(${Z++}) var textureSampler${$ + 1}: sampler;`)
    }
    return Q.join(`
`)
}
function ix(J) {
    let Q = [];
    if (J === 1)
        Q.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");
    else {
        Q.push("switch vTextureId {");
        for (let Z = 0; Z < J; Z++) {
            if (Z === J - 1)
                Q.push("  default:{");
            else
                Q.push(`  case ${Z}:{`);
            Q.push(`      outColor = textureSampleGrad(textureSource${Z + 1}, textureSampler${Z + 1}, vUV, uvDx, uvDy);`),
                Q.push("      break;}")
        }
        Q.push("}")
    }
    return Q.join(`
`)
}
function YZ(J) {
    if (!SF[J])
        SF[J] = {
            name: "texture-batch-bit",
            vertex: {
                header: `
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,
                main: `
                vTextureId = aTextureIdAndRound.y;
            `,
                end: `
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `
            },
            fragment: {
                header: `
                @in @interpolate(flat) vTextureId: u32;

                ${sx(J)}
            `,
                main: `
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${ix(J)}
            `
            }
        };
    return SF[J]
}
function ax(J) {
    let Q = [];
    for (let Z = 0; Z < J; Z++) {
        if (Z > 0)
            Q.push("else");
        if (Z < J - 1)
            Q.push(`if(vTextureId < ${Z}.5)`);
        Q.push("{"),
            Q.push(`	outColor = texture(uTextures[${Z}], vUV);`),
            Q.push("}")
    }
    return Q.join(`
`)
}
function XZ(J) {
    if (!TF[J])
        TF[J] = {
            name: "texture-batch-bit",
            vertex: {
                header: `
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,
                main: `
                vTextureId = aTextureIdAndRound.y;
            `,
                end: `
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `
            },
            fragment: {
                header: `
                in float vTextureId;

                uniform sampler2D uTextures[${J}];

            `,
                main: `

                ${ax(J)}
            `
            }
        };
    return TF[J]
}
var SF, TF;
var I$ = O(() => {
    SF = {};
    TF = {}
}
);
var v5, S5;
var S9 = O(() => {
    v5 = {
        name: "round-pixels-bit",
        vertex: {
            header: `
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `
        }
    },
        S5 = {
            name: "round-pixels-bit",
            vertex: {
                header: `
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `
            }
        }
}
);
var rV, e2;
var JU = O(() => {
    rV = ["f32", "i32", "vec2<f32>", "vec3<f32>", "vec4<f32>", "mat2x2<f32>", "mat3x3<f32>", "mat4x4<f32>", "mat3x2<f32>", "mat4x2<f32>", "mat2x3<f32>", "mat4x3<f32>", "mat2x4<f32>", "mat3x4<f32>", "vec2<i32>", "vec3<i32>", "vec4<i32>"],
        e2 = rV.reduce((J, Q) => {
            return J[Q] = !0,
                J
        }
            , {})
}
);
function QU(J, Q) {
    switch (J) {
        case "f32":
            return 0;
        case "vec2<f32>":
            return new Float32Array(2 * Q);
        case "vec3<f32>":
            return new Float32Array(3 * Q);
        case "vec4<f32>":
            return new Float32Array(4 * Q);
        case "mat2x2<f32>":
            return new Float32Array([1, 0, 0, 1]);
        case "mat3x3<f32>":
            return new Float32Array([1, 0, 0, 0, 1, 0, 0, 0, 1]);
        case "mat4x4<f32>":
            return new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1])
    }
    return null
}
var ZU = () => { }
    ;
var vM = class J {
    constructor(Q, Z) {
        this._touched = 0,
            this.uid = i8("uniform"),
            this._resourceType = "uniformGroup",
            this._resourceId = i8("resource"),
            this.isUniformGroup = !0,
            this._dirtyId = 0,
            this.destroyed = !1,
            Z = {
                ...J.defaultOptions,
                ...Z
            },
            this.uniformStructures = Q;
        let $ = {};
        for (let q in Q) {
            let K = Q[q];
            if (K.name = q,
                K.size = K.size ?? 1,
                !e2[K.type])
                throw new Error(`Uniform type ${K.type} is not supported. Supported uniform types are: ${rV.join(", ")}`);
            K.value ?? (K.value = QU(K.type, K.size)),
                $[q] = K.value
        }
        this.uniforms = $,
            this._dirtyId = 1,
            this.ubo = Z.ubo,
            this.isStatic = Z.isStatic,
            this._signature = Z9(Object.keys($).map((q) => `${q}-${Q[q].type}`).join("-"), "uniform-group")
    }
    update() {
        this._dirtyId++
    }
}
    , Y6;
var _7 = O(() => {
    l7();
    C$();
    JU();
    ZU();
    vM.defaultOptions = {
        ubo: !1,
        isStatic: !1
    };
    Y6 = vM
}
);
function UZ(J) {
    let Q = SM[J];
    if (Q)
        return Q;
    let Z = new Int32Array(J);
    for (let $ = 0; $ < J; $++)
        Z[$] = $;
    return Q = SM[J] = new Y6({
        uTextures: {
            value: Z,
            type: "i32",
            size: J
        }
    }, {
        isStatic: !0
    }),
        Q
}
var SM;
var Uq = O(() => {
    _7();
    SM = {}
}
);
var W7;
var $5 = O(() => {
    W7 = ((J) => {
        return J[J.WEBGL = 1] = "WEBGL",
            J[J.WEBGPU = 2] = "WEBGPU",
            J[J.BOTH = 3] = "BOTH",
            J
    }
    )(W7 || {})
}
);
var k7;
var k5 = O(() => {
    wJ();
    l7();
    lJ();
    R9();
    Z5();
    $5();
    _7();
    k7 = class k7 extends o6 {
        constructor(J) {
            super();
            this.uid = i8("shader"),
                this._uniformBindMap = Object.create(null),
                this._ownedBindGroups = [];
            let { gpuProgram: Q, glProgram: Z, groups: $, resources: q, compatibleRenderers: K, groupMap: V } = J;
            if (this.gpuProgram = Q,
                this.glProgram = Z,
                K === void 0) {
                if (K = 0,
                    Q)
                    K |= W7.WEBGPU;
                if (Z)
                    K |= W7.WEBGL
            }
            this.compatibleRenderers = K;
            let z = {};
            if (!q && !$)
                q = {};
            if (q && $)
                throw new Error("[Shader] Cannot have both resources and groups");
            else if (!Q && $ && !V)
                throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");
            else if (!Q && $ && V)
                for (let W in V)
                    for (let H in V[W]) {
                        let Y = V[W][H];
                        z[Y] = {
                            group: W,
                            binding: H,
                            name: Y
                        }
                    }
            else if (Q && $ && !V) {
                let W = Q.structsAndGroups.groups;
                V = {},
                    W.forEach((H) => {
                        V[H.group] = V[H.group] || {},
                            V[H.group][H.binding] = H.name,
                            z[H.name] = H
                    }
                    )
            } else if (q) {
                if ($ = {},
                    V = {},
                    Q)
                    Q.structsAndGroups.groups.forEach((Y) => {
                        V[Y.group] = V[Y.group] || {},
                            V[Y.group][Y.binding] = Y.name,
                            z[Y.name] = Y
                    }
                    );
                let W = 0;
                for (let H in q) {
                    if (z[H])
                        continue;
                    if (!$[99])
                        $[99] = new QJ,
                            this._ownedBindGroups.push($[99]);
                    z[H] = {
                        group: 99,
                        binding: W,
                        name: H
                    },
                        V[99] = V[99] || {},
                        V[99][W] = H,
                        W++
                }
                for (let H in q) {
                    let Y = H
                        , U = q[H];
                    if (!U.source && !U._resourceType)
                        U = new Y6(U);
                    let N = z[Y];
                    if (N) {
                        if (!$[N.group])
                            $[N.group] = new QJ,
                                this._ownedBindGroups.push($[N.group]);
                        $[N.group].setResource(U, N.binding)
                    }
                }
            }
            this.groups = $,
                this._uniformBindMap = V,
                this.resources = this._buildResourceAccessor($, z)
        }
        addResource(J, Q, Z) {
            var $, q;
            if (($ = this._uniformBindMap)[Q] || ($[Q] = {}),
                (q = this._uniformBindMap[Q])[Z] || (q[Z] = J),
                !this.groups[Q])
                this.groups[Q] = new QJ,
                    this._ownedBindGroups.push(this.groups[Q])
        }
        _buildResourceAccessor(J, Q) {
            let Z = {};
            for (let $ in Q) {
                let q = Q[$];
                Object.defineProperty(Z, q.name, {
                    get() {
                        return J[q.group].getResource(q.binding)
                    },
                    set(K) {
                        J[q.group].setResource(K, q.binding)
                    }
                })
            }
            return Z
        }
        destroy(J = !1) {
            if (this.emit("destroy", this),
                J)
                this.gpuProgram?.destroy(),
                    this.glProgram?.destroy();
            this.gpuProgram = null,
                this.glProgram = null,
                this.removeAllListeners(),
                this._uniformBindMap = null,
                this._ownedBindGroups.forEach((Q) => {
                    Q.destroy()
                }
                ),
                this._ownedBindGroups = null,
                this.resources = null,
                this.groups = null
        }
        static from(J) {
            let { gpu: Q, gl: Z, ...$ } = J, q, K;
            if (Q)
                q = B7.from(Q);
            if (Z)
                K = j7.from(Z);
            return new k7({
                gpuProgram: q,
                glProgram: K,
                ...$
            })
        }
    }
}
);
var tV;
var $U = O(() => {
    v9();
    O$();
    I$();
    S9();
    Uq();
    k5();
    tV = class tV extends k7 {
        constructor(J) {
            let Q = b5({
                name: "batch",
                bits: [HZ, XZ(J), S5]
            })
                , Z = R5({
                    name: "batch",
                    bits: [WZ, YZ(J), v5]
                });
            super({
                glProgram: Q,
                gpuProgram: Z,
                resources: {
                    batchSamplers: UZ(J)
                }
            })
        }
    }
}
);
var yF = null, TM, L$;
var eV = O(() => {
    w0();
    W2();
    U2();
    $U();
    TM = class J extends z2 {
        constructor(Q) {
            super(Q);
            this.geometry = new oV,
                this.name = J.extension.name,
                this.vertexSize = 6,
                yF ?? (yF = new tV(Q.maxTextures)),
                this.shader = yF
        }
        packAttributes(Q, Z, $, q, K) {
            let V = K << 16 | Q.roundPixels & 65535
                , z = Q.transform
                , W = z.a
                , H = z.b
                , Y = z.c
                , U = z.d
                , N = z.tx
                , j = z.ty
                , { positions: k, uvs: L } = Q
                , F = Q.color
                , P = Q.attributeOffset
                , M = P + Q.attributeSize;
            for (let v = P; v < M; v++) {
                let E = v * 2
                    , n = k[E]
                    , u = k[E + 1];
                Z[q++] = W * n + Y * u + N,
                    Z[q++] = U * u + H * n + j,
                    Z[q++] = L[E],
                    Z[q++] = L[E + 1],
                    $[q++] = F,
                    $[q++] = V
            }
        }
        packQuadAttributes(Q, Z, $, q, K) {
            let { texture: V, transform: z } = Q
                , W = z.a
                , H = z.b
                , Y = z.c
                , U = z.d
                , N = z.tx
                , j = z.ty
                , k = Q.bounds
                , L = k.maxX
                , F = k.minX
                , P = k.maxY
                , M = k.minY
                , v = V.uvs
                , E = Q.color
                , n = K << 16 | Q.roundPixels & 65535;
            Z[q + 0] = W * F + Y * M + N,
                Z[q + 1] = U * M + H * F + j,
                Z[q + 2] = v.x0,
                Z[q + 3] = v.y0,
                $[q + 4] = E,
                $[q + 5] = n,
                Z[q + 6] = W * L + Y * M + N,
                Z[q + 7] = U * M + H * L + j,
                Z[q + 8] = v.x1,
                Z[q + 9] = v.y1,
                $[q + 10] = E,
                $[q + 11] = n,
                Z[q + 12] = W * L + Y * P + N,
                Z[q + 13] = U * P + H * L + j,
                Z[q + 14] = v.x2,
                Z[q + 15] = v.y2,
                $[q + 16] = E,
                $[q + 17] = n,
                Z[q + 18] = W * F + Y * P + N,
                Z[q + 19] = U * P + H * F + j,
                Z[q + 20] = v.x3,
                Z[q + 21] = v.y3,
                $[q + 22] = E,
                $[q + 23] = n
        }
    }
        ;
    TM.extension = {
        type: [R.Batcher],
        name: "default"
    };
    L$ = TM
}
);
function qU(J, Q, Z, $, q, K, V, z = null) {
    let W = 0;
    Z *= Q,
        q *= K;
    let { a: H, b: Y, c: U, d: N, tx: j, ty: k } = z;
    while (W < V) {
        let L = J[Z]
            , F = J[Z + 1];
        $[q] = H * L + U * F + j,
            $[q + 1] = Y * L + N * F + k,
            q += K,
            Z += Q,
            W++
    }
}
function KU(J, Q, Z, $) {
    let q = 0;
    Q *= Z;
    while (q < $)
        J[Q] = 0,
            J[Q + 1] = 0,
            Q += Z,
            q++
}
var VU = () => { }
    ;
function Jz(J, Q, Z, $, q) {
    let { a: K, b: V, c: z, d: W, tx: H, ty: Y } = Q;
    Z || (Z = 0),
        $ || ($ = 2),
        q || (q = J.length / $ - Z);
    let U = Z * $;
    for (let N = 0; N < q; N++) {
        let j = J[U]
            , k = J[U + 1];
        J[U] = K * j + z * k + H,
            J[U + 1] = V * j + W * k + Y,
            U += $
    }
}
var zU = () => { }
    ;
class NZ {
    constructor() {
        this.packAsQuad = !1,
            this.batcherName = "default",
            this.topology = "triangle-list",
            this.applyTransform = !0,
            this.roundPixels = 0,
            this._batcher = null,
            this._batch = null
    }
    get uvs() {
        return this.geometryData.uvs
    }
    get positions() {
        return this.geometryData.vertices
    }
    get indices() {
        return this.geometryData.indices
    }
    get blendMode() {
        if (this.renderable && this.applyTransform)
            return this.renderable.groupBlendMode;
        return "normal"
    }
    get color() {
        let J = this.baseColor
            , Q = J >> 16 | J & 65280 | (J & 255) << 16
            , Z = this.renderable;
        if (Z)
            return c1(Q, Z.groupColor) + (this.alpha * Z.groupAlpha * 255 << 24);
        return Q + (this.alpha * 255 << 24)
    }
    get transform() {
        return this.renderable?.groupTransform || rx
    }
    copyTo(J) {
        J.indexOffset = this.indexOffset,
            J.indexSize = this.indexSize,
            J.attributeOffset = this.attributeOffset,
            J.attributeSize = this.attributeSize,
            J.baseColor = this.baseColor,
            J.alpha = this.alpha,
            J.texture = this.texture,
            J.geometryData = this.geometryData,
            J.topology = this.topology
    }
    reset() {
        this.applyTransform = !0,
            this.renderable = null,
            this.topology = "triangle-list"
    }
}
var rx;
var Qz = O(() => {
    Z6();
    BV();
    rx = new f0
}
);
var wZ, WU, HU;
var YU = O(() => {
    w0();
    wZ = {
        extension: {
            type: R.ShapeBuilder,
            name: "circle"
        },
        build(J, Q) {
            let Z, $, q, K, V, z;
            if (J.type === "circle") {
                let E = J;
                if (V = z = E.radius,
                    V <= 0)
                    return !1;
                Z = E.x,
                    $ = E.y,
                    q = K = 0
            } else if (J.type === "ellipse") {
                let E = J;
                if (V = E.halfWidth,
                    z = E.halfHeight,
                    V <= 0 || z <= 0)
                    return !1;
                Z = E.x,
                    $ = E.y,
                    q = K = 0
            } else {
                let E = J
                    , n = E.width / 2
                    , u = E.height / 2;
                Z = E.x + n,
                    $ = E.y + u,
                    V = z = Math.max(0, Math.min(E.radius, Math.min(n, u))),
                    q = n - V,
                    K = u - z
            }
            if (q < 0 || K < 0)
                return !1;
            let W = Math.ceil(2.3 * Math.sqrt(V + z))
                , H = W * 8 + (q ? 4 : 0) + (K ? 4 : 0);
            if (H === 0)
                return !1;
            if (W === 0)
                return Q[0] = Q[6] = Z + q,
                    Q[1] = Q[3] = $ + K,
                    Q[2] = Q[4] = Z - q,
                    Q[5] = Q[7] = $ - K,
                    !0;
            let Y = 0
                , U = W * 4 + (q ? 2 : 0) + 2
                , N = U
                , j = H
                , k = q + V
                , L = K
                , F = Z + k
                , P = Z - k
                , M = $ + L;
            if (Q[Y++] = F,
                Q[Y++] = M,
                Q[--U] = M,
                Q[--U] = P,
                K) {
                let E = $ - L;
                Q[N++] = P,
                    Q[N++] = E,
                    Q[--j] = E,
                    Q[--j] = F
            }
            for (let E = 1; E < W; E++) {
                let n = Math.PI / 2 * (E / W)
                    , u = q + Math.cos(n) * V
                    , b = K + Math.sin(n) * z
                    , i = Z + u
                    , g = Z - u
                    , l = $ + b
                    , o = $ - b;
                Q[Y++] = i,
                    Q[Y++] = l,
                    Q[--U] = l,
                    Q[--U] = g,
                    Q[N++] = g,
                    Q[N++] = o,
                    Q[--j] = o,
                    Q[--j] = i
            }
            k = q,
                L = K + z,
                F = Z + k,
                P = Z - k,
                M = $ + L;
            let v = $ - L;
            if (Q[Y++] = F,
                Q[Y++] = M,
                Q[--j] = v,
                Q[--j] = F,
                q)
                Q[Y++] = P,
                    Q[Y++] = M,
                    Q[--j] = v,
                    Q[--j] = P;
            return !0
        },
        triangulate(J, Q, Z, $, q, K) {
            if (J.length === 0)
                return;
            let V = 0
                , z = 0;
            for (let Y = 0; Y < J.length; Y += 2)
                V += J[Y],
                    z += J[Y + 1];
            V /= J.length / 2,
                z /= J.length / 2;
            let W = $;
            Q[W * Z] = V,
                Q[W * Z + 1] = z;
            let H = W++;
            for (let Y = 0; Y < J.length; Y += 2) {
                if (Q[W * Z] = J[Y],
                    Q[W * Z + 1] = J[Y + 1],
                    Y > 0)
                    q[K++] = W,
                        q[K++] = H,
                        q[K++] = W - 1;
                W++
            }
            q[K++] = H + 1,
                q[K++] = H,
                q[K++] = W - 1
        }
    },
        WU = {
            ...wZ,
            extension: {
                ...wZ.extension,
                name: "ellipse"
            }
        },
        HU = {
            ...wZ,
            extension: {
                ...wZ.extension,
                name: "roundedRectangle"
            }
        }
}
);
var Nq = 0.0001
    , Zz = 0.0001;
var $z = () => { }
    ;
function XU(J) {
    let Q = J.length;
    if (Q < 6)
        return 1;
    let Z = 0;
    for (let $ = 0, q = J[Q - 2], K = J[Q - 1]; $ < Q; $ += 2) {
        let V = J[$]
            , z = J[$ + 1];
        Z += (V - q) * (z + K),
            q = V,
            K = z
    }
    if (Z < 0)
        return -1;
    return 1
}
var UU = () => { }
    ;
function yM(J, Q, Z, $, q, K, V, z) {
    let W = J - Z * q, H = Q - $ * q, Y = J + Z * K, U = Q + $ * K, N, j;
    if (V)
        N = $,
            j = -Z;
    else
        N = -$,
            j = Z;
    let k = W + N
        , L = H + j
        , F = Y + N
        , P = U + j;
    return z.push(k, L),
        z.push(F, P),
        2
}
function F$(J, Q, Z, $, q, K, V, z) {
    let W = Z - J
        , H = $ - Q
        , Y = Math.atan2(W, H)
        , U = Math.atan2(q - J, K - Q);
    if (z && Y < U)
        Y += Math.PI * 2;
    else if (!z && Y > U)
        U += Math.PI * 2;
    let N = Y
        , j = U - Y
        , k = Math.abs(j)
        , L = Math.sqrt(W * W + H * H)
        , F = (15 * k * Math.sqrt(L) / Math.PI >> 0) + 1
        , P = j / F;
    if (N += P,
        z) {
        V.push(J, Q),
            V.push(Z, $);
        for (let M = 1, v = N; M < F; M++,
            v += P)
            V.push(J, Q),
                V.push(J + Math.sin(v) * L, Q + Math.cos(v) * L);
        V.push(J, Q),
            V.push(q, K)
    } else {
        V.push(Z, $),
            V.push(J, Q);
        for (let M = 1, v = N; M < F; M++,
            v += P)
            V.push(J + Math.sin(v) * L, Q + Math.cos(v) * L),
                V.push(J, Q);
        V.push(q, K),
            V.push(J, Q)
    }
    return F * 2
}
function NU(J, Q, Z, $, q, K) {
    let V = Nq;
    if (J.length === 0)
        return;
    let z = Q
        , W = z.alignment;
    if (Q.alignment !== 0.5) {
        let I8 = XU(J);
        if (Z)
            I8 *= -1;
        W = (W - 0.5) * I8 + 0.5
    }
    let H = new z6(J[0], J[1])
        , Y = new z6(J[J.length - 2], J[J.length - 1])
        , U = $
        , N = Math.abs(H.x - Y.x) < V && Math.abs(H.y - Y.y) < V;
    if (U) {
        if (J = J.slice(),
            N)
            J.pop(),
                J.pop(),
                Y.set(J[J.length - 2], J[J.length - 1]);
        let I8 = (H.x + Y.x) * 0.5
            , x0 = (Y.y + H.y) * 0.5;
        J.unshift(I8, x0),
            J.push(I8, x0)
    }
    let j = q
        , k = J.length / 2
        , L = J.length
        , F = j.length / 2
        , P = z.width / 2
        , M = P * P
        , v = z.miterLimit * z.miterLimit
        , E = J[0]
        , n = J[1]
        , u = J[2]
        , b = J[3]
        , i = 0
        , g = 0
        , l = -(n - b)
        , o = E - u
        , F0 = 0
        , b0 = 0
        , d0 = Math.sqrt(l * l + o * o);
    l /= d0,
        o /= d0,
        l *= P,
        o *= P;
    let H8 = W
        , E0 = (1 - H8) * 2
        , v0 = H8 * 2;
    if (!U) {
        if (z.cap === "round")
            L += F$(E - l * (E0 - v0) * 0.5, n - o * (E0 - v0) * 0.5, E - l * E0, n - o * E0, E + l * v0, n + o * v0, j, !0) + 2;
        else if (z.cap === "square")
            L += yM(E, n, l, o, E0, v0, !0, j)
    }
    j.push(E - l * E0, n - o * E0),
        j.push(E + l * v0, n + o * v0);
    for (let I8 = 1; I8 < k - 1; ++I8) {
        E = J[(I8 - 1) * 2],
            n = J[(I8 - 1) * 2 + 1],
            u = J[I8 * 2],
            b = J[I8 * 2 + 1],
            i = J[(I8 + 1) * 2],
            g = J[(I8 + 1) * 2 + 1],
            l = -(n - b),
            o = E - u,
            d0 = Math.sqrt(l * l + o * o),
            l /= d0,
            o /= d0,
            l *= P,
            o *= P,
            F0 = -(b - g),
            b0 = u - i,
            d0 = Math.sqrt(F0 * F0 + b0 * b0),
            F0 /= d0,
            b0 /= d0,
            F0 *= P,
            b0 *= P;
        let x0 = u - E
            , U8 = n - b
            , t8 = u - i
            , o8 = g - b
            , c8 = x0 * t8 + U8 * o8
            , _8 = U8 * t8 - o8 * x0
            , R6 = _8 < 0;
        if (Math.abs(_8) < 0.001 * Math.abs(c8)) {
            if (j.push(u - l * E0, b - o * E0),
                j.push(u + l * v0, b + o * v0),
                c8 >= 0) {
                if (z.join === "round")
                    L += F$(u, b, u - l * E0, b - o * E0, u - F0 * E0, b - b0 * E0, j, !1) + 4;
                else
                    L += 2;
                j.push(u - F0 * v0, b - b0 * v0),
                    j.push(u + F0 * E0, b + b0 * E0)
            }
            continue
        }
        let n8 = (-l + E) * (-o + b) - (-l + u) * (-o + n)
            , q6 = (-F0 + i) * (-b0 + b) - (-F0 + u) * (-b0 + g)
            , K6 = (x0 * q6 - t8 * n8) / _8
            , k6 = (o8 * n8 - U8 * q6) / _8
            , y6 = (K6 - u) * (K6 - u) + (k6 - b) * (k6 - b)
            , S6 = u + (K6 - u) * E0
            , J8 = b + (k6 - b) * E0
            , L0 = u - (K6 - u) * v0
            , d8 = b - (k6 - b) * v0
            , d6 = Math.min(x0 * x0 + U8 * U8, t8 * t8 + o8 * o8)
            , K8 = R6 ? E0 : v0
            , h8 = d6 + K8 * K8 * M;
        if (y6 <= h8)
            if (z.join === "bevel" || y6 / M > v) {
                if (R6)
                    j.push(S6, J8),
                        j.push(u + l * v0, b + o * v0),
                        j.push(S6, J8),
                        j.push(u + F0 * v0, b + b0 * v0);
                else
                    j.push(u - l * E0, b - o * E0),
                        j.push(L0, d8),
                        j.push(u - F0 * E0, b - b0 * E0),
                        j.push(L0, d8);
                L += 2
            } else if (z.join === "round")
                if (R6)
                    j.push(S6, J8),
                        j.push(u + l * v0, b + o * v0),
                        L += F$(u, b, u + l * v0, b + o * v0, u + F0 * v0, b + b0 * v0, j, !0) + 4,
                        j.push(S6, J8),
                        j.push(u + F0 * v0, b + b0 * v0);
                else
                    j.push(u - l * E0, b - o * E0),
                        j.push(L0, d8),
                        L += F$(u, b, u - l * E0, b - o * E0, u - F0 * E0, b - b0 * E0, j, !1) + 4,
                        j.push(u - F0 * E0, b - b0 * E0),
                        j.push(L0, d8);
            else
                j.push(S6, J8),
                    j.push(L0, d8);
        else {
            if (j.push(u - l * E0, b - o * E0),
                j.push(u + l * v0, b + o * v0),
                z.join === "round")
                if (R6)
                    L += F$(u, b, u + l * v0, b + o * v0, u + F0 * v0, b + b0 * v0, j, !0) + 2;
                else
                    L += F$(u, b, u - l * E0, b - o * E0, u - F0 * E0, b - b0 * E0, j, !1) + 2;
            else if (z.join === "miter" && y6 / M <= v) {
                if (R6)
                    j.push(L0, d8),
                        j.push(L0, d8);
                else
                    j.push(S6, J8),
                        j.push(S6, J8);
                L += 2
            }
            j.push(u - F0 * E0, b - b0 * E0),
                j.push(u + F0 * v0, b + b0 * v0),
                L += 2
        }
    }
    if (E = J[(k - 2) * 2],
        n = J[(k - 2) * 2 + 1],
        u = J[(k - 1) * 2],
        b = J[(k - 1) * 2 + 1],
        l = -(n - b),
        o = E - u,
        d0 = Math.sqrt(l * l + o * o),
        l /= d0,
        o /= d0,
        l *= P,
        o *= P,
        j.push(u - l * E0, b - o * E0),
        j.push(u + l * v0, b + o * v0),
        !U) {
        if (z.cap === "round")
            L += F$(u - l * (E0 - v0) * 0.5, b - o * (E0 - v0) * 0.5, u - l * E0, b - o * E0, u + l * v0, b + o * v0, j, !1) + 2;
        else if (z.cap === "square")
            L += yM(u, b, l, o, E0, v0, !1, j)
    }
    let G6 = Zz * Zz;
    for (let I8 = F; I8 < L + F - 2; ++I8) {
        if (E = j[I8 * 2],
            n = j[I8 * 2 + 1],
            u = j[(I8 + 1) * 2],
            b = j[(I8 + 1) * 2 + 1],
            i = j[(I8 + 2) * 2],
            g = j[(I8 + 2) * 2 + 1],
            Math.abs(E * (b - g) + u * (g - n) + i * (n - b)) < G6)
            continue;
        K.push(I8, I8 + 1, I8 + 2)
    }
}
var wU = O(() => {
    cJ();
    $z();
    UU()
}
);
function jU(J, Q, Z, $) {
    let q = Nq;
    if (J.length === 0)
        return;
    let K = J[0]
        , V = J[1]
        , z = J[J.length - 2]
        , W = J[J.length - 1]
        , H = Q || Math.abs(K - z) < q && Math.abs(V - W) < q
        , Y = Z
        , U = J.length / 2
        , N = Y.length / 2;
    for (let j = 0; j < U; j++)
        Y.push(J[j * 2]),
            Y.push(J[j * 2 + 1]);
    for (let j = 0; j < U - 1; j++)
        $.push(N + j, N + j + 1);
    if (H)
        $.push(N + U - 1, N)
}
var BU = O(() => {
    $z()
}
);
function OU(J, Q, Z = 2) {
    let $ = Q && Q.length
        , q = $ ? Q[0] * Z : J.length
        , K = hM(J, 0, q, Z, !0)
        , V = [];
    if (!K || K.next === K.prev)
        return V;
    let z, W, H;
    if ($)
        K = Zg(J, Q, K, Z);
    if (J.length > 80 * Z) {
        z = J[0],
            W = J[1];
        let Y = z
            , U = W;
        for (let N = Z; N < q; N += Z) {
            let j = J[N]
                , k = J[N + 1];
            if (j < z)
                z = j;
            if (k < W)
                W = k;
            if (j > Y)
                Y = j;
            if (k > U)
                U = k
        }
        H = Math.max(Y - z, U - W),
            H = H !== 0 ? 32767 / H : 0
    }
    return Kz(K, V, Z, z, W, H, 0),
        V
}
function hM(J, Q, Z, $, q) {
    let K;
    if (q === Ng(J, Q, Z, $) > 0)
        for (let V = Q; V < Z; V += $)
            K = fM(V / $ | 0, J[V], J[V + 1], K);
    else
        for (let V = Z - $; V >= Q; V -= $)
            K = fM(V / $ | 0, J[V], J[V + 1], K);
    if (K && wq(K, K.next))
        zz(K),
            K = K.next;
    return K
}
function G$(J, Q) {
    if (!J)
        return J;
    if (!Q)
        Q = J;
    let Z = J, $;
    do
        if ($ = !1,
            !Z.steiner && (wq(Z, Z.next) || D7(Z.prev, Z, Z.next) === 0)) {
            if (zz(Z),
                Z = Q = Z.prev,
                Z === Z.next)
                break;
            $ = !0
        } else
            Z = Z.next;
    while ($ || Z !== Q);
    return Q
}
function Kz(J, Q, Z, $, q, K, V) {
    if (!J)
        return;
    if (!V && K)
        zg(J, $, q, K);
    let z = J;
    while (J.prev !== J.next) {
        let { prev: W, next: H } = J;
        if (K ? ex(J, $, q, K) : tx(J)) {
            Q.push(W.i, J.i, H.i),
                zz(J),
                J = H.next,
                z = H.next;
            continue
        }
        if (J = H,
            J === z) {
            if (!V)
                Kz(G$(J), Q, Z, $, q, K, 1);
            else if (V === 1)
                J = Jg(G$(J), Q),
                    Kz(J, Q, Z, $, q, K, 2);
            else if (V === 2)
                Qg(J, Q, Z, $, q, K);
            break
        }
    }
}
function tx(J) {
    let Q = J.prev
        , Z = J
        , $ = J.next;
    if (D7(Q, Z, $) >= 0)
        return !1;
    let q = Q.x
        , K = Z.x
        , V = $.x
        , z = Q.y
        , W = Z.y
        , H = $.y
        , Y = Math.min(q, K, V)
        , U = Math.min(z, W, H)
        , N = Math.max(q, K, V)
        , j = Math.max(z, W, H)
        , k = $.next;
    while (k !== Q) {
        if (k.x >= Y && k.x <= N && k.y >= U && k.y <= j && qz(q, z, K, W, V, H, k.x, k.y) && D7(k.prev, k, k.next) >= 0)
            return !1;
        k = k.next
    }
    return !0
}
function ex(J, Q, Z, $) {
    let q = J.prev
        , K = J
        , V = J.next;
    if (D7(q, K, V) >= 0)
        return !1;
    let z = q.x
        , W = K.x
        , H = V.x
        , Y = q.y
        , U = K.y
        , N = V.y
        , j = Math.min(z, W, H)
        , k = Math.min(Y, U, N)
        , L = Math.max(z, W, H)
        , F = Math.max(Y, U, N)
        , P = fF(j, k, Q, Z, $)
        , M = fF(L, F, Q, Z, $)
        , v = J.prevZ
        , E = J.nextZ;
    while (v && v.z >= P && E && E.z <= M) {
        if (v.x >= j && v.x <= L && v.y >= k && v.y <= F && v !== q && v !== V && qz(z, Y, W, U, H, N, v.x, v.y) && D7(v.prev, v, v.next) >= 0)
            return !1;
        if (v = v.prevZ,
            E.x >= j && E.x <= L && E.y >= k && E.y <= F && E !== q && E !== V && qz(z, Y, W, U, H, N, E.x, E.y) && D7(E.prev, E, E.next) >= 0)
            return !1;
        E = E.nextZ
    }
    while (v && v.z >= P) {
        if (v.x >= j && v.x <= L && v.y >= k && v.y <= F && v !== q && v !== V && qz(z, Y, W, U, H, N, v.x, v.y) && D7(v.prev, v, v.next) >= 0)
            return !1;
        v = v.prevZ
    }
    while (E && E.z <= M) {
        if (E.x >= j && E.x <= L && E.y >= k && E.y <= F && E !== q && E !== V && qz(z, Y, W, U, H, N, E.x, E.y) && D7(E.prev, E, E.next) >= 0)
            return !1;
        E = E.nextZ
    }
    return !0
}
function Jg(J, Q) {
    let Z = J;
    do {
        let $ = Z.prev
            , q = Z.next.next;
        if (!wq($, q) && gM($, Z, Z.next, q) && Vz($, q) && Vz(q, $))
            Q.push($.i, Z.i, q.i),
                zz(Z),
                zz(Z.next),
                Z = J = q;
        Z = Z.next
    } while (Z !== J);
    return G$(Z)
}
function Qg(J, Q, Z, $, q, K) {
    let V = J;
    do {
        let z = V.next.next;
        while (z !== V.prev) {
            if (V.i !== z.i && Yg(V, z)) {
                let W = mM(V, z);
                V = G$(V, V.next),
                    W = G$(W, W.next),
                    Kz(V, Q, Z, $, q, K, 0),
                    Kz(W, Q, Z, $, q, K, 0);
                return
            }
            z = z.next
        }
        V = V.next
    } while (V !== J)
}
function Zg(J, Q, Z, $) {
    let q = [];
    for (let K = 0, V = Q.length; K < V; K++) {
        let z = Q[K] * $
            , W = K < V - 1 ? Q[K + 1] * $ : J.length
            , H = hM(J, z, W, $, !1);
        if (H === H.next)
            H.steiner = !0;
        q.push(Hg(H))
    }
    q.sort($g);
    for (let K = 0; K < q.length; K++)
        Z = qg(q[K], Z);
    return Z
}
function $g(J, Q) {
    let Z = J.x - Q.x;
    if (Z === 0) {
        if (Z = J.y - Q.y,
            Z === 0) {
            let $ = (J.next.y - J.y) / (J.next.x - J.x)
                , q = (Q.next.y - Q.y) / (Q.next.x - Q.x);
            Z = $ - q
        }
    }
    return Z
}
function qg(J, Q) {
    let Z = Kg(J, Q);
    if (!Z)
        return Q;
    let $ = mM(Z, J);
    return G$($, $.next),
        G$(Z, Z.next)
}
function Kg(J, Q) {
    let Z = Q, $ = J.x, q = J.y, K = -1 / 0, V;
    if (wq(J, Z))
        return Z;
    do {
        if (wq(J, Z.next))
            return Z.next;
        else if (q <= Z.y && q >= Z.next.y && Z.next.y !== Z.y) {
            let U = Z.x + (q - Z.y) * (Z.next.x - Z.x) / (Z.next.y - Z.y);
            if (U <= $ && U > K) {
                if (K = U,
                    V = Z.x < Z.next.x ? Z : Z.next,
                    U === $)
                    return V
            }
        }
        Z = Z.next
    } while (Z !== Q);
    if (!V)
        return null;
    let z = V
        , W = V.x
        , H = V.y
        , Y = 1 / 0;
    Z = V;
    do {
        if ($ >= Z.x && Z.x >= W && $ !== Z.x && xM(q < H ? $ : K, q, W, H, q < H ? K : $, q, Z.x, Z.y)) {
            let U = Math.abs(q - Z.y) / ($ - Z.x);
            if (Vz(Z, J) && (U < Y || U === Y && (Z.x > V.x || Z.x === V.x && Vg(V, Z))))
                V = Z,
                    Y = U
        }
        Z = Z.next
    } while (Z !== z);
    return V
}
function Vg(J, Q) {
    return D7(J.prev, J, Q.prev) < 0 && D7(Q.next, J, J.next) < 0
}
function zg(J, Q, Z, $) {
    let q = J;
    do {
        if (q.z === 0)
            q.z = fF(q.x, q.y, Q, Z, $);
        q.prevZ = q.prev,
            q.nextZ = q.next,
            q = q.next
    } while (q !== J);
    q.prevZ.nextZ = null,
        q.prevZ = null,
        Wg(q)
}
function Wg(J) {
    let Q, Z = 1;
    do {
        let $ = J, q;
        J = null;
        let K = null;
        Q = 0;
        while ($) {
            Q++;
            let V = $
                , z = 0;
            for (let H = 0; H < Z; H++)
                if (z++,
                    V = V.nextZ,
                    !V)
                    break;
            let W = Z;
            while (z > 0 || W > 0 && V) {
                if (z !== 0 && (W === 0 || !V || $.z <= V.z))
                    q = $,
                        $ = $.nextZ,
                        z--;
                else
                    q = V,
                        V = V.nextZ,
                        W--;
                if (K)
                    K.nextZ = q;
                else
                    J = q;
                q.prevZ = K,
                    K = q
            }
            $ = V
        }
        K.nextZ = null,
            Z *= 2
    } while (Q > 1);
    return J
}
function fF(J, Q, Z, $, q) {
    return J = (J - Z) * q | 0,
        Q = (Q - $) * q | 0,
        J = (J | J << 8) & 16711935,
        J = (J | J << 4) & 252645135,
        J = (J | J << 2) & 858993459,
        J = (J | J << 1) & 1431655765,
        Q = (Q | Q << 8) & 16711935,
        Q = (Q | Q << 4) & 252645135,
        Q = (Q | Q << 2) & 858993459,
        Q = (Q | Q << 1) & 1431655765,
        J | Q << 1
}
function Hg(J) {
    let Q = J
        , Z = J;
    do {
        if (Q.x < Z.x || Q.x === Z.x && Q.y < Z.y)
            Z = Q;
        Q = Q.next
    } while (Q !== J);
    return Z
}
function xM(J, Q, Z, $, q, K, V, z) {
    return (q - V) * (Q - z) >= (J - V) * (K - z) && (J - V) * ($ - z) >= (Z - V) * (Q - z) && (Z - V) * (K - z) >= (q - V) * ($ - z)
}
function qz(J, Q, Z, $, q, K, V, z) {
    return !(J === V && Q === z) && xM(J, Q, Z, $, q, K, V, z)
}
function Yg(J, Q) {
    return J.next.i !== Q.i && J.prev.i !== Q.i && !Xg(J, Q) && (Vz(J, Q) && Vz(Q, J) && Ug(J, Q) && (D7(J.prev, J, Q.prev) || D7(J, Q.prev, Q)) || wq(J, Q) && D7(J.prev, J, J.next) > 0 && D7(Q.prev, Q, Q.next) > 0)
}
function D7(J, Q, Z) {
    return (Q.y - J.y) * (Z.x - Q.x) - (Q.x - J.x) * (Z.y - Q.y)
}
function wq(J, Q) {
    return J.x === Q.x && J.y === Q.y
}
function gM(J, Q, Z, $) {
    let q = CU(D7(J, Q, Z))
        , K = CU(D7(J, Q, $))
        , V = CU(D7(Z, $, J))
        , z = CU(D7(Z, $, Q));
    if (q !== K && V !== z)
        return !0;
    if (q === 0 && kU(J, Z, Q))
        return !0;
    if (K === 0 && kU(J, $, Q))
        return !0;
    if (V === 0 && kU(Z, J, $))
        return !0;
    if (z === 0 && kU(Z, Q, $))
        return !0;
    return !1
}
function kU(J, Q, Z) {
    return Q.x <= Math.max(J.x, Z.x) && Q.x >= Math.min(J.x, Z.x) && Q.y <= Math.max(J.y, Z.y) && Q.y >= Math.min(J.y, Z.y)
}
function CU(J) {
    return J > 0 ? 1 : J < 0 ? -1 : 0
}
function Xg(J, Q) {
    let Z = J;
    do {
        if (Z.i !== J.i && Z.next.i !== J.i && Z.i !== Q.i && Z.next.i !== Q.i && gM(Z, Z.next, J, Q))
            return !0;
        Z = Z.next
    } while (Z !== J);
    return !1
}
function Vz(J, Q) {
    return D7(J.prev, J, J.next) < 0 ? D7(J, Q, J.next) >= 0 && D7(J, J.prev, Q) >= 0 : D7(J, Q, J.prev) < 0 || D7(J, J.next, Q) < 0
}
function Ug(J, Q) {
    let Z = J
        , $ = !1
        , q = (J.x + Q.x) / 2
        , K = (J.y + Q.y) / 2;
    do {
        if (Z.y > K !== Z.next.y > K && Z.next.y !== Z.y && q < (Z.next.x - Z.x) * (K - Z.y) / (Z.next.y - Z.y) + Z.x)
            $ = !$;
        Z = Z.next
    } while (Z !== J);
    return $
}
function mM(J, Q) {
    let Z = hF(J.i, J.x, J.y)
        , $ = hF(Q.i, Q.x, Q.y)
        , q = J.next
        , K = Q.prev;
    return J.next = Q,
        Q.prev = J,
        Z.next = q,
        q.prev = Z,
        $.next = Z,
        Z.prev = $,
        K.next = $,
        $.prev = K,
        $
}
function fM(J, Q, Z, $) {
    let q = hF(J, Q, Z);
    if (!$)
        q.prev = q,
            q.next = q;
    else
        q.next = $.next,
            q.prev = $,
            $.next.prev = q,
            $.next = q;
    return q
}
function zz(J) {
    if (J.next.prev = J.prev,
        J.prev.next = J.next,
        J.prevZ)
        J.prevZ.nextZ = J.nextZ;
    if (J.nextZ)
        J.nextZ.prevZ = J.prevZ
}
function hF(J, Q, Z) {
    return {
        i: J,
        x: Q,
        y: Z,
        prev: null,
        next: null,
        z: 0,
        prevZ: null,
        nextZ: null,
        steiner: !1
    }
}
function Ng(J, Q, Z, $) {
    let q = 0;
    for (let K = Q, V = Z - $; K < Z; K += $)
        q += (J[V] - J[K]) * (J[K + 1] + J[V + 1]),
            V = K;
    return q
}
var IU;
var Wz = O(() => {
    wJ();
    IU = OU.default || OU
}
);
function jq(J, Q, Z, $, q, K, V) {
    let z = IU(J, Q, 2);
    if (!z)
        return;
    for (let H = 0; H < z.length; H += 3)
        K[V++] = z[H] + q,
            K[V++] = z[H + 1] + q,
            K[V++] = z[H + 2] + q;
    let W = q * $;
    for (let H = 0; H < J.length; H += 2)
        Z[W] = J[H],
            Z[W + 1] = J[H + 1],
            W += $
}
var Hz = O(() => {
    Wz()
}
);
var wg, LU;
var FU = O(() => {
    w0();
    Hz();
    wg = [],
        LU = {
            extension: {
                type: R.ShapeBuilder,
                name: "polygon"
            },
            build(J, Q) {
                for (let Z = 0; Z < J.points.length; Z++)
                    Q[Z] = J.points[Z];
                return !0
            },
            triangulate(J, Q, Z, $, q, K) {
                jq(J, wg, Q, Z, $, q, K)
            }
        }
}
);
var GU;
var PU = O(() => {
    w0();
    GU = {
        extension: {
            type: R.ShapeBuilder,
            name: "rectangle"
        },
        build(J, Q) {
            let Z = J
                , $ = Z.x
                , q = Z.y
                , K = Z.width
                , V = Z.height;
            if (!(K > 0 && V > 0))
                return !1;
            return Q[0] = $,
                Q[1] = q,
                Q[2] = $ + K,
                Q[3] = q,
                Q[4] = $ + K,
                Q[5] = q + V,
                Q[6] = $,
                Q[7] = q + V,
                !0
        },
        triangulate(J, Q, Z, $, q, K) {
            let V = 0;
            $ *= Z,
                Q[$ + V] = J[0],
                Q[$ + V + 1] = J[1],
                V += Z,
                Q[$ + V] = J[2],
                Q[$ + V + 1] = J[3],
                V += Z,
                Q[$ + V] = J[6],
                Q[$ + V + 1] = J[7],
                V += Z,
                Q[$ + V] = J[4],
                Q[$ + V + 1] = J[5],
                V += Z;
            let z = $ / Z;
            q[K++] = z,
                q[K++] = z + 1,
                q[K++] = z + 2,
                q[K++] = z + 1,
                q[K++] = z + 3,
                q[K++] = z + 2
        }
    }
}
);
var DU;
var AU = O(() => {
    w0();
    DU = {
        extension: {
            type: R.ShapeBuilder,
            name: "triangle"
        },
        build(J, Q) {
            return Q[0] = J.x,
                Q[1] = J.y,
                Q[2] = J.x2,
                Q[3] = J.y2,
                Q[4] = J.x3,
                Q[5] = J.y3,
                !0
        },
        triangulate(J, Q, Z, $, q, K) {
            let V = 0;
            $ *= Z,
                Q[$ + V] = J[0],
                Q[$ + V + 1] = J[1],
                V += Z,
                Q[$ + V] = J[2],
                Q[$ + V + 1] = J[3],
                V += Z,
                Q[$ + V] = J[4],
                Q[$ + V + 1] = J[5];
            let z = $ / Z;
            q[K++] = z,
                q[K++] = z + 1,
                q[K++] = z + 2
        }
    }
}
);
function dM(J, Q) {
    for (let Z = 0; Z < Q.length; Z++) {
        let $ = Q[Z];
        J.addColorStop($.offset, $.color)
    }
}
function pM(J, Q) {
    let Z = a0.get().createCanvas(J, Q)
        , $ = Z.getContext("2d");
    return {
        canvas: Z,
        context: $
    }
}
function jg(J) {
    let Q = J[0] ?? {};
    if (typeof Q === "number" || J[1])
        c0("8.5.2", "use options object instead"),
            Q = {
                type: "linear",
                start: {
                    x: J[0],
                    y: J[1]
                },
                end: {
                    x: J[2],
                    y: J[3]
                },
                textureSpace: J[4],
                textureSize: J[5] ?? MJ.defaultLinearOptions.textureSize
            };
    return Q
}
var cM, xF = class J {
    constructor(...Q) {
        this.uid = i8("fillGradient"),
            this.type = "linear",
            this.colorStops = [];
        let Z = jg(Q);
        if (Z = {
            ...Z.type === "radial" ? J.defaultRadialOptions : J.defaultLinearOptions,
            ...J5(Z)
        },
            this._textureSize = Z.textureSize,
            this._wrapMode = Z.wrapMode,
            Z.type === "radial")
            this.center = Z.center,
                this.outerCenter = Z.outerCenter ?? this.center,
                this.innerRadius = Z.innerRadius,
                this.outerRadius = Z.outerRadius,
                this.scale = Z.scale,
                this.rotation = Z.rotation;
        else
            this.start = Z.start,
                this.end = Z.end;
        this.textureSpace = Z.textureSpace,
            this.type = Z.type,
            Z.colorStops.forEach((q) => {
                this.addColorStop(q.offset, q.color)
            }
            )
    }
    addColorStop(Q, Z) {
        return this.colorStops.push({
            offset: Q,
            color: E8.shared.setValue(Z).toHexa()
        }),
            this
    }
    buildLinearGradient() {
        if (this.texture)
            return;
        let { x: Q, y: Z } = this.start
            , { x: $, y: q } = this.end
            , K = $ - Q
            , V = q - Z
            , z = K < 0 || V < 0;
        if (this._wrapMode === "clamp-to-edge") {
            if (K < 0) {
                let F = Q;
                Q = $,
                    $ = F,
                    K *= -1
            }
            if (V < 0) {
                let F = Z;
                Z = q,
                    q = F,
                    V *= -1
            }
        }
        let W = this.colorStops.length ? this.colorStops : cM
            , H = this._textureSize
            , { canvas: Y, context: U } = pM(H, 1)
            , N = !z ? U.createLinearGradient(0, 0, this._textureSize, 0) : U.createLinearGradient(this._textureSize, 0, 0, 0);
        dM(N, W),
            U.fillStyle = N,
            U.fillRect(0, 0, H, 1),
            this.texture = new _0({
                source: new pJ({
                    resource: Y,
                    addressMode: this._wrapMode
                })
            });
        let j = Math.sqrt(K * K + V * V)
            , k = Math.atan2(V, K)
            , L = new f0;
        if (L.scale(j / H, 1),
            L.rotate(k),
            L.translate(Q, Z),
            this.textureSpace === "local")
            L.scale(H, H);
        this.transform = L
    }
    buildGradient() {
        if (this.type === "linear")
            this.buildLinearGradient();
        else
            this.buildRadialGradient()
    }
    buildRadialGradient() {
        if (this.texture)
            return;
        let Q = this.colorStops.length ? this.colorStops : cM
            , Z = this._textureSize
            , { canvas: $, context: q } = pM(Z, Z)
            , { x: K, y: V } = this.center
            , { x: z, y: W } = this.outerCenter
            , H = this.innerRadius
            , Y = this.outerRadius
            , U = z - Y
            , N = W - Y
            , j = Z / (Y * 2)
            , k = (K - U) * j
            , L = (V - N) * j
            , F = q.createRadialGradient(k, L, H * j, (z - U) * j, (W - N) * j, Y * j);
        dM(F, Q),
            q.fillStyle = Q[Q.length - 1].color,
            q.fillRect(0, 0, Z, Z),
            q.fillStyle = F,
            q.translate(k, L),
            q.rotate(this.rotation),
            q.scale(1, this.scale),
            q.translate(-k, -L),
            q.fillRect(0, 0, Z, Z),
            this.texture = new _0({
                source: new pJ({
                    resource: $,
                    addressMode: this._wrapMode
                })
            });
        let P = new f0;
        if (P.scale(1 / j, 1 / j),
            P.translate(U, N),
            this.textureSpace === "local")
            P.scale(Z, Z);
        this.transform = P
    }
    get styleKey() {
        return this.uid
    }
    destroy() {
        this.texture?.destroy(!0),
            this.texture = null,
            this.transform = null,
            this.colorStops = [],
            this.start = null,
            this.end = null,
            this.center = null,
            this.outerCenter = null
    }
}
    , MJ;
var jZ = O(() => {
    T7();
    M6();
    Z6();
    qZ();
    W6();
    l7();
    O6();
    XQ();
    cM = [{
        offset: 0,
        color: "white"
    }, {
        offset: 1,
        color: "black"
    }];
    xF.defaultLinearOptions = {
        start: {
            x: 0,
            y: 0
        },
        end: {
            x: 0,
            y: 1
        },
        colorStops: [],
        textureSpace: "local",
        type: "linear",
        textureSize: 256,
        wrapMode: "clamp-to-edge"
    };
    xF.defaultRadialOptions = {
        center: {
            x: 0.5,
            y: 0.5
        },
        innerRadius: 0,
        outerRadius: 0.5,
        colorStops: [],
        scale: 1,
        textureSpace: "local",
        type: "radial",
        textureSize: 256,
        wrapMode: "clamp-to-edge"
    };
    MJ = xF
}
);
function EU(J, Q, Z, $) {
    let q = Q.matrix ? J.copyFrom(Q.matrix).invert() : J.identity();
    if (Q.textureSpace === "local") {
        let V = Z.getBounds(kg);
        if (Q.width)
            V.pad(Q.width);
        let { x: z, y: W } = V
            , H = 1 / V.width
            , Y = 1 / V.height
            , U = -z * H
            , N = -W * Y
            , j = q.a
            , k = q.b
            , L = q.c
            , F = q.d;
        q.a *= H,
            q.b *= H,
            q.c *= Y,
            q.d *= Y,
            q.tx = U * j + N * L + q.tx,
            q.ty = U * k + N * F + q.ty
    } else
        q.translate(Q.texture.frame.x, Q.texture.frame.y),
            q.scale(1 / Q.texture.source.width, 1 / Q.texture.source.height);
    let K = Q.texture.source.style;
    if (!(Q.fill instanceof MJ) && K.addressMode === "clamp-to-edge")
        K.addressMode = "repeat",
            K.update();
    if ($)
        q.append(Bg.copyFrom($).invert());
    return q
}
var Bg, kg;
var MU = O(() => {
    Z6();
    E7();
    jZ();
    Bg = new f0,
        kg = new v8
}
);
function _U(J, Q) {
    let { geometryData: Z, batches: $ } = Q;
    $.length = 0,
        Z.indices.length = 0,
        Z.vertices.length = 0,
        Z.uvs.length = 0;
    for (let q = 0; q < J.instructions.length; q++) {
        let K = J.instructions[q];
        if (K.action === "texture")
            Ig(K.data, $, Z);
        else if (K.action === "fill" || K.action === "stroke") {
            let V = K.action === "stroke"
                , z = K.data.path.shapePath
                , W = K.data.style
                , H = K.data.hole;
            if (V && H)
                uM(H.shapePath, W, !0, $, Z);
            if (H)
                z.shapePrimitives[z.shapePrimitives.length - 1].holes = H.shapePath.shapePrimitives;
            uM(z, W, V, $, Z)
        }
    }
}
function Ig(J, Q, Z) {
    let $ = []
        , q = Bq.rectangle
        , K = Cg;
    K.x = J.dx,
        K.y = J.dy,
        K.width = J.dw,
        K.height = J.dh;
    let V = J.transform;
    if (!q.build(K, $))
        return;
    let { vertices: z, uvs: W, indices: H } = Z
        , Y = H.length
        , U = z.length / 2;
    if (V)
        Jz($, V);
    q.triangulate($, z, 2, U, H, Y);
    let N = J.image
        , j = N.uvs;
    W.push(j.x0, j.y0, j.x1, j.y1, j.x3, j.y3, j.x2, j.y2);
    let k = V7.get(NZ);
    k.indexOffset = Y,
        k.indexSize = H.length - Y,
        k.attributeOffset = U,
        k.attributeSize = z.length / 2 - U,
        k.baseColor = J.style,
        k.alpha = J.alpha,
        k.texture = N,
        k.geometryData = Z,
        Q.push(k)
}
function uM(J, Q, Z, $, q) {
    let { vertices: K, uvs: V, indices: z } = q;
    J.shapePrimitives.forEach(({ shape: W, transform: H, holes: Y }) => {
        let U = []
            , N = Bq[W.type];
        if (!N.build(W, U))
            return;
        let j = z.length
            , k = K.length / 2
            , L = "triangle-list";
        if (H)
            Jz(U, H);
        if (!Z)
            if (Y) {
                let v = []
                    , E = U.slice();
                Lg(Y).forEach((u) => {
                    v.push(E.length / 2),
                        E.push(...u)
                }
                ),
                    jq(E, v, K, 2, k, z, j)
            } else
                N.triangulate(U, K, 2, k, z, j);
        else {
            let v = W.closePath ?? !0
                , E = Q;
            if (!E.pixelLine)
                NU(U, E, !1, v, K, z);
            else
                jU(U, v, K, z),
                    L = "line-list"
        }
        let F = V.length / 2
            , P = Q.texture;
        if (P !== _0.WHITE) {
            let v = EU(Og, Q, W, H);
            qU(K, 2, k, V, F, 2, K.length / 2 - k, v)
        } else
            KU(V, F, 2, K.length / 2 - k);
        let M = V7.get(NZ);
        M.indexOffset = j,
            M.indexSize = z.length - j,
            M.attributeOffset = k,
            M.attributeSize = K.length / 2 - k,
            M.baseColor = Q.color,
            M.alpha = Q.alpha,
            M.texture = P,
            M.geometryData = q,
            M.topology = L,
            $.push(M)
    }
    )
}
function Lg(J) {
    let Q = [];
    for (let Z = 0; Z < J.length; Z++) {
        let $ = J[Z].shape
            , q = [];
        if (Bq[$.type].build($, q))
            Q.push(q)
    }
    return Q
}
var Bq, Cg, Og;
var RU = O(() => {
    w0();
    Z6();
    E7();
    VU();
    zU();
    W6();
    s5();
    Qz();
    YU();
    wU();
    BU();
    FU();
    PU();
    AU();
    MU();
    Hz();
    Bq = {};
    e0.handleByMap(R.ShapeBuilder, Bq);
    e0.add(GU, LU, DU, wZ, WU, HU);
    Cg = new v8,
        Og = new f0
}
);
class bU {
    constructor() {
        this.batches = [],
            this.geometryData = {
                vertices: [],
                uvs: [],
                indices: []
            }
    }
}
class vU {
    constructor() {
        this.instructions = new Z$
    }
    init(J) {
        this.batcher = new L$({
            maxTextures: J
        }),
            this.instructions.reset()
    }
    get geometry() {
        return c0(sY, "GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),
            this.batcher.geometry
    }
}
var gF = class J {
    constructor(Q) {
        this._gpuContextHash = {},
            this._graphicsDataContextHash = Object.create(null),
            this._renderer = Q,
            Q.renderableGC.addManagedHash(this, "_gpuContextHash"),
            Q.renderableGC.addManagedHash(this, "_graphicsDataContextHash")
    }
    init(Q) {
        J.defaultOptions.bezierSmoothness = Q?.bezierSmoothness ?? J.defaultOptions.bezierSmoothness
    }
    getContextRenderData(Q) {
        return this._graphicsDataContextHash[Q.uid] || this._initContextRenderData(Q)
    }
    updateGpuContext(Q) {
        let Z = this._gpuContextHash[Q.uid] || this._initContext(Q);
        if (Q.dirty) {
            if (Z)
                this._cleanGraphicsContextData(Q);
            else
                Z = this._initContext(Q);
            _U(Q, Z);
            let $ = Q.batchMode;
            if (Q.customShader || $ === "no-batch")
                Z.isBatchable = !1;
            else if ($ === "auto")
                Z.isBatchable = Z.geometryData.vertices.length < 400;
            else
                Z.isBatchable = !0;
            Q.dirty = !1
        }
        return Z
    }
    getGpuContext(Q) {
        return this._gpuContextHash[Q.uid] || this._initContext(Q)
    }
    _initContextRenderData(Q) {
        let Z = V7.get(vU, {
            maxTextures: this._renderer.limits.maxBatchableTextures
        })
            , { batches: $, geometryData: q } = this._gpuContextHash[Q.uid]
            , K = q.vertices.length
            , V = q.indices.length;
        for (let Y = 0; Y < $.length; Y++)
            $[Y].applyTransform = !1;
        let z = Z.batcher;
        z.ensureAttributeBuffer(K),
            z.ensureIndexBuffer(V),
            z.begin();
        for (let Y = 0; Y < $.length; Y++) {
            let U = $[Y];
            z.add(U)
        }
        z.finish(Z.instructions);
        let W = z.geometry;
        W.indexBuffer.setDataWithSize(z.indexBuffer, z.indexSize, !0),
            W.buffers[0].setDataWithSize(z.attributeBuffer.float32View, z.attributeSize, !0);
        let H = z.batches;
        for (let Y = 0; Y < H.length; Y++) {
            let U = H[Y];
            U.bindGroup = KZ(U.textures.textures, U.textures.count, this._renderer.limits.maxBatchableTextures)
        }
        return this._graphicsDataContextHash[Q.uid] = Z,
            Z
    }
    _initContext(Q) {
        let Z = new bU;
        return Z.context = Q,
            this._gpuContextHash[Q.uid] = Z,
            Q.on("destroy", this.onGraphicsContextDestroy, this),
            this._gpuContextHash[Q.uid]
    }
    onGraphicsContextDestroy(Q) {
        this._cleanGraphicsContextData(Q),
            Q.off("destroy", this.onGraphicsContextDestroy, this),
            this._gpuContextHash[Q.uid] = null
    }
    _cleanGraphicsContextData(Q) {
        let Z = this._gpuContextHash[Q.uid];
        if (!Z.isBatchable) {
            if (this._graphicsDataContextHash[Q.uid])
                V7.return(this.getContextRenderData(Q)),
                    this._graphicsDataContextHash[Q.uid] = null
        }
        if (Z.batches)
            Z.batches.forEach(($) => {
                V7.return($)
            }
            )
    }
    destroy() {
        for (let Q in this._gpuContextHash)
            if (this._gpuContextHash[Q])
                this.onGraphicsContextDestroy(this._gpuContextHash[Q].context)
    }
}
    , BZ;
var kq = O(() => {
    w0();
    zq();
    eV();
    IV();
    O6();
    s5();
    RU();
    gF.extension = {
        type: [R.WebGLSystem, R.WebGPUSystem, R.CanvasSystem],
        name: "graphicsContext"
    };
    gF.defaultOptions = {
        bezierSmoothness: 0.5
    };
    BZ = gF
}
);
var Fg, mF = class J {
    constructor() {
        this.data = 0,
            this.blendMode = "normal",
            this.polygonOffset = 0,
            this.blend = !0,
            this.depthMask = !0
    }
    get blend() {
        return !!(this.data & 1)
    }
    set blend(Q) {
        if (!!(this.data & 1) !== Q)
            this.data ^= 1
    }
    get offsets() {
        return !!(this.data & 2)
    }
    set offsets(Q) {
        if (!!(this.data & 2) !== Q)
            this.data ^= 2
    }
    set cullMode(Q) {
        if (Q === "none") {
            this.culling = !1;
            return
        }
        this.culling = !0,
            this.clockwiseFrontFace = Q === "front"
    }
    get cullMode() {
        if (!this.culling)
            return "none";
        return this.clockwiseFrontFace ? "front" : "back"
    }
    get culling() {
        return !!(this.data & 4)
    }
    set culling(Q) {
        if (!!(this.data & 4) !== Q)
            this.data ^= 4
    }
    get depthTest() {
        return !!(this.data & 8)
    }
    set depthTest(Q) {
        if (!!(this.data & 8) !== Q)
            this.data ^= 8
    }
    get depthMask() {
        return !!(this.data & 32)
    }
    set depthMask(Q) {
        if (!!(this.data & 32) !== Q)
            this.data ^= 32
    }
    get clockwiseFrontFace() {
        return !!(this.data & 16)
    }
    set clockwiseFrontFace(Q) {
        if (!!(this.data & 16) !== Q)
            this.data ^= 16
    }
    get blendMode() {
        return this._blendMode
    }
    set blendMode(Q) {
        this.blend = Q !== "none",
            this._blendMode = Q,
            this._blendModeId = Fg[Q] || 0
    }
    get polygonOffset() {
        return this._polygonOffset
    }
    set polygonOffset(Q) {
        this.offsets = !!Q,
            this._polygonOffset = Q
    }
    toString() {
        return `[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`
    }
    static for2d() {
        let Q = new J;
        return Q.depthTest = !1,
            Q.blend = !0,
            Q
    }
}
    , U7;
var q5 = O(() => {
    Fg = {
        normal: 0,
        add: 1,
        multiply: 2,
        screen: 3,
        overlay: 4,
        erase: 5,
        "normal-npm": 6,
        "add-npm": 7,
        "screen-npm": 8,
        min: 9,
        max: 10
    };
    mF.default2d = mF.for2d();
    U7 = mF
}
);
function T5(J, Q, Z) {
    let $ = (J >> 24 & 255) / 255;
    Q[Z++] = (J & 255) / 255 * $,
        Q[Z++] = (J >> 8 & 255) / 255 * $,
        Q[Z++] = (J >> 16 & 255) / 255 * $,
        Q[Z++] = $
}
var kZ = () => { }
    ;
class SU {
    constructor() {
        this.batches = [],
            this.batched = !1
    }
    destroy() {
        this.batches.forEach((J) => {
            V7.return(J)
        }
        ),
            this.batches.length = 0
    }
}
class Cq {
    constructor(J, Q) {
        this.state = U7.for2d(),
            this.renderer = J,
            this._adaptor = Q,
            this.renderer.runners.contextChange.add(this)
    }
    contextChange() {
        this._adaptor.contextChange(this.renderer)
    }
    validateRenderable(J) {
        let Q = J.context
            , Z = !!J._gpuData
            , $ = this.renderer.graphicsContext.updateGpuContext(Q);
        if ($.isBatchable || Z !== $.isBatchable)
            return !0;
        return !1
    }
    addRenderable(J, Q) {
        let Z = this.renderer.graphicsContext.updateGpuContext(J.context);
        if (J.didViewUpdate)
            this._rebuild(J);
        if (Z.isBatchable)
            this._addToBatcher(J, Q);
        else
            this.renderer.renderPipes.batch.break(Q),
                Q.add(J)
    }
    updateRenderable(J) {
        let Z = this._getGpuDataForRenderable(J).batches;
        for (let $ = 0; $ < Z.length; $++) {
            let q = Z[$];
            q._batcher.updateElement(q)
        }
    }
    execute(J) {
        if (!J.isRenderable)
            return;
        let Q = this.renderer
            , Z = J.context;
        if (!Q.graphicsContext.getGpuContext(Z).batches.length)
            return;
        let q = Z.customShader || this._adaptor.shader;
        this.state.blendMode = J.groupBlendMode;
        let K = q.resources.localUniforms.uniforms;
        K.uTransformMatrix = J.groupTransform,
            K.uRound = Q._roundPixels | J._roundPixels,
            T5(J.groupColorAlpha, K.uColor, 0),
            this._adaptor.execute(this, J)
    }
    _rebuild(J) {
        let Q = this._getGpuDataForRenderable(J)
            , Z = this.renderer.graphicsContext.updateGpuContext(J.context);
        if (Q.destroy(),
            Z.isBatchable)
            this._updateBatchesForRenderable(J, Q)
    }
    _addToBatcher(J, Q) {
        let Z = this.renderer.renderPipes.batch
            , $ = this._getGpuDataForRenderable(J).batches;
        for (let q = 0; q < $.length; q++) {
            let K = $[q];
            Z.addToBatch(K, Q)
        }
    }
    _getGpuDataForRenderable(J) {
        return J._gpuData[this.renderer.uid] || this._initGpuDataForRenderable(J)
    }
    _initGpuDataForRenderable(J) {
        let Q = new SU;
        return J._gpuData[this.renderer.uid] = Q,
            Q
    }
    _updateBatchesForRenderable(J, Q) {
        let Z = J.context
            , $ = this.renderer.graphicsContext.getGpuContext(Z)
            , q = this.renderer._roundPixels | J._roundPixels;
        Q.batches = $.batches.map((K) => {
            let V = V7.get(NZ);
            return K.copyTo(V),
                V.renderable = J,
                V.roundPixels = q,
                V
        }
        )
    }
    destroy() {
        this.renderer = null,
            this._adaptor.destroy(),
            this._adaptor = null,
            this.state = null
    }
}
var TU = O(() => {
    w0();
    q5();
    s5();
    kZ();
    Qz();
    Cq.extension = {
        type: [R.WebGLPipes, R.WebGPUPipes, R.CanvasPipes],
        name: "graphics"
    }
}
);
var cF = O(() => {
    w0();
    kq();
    TU();
    e0.add(Cq);
    e0.add(BZ)
}
);
class FQ {
    constructor() {
        this.batcherName = "default",
            this.packAsQuad = !1,
            this.indexOffset = 0,
            this.attributeOffset = 0,
            this.roundPixels = 0,
            this._batcher = null,
            this._batch = null,
            this._textureMatrixUpdateId = -1,
            this._uvUpdateId = -1
    }
    get blendMode() {
        return this.renderable.groupBlendMode
    }
    get topology() {
        return this._topology || this.geometry.topology
    }
    set topology(J) {
        this._topology = J
    }
    reset() {
        this.renderable = null,
            this.texture = null,
            this._batcher = null,
            this._batch = null,
            this.geometry = null,
            this._uvUpdateId = -1,
            this._textureMatrixUpdateId = -1
    }
    setTexture(J) {
        if (this.texture === J)
            return;
        this.texture = J,
            this._textureMatrixUpdateId = -1
    }
    get uvs() {
        let Q = this.geometry.getBuffer("aUV")
            , Z = Q.data
            , $ = Z
            , q = this.texture.textureMatrix;
        if (!q.isSimple) {
            if ($ = this._transformedUvs,
                this._textureMatrixUpdateId !== q._updateID || this._uvUpdateId !== Q._updateID) {
                if (!$ || $.length < Z.length)
                    $ = this._transformedUvs = new Float32Array(Z.length);
                this._textureMatrixUpdateId = q._updateID,
                    this._uvUpdateId = Q._updateID,
                    q.multiplyUvs(Z, $)
            }
        }
        return $
    }
    get positions() {
        return this.geometry.positions
    }
    get indices() {
        return this.geometry.indices
    }
    get color() {
        return this.renderable.groupColorAlpha
    }
    get groupTransform() {
        return this.renderable.groupTransform
    }
    get attributeSize() {
        return this.geometry.positions.length / 2
    }
    get indexSize() {
        return this.geometry.indices.length
    }
}
var Oq = () => { }
    ;
class Yz {
    destroy() { }
}
class Iq {
    constructor(J, Q) {
        this.localUniforms = new Y6({
            uTransformMatrix: {
                value: new f0,
                type: "mat3x3<f32>"
            },
            uColor: {
                value: new Float32Array([1, 1, 1, 1]),
                type: "vec4<f32>"
            },
            uRound: {
                value: 0,
                type: "f32"
            }
        }),
            this.localUniformsBindGroup = new QJ({
                0: this.localUniforms
            }),
            this.renderer = J,
            this._adaptor = Q,
            this._adaptor.init()
    }
    validateRenderable(J) {
        let Q = this._getMeshData(J)
            , Z = Q.batched
            , $ = J.batched;
        if (Q.batched = $,
            Z !== $)
            return !0;
        else if ($) {
            let q = J._geometry;
            if (q.indices.length !== Q.indexSize || q.positions.length !== Q.vertexSize)
                return Q.indexSize = q.indices.length,
                    Q.vertexSize = q.positions.length,
                    !0;
            let K = this._getBatchableMesh(J);
            if (K.texture.uid !== J._texture.uid)
                K._textureMatrixUpdateId = -1;
            return !K._batcher.checkAndUpdateTexture(K, J._texture)
        }
        return !1
    }
    addRenderable(J, Q) {
        let Z = this.renderer.renderPipes.batch
            , $ = this._getMeshData(J);
        if (J.didViewUpdate)
            $.indexSize = J._geometry.indices?.length,
                $.vertexSize = J._geometry.positions?.length;
        if ($.batched) {
            let q = this._getBatchableMesh(J);
            q.setTexture(J._texture),
                q.geometry = J._geometry,
                Z.addToBatch(q, Q)
        } else
            Z.break(Q),
                Q.add(J)
    }
    updateRenderable(J) {
        if (J.batched) {
            let Q = this._getBatchableMesh(J);
            Q.setTexture(J._texture),
                Q.geometry = J._geometry,
                Q._batcher.updateElement(Q)
        }
    }
    execute(J) {
        if (!J.isRenderable)
            return;
        J.state.blendMode = J9(J.groupBlendMode, J.texture._source);
        let Q = this.localUniforms;
        Q.uniforms.uTransformMatrix = J.groupTransform,
            Q.uniforms.uRound = this.renderer._roundPixels | J._roundPixels,
            Q.update(),
            T5(J.groupColorAlpha, Q.uniforms.uColor, 0),
            this._adaptor.execute(this, J)
    }
    _getMeshData(J) {
        var Q, Z;
        return (Q = J._gpuData)[Z = this.renderer.uid] || (Q[Z] = new Yz),
            J._gpuData[this.renderer.uid].meshData || this._initMeshData(J)
    }
    _initMeshData(J) {
        return J._gpuData[this.renderer.uid].meshData = {
            batched: J.batched,
            indexSize: 0,
            vertexSize: 0
        },
            J._gpuData[this.renderer.uid].meshData
    }
    _getBatchableMesh(J) {
        var Q, Z;
        return (Q = J._gpuData)[Z = this.renderer.uid] || (Q[Z] = new Yz),
            J._gpuData[this.renderer.uid].batchableMesh || this._initBatchableMesh(J)
    }
    _initBatchableMesh(J) {
        let Q = new FQ;
        return Q.renderable = J,
            Q.setTexture(J._texture),
            Q.transform = J.groupTransform,
            Q.roundPixels = this.renderer._roundPixels | J._roundPixels,
            J._gpuData[this.renderer.uid].batchableMesh = Q,
            Q
    }
    destroy() {
        this.localUniforms = null,
            this.localUniformsBindGroup = null,
            this._adaptor.destroy(),
            this._adaptor = null,
            this.renderer = null
    }
}
var yU = O(() => {
    w0();
    Z6();
    R9();
    _7();
    k$();
    kZ();
    Oq();
    Iq.extension = {
        type: [R.WebGLPipes, R.WebGPUPipes, R.CanvasPipes],
        name: "mesh"
    }
}
);
var dF = O(() => {
    w0();
    yU();
    e0.add(Iq)
}
);
class Xz {
    execute(J, Q) {
        let { state: Z, renderer: $ } = J
            , q = Q.shader || J.defaultShader;
        q.resources.uTexture = Q.texture._source,
            q.resources.uniforms = J.localUniforms;
        let K = $.gl
            , V = J.getBuffers(Q);
        $.shader.bind(q),
            $.state.set(Z),
            $.geometry.bind(V.geometry, q.glProgram);
        let W = V.geometry.indexBuffer.data.BYTES_PER_ELEMENT === 2 ? K.UNSIGNED_SHORT : K.UNSIGNED_INT;
        K.drawElements(K.TRIANGLES, Q.particleChildren.length * 6, W, 0)
    }
}
var fU = () => { }
    ;
function Uz(J, Q = null) {
    let Z = J * 6;
    if (Z > 65535)
        Q || (Q = new Uint32Array(Z));
    else
        Q || (Q = new Uint16Array(Z));
    if (Q.length !== Z)
        throw new Error(`Out buffer length is incorrect, got ${Q.length} and expected ${Z}`);
    for (let $ = 0, q = 0; $ < Z; $ += 6,
        q += 4)
        Q[$ + 0] = q + 0,
            Q[$ + 1] = q + 1,
            Q[$ + 2] = q + 2,
            Q[$ + 3] = q + 0,
            Q[$ + 4] = q + 2,
            Q[$ + 5] = q + 3;
    return Q
}
var hU = () => { }
    ;
function xU(J) {
    return {
        dynamicUpdate: lM(J, !0),
        staticUpdate: lM(J, !1)
    }
}
function lM(J, Q) {
    let Z = [];
    Z.push(`

        var index = 0;

        for (let i = 0; i < ps.length; ++i)
        {
            const p = ps[i];

            `);
    let $ = 0;
    for (let K in J) {
        let V = J[K];
        if (Q !== V.dynamic)
            continue;
        Z.push(`offset = index + ${$}`),
            Z.push(V.code);
        let z = EJ(V.format);
        $ += z.stride / 4
    }
    Z.push(`
            index += stride * 4;
        }
    `),
        Z.unshift(`
        var stride = ${$};
    `);
    let q = Z.join(`
`);
    return new Function("ps", "f32v", "u32v", q)
}
var gU = O(() => {
    LQ()
}
);
class Nz {
    constructor(J) {
        this._size = 0,
            this._generateParticleUpdateCache = {};
        let Q = this._size = J.size ?? 1000
            , Z = J.properties
            , $ = 0
            , q = 0;
        for (let H in Z) {
            let Y = Z[H]
                , U = EJ(Y.format);
            if (Y.dynamic)
                q += U.stride;
            else
                $ += U.stride
        }
        this._dynamicStride = q / 4,
            this._staticStride = $ / 4,
            this.staticAttributeBuffer = new e5(Q * 4 * $),
            this.dynamicAttributeBuffer = new e5(Q * 4 * q),
            this.indexBuffer = Uz(Q);
        let K = new uJ
            , V = 0
            , z = 0;
        this._staticBuffer = new P7({
            data: new Float32Array(1),
            label: "static-particle-buffer",
            shrinkToFit: !1,
            usage: a8.VERTEX | a8.COPY_DST
        }),
            this._dynamicBuffer = new P7({
                data: new Float32Array(1),
                label: "dynamic-particle-buffer",
                shrinkToFit: !1,
                usage: a8.VERTEX | a8.COPY_DST
            });
        for (let H in Z) {
            let Y = Z[H]
                , U = EJ(Y.format);
            if (Y.dynamic)
                K.addAttribute(Y.attributeName, {
                    buffer: this._dynamicBuffer,
                    stride: this._dynamicStride * 4,
                    offset: V * 4,
                    format: Y.format
                }),
                    V += U.size;
            else
                K.addAttribute(Y.attributeName, {
                    buffer: this._staticBuffer,
                    stride: this._staticStride * 4,
                    offset: z * 4,
                    format: Y.format
                }),
                    z += U.size
        }
        K.addIndex(this.indexBuffer);
        let W = this.getParticleUpdate(Z);
        this._dynamicUpload = W.dynamicUpdate,
            this._staticUpload = W.staticUpdate,
            this.geometry = K
    }
    getParticleUpdate(J) {
        let Q = Gg(J);
        if (this._generateParticleUpdateCache[Q])
            return this._generateParticleUpdateCache[Q];
        return this._generateParticleUpdateCache[Q] = this.generateParticleUpdate(J),
            this._generateParticleUpdateCache[Q]
    }
    generateParticleUpdate(J) {
        return xU(J)
    }
    update(J, Q) {
        if (J.length > this._size)
            Q = !0,
                this._size = Math.max(J.length, this._size * 1.5 | 0),
                this.staticAttributeBuffer = new e5(this._size * this._staticStride * 4 * 4),
                this.dynamicAttributeBuffer = new e5(this._size * this._dynamicStride * 4 * 4),
                this.indexBuffer = Uz(this._size),
                this.geometry.indexBuffer.setDataWithSize(this.indexBuffer, this.indexBuffer.byteLength, !0);
        let Z = this.dynamicAttributeBuffer;
        if (this._dynamicUpload(J, Z.float32View, Z.uint32View),
            this._dynamicBuffer.setDataWithSize(this.dynamicAttributeBuffer.float32View, J.length * this._dynamicStride * 4, !0),
            Q) {
            let $ = this.staticAttributeBuffer;
            this._staticUpload(J, $.float32View, $.uint32View),
                this._staticBuffer.setDataWithSize($.float32View, J.length * this._staticStride * 4, !0)
        }
    }
    destroy() {
        this._staticBuffer.destroy(),
            this._dynamicBuffer.destroy(),
            this.geometry.destroy()
    }
}
function Gg(J) {
    let Q = [];
    for (let Z in J) {
        let $ = J[Z];
        Q.push(Z, $.code, $.dynamic ? "d" : "s")
    }
    return Q.join("_")
}
var mU = O(() => {
    b9();
    Q9();
    IQ();
    LQ();
    gV();
    hU();
    gU()
}
);
var cU = `varying vec2 vUV;
varying vec4 vColor;

uniform sampler2D uTexture;

void main(void){
    vec4 color = texture2D(uTexture, vUV) * vColor;
    gl_FragColor = color;
}`;
var dU = () => { }
    ;
var pU = `attribute vec2 aVertex;
attribute vec2 aUV;
attribute vec4 aColor;

attribute vec2 aPosition;
attribute float aRotation;

uniform mat3 uTranslationMatrix;
uniform float uRound;
uniform vec2 uResolution;
uniform vec4 uColor;

varying vec2 vUV;
varying vec4 vColor;

vec2 roundPixels(vec2 position, vec2 targetSize)
{       
    return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
}

void main(void){
    float cosRotation = cos(aRotation);
    float sinRotation = sin(aRotation);
    float x = aVertex.x * cosRotation - aVertex.y * sinRotation;
    float y = aVertex.x * sinRotation + aVertex.y * cosRotation;

    vec2 v = vec2(x, y);
    v = v + aPosition;

    gl_Position = vec4((uTranslationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    if(uRound == 1.0)
    {
        gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
    }

    vUV = aUV;
    vColor = vec4(aColor.rgb * aColor.a, aColor.a) * uColor;
}
`;
var uU = () => { }
    ;
var wz = `
struct ParticleUniforms {
  uProjectionMatrix:mat3x3<f32>,
  uColor:vec4<f32>,
  uResolution:vec2<f32>,
  uRoundPixels:f32,
};

@group(0) @binding(0) var<uniform> uniforms: ParticleUniforms;

@group(1) @binding(0) var uTexture: texture_2d<f32>;
@group(1) @binding(1) var uSampler : sampler;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>,
    @location(1) color : vec4<f32>,
  };
@vertex
fn mainVertex(
  @location(0) aVertex: vec2<f32>,
  @location(1) aPosition: vec2<f32>,
  @location(2) aUV: vec2<f32>,
  @location(3) aColor: vec4<f32>,
  @location(4) aRotation: f32,
) -> VSOutput {
  
   let v = vec2(
       aVertex.x * cos(aRotation) - aVertex.y * sin(aRotation),
       aVertex.x * sin(aRotation) + aVertex.y * cos(aRotation)
   ) + aPosition;

   let position = vec4((uniforms.uProjectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    let vColor = vec4(aColor.rgb * aColor.a, aColor.a) * uniforms.uColor;

  return VSOutput(
   position,
   aUV,
   vColor,
  );
}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @location(1) color: vec4<f32>,
  @builtin(position) position: vec4<f32>,
) -> @location(0) vec4<f32> {

    var sample = textureSample(uTexture, uSampler, uv) * color;
   
    return sample;
}`;
var lU = () => { }
    ;
var jz;
var oU = O(() => {
    T7();
    Z6();
    lJ();
    Z5();
    k5();
    W6();
    A9();
    dU();
    uU();
    lU();
    jz = class jz extends k7 {
        constructor() {
            let J = j7.from({
                vertex: pU,
                fragment: cU
            })
                , Q = B7.from({
                    fragment: {
                        source: wz,
                        entryPoint: "mainFragment"
                    },
                    vertex: {
                        source: wz,
                        entryPoint: "mainVertex"
                    }
                });
            super({
                glProgram: J,
                gpuProgram: Q,
                resources: {
                    uTexture: _0.WHITE.source,
                    uSampler: new o7({}),
                    uniforms: {
                        uTranslationMatrix: {
                            value: new f0,
                            type: "mat3x3<f32>"
                        },
                        uColor: {
                            value: new E8(16777215),
                            type: "vec4<f32>"
                        },
                        uRound: {
                            value: 1,
                            type: "f32"
                        },
                        uResolution: {
                            value: [0, 0],
                            type: "vec2<f32>"
                        }
                    }
                }
            })
        }
    }
}
);
class P$ {
    constructor(J, Q) {
        this.state = U7.for2d(),
            this.localUniforms = new Y6({
                uTranslationMatrix: {
                    value: new f0,
                    type: "mat3x3<f32>"
                },
                uColor: {
                    value: new Float32Array(4),
                    type: "vec4<f32>"
                },
                uRound: {
                    value: 1,
                    type: "f32"
                },
                uResolution: {
                    value: [0, 0],
                    type: "vec2<f32>"
                }
            }),
            this.renderer = J,
            this.adaptor = Q,
            this.defaultShader = new jz,
            this.state = U7.for2d()
    }
    validateRenderable(J) {
        return !1
    }
    addRenderable(J, Q) {
        this.renderer.renderPipes.batch.break(Q),
            Q.add(J)
    }
    getBuffers(J) {
        return J._gpuData[this.renderer.uid] || this._initBuffer(J)
    }
    _initBuffer(J) {
        return J._gpuData[this.renderer.uid] = new Nz({
            size: J.particleChildren.length,
            properties: J._properties
        }),
            J._gpuData[this.renderer.uid]
    }
    updateRenderable(J) { }
    execute(J) {
        let Q = J.particleChildren;
        if (Q.length === 0)
            return;
        let Z = this.renderer
            , $ = this.getBuffers(J);
        J.texture || (J.texture = Q[0].texture);
        let q = this.state;
        $.update(Q, J._childrenDirty),
            J._childrenDirty = !1,
            q.blendMode = J9(J.blendMode, J.texture._source);
        let K = this.localUniforms.uniforms
            , V = K.uTranslationMatrix;
        J.worldTransform.copyTo(V),
            V.prepend(Z.globalUniforms.globalUniformData.projectionMatrix),
            K.uResolution = Z.globalUniforms.globalUniformData.resolution,
            K.uRound = Z._roundPixels | J._roundPixels,
            T5(J.groupColorAlpha, K.uColor, 0),
            this.adaptor.execute(this, J)
    }
    destroy() {
        if (this.defaultShader)
            this.defaultShader.destroy(),
                this.defaultShader = null
    }
}
var Bz = O(() => {
    Z6();
    _7();
    k$();
    q5();
    kZ();
    mU();
    oU()
}
);
var Lq;
var nU = O(() => {
    w0();
    fU();
    Bz();
    Lq = class Lq extends P$ {
        constructor(J) {
            super(J, new Xz)
        }
    }
        ;
    Lq.extension = {
        type: [R.WebGLPipes],
        name: "particle"
    }
}
);
class kz {
    execute(J, Q) {
        let Z = J.renderer
            , $ = Q.shader || J.defaultShader;
        $.groups[0] = Z.renderPipes.uniformBatch.getUniformBindGroup(J.localUniforms, !0),
            $.groups[1] = Z.texture.getTextureBindGroup(Q.texture);
        let q = J.state
            , K = J.getBuffers(Q);
        Z.encoder.draw({
            geometry: K.geometry,
            shader: Q.shader || J.defaultShader,
            state: q,
            size: Q.particleChildren.length * 6
        })
    }
}
var sU = () => { }
    ;
var Fq;
var iU = O(() => {
    w0();
    sU();
    Bz();
    Fq = class Fq extends P$ {
        constructor(J) {
            super(J, new kz)
        }
    }
        ;
    Fq.extension = {
        type: [R.WebGPUPipes],
        name: "particle"
    }
}
);
var pF = O(() => {
    w0();
    nU();
    iU();
    e0.add(Lq);
    e0.add(Fq)
}
);
function D$(J, Q) {
    let { texture: Z, bounds: $ } = J
        , q = Q._style._getFinalPadding();
    Jq($, Q._anchor, Z);
    let K = Q._anchor._x * q * 2
        , V = Q._anchor._y * q * 2;
    $.minX -= q - K,
        $.minY -= q - V,
        $.maxX -= q - K,
        $.maxY -= q - V
}
var Cz = O(() => {
    fV()
}
);
class $9 {
    constructor() {
        this.batcherName = "default",
            this.topology = "triangle-list",
            this.attributeSize = 4,
            this.indexSize = 6,
            this.packAsQuad = !0,
            this.roundPixels = 0,
            this._attributeStart = 0,
            this._batcher = null,
            this._batch = null
    }
    get blendMode() {
        return this.renderable.groupBlendMode
    }
    get color() {
        return this.renderable.groupColorAlpha
    }
    reset() {
        this.renderable = null,
            this.texture = null,
            this._batcher = null,
            this._batch = null,
            this.bounds = null
    }
    destroy() { }
}
var A$ = () => { }
    ;
var Oz;
var aU = O(() => {
    A$();
    Oz = class Oz extends $9 {
        constructor(J) {
            super();
            this._renderer = J,
                J.runners.resolutionChange.add(this)
        }
        resolutionChange() {
            let J = this.renderable;
            if (J._autoResolution)
                J.onViewUpdate()
        }
        destroy() {
            this._renderer.canvasText.returnTexture(this.texture),
                this._renderer = null
        }
    }
}
);
class Gq {
    constructor(J) {
        this._renderer = J
    }
    validateRenderable(J) {
        return J._didTextUpdate
    }
    addRenderable(J, Q) {
        let Z = this._getGpuText(J);
        if (J._didTextUpdate)
            this._updateGpuText(J),
                J._didTextUpdate = !1;
        this._renderer.renderPipes.batch.addToBatch(Z, Q)
    }
    updateRenderable(J) {
        let Q = this._getGpuText(J);
        Q._batcher.updateElement(Q)
    }
    _updateGpuText(J) {
        let Q = this._getGpuText(J);
        if (Q.texture)
            this._renderer.canvasText.returnTexture(Q.texture);
        J._resolution = J._autoResolution ? this._renderer.resolution : J.resolution,
            Q.texture = this._renderer.canvasText.getTexture(J),
            D$(Q, J)
    }
    _getGpuText(J) {
        return J._gpuData[this._renderer.uid] || this.initGpuText(J)
    }
    initGpuText(J) {
        let Q = new Oz(this._renderer);
        return Q.renderable = J,
            Q.transform = J.groupTransform,
            Q.bounds = {
                minX: 0,
                maxX: 1,
                minY: 0,
                maxY: 0
            },
            Q.roundPixels = this._renderer._roundPixels | J._roundPixels,
            J._gpuData[this._renderer.uid] = Q,
            Q
    }
    destroy() {
        this._renderer = null
    }
}
var rU = O(() => {
    w0();
    Cz();
    aU();
    Gq.extension = {
        type: [R.WebGLPipes, R.WebGPUPipes, R.CanvasPipes],
        name: "text"
    }
}
);
class T9 {
    constructor(J, Q) {
        if (this.uid = i8("fillPattern"),
            this.transform = new f0,
            this._styleKey = null,
            this.texture = J,
            this.transform.scale(1 / J.frame.width, 1 / J.frame.height),
            Q)
            J.source.style.addressModeU = oM[Q].addressModeU,
                J.source.style.addressModeV = oM[Q].addressModeV
    }
    setTransform(J) {
        let Q = this.texture;
        this.transform.copyFrom(J),
            this.transform.invert(),
            this.transform.scale(1 / Q.frame.width, 1 / Q.frame.height),
            this._styleKey = null
    }
    get styleKey() {
        if (this._styleKey)
            return this._styleKey;
        return this._styleKey = `fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,
            this._styleKey
    }
    destroy() {
        this.texture.destroy(!0),
            this.texture = null,
            this._styleKey = null
    }
}
var oM;
var Pq = O(() => {
    Z6();
    l7();
    oM = {
        repeat: {
            addressModeU: "repeat",
            addressModeV: "repeat"
        },
        "repeat-x": {
            addressModeU: "repeat",
            addressModeV: "clamp-to-edge"
        },
        "repeat-y": {
            addressModeU: "clamp-to-edge",
            addressModeV: "repeat"
        },
        "no-repeat": {
            addressModeU: "clamp-to-edge",
            addressModeV: "clamp-to-edge"
        }
    }
}
);
var sM = G5((W70, nM) => {
    nM.exports = Dg;
    var uF = {
        a: 7,
        c: 6,
        h: 1,
        l: 2,
        m: 2,
        q: 4,
        s: 4,
        t: 2,
        v: 1,
        z: 0
    }
        , Pg = /([astvzqmhlc])([^astvzqmhlc]*)/ig;
    function Dg(J) {
        var Q = [];
        return J.replace(Pg, function (Z, $, q) {
            var K = $.toLowerCase();
            if (q = Eg(q),
                K == "m" && q.length > 2)
                Q.push([$].concat(q.splice(0, 2))),
                    K = "l",
                    $ = $ == "m" ? "l" : "L";
            while (!0) {
                if (q.length == uF[K])
                    return q.unshift($),
                        Q.push(q);
                if (q.length < uF[K])
                    throw new Error("malformed path data");
                Q.push([$].concat(q.splice(0, uF[K])))
            }
        }),
            Q
    }
    var Ag = /-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;
    function Eg(J) {
        var Q = J.match(Ag);
        return Q ? Q.map(Number) : []
    }
}
);
function tU(J, Q) {
    let Z = iM.default(J)
        , $ = []
        , q = null
        , K = 0
        , V = 0;
    for (let z = 0; z < Z.length; z++) {
        let W = Z[z]
            , H = W[0]
            , Y = W;
        switch (H) {
            case "M":
                K = Y[1],
                    V = Y[2],
                    Q.moveTo(K, V);
                break;
            case "m":
                K += Y[1],
                    V += Y[2],
                    Q.moveTo(K, V);
                break;
            case "H":
                K = Y[1],
                    Q.lineTo(K, V);
                break;
            case "h":
                K += Y[1],
                    Q.lineTo(K, V);
                break;
            case "V":
                V = Y[1],
                    Q.lineTo(K, V);
                break;
            case "v":
                V += Y[1],
                    Q.lineTo(K, V);
                break;
            case "L":
                K = Y[1],
                    V = Y[2],
                    Q.lineTo(K, V);
                break;
            case "l":
                K += Y[1],
                    V += Y[2],
                    Q.lineTo(K, V);
                break;
            case "C":
                K = Y[5],
                    V = Y[6],
                    Q.bezierCurveTo(Y[1], Y[2], Y[3], Y[4], K, V);
                break;
            case "c":
                Q.bezierCurveTo(K + Y[1], V + Y[2], K + Y[3], V + Y[4], K + Y[5], V + Y[6]),
                    K += Y[5],
                    V += Y[6];
                break;
            case "S":
                K = Y[3],
                    V = Y[4],
                    Q.bezierCurveToShort(Y[1], Y[2], K, V);
                break;
            case "s":
                Q.bezierCurveToShort(K + Y[1], V + Y[2], K + Y[3], V + Y[4]),
                    K += Y[3],
                    V += Y[4];
                break;
            case "Q":
                K = Y[3],
                    V = Y[4],
                    Q.quadraticCurveTo(Y[1], Y[2], K, V);
                break;
            case "q":
                Q.quadraticCurveTo(K + Y[1], V + Y[2], K + Y[3], V + Y[4]),
                    K += Y[3],
                    V += Y[4];
                break;
            case "T":
                K = Y[1],
                    V = Y[2],
                    Q.quadraticCurveToShort(K, V);
                break;
            case "t":
                K += Y[1],
                    V += Y[2],
                    Q.quadraticCurveToShort(K, V);
                break;
            case "A":
                K = Y[6],
                    V = Y[7],
                    Q.arcToSvg(Y[1], Y[2], Y[3], Y[4], Y[5], K, V);
                break;
            case "a":
                K += Y[6],
                    V += Y[7],
                    Q.arcToSvg(Y[1], Y[2], Y[3], Y[4], Y[5], K, V);
                break;
            case "Z":
            case "z":
                if (Q.closePath(),
                    $.length > 0)
                    if (q = $.pop(),
                        q)
                        K = q.startX,
                            V = q.startY;
                    else
                        K = 0,
                            V = 0;
                q = null;
                break;
            default:
                m0(`Unknown SVG path command: ${H}`)
        }
        if (H !== "Z" && H !== "z") {
            if (q === null)
                q = {
                    startX: K,
                    startY: V
                },
                    $.push(q)
        }
    }
    return Q
}
var iM;
var eU = O(() => {
    iM = oZ(sM(), 1);
    B6()
}
);
class Dq {
    constructor(J = 0, Q = 0, Z = 0) {
        this.type = "circle",
            this.x = J,
            this.y = Q,
            this.radius = Z
    }
    clone() {
        return new Dq(this.x, this.y, this.radius)
    }
    contains(J, Q) {
        if (this.radius <= 0)
            return !1;
        let Z = this.radius * this.radius
            , $ = this.x - J
            , q = this.y - Q;
        return $ *= $,
            q *= q,
            $ + q <= Z
    }
    strokeContains(J, Q, Z, $ = 0.5) {
        if (this.radius === 0)
            return !1;
        let q = this.x - J
            , K = this.y - Q
            , V = this.radius
            , z = (1 - $) * Z
            , W = Math.sqrt(q * q + K * K);
        return W <= V + z && W > V - (Z - z)
    }
    getBounds(J) {
        return J || (J = new v8),
            J.x = this.x - this.radius,
            J.y = this.y - this.radius,
            J.width = this.radius * 2,
            J.height = this.radius * 2,
            J
    }
    copyFrom(J) {
        return this.x = J.x,
            this.y = J.y,
            this.radius = J.radius,
            this
    }
    copyTo(J) {
        return J.copyFrom(this),
            J
    }
    toString() {
        return `[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`
    }
}
var JN = O(() => {
    E7()
}
);
class Aq {
    constructor(J = 0, Q = 0, Z = 0, $ = 0) {
        this.type = "ellipse",
            this.x = J,
            this.y = Q,
            this.halfWidth = Z,
            this.halfHeight = $
    }
    clone() {
        return new Aq(this.x, this.y, this.halfWidth, this.halfHeight)
    }
    contains(J, Q) {
        if (this.halfWidth <= 0 || this.halfHeight <= 0)
            return !1;
        let Z = (J - this.x) / this.halfWidth
            , $ = (Q - this.y) / this.halfHeight;
        return Z *= Z,
            $ *= $,
            Z + $ <= 1
    }
    strokeContains(J, Q, Z, $ = 0.5) {
        let { halfWidth: q, halfHeight: K } = this;
        if (q <= 0 || K <= 0)
            return !1;
        let V = Z * (1 - $)
            , z = Z - V
            , W = q - z
            , H = K - z
            , Y = q + V
            , U = K + V
            , N = J - this.x
            , j = Q - this.y
            , k = N * N / (W * W) + j * j / (H * H)
            , L = N * N / (Y * Y) + j * j / (U * U);
        return k > 1 && L <= 1
    }
    getBounds(J) {
        return J || (J = new v8),
            J.x = this.x - this.halfWidth,
            J.y = this.y - this.halfHeight,
            J.width = this.halfWidth * 2,
            J.height = this.halfHeight * 2,
            J
    }
    copyFrom(J) {
        return this.x = J.x,
            this.y = J.y,
            this.halfWidth = J.halfWidth,
            this.halfHeight = J.halfHeight,
            this
    }
    copyTo(J) {
        return J.copyFrom(this),
            J
    }
    toString() {
        return `[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`
    }
}
var QN = O(() => {
    E7()
}
);
function Iz(J, Q, Z, $, q, K) {
    let V = J - Z
        , z = Q - $
        , W = q - Z
        , H = K - $
        , Y = V * W + z * H
        , U = W * W + H * H
        , N = -1;
    if (U !== 0)
        N = Y / U;
    let j, k;
    if (N < 0)
        j = Z,
            k = $;
    else if (N > 1)
        j = q,
            k = K;
    else
        j = Z + N * W,
            k = $ + N * H;
    let L = J - j
        , F = Q - k;
    return L * L + F * F
}
var Lz = () => { }
    ;
class CZ {
    constructor(...J) {
        this.type = "polygon";
        let Q = Array.isArray(J[0]) ? J[0] : J;
        if (typeof Q[0] !== "number") {
            let Z = [];
            for (let $ = 0, q = Q.length; $ < q; $++)
                Z.push(Q[$].x, Q[$].y);
            Q = Z
        }
        this.points = Q,
            this.closePath = !0
    }
    isClockwise() {
        let J = 0
            , Q = this.points
            , Z = Q.length;
        for (let $ = 0; $ < Z; $ += 2) {
            let q = Q[$]
                , K = Q[$ + 1]
                , V = Q[($ + 2) % Z]
                , z = Q[($ + 3) % Z];
            J += (V - q) * (z + K)
        }
        return J < 0
    }
    containsPolygon(J) {
        let Q = this.getBounds(Mg)
            , Z = J.getBounds(_g);
        if (!Q.containsRect(Z))
            return !1;
        let $ = J.points;
        for (let q = 0; q < $.length; q += 2) {
            let K = $[q]
                , V = $[q + 1];
            if (!this.contains(K, V))
                return !1
        }
        return !0
    }
    clone() {
        let J = this.points.slice()
            , Q = new CZ(J);
        return Q.closePath = this.closePath,
            Q
    }
    contains(J, Q) {
        let Z = !1
            , $ = this.points.length / 2;
        for (let q = 0, K = $ - 1; q < $; K = q++) {
            let V = this.points[q * 2]
                , z = this.points[q * 2 + 1]
                , W = this.points[K * 2]
                , H = this.points[K * 2 + 1];
            if (z > Q !== H > Q && J < (W - V) * ((Q - z) / (H - z)) + V)
                Z = !Z
        }
        return Z
    }
    strokeContains(J, Q, Z, $ = 0.5) {
        let q = Z * Z
            , K = q * (1 - $)
            , V = q - K
            , { points: z } = this
            , W = z.length - (this.closePath ? 0 : 2);
        for (let H = 0; H < W; H += 2) {
            let Y = z[H]
                , U = z[H + 1]
                , N = z[(H + 2) % z.length]
                , j = z[(H + 3) % z.length]
                , k = Iz(J, Q, Y, U, N, j)
                , L = Math.sign((N - Y) * (Q - U) - (j - U) * (J - Y));
            if (k <= (L < 0 ? V : K))
                return !0
        }
        return !1
    }
    getBounds(J) {
        J || (J = new v8);
        let Q = this.points
            , Z = 1 / 0
            , $ = -1 / 0
            , q = 1 / 0
            , K = -1 / 0;
        for (let V = 0, z = Q.length; V < z; V += 2) {
            let W = Q[V]
                , H = Q[V + 1];
            Z = W < Z ? W : Z,
                $ = W > $ ? W : $,
                q = H < q ? H : q,
                K = H > K ? H : K
        }
        return J.x = Z,
            J.width = $ - Z,
            J.y = q,
            J.height = K - q,
            J
    }
    copyFrom(J) {
        return this.points = J.points.slice(),
            this.closePath = J.closePath,
            this
    }
    copyTo(J) {
        return J.copyFrom(this),
            J
    }
    toString() {
        return `[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((J, Q) => `${J}, ${Q}`, "")}]`
    }
    get lastX() {
        return this.points[this.points.length - 2]
    }
    get lastY() {
        return this.points[this.points.length - 1]
    }
    get x() {
        return c0("8.11.0", "Polygon.lastX is deprecated, please use Polygon.lastX instead."),
            this.points[this.points.length - 2]
    }
    get y() {
        return c0("8.11.0", "Polygon.y is deprecated, please use Polygon.lastY instead."),
            this.points[this.points.length - 1]
    }
    get startX() {
        return this.points[0]
    }
    get startY() {
        return this.points[1]
    }
}
var Mg, _g;
var ZN = O(() => {
    O6();
    Lz();
    E7()
}
);
class Eq {
    constructor(J = 0, Q = 0, Z = 0, $ = 0, q = 20) {
        this.type = "roundedRectangle",
            this.x = J,
            this.y = Q,
            this.width = Z,
            this.height = $,
            this.radius = q
    }
    getBounds(J) {
        return J || (J = new v8),
            J.x = this.x,
            J.y = this.y,
            J.width = this.width,
            J.height = this.height,
            J
    }
    clone() {
        return new Eq(this.x, this.y, this.width, this.height, this.radius)
    }
    copyFrom(J) {
        return this.x = J.x,
            this.y = J.y,
            this.width = J.width,
            this.height = J.height,
            this
    }
    copyTo(J) {
        return J.copyFrom(this),
            J
    }
    contains(J, Q) {
        if (this.width <= 0 || this.height <= 0)
            return !1;
        if (J >= this.x && J <= this.x + this.width) {
            if (Q >= this.y && Q <= this.y + this.height) {
                let Z = Math.max(0, Math.min(this.radius, Math.min(this.width, this.height) / 2));
                if (Q >= this.y + Z && Q <= this.y + this.height - Z || J >= this.x + Z && J <= this.x + this.width - Z)
                    return !0;
                let $ = J - (this.x + Z)
                    , q = Q - (this.y + Z)
                    , K = Z * Z;
                if ($ * $ + q * q <= K)
                    return !0;
                if ($ = J - (this.x + this.width - Z),
                    $ * $ + q * q <= K)
                    return !0;
                if (q = Q - (this.y + this.height - Z),
                    $ * $ + q * q <= K)
                    return !0;
                if ($ = J - (this.x + Z),
                    $ * $ + q * q <= K)
                    return !0
            }
        }
        return !1
    }
    strokeContains(J, Q, Z, $ = 0.5) {
        let { x: q, y: K, width: V, height: z, radius: W } = this
            , H = Z * (1 - $)
            , Y = Z - H
            , U = q + W
            , N = K + W
            , j = V - W * 2
            , k = z - W * 2
            , L = q + V
            , F = K + z;
        if ((J >= q - H && J <= q + Y || J >= L - Y && J <= L + H) && Q >= N && Q <= N + k)
            return !0;
        if ((Q >= K - H && Q <= K + Y || Q >= F - Y && Q <= F + H) && J >= U && J <= U + j)
            return !0;
        return J < U && Q < N && $N(J, Q, U, N, W, Y, H) || J > L - W && Q < N && $N(J, Q, L - W, N, W, Y, H) || J > L - W && Q > F - W && $N(J, Q, L - W, F - W, W, Y, H) || J < U && Q > F - W && $N(J, Q, U, F - W, W, Y, H)
    }
    toString() {
        return `[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`
    }
}
var $N = (J, Q, Z, $, q, K, V) => {
    let z = J - Z
        , W = Q - $
        , H = Math.sqrt(z * z + W * W);
    return H >= q - K && H <= q + V
}
    ;
var qN = O(() => {
    E7()
}
);
function _q(J, Q, Z, $, q, K, V, z, W, H) {
    let U = Math.min(0.99, Math.max(0, H ?? BZ.defaultOptions.bezierSmoothness))
        , N = (bg - U) / 1;
    return N *= N,
        vg(Q, Z, $, q, K, V, z, W, J, N),
        J
}
function vg(J, Q, Z, $, q, K, V, z, W, H) {
    oF(J, Q, Z, $, q, K, V, z, W, H, 0),
        W.push(V, z)
}
function oF(J, Q, Z, $, q, K, V, z, W, H, Y) {
    if (Y > Rg)
        return;
    let U = Math.PI
        , N = (J + Z) / 2
        , j = (Q + $) / 2
        , k = (Z + q) / 2
        , L = ($ + K) / 2
        , F = (q + V) / 2
        , P = (K + z) / 2
        , M = (N + k) / 2
        , v = (j + L) / 2
        , E = (k + F) / 2
        , n = (L + P) / 2
        , u = (M + E) / 2
        , b = (v + n) / 2;
    if (Y > 0) {
        let i = V - J, g = z - Q, l = Math.abs((Z - V) * g - ($ - z) * i), o = Math.abs((q - V) * g - (K - z) * i), F0, b0;
        if (l > KN && o > KN) {
            if ((l + o) * (l + o) <= H * (i * i + g * g)) {
                if (Mq < lF) {
                    W.push(u, b);
                    return
                }
                let d0 = Math.atan2(K - $, q - Z);
                if (F0 = Math.abs(d0 - Math.atan2($ - Q, Z - J)),
                    b0 = Math.abs(Math.atan2(z - K, V - q) - d0),
                    F0 >= U)
                    F0 = 2 * U - F0;
                if (b0 >= U)
                    b0 = 2 * U - b0;
                if (F0 + b0 < Mq) {
                    W.push(u, b);
                    return
                }
                if (E$ !== 0) {
                    if (F0 > E$) {
                        W.push(Z, $);
                        return
                    }
                    if (b0 > E$) {
                        W.push(q, K);
                        return
                    }
                }
            }
        } else if (l > KN) {
            if (l * l <= H * (i * i + g * g)) {
                if (Mq < lF) {
                    W.push(u, b);
                    return
                }
                if (F0 = Math.abs(Math.atan2(K - $, q - Z) - Math.atan2($ - Q, Z - J)),
                    F0 >= U)
                    F0 = 2 * U - F0;
                if (F0 < Mq) {
                    W.push(Z, $),
                        W.push(q, K);
                    return
                }
                if (E$ !== 0) {
                    if (F0 > E$) {
                        W.push(Z, $);
                        return
                    }
                }
            }
        } else if (o > KN) {
            if (o * o <= H * (i * i + g * g)) {
                if (Mq < lF) {
                    W.push(u, b);
                    return
                }
                if (F0 = Math.abs(Math.atan2(z - K, V - q) - Math.atan2(K - $, q - Z)),
                    F0 >= U)
                    F0 = 2 * U - F0;
                if (F0 < Mq) {
                    W.push(Z, $),
                        W.push(q, K);
                    return
                }
                if (E$ !== 0) {
                    if (F0 > E$) {
                        W.push(q, K);
                        return
                    }
                }
            }
        } else if (i = u - (J + V) / 2,
            g = b - (Q + z) / 2,
            i * i + g * g <= H) {
            W.push(u, b);
            return
        }
    }
    oF(J, Q, N, j, M, v, u, b, W, H, Y + 1),
        oF(u, b, E, n, F, P, V, z, W, H, Y + 1)
}
var Rg = 8
    , KN = 0.00000011920929
    , bg = 1
    , lF = 0.01
    , Mq = 0
    , E$ = 0;
var Fz = O(() => {
    kq()
}
);
function VN(J, Q, Z, $, q, K, V, z) {
    let H = Math.min(0.99, Math.max(0, z ?? BZ.defaultOptions.bezierSmoothness))
        , Y = (yg - H) / 1;
    return Y *= Y,
        hg(Q, Z, $, q, K, V, J, Y),
        J
}
function hg(J, Q, Z, $, q, K, V, z) {
    nF(V, J, Q, Z, $, q, K, z, 0),
        V.push(q, K)
}
function nF(J, Q, Z, $, q, K, V, z, W) {
    if (W > Sg)
        return;
    let H = Math.PI
        , Y = (Q + $) / 2
        , U = (Z + q) / 2
        , N = ($ + K) / 2
        , j = (q + V) / 2
        , k = (Y + N) / 2
        , L = (U + j) / 2
        , F = K - Q
        , P = V - Z
        , M = Math.abs(($ - K) * P - (q - V) * F);
    if (M > Tg) {
        if (M * M <= z * (F * F + P * P)) {
            if (aM < fg) {
                J.push(k, L);
                return
            }
            let v = Math.abs(Math.atan2(V - q, K - $) - Math.atan2(q - Z, $ - Q));
            if (v >= H)
                v = 2 * H - v;
            if (v < aM) {
                J.push(k, L);
                return
            }
        }
    } else if (F = k - (Q + K) / 2,
        P = L - (Z + V) / 2,
        F * F + P * P <= z) {
        J.push(k, L);
        return
    }
    nF(J, Q, Z, Y, U, k, L, z, W + 1),
        nF(J, k, L, N, j, K, V, z, W + 1)
}
var Sg = 8
    , Tg = 0.00000011920929
    , yg = 1
    , fg = 0.01
    , aM = 0;
var zN = O(() => {
    kq()
}
);
function Rq(J, Q, Z, $, q, K, V, z) {
    let W = Math.abs(q - K);
    if (!V && q > K)
        W = 2 * Math.PI - W;
    else if (V && K > q)
        W = 2 * Math.PI - W;
    z || (z = Math.max(6, Math.floor(6 * Math.pow($, 0.3333333333333333) * (W / Math.PI)))),
        z = Math.max(z, 3);
    let H = W / z
        , Y = q;
    H *= V ? -1 : 1;
    for (let U = 0; U < z + 1; U++) {
        let N = Math.cos(Y)
            , j = Math.sin(Y)
            , k = Q + N * $
            , L = Z + j * $;
        J.push(k, L),
            Y += H
    }
}
var Gz = () => { }
    ;
function WN(J, Q, Z, $, q, K) {
    let V = J[J.length - 2]
        , W = J[J.length - 1] - Z
        , H = V - Q
        , Y = q - Z
        , U = $ - Q
        , N = Math.abs(W * U - H * Y);
    if (N < 0.00000001 || K === 0) {
        if (J[J.length - 2] !== Q || J[J.length - 1] !== Z)
            J.push(Q, Z);
        return
    }
    let j = W * W + H * H
        , k = Y * Y + U * U
        , L = W * Y + H * U
        , F = K * Math.sqrt(j) / N
        , P = K * Math.sqrt(k) / N
        , M = F * L / j
        , v = P * L / k
        , E = F * U + P * H
        , n = F * Y + P * W
        , u = H * (P + M)
        , b = W * (P + M)
        , i = U * (F + v)
        , g = Y * (F + v)
        , l = Math.atan2(b - n, u - E)
        , o = Math.atan2(g - n, i - E);
    Rq(J, E + Q, n + Z, K, l, o, H * Y > U * W)
}
var HN = O(() => {
    Gz()
}
);
function xg(J, Q) {
    let Z = Q === -1.5707963267948966 ? -0.551915024494 : 1.3333333333333333 * Math.tan(Q / 4)
        , $ = Q === 1.5707963267948966 ? 0.551915024494 : Z
        , q = Math.cos(J)
        , K = Math.sin(J)
        , V = Math.cos(J + Q)
        , z = Math.sin(J + Q);
    return [{
        x: q - K * $,
        y: K + q * $
    }, {
        x: V + z * $,
        y: z - V * $
    }, {
        x: V,
        y: z
    }]
}
function YN(J, Q, Z, $, q, K, V, z = 0, W = 0, H = 0) {
    if (K === 0 || V === 0)
        return;
    let Y = Math.sin(z * Pz / 360)
        , U = Math.cos(z * Pz / 360)
        , N = U * (Q - $) / 2 + Y * (Z - q) / 2
        , j = -Y * (Q - $) / 2 + U * (Z - q) / 2;
    if (N === 0 && j === 0)
        return;
    K = Math.abs(K),
        V = Math.abs(V);
    let k = Math.pow(N, 2) / Math.pow(K, 2) + Math.pow(j, 2) / Math.pow(V, 2);
    if (k > 1)
        K *= Math.sqrt(k),
            V *= Math.sqrt(k);
    gg(Q, Z, $, q, K, V, W, H, Y, U, N, j, sF);
    let { ang1: L, ang2: F } = sF
        , { centerX: P, centerY: M } = sF
        , v = Math.abs(F) / (Pz / 4);
    if (Math.abs(1 - v) < 0.0000001)
        v = 1;
    let E = Math.max(Math.ceil(v), 1);
    F /= E;
    let n = J[J.length - 2]
        , u = J[J.length - 1]
        , b = {
            x: 0,
            y: 0
        };
    for (let i = 0; i < E; i++) {
        let g = xg(L, F)
            , { x: l, y: o } = iF(g[0], K, V, U, Y, P, M, b)
            , { x: F0, y: b0 } = iF(g[1], K, V, U, Y, P, M, b)
            , { x: d0, y: H8 } = iF(g[2], K, V, U, Y, P, M, b);
        _q(J, n, u, l, o, F0, b0, d0, H8),
            n = d0,
            u = H8,
            L += F
    }
}
var Pz, sF, iF = ({ x: J, y: Q }, Z, $, q, K, V, z, W) => {
    J *= Z,
        Q *= $;
    let H = q * J - K * Q
        , Y = K * J + q * Q;
    return W.x = H + V,
        W.y = Y + z,
        W
}
    , rM = (J, Q, Z, $) => {
        let q = J * $ - Q * Z < 0 ? -1 : 1
            , K = J * Z + Q * $;
        if (K > 1)
            K = 1;
        if (K < -1)
            K = -1;
        return q * Math.acos(K)
    }
    , gg = (J, Q, Z, $, q, K, V, z, W, H, Y, U, N) => {
        let j = Math.pow(q, 2)
            , k = Math.pow(K, 2)
            , L = Math.pow(Y, 2)
            , F = Math.pow(U, 2)
            , P = j * k - j * F - k * L;
        if (P < 0)
            P = 0;
        P /= j * F + k * L,
            P = Math.sqrt(P) * (V === z ? -1 : 1);
        let M = P * q / K * U
            , v = P * -K / q * Y
            , E = H * M - W * v + (J + Z) / 2
            , n = W * M + H * v + (Q + $) / 2
            , u = (Y - M) / q
            , b = (U - v) / K
            , i = (-Y - M) / q
            , g = (-U - v) / K
            , l = rM(1, 0, u, b)
            , o = rM(u, b, i, g);
        if (z === 0 && o > 0)
            o -= Pz;
        if (z === 1 && o < 0)
            o += Pz;
        N.centerX = E,
            N.centerY = n,
            N.ang1 = l,
            N.ang2 = o
    }
    ;
var XN = O(() => {
    Fz();
    Pz = Math.PI * 2,
        sF = {
            centerX: 0,
            centerY: 0,
            ang1: 0,
            ang2: 0
        }
}
);
function UN(J, Q, Z) {
    let $ = (V, z) => {
        let W = z.x - V.x
            , H = z.y - V.y
            , Y = Math.sqrt(W * W + H * H)
            , U = W / Y
            , N = H / Y;
        return {
            len: Y,
            nx: U,
            ny: N
        }
    }
        , q = (V, z) => {
            if (V === 0)
                J.moveTo(z.x, z.y);
            else
                J.lineTo(z.x, z.y)
        }
        , K = Q[Q.length - 1];
    for (let V = 0; V < Q.length; V++) {
        let z = Q[V % Q.length]
            , W = z.radius ?? Z;
        if (W <= 0) {
            q(V, z),
                K = z;
            continue
        }
        let H = Q[(V + 1) % Q.length]
            , Y = $(z, K)
            , U = $(z, H);
        if (Y.len < 0.0001 || U.len < 0.0001) {
            q(V, z),
                K = z;
            continue
        }
        let N = Math.asin(Y.nx * U.ny - Y.ny * U.nx)
            , j = 1
            , k = !1;
        if (Y.nx * U.nx - Y.ny * -U.ny < 0)
            if (N < 0)
                N = Math.PI + N;
            else
                N = Math.PI - N,
                    j = -1,
                    k = !0;
        else if (N > 0)
            j = -1,
                k = !0;
        let L = N / 2, F, P = Math.abs(Math.cos(L) * W / Math.sin(L));
        if (P > Math.min(Y.len / 2, U.len / 2))
            P = Math.min(Y.len / 2, U.len / 2),
                F = Math.abs(P * Math.sin(L) / Math.cos(L));
        else
            F = W;
        let M = z.x + U.nx * P + -U.ny * F * j
            , v = z.y + U.ny * P + U.nx * F * j
            , E = Math.atan2(Y.ny, Y.nx) + Math.PI / 2 * j
            , n = Math.atan2(U.ny, U.nx) - Math.PI / 2 * j;
        if (V === 0)
            J.moveTo(M + Math.cos(E) * F, v + Math.sin(E) * F);
        J.arc(M, v, F, E, n, k),
            K = z
    }
}
function NN(J, Q, Z, $) {
    let q = (z, W) => Math.sqrt((z.x - W.x) ** 2 + (z.y - W.y) ** 2)
        , K = (z, W, H) => ({
            x: z.x + (W.x - z.x) * H,
            y: z.y + (W.y - z.y) * H
        })
        , V = Q.length;
    for (let z = 0; z < V; z++) {
        let W = Q[(z + 1) % V]
            , H = W.radius ?? Z;
        if (H <= 0) {
            if (z === 0)
                J.moveTo(W.x, W.y);
            else
                J.lineTo(W.x, W.y);
            continue
        }
        let Y = Q[z], U = Q[(z + 2) % V], N = q(Y, W), j;
        if (N < 0.0001)
            j = W;
        else {
            let F = Math.min(N / 2, H);
            j = K(W, Y, F / N)
        }
        let k = q(U, W), L;
        if (k < 0.0001)
            L = W;
        else {
            let F = Math.min(k / 2, H);
            L = K(W, U, F / k)
        }
        if (z === 0)
            J.moveTo(j.x, j.y);
        else
            J.lineTo(j.x, j.y);
        J.quadraticCurveTo(W.x, W.y, L.x, L.y, $)
    }
}
var wN = () => { }
    ;
class Dz {
    constructor(J) {
        this.shapePrimitives = [],
            this._currentPoly = null,
            this._bounds = new E6,
            this._graphicsPath2D = J,
            this.signed = J.checkForHoles
    }
    moveTo(J, Q) {
        return this.startPoly(J, Q),
            this
    }
    lineTo(J, Q) {
        this._ensurePoly();
        let Z = this._currentPoly.points
            , $ = Z[Z.length - 2]
            , q = Z[Z.length - 1];
        if ($ !== J || q !== Q)
            Z.push(J, Q);
        return this
    }
    arc(J, Q, Z, $, q, K) {
        this._ensurePoly(!1);
        let V = this._currentPoly.points;
        return Rq(V, J, Q, Z, $, q, K),
            this
    }
    arcTo(J, Q, Z, $, q) {
        this._ensurePoly();
        let K = this._currentPoly.points;
        return WN(K, J, Q, Z, $, q),
            this
    }
    arcToSvg(J, Q, Z, $, q, K, V) {
        let z = this._currentPoly.points;
        return YN(z, this._currentPoly.lastX, this._currentPoly.lastY, K, V, J, Q, Z, $, q),
            this
    }
    bezierCurveTo(J, Q, Z, $, q, K, V) {
        this._ensurePoly();
        let z = this._currentPoly;
        return _q(this._currentPoly.points, z.lastX, z.lastY, J, Q, Z, $, q, K, V),
            this
    }
    quadraticCurveTo(J, Q, Z, $, q) {
        this._ensurePoly();
        let K = this._currentPoly;
        return VN(this._currentPoly.points, K.lastX, K.lastY, J, Q, Z, $, q),
            this
    }
    closePath() {
        return this.endPoly(!0),
            this
    }
    addPath(J, Q) {
        if (this.endPoly(),
            Q && !Q.isIdentity())
            J = J.clone(!0),
                J.transform(Q);
        let Z = this.shapePrimitives
            , $ = Z.length;
        for (let q = 0; q < J.instructions.length; q++) {
            let K = J.instructions[q];
            this[K.action](...K.data)
        }
        if (J.checkForHoles && Z.length - $ > 1) {
            let q = null;
            for (let K = $; K < Z.length; K++) {
                let V = Z[K];
                if (V.shape.type === "polygon") {
                    let z = V.shape
                        , W = q?.shape;
                    if (W && W.containsPolygon(z))
                        q.holes || (q.holes = []),
                            q.holes.push(V),
                            Z.copyWithin(K, K + 1),
                            Z.length--,
                            K--;
                    else
                        q = V
                }
            }
        }
        return this
    }
    finish(J = !1) {
        this.endPoly(J)
    }
    rect(J, Q, Z, $, q) {
        return this.drawShape(new v8(J, Q, Z, $), q),
            this
    }
    circle(J, Q, Z, $) {
        return this.drawShape(new Dq(J, Q, Z), $),
            this
    }
    poly(J, Q, Z) {
        let $ = new CZ(J);
        return $.closePath = Q,
            this.drawShape($, Z),
            this
    }
    regularPoly(J, Q, Z, $, q = 0, K) {
        $ = Math.max($ | 0, 3);
        let V = -1 * Math.PI / 2 + q
            , z = Math.PI * 2 / $
            , W = [];
        for (let H = 0; H < $; H++) {
            let Y = V - H * z;
            W.push(J + Z * Math.cos(Y), Q + Z * Math.sin(Y))
        }
        return this.poly(W, !0, K),
            this
    }
    roundPoly(J, Q, Z, $, q, K = 0, V) {
        if ($ = Math.max($ | 0, 3),
            q <= 0)
            return this.regularPoly(J, Q, Z, $, K);
        let z = Z * Math.sin(Math.PI / $) - 0.001;
        q = Math.min(q, z);
        let W = -1 * Math.PI / 2 + K
            , H = Math.PI * 2 / $
            , Y = ($ - 2) * Math.PI / $ / 2;
        for (let U = 0; U < $; U++) {
            let N = U * H + W
                , j = J + Z * Math.cos(N)
                , k = Q + Z * Math.sin(N)
                , L = N + Math.PI + Y
                , F = N - Math.PI - Y
                , P = j + q * Math.cos(L)
                , M = k + q * Math.sin(L)
                , v = j + q * Math.cos(F)
                , E = k + q * Math.sin(F);
            if (U === 0)
                this.moveTo(P, M);
            else
                this.lineTo(P, M);
            this.quadraticCurveTo(j, k, v, E, V)
        }
        return this.closePath()
    }
    roundShape(J, Q, Z = !1, $) {
        if (J.length < 3)
            return this;
        if (Z)
            NN(this, J, Q, $);
        else
            UN(this, J, Q);
        return this.closePath()
    }
    filletRect(J, Q, Z, $, q) {
        if (q === 0)
            return this.rect(J, Q, Z, $);
        let K = Math.min(Z, $) / 2
            , V = Math.min(K, Math.max(-K, q))
            , z = J + Z
            , W = Q + $
            , H = V < 0 ? -V : 0
            , Y = Math.abs(V);
        return this.moveTo(J, Q + Y).arcTo(J + H, Q + H, J + Y, Q, Y).lineTo(z - Y, Q).arcTo(z - H, Q + H, z, Q + Y, Y).lineTo(z, W - Y).arcTo(z - H, W - H, J + Z - Y, W, Y).lineTo(J + Y, W).arcTo(J + H, W - H, J, W - Y, Y).closePath()
    }
    chamferRect(J, Q, Z, $, q, K) {
        if (q <= 0)
            return this.rect(J, Q, Z, $);
        let V = Math.min(q, Math.min(Z, $) / 2)
            , z = J + Z
            , W = Q + $
            , H = [J + V, Q, z - V, Q, z, Q + V, z, W - V, z - V, W, J + V, W, J, W - V, J, Q + V];
        for (let Y = H.length - 1; Y >= 2; Y -= 2)
            if (H[Y] === H[Y - 2] && H[Y - 1] === H[Y - 3])
                H.splice(Y - 1, 2);
        return this.poly(H, !0, K)
    }
    ellipse(J, Q, Z, $, q) {
        return this.drawShape(new Aq(J, Q, Z, $), q),
            this
    }
    roundRect(J, Q, Z, $, q, K) {
        return this.drawShape(new Eq(J, Q, Z, $, q), K),
            this
    }
    drawShape(J, Q) {
        return this.endPoly(),
            this.shapePrimitives.push({
                shape: J,
                transform: Q
            }),
            this
    }
    startPoly(J, Q) {
        let Z = this._currentPoly;
        if (Z)
            this.endPoly();
        return Z = new CZ,
            Z.points.push(J, Q),
            this._currentPoly = Z,
            this
    }
    endPoly(J = !1) {
        let Q = this._currentPoly;
        if (Q && Q.points.length > 2)
            Q.closePath = J,
                this.shapePrimitives.push({
                    shape: Q
                });
        return this._currentPoly = null,
            this
    }
    _ensurePoly(J = !0) {
        if (this._currentPoly)
            return;
        if (this._currentPoly = new CZ,
            J) {
            let Q = this.shapePrimitives[this.shapePrimitives.length - 1];
            if (Q) {
                let Z = Q.shape.x
                    , $ = Q.shape.y;
                if (Q.transform && !Q.transform.isIdentity()) {
                    let q = Q.transform
                        , K = Z;
                    Z = q.a * Z + q.c * $ + q.tx,
                        $ = q.b * K + q.d * $ + q.ty
                }
                this._currentPoly.points.push(Z, $)
            } else
                this._currentPoly.points.push(0, 0)
        }
    }
    buildPath() {
        let J = this._graphicsPath2D;
        this.shapePrimitives.length = 0,
            this._currentPoly = null;
        for (let Q = 0; Q < J.instructions.length; Q++) {
            let Z = J.instructions[Q];
            this[Z.action](...Z.data)
        }
        this.finish()
    }
    get bounds() {
        let J = this._bounds;
        J.clear();
        let Q = this.shapePrimitives;
        for (let Z = 0; Z < Q.length; Z++) {
            let $ = Q[Z]
                , q = $.shape.getBounds(mg);
            if ($.transform)
                J.addRect(q, $.transform);
            else
                J.addRect(q)
        }
        return J
    }
}
var mg;
var jN = O(() => {
    JN();
    QN();
    ZN();
    E7();
    qN();
    VJ();
    Fz();
    zN();
    Gz();
    HN();
    XN();
    wN();
    mg = new v8
}
);
class y9 {
    constructor(J, Q = !1) {
        if (this.instructions = [],
            this.uid = i8("graphicsPath"),
            this._dirty = !0,
            this.checkForHoles = Q,
            typeof J === "string")
            tU(J, this);
        else
            this.instructions = J?.slice() ?? []
    }
    get shapePath() {
        if (!this._shapePath)
            this._shapePath = new Dz(this);
        if (this._dirty)
            this._dirty = !1,
                this._shapePath.buildPath();
        return this._shapePath
    }
    addPath(J, Q) {
        return J = J.clone(),
            this.instructions.push({
                action: "addPath",
                data: [J, Q]
            }),
            this._dirty = !0,
            this
    }
    arc(...J) {
        return this.instructions.push({
            action: "arc",
            data: J
        }),
            this._dirty = !0,
            this
    }
    arcTo(...J) {
        return this.instructions.push({
            action: "arcTo",
            data: J
        }),
            this._dirty = !0,
            this
    }
    arcToSvg(...J) {
        return this.instructions.push({
            action: "arcToSvg",
            data: J
        }),
            this._dirty = !0,
            this
    }
    bezierCurveTo(...J) {
        return this.instructions.push({
            action: "bezierCurveTo",
            data: J
        }),
            this._dirty = !0,
            this
    }
    bezierCurveToShort(J, Q, Z, $, q) {
        let K = this.instructions[this.instructions.length - 1]
            , V = this.getLastPoint(z6.shared)
            , z = 0
            , W = 0;
        if (!K || K.action !== "bezierCurveTo")
            z = V.x,
                W = V.y;
        else {
            z = K.data[2],
                W = K.data[3];
            let { x: H, y: Y } = V;
            z = H + (H - z),
                W = Y + (Y - W)
        }
        return this.instructions.push({
            action: "bezierCurveTo",
            data: [z, W, J, Q, Z, $, q]
        }),
            this._dirty = !0,
            this
    }
    closePath() {
        return this.instructions.push({
            action: "closePath",
            data: []
        }),
            this._dirty = !0,
            this
    }
    ellipse(...J) {
        return this.instructions.push({
            action: "ellipse",
            data: J
        }),
            this._dirty = !0,
            this
    }
    lineTo(...J) {
        return this.instructions.push({
            action: "lineTo",
            data: J
        }),
            this._dirty = !0,
            this
    }
    moveTo(...J) {
        return this.instructions.push({
            action: "moveTo",
            data: J
        }),
            this
    }
    quadraticCurveTo(...J) {
        return this.instructions.push({
            action: "quadraticCurveTo",
            data: J
        }),
            this._dirty = !0,
            this
    }
    quadraticCurveToShort(J, Q, Z) {
        let $ = this.instructions[this.instructions.length - 1]
            , q = this.getLastPoint(z6.shared)
            , K = 0
            , V = 0;
        if (!$ || $.action !== "quadraticCurveTo")
            K = q.x,
                V = q.y;
        else {
            K = $.data[0],
                V = $.data[1];
            let { x: z, y: W } = q;
            K = z + (z - K),
                V = W + (W - V)
        }
        return this.instructions.push({
            action: "quadraticCurveTo",
            data: [K, V, J, Q, Z]
        }),
            this._dirty = !0,
            this
    }
    rect(J, Q, Z, $, q) {
        return this.instructions.push({
            action: "rect",
            data: [J, Q, Z, $, q]
        }),
            this._dirty = !0,
            this
    }
    circle(J, Q, Z, $) {
        return this.instructions.push({
            action: "circle",
            data: [J, Q, Z, $]
        }),
            this._dirty = !0,
            this
    }
    roundRect(...J) {
        return this.instructions.push({
            action: "roundRect",
            data: J
        }),
            this._dirty = !0,
            this
    }
    poly(...J) {
        return this.instructions.push({
            action: "poly",
            data: J
        }),
            this._dirty = !0,
            this
    }
    regularPoly(...J) {
        return this.instructions.push({
            action: "regularPoly",
            data: J
        }),
            this._dirty = !0,
            this
    }
    roundPoly(...J) {
        return this.instructions.push({
            action: "roundPoly",
            data: J
        }),
            this._dirty = !0,
            this
    }
    roundShape(...J) {
        return this.instructions.push({
            action: "roundShape",
            data: J
        }),
            this._dirty = !0,
            this
    }
    filletRect(...J) {
        return this.instructions.push({
            action: "filletRect",
            data: J
        }),
            this._dirty = !0,
            this
    }
    chamferRect(...J) {
        return this.instructions.push({
            action: "chamferRect",
            data: J
        }),
            this._dirty = !0,
            this
    }
    star(J, Q, Z, $, q, K, V) {
        q || (q = $ / 2);
        let z = -1 * Math.PI / 2 + K
            , W = Z * 2
            , H = Math.PI * 2 / W
            , Y = [];
        for (let U = 0; U < W; U++) {
            let N = U % 2 ? q : $
                , j = U * H + z;
            Y.push(J + N * Math.cos(j), Q + N * Math.sin(j))
        }
        return this.poly(Y, !0, V),
            this
    }
    clone(J = !1) {
        let Q = new y9;
        if (Q.checkForHoles = this.checkForHoles,
            !J)
            Q.instructions = this.instructions.slice();
        else
            for (let Z = 0; Z < this.instructions.length; Z++) {
                let $ = this.instructions[Z];
                Q.instructions.push({
                    action: $.action,
                    data: $.data.slice()
                })
            }
        return Q
    }
    clear() {
        return this.instructions.length = 0,
            this._dirty = !0,
            this
    }
    transform(J) {
        if (J.isIdentity())
            return this;
        let { a: Q, b: Z, c: $, d: q, tx: K, ty: V } = J
            , z = 0
            , W = 0
            , H = 0
            , Y = 0
            , U = 0
            , N = 0
            , j = 0
            , k = 0;
        for (let L = 0; L < this.instructions.length; L++) {
            let F = this.instructions[L]
                , P = F.data;
            switch (F.action) {
                case "moveTo":
                case "lineTo":
                    z = P[0],
                        W = P[1],
                        P[0] = Q * z + $ * W + K,
                        P[1] = Z * z + q * W + V;
                    break;
                case "bezierCurveTo":
                    H = P[0],
                        Y = P[1],
                        U = P[2],
                        N = P[3],
                        z = P[4],
                        W = P[5],
                        P[0] = Q * H + $ * Y + K,
                        P[1] = Z * H + q * Y + V,
                        P[2] = Q * U + $ * N + K,
                        P[3] = Z * U + q * N + V,
                        P[4] = Q * z + $ * W + K,
                        P[5] = Z * z + q * W + V;
                    break;
                case "quadraticCurveTo":
                    H = P[0],
                        Y = P[1],
                        z = P[2],
                        W = P[3],
                        P[0] = Q * H + $ * Y + K,
                        P[1] = Z * H + q * Y + V,
                        P[2] = Q * z + $ * W + K,
                        P[3] = Z * z + q * W + V;
                    break;
                case "arcToSvg":
                    z = P[5],
                        W = P[6],
                        j = P[0],
                        k = P[1],
                        P[0] = Q * j + $ * k,
                        P[1] = Z * j + q * k,
                        P[5] = Q * z + $ * W + K,
                        P[6] = Z * z + q * W + V;
                    break;
                case "circle":
                    P[4] = Az(P[3], J);
                    break;
                case "rect":
                    P[4] = Az(P[4], J);
                    break;
                case "ellipse":
                    P[8] = Az(P[8], J);
                    break;
                case "roundRect":
                    P[5] = Az(P[5], J);
                    break;
                case "addPath":
                    P[0].transform(J);
                    break;
                case "poly":
                    P[2] = Az(P[2], J);
                    break;
                default:
                    m0("unknown transform action", F.action);
                    break
            }
        }
        return this._dirty = !0,
            this
    }
    get bounds() {
        return this.shapePath.bounds
    }
    getLastPoint(J) {
        let Q = this.instructions.length - 1
            , Z = this.instructions[Q];
        if (!Z)
            return J.x = 0,
                J.y = 0,
                J;
        while (Z.action === "closePath") {
            if (Q--,
                Q < 0)
                return J.x = 0,
                    J.y = 0,
                    J;
            Z = this.instructions[Q]
        }
        switch (Z.action) {
            case "moveTo":
            case "lineTo":
                J.x = Z.data[0],
                    J.y = Z.data[1];
                break;
            case "quadraticCurveTo":
                J.x = Z.data[2],
                    J.y = Z.data[3];
                break;
            case "bezierCurveTo":
                J.x = Z.data[4],
                    J.y = Z.data[5];
                break;
            case "arc":
            case "arcToSvg":
                J.x = Z.data[5],
                    J.y = Z.data[6];
                break;
            case "addPath":
                Z.data[0].getLastPoint(J);
                break
        }
        return J
    }
}
function Az(J, Q) {
    if (J)
        return J.prepend(Q);
    return Q.clone()
}
var Ez = O(() => {
    cJ();
    l7();
    B6();
    eU();
    jN()
}
);
function H7(J, Q, Z) {
    let $ = J.getAttribute(Q);
    return $ ? Number($) : Z
}
var Mz = () => { }
    ;
function BN(J, Q) {
    let Z = J.querySelectorAll("defs");
    for (let $ = 0; $ < Z.length; $++) {
        let q = Z[$];
        for (let K = 0; K < q.children.length; K++) {
            let V = q.children[K];
            switch (V.nodeName.toLowerCase()) {
                case "lineargradient":
                    Q.defs[V.id] = cg(V);
                    break;
                case "radialgradient":
                    Q.defs[V.id] = dg(V);
                    break;
                default:
                    break
            }
        }
    }
}
function cg(J) {
    let Q = H7(J, "x1", 0)
        , Z = H7(J, "y1", 0)
        , $ = H7(J, "x2", 1)
        , q = H7(J, "y2", 0)
        , K = J.getAttribute("gradientUnits") || "objectBoundingBox"
        , V = new MJ(Q, Z, $, q, K === "objectBoundingBox" ? "local" : "global");
    for (let z = 0; z < J.children.length; z++) {
        let W = J.children[z]
            , H = H7(W, "offset", 0)
            , Y = E8.shared.setValue(W.getAttribute("stop-color")).toNumber();
        V.addColorStop(H, Y)
    }
    return V
}
function dg(J) {
    return m0("[SVG Parser] Radial gradients are not yet supported"),
        new MJ(0, 0, 1, 0)
}
var kN = O(() => {
    T7();
    B6();
    jZ();
    Mz()
}
);
function _z(J) {
    let Q = J.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);
    return Q ? Q[1] : ""
}
var CN = () => { }
    ;
function Rz(J, Q) {
    let Z = J.getAttribute("style")
        , $ = {}
        , q = {}
        , K = {
            strokeStyle: $,
            fillStyle: q,
            useFill: !1,
            useStroke: !1
        };
    for (let V in ON) {
        let z = J.getAttribute(V);
        if (z)
            tM(Q, K, V, z.trim())
    }
    if (Z) {
        let V = Z.split(";");
        for (let z = 0; z < V.length; z++) {
            let W = V[z].trim()
                , [H, Y] = W.split(":");
            if (ON[H])
                tM(Q, K, H, Y.trim())
        }
    }
    return {
        strokeStyle: K.useStroke ? $ : null,
        fillStyle: K.useFill ? q : null,
        useFill: K.useFill,
        useStroke: K.useStroke
    }
}
function tM(J, Q, Z, $) {
    switch (Z) {
        case "stroke":
            if ($ !== "none") {
                if ($.startsWith("url(")) {
                    let q = _z($);
                    Q.strokeStyle.fill = J.defs[q]
                } else
                    Q.strokeStyle.color = E8.shared.setValue($).toNumber();
                Q.useStroke = !0
            }
            break;
        case "stroke-width":
            Q.strokeStyle.width = Number($);
            break;
        case "fill":
            if ($ !== "none") {
                if ($.startsWith("url(")) {
                    let q = _z($);
                    Q.fillStyle.fill = J.defs[q]
                } else
                    Q.fillStyle.color = E8.shared.setValue($).toNumber();
                Q.useFill = !0
            }
            break;
        case "fill-opacity":
            Q.fillStyle.alpha = Number($);
            break;
        case "stroke-opacity":
            Q.strokeStyle.alpha = Number($);
            break;
        case "opacity":
            Q.fillStyle.alpha = Number($),
                Q.strokeStyle.alpha = Number($);
            break
    }
}
var ON;
var IN = O(() => {
    T7();
    CN();
    ON = {
        fill: {
            type: "paint",
            default: 0
        },
        "fill-opacity": {
            type: "number",
            default: 1
        },
        stroke: {
            type: "paint",
            default: 0
        },
        "stroke-width": {
            type: "number",
            default: 1
        },
        "stroke-opacity": {
            type: "number",
            default: 1
        },
        "stroke-linecap": {
            type: "string",
            default: "butt"
        },
        "stroke-linejoin": {
            type: "string",
            default: "miter"
        },
        "stroke-miterlimit": {
            type: "number",
            default: 10
        },
        "stroke-dasharray": {
            type: "string",
            default: "none"
        },
        "stroke-dashoffset": {
            type: "number",
            default: 0
        },
        opacity: {
            type: "number",
            default: 1
        }
    }
}
);
function LN(J, Q) {
    if (typeof J === "string") {
        let V = document.createElement("div");
        V.innerHTML = J.trim(),
            J = V.querySelector("svg")
    }
    let Z = {
        context: Q,
        defs: {},
        path: new y9
    };
    BN(J, Z);
    let $ = J.children
        , { fillStyle: q, strokeStyle: K } = Rz(J, Z);
    for (let V = 0; V < $.length; V++) {
        let z = $[V];
        if (z.nodeName.toLowerCase() === "defs")
            continue;
        eM(z, Z, q, K)
    }
    return Q
}
function eM(J, Q, Z, $) {
    let q = J.children
        , { fillStyle: K, strokeStyle: V } = Rz(J, Q);
    if (K && Z)
        Z = {
            ...Z,
            ...K
        };
    else if (K)
        Z = K;
    if (V && $)
        $ = {
            ...$,
            ...V
        };
    else if (V)
        $ = V;
    let z = !Z && !$;
    if (z)
        Z = {
            color: 0
        };
    let W, H, Y, U, N, j, k, L, F, P, M, v, E, n, u, b, i;
    switch (J.nodeName.toLowerCase()) {
        case "path":
            if (n = J.getAttribute("d"),
                J.getAttribute("fill-rule") === "evenodd")
                m0("SVG Evenodd fill rule not supported, your svg may render incorrectly");
            if (u = new y9(n, !0),
                Q.context.path(u),
                Z)
                Q.context.fill(Z);
            if ($)
                Q.context.stroke($);
            break;
        case "circle":
            if (k = H7(J, "cx", 0),
                L = H7(J, "cy", 0),
                F = H7(J, "r", 0),
                Q.context.ellipse(k, L, F, F),
                Z)
                Q.context.fill(Z);
            if ($)
                Q.context.stroke($);
            break;
        case "rect":
            if (W = H7(J, "x", 0),
                H = H7(J, "y", 0),
                b = H7(J, "width", 0),
                i = H7(J, "height", 0),
                P = H7(J, "rx", 0),
                M = H7(J, "ry", 0),
                P || M)
                Q.context.roundRect(W, H, b, i, P || M);
            else
                Q.context.rect(W, H, b, i);
            if (Z)
                Q.context.fill(Z);
            if ($)
                Q.context.stroke($);
            break;
        case "ellipse":
            if (k = H7(J, "cx", 0),
                L = H7(J, "cy", 0),
                P = H7(J, "rx", 0),
                M = H7(J, "ry", 0),
                Q.context.beginPath(),
                Q.context.ellipse(k, L, P, M),
                Z)
                Q.context.fill(Z);
            if ($)
                Q.context.stroke($);
            break;
        case "line":
            if (Y = H7(J, "x1", 0),
                U = H7(J, "y1", 0),
                N = H7(J, "x2", 0),
                j = H7(J, "y2", 0),
                Q.context.beginPath(),
                Q.context.moveTo(Y, U),
                Q.context.lineTo(N, j),
                $)
                Q.context.stroke($);
            break;
        case "polygon":
            if (E = J.getAttribute("points"),
                v = E.match(/\d+/g).map((g) => parseInt(g, 10)),
                Q.context.poly(v, !0),
                Z)
                Q.context.fill(Z);
            if ($)
                Q.context.stroke($);
            break;
        case "polyline":
            if (E = J.getAttribute("points"),
                v = E.match(/\d+/g).map((g) => parseInt(g, 10)),
                Q.context.poly(v, !1),
                $)
                Q.context.stroke($);
            break;
        case "g":
        case "svg":
            break;
        default:
            {
                m0(`[SVG parser] <${J.nodeName}> elements unsupported`);
                break
            }
    }
    if (z)
        Z = null;
    for (let g = 0; g < q.length; g++)
        eM(q[g], Q, Z, $)
}
var FN = O(() => {
    B6();
    Ez();
    kN();
    Mz();
    IN()
}
);
function pg(J) {
    return E8.isColorLike(J)
}
function J_(J) {
    return J instanceof T9
}
function Q_(J) {
    return J instanceof MJ
}
function ug(J) {
    return J instanceof _0
}
function lg(J, Q, Z) {
    let $ = E8.shared.setValue(Q ?? 0);
    return J.color = $.toNumber(),
        J.alpha = $.alpha === 1 ? Z.alpha : $.alpha,
        J.texture = _0.WHITE,
    {
        ...Z,
        ...J
    }
}
function og(J, Q, Z) {
    return J.texture = Q,
    {
        ...Z,
        ...J
    }
}
function Z_(J, Q, Z) {
    return J.fill = Q,
        J.color = 16777215,
        J.texture = Q.texture,
        J.matrix = Q.transform,
    {
        ...Z,
        ...J
    }
}
function $_(J, Q, Z) {
    return Q.buildGradient(),
        J.fill = Q,
        J.color = 16777215,
        J.texture = Q.texture,
        J.matrix = Q.transform,
        J.textureSpace = Q.textureSpace,
    {
        ...Z,
        ...J
    }
}
function ng(J, Q) {
    let Z = {
        ...Q,
        ...J
    }
        , $ = E8.shared.setValue(Z.color);
    return Z.alpha *= $.alpha,
        Z.color = $.toNumber(),
        Z
}
function q9(J, Q) {
    if (J === void 0 || J === null)
        return null;
    let Z = {}
        , $ = J;
    if (pg(J))
        return lg(Z, J, Q);
    else if (ug(J))
        return og(Z, J, Q);
    else if (J_(J))
        return Z_(Z, J, Q);
    else if (Q_(J))
        return $_(Z, J, Q);
    else if ($.fill && J_($.fill))
        return Z_($, $.fill, Q);
    else if ($.fill && Q_($.fill))
        return $_($, $.fill, Q);
    return ng($, Q)
}
function OZ(J, Q) {
    let { width: Z, alignment: $, miterLimit: q, cap: K, join: V, pixelLine: z, ...W } = Q
        , H = q9(J, W);
    if (!H)
        return null;
    return {
        width: Z,
        alignment: $,
        miterLimit: q,
        cap: K,
        join: V,
        pixelLine: z,
        ...H
    }
}
var bz = O(() => {
    T7();
    W6();
    jZ();
    Pq()
}
);
var sg, q_, aF, f7;
var IZ = O(() => {
    wJ();
    T7();
    Z6();
    cJ();
    W6();
    l7();
    O6();
    VJ();
    Ez();
    FN();
    bz();
    sg = new z6,
        q_ = new f0,
        aF = class J extends o6 {
            constructor() {
                super(...arguments);
                this.uid = i8("graphicsContext"),
                    this.dirty = !0,
                    this.batchMode = "auto",
                    this.instructions = [],
                    this._activePath = new y9,
                    this._transform = new f0,
                    this._fillStyle = {
                        ...J.defaultFillStyle
                    },
                    this._strokeStyle = {
                        ...J.defaultStrokeStyle
                    },
                    this._stateStack = [],
                    this._tick = 0,
                    this._bounds = new E6,
                    this._boundsDirty = !0
            }
            clone() {
                let Q = new J;
                return Q.batchMode = this.batchMode,
                    Q.instructions = this.instructions.slice(),
                    Q._activePath = this._activePath.clone(),
                    Q._transform = this._transform.clone(),
                    Q._fillStyle = {
                        ...this._fillStyle
                    },
                    Q._strokeStyle = {
                        ...this._strokeStyle
                    },
                    Q._stateStack = this._stateStack.slice(),
                    Q._bounds = this._bounds.clone(),
                    Q._boundsDirty = !0,
                    Q
            }
            get fillStyle() {
                return this._fillStyle
            }
            set fillStyle(Q) {
                this._fillStyle = q9(Q, J.defaultFillStyle)
            }
            get strokeStyle() {
                return this._strokeStyle
            }
            set strokeStyle(Q) {
                this._strokeStyle = OZ(Q, J.defaultStrokeStyle)
            }
            setFillStyle(Q) {
                return this._fillStyle = q9(Q, J.defaultFillStyle),
                    this
            }
            setStrokeStyle(Q) {
                return this._strokeStyle = q9(Q, J.defaultStrokeStyle),
                    this
            }
            texture(Q, Z, $, q, K, V) {
                return this.instructions.push({
                    action: "texture",
                    data: {
                        image: Q,
                        dx: $ || 0,
                        dy: q || 0,
                        dw: K || Q.frame.width,
                        dh: V || Q.frame.height,
                        transform: this._transform.clone(),
                        alpha: this._fillStyle.alpha,
                        style: Z ? E8.shared.setValue(Z).toNumber() : 16777215
                    }
                }),
                    this.onUpdate(),
                    this
            }
            beginPath() {
                return this._activePath = new y9,
                    this
            }
            fill(Q, Z) {
                let $, q = this.instructions[this.instructions.length - 1];
                if (this._tick === 0 && q && q.action === "stroke")
                    $ = q.data.path;
                else
                    $ = this._activePath.clone();
                if (!$)
                    return this;
                if (Q != null) {
                    if (Z !== void 0 && typeof Q === "number")
                        c0(Y8, "GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),
                            Q = {
                                color: Q,
                                alpha: Z
                            };
                    this._fillStyle = q9(Q, J.defaultFillStyle)
                }
                return this.instructions.push({
                    action: "fill",
                    data: {
                        style: this.fillStyle,
                        path: $
                    }
                }),
                    this.onUpdate(),
                    this._initNextPathLocation(),
                    this._tick = 0,
                    this
            }
            _initNextPathLocation() {
                let { x: Q, y: Z } = this._activePath.getLastPoint(z6.shared);
                this._activePath.clear(),
                    this._activePath.moveTo(Q, Z)
            }
            stroke(Q) {
                let Z, $ = this.instructions[this.instructions.length - 1];
                if (this._tick === 0 && $ && $.action === "fill")
                    Z = $.data.path;
                else
                    Z = this._activePath.clone();
                if (!Z)
                    return this;
                if (Q != null)
                    this._strokeStyle = OZ(Q, J.defaultStrokeStyle);
                return this.instructions.push({
                    action: "stroke",
                    data: {
                        style: this.strokeStyle,
                        path: Z
                    }
                }),
                    this.onUpdate(),
                    this._initNextPathLocation(),
                    this._tick = 0,
                    this
            }
            cut() {
                for (let Q = 0; Q < 2; Q++) {
                    let Z = this.instructions[this.instructions.length - 1 - Q]
                        , $ = this._activePath.clone();
                    if (Z) {
                        if (Z.action === "stroke" || Z.action === "fill")
                            if (Z.data.hole)
                                Z.data.hole.addPath($);
                            else {
                                Z.data.hole = $;
                                break
                            }
                    }
                }
                return this._initNextPathLocation(),
                    this
            }
            arc(Q, Z, $, q, K, V) {
                this._tick++;
                let z = this._transform;
                return this._activePath.arc(z.a * Q + z.c * Z + z.tx, z.b * Q + z.d * Z + z.ty, $, q, K, V),
                    this
            }
            arcTo(Q, Z, $, q, K) {
                this._tick++;
                let V = this._transform;
                return this._activePath.arcTo(V.a * Q + V.c * Z + V.tx, V.b * Q + V.d * Z + V.ty, V.a * $ + V.c * q + V.tx, V.b * $ + V.d * q + V.ty, K),
                    this
            }
            arcToSvg(Q, Z, $, q, K, V, z) {
                this._tick++;
                let W = this._transform;
                return this._activePath.arcToSvg(Q, Z, $, q, K, W.a * V + W.c * z + W.tx, W.b * V + W.d * z + W.ty),
                    this
            }
            bezierCurveTo(Q, Z, $, q, K, V, z) {
                this._tick++;
                let W = this._transform;
                return this._activePath.bezierCurveTo(W.a * Q + W.c * Z + W.tx, W.b * Q + W.d * Z + W.ty, W.a * $ + W.c * q + W.tx, W.b * $ + W.d * q + W.ty, W.a * K + W.c * V + W.tx, W.b * K + W.d * V + W.ty, z),
                    this
            }
            closePath() {
                return this._tick++,
                    this._activePath?.closePath(),
                    this
            }
            ellipse(Q, Z, $, q) {
                return this._tick++,
                    this._activePath.ellipse(Q, Z, $, q, this._transform.clone()),
                    this
            }
            circle(Q, Z, $) {
                return this._tick++,
                    this._activePath.circle(Q, Z, $, this._transform.clone()),
                    this
            }
            path(Q) {
                return this._tick++,
                    this._activePath.addPath(Q, this._transform.clone()),
                    this
            }
            lineTo(Q, Z) {
                this._tick++;
                let $ = this._transform;
                return this._activePath.lineTo($.a * Q + $.c * Z + $.tx, $.b * Q + $.d * Z + $.ty),
                    this
            }
            moveTo(Q, Z) {
                this._tick++;
                let $ = this._transform
                    , q = this._activePath.instructions
                    , K = $.a * Q + $.c * Z + $.tx
                    , V = $.b * Q + $.d * Z + $.ty;
                if (q.length === 1 && q[0].action === "moveTo")
                    return q[0].data[0] = K,
                        q[0].data[1] = V,
                        this;
                return this._activePath.moveTo(K, V),
                    this
            }
            quadraticCurveTo(Q, Z, $, q, K) {
                this._tick++;
                let V = this._transform;
                return this._activePath.quadraticCurveTo(V.a * Q + V.c * Z + V.tx, V.b * Q + V.d * Z + V.ty, V.a * $ + V.c * q + V.tx, V.b * $ + V.d * q + V.ty, K),
                    this
            }
            rect(Q, Z, $, q) {
                return this._tick++,
                    this._activePath.rect(Q, Z, $, q, this._transform.clone()),
                    this
            }
            roundRect(Q, Z, $, q, K) {
                return this._tick++,
                    this._activePath.roundRect(Q, Z, $, q, K, this._transform.clone()),
                    this
            }
            poly(Q, Z) {
                return this._tick++,
                    this._activePath.poly(Q, Z, this._transform.clone()),
                    this
            }
            regularPoly(Q, Z, $, q, K = 0, V) {
                return this._tick++,
                    this._activePath.regularPoly(Q, Z, $, q, K, V),
                    this
            }
            roundPoly(Q, Z, $, q, K, V) {
                return this._tick++,
                    this._activePath.roundPoly(Q, Z, $, q, K, V),
                    this
            }
            roundShape(Q, Z, $, q) {
                return this._tick++,
                    this._activePath.roundShape(Q, Z, $, q),
                    this
            }
            filletRect(Q, Z, $, q, K) {
                return this._tick++,
                    this._activePath.filletRect(Q, Z, $, q, K),
                    this
            }
            chamferRect(Q, Z, $, q, K, V) {
                return this._tick++,
                    this._activePath.chamferRect(Q, Z, $, q, K, V),
                    this
            }
            star(Q, Z, $, q, K = 0, V = 0) {
                return this._tick++,
                    this._activePath.star(Q, Z, $, q, K, V, this._transform.clone()),
                    this
            }
            svg(Q) {
                return this._tick++,
                    LN(Q, this),
                    this
            }
            restore() {
                let Q = this._stateStack.pop();
                if (Q)
                    this._transform = Q.transform,
                        this._fillStyle = Q.fillStyle,
                        this._strokeStyle = Q.strokeStyle;
                return this
            }
            save() {
                return this._stateStack.push({
                    transform: this._transform.clone(),
                    fillStyle: {
                        ...this._fillStyle
                    },
                    strokeStyle: {
                        ...this._strokeStyle
                    }
                }),
                    this
            }
            getTransform() {
                return this._transform
            }
            resetTransform() {
                return this._transform.identity(),
                    this
            }
            rotate(Q) {
                return this._transform.rotate(Q),
                    this
            }
            scale(Q, Z = Q) {
                return this._transform.scale(Q, Z),
                    this
            }
            setTransform(Q, Z, $, q, K, V) {
                if (Q instanceof f0)
                    return this._transform.set(Q.a, Q.b, Q.c, Q.d, Q.tx, Q.ty),
                        this;
                return this._transform.set(Q, Z, $, q, K, V),
                    this
            }
            transform(Q, Z, $, q, K, V) {
                if (Q instanceof f0)
                    return this._transform.append(Q),
                        this;
                return q_.set(Q, Z, $, q, K, V),
                    this._transform.append(q_),
                    this
            }
            translate(Q, Z = Q) {
                return this._transform.translate(Q, Z),
                    this
            }
            clear() {
                return this._activePath.clear(),
                    this.instructions.length = 0,
                    this.resetTransform(),
                    this.onUpdate(),
                    this
            }
            onUpdate() {
                if (this.dirty)
                    return;
                this.emit("update", this, 16),
                    this.dirty = !0,
                    this._boundsDirty = !0
            }
            get bounds() {
                if (!this._boundsDirty)
                    return this._bounds;
                let Q = this._bounds;
                Q.clear();
                for (let Z = 0; Z < this.instructions.length; Z++) {
                    let $ = this.instructions[Z]
                        , q = $.action;
                    if (q === "fill") {
                        let K = $.data;
                        Q.addBounds(K.path.bounds)
                    } else if (q === "texture") {
                        let K = $.data;
                        Q.addFrame(K.dx, K.dy, K.dx + K.dw, K.dy + K.dh, K.transform)
                    }
                    if (q === "stroke") {
                        let K = $.data
                            , V = K.style.alignment
                            , z = K.style.width * (1 - V)
                            , W = K.path.bounds;
                        Q.addFrame(W.minX - z, W.minY - z, W.maxX + z, W.maxY + z)
                    }
                }
                return Q
            }
            containsPoint(Q) {
                if (!this.bounds.containsPoint(Q.x, Q.y))
                    return !1;
                let Z = this.instructions
                    , $ = !1;
                for (let q = 0; q < Z.length; q++) {
                    let K = Z[q]
                        , V = K.data
                        , z = V.path;
                    if (!K.action || !z)
                        continue;
                    let W = V.style
                        , H = z.shapePath.shapePrimitives;
                    for (let Y = 0; Y < H.length; Y++) {
                        let U = H[Y].shape;
                        if (!W || !U)
                            continue;
                        let N = H[Y].transform
                            , j = N ? N.applyInverse(Q, sg) : Q;
                        if (K.action === "fill")
                            $ = U.contains(j.x, j.y);
                        else {
                            let L = W;
                            $ = U.strokeContains(j.x, j.y, L.width, L.alignment)
                        }
                        let k = V.hole;
                        if (k) {
                            let L = k.shapePath?.shapePrimitives;
                            if (L) {
                                for (let F = 0; F < L.length; F++)
                                    if (L[F].shape.contains(j.x, j.y))
                                        $ = !1
                            }
                        }
                        if ($)
                            return !0
                    }
                }
                return $
            }
            destroy(Q = !1) {
                if (this._stateStack.length = 0,
                    this._transform = null,
                    this.emit("destroy", this),
                    this.removeAllListeners(),
                    typeof Q === "boolean" ? Q : Q?.texture) {
                    let $ = typeof Q === "boolean" ? Q : Q?.textureSource;
                    if (this._fillStyle.texture)
                        this._fillStyle.fill && "uid" in this._fillStyle.fill ? this._fillStyle.fill.destroy() : this._fillStyle.texture.destroy($);
                    if (this._strokeStyle.texture)
                        this._strokeStyle.fill && "uid" in this._strokeStyle.fill ? this._strokeStyle.fill.destroy() : this._strokeStyle.texture.destroy($)
                }
                this._fillStyle = null,
                    this._strokeStyle = null,
                    this.instructions = null,
                    this._activePath = null,
                    this._bounds = null,
                    this._stateStack = null,
                    this.customShader = null,
                    this._transform = null
            }
        }
        ;
    aF.defaultFillStyle = {
        color: 16777215,
        alpha: 1,
        texture: _0.WHITE,
        matrix: null,
        fill: null,
        textureSpace: "local"
    };
    aF.defaultStrokeStyle = {
        width: 1,
        color: 16777215,
        alpha: 1,
        alignment: 0.5,
        miterLimit: 10,
        cap: "butt",
        join: "miter",
        texture: _0.WHITE,
        matrix: null,
        fill: null,
        textureSpace: "local",
        pixelLine: !1
    };
    f7 = aF
}
);
function GN(J) {
    let Q = []
        , Z = 0;
    for (let $ = 0; $ < K_.length; $++) {
        let q = `_${K_[$]}`;
        Q[Z++] = J[q]
    }
    return Z = V_(J._fill, Q, Z),
        Z = ag(J._stroke, Q, Z),
        Z = rg(J.dropShadow, Q, Z),
        Z = ig(J.filters, Q, Z),
        Q.join("-")
}
function ig(J, Q, Z) {
    if (!J)
        return Z;
    for (let $ of J)
        Q[Z++] = $.uid;
    return Z
}
function V_(J, Q, Z) {
    if (!J)
        return Z;
    return Q[Z++] = J.color,
        Q[Z++] = J.alpha,
        Q[Z++] = J.fill?.styleKey,
        Z
}
function ag(J, Q, Z) {
    if (!J)
        return Z;
    return Z = V_(J, Q, Z),
        Q[Z++] = J.width,
        Q[Z++] = J.alignment,
        Q[Z++] = J.cap,
        Q[Z++] = J.join,
        Q[Z++] = J.miterLimit,
        Z
}
function rg(J, Q, Z) {
    if (!J)
        return Z;
    return Q[Z++] = J.alpha,
        Q[Z++] = J.angle,
        Q[Z++] = J.blur,
        Q[Z++] = J.distance,
        Q[Z++] = E8.shared.setValue(J.color).toNumber(),
        Z
}
var K_;
var PN = O(() => {
    T7();
    K_ = ["align", "breakWords", "cssOverrides", "fontVariant", "fontWeight", "leading", "letterSpacing", "lineHeight", "padding", "textBaseline", "trim", "whiteSpace", "wordWrap", "wordWrapWidth", "fontFamily", "fontStyle", "fontSize"]
}
);
function tg(J) {
    let Q = J;
    if (typeof Q.dropShadow === "boolean" && Q.dropShadow) {
        let Z = s6.defaultDropShadow;
        J.dropShadow = {
            alpha: Q.dropShadowAlpha ?? Z.alpha,
            angle: Q.dropShadowAngle ?? Z.angle,
            blur: Q.dropShadowBlur ?? Z.blur,
            color: Q.dropShadowColor ?? Z.color,
            distance: Q.dropShadowDistance ?? Z.distance
        }
    }
    if (Q.strokeThickness !== void 0) {
        c0(Y8, "strokeThickness is now a part of stroke");
        let Z = Q.stroke
            , $ = {};
        if (E8.isColorLike(Z))
            $.color = Z;
        else if (Z instanceof MJ || Z instanceof T9)
            $.fill = Z;
        else if (Object.hasOwnProperty.call(Z, "color") || Object.hasOwnProperty.call(Z, "fill"))
            $ = Z;
        else
            throw new Error("Invalid stroke value.");
        J.stroke = {
            ...$,
            width: Q.strokeThickness
        }
    }
    if (Array.isArray(Q.fillGradientStops)) {
        if (c0(Y8, "gradient fill is now a fill pattern: `new FillGradient(...)`"),
            !Array.isArray(Q.fill) || Q.fill.length === 0)
            throw new Error("Invalid fill value. Expected an array of colors for gradient fill.");
        if (Q.fill.length !== Q.fillGradientStops.length)
            m0("The number of fill colors must match the number of fill gradient stops.");
        let Z = new MJ({
            start: {
                x: 0,
                y: 0
            },
            end: {
                x: 0,
                y: 1
            },
            textureSpace: "local"
        })
            , $ = Q.fillGradientStops.slice()
            , q = Q.fill.map((K) => E8.shared.setValue(K).toNumber());
        $.forEach((K, V) => {
            Z.addColorStop(K, q[V])
        }
        ),
            J.fill = {
                fill: Z
            }
    }
}
var rF, s6;
var y5 = O(() => {
    wJ();
    T7();
    O6();
    B6();
    jZ();
    Pq();
    IZ();
    bz();
    PN();
    rF = class J extends o6 {
        constructor(Q = {}) {
            super();
            tg(Q);
            let Z = {
                ...J.defaultTextStyle,
                ...Q
            };
            for (let $ in Z) {
                let q = $;
                this[q] = Z[$]
            }
            this.update()
        }
        get align() {
            return this._align
        }
        set align(Q) {
            this._align = Q,
                this.update()
        }
        get breakWords() {
            return this._breakWords
        }
        set breakWords(Q) {
            this._breakWords = Q,
                this.update()
        }
        get dropShadow() {
            return this._dropShadow
        }
        set dropShadow(Q) {
            if (Q !== null && typeof Q === "object")
                this._dropShadow = this._createProxy({
                    ...J.defaultDropShadow,
                    ...Q
                });
            else
                this._dropShadow = Q ? this._createProxy({
                    ...J.defaultDropShadow
                }) : null;
            this.update()
        }
        get fontFamily() {
            return this._fontFamily
        }
        set fontFamily(Q) {
            this._fontFamily = Q,
                this.update()
        }
        get fontSize() {
            return this._fontSize
        }
        set fontSize(Q) {
            if (typeof Q === "string")
                this._fontSize = parseInt(Q, 10);
            else
                this._fontSize = Q;
            this.update()
        }
        get fontStyle() {
            return this._fontStyle
        }
        set fontStyle(Q) {
            this._fontStyle = Q.toLowerCase(),
                this.update()
        }
        get fontVariant() {
            return this._fontVariant
        }
        set fontVariant(Q) {
            this._fontVariant = Q,
                this.update()
        }
        get fontWeight() {
            return this._fontWeight
        }
        set fontWeight(Q) {
            this._fontWeight = Q,
                this.update()
        }
        get leading() {
            return this._leading
        }
        set leading(Q) {
            this._leading = Q,
                this.update()
        }
        get letterSpacing() {
            return this._letterSpacing
        }
        set letterSpacing(Q) {
            this._letterSpacing = Q,
                this.update()
        }
        get lineHeight() {
            return this._lineHeight
        }
        set lineHeight(Q) {
            this._lineHeight = Q,
                this.update()
        }
        get padding() {
            return this._padding
        }
        set padding(Q) {
            this._padding = Q,
                this.update()
        }
        get filters() {
            return this._filters
        }
        set filters(Q) {
            this._filters = Q,
                this.update()
        }
        get trim() {
            return this._trim
        }
        set trim(Q) {
            this._trim = Q,
                this.update()
        }
        get textBaseline() {
            return this._textBaseline
        }
        set textBaseline(Q) {
            this._textBaseline = Q,
                this.update()
        }
        get whiteSpace() {
            return this._whiteSpace
        }
        set whiteSpace(Q) {
            this._whiteSpace = Q,
                this.update()
        }
        get wordWrap() {
            return this._wordWrap
        }
        set wordWrap(Q) {
            this._wordWrap = Q,
                this.update()
        }
        get wordWrapWidth() {
            return this._wordWrapWidth
        }
        set wordWrapWidth(Q) {
            this._wordWrapWidth = Q,
                this.update()
        }
        get fill() {
            return this._originalFill
        }
        set fill(Q) {
            if (Q === this._originalFill)
                return;
            if (this._originalFill = Q,
                this._isFillStyle(Q))
                this._originalFill = this._createProxy({
                    ...f7.defaultFillStyle,
                    ...Q
                }, () => {
                    this._fill = q9({
                        ...this._originalFill
                    }, f7.defaultFillStyle)
                }
                );
            this._fill = q9(Q === 0 ? "black" : Q, f7.defaultFillStyle),
                this.update()
        }
        get stroke() {
            return this._originalStroke
        }
        set stroke(Q) {
            if (Q === this._originalStroke)
                return;
            if (this._originalStroke = Q,
                this._isFillStyle(Q))
                this._originalStroke = this._createProxy({
                    ...f7.defaultStrokeStyle,
                    ...Q
                }, () => {
                    this._stroke = OZ({
                        ...this._originalStroke
                    }, f7.defaultStrokeStyle)
                }
                );
            this._stroke = OZ(Q, f7.defaultStrokeStyle),
                this.update()
        }
        _generateKey() {
            return this._styleKey = GN(this),
                this._styleKey
        }
        update() {
            this._styleKey = null,
                this.emit("update", this)
        }
        reset() {
            let Q = J.defaultTextStyle;
            for (let Z in Q)
                this[Z] = Q[Z]
        }
        get styleKey() {
            return this._styleKey || this._generateKey()
        }
        clone() {
            return new J({
                align: this.align,
                breakWords: this.breakWords,
                dropShadow: this._dropShadow ? {
                    ...this._dropShadow
                } : null,
                fill: this._fill,
                fontFamily: this.fontFamily,
                fontSize: this.fontSize,
                fontStyle: this.fontStyle,
                fontVariant: this.fontVariant,
                fontWeight: this.fontWeight,
                leading: this.leading,
                letterSpacing: this.letterSpacing,
                lineHeight: this.lineHeight,
                padding: this.padding,
                stroke: this._stroke,
                textBaseline: this.textBaseline,
                whiteSpace: this.whiteSpace,
                wordWrap: this.wordWrap,
                wordWrapWidth: this.wordWrapWidth,
                filters: this._filters ? [...this._filters] : void 0
            })
        }
        _getFinalPadding() {
            let Q = 0;
            if (this._filters)
                for (let Z = 0; Z < this._filters.length; Z++)
                    Q += this._filters[Z].padding;
            return Math.max(this._padding, Q)
        }
        destroy(Q = !1) {
            if (this.removeAllListeners(),
                typeof Q === "boolean" ? Q : Q?.texture) {
                let $ = typeof Q === "boolean" ? Q : Q?.textureSource;
                if (this._fill?.texture)
                    this._fill.texture.destroy($);
                if (this._originalFill?.texture)
                    this._originalFill.texture.destroy($);
                if (this._stroke?.texture)
                    this._stroke.texture.destroy($);
                if (this._originalStroke?.texture)
                    this._originalStroke.texture.destroy($)
            }
            this._fill = null,
                this._stroke = null,
                this.dropShadow = null,
                this._originalStroke = null,
                this._originalFill = null
        }
        _createProxy(Q, Z) {
            return new Proxy(Q, {
                set: ($, q, K) => {
                    return $[q] = K,
                        Z?.(q, K),
                        this.update(),
                        !0
                }
            })
        }
        _isFillStyle(Q) {
            return (Q ?? null) !== null && !(E8.isColorLike(Q) || Q instanceof MJ || Q instanceof T9)
        }
    }
        ;
    rF.defaultDropShadow = {
        alpha: 1,
        angle: Math.PI / 6,
        blur: 0,
        color: "black",
        distance: 5
    };
    rF.defaultTextStyle = {
        align: "left",
        breakWords: !1,
        dropShadow: null,
        fill: "black",
        fontFamily: "Arial",
        fontSize: 26,
        fontStyle: "normal",
        fontVariant: "normal",
        fontWeight: "normal",
        leading: 0,
        letterSpacing: 0,
        lineHeight: 0,
        padding: 0,
        stroke: null,
        textBaseline: "alphabetic",
        trim: !1,
        whiteSpace: "pre",
        wordWrap: !1,
        wordWrapWidth: 100
    };
    s6 = rF
}
);
function bq(J, Q, Z, $) {
    let q = eg;
    q.minX = 0,
        q.minY = 0,
        q.maxX = J.width / $ | 0,
        q.maxY = J.height / $ | 0;
    let K = m6.getOptimalTexture(q.width, q.height, $, !1);
    return K.source.uploadMethodId = "image",
        K.source.resource = J,
        K.source.alphaMode = "premultiply-alpha-on-upload",
        K.frame.width = Q / $,
        K.frame.height = Z / $,
        K.source.emit("update", K.source),
        K.updateUvs(),
        K
}
var eg;
var vz = O(() => {
    E5();
    VJ();
    eg = new E6
}
);
class DN {
    constructor(J) {
        this._canvasPool = Object.create(null),
            this.canvasOptions = J || {},
            this.enableFullScreen = !1
    }
    _createCanvasAndContext(J, Q) {
        let Z = a0.get().createCanvas();
        Z.width = J,
            Z.height = Q;
        let $ = Z.getContext("2d");
        return {
            canvas: Z,
            context: $
        }
    }
    getOptimalCanvasAndContext(J, Q, Z = 1) {
        J = Math.ceil(J * Z - 0.000001),
            Q = Math.ceil(Q * Z - 0.000001),
            J = i5(J),
            Q = i5(Q);
        let $ = (J << 17) + (Q << 1);
        if (!this._canvasPool[$])
            this._canvasPool[$] = [];
        let q = this._canvasPool[$].pop();
        if (!q)
            q = this._createCanvasAndContext(J, Q);
        return q
    }
    returnCanvasAndContext(J) {
        let Q = J.canvas
            , { width: Z, height: $ } = Q
            , q = (Z << 17) + ($ << 1);
        J.context.resetTransform(),
            J.context.clearRect(0, 0, Z, $),
            this._canvasPool[q].push(J)
    }
    clear() {
        this._canvasPool = {}
    }
}
var oJ;
var LZ = O(() => {
    M6();
    $$();
    oJ = new DN
}
);
function Jm(J, Q) {
    if (!M$)
        M$ = a0.get().createCanvas(256, 128),
            GQ = M$.getContext("2d", {
                willReadFrequently: !0
            }),
            GQ.globalCompositeOperation = "copy",
            GQ.globalAlpha = 1;
    if (M$.width < J || M$.height < Q)
        M$.width = i5(J),
            M$.height = i5(Q)
}
function z_(J, Q, Z) {
    for (let $ = 0, q = 4 * Z * Q; $ < Q; ++$,
        q += 4)
        if (J[q + 3] !== 0)
            return !1;
    return !0
}
function W_(J, Q, Z, $, q) {
    let K = 4 * Q;
    for (let V = $, z = $ * K + 4 * Z; V <= q; ++V,
        z += K)
        if (J[z + 3] !== 0)
            return !1;
    return !0
}
function AN(...J) {
    let Q = J[0];
    if (!Q.canvas)
        Q = {
            canvas: J[0],
            resolution: J[1]
        };
    let { canvas: Z } = Q
        , $ = Math.min(Q.resolution ?? 1, 1)
        , q = Q.width ?? Z.width
        , K = Q.height ?? Z.height
        , V = Q.output;
    if (Jm(q, K),
        !GQ)
        throw new TypeError("Failed to get canvas 2D context");
    GQ.drawImage(Z, 0, 0, q, K, 0, 0, q * $, K * $);
    let W = GQ.getImageData(0, 0, q, K).data
        , H = 0
        , Y = 0
        , U = q - 1
        , N = K - 1;
    while (Y < K && z_(W, q, Y))
        ++Y;
    if (Y === K)
        return v8.EMPTY;
    while (z_(W, q, N))
        --N;
    while (W_(W, q, H, Y, N))
        ++H;
    while (W_(W, q, U, Y, N))
        --U;
    return ++U,
        ++N,
        GQ.globalCompositeOperation = "source-over",
        GQ.strokeRect(H, Y, U - H, N - Y),
        GQ.globalCompositeOperation = "copy",
        V ?? (V = new v8),
        V.set(H / $, Y / $, (U - H) / $, (N - Y) / $),
        V
}
var M$ = null
    , GQ = null;
var EN = O(() => {
    M6();
    $$();
    E7()
}
);
function PQ(J) {
    let Q = typeof J.fontSize === "number" ? `${J.fontSize}px` : J.fontSize
        , Z = J.fontFamily;
    if (!Array.isArray(J.fontFamily))
        Z = J.fontFamily.split(",");
    for (let $ = Z.length - 1; $ >= 0; $--) {
        let q = Z[$].trim();
        if (!/([\"\'])[^\'\"]+\1/.test(q) && !Qm.includes(q))
            q = `"${q}"`;
        Z[$] = q
    }
    return `${J.fontStyle} ${J.fontVariant} ${J.fontWeight} ${Q} ${Z.join(",")}`
}
var Qm;
var vq = O(() => {
    Qm = ["serif", "sans-serif", "monospace", "cursive", "fantasy", "system-ui"]
}
);
var tF, f9 = class J {
    static get experimentalLetterSpacingSupported() {
        let Q = J._experimentalLetterSpacingSupported;
        if (Q === void 0) {
            let Z = a0.get().getCanvasRenderingContext2D().prototype;
            Q = J._experimentalLetterSpacingSupported = "letterSpacing" in Z || "textLetterSpacing" in Z
        }
        return Q
    }
    constructor(Q, Z, $, q, K, V, z, W, H) {
        this.text = Q,
            this.style = Z,
            this.width = $,
            this.height = q,
            this.lines = K,
            this.lineWidths = V,
            this.lineHeight = z,
            this.maxLineWidth = W,
            this.fontProperties = H
    }
    static measureText(Q = " ", Z, $ = J._canvas, q = Z.wordWrap) {
        let K = PQ(Z)
            , V = J.measureFont(K);
        if (V.fontSize === 0)
            V.fontSize = Z.fontSize,
                V.ascent = Z.fontSize;
        let z = J.__context;
        z.font = K;
        let H = (q ? J._wordWrap(Q, Z, $) : Q).split(/(?:\r\n|\r|\n)/)
            , Y = new Array(H.length)
            , U = 0;
        for (let P = 0; P < H.length; P++) {
            let M = J._measureText(H[P], Z.letterSpacing, z);
            Y[P] = M,
                U = Math.max(U, M)
        }
        let N = Z._stroke?.width || 0
            , j = U + N;
        if (Z.dropShadow)
            j += Z.dropShadow.distance;
        let k = Z.lineHeight || V.fontSize
            , L = Math.max(k, V.fontSize + N) + (H.length - 1) * (k + Z.leading);
        if (Z.dropShadow)
            L += Z.dropShadow.distance;
        return new J(Q, Z, j, L, H, Y, k + Z.leading, U, V)
    }
    static _measureText(Q, Z, $) {
        let q = !1;
        if (J.experimentalLetterSpacingSupported)
            if (J.experimentalLetterSpacing)
                $.letterSpacing = `${Z}px`,
                    $.textLetterSpacing = `${Z}px`,
                    q = !0;
            else
                $.letterSpacing = "0px",
                    $.textLetterSpacing = "0px";
        let K = $.measureText(Q)
            , V = K.width
            , z = -K.actualBoundingBoxLeft
            , H = K.actualBoundingBoxRight - z;
        if (V > 0)
            if (q)
                V -= Z,
                    H -= Z;
            else {
                let Y = (J.graphemeSegmenter(Q).length - 1) * Z;
                V += Y,
                    H += Y
            }
        return Math.max(V, H)
    }
    static _wordWrap(Q, Z, $ = J._canvas) {
        let q = $.getContext("2d", tF)
            , K = 0
            , V = ""
            , z = ""
            , W = Object.create(null)
            , { letterSpacing: H, whiteSpace: Y } = Z
            , U = J._collapseSpaces(Y)
            , N = J._collapseNewlines(Y)
            , j = !U
            , k = Z.wordWrapWidth + H
            , L = J._tokenize(Q);
        for (let F = 0; F < L.length; F++) {
            let P = L[F];
            if (J._isNewline(P)) {
                if (!N) {
                    z += J._addLine(V),
                        j = !U,
                        V = "",
                        K = 0;
                    continue
                }
                P = " "
            }
            if (U) {
                let v = J.isBreakingSpace(P)
                    , E = J.isBreakingSpace(V[V.length - 1]);
                if (v && E)
                    continue
            }
            let M = J._getFromCache(P, H, W, q);
            if (M > k) {
                if (V !== "")
                    z += J._addLine(V),
                        V = "",
                        K = 0;
                if (J.canBreakWords(P, Z.breakWords)) {
                    let v = J.wordWrapSplit(P);
                    for (let E = 0; E < v.length; E++) {
                        let n = v[E]
                            , u = n
                            , b = 1;
                        while (v[E + b]) {
                            let g = v[E + b];
                            if (!J.canBreakChars(u, g, P, E, Z.breakWords))
                                n += g;
                            else
                                break;
                            u = g,
                                b++
                        }
                        E += b - 1;
                        let i = J._getFromCache(n, H, W, q);
                        if (i + K > k)
                            z += J._addLine(V),
                                j = !1,
                                V = "",
                                K = 0;
                        V += n,
                            K += i
                    }
                } else {
                    if (V.length > 0)
                        z += J._addLine(V),
                            V = "",
                            K = 0;
                    let v = F === L.length - 1;
                    z += J._addLine(P, !v),
                        j = !1,
                        V = "",
                        K = 0
                }
            } else {
                if (M + K > k)
                    j = !1,
                        z += J._addLine(V),
                        V = "",
                        K = 0;
                if (V.length > 0 || !J.isBreakingSpace(P) || j)
                    V += P,
                        K += M
            }
        }
        return z += J._addLine(V, !1),
            z
    }
    static _addLine(Q, Z = !0) {
        return Q = J._trimRight(Q),
            Q = Z ? `${Q}
` : Q,
            Q
    }
    static _getFromCache(Q, Z, $, q) {
        let K = $[Q];
        if (typeof K !== "number")
            K = J._measureText(Q, Z, q) + Z,
                $[Q] = K;
        return K
    }
    static _collapseSpaces(Q) {
        return Q === "normal" || Q === "pre-line"
    }
    static _collapseNewlines(Q) {
        return Q === "normal"
    }
    static _trimRight(Q) {
        if (typeof Q !== "string")
            return "";
        for (let Z = Q.length - 1; Z >= 0; Z--) {
            let $ = Q[Z];
            if (!J.isBreakingSpace($))
                break;
            Q = Q.slice(0, -1)
        }
        return Q
    }
    static _isNewline(Q) {
        if (typeof Q !== "string")
            return !1;
        return J._newlines.includes(Q.charCodeAt(0))
    }
    static isBreakingSpace(Q, Z) {
        if (typeof Q !== "string")
            return !1;
        return J._breakingSpaces.includes(Q.charCodeAt(0))
    }
    static _tokenize(Q) {
        let Z = []
            , $ = "";
        if (typeof Q !== "string")
            return Z;
        for (let q = 0; q < Q.length; q++) {
            let K = Q[q]
                , V = Q[q + 1];
            if (J.isBreakingSpace(K, V) || J._isNewline(K)) {
                if ($ !== "")
                    Z.push($),
                        $ = "";
                if (K === "\r" && V === `
`)
                    Z.push(`\r
`),
                        q++;
                else
                    Z.push(K);
                continue
            }
            $ += K
        }
        if ($ !== "")
            Z.push($);
        return Z
    }
    static canBreakWords(Q, Z) {
        return Z
    }
    static canBreakChars(Q, Z, $, q, K) {
        return !0
    }
    static wordWrapSplit(Q) {
        return J.graphemeSegmenter(Q)
    }
    static measureFont(Q) {
        if (J._fonts[Q])
            return J._fonts[Q];
        let Z = J._context;
        Z.font = Q;
        let $ = Z.measureText(J.METRICS_STRING + J.BASELINE_SYMBOL)
            , q = {
                ascent: $.actualBoundingBoxAscent,
                descent: $.actualBoundingBoxDescent,
                fontSize: $.actualBoundingBoxAscent + $.actualBoundingBoxDescent
            };
        return J._fonts[Q] = q,
            q
    }
    static clearMetrics(Q = "") {
        if (Q)
            delete J._fonts[Q];
        else
            J._fonts = {}
    }
    static get _canvas() {
        if (!J.__canvas) {
            let Q;
            try {
                let Z = new OffscreenCanvas(0, 0);
                if (Z.getContext("2d", tF)?.measureText)
                    return J.__canvas = Z,
                        Z;
                Q = a0.get().createCanvas()
            } catch (Z) {
                Q = a0.get().createCanvas()
            }
            Q.width = Q.height = 10,
                J.__canvas = Q
        }
        return J.__canvas
    }
    static get _context() {
        if (!J.__context)
            J.__context = J._canvas.getContext("2d", tF);
        return J.__context
    }
}
    , C7;
var h9 = O(() => {
    M6();
    vq();
    tF = {
        willReadFrequently: !0
    };
    f9.METRICS_STRING = "|ÉqÅ";
    f9.BASELINE_SYMBOL = "M";
    f9.BASELINE_MULTIPLIER = 1.4;
    f9.HEIGHT_MULTIPLIER = 2;
    f9.graphemeSegmenter = (() => {
        if (typeof Intl?.Segmenter === "function") {
            let J = new Intl.Segmenter;
            return (Q) => {
                let Z = J.segment(Q)
                    , $ = []
                    , q = 0;
                for (let K of Z)
                    $[q++] = K.segment;
                return $
            }
        }
        return (J) => [...J]
    }
    )();
    f9.experimentalLetterSpacing = !1;
    f9._fonts = {};
    f9._newlines = [10, 13];
    f9._breakingSpaces = [9, 32, 8192, 8193, 8194, 8195, 8196, 8197, 8198, 8200, 8201, 8202, 8287, 12288];
    C7 = f9
}
);
function FZ(J, Q, Z, $ = 0) {
    if (J.texture === _0.WHITE && !J.fill)
        return E8.shared.setValue(J.color).setAlpha(J.alpha ?? 1).toHexa();
    else if (!J.fill) {
        let q = Q.createPattern(J.texture.source.resource, "repeat")
            , K = J.matrix.copyTo(f0.shared);
        return K.scale(J.texture.frame.width, J.texture.frame.height),
            q.setTransform(K),
            q
    } else if (J.fill instanceof T9) {
        let q = J.fill
            , K = Q.createPattern(q.texture.source.resource, "repeat")
            , V = q.transform.copyTo(f0.shared);
        return V.scale(q.texture.frame.width, q.texture.frame.height),
            K.setTransform(V),
            K
    } else if (J.fill instanceof MJ) {
        let q = J.fill
            , K = q.type === "linear"
            , V = q.textureSpace === "local"
            , z = 1
            , W = 1;
        if (V && Z)
            z = Z.width + $,
                W = Z.height + $;
        let H, Y = !1;
        if (K) {
            let { start: U, end: N } = q;
            H = Q.createLinearGradient(U.x * z, U.y * W, N.x * z, N.y * W),
                Y = Math.abs(N.x - U.x) < Math.abs((N.y - U.y) * 0.1)
        } else {
            let { center: U, innerRadius: N, outerCenter: j, outerRadius: k } = q;
            H = Q.createRadialGradient(U.x * z, U.y * W, N * z, j.x * z, j.y * W, k * z)
        }
        if (Y && V && Z) {
            let U = Z.lineHeight / W;
            for (let N = 0; N < Z.lines.length; N++) {
                let j = (N * Z.lineHeight + $ / 2) / W;
                q.colorStops.forEach((k) => {
                    let L = j + k.offset * U;
                    H.addColorStop(Math.floor(L * H_) / H_, E8.shared.setValue(k.color).toHex())
                }
                )
            }
        } else
            q.colorStops.forEach((U) => {
                H.addColorStop(U.offset, E8.shared.setValue(U.color).toHex())
            }
            );
        return H
    }
    return m0("FillStyle not recognised", J),
        "red"
}
var H_ = 1e5;
var Sz = O(() => {
    T7();
    Z6();
    W6();
    B6();
    jZ();
    Pq()
}
);
class X_ {
    getCanvasAndContext(J) {
        let { text: Q, style: Z, resolution: $ = 1 } = J
            , q = Z._getFinalPadding()
            , K = C7.measureText(Q || " ", Z)
            , V = Math.ceil(Math.ceil(Math.max(1, K.width) + q * 2) * $)
            , z = Math.ceil(Math.ceil(Math.max(1, K.height) + q * 2) * $)
            , W = oJ.getOptimalCanvasAndContext(V, z);
        this._renderTextToCanvas(Q, Z, q, $, W);
        let H = Z.trim ? AN({
            canvas: W.canvas,
            width: V,
            height: z,
            resolution: 1,
            output: Y_
        }) : Y_.set(0, 0, V, z);
        return {
            canvasAndContext: W,
            frame: H
        }
    }
    returnCanvasAndContext(J) {
        oJ.returnCanvasAndContext(J)
    }
    _renderTextToCanvas(J, Q, Z, $, q) {
        let { canvas: K, context: V } = q
            , z = PQ(Q)
            , W = C7.measureText(J || " ", Q)
            , H = W.lines
            , Y = W.lineHeight
            , U = W.lineWidths
            , N = W.maxLineWidth
            , j = W.fontProperties
            , k = K.height;
        if (V.resetTransform(),
            V.scale($, $),
            V.textBaseline = Q.textBaseline,
            Q._stroke?.width) {
            let M = Q._stroke;
            V.lineWidth = M.width,
                V.miterLimit = M.miterLimit,
                V.lineJoin = M.join,
                V.lineCap = M.cap
        }
        V.font = z;
        let L, F, P = Q.dropShadow ? 2 : 1;
        for (let M = 0; M < P; ++M) {
            let v = Q.dropShadow && M === 0
                , E = v ? Math.ceil(Math.max(1, k) + Z * 2) : 0
                , n = E * $;
            if (v) {
                V.fillStyle = "black",
                    V.strokeStyle = "black";
                let i = Q.dropShadow
                    , g = i.color
                    , l = i.alpha;
                V.shadowColor = E8.shared.setValue(g).setAlpha(l).toRgbaString();
                let o = i.blur * $
                    , F0 = i.distance * $;
                V.shadowBlur = o,
                    V.shadowOffsetX = Math.cos(i.angle) * F0,
                    V.shadowOffsetY = Math.sin(i.angle) * F0 + n
            } else {
                if (V.fillStyle = Q._fill ? FZ(Q._fill, V, W, Z * 2) : null,
                    Q._stroke?.width) {
                    let i = Q._stroke.width * 0.5 + Z * 2;
                    V.strokeStyle = FZ(Q._stroke, V, W, i)
                }
                V.shadowColor = "black"
            }
            let u = (Y - j.fontSize) / 2;
            if (Y - j.fontSize < 0)
                u = 0;
            let b = Q._stroke?.width ?? 0;
            for (let i = 0; i < H.length; i++) {
                if (L = b / 2,
                    F = b / 2 + i * Y + j.ascent + u,
                    Q.align === "right")
                    L += N - U[i];
                else if (Q.align === "center")
                    L += (N - U[i]) / 2;
                if (Q._stroke?.width)
                    this._drawLetterSpacing(H[i], Q, q, L + Z, F + Z - E, !0);
                if (Q._fill !== void 0)
                    this._drawLetterSpacing(H[i], Q, q, L + Z, F + Z - E)
            }
        }
    }
    _drawLetterSpacing(J, Q, Z, $, q, K = !1) {
        let { context: V } = Z
            , z = Q.letterSpacing
            , W = !1;
        if (C7.experimentalLetterSpacingSupported)
            if (C7.experimentalLetterSpacing)
                V.letterSpacing = `${z}px`,
                    V.textLetterSpacing = `${z}px`,
                    W = !0;
            else
                V.letterSpacing = "0px",
                    V.textLetterSpacing = "0px";
        if (z === 0 || W) {
            if (K)
                V.strokeText(J, $, q);
            else
                V.fillText(J, $, q);
            return
        }
        let H = $
            , Y = C7.graphemeSegmenter(J)
            , U = V.measureText(J).width
            , N = 0;
        for (let j = 0; j < Y.length; ++j) {
            let k = Y[j];
            if (K)
                V.strokeText(k, H, q);
            else
                V.fillText(k, H, q);
            let L = "";
            for (let F = j + 1; F < Y.length; ++F)
                L += Y[F];
            N = V.measureText(L).width,
                H += U - N + z,
                U = N
        }
    }
}
var Y_, DQ;
var Tz = O(() => {
    T7();
    E7();
    LZ();
    EN();
    h9();
    vq();
    Sz();
    Y_ = new v8;
    DQ = new X_
}
);
class Sq {
    constructor(J) {
        this._renderer = J
    }
    getTexture(J, Q, Z, $) {
        if (typeof J === "string")
            c0("8.0.0", "CanvasTextSystem.getTexture: Use object TextOptions instead of separate arguments"),
                J = {
                    text: J,
                    style: Z,
                    resolution: Q
                };
        if (!(J.style instanceof s6))
            J.style = new s6(J.style);
        if (!(J.textureStyle instanceof o7))
            J.textureStyle = new o7(J.textureStyle);
        if (typeof J.text !== "string")
            J.text = J.text.toString();
        let { text: q, style: K, textureStyle: V } = J
            , z = J.resolution ?? this._renderer.resolution
            , { frame: W, canvasAndContext: H } = DQ.getCanvasAndContext({
                text: q,
                style: K,
                resolution: z
            })
            , Y = bq(H.canvas, W.width, W.height, z);
        if (V)
            Y.source.style = V;
        if (K.trim)
            W.pad(K.padding),
                Y.frame.copyFrom(W),
                Y.frame.scale(1 / z),
                Y.updateUvs();
        if (K.filters) {
            let U = this._applyFilters(Y, K.filters);
            return this.returnTexture(Y),
                DQ.returnCanvasAndContext(H),
                U
        }
        return this._renderer.texture.initSource(Y._source),
            DQ.returnCanvasAndContext(H),
            Y
    }
    returnTexture(J) {
        let Q = J.source;
        Q.resource = null,
            Q.uploadMethodId = "unknown",
            Q.alphaMode = "no-premultiply-alpha",
            m6.returnTexture(J, !0)
    }
    renderTextToCanvas() {
        c0("8.10.0", "CanvasTextSystem.renderTextToCanvas: no longer supported, use CanvasTextSystem.getTexture instead")
    }
    _applyFilters(J, Q) {
        let Z = this._renderer.renderTarget.renderTarget
            , $ = this._renderer.filter.generateFilteredTexture({
                texture: J,
                filters: Q
            });
        return this._renderer.renderTarget.bind(Z, !1),
            $
    }
    destroy() {
        this._renderer = null
    }
}
var MN = O(() => {
    w0();
    E5();
    A9();
    O6();
    y5();
    vz();
    Tz();
    Sq.extension = {
        type: [R.WebGLSystem, R.WebGPUSystem, R.CanvasSystem],
        name: "canvasText"
    }
}
);
var eF = O(() => {
    w0();
    rU();
    MN();
    e0.add(Sq);
    e0.add(Gq)
}
);
var w6;
var yz = O(() => {
    O6();
    _5();
    IZ();
    w6 = class w6 extends JJ {
        constructor(J) {
            if (J instanceof f7)
                J = {
                    context: J
                };
            let { context: Q, roundPixels: Z, ...$ } = J || {};
            super({
                label: "Graphics",
                ...$
            });
            if (this.renderPipeId = "graphics",
                !Q)
                this._context = this._ownedContext = new f7;
            else
                this._context = Q;
            this._context.on("update", this.onViewUpdate, this),
                this.didViewUpdate = !0,
                this.allowChildren = !1,
                this.roundPixels = Z ?? !1
        }
        set context(J) {
            if (J === this._context)
                return;
            this._context.off("update", this.onViewUpdate, this),
                this._context = J,
                this._context.on("update", this.onViewUpdate, this),
                this.onViewUpdate()
        }
        get context() {
            return this._context
        }
        get bounds() {
            return this._context.bounds
        }
        updateBounds() { }
        containsPoint(J) {
            return this._context.containsPoint(J)
        }
        destroy(J) {
            if (this._ownedContext && !J)
                this._ownedContext.destroy(J);
            else if (J === !0 || J?.context === !0)
                this._context.destroy(J);
            this._ownedContext = null,
                this._context = null,
                super.destroy(J)
        }
        _callContextMethod(J, Q) {
            return this.context[J](...Q),
                this
        }
        setFillStyle(...J) {
            return this._callContextMethod("setFillStyle", J)
        }
        setStrokeStyle(...J) {
            return this._callContextMethod("setStrokeStyle", J)
        }
        fill(...J) {
            return this._callContextMethod("fill", J)
        }
        stroke(...J) {
            return this._callContextMethod("stroke", J)
        }
        texture(...J) {
            return this._callContextMethod("texture", J)
        }
        beginPath() {
            return this._callContextMethod("beginPath", [])
        }
        cut() {
            return this._callContextMethod("cut", [])
        }
        arc(...J) {
            return this._callContextMethod("arc", J)
        }
        arcTo(...J) {
            return this._callContextMethod("arcTo", J)
        }
        arcToSvg(...J) {
            return this._callContextMethod("arcToSvg", J)
        }
        bezierCurveTo(...J) {
            return this._callContextMethod("bezierCurveTo", J)
        }
        closePath() {
            return this._callContextMethod("closePath", [])
        }
        ellipse(...J) {
            return this._callContextMethod("ellipse", J)
        }
        circle(...J) {
            return this._callContextMethod("circle", J)
        }
        path(...J) {
            return this._callContextMethod("path", J)
        }
        lineTo(...J) {
            return this._callContextMethod("lineTo", J)
        }
        moveTo(...J) {
            return this._callContextMethod("moveTo", J)
        }
        quadraticCurveTo(...J) {
            return this._callContextMethod("quadraticCurveTo", J)
        }
        rect(...J) {
            return this._callContextMethod("rect", J)
        }
        roundRect(...J) {
            return this._callContextMethod("roundRect", J)
        }
        poly(...J) {
            return this._callContextMethod("poly", J)
        }
        regularPoly(...J) {
            return this._callContextMethod("regularPoly", J)
        }
        roundPoly(...J) {
            return this._callContextMethod("roundPoly", J)
        }
        roundShape(...J) {
            return this._callContextMethod("roundShape", J)
        }
        filletRect(...J) {
            return this._callContextMethod("filletRect", J)
        }
        chamferRect(...J) {
            return this._callContextMethod("chamferRect", J)
        }
        star(...J) {
            return this._callContextMethod("star", J)
        }
        svg(...J) {
            return this._callContextMethod("svg", J)
        }
        restore(...J) {
            return this._callContextMethod("restore", J)
        }
        save() {
            return this._callContextMethod("save", [])
        }
        getTransform() {
            return this.context.getTransform()
        }
        resetTransform() {
            return this._callContextMethod("resetTransform", [])
        }
        rotateTransform(...J) {
            return this._callContextMethod("rotate", J)
        }
        scaleTransform(...J) {
            return this._callContextMethod("scale", J)
        }
        setTransform(...J) {
            return this._callContextMethod("setTransform", J)
        }
        transform(...J) {
            return this._callContextMethod("transform", J)
        }
        translateTransform(...J) {
            return this._callContextMethod("translate", J)
        }
        clear() {
            return this._callContextMethod("clear", [])
        }
        get fillStyle() {
            return this._context.fillStyle
        }
        set fillStyle(J) {
            this._context.fillStyle = J
        }
        get strokeStyle() {
            return this._context.strokeStyle
        }
        set strokeStyle(J) {
            this._context.strokeStyle = J
        }
        clone(J = !1) {
            if (J)
                return new w6(this._context.clone());
            return this._ownedContext = null,
                new w6(this._context)
        }
        lineStyle(J, Q, Z) {
            c0(Y8, "Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");
            let $ = {};
            return J && ($.width = J),
                Q && ($.color = Q),
                Z && ($.alpha = Z),
                this.context.strokeStyle = $,
                this
        }
        beginFill(J, Q) {
            c0(Y8, "Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");
            let Z = {};
            if (J !== void 0)
                Z.color = J;
            if (Q !== void 0)
                Z.alpha = Q;
            return this.context.fillStyle = Z,
                this
        }
        endFill() {
            c0(Y8, "Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),
                this.context.fill();
            let J = this.context.strokeStyle;
            if (J.width !== f7.defaultStrokeStyle.width || J.color !== f7.defaultStrokeStyle.color || J.alpha !== f7.defaultStrokeStyle.alpha)
                this.context.stroke();
            return this
        }
        drawCircle(...J) {
            return c0(Y8, "Graphics#drawCircle has been renamed to Graphics#circle"),
                this._callContextMethod("circle", J)
        }
        drawEllipse(...J) {
            return c0(Y8, "Graphics#drawEllipse has been renamed to Graphics#ellipse"),
                this._callContextMethod("ellipse", J)
        }
        drawPolygon(...J) {
            return c0(Y8, "Graphics#drawPolygon has been renamed to Graphics#poly"),
                this._callContextMethod("poly", J)
        }
        drawRect(...J) {
            return c0(Y8, "Graphics#drawRect has been renamed to Graphics#rect"),
                this._callContextMethod("rect", J)
        }
        drawRoundedRect(...J) {
            return c0(Y8, "Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),
                this._callContextMethod("roundRect", J)
        }
        drawStar(...J) {
            return c0(Y8, "Graphics#drawStar has been renamed to Graphics#star"),
                this._callContextMethod("star", J)
        }
    }
}
);
var _N, RN;
var bN = O(() => {
    _N = {
        name: "local-uniform-msdf-bit",
        vertex: {
            header: `
            struct LocalUniforms {
                uColor:vec4<f32>,
                uTransformMatrix:mat3x3<f32>,
                uDistance: f32,
                uRound:f32,
            }

            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;
        `,
            main: `
            vColor *= localUniforms.uColor;
            modelMatrix *= localUniforms.uTransformMatrix;
        `,
            end: `
            if(localUniforms.uRound == 1)
            {
                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
            }
        `
        },
        fragment: {
            header: `
            struct LocalUniforms {
                uColor:vec4<f32>,
                uTransformMatrix:mat3x3<f32>,
                uDistance: f32
            }

            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;
         `,
            main: `
            outColor = vec4<f32>(calculateMSDFAlpha(outColor, localUniforms.uColor, localUniforms.uDistance));
        `
        }
    },
        RN = {
            name: "local-uniform-msdf-bit",
            vertex: {
                header: `
            uniform mat3 uTransformMatrix;
            uniform vec4 uColor;
            uniform float uRound;
        `,
                main: `
            vColor *= uColor;
            modelMatrix *= uTransformMatrix;
        `,
                end: `
            if(uRound == 1.)
            {
                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
            }
        `
            },
            fragment: {
                header: `
            uniform float uDistance;
         `,
                main: `
            outColor = vec4(calculateMSDFAlpha(outColor, vColor, uDistance));
        `
            }
        }
}
);
var vN, SN;
var TN = O(() => {
    vN = {
        name: "msdf-bit",
        fragment: {
            header: `
            fn calculateMSDFAlpha(msdfColor:vec4<f32>, shapeColor:vec4<f32>, distance:f32) -> f32 {

                // MSDF
                var median = msdfColor.r + msdfColor.g + msdfColor.b -
                    min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -
                    max(msdfColor.r, max(msdfColor.g, msdfColor.b));

                // SDF
                median = min(median, msdfColor.a);

                var screenPxDistance = distance * (median - 0.5);
                var alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);
                if (median < 0.01) {
                    alpha = 0.0;
                } else if (median > 0.99) {
                    alpha = 1.0;
                }

                // Gamma correction for coverage-like alpha
                var luma: f32 = dot(shapeColor.rgb, vec3<f32>(0.299, 0.587, 0.114));
                var gamma: f32 = mix(1.0, 1.0 / 2.2, luma);
                var coverage: f32 = pow(shapeColor.a * alpha, gamma);

                return coverage;

            }
        `
        }
    },
        SN = {
            name: "msdf-bit",
            fragment: {
                header: `
            float calculateMSDFAlpha(vec4 msdfColor, vec4 shapeColor, float distance) {

                // MSDF
                float median = msdfColor.r + msdfColor.g + msdfColor.b -
                                min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -
                                max(msdfColor.r, max(msdfColor.g, msdfColor.b));

                // SDF
                median = min(median, msdfColor.a);

                float screenPxDistance = distance * (median - 0.5);
                float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);

                if (median < 0.01) {
                    alpha = 0.0;
                } else if (median > 0.99) {
                    alpha = 1.0;
                }

                // Gamma correction for coverage-like alpha
                float luma = dot(shapeColor.rgb, vec3(0.299, 0.587, 0.114));
                float gamma = mix(1.0, 1.0 / 2.2, luma);
                float coverage = pow(shapeColor.a * alpha, gamma);

                return coverage;
            }
        `
            }
        }
}
);
var JG, QG, fz;
var yN = O(() => {
    Z6();
    v9();
    O$();
    I$();
    S9();
    Uq();
    k5();
    _7();
    bN();
    TN();
    fz = class fz extends k7 {
        constructor(J) {
            let Q = new Y6({
                uColor: {
                    value: new Float32Array([1, 1, 1, 1]),
                    type: "vec4<f32>"
                },
                uTransformMatrix: {
                    value: new f0,
                    type: "mat3x3<f32>"
                },
                uDistance: {
                    value: 4,
                    type: "f32"
                },
                uRound: {
                    value: 0,
                    type: "f32"
                }
            });
            JG ?? (JG = R5({
                name: "sdf-shader",
                bits: [WZ, YZ(J), _N, vN, v5]
            })),
                QG ?? (QG = b5({
                    name: "sdf-shader",
                    bits: [HZ, XZ(J), RN, SN, S5]
                }));
            super({
                glProgram: QG,
                gpuProgram: JG,
                resources: {
                    localUniforms: Q,
                    batchSamplers: UZ(J)
                }
            })
        }
    }
}
);
var _$;
var hz = O(() => {
    wJ();
    O6();
    _$ = class _$ extends o6 {
        constructor() {
            super(...arguments);
            this.chars = Object.create(null),
                this.lineHeight = 0,
                this.fontFamily = "",
                this.fontMetrics = {
                    fontSize: 0,
                    ascent: 0,
                    descent: 0
                },
                this.baseLineOffset = 0,
                this.distanceField = {
                    type: "none",
                    range: 0
                },
                this.pages = [],
                this.applyFillAsTint = !0,
                this.baseMeasurementFontSize = 100,
                this.baseRenderedFontSize = 100
        }
        get font() {
            return c0(Y8, "BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),
                this.fontFamily
        }
        get pageTextures() {
            return c0(Y8, "BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),
                this.pages
        }
        get size() {
            return c0(Y8, "BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),
                this.fontMetrics.fontSize
        }
        get distanceFieldRange() {
            return c0(Y8, "BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),
                this.distanceField.range
        }
        get distanceFieldType() {
            return c0(Y8, "BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),
                this.distanceField.type
        }
        destroy(J = !1) {
            this.emit("destroy", this),
                this.removeAllListeners();
            for (let Q in this.chars)
                this.chars[Q].texture?.destroy();
            if (this.chars = null,
                J)
                this.pages.forEach((Q) => Q.texture.destroy(!0)),
                    this.pages = null
        }
    }
}
);
var U_, xz;
var fN = O(() => {
    T7();
    E7();
    LZ();
    qZ();
    W6();
    A9();
    O6();
    h9();
    vq();
    Sz();
    y5();
    hz();
    U_ = class J extends _$ {
        constructor(Q) {
            super();
            this.resolution = 1,
                this.pages = [],
                this._padding = 0,
                this._measureCache = Object.create(null),
                this._currentChars = [],
                this._currentX = 0,
                this._currentY = 0,
                this._currentMaxCharHeight = 0,
                this._currentPageIndex = -1,
                this._skipKerning = !1;
            let Z = {
                ...J.defaultOptions,
                ...Q
            };
            this._textureSize = Z.textureSize,
                this._mipmap = Z.mipmap;
            let $ = Z.style.clone();
            if (Z.overrideFill)
                $._fill.color = 16777215,
                    $._fill.alpha = 1,
                    $._fill.texture = _0.WHITE,
                    $._fill.fill = null;
            this.applyFillAsTint = Z.overrideFill;
            let q = $.fontSize;
            $.fontSize = this.baseMeasurementFontSize;
            let K = PQ($);
            if (Z.overrideSize) {
                if ($._stroke)
                    $._stroke.width *= this.baseRenderedFontSize / q
            } else
                $.fontSize = this.baseRenderedFontSize = q;
            if (this._style = $,
                this._skipKerning = Z.skipKerning ?? !1,
                this.resolution = Z.resolution ?? 1,
                this._padding = Z.padding ?? 4,
                Z.textureStyle)
                this._textureStyle = Z.textureStyle instanceof o7 ? Z.textureStyle : new o7(Z.textureStyle);
            this.fontMetrics = C7.measureFont(K),
                this.lineHeight = $.lineHeight || this.fontMetrics.fontSize || $.fontSize
        }
        ensureCharacters(Q) {
            let Z = C7.graphemeSegmenter(Q).filter((F) => !this._currentChars.includes(F)).filter((F, P, M) => M.indexOf(F) === P);
            if (!Z.length)
                return;
            this._currentChars = [...this._currentChars, ...Z];
            let $;
            if (this._currentPageIndex === -1)
                $ = this._nextPage();
            else
                $ = this.pages[this._currentPageIndex];
            let { canvas: q, context: K } = $.canvasAndContext
                , V = $.texture.source
                , z = this._style
                , W = this._currentX
                , H = this._currentY
                , Y = this._currentMaxCharHeight
                , U = this.baseRenderedFontSize / this.baseMeasurementFontSize
                , N = this._padding * U
                , j = !1
                , k = q.width / this.resolution
                , L = q.height / this.resolution;
            for (let F = 0; F < Z.length; F++) {
                let P = Z[F]
                    , M = C7.measureText(P, z, q, !1);
                M.lineHeight = M.height;
                let v = M.width * U
                    , E = Math.ceil((z.fontStyle === "italic" ? 2 : 1) * v)
                    , n = M.height * U
                    , u = E + N * 2
                    , b = n + N * 2;
                if (j = !1,
                    P !== `
` && P !== "\r" && P !== "\t" && P !== " ")
                    j = !0,
                        Y = Math.ceil(Math.max(b, Y));
                if (W + u > k) {
                    if (H += Y,
                        Y = b,
                        W = 0,
                        H + Y > L) {
                        V.update();
                        let g = this._nextPage();
                        q = g.canvasAndContext.canvas,
                            K = g.canvasAndContext.context,
                            V = g.texture.source,
                            W = 0,
                            H = 0,
                            Y = 0
                    }
                }
                let i = v / U - (z.dropShadow?.distance ?? 0) - (z._stroke?.width ?? 0);
                if (this.chars[P] = {
                    id: P.codePointAt(0),
                    xOffset: -this._padding,
                    yOffset: -this._padding,
                    xAdvance: i,
                    kerning: {}
                },
                    j) {
                    this._drawGlyph(K, M, W + N, H + N, U, z);
                    let g = V.width * U
                        , l = V.height * U
                        , o = new v8(W / g * V.width, H / l * V.height, u / g * V.width, b / l * V.height);
                    this.chars[P].texture = new _0({
                        source: V,
                        frame: o
                    }),
                        W += Math.ceil(u)
                }
            }
            V.update(),
                this._currentX = W,
                this._currentY = H,
                this._currentMaxCharHeight = Y,
                this._skipKerning && this._applyKerning(Z, K)
        }
        get pageTextures() {
            return c0(Y8, "BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),
                this.pages
        }
        _applyKerning(Q, Z) {
            let $ = this._measureCache;
            for (let q = 0; q < Q.length; q++) {
                let K = Q[q];
                for (let V = 0; V < this._currentChars.length; V++) {
                    let z = this._currentChars[V]
                        , W = $[K];
                    if (!W)
                        W = $[K] = Z.measureText(K).width;
                    let H = $[z];
                    if (!H)
                        H = $[z] = Z.measureText(z).width;
                    let Y = Z.measureText(K + z).width
                        , U = Y - (W + H);
                    if (U)
                        this.chars[K].kerning[z] = U;
                    if (Y = Z.measureText(K + z).width,
                        U = Y - (W + H),
                        U)
                        this.chars[z].kerning[K] = U
                }
            }
        }
        _nextPage() {
            this._currentPageIndex++;
            let Q = this.resolution
                , Z = oJ.getOptimalCanvasAndContext(this._textureSize, this._textureSize, Q);
            this._setupContext(Z.context, this._style, Q);
            let $ = Q * (this.baseRenderedFontSize / this.baseMeasurementFontSize)
                , q = new _0({
                    source: new pJ({
                        resource: Z.canvas,
                        resolution: $,
                        alphaMode: "premultiply-alpha-on-upload",
                        autoGenerateMipmaps: this._mipmap
                    })
                });
            if (this._textureStyle)
                q.source.style = this._textureStyle;
            let K = {
                canvasAndContext: Z,
                texture: q
            };
            return this.pages[this._currentPageIndex] = K,
                K
        }
        _setupContext(Q, Z, $) {
            Z.fontSize = this.baseRenderedFontSize,
                Q.scale($, $),
                Q.font = PQ(Z),
                Z.fontSize = this.baseMeasurementFontSize,
                Q.textBaseline = Z.textBaseline;
            let q = Z._stroke
                , K = q?.width ?? 0;
            if (q)
                Q.lineWidth = K,
                    Q.lineJoin = q.join,
                    Q.miterLimit = q.miterLimit,
                    Q.strokeStyle = FZ(q, Q);
            if (Z._fill)
                Q.fillStyle = FZ(Z._fill, Q);
            if (Z.dropShadow) {
                let V = Z.dropShadow
                    , z = E8.shared.setValue(V.color).toArray()
                    , W = V.blur * $
                    , H = V.distance * $;
                Q.shadowColor = `rgba(${z[0] * 255},${z[1] * 255},${z[2] * 255},${V.alpha})`,
                    Q.shadowBlur = W,
                    Q.shadowOffsetX = Math.cos(V.angle) * H,
                    Q.shadowOffsetY = Math.sin(V.angle) * H
            } else
                Q.shadowColor = "black",
                    Q.shadowBlur = 0,
                    Q.shadowOffsetX = 0,
                    Q.shadowOffsetY = 0
        }
        _drawGlyph(Q, Z, $, q, K, V) {
            let { text: z, fontProperties: W } = Z
                , Y = (V._stroke?.width ?? 0) * K
                , U = $ + Y / 2
                , N = q - Y / 2
                , j = W.descent * K
                , k = Z.lineHeight * K
                , L = !1;
            if (V.stroke && Y)
                L = !0,
                    Q.strokeText(z, U, N + k - j);
            let { shadowBlur: F, shadowOffsetX: P, shadowOffsetY: M } = Q;
            if (V._fill) {
                if (L)
                    Q.shadowBlur = 0,
                        Q.shadowOffsetX = 0,
                        Q.shadowOffsetY = 0;
                Q.fillText(z, U, N + k - j)
            }
            if (L)
                Q.shadowBlur = F,
                    Q.shadowOffsetX = P,
                    Q.shadowOffsetY = M
        }
        destroy() {
            super.destroy();
            for (let Q = 0; Q < this.pages.length; Q++) {
                let { canvasAndContext: Z, texture: $ } = this.pages[Q];
                oJ.returnCanvasAndContext(Z),
                    $.destroy(!0)
            }
            this.pages = null
        }
    }
        ;
    U_.defaultOptions = {
        textureSize: 512,
        style: new s6,
        mipmap: !0
    };
    xz = U_
}
);
function GZ(J, Q, Z, $) {
    let q = {
        width: 0,
        height: 0,
        offsetY: 0,
        scale: Q.fontSize / Z.baseMeasurementFontSize,
        lines: [{
            width: 0,
            charPositions: [],
            spaceWidth: 0,
            spacesIndex: [],
            chars: []
        }]
    };
    q.offsetY = Z.baseLineOffset;
    let K = q.lines[0]
        , V = null
        , z = !0
        , W = {
            spaceWord: !1,
            width: 0,
            start: 0,
            index: 0,
            positions: [],
            chars: []
        }
        , H = (F) => {
            let P = K.width;
            for (let M = 0; M < W.index; M++) {
                let v = F.positions[M];
                K.chars.push(F.chars[M]),
                    K.charPositions.push(v + P)
            }
            K.width += F.width,
                z = !1,
                W.width = 0,
                W.index = 0,
                W.chars.length = 0
        }
        , Y = () => {
            let F = K.chars.length - 1;
            if ($) {
                let P = K.chars[F];
                while (P === " ")
                    K.width -= Z.chars[P].xAdvance,
                        P = K.chars[--F]
            }
            q.width = Math.max(q.width, K.width),
                K = {
                    width: 0,
                    charPositions: [],
                    chars: [],
                    spaceWidth: 0,
                    spacesIndex: []
                },
                z = !0,
                q.lines.push(K),
                q.height += Z.lineHeight
        }
        , U = Z.baseMeasurementFontSize / Q.fontSize
        , N = Q.letterSpacing * U
        , j = Q.wordWrapWidth * U
        , k = Q.wordWrap && Q.breakWords
        , L = (F) => F - N > j;
    for (let F = 0; F < J.length + 1; F++) {
        let P, M = F === J.length;
        if (!M)
            P = J[F];
        let v = Z.chars[P] || Z.chars[" "];
        if (/(?:\s)/.test(P) || P === "\r" || P === `
` || M) {
            if (!z && Q.wordWrap && L(K.width + W.width)) {
                if (Y(),
                    H(W),
                    !M)
                    K.charPositions.push(0)
            } else if (W.start = K.width,
                H(W),
                !M)
                K.charPositions.push(0);
            if (P === "\r" || P === `
`) {
                if (K.width !== 0)
                    Y()
            } else if (!M) {
                let b = v.xAdvance + (v.kerning[V] || 0) + N;
                K.width += b,
                    K.spaceWidth = b,
                    K.spacesIndex.push(K.charPositions.length),
                    K.chars.push(P)
            }
        } else {
            let u = v.kerning[V] || 0
                , b = v.xAdvance + u + N;
            if (k && L(K.width + W.width + b))
                H(W),
                    Y();
            W.positions[W.index++] = W.width + u,
                W.chars.push(P),
                W.width += b
        }
        V = P
    }
    if (Y(),
        Q.align === "center")
        Zm(q);
    else if (Q.align === "right")
        $m(q);
    else if (Q.align === "justify")
        qm(q);
    return q
}
function Zm(J) {
    for (let Q = 0; Q < J.lines.length; Q++) {
        let Z = J.lines[Q]
            , $ = J.width / 2 - Z.width / 2;
        for (let q = 0; q < Z.charPositions.length; q++)
            Z.charPositions[q] += $
    }
}
function $m(J) {
    for (let Q = 0; Q < J.lines.length; Q++) {
        let Z = J.lines[Q]
            , $ = J.width - Z.width;
        for (let q = 0; q < Z.charPositions.length; q++)
            Z.charPositions[q] += $
    }
}
function qm(J) {
    let Q = J.width;
    for (let Z = 0; Z < J.lines.length; Z++) {
        let $ = J.lines[Z]
            , q = 0
            , K = $.spacesIndex[q++]
            , V = 0
            , z = $.spacesIndex.length
            , H = (Q - $.width) / z;
        for (let Y = 0; Y < $.charPositions.length; Y++) {
            if (Y === K)
                K = $.spacesIndex[q++],
                    V += H;
            $.charPositions[Y] += V
        }
    }
}
var Tq = () => { }
    ;
function hN(J) {
    if (J === "")
        return [];
    if (typeof J === "string")
        J = [J];
    let Q = [];
    for (let Z = 0, $ = J.length; Z < $; Z++) {
        let q = J[Z];
        if (Array.isArray(q)) {
            if (q.length !== 2)
                throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${q.length}.`);
            if (q[0].length === 0 || q[1].length === 0)
                throw new Error("[BitmapFont]: Invalid character delimiter.");
            let K = q[0].charCodeAt(0)
                , V = q[1].charCodeAt(0);
            if (V < K)
                throw new Error("[BitmapFont]: Invalid character range.");
            for (let z = K, W = V; z <= W; z++)
                Q.push(String.fromCharCode(z))
        } else
            Q.push(...Array.from(q))
    }
    if (Q.length === 0)
        throw new Error("[BitmapFont]: Empty set when resolving characters.");
    return Q
}
var xN = () => { }
    ;
class N_ {
    constructor() {
        this.ALPHA = [["a", "z"], ["A", "Z"], " "],
            this.NUMERIC = [["0", "9"]],
            this.ALPHANUMERIC = [["a", "z"], ["A", "Z"], ["0", "9"], " "],
            this.ASCII = [[" ", "~"]],
            this.defaultOptions = {
                chars: this.ALPHANUMERIC,
                resolution: 1,
                padding: 4,
                skipKerning: !1,
                textureStyle: null
            }
    }
    getFont(J, Q) {
        let Z = `${Q.fontFamily}-bitmap`
            , $ = !0;
        if (Q._fill.fill && !Q._stroke)
            Z += Q._fill.fill.styleKey,
                $ = !1;
        else if (Q._stroke || Q.dropShadow) {
            let K = Q.styleKey;
            K = K.substring(0, K.lastIndexOf("-")),
                Z = `${K}-bitmap`,
                $ = !1
        }
        if (!H6.has(Z)) {
            let K = new xz({
                style: Q,
                overrideFill: $,
                overrideSize: !0,
                ...this.defaultOptions
            });
            if (gN++,
                gN > 50)
                m0("BitmapText", `You have dynamically created ${gN} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``);
            K.once("destroy", () => {
                gN--,
                    H6.remove(Z)
            }
            ),
                H6.set(Z, K)
        }
        let q = H6.get(Z);
        return q.ensureCharacters?.(J),
            q
    }
    getLayout(J, Q, Z = !0) {
        let $ = this.getFont(J, Q)
            , q = C7.graphemeSegmenter(J);
        return GZ(q, Q, $, Z)
    }
    measureText(J, Q, Z = !0) {
        return this.getLayout(J, Q, Z)
    }
    install(...J) {
        let Q = J[0];
        if (typeof Q === "string")
            Q = {
                name: Q,
                style: J[1],
                chars: J[2]?.chars,
                resolution: J[2]?.resolution,
                padding: J[2]?.padding,
                skipKerning: J[2]?.skipKerning
            },
                c0(Y8, "BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})");
        let Z = Q?.name;
        if (!Z)
            throw new Error("[BitmapFontManager] Property `name` is required.");
        Q = {
            ...this.defaultOptions,
            ...Q
        };
        let $ = Q.style
            , q = $ instanceof s6 ? $ : new s6($)
            , K = Q.dynamicFill ?? this._canUseTintForStyle(q)
            , V = new xz({
                style: q,
                overrideFill: K,
                skipKerning: Q.skipKerning,
                padding: Q.padding,
                resolution: Q.resolution,
                overrideSize: !1,
                textureStyle: Q.textureStyle
            })
            , z = hN(Q.chars);
        return V.ensureCharacters(z.join("")),
            H6.set(`${Z}-bitmap`, V),
            V.once("destroy", () => H6.remove(`${Z}-bitmap`)),
            V
    }
    uninstall(J) {
        let Q = `${J}-bitmap`
            , Z = H6.get(Q);
        if (Z)
            Z.destroy()
    }
    _canUseTintForStyle(J) {
        return !J._stroke && (!J.dropShadow || J.dropShadow.color === 0) && !J._fill.fill && J._fill.color === 16777215
    }
}
var gN = 0, K9;
var R$ = O(() => {
    t5();
    O6();
    B6();
    h9();
    y5();
    fN();
    Tq();
    xN();
    K9 = new N_
}
);
class yq {
    constructor(J) {
        this._renderer = J,
            this._renderer.renderableGC.addManagedHash(this, "_gpuBitmapText")
    }
    validateRenderable(J) {
        let Q = this._getGpuBitmapText(J);
        return this._renderer.renderPipes.graphics.validateRenderable(Q)
    }
    addRenderable(J, Q) {
        let Z = this._getGpuBitmapText(J);
        if (w_(J, Z),
            J._didTextUpdate)
            J._didTextUpdate = !1,
                this._updateContext(J, Z);
        if (this._renderer.renderPipes.graphics.addRenderable(Z, Q),
            Z.context.customShader)
            this._updateDistanceField(J)
    }
    updateRenderable(J) {
        let Q = this._getGpuBitmapText(J);
        if (w_(J, Q),
            this._renderer.renderPipes.graphics.updateRenderable(Q),
            Q.context.customShader)
            this._updateDistanceField(J)
    }
    _updateContext(J, Q) {
        let { context: Z } = Q
            , $ = K9.getFont(J.text, J._style);
        if (Z.clear(),
            $.distanceField.type !== "none") {
            if (!Z.customShader)
                Z.customShader = new fz(this._renderer.limits.maxBatchableTextures)
        }
        let q = C7.graphemeSegmenter(J.text)
            , K = J._style
            , V = $.baseLineOffset
            , z = GZ(q, K, $, !0)
            , W = K.padding
            , H = z.scale
            , Y = z.width
            , U = z.height + z.offsetY;
        if (K._stroke)
            Y += K._stroke.width / H,
                U += K._stroke.width / H;
        Z.translate(-J._anchor._x * Y - W, -J._anchor._y * U - W).scale(H, H);
        let N = $.applyFillAsTint ? K._fill.color : 16777215;
        for (let j = 0; j < z.lines.length; j++) {
            let k = z.lines[j];
            for (let L = 0; L < k.charPositions.length; L++) {
                let F = k.chars[L]
                    , P = $.chars[F];
                if (P?.texture) {
                    let M = P.texture;
                    Z.texture(M, N ? N : "black", Math.round(k.charPositions[L] + P.xOffset), Math.round(V + P.yOffset), M.orig.width, M.orig.height)
                }
            }
            V += $.lineHeight
        }
    }
    _getGpuBitmapText(J) {
        return J._gpuData[this._renderer.uid] || this.initGpuText(J)
    }
    initGpuText(J) {
        let Q = new mN;
        return J._gpuData[this._renderer.uid] = Q,
            this._updateContext(J, Q),
            Q
    }
    _updateDistanceField(J) {
        let Q = this._getGpuBitmapText(J).context
            , Z = J._style.fontFamily
            , $ = H6.get(`${Z}-bitmap`)
            , { a: q, b: K, c: V, d: z } = J.groupTransform
            , W = Math.sqrt(q * q + K * K)
            , H = Math.sqrt(V * V + z * z)
            , Y = (Math.abs(W) + Math.abs(H)) / 2
            , U = $.baseRenderedFontSize / J._style.fontSize
            , N = Y * $.distanceField.range * (1 / U);
        Q.customShader.resources.localUniforms.uniforms.uDistance = N
    }
    destroy() {
        this._renderer = null
    }
}
function w_(J, Q) {
    Q.groupTransform = J.groupTransform,
        Q.groupColorAlpha = J.groupColorAlpha,
        Q.groupColor = J.groupColor,
        Q.groupBlendMode = J.groupBlendMode,
        Q.globalDisplayStatus = J.globalDisplayStatus,
        Q.groupTransform = J.groupTransform,
        Q.localDisplayStatus = J.localDisplayStatus,
        Q.groupAlpha = J.groupAlpha,
        Q._roundPixels = J._roundPixels
}
var mN;
var cN = O(() => {
    t5();
    w0();
    yz();
    h9();
    yN();
    R$();
    Tq();
    mN = class mN extends w6 {
        destroy() {
            if (this.context.customShader)
                this.context.customShader.destroy();
            super.destroy()
        }
    }
        ;
    yq.extension = {
        type: [R.WebGLPipes, R.WebGPUPipes, R.CanvasPipes],
        name: "bitmapText"
    }
}
);
var ZG = O(() => {
    w0();
    cN();
    e0.add(yq)
}
);
var gz;
var dN = O(() => {
    A$();
    gz = class gz extends $9 {
        constructor(J) {
            super();
            this.generatingTexture = !1,
                this._renderer = J,
                J.runners.resolutionChange.add(this)
        }
        resolutionChange() {
            let J = this.renderable;
            if (J._autoResolution)
                J.onViewUpdate()
        }
        destroy() {
            this._renderer.htmlText.returnTexturePromise(this.texturePromise),
                this.texturePromise = null,
                this._renderer = null
        }
    }
}
);
class fq {
    constructor(J) {
        this._renderer = J
    }
    validateRenderable(J) {
        return J._didTextUpdate
    }
    addRenderable(J, Q) {
        let Z = this._getGpuText(J);
        if (J._didTextUpdate)
            this._updateGpuText(J).catch(($) => { }
            ),
                J._didTextUpdate = !1,
                D$(Z, J);
        this._renderer.renderPipes.batch.addToBatch(Z, Q)
    }
    updateRenderable(J) {
        let Q = this._getGpuText(J);
        Q._batcher.updateElement(Q)
    }
    async _updateGpuText(J) {
        J._didTextUpdate = !1;
        let Q = this._getGpuText(J);
        if (Q.generatingTexture)
            return;
        if (Q.texturePromise)
            this._renderer.htmlText.returnTexturePromise(Q.texturePromise),
                Q.texturePromise = null;
        Q.generatingTexture = !0,
            J._resolution = J._autoResolution ? this._renderer.resolution : J.resolution;
        let Z = this._renderer.htmlText.getTexturePromise(J);
        Q.texturePromise = Z,
            Q.texture = await Z;
        let $ = J.renderGroup || J.parentRenderGroup;
        if ($)
            $.structureDidChange = !0;
        Q.generatingTexture = !1,
            D$(Q, J)
    }
    _getGpuText(J) {
        return J._gpuData[this._renderer.uid] || this.initGpuText(J)
    }
    initGpuText(J) {
        let Q = new gz(this._renderer);
        return Q.renderable = J,
            Q.transform = J.groupTransform,
            Q.texture = _0.EMPTY,
            Q.bounds = {
                minX: 0,
                maxX: 1,
                minY: 0,
                maxY: 0
            },
            Q.roundPixels = this._renderer._roundPixels | J._roundPixels,
            J._resolution = J._autoResolution ? this._renderer.resolution : J.resolution,
            J._gpuData[this._renderer.uid] = Q,
            Q
    }
    destroy() {
        this._renderer = null
    }
}
var pN = O(() => {
    w0();
    W6();
    Cz();
    dN();
    fq.extension = {
        type: [R.WebGLPipes, R.WebGPUPipes, R.CanvasPipes],
        name: "htmlText"
    }
}
);
function uN() {
    let { userAgent: J } = a0.get().getNavigator();
    return /^((?!chrome|android).)*safari/i.test(J)
}
var lN = O(() => {
    M6()
}
);
class b$ {
    constructor() {
        this.svgRoot = document.createElementNS(j_, "svg"),
            this.foreignObject = document.createElementNS(j_, "foreignObject"),
            this.domElement = document.createElementNS(B_, "div"),
            this.styleElement = document.createElementNS(B_, "style");
        let { foreignObject: J, svgRoot: Q, styleElement: Z, domElement: $ } = this;
        J.setAttribute("width", "10000"),
            J.setAttribute("height", "10000"),
            J.style.overflow = "hidden",
            Q.appendChild(J),
            J.appendChild(Z),
            J.appendChild($),
            this.image = a0.get().createImage()
    }
}
var j_ = "http://www.w3.org/2000/svg"
    , B_ = "http://www.w3.org/1999/xhtml";
var mz = O(() => {
    M6()
}
);
function oN(J, Q) {
    let Z = Q.fontFamily
        , $ = []
        , q = {}
        , K = /font-family:([^;"\s]+)/g
        , V = J.match(K);
    function z(W) {
        if (!q[W])
            $.push(W),
                q[W] = !0
    }
    if (Array.isArray(Z))
        for (let W = 0; W < Z.length; W++)
            z(Z[W]);
    else
        z(Z);
    if (V)
        V.forEach((W) => {
            let H = W.split(":")[1].trim();
            z(H)
        }
        );
    for (let W in Q.tagStyles) {
        let H = Q.tagStyles[W].fontFamily;
        z(H)
    }
    return $
}
var nN = () => { }
    ;
async function sN(J) {
    let Z = await (await a0.get().fetch(J).catch((e) => console.log(e))).blob()
        , $ = new FileReader;
    return await new Promise((K, V) => {
        $.onloadend = () => K($.result),
            $.onerror = V,
            $.readAsDataURL(Z)
    }
    )
}
var iN = O(() => {
    M6()
}
);
async function aN(J, Q) {
    let Z = await sN(Q);
    return `@font-face {
        font-family: "${J.fontFamily}";
        font-weight: ${J.fontWeight};
        font-style: ${J.fontStyle};
        src: url('${Z}');
    }`
}
var rN = O(() => {
    iN()
}
);
async function tN(J) {
    let Q = J.filter((Z) => H6.has(`${Z}-and-url`)).map((Z) => {
        if (!cz.has(Z)) {
            let { entries: $ } = H6.get(`${Z}-and-url`)
                , q = [];
            $.forEach((K) => {
                let V = K.url
                    , W = K.faces.map((H) => ({
                        weight: H.weight,
                        style: H.style
                    }));
                q.push(...W.map((H) => aN({
                    fontWeight: H.weight,
                    fontStyle: H.style,
                    fontFamily: Z
                }, V)))
            }
            ),
                cz.set(Z, Promise.all(q).then((K) => K.join(`
`)))
        }
        return cz.get(Z)
    }
    );
    return (await Promise.all(Q)).join(`
`)
}
var cz;
var eN = O(() => {
    t5();
    rN();
    cz = new Map
}
);
function Jw(J, Q, Z, $, q) {
    let { domElement: K, styleElement: V, svgRoot: z } = q;
    K.innerHTML = `<style>${Q.cssStyle}</style><div style='padding:0;'>${J}</div>`,
        K.setAttribute("style", `transform: scale(${Z});transform-origin: top left; display: inline-block`),
        V.textContent = $;
    let { width: W, height: H } = q.image;
    return z.setAttribute("width", W.toString()),
        z.setAttribute("height", H.toString()),
        new XMLSerializer().serializeToString(z)
}
var Qw = () => { }
    ;
function Zw(J, Q) {
    let Z = oJ.getOptimalCanvasAndContext(J.width, J.height, Q)
        , { context: $ } = Z;
    return $.clearRect(0, 0, J.width, J.height),
        $.drawImage(J, 0, 0),
        Z
}
var $w = O(() => {
    LZ()
}
);
function qw(J, Q, Z) {
    return new Promise(async ($) => {
        if (Z)
            await new Promise((q) => setTimeout(q, 100));
        J.onload = () => {
            $()
        }
            ,
            J.src = `data:image/svg+xml;charset=utf8,${encodeURIComponent(Q)}`,
            J.crossOrigin = "anonymous"
    }
    )
}
var Kw = () => { }
    ;
function hq(J, Q, Z, $) {
    $ || ($ = k_ || (k_ = new b$));
    let { domElement: q, styleElement: K, svgRoot: V } = $;
    if (q.innerHTML = `<style>${Q.cssStyle};</style><div style='padding:0'>${J}</div>`,
        q.setAttribute("style", "transform-origin: top left; display: inline-block"),
        Z)
        K.textContent = Z;
    document.body.appendChild(V);
    let z = q.getBoundingClientRect();
    V.remove();
    let W = Q.padding * 2;
    return {
        width: z.width - W,
        height: z.height - W
    }
}
var k_;
var dz = O(() => {
    mz()
}
);
class xq {
    constructor(J) {
        this._renderer = J,
            this._createCanvas = J.type === W7.WEBGPU
    }
    getTexture(J) {
        return this.getTexturePromise(J)
    }
    getTexturePromise(J) {
        return this._buildTexturePromise(J)
    }
    async _buildTexturePromise(J) {
        let { text: Q, style: Z, resolution: $, textureStyle: q } = J
            , K = V7.get(b$)
            , V = oN(Q, Z)
            , z = await tN(V)
            , W = hq(Q, Z, z, K)
            , H = Math.ceil(Math.ceil(Math.max(1, W.width) + Z.padding * 2) * $)
            , Y = Math.ceil(Math.ceil(Math.max(1, W.height) + Z.padding * 2) * $)
            , U = K.image
            , N = 2;
        U.width = (H | 0) + 2,
            U.height = (Y | 0) + 2;
        let j = Jw(Q, Z, $, z, K);
        await qw(U, j, uN() && V.length > 0);
        let k = U, L;
        if (this._createCanvas)
            L = Zw(U, $);
        let F = bq(L ? L.canvas : k, U.width - 2, U.height - 2, $);
        if (q)
            F.source.style = q;
        if (this._createCanvas)
            this._renderer.texture.initSource(F.source),
                oJ.returnCanvasAndContext(L);
        return V7.return(K),
            F
    }
    returnTexturePromise(J) {
        J.then((Q) => {
            this._cleanUp(Q)
        }
        ).catch(() => {
            m0("HTMLTextSystem: Failed to clean texture")
        }
        )
    }
    _cleanUp(J) {
        m6.returnTexture(J, !0),
            J.source.resource = null,
            J.source.uploadMethodId = "unknown"
    }
    destroy() {
        this._renderer = null
    }
}
var Vw = O(() => {
    w0();
    LZ();
    E5();
    $5();
    lN();
    B6();
    s5();
    vz();
    mz();
    nN();
    eN();
    Qw();
    $w();
    Kw();
    dz();
    xq.extension = {
        type: [R.WebGLSystem, R.WebGPUSystem, R.CanvasSystem],
        name: "htmlText"
    }
}
);
var $G = O(() => {
    w0();
    pN();
    Vw();
    e0.add(xq);
    e0.add(fq)
}
);
var C_, C5;
var AQ = O(() => {
    b9();
    Q9();
    IQ();
    O6();
    C_ = class J extends uJ {
        constructor(...Q) {
            let Z = Q[0] ?? {};
            if (Z instanceof Float32Array)
                c0(Y8, "use new MeshGeometry({ positions, uvs, indices }) instead"),
                    Z = {
                        positions: Z,
                        uvs: Q[1],
                        indices: Q[2]
                    };
            Z = {
                ...J.defaultOptions,
                ...Z
            };
            let $ = Z.positions || new Float32Array([0, 0, 1, 0, 1, 1, 0, 1])
                , q = Z.uvs;
            if (!q)
                if (Z.positions)
                    q = new Float32Array($.length);
                else
                    q = new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]);
            let K = Z.indices || new Uint32Array([0, 1, 2, 0, 2, 3])
                , V = Z.shrinkBuffersToFit
                , z = new P7({
                    data: $,
                    label: "attribute-mesh-positions",
                    shrinkToFit: V,
                    usage: a8.VERTEX | a8.COPY_DST
                })
                , W = new P7({
                    data: q,
                    label: "attribute-mesh-uvs",
                    shrinkToFit: V,
                    usage: a8.VERTEX | a8.COPY_DST
                })
                , H = new P7({
                    data: K,
                    label: "index-mesh-buffer",
                    shrinkToFit: V,
                    usage: a8.INDEX | a8.COPY_DST
                });
            super({
                attributes: {
                    aPosition: {
                        buffer: z,
                        format: "float32x2",
                        stride: 8,
                        offset: 0
                    },
                    aUV: {
                        buffer: W,
                        format: "float32x2",
                        stride: 8,
                        offset: 0
                    }
                },
                indexBuffer: H,
                topology: Z.topology
            });
            this.batchMode = "auto"
        }
        get positions() {
            return this.attributes.aPosition.buffer.data
        }
        set positions(Q) {
            this.attributes.aPosition.buffer.data = Q
        }
        get uvs() {
            return this.attributes.aUV.buffer.data
        }
        set uvs(Q) {
            this.attributes.aUV.buffer.data = Q
        }
        get indices() {
            return this.indexBuffer.data
        }
        set indices(Q) {
            this.indexBuffer.data = Q
        }
    }
        ;
    C_.defaultOptions = {
        topology: "triangle-list",
        shrinkBuffersToFit: !1
    };
    C5 = C_
}
);
var EQ, zw, PZ;
var DZ = O(() => {
    EQ = {
        name: "local-uniform-bit",
        vertex: {
            header: `

            struct LocalUniforms {
                uTransformMatrix:mat3x3<f32>,
                uColor:vec4<f32>,
                uRound:f32,
            }

            @group(1) @binding(0) var<uniform> localUniforms : LocalUniforms;
        `,
            main: `
            vColor *= localUniforms.uColor;
            modelMatrix *= localUniforms.uTransformMatrix;
        `,
            end: `
            if(localUniforms.uRound == 1)
            {
                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
            }
        `
        }
    },
        zw = {
            ...EQ,
            vertex: {
                ...EQ.vertex,
                header: EQ.vertex.header.replace("group(1)", "group(2)")
            }
        },
        PZ = {
            name: "local-uniform-bit",
            vertex: {
                header: `

            uniform mat3 uTransformMatrix;
            uniform vec4 uColor;
            uniform float uRound;
        `,
                main: `
            vColor *= uColor;
            modelMatrix = uTransformMatrix;
        `,
                end: `
            if(uRound == 1.)
            {
                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
            }
        `
            }
        }
}
);
var Ww, Hw;
var Yw = O(() => {
    Ww = {
        name: "tiling-bit",
        vertex: {
            header: `
            struct TilingUniforms {
                uMapCoord:mat3x3<f32>,
                uClampFrame:vec4<f32>,
                uClampOffset:vec2<f32>,
                uTextureTransform:mat3x3<f32>,
                uSizeAnchor:vec4<f32>
            };

            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;
            @group(2) @binding(1) var uTexture: texture_2d<f32>;
            @group(2) @binding(2) var uSampler: sampler;
        `,
            main: `
            uv = (tilingUniforms.uTextureTransform * vec3(uv, 1.0)).xy;

            position = (position - tilingUniforms.uSizeAnchor.zw) * tilingUniforms.uSizeAnchor.xy;
        `
        },
        fragment: {
            header: `
            struct TilingUniforms {
                uMapCoord:mat3x3<f32>,
                uClampFrame:vec4<f32>,
                uClampOffset:vec2<f32>,
                uTextureTransform:mat3x3<f32>,
                uSizeAnchor:vec4<f32>
            };

            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;
            @group(2) @binding(1) var uTexture: texture_2d<f32>;
            @group(2) @binding(2) var uSampler: sampler;
        `,
            main: `

            var coord = vUV + ceil(tilingUniforms.uClampOffset - vUV);
            coord = (tilingUniforms.uMapCoord * vec3(coord, 1.0)).xy;
            var unclamped = coord;
            coord = clamp(coord, tilingUniforms.uClampFrame.xy, tilingUniforms.uClampFrame.zw);

            var bias = 0.;

            if(unclamped.x == coord.x && unclamped.y == coord.y)
            {
                bias = -32.;
            }

            outColor = textureSampleBias(uTexture, uSampler, coord, bias);
        `
        }
    },
        Hw = {
            name: "tiling-bit",
            vertex: {
                header: `
            uniform mat3 uTextureTransform;
            uniform vec4 uSizeAnchor;

        `,
                main: `
            uv = (uTextureTransform * vec3(aUV, 1.0)).xy;

            position = (position - uSizeAnchor.zw) * uSizeAnchor.xy;
        `
            },
            fragment: {
                header: `
            uniform sampler2D uTexture;
            uniform mat3 uMapCoord;
            uniform vec4 uClampFrame;
            uniform vec2 uClampOffset;
        `,
                main: `

        vec2 coord = vUV + ceil(uClampOffset - vUV);
        coord = (uMapCoord * vec3(coord, 1.0)).xy;
        vec2 unclamped = coord;
        coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

        outColor = texture(uTexture, coord, unclamped == coord ? 0.0 : -32.0);// lod-bias very negative to force lod 0

        `
            }
        }
}
);
var qG, KG, pz;
var Xw = O(() => {
    Z6();
    v9();
    DZ();
    S9();
    k5();
    _7();
    W6();
    Yw();
    pz = class pz extends k7 {
        constructor() {
            qG ?? (qG = R5({
                name: "tiling-sprite-shader",
                bits: [EQ, Ww, v5]
            })),
                KG ?? (KG = b5({
                    name: "tiling-sprite-shader",
                    bits: [PZ, Hw, S5]
                }));
            let J = new Y6({
                uMapCoord: {
                    value: new f0,
                    type: "mat3x3<f32>"
                },
                uClampFrame: {
                    value: new Float32Array([0, 0, 1, 1]),
                    type: "vec4<f32>"
                },
                uClampOffset: {
                    value: new Float32Array([0, 0]),
                    type: "vec2<f32>"
                },
                uTextureTransform: {
                    value: new f0,
                    type: "mat3x3<f32>"
                },
                uSizeAnchor: {
                    value: new Float32Array([100, 100, 0.5, 0.5]),
                    type: "vec4<f32>"
                }
            });
            super({
                glProgram: KG,
                gpuProgram: qG,
                resources: {
                    localUniforms: new Y6({
                        uTransformMatrix: {
                            value: new f0,
                            type: "mat3x3<f32>"
                        },
                        uColor: {
                            value: new Float32Array([1, 1, 1, 1]),
                            type: "vec4<f32>"
                        },
                        uRound: {
                            value: 0,
                            type: "f32"
                        }
                    }),
                    tilingUniforms: J,
                    uTexture: _0.EMPTY.source,
                    uSampler: _0.EMPTY.source.style
                }
            })
        }
        updateUniforms(J, Q, Z, $, q, K) {
            let V = this.resources.tilingUniforms
                , z = K.width
                , W = K.height
                , H = K.textureMatrix
                , Y = V.uniforms.uTextureTransform;
            if (Y.set(Z.a * z / J, Z.b * z / Q, Z.c * W / J, Z.d * W / Q, Z.tx / J, Z.ty / Q),
                Y.invert(),
                V.uniforms.uMapCoord = H.mapCoord,
                V.uniforms.uClampFrame = H.uClampFrame,
                V.uniforms.uClampOffset = H.uClampOffset,
                V.uniforms.uTextureTransform = Y,
                V.uniforms.uSizeAnchor[0] = J,
                V.uniforms.uSizeAnchor[1] = Q,
                V.uniforms.uSizeAnchor[2] = $,
                V.uniforms.uSizeAnchor[3] = q,
                K)
                this.resources.uTexture = K.source,
                    this.resources.uSampler = K.source.style
        }
    }
}
);
var uz;
var Uw = O(() => {
    AQ();
    uz = class uz extends C5 {
        constructor() {
            super({
                positions: new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]),
                uvs: new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]),
                indices: new Uint32Array([0, 1, 2, 0, 2, 3])
            })
        }
    }
}
);
function Nw(J, Q) {
    let Z = J.anchor.x
        , $ = J.anchor.y;
    Q[0] = -Z * J.width,
        Q[1] = -$ * J.height,
        Q[2] = (1 - Z) * J.width,
        Q[3] = -$ * J.height,
        Q[4] = (1 - Z) * J.width,
        Q[5] = (1 - $) * J.height,
        Q[6] = -Z * J.width,
        Q[7] = (1 - $) * J.height
}
var ww = () => { }
    ;
function jw(J, Q, Z, $) {
    let q = 0
        , K = J.length / (Q || 2)
        , V = $.a
        , z = $.b
        , W = $.c
        , H = $.d
        , Y = $.tx
        , U = $.ty;
    Z *= Q;
    while (q < K) {
        let N = J[Z]
            , j = J[Z + 1];
        J[Z] = V * N + W * j + Y,
            J[Z + 1] = z * N + H * j + U,
            Z += Q,
            q++
    }
}
var Bw = () => { }
    ;
function kw(J, Q) {
    let Z = J.texture
        , $ = Z.frame.width
        , q = Z.frame.height
        , K = 0
        , V = 0;
    if (J.applyAnchorToTexture)
        K = J.anchor.x,
            V = J.anchor.y;
    Q[0] = Q[6] = -K,
        Q[2] = Q[4] = 1 - K,
        Q[1] = Q[3] = -V,
        Q[5] = Q[7] = 1 - V;
    let z = f0.shared;
    z.copyFrom(J._tileTransform.matrix),
        z.tx /= J.width,
        z.ty /= J.height,
        z.invert(),
        z.scale(J.width / $, J.height / q),
        jw(Q, 2, 0, z)
}
var Cw = O(() => {
    Z6();
    Bw()
}
);
class Iw {
    constructor() {
        this.canBatch = !0,
            this.geometry = new C5({
                indices: Ow.indices.slice(),
                positions: Ow.positions.slice(),
                uvs: Ow.uvs.slice()
            })
    }
    destroy() {
        this.geometry.destroy(),
            this.shader?.destroy()
    }
}
class gq {
    constructor(J) {
        this._state = U7.default2d,
            this._renderer = J
    }
    validateRenderable(J) {
        let Q = this._getTilingSpriteData(J)
            , Z = Q.canBatch;
        this._updateCanBatch(J);
        let $ = Q.canBatch;
        if ($ && $ === Z) {
            let { batchableMesh: q } = Q;
            return !q._batcher.checkAndUpdateTexture(q, J.texture)
        }
        return Z !== $
    }
    addRenderable(J, Q) {
        let Z = this._renderer.renderPipes.batch;
        this._updateCanBatch(J);
        let $ = this._getTilingSpriteData(J)
            , { geometry: q, canBatch: K } = $;
        if (K) {
            $.batchableMesh || ($.batchableMesh = new FQ);
            let V = $.batchableMesh;
            if (J.didViewUpdate)
                this._updateBatchableMesh(J),
                    V.geometry = q,
                    V.renderable = J,
                    V.transform = J.groupTransform,
                    V.setTexture(J._texture);
            V.roundPixels = this._renderer._roundPixels | J._roundPixels,
                Z.addToBatch(V, Q)
        } else
            Z.break(Q),
                $.shader || ($.shader = new pz),
                this.updateRenderable(J),
                Q.add(J)
    }
    execute(J) {
        let { shader: Q } = this._getTilingSpriteData(J);
        Q.groups[0] = this._renderer.globalUniforms.bindGroup;
        let Z = Q.resources.localUniforms.uniforms;
        Z.uTransformMatrix = J.groupTransform,
            Z.uRound = this._renderer._roundPixels | J._roundPixels,
            T5(J.groupColorAlpha, Z.uColor, 0),
            this._state.blendMode = J9(J.groupBlendMode, J.texture._source),
            this._renderer.encoder.draw({
                geometry: Ow,
                shader: Q,
                state: this._state
            })
    }
    updateRenderable(J) {
        let Q = this._getTilingSpriteData(J)
            , { canBatch: Z } = Q;
        if (Z) {
            let { batchableMesh: $ } = Q;
            if (J.didViewUpdate)
                this._updateBatchableMesh(J);
            $._batcher.updateElement($)
        } else if (J.didViewUpdate) {
            let { shader: $ } = Q;
            $.updateUniforms(J.width, J.height, J._tileTransform.matrix, J.anchor.x, J.anchor.y, J.texture)
        }
    }
    _getTilingSpriteData(J) {
        return J._gpuData[this._renderer.uid] || this._initTilingSpriteData(J)
    }
    _initTilingSpriteData(J) {
        let Q = new Iw;
        return Q.renderable = J,
            J._gpuData[this._renderer.uid] = Q,
            Q
    }
    _updateBatchableMesh(J) {
        let Q = this._getTilingSpriteData(J)
            , { geometry: Z } = Q
            , $ = J.texture.source.style;
        if ($.addressMode !== "repeat")
            $.addressMode = "repeat",
                $.update();
        kw(J, Z.uvs),
            Nw(J, Z.positions)
    }
    destroy() {
        this._renderer = null
    }
    _updateCanBatch(J) {
        let Q = this._getTilingSpriteData(J)
            , Z = J.texture
            , $ = !0;
        if (this._renderer.type === W7.WEBGL)
            $ = this._renderer.context.supports.nonPowOf2wrapping;
        return Q.canBatch = Z.textureMatrix.isSimple && ($ || Z.source.isPowerOfTwo),
            Q.canBatch
    }
}
var Ow;
var Lw = O(() => {
    w0();
    k$();
    q5();
    $5();
    kZ();
    Oq();
    AQ();
    Xw();
    Uw();
    ww();
    Cw();
    Ow = new uz;
    gq.extension = {
        type: [R.WebGLPipes, R.WebGPUPipes, R.CanvasPipes],
        name: "tilingSprite"
    }
}
);
var VG = O(() => {
    w0();
    Lw();
    e0.add(gq)
}
);
var O_, v$;
var mq = O(() => {
    O6();
    AQ();
    O_ = class J extends C5 {
        constructor(...Q) {
            super({});
            let Z = Q[0] ?? {};
            if (typeof Z === "number")
                c0(Y8, "PlaneGeometry constructor changed please use { width, height, verticesX, verticesY } instead"),
                    Z = {
                        width: Z,
                        height: Q[1],
                        verticesX: Q[2],
                        verticesY: Q[3]
                    };
            this.build(Z)
        }
        build(Q) {
            Q = {
                ...J.defaultOptions,
                ...Q
            },
                this.verticesX = this.verticesX ?? Q.verticesX,
                this.verticesY = this.verticesY ?? Q.verticesY,
                this.width = this.width ?? Q.width,
                this.height = this.height ?? Q.height;
            let Z = this.verticesX * this.verticesY
                , $ = []
                , q = []
                , K = []
                , V = this.verticesX - 1
                , z = this.verticesY - 1
                , W = this.width / V
                , H = this.height / z;
            for (let U = 0; U < Z; U++) {
                let N = U % this.verticesX
                    , j = U / this.verticesX | 0;
                $.push(N * W, j * H),
                    q.push(N / V, j / z)
            }
            let Y = V * z;
            for (let U = 0; U < Y; U++) {
                let N = U % V
                    , j = U / V | 0
                    , k = j * this.verticesX + N
                    , L = j * this.verticesX + N + 1
                    , F = (j + 1) * this.verticesX + N
                    , P = (j + 1) * this.verticesX + N + 1;
                K.push(k, L, F, L, P, F)
            }
            this.buffers[0].data = new Float32Array($),
                this.buffers[1].data = new Float32Array(q),
                this.indexBuffer.data = new Uint32Array(K),
                this.buffers[0].update(),
                this.buffers[1].update(),
                this.indexBuffer.update()
        }
    }
        ;
    O_.defaultOptions = {
        width: 100,
        height: 100,
        verticesX: 10,
        verticesY: 10
    };
    v$ = O_
}
);
var I_, V9;
var lz = O(() => {
    mq();
    I_ = class J extends v$ {
        constructor(Q = {}) {
            Q = {
                ...J.defaultOptions,
                ...Q
            };
            super({
                width: Q.width,
                height: Q.height,
                verticesX: 4,
                verticesY: 4
            });
            this.update(Q)
        }
        update(Q) {
            this.width = Q.width ?? this.width,
                this.height = Q.height ?? this.height,
                this._originalWidth = Q.originalWidth ?? this._originalWidth,
                this._originalHeight = Q.originalHeight ?? this._originalHeight,
                this._leftWidth = Q.leftWidth ?? this._leftWidth,
                this._rightWidth = Q.rightWidth ?? this._rightWidth,
                this._topHeight = Q.topHeight ?? this._topHeight,
                this._bottomHeight = Q.bottomHeight ?? this._bottomHeight,
                this._anchorX = Q.anchor?.x,
                this._anchorY = Q.anchor?.y,
                this.updateUvs(),
                this.updatePositions()
        }
        updatePositions() {
            let Q = this.positions
                , { width: Z, height: $, _leftWidth: q, _rightWidth: K, _topHeight: V, _bottomHeight: z, _anchorX: W, _anchorY: H } = this
                , Y = q + K
                , U = Z > Y ? 1 : Z / Y
                , N = V + z
                , j = $ > N ? 1 : $ / N
                , k = Math.min(U, j)
                , L = W * Z
                , F = H * $;
            Q[0] = Q[8] = Q[16] = Q[24] = -L,
                Q[2] = Q[10] = Q[18] = Q[26] = q * k - L,
                Q[4] = Q[12] = Q[20] = Q[28] = Z - K * k - L,
                Q[6] = Q[14] = Q[22] = Q[30] = Z - L,
                Q[1] = Q[3] = Q[5] = Q[7] = -F,
                Q[9] = Q[11] = Q[13] = Q[15] = V * k - F,
                Q[17] = Q[19] = Q[21] = Q[23] = $ - z * k - F,
                Q[25] = Q[27] = Q[29] = Q[31] = $ - F,
                this.getBuffer("aPosition").update()
        }
        updateUvs() {
            let Q = this.uvs;
            Q[0] = Q[8] = Q[16] = Q[24] = 0,
                Q[1] = Q[3] = Q[5] = Q[7] = 0,
                Q[6] = Q[14] = Q[22] = Q[30] = 1,
                Q[25] = Q[27] = Q[29] = Q[31] = 1;
            let Z = 1 / this._originalWidth
                , $ = 1 / this._originalHeight;
            Q[2] = Q[10] = Q[18] = Q[26] = Z * this._leftWidth,
                Q[9] = Q[11] = Q[13] = Q[15] = $ * this._topHeight,
                Q[4] = Q[12] = Q[20] = Q[28] = 1 - Z * this._rightWidth,
                Q[17] = Q[19] = Q[21] = Q[23] = 1 - $ * this._bottomHeight,
                this.getBuffer("aUV").update()
        }
    }
        ;
    I_.defaultOptions = {
        width: 100,
        height: 100,
        leftWidth: 10,
        topHeight: 10,
        rightWidth: 10,
        bottomHeight: 10,
        originalWidth: 100,
        originalHeight: 100
    };
    V9 = I_
}
);
class cq {
    constructor(J) {
        this._renderer = J
    }
    addRenderable(J, Q) {
        let Z = this._getGpuSprite(J);
        if (J.didViewUpdate)
            this._updateBatchableSprite(J, Z);
        this._renderer.renderPipes.batch.addToBatch(Z, Q)
    }
    updateRenderable(J) {
        let Q = this._getGpuSprite(J);
        if (J.didViewUpdate)
            this._updateBatchableSprite(J, Q);
        Q._batcher.updateElement(Q)
    }
    validateRenderable(J) {
        let Q = this._getGpuSprite(J);
        return !Q._batcher.checkAndUpdateTexture(Q, J._texture)
    }
    _updateBatchableSprite(J, Q) {
        Q.geometry.update(J),
            Q.setTexture(J._texture)
    }
    _getGpuSprite(J) {
        return J._gpuData[this._renderer.uid] || this._initGPUSprite(J)
    }
    _initGPUSprite(J) {
        let Q = J._gpuData[this._renderer.uid] = new Fw
            , Z = Q;
        if (Z.renderable = J,
            Z.transform = J.groupTransform,
            Z.texture = J._texture,
            Z.roundPixels = this._renderer._roundPixels | J._roundPixels,
            !J.didViewUpdate)
            this._updateBatchableSprite(J, Z);
        return Q
    }
    destroy() {
        this._renderer = null
    }
}
var Fw;
var Gw = O(() => {
    w0();
    Oq();
    lz();
    Fw = class Fw extends FQ {
        constructor() {
            super();
            this.geometry = new V9
        }
        destroy() {
            this.geometry.destroy()
        }
    }
        ;
    cq.extension = {
        type: [R.WebGLPipes, R.WebGPUPipes, R.CanvasPipes],
        name: "nineSliceSprite"
    }
}
);
var zG = O(() => {
    w0();
    Gw();
    e0.add(cq)
}
);
class dq {
    constructor(J) {
        this._renderer = J
    }
    push(J, Q, Z) {
        this._renderer.renderPipes.batch.break(Z),
            Z.add({
                renderPipeId: "filter",
                canBundle: !1,
                action: "pushFilter",
                container: Q,
                filterEffect: J
            })
    }
    pop(J, Q, Z) {
        this._renderer.renderPipes.batch.break(Z),
            Z.add({
                renderPipeId: "filter",
                action: "popFilter",
                canBundle: !1
            })
    }
    execute(J) {
        if (J.action === "pushFilter")
            this._renderer.filter.push(J);
        else if (J.action === "popFilter")
            this._renderer.filter.pop()
    }
    destroy() {
        this._renderer = null
    }
}
var Pw = O(() => {
    w0();
    dq.extension = {
        type: [R.WebGLPipes, R.WebGPUPipes, R.CanvasPipes],
        name: "filter"
    }
}
);
function Dw(J, Q) {
    Q.clear();
    let Z = Q.matrix;
    for (let $ = 0; $ < J.length; $++) {
        let q = J[$];
        if (q.globalDisplayStatus < 7)
            continue;
        Q.matrix = q.worldTransform,
            Q.addBounds(q.bounds)
    }
    return Q.matrix = Z,
        Q
}
var Aw = () => { }
    ;
class L_ {
    constructor() {
        this.skip = !1,
            this.inputTexture = null,
            this.backTexture = null,
            this.filters = null,
            this.bounds = new E6,
            this.container = null,
            this.blendRequired = !1,
            this.outputRenderSurface = null,
            this.globalFrame = {
                x: 0,
                y: 0,
                width: 0,
                height: 0
            }
    }
}
class pq {
    constructor(J) {
        this._filterStackIndex = 0,
            this._filterStack = [],
            this._filterGlobalUniforms = new Y6({
                uInputSize: {
                    value: new Float32Array(4),
                    type: "vec4<f32>"
                },
                uInputPixel: {
                    value: new Float32Array(4),
                    type: "vec4<f32>"
                },
                uInputClamp: {
                    value: new Float32Array(4),
                    type: "vec4<f32>"
                },
                uOutputFrame: {
                    value: new Float32Array(4),
                    type: "vec4<f32>"
                },
                uGlobalFrame: {
                    value: new Float32Array(4),
                    type: "vec4<f32>"
                },
                uOutputTexture: {
                    value: new Float32Array(4),
                    type: "vec4<f32>"
                }
            }),
            this._globalFilterBindGroup = new QJ({}),
            this.renderer = J
    }
    get activeBackTexture() {
        return this._activeFilterData?.backTexture
    }
    push(J) {
        let Q = this.renderer
            , Z = J.filterEffect.filters
            , $ = this._pushFilterData();
        $.skip = !1,
            $.filters = Z,
            $.container = J.container,
            $.outputRenderSurface = Q.renderTarget.renderSurface;
        let q = Q.renderTarget.renderTarget.colorTexture.source
            , K = q.resolution
            , V = q.antialias;
        if (Z.length === 0) {
            $.skip = !0;
            return
        }
        let z = $.bounds;
        if (this._calculateFilterArea(J, z),
            this._calculateFilterBounds($, Q.renderTarget.rootViewPort, V, K, 1),
            $.skip)
            return;
        let W = this._getPreviousFilterData()
            , H = this._findFilterResolution(K)
            , Y = 0
            , U = 0;
        if (W)
            Y = W.bounds.minX,
                U = W.bounds.minY;
        this._calculateGlobalFrame($, Y, U, H, q.width, q.height),
            this._setupFilterTextures($, z, Q, W)
    }
    generateFilteredTexture({ texture: J, filters: Q }) {
        let Z = this._pushFilterData();
        this._activeFilterData = Z,
            Z.skip = !1,
            Z.filters = Q;
        let $ = J.source
            , q = $.resolution
            , K = $.antialias;
        if (Q.length === 0)
            return Z.skip = !0,
                J;
        let V = Z.bounds;
        if (V.addRect(J.frame),
            this._calculateFilterBounds(Z, V.rectangle, K, q, 0),
            Z.skip)
            return J;
        let z = q
            , W = 0
            , H = 0;
        this._calculateGlobalFrame(Z, W, H, z, $.width, $.height),
            Z.outputRenderSurface = m6.getOptimalTexture(V.width, V.height, Z.resolution, Z.antialias),
            Z.backTexture = _0.EMPTY,
            Z.inputTexture = J,
            this.renderer.renderTarget.finishRenderPass(),
            this._applyFiltersToTexture(Z, !0);
        let U = Z.outputRenderSurface;
        return U.source.alphaMode = "premultiplied-alpha",
            U
    }
    pop() {
        let J = this.renderer
            , Q = this._popFilterData();
        if (Q.skip)
            return;
        if (J.globalUniforms.pop(),
            J.renderTarget.finishRenderPass(),
            this._activeFilterData = Q,
            this._applyFiltersToTexture(Q, !1),
            Q.blendRequired)
            m6.returnTexture(Q.backTexture);
        m6.returnTexture(Q.inputTexture)
    }
    getBackTexture(J, Q, Z) {
        let $ = J.colorTexture.source._resolution
            , q = m6.getOptimalTexture(Q.width, Q.height, $, !1)
            , K = Q.minX
            , V = Q.minY;
        if (Z)
            K -= Z.minX,
                V -= Z.minY;
        K = Math.floor(K * $),
            V = Math.floor(V * $);
        let z = Math.ceil(Q.width * $)
            , W = Math.ceil(Q.height * $);
        return this.renderer.renderTarget.copyToTexture(J, q, {
            x: K,
            y: V
        }, {
            width: z,
            height: W
        }, {
            x: 0,
            y: 0
        }),
            q
    }
    applyFilter(J, Q, Z, $) {
        let q = this.renderer
            , K = this._activeFilterData
            , z = K.outputRenderSurface === Z
            , W = q.renderTarget.rootRenderTarget.colorTexture.source._resolution
            , H = this._findFilterResolution(W)
            , Y = 0
            , U = 0;
        if (z) {
            let N = this._findPreviousFilterOffset();
            Y = N.x,
                U = N.y
        }
        this._updateFilterUniforms(Q, Z, K, Y, U, H, z, $),
            this._setupBindGroupsAndRender(J, Q, q)
    }
    calculateSpriteMatrix(J, Q) {
        let Z = this._activeFilterData
            , $ = J.set(Z.inputTexture._source.width, 0, 0, Z.inputTexture._source.height, Z.bounds.minX, Z.bounds.minY)
            , q = Q.worldTransform.copyTo(f0.shared)
            , K = Q.renderGroup || Q.parentRenderGroup;
        if (K && K.cacheToLocalTransform)
            q.prepend(K.cacheToLocalTransform);
        return q.invert(),
            $.prepend(q),
            $.scale(1 / Q.texture.orig.width, 1 / Q.texture.orig.height),
            $.translate(Q.anchor.x, Q.anchor.y),
            $
    }
    destroy() { }
    _setupBindGroupsAndRender(J, Q, Z) {
        if (Z.renderPipes.uniformBatch) {
            let $ = Z.renderPipes.uniformBatch.getUboResource(this._filterGlobalUniforms);
            this._globalFilterBindGroup.setResource($, 0)
        } else
            this._globalFilterBindGroup.setResource(this._filterGlobalUniforms, 0);
        if (this._globalFilterBindGroup.setResource(Q.source, 1),
            this._globalFilterBindGroup.setResource(Q.source.style, 2),
            J.groups[0] = this._globalFilterBindGroup,
            Z.encoder.draw({
                geometry: Km,
                shader: J,
                state: J._state,
                topology: "triangle-list"
            }),
            Z.type === W7.WEBGL)
            Z.renderTarget.finishRenderPass()
    }
    _setupFilterTextures(J, Q, Z, $) {
        if (J.backTexture = _0.EMPTY,
            J.blendRequired) {
            Z.renderTarget.finishRenderPass();
            let q = Z.renderTarget.getRenderTarget(J.outputRenderSurface);
            J.backTexture = this.getBackTexture(q, Q, $?.bounds)
        }
        J.inputTexture = m6.getOptimalTexture(Q.width, Q.height, J.resolution, J.antialias),
            Z.renderTarget.bind(J.inputTexture, !0),
            Z.globalUniforms.push({
                offset: Q
            })
    }
    _calculateGlobalFrame(J, Q, Z, $, q, K) {
        let V = J.globalFrame;
        V.x = Q * $,
            V.y = Z * $,
            V.width = q * $,
            V.height = K * $
    }
    _updateFilterUniforms(J, Q, Z, $, q, K, V, z) {
        let W = this._filterGlobalUniforms.uniforms
            , H = W.uOutputFrame
            , Y = W.uInputSize
            , U = W.uInputPixel
            , N = W.uInputClamp
            , j = W.uGlobalFrame
            , k = W.uOutputTexture;
        if (V)
            H[0] = Z.bounds.minX - $,
                H[1] = Z.bounds.minY - q;
        else
            H[0] = 0,
                H[1] = 0;
        H[2] = J.frame.width,
            H[3] = J.frame.height,
            Y[0] = J.source.width,
            Y[1] = J.source.height,
            Y[2] = 1 / Y[0],
            Y[3] = 1 / Y[1],
            U[0] = J.source.pixelWidth,
            U[1] = J.source.pixelHeight,
            U[2] = 1 / U[0],
            U[3] = 1 / U[1],
            N[0] = 0.5 * U[2],
            N[1] = 0.5 * U[3],
            N[2] = J.frame.width * Y[2] - 0.5 * U[2],
            N[3] = J.frame.height * Y[3] - 0.5 * U[3];
        let L = this.renderer.renderTarget.rootRenderTarget.colorTexture;
        if (j[0] = $ * K,
            j[1] = q * K,
            j[2] = L.source.width * K,
            j[3] = L.source.height * K,
            Q instanceof _0)
            Q.source.resource = null;
        let F = this.renderer.renderTarget.getRenderTarget(Q);
        if (this.renderer.renderTarget.bind(Q, !!z),
            Q instanceof _0)
            k[0] = Q.frame.width,
                k[1] = Q.frame.height;
        else
            k[0] = F.width,
                k[1] = F.height;
        k[2] = F.isRoot ? -1 : 1,
            this._filterGlobalUniforms.update()
    }
    _findFilterResolution(J) {
        let Q = this._filterStackIndex - 1;
        while (Q > 0 && this._filterStack[Q].skip)
            --Q;
        return Q > 0 && this._filterStack[Q].inputTexture ? this._filterStack[Q].inputTexture.source._resolution : J
    }
    _findPreviousFilterOffset() {
        let J = 0
            , Q = 0
            , Z = this._filterStackIndex;
        while (Z > 0) {
            Z--;
            let $ = this._filterStack[Z];
            if (!$.skip) {
                J = $.bounds.minX,
                    Q = $.bounds.minY;
                break
            }
        }
        return {
            x: J,
            y: Q
        }
    }
    _calculateFilterArea(J, Q) {
        if (J.renderables)
            Dw(J.renderables, Q);
        else if (J.filterEffect.filterArea)
            Q.clear(),
                Q.addRect(J.filterEffect.filterArea),
                Q.applyMatrix(J.container.worldTransform);
        else
            J.container.getFastGlobalBounds(!0, Q);
        if (J.container) {
            let $ = (J.container.renderGroup || J.container.parentRenderGroup).cacheToLocalTransform;
            if ($)
                Q.applyMatrix($)
        }
    }
    _applyFiltersToTexture(J, Q) {
        let { inputTexture: Z, bounds: $, filters: q } = J;
        if (this._globalFilterBindGroup.setResource(Z.source.style, 2),
            this._globalFilterBindGroup.setResource(J.backTexture.source, 3),
            q.length === 1)
            q[0].apply(this, Z, J.outputRenderSurface, Q);
        else {
            let K = J.inputTexture
                , V = m6.getOptimalTexture($.width, $.height, K.source._resolution, !1)
                , z = V
                , W = 0;
            for (W = 0; W < q.length - 1; ++W) {
                q[W].apply(this, K, z, !0);
                let Y = K;
                K = z,
                    z = Y
            }
            q[W].apply(this, K, J.outputRenderSurface, Q),
                m6.returnTexture(V)
        }
    }
    _calculateFilterBounds(J, Q, Z, $, q) {
        let K = this.renderer
            , V = J.bounds
            , z = J.filters
            , W = 1 / 0
            , H = 0
            , Y = !0
            , U = !1
            , N = !1
            , j = !0;
        for (let k = 0; k < z.length; k++) {
            let L = z[k];
            if (W = Math.min(W, L.resolution === "inherit" ? $ : L.resolution),
                H += L.padding,
                L.antialias === "off")
                Y = !1;
            else if (L.antialias === "inherit")
                Y && (Y = Z);
            if (!L.clipToViewport)
                j = !1;
            if (!(L.compatibleRenderers & K.type)) {
                N = !1;
                break
            }
            if (L.blendRequired && !(K.backBuffer?.useBackBuffer ?? !0)) {
                m0("Blend filter requires backBuffer on WebGL renderer to be enabled. Set `useBackBuffer: true` in the renderer options."),
                    N = !1;
                break
            }
            N = L.enabled || N,
                U || (U = L.blendRequired)
        }
        if (!N) {
            J.skip = !0;
            return
        }
        if (j)
            V.fitBounds(0, Q.width / $, 0, Q.height / $);
        if (V.scale(W).ceil().scale(1 / W).pad((H | 0) * q),
            !V.isPositive) {
            J.skip = !0;
            return
        }
        J.antialias = Y,
            J.resolution = W,
            J.blendRequired = U
    }
    _popFilterData() {
        return this._filterStackIndex--,
            this._filterStack[this._filterStackIndex]
    }
    _getPreviousFilterData() {
        let J, Q = this._filterStackIndex - 1;
        while (Q > 1)
            if (Q--,
                J = this._filterStack[Q],
                !J.skip)
                break;
        return J
    }
    _pushFilterData() {
        let J = this._filterStack[this._filterStackIndex];
        if (!J)
            J = this._filterStack[this._filterStackIndex] = new L_;
        return this._filterStackIndex++,
            J
    }
}
var Km;
var Ew = O(() => {
    w0();
    Z6();
    R9();
    IQ();
    _7();
    W6();
    E5();
    $5();
    VJ();
    Aw();
    B6();
    Km = new uJ({
        attributes: {
            aPosition: {
                buffer: new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]),
                format: "float32x2",
                stride: 8,
                offset: 0
            }
        },
        indexBuffer: new Uint32Array([0, 1, 2, 0, 2, 3])
    });
    pq.extension = {
        type: [R.WebGLSystem, R.WebGPUSystem],
        name: "filter"
    }
}
);
var WG = O(() => {
    w0();
    Pw();
    Ew();
    e0.add(pq);
    e0.add(dq)
}
);
var Vm = {};
var F_ = O(() => {
    WM();
    OF();
    YM();
    UM();
    sX();
    J2();
    cF();
    dF();
    pF();
    eF();
    ZG();
    $G();
    VG();
    zG();
    WG()
}
);
var zm = {};
var G_ = O(() => {
    OF();
    sX();
    J2();
    cF();
    dF();
    pF();
    eF();
    ZG();
    $G();
    VG();
    zG();
    WG()
}
);
var P_, _J;
var z9 = O(() => {
    lJ();
    Z5();
    k5();
    q5();
    P_ = class J extends k7 {
        constructor(Q) {
            Q = {
                ...J.defaultOptions,
                ...Q
            };
            super(Q);
            if (this.enabled = !0,
                this._state = U7.for2d(),
                this.blendMode = Q.blendMode,
                this.padding = Q.padding,
                typeof Q.antialias === "boolean")
                this.antialias = Q.antialias ? "on" : "off";
            else
                this.antialias = Q.antialias;
            this.resolution = Q.resolution,
                this.blendRequired = Q.blendRequired,
                this.clipToViewport = Q.clipToViewport,
                this.addResource("uTexture", 0, 1)
        }
        apply(Q, Z, $, q) {
            Q.applyFilter(this, Z, $, q)
        }
        get blendMode() {
            return this._state.blendMode
        }
        set blendMode(Q) {
            this._state.blendMode = Q
        }
        static from(Q) {
            let { gpu: Z, gl: $, ...q } = Q, K, V;
            if (Z)
                K = B7.from(Z);
            if ($)
                V = j7.from($);
            return new J({
                gpuProgram: K,
                glProgram: V,
                ...q
            })
        }
    }
        ;
    P_.defaultOptions = {
        blendMode: "normal",
        resolution: 1,
        padding: 0,
        antialias: "off",
        blendRequired: !1,
        clipToViewport: !0
    };
    _J = P_
}
);
async function tw(J) {
    if (J)
        return;
    for (let Q = 0; Q < XG.length; Q++) {
        let Z = XG[Q];
        if (Z.value.test()) {
            await Z.value.load();
            return
        }
    }
}
var XG;
var ew = O(() => {
    w0();
    XG = [];
    e0.handleByNamedList(R.Environment, XG)
}
);
function uq() {
    if (typeof oz === "boolean")
        return oz;
    try {
        oz = new Function("param1", "param2", "param3", "return param1[param2] === param3;")({
            a: "b"
        }, "a", "b") === !0
    } catch (J) {
        oz = !1
    }
    return oz
}
var oz;
var nz = () => { }
    ;
var s7;
var MZ = O(() => {
    s7 = ((J) => {
        return J[J.NONE = 0] = "NONE",
            J[J.COLOR = 16384] = "COLOR",
            J[J.STENCIL = 1024] = "STENCIL",
            J[J.DEPTH = 256] = "DEPTH",
            J[J.COLOR_DEPTH = 16640] = "COLOR_DEPTH",
            J[J.COLOR_STENCIL = 17408] = "COLOR_STENCIL",
            J[J.DEPTH_STENCIL = 1280] = "DEPTH_STENCIL",
            J[J.ALL = 17664] = "ALL",
            J
    }
    )(s7 || {})
}
);
class S$ {
    constructor(J) {
        this.items = [],
            this._name = J
    }
    emit(J, Q, Z, $, q, K, V, z) {
        let { name: W, items: H } = this;
        for (let Y = 0, U = H.length; Y < U; Y++)
            H[Y][W](J, Q, Z, $, q, K, V, z);
        return this
    }
    add(J) {
        if (J[this._name])
            this.remove(J),
                this.items.push(J);
        return this
    }
    remove(J) {
        let Q = this.items.indexOf(J);
        if (Q !== -1)
            this.items.splice(Q, 1);
        return this
    }
    contains(J) {
        return this.items.indexOf(J) !== -1
    }
    removeAll() {
        return this.items.length = 0,
            this
    }
    destroy() {
        this.removeAll(),
            this.items = null,
            this._name = null
    }
    get empty() {
        return this.items.length === 0
    }
    get name() {
        return this._name
    }
}
var sz = () => { }
    ;
var Wm, A_, x9;
var T$ = O(() => {
    T7();
    ew();
    zJ();
    nz();
    l7();
    O6();
    Wz();
    MZ();
    sz();
    wJ();
    Wm = ["init", "destroy", "contextChange", "resolutionChange", "resetState", "renderEnd", "renderStart", "render", "update", "postrender", "prerender"],
        A_ = class J extends o6 {
            constructor(Q) {
                super();
                this.uid = i8("renderer"),
                    this.runners = Object.create(null),
                    this.renderPipes = Object.create(null),
                    this._initOptions = {},
                    this._systemsHash = Object.create(null),
                    this.type = Q.type,
                    this.name = Q.name,
                    this.config = Q;
                let Z = [...Wm, ...this.config.runners ?? []];
                this._addRunners(...Z),
                    this._unsafeEvalCheck()
            }
            async init(Q = {}) {
                let Z = Q.skipExtensionImports === !0 ? !0 : Q.manageImports === !1;
                await tw(Z),
                    this._addSystems(this.config.systems),
                    this._addPipes(this.config.renderPipes, this.config.renderPipeAdaptors);
                for (let $ in this._systemsHash)
                    Q = {
                        ...this._systemsHash[$].constructor.defaultOptions,
                        ...Q
                    };
                Q = {
                    ...J.defaultOptions,
                    ...Q
                },
                    this._roundPixels = Q.roundPixels ? 1 : 0;
                for (let $ = 0; $ < this.runners.init.items.length; $++)
                    await this.runners.init.items[$].init(Q);
                this._initOptions = Q
            }
            render(Q, Z) {
                let $ = Q;
                if ($ instanceof m8) {
                    if ($ = {
                        container: $
                    },
                        Z)
                        c0(Y8, "passing a second argument is deprecated, please use render options instead"),
                            $.target = Z.renderTexture
                }
                if ($.target || ($.target = this.view.renderTarget),
                    $.target === this.view.renderTarget)
                    this._lastObjectRendered = $.container,
                        $.clearColor ?? ($.clearColor = this.background.colorRgba),
                        $.clear ?? ($.clear = this.background.clearBeforeRender);
                if ($.clearColor) {
                    let q = Array.isArray($.clearColor) && $.clearColor.length === 4;
                    $.clearColor = q ? $.clearColor : E8.shared.setValue($.clearColor).toArray()
                }
                if (!$.transform)
                    $.container.updateLocalTransform(),
                        $.transform = $.container.localTransform;
                $.container.enableRenderGroup(),
                    this.runners.prerender.emit($),
                    this.runners.renderStart.emit($),
                    this.runners.render.emit($),
                    this.runners.renderEnd.emit($),
                    this.runners.postrender.emit($)
            }
            resize(Q, Z, $) {
                let q = this.view.resolution;
                if (this.view.resize(Q, Z, $),
                    this.emit("resize", this.view.screen.width, this.view.screen.height, this.view.resolution),
                    $ !== void 0 && $ !== q)
                    this.runners.resolutionChange.emit($)
            }
            clear(Q = {}) {
                let Z = this;
                Q.target || (Q.target = Z.renderTarget.renderTarget),
                    Q.clearColor || (Q.clearColor = this.background.colorRgba),
                    Q.clear ?? (Q.clear = s7.ALL);
                let { clear: $, clearColor: q, target: K } = Q;
                E8.shared.setValue(q ?? this.background.colorRgba),
                    Z.renderTarget.clear(K, $, E8.shared.toArray())
            }
            get resolution() {
                return this.view.resolution
            }
            set resolution(Q) {
                this.view.resolution = Q,
                    this.runners.resolutionChange.emit(Q)
            }
            get width() {
                return this.view.texture.frame.width
            }
            get height() {
                return this.view.texture.frame.height
            }
            get canvas() {
                return this.view.canvas
            }
            get lastObjectRendered() {
                return this._lastObjectRendered
            }
            get renderingToScreen() {
                return this.renderTarget.renderingToScreen
            }
            get screen() {
                return this.view.screen
            }
            _addRunners(...Q) {
                Q.forEach((Z) => {
                    this.runners[Z] = new S$(Z)
                }
                )
            }
            _addSystems(Q) {
                let Z;
                for (Z in Q) {
                    let $ = Q[Z];
                    this._addSystem($.value, $.name)
                }
            }
            _addSystem(Q, Z) {
                let $ = new Q(this);
                if (this[Z])
                    throw new Error(`Whoops! The name "${Z}" is already in use`);
                this[Z] = $,
                    this._systemsHash[Z] = $;
                for (let q in this.runners)
                    this.runners[q].add($);
                return this
            }
            _addPipes(Q, Z) {
                let $ = Z.reduce((q, K) => {
                    return q[K.name] = K.value,
                        q
                }
                    , {});
                Q.forEach((q) => {
                    let { value: K, name: V } = q
                        , z = $[V];
                    this.renderPipes[V] = new K(this, z ? new z : null)
                }
                )
            }
            destroy(Q = !1) {
                this.runners.destroy.items.reverse(),
                    this.runners.destroy.emit(Q),
                    Object.values(this.runners).forEach((Z) => {
                        Z.destroy()
                    }
                    ),
                    this._systemsHash = null,
                    this.renderPipes = null
            }
            generateTexture(Q) {
                return this.textureGenerator.generateTexture(Q)
            }
            get roundPixels() {
                return !!this._roundPixels
            }
            _unsafeEvalCheck() {
                if (!uq())
                    throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")
            }
            resetState() {
                this.runners.resetState.emit()
            }
        }
        ;
    A_.defaultOptions = {
        resolution: 1,
        failIfMajorPerformanceCaveat: !1,
        roundPixels: !1
    };
    x9 = A_
}
);
class lq {
    constructor() {
        this._maxTextures = 0
    }
    contextChange(J) {
        let Q = new Y6({
            uTransformMatrix: {
                value: new f0,
                type: "mat3x3<f32>"
            },
            uColor: {
                value: new Float32Array([1, 1, 1, 1]),
                type: "vec4<f32>"
            },
            uRound: {
                value: 0,
                type: "f32"
            }
        });
        this._maxTextures = J.limits.maxBatchableTextures;
        let Z = R5({
            name: "graphics",
            bits: [WZ, YZ(this._maxTextures), zw, v5]
        });
        this.shader = new k7({
            gpuProgram: Z,
            resources: {
                localUniforms: Q
            }
        })
    }
    execute(J, Q) {
        let Z = Q.context
            , $ = Z.customShader || this.shader
            , q = J.renderer
            , K = q.graphicsContext
            , { batcher: V, instructions: z } = K.getContextRenderData(Z)
            , W = q.encoder;
        W.setGeometry(V.geometry, $.gpuProgram);
        let H = q.globalUniforms.bindGroup;
        W.setBindGroup(0, H, $.gpuProgram);
        let Y = q.renderPipes.uniformBatch.getUniformBindGroup($.resources.localUniforms, !0);
        W.setBindGroup(2, Y, $.gpuProgram);
        let U = z.instructions
            , N = null;
        for (let j = 0; j < z.instructionSize; j++) {
            let k = U[j];
            if (k.topology !== N)
                N = k.topology,
                    W.setPipelineFromGeometryProgramAndState(V.geometry, $.gpuProgram, J.state, k.topology);
            if ($.groups[1] = k.bindGroup,
                !k.gpuBindGroup) {
                let L = k.textures;
                k.bindGroup = KZ(L.textures, L.count, this._maxTextures),
                    k.gpuBindGroup = q.bindGroup.getBindGroup(k.bindGroup, $.gpuProgram, 1)
            }
            W.setBindGroup(1, k.bindGroup, $.gpuProgram),
                W.renderPassEncoder.drawIndexed(k.size, 1, k.start)
        }
    }
    destroy() {
        this.shader.destroy(!0),
            this.shader = null
    }
}
var Zj = O(() => {
    w0();
    Z6();
    zq();
    v9();
    O$();
    I$();
    DZ();
    S9();
    k5();
    _7();
    lq.extension = {
        type: [R.WebGPUPipesAdaptor],
        name: "graphics"
    }
}
);
var $j, qj;
var iz = O(() => {
    $j = {
        name: "texture-bit",
        vertex: {
            header: `

        struct TextureUniforms {
            uTextureMatrix:mat3x3<f32>,
        }

        @group(2) @binding(2) var<uniform> textureUniforms : TextureUniforms;
        `,
            main: `
            uv = (textureUniforms.uTextureMatrix * vec3(uv, 1.0)).xy;
        `
        },
        fragment: {
            header: `
            @group(2) @binding(0) var uTexture: texture_2d<f32>;
            @group(2) @binding(1) var uSampler: sampler;


        `,
            main: `
            outColor = textureSample(uTexture, uSampler, vUV);
        `
        }
    },
        qj = {
            name: "texture-bit",
            vertex: {
                header: `
            uniform mat3 uTextureMatrix;
        `,
                main: `
            uv = (uTextureMatrix * vec3(uv, 1.0)).xy;
        `
            },
            fragment: {
                header: `
        uniform sampler2D uTexture;


        `,
                main: `
            outColor = texture(uTexture, vUV);
        `
            }
        }
}
);
class oq {
    init() {
        let J = R5({
            name: "mesh",
            bits: [EQ, $j, v5]
        });
        this._shader = new k7({
            gpuProgram: J,
            resources: {
                uTexture: _0.EMPTY._source,
                uSampler: _0.EMPTY._source.style,
                textureUniforms: {
                    uTextureMatrix: {
                        type: "mat3x3<f32>",
                        value: new f0
                    }
                }
            }
        })
    }
    execute(J, Q) {
        let Z = J.renderer
            , $ = Q._shader;
        if (!$)
            $ = this._shader,
                $.groups[2] = Z.texture.getTextureBindGroup(Q.texture);
        else if (!$.gpuProgram) {
            m0("Mesh shader has no gpuProgram", Q.shader);
            return
        }
        let q = $.gpuProgram;
        if (q.autoAssignGlobalUniforms)
            $.groups[0] = Z.globalUniforms.bindGroup;
        if (q.autoAssignLocalUniforms) {
            let K = J.localUniforms;
            $.groups[1] = Z.renderPipes.uniformBatch.getUniformBindGroup(K, !0)
        }
        Z.encoder.draw({
            geometry: Q._geometry,
            shader: $,
            state: Q.state
        })
    }
    destroy() {
        this._shader.destroy(!0),
            this._shader = null
    }
}
var Kj = O(() => {
    w0();
    Z6();
    v9();
    DZ();
    S9();
    iz();
    k5();
    W6();
    B6();
    oq.extension = {
        type: [R.WebGPUPipesAdaptor],
        name: "mesh"
    }
}
);
class nq {
    start(J, Q, Z) {
        let $ = J.renderer
            , q = $.encoder
            , K = Z.gpuProgram;
        this._shader = Z,
            this._geometry = Q,
            q.setGeometry(Q, K),
            Vj.blendMode = "normal",
            $.pipeline.getPipeline(Q, K, Vj);
        let V = $.globalUniforms.bindGroup;
        q.resetBindGroup(1),
            q.setBindGroup(0, V, K)
    }
    execute(J, Q) {
        let Z = this._shader.gpuProgram
            , $ = J.renderer
            , q = $.encoder;
        if (!Q.bindGroup) {
            let z = Q.textures;
            Q.bindGroup = KZ(z.textures, z.count, $.limits.maxBatchableTextures)
        }
        Vj.blendMode = Q.blendMode;
        let K = $.bindGroup.getBindGroup(Q.bindGroup, Z, 1)
            , V = $.pipeline.getPipeline(this._geometry, Z, Vj, Q.topology);
        Q.bindGroup._touch($.textureGC.count),
            q.setPipeline(V),
            q.renderPassEncoder.setBindGroup(1, K),
            q.renderPassEncoder.drawIndexed(Q.size, 1, Q.start)
    }
}
var Vj;
var zj = O(() => {
    w0();
    q5();
    zq();
    Vj = U7.for2d();
    nq.extension = {
        type: [R.WebGPUPipesAdaptor],
        name: "batch"
    }
}
);
class sq {
    constructor(J) {
        this._renderer = J
    }
    updateRenderable() { }
    destroyRenderable() { }
    validateRenderable() {
        return !1
    }
    addRenderable(J, Q) {
        this._renderer.renderPipes.batch.break(Q),
            Q.add(J)
    }
    execute(J) {
        if (!J.isRenderable)
            return;
        J.render(this._renderer)
    }
    destroy() {
        this._renderer = null
    }
}
var Wj = O(() => {
    w0();
    sq.extension = {
        type: [R.WebGLPipes, R.WebGPUPipes, R.CanvasPipes],
        name: "customRender"
    }
}
);
function y$(J, Q) {
    let Z = J.instructionSet
        , $ = Z.instructions;
    for (let q = 0; q < Z.instructionSize; q++) {
        let K = $[q];
        Q[K.renderPipeId].execute(K)
    }
}
var az = () => { }
    ;
class iq {
    constructor(J) {
        this._renderer = J
    }
    addRenderGroup(J, Q) {
        if (J.isCachedAsTexture)
            this._addRenderableCacheAsTexture(J, Q);
        else
            this._addRenderableDirect(J, Q)
    }
    execute(J) {
        if (!J.isRenderable)
            return;
        if (J.isCachedAsTexture)
            this._executeCacheAsTexture(J);
        else
            this._executeDirect(J)
    }
    destroy() {
        this._renderer = null
    }
    _addRenderableDirect(J, Q) {
        if (this._renderer.renderPipes.batch.break(Q),
            J._batchableRenderGroup)
            V7.return(J._batchableRenderGroup),
                J._batchableRenderGroup = null;
        Q.add(J)
    }
    _addRenderableCacheAsTexture(J, Q) {
        let Z = J._batchableRenderGroup ?? (J._batchableRenderGroup = V7.get($9));
        Z.renderable = J.root,
            Z.transform = J.root.relativeGroupTransform,
            Z.texture = J.texture,
            Z.bounds = J._textureBounds,
            Q.add(J),
            this._renderer.renderPipes.batch.addToBatch(Z, Q)
    }
    _executeCacheAsTexture(J) {
        if (J.textureNeedsUpdate) {
            J.textureNeedsUpdate = !1;
            let Q = Hm.identity().translate(-J._textureBounds.x, -J._textureBounds.y);
            this._renderer.renderTarget.push(J.texture, !0, null, J.texture.frame),
                this._renderer.globalUniforms.push({
                    worldTransformMatrix: Q,
                    worldColor: 4294967295
                }),
                y$(J, this._renderer.renderPipes),
                this._renderer.renderTarget.finishRenderPass(),
                this._renderer.renderTarget.pop(),
                this._renderer.globalUniforms.pop()
        }
        J._batchableRenderGroup._batcher.updateElement(J._batchableRenderGroup),
            J._batchableRenderGroup._batcher.geometry.buffers[0].update()
    }
    _executeDirect(J) {
        this._renderer.globalUniforms.push({
            worldTransformMatrix: J.inverseParentTextureTransform,
            worldColor: J.worldColorAlpha
        }),
            y$(J, this._renderer.renderPipes),
            this._renderer.globalUniforms.pop()
    }
}
var Hm;
var Hj = O(() => {
    w0();
    Z6();
    s5();
    A$();
    az();
    Hm = new f0;
    iq.extension = {
        type: [R.WebGLPipes, R.WebGPUPipes, R.CanvasPipes],
        name: "renderGroup"
    }
}
);
function f$(J, Q) {
    Q || (Q = 0);
    for (let Z = Q; Z < J.length; Z++)
        if (J[Z])
            J[Z] = null;
        else
            break
}
var rz = () => { }
    ;
function tz(J, Q = !1) {
    UG(J);
    let Z = J.childrenToUpdate
        , $ = J.updateTick++;
    for (let q in Z) {
        let K = Number(q)
            , V = Z[q]
            , z = V.list
            , W = V.index;
        for (let H = 0; H < W; H++) {
            let Y = z[H];
            if (Y.parentRenderGroup === J && Y.relativeRenderGroupDepth === K)
                Yj(Y, $, 0)
        }
        f$(z, W),
            V.index = 0
    }
    if (Q)
        for (let q = 0; q < J.renderGroupChildren.length; q++)
            tz(J.renderGroupChildren[q], Q)
}
function UG(J) {
    let Q = J.root, Z;
    if (J.renderGroupParent) {
        let $ = J.renderGroupParent;
        J.worldTransform.appendFrom(Q.relativeGroupTransform, $.worldTransform),
            J.worldColor = rQ(Q.groupColor, $.worldColor),
            Z = Q.groupAlpha * $.worldAlpha
    } else
        J.worldTransform.copyFrom(Q.localTransform),
            J.worldColor = Q.localColor,
            Z = Q.localAlpha;
    Z = Z < 0 ? 0 : Z > 1 ? 1 : Z,
        J.worldAlpha = Z,
        J.worldColorAlpha = J.worldColor + ((Z * 255 | 0) << 24)
}
function Yj(J, Q, Z) {
    if (Q === J.updateTick)
        return;
    J.updateTick = Q,
        J.didChange = !1;
    let $ = J.localTransform;
    J.updateLocalTransform();
    let q = J.parent;
    if (q && !q.renderGroup) {
        if (Z |= J._updateFlags,
            J.relativeGroupTransform.appendFrom($, q.relativeGroupTransform),
            Z & E_)
            M_(J, q, Z)
    } else if (Z = J._updateFlags,
        J.relativeGroupTransform.copyFrom($),
        Z & E_)
        M_(J, Ym, Z);
    if (!J.renderGroup) {
        let K = J.children
            , V = K.length;
        for (let H = 0; H < V; H++)
            Yj(K[H], Q, Z);
        let z = J.parentRenderGroup
            , W = J;
        if (W.renderPipeId && !z.structureDidChange)
            z.updateRenderable(W)
    }
}
function M_(J, Q, Z) {
    if (Z & Y$) {
        J.groupColor = rQ(J.localColor, Q.groupColor);
        let $ = J.localAlpha * Q.groupAlpha;
        $ = $ < 0 ? 0 : $ > 1 ? 1 : $,
            J.groupAlpha = $,
            J.groupColorAlpha = J.groupColor + (($ * 255 | 0) << 24)
    }
    if (Z & u1)
        J.groupBlendMode = J.localBlendMode === "inherit" ? Q.groupBlendMode : J.localBlendMode;
    if (Z & JZ)
        J.globalDisplayStatus = J.localDisplayStatus & Q.globalDisplayStatus;
    J._updateFlags = 0
}
var Ym, E_;
var Xj = O(() => {
    zJ();
    rz();
    kV();
    Ym = new m8,
        E_ = JZ | Y$ | u1
}
);
function Uj(J, Q) {
    let { list: Z, index: $ } = J.childrenRenderablesToUpdate
        , q = !1;
    for (let K = 0; K < $; K++) {
        let V = Z[K];
        if (q = Q[V.renderPipeId].validateRenderable(V),
            q)
            break
    }
    return J.structureDidChange = q,
        q
}
var Nj = () => { }
    ;
class aq {
    constructor(J) {
        this._renderer = J
    }
    render({ container: J, transform: Q }) {
        let Z = J.parent
            , $ = J.renderGroup.renderGroupParent;
        J.parent = null,
            J.renderGroup.renderGroupParent = null;
        let q = this._renderer
            , K = Xm;
        if (Q)
            K = K.copyFrom(J.renderGroup.localTransform),
                J.renderGroup.localTransform.copyFrom(Q);
        let V = q.renderPipes;
        if (this._updateCachedRenderGroups(J.renderGroup, null),
            this._updateRenderGroups(J.renderGroup),
            q.globalUniforms.start({
                worldTransformMatrix: Q ? J.renderGroup.localTransform : J.renderGroup.worldTransform,
                worldColor: J.renderGroup.worldColorAlpha
            }),
            y$(J.renderGroup, V),
            V.uniformBatch)
            V.uniformBatch.renderEnd();
        if (Q)
            J.renderGroup.localTransform.copyFrom(K);
        J.parent = Z,
            J.renderGroup.renderGroupParent = $
    }
    destroy() {
        this._renderer = null
    }
    _updateCachedRenderGroups(J, Q) {
        if (J.isCachedAsTexture) {
            if (!J.updateCacheTexture)
                return;
            Q = J
        }
        J._parentCacheAsTextureRenderGroup = Q;
        for (let Z = J.renderGroupChildren.length - 1; Z >= 0; Z--)
            this._updateCachedRenderGroups(J.renderGroupChildren[Z], Q);
        if (J.invalidateMatrices(),
            J.isCachedAsTexture) {
            if (J.textureNeedsUpdate) {
                let Z = J.root.getLocalBounds();
                Z.ceil();
                let $ = J.texture;
                if (J.texture)
                    m6.returnTexture(J.texture);
                let q = this._renderer
                    , K = J.textureOptions.resolution || q.view.resolution
                    , V = J.textureOptions.antialias ?? q.view.antialias;
                if (J.texture = m6.getOptimalTexture(Z.width, Z.height, K, V),
                    J._textureBounds || (J._textureBounds = new E6),
                    J._textureBounds.copyFrom(Z),
                    $ !== J.texture) {
                    if (J.renderGroupParent)
                        J.renderGroupParent.structureDidChange = !0
                }
            }
        } else if (J.texture)
            m6.returnTexture(J.texture),
                J.texture = null
    }
    _updateRenderGroups(J) {
        let Q = this._renderer
            , Z = Q.renderPipes;
        if (J.runOnRender(Q),
            J.instructionSet.renderPipes = Z,
            !J.structureDidChange)
            Uj(J, Z);
        else
            f$(J.childrenRenderablesToUpdate.list, 0);
        if (tz(J),
            J.structureDidChange)
            J.structureDidChange = !1,
                this._buildInstructions(J, Q);
        else
            this._updateRenderables(J);
        if (J.childrenRenderablesToUpdate.index = 0,
            Q.renderPipes.batch.upload(J.instructionSet),
            J.isCachedAsTexture && !J.textureNeedsUpdate)
            return;
        for (let $ = 0; $ < J.renderGroupChildren.length; $++)
            this._updateRenderGroups(J.renderGroupChildren[$])
    }
    _updateRenderables(J) {
        let { list: Q, index: Z } = J.childrenRenderablesToUpdate;
        for (let $ = 0; $ < Z; $++) {
            let q = Q[$];
            if (q.didViewUpdate)
                J.updateRenderable(q)
        }
        f$(Q, Z)
    }
    _buildInstructions(J, Q) {
        let { root: Z, instructionSet: $ } = J;
        $.reset();
        let q = Q.renderPipes ? Q : Q.batch.renderer
            , K = q.renderPipes;
        if (K.batch.buildStart($),
            K.blendMode.buildStart(),
            K.colorMask.buildStart(),
            Z.sortableChildren)
            Z.sortChildren();
        Z.collectRenderablesWithEffects($, q, null),
            K.batch.buildEnd($),
            K.blendMode.buildEnd($)
    }
}
var Xm;
var wj = O(() => {
    w0();
    Z6();
    E5();
    VJ();
    rz();
    az();
    Xj();
    Nj();
    Xm = new f0;
    aq.extension = {
        type: [R.WebGLSystem, R.WebGPUSystem, R.CanvasSystem],
        name: "renderGroup"
    }
}
);
class rq {
    constructor(J) {
        this._renderer = J
    }
    addRenderable(J, Q) {
        let Z = this._getGpuSprite(J);
        if (J.didViewUpdate)
            this._updateBatchableSprite(J, Z);
        this._renderer.renderPipes.batch.addToBatch(Z, Q)
    }
    updateRenderable(J) {
        let Q = this._getGpuSprite(J);
        if (J.didViewUpdate)
            this._updateBatchableSprite(J, Q);
        Q._batcher.updateElement(Q)
    }
    validateRenderable(J) {
        let Q = this._getGpuSprite(J);
        return !Q._batcher.checkAndUpdateTexture(Q, J._texture)
    }
    _updateBatchableSprite(J, Q) {
        Q.bounds = J.visualBounds,
            Q.texture = J._texture
    }
    _getGpuSprite(J) {
        return J._gpuData[this._renderer.uid] || this._initGPUSprite(J)
    }
    _initGPUSprite(J) {
        let Q = new $9;
        return Q.renderable = J,
            Q.transform = J.groupTransform,
            Q.texture = J._texture,
            Q.bounds = J.visualBounds,
            Q.roundPixels = this._renderer._roundPixels | J._roundPixels,
            J._gpuData[this._renderer.uid] = Q,
            Q
    }
    destroy() {
        this._renderer = null
    }
}
var jj = O(() => {
    w0();
    A$();
    rq.extension = {
        type: [R.WebGLPipes, R.WebGPUPipes, R.CanvasPipes],
        name: "sprite"
    }
}
);
var _Z = "8.11.0";
var ez = O(() => {
    wJ()
}
);
class tq {
    static init() {
        globalThis.__PIXI_APP_INIT__?.(this, _Z)
    }
    static destroy() { }
}
class eq {
    constructor(J) {
        this._renderer = J
    }
    init() {
        globalThis.__PIXI_RENDERER_INIT__?.(this._renderer, _Z)
    }
    destroy() {
        this._renderer = null
    }
}
var JW = O(() => {
    w0();
    ez();
    tq.extension = R.Application;
    eq.extension = {
        type: [R.WebGLSystem, R.WebGPUSystem],
        name: "initHook",
        priority: -10
    }
}
);
var NG = class J {
    constructor(Q, Z) {
        this.state = U7.for2d(),
            this._batchersByInstructionSet = Object.create(null),
            this._activeBatches = Object.create(null),
            this.renderer = Q,
            this._adaptor = Z,
            this._adaptor.init?.(this)
    }
    static getBatcher(Q) {
        return new this._availableBatchers[Q]
    }
    buildStart(Q) {
        let Z = this._batchersByInstructionSet[Q.uid];
        if (!Z)
            Z = this._batchersByInstructionSet[Q.uid] = Object.create(null),
                Z.default || (Z.default = new L$({
                    maxTextures: this.renderer.limits.maxBatchableTextures
                }));
        this._activeBatches = Z,
            this._activeBatch = this._activeBatches.default;
        for (let $ in this._activeBatches)
            this._activeBatches[$].begin()
    }
    addToBatch(Q, Z) {
        if (this._activeBatch.name !== Q.batcherName) {
            this._activeBatch.break(Z);
            let $ = this._activeBatches[Q.batcherName];
            if (!$)
                $ = this._activeBatches[Q.batcherName] = J.getBatcher(Q.batcherName),
                    $.begin();
            this._activeBatch = $
        }
        this._activeBatch.add(Q)
    }
    break(Q) {
        this._activeBatch.break(Q)
    }
    buildEnd(Q) {
        this._activeBatch.break(Q);
        let Z = this._activeBatches;
        for (let $ in Z) {
            let q = Z[$]
                , K = q.geometry;
            K.indexBuffer.setDataWithSize(q.indexBuffer, q.indexSize, !0),
                K.buffers[0].setDataWithSize(q.attributeBuffer.float32View, q.attributeSize, !1)
        }
    }
    upload(Q) {
        let Z = this._batchersByInstructionSet[Q.uid];
        for (let $ in Z) {
            let q = Z[$]
                , K = q.geometry;
            if (q.dirty)
                q.dirty = !1,
                    K.buffers[0].update(q.attributeSize * 4)
        }
    }
    execute(Q) {
        if (Q.action === "startBatch") {
            let Z = Q.batcher
                , $ = Z.geometry
                , q = Z.shader;
            this._adaptor.start(this, $, q)
        }
        this._adaptor.execute(this, Q)
    }
    destroy() {
        this.state = null,
            this.renderer = null,
            this._adaptor = null;
        for (let Q in this._activeBatches)
            this._activeBatches[Q].destroy();
        this._activeBatches = null
    }
}
    , QW;
var Bj = O(() => {
    w0();
    q5();
    eV();
    NG.extension = {
        type: [R.WebGLPipes, R.WebGPUPipes, R.CanvasPipes],
        name: "batch"
    };
    NG._availableBatchers = Object.create(null);
    QW = NG;
    e0.handleByMap(R.Batcher, QW._availableBatchers);
    e0.add(L$)
}
);
var kj = `in vec2 vMaskCoord;
in vec2 vTextureCoord;

uniform sampler2D uTexture;
uniform sampler2D uMaskTexture;

uniform float uAlpha;
uniform vec4 uMaskClamp;
uniform float uInverse;

out vec4 finalColor;

void main(void)
{
    float clip = step(3.5,
        step(uMaskClamp.x, vMaskCoord.x) +
        step(uMaskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, uMaskClamp.z) +
        step(vMaskCoord.y, uMaskClamp.w));

    // TODO look into why this is needed
    float npmAlpha = uAlpha;
    vec4 original = texture(uTexture, vTextureCoord);
    vec4 masky = texture(uMaskTexture, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    float a = alphaMul * masky.r * npmAlpha * clip;

    if (uInverse == 1.0) {
        a = 1.0 - a;
    }

    finalColor = original * a;
}
`;
var Cj = () => { }
    ;
var Oj = `in vec2 aPosition;

out vec2 vTextureCoord;
out vec2 vMaskCoord;


uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;
uniform mat3 uFilterMatrix;

vec4 filterVertexPosition(  vec2 aPosition )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
       
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord(  vec2 aPosition )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

vec2 getFilterCoord( vec2 aPosition )
{
    return  ( uFilterMatrix * vec3( filterTextureCoord(aPosition), 1.0)  ).xy;
}   

void main(void)
{
    gl_Position = filterVertexPosition(aPosition);
    vTextureCoord = filterTextureCoord(aPosition);
    vMaskCoord = getFilterCoord(aPosition);
}
`;
var Ij = () => { }
    ;
var ZW = `struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct MaskUniforms {
  uFilterMatrix:mat3x3<f32>,
  uMaskClamp:vec4<f32>,
  uAlpha:f32,
  uInverse:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> filterUniforms : MaskUniforms;
@group(1) @binding(1) var uMaskTexture: texture_2d<f32>;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>,
    @location(1) filterUv : vec2<f32>,
};

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);
}

fn getFilterCoord(aPosition:vec2<f32> ) -> vec2<f32>
{
  return ( filterUniforms.uFilterMatrix * vec3( filterTextureCoord(aPosition), 1.0)  ).xy;
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}

@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>,
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition),
   getFilterCoord(aPosition)
  );
}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @location(1) filterUv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {

    var maskClamp = filterUniforms.uMaskClamp;
    var uAlpha = filterUniforms.uAlpha;

    var clip = step(3.5,
      step(maskClamp.x, filterUv.x) +
      step(maskClamp.y, filterUv.y) +
      step(filterUv.x, maskClamp.z) +
      step(filterUv.y, maskClamp.w));

    var mask = textureSample(uMaskTexture, uSampler, filterUv);
    var source = textureSample(uTexture, uSampler, uv);
    var alphaMul = 1.0 - uAlpha * (1.0 - mask.a);

    var a: f32 = alphaMul * mask.r * uAlpha * clip;

    if (filterUniforms.uInverse == 1.0) {
        a = 1.0 - a;
    }

    return source * a;
}
`;
var Lj = () => { }
    ;
var $W;
var Fj = O(() => {
    Z6();
    lJ();
    Z5();
    _7();
    PV();
    z9();
    Cj();
    Ij();
    Lj();
    $W = class $W extends _J {
        constructor(J) {
            let { sprite: Q, ...Z } = J
                , $ = new W$(Q.texture)
                , q = new Y6({
                    uFilterMatrix: {
                        value: new f0,
                        type: "mat3x3<f32>"
                    },
                    uMaskClamp: {
                        value: $.uClampFrame,
                        type: "vec4<f32>"
                    },
                    uAlpha: {
                        value: 1,
                        type: "f32"
                    },
                    uInverse: {
                        value: J.inverse ? 1 : 0,
                        type: "f32"
                    }
                })
                , K = B7.from({
                    vertex: {
                        source: ZW,
                        entryPoint: "mainVertex"
                    },
                    fragment: {
                        source: ZW,
                        entryPoint: "mainFragment"
                    }
                })
                , V = j7.from({
                    vertex: Oj,
                    fragment: kj,
                    name: "mask-filter"
                });
            super({
                ...Z,
                gpuProgram: K,
                glProgram: V,
                clipToViewport: !1,
                resources: {
                    filterUniforms: q,
                    uMaskTexture: Q.texture.source
                }
            });
            this.sprite = Q,
                this._textureMatrix = $
        }
        set inverse(J) {
            this.resources.filterUniforms.uniforms.uInverse = J ? 1 : 0
        }
        get inverse() {
            return this.resources.filterUniforms.uniforms.uInverse === 1
        }
        apply(J, Q, Z, $) {
            this._textureMatrix.texture = this.sprite.texture,
                J.calculateSpriteMatrix(this.resources.filterUniforms.uniforms.uFilterMatrix, this.sprite).prepend(this._textureMatrix.mapCoord),
                this.resources.uMaskTexture = this.sprite.texture.source,
                J.applyFilter(this, Q, Z, $)
        }
    }
}
);
class JK {
    constructor(J) {
        this._activeMaskStage = [],
            this._renderer = J
    }
    push(J, Q, Z) {
        let $ = this._renderer;
        if ($.renderPipes.batch.break(Z),
            Z.add({
                renderPipeId: "alphaMask",
                action: "pushMaskBegin",
                mask: J,
                inverse: Q._maskOptions.inverse,
                canBundle: !1,
                maskedContainer: Q
            }),
            J.inverse = Q._maskOptions.inverse,
            J.renderMaskToTexture) {
            let q = J.mask;
            q.includeInBuild = !0,
                q.collectRenderables(Z, $, null),
                q.includeInBuild = !1
        }
        $.renderPipes.batch.break(Z),
            Z.add({
                renderPipeId: "alphaMask",
                action: "pushMaskEnd",
                mask: J,
                maskedContainer: Q,
                inverse: Q._maskOptions.inverse,
                canBundle: !1
            })
    }
    pop(J, Q, Z) {
        this._renderer.renderPipes.batch.break(Z),
            Z.add({
                renderPipeId: "alphaMask",
                action: "popMaskEnd",
                mask: J,
                inverse: Q._maskOptions.inverse,
                canBundle: !1
            })
    }
    execute(J) {
        let Q = this._renderer
            , Z = J.mask.renderMaskToTexture;
        if (J.action === "pushMaskBegin") {
            let $ = V7.get(__);
            if ($.inverse = J.inverse,
                Z) {
                J.mask.mask.measurable = !0;
                let q = D9(J.mask.mask, !0, Um);
                J.mask.mask.measurable = !1,
                    q.ceil();
                let K = Q.renderTarget.renderTarget.colorTexture.source
                    , V = m6.getOptimalTexture(q.width, q.height, K._resolution, K.antialias);
                Q.renderTarget.push(V, !0),
                    Q.globalUniforms.push({
                        offset: q,
                        worldColor: 4294967295
                    });
                let z = $.sprite;
                z.texture = V,
                    z.worldTransform.tx = q.minX,
                    z.worldTransform.ty = q.minY,
                    this._activeMaskStage.push({
                        filterEffect: $,
                        maskedContainer: J.maskedContainer,
                        filterTexture: V
                    })
            } else
                $.sprite = J.mask.mask,
                    this._activeMaskStage.push({
                        filterEffect: $,
                        maskedContainer: J.maskedContainer
                    })
        } else if (J.action === "pushMaskEnd") {
            let $ = this._activeMaskStage[this._activeMaskStage.length - 1];
            if (Z) {
                if (Q.type === W7.WEBGL)
                    Q.renderTarget.finishRenderPass();
                Q.renderTarget.pop(),
                    Q.globalUniforms.pop()
            }
            Q.filter.push({
                renderPipeId: "filter",
                action: "pushFilter",
                container: $.maskedContainer,
                filterEffect: $.filterEffect,
                canBundle: !1
            })
        } else if (J.action === "popMaskEnd") {
            Q.filter.pop();
            let $ = this._activeMaskStage.pop();
            if (Z)
                m6.returnTexture($.filterTexture);
            V7.return($.filterEffect)
        }
    }
    destroy() {
        this._renderer = null,
            this._activeMaskStage = null
    }
}
var Um, __;
var Gj = O(() => {
    w0();
    x1();
    Fj();
    VJ();
    aQ();
    kQ();
    s5();
    W6();
    E5();
    $5();
    Um = new E6;
    __ = class __ extends P9 {
        constructor() {
            super();
            this.filters = [new $W({
                sprite: new WJ(_0.EMPTY),
                inverse: !1,
                resolution: "inherit",
                antialias: "inherit"
            })]
        }
        get sprite() {
            return this.filters[0].sprite
        }
        set sprite(J) {
            this.filters[0].sprite = J
        }
        get inverse() {
            return this.filters[0].inverse
        }
        set inverse(J) {
            this.filters[0].inverse = J
        }
    }
        ;
    JK.extension = {
        type: [R.WebGLPipes, R.WebGPUPipes, R.CanvasPipes],
        name: "alphaMask"
    }
}
);
class QK {
    constructor(J) {
        this._colorStack = [],
            this._colorStackIndex = 0,
            this._currentColor = 0,
            this._renderer = J
    }
    buildStart() {
        this._colorStack[0] = 15,
            this._colorStackIndex = 1,
            this._currentColor = 15
    }
    push(J, Q, Z) {
        this._renderer.renderPipes.batch.break(Z);
        let q = this._colorStack;
        q[this._colorStackIndex] = q[this._colorStackIndex - 1] & J.mask;
        let K = this._colorStack[this._colorStackIndex];
        if (K !== this._currentColor)
            this._currentColor = K,
                Z.add({
                    renderPipeId: "colorMask",
                    colorMask: K,
                    canBundle: !1
                });
        this._colorStackIndex++
    }
    pop(J, Q, Z) {
        this._renderer.renderPipes.batch.break(Z);
        let q = this._colorStack;
        this._colorStackIndex--;
        let K = q[this._colorStackIndex - 1];
        if (K !== this._currentColor)
            this._currentColor = K,
                Z.add({
                    renderPipeId: "colorMask",
                    colorMask: K,
                    canBundle: !1
                })
    }
    execute(J) {
        this._renderer.colorMask.setMask(J.colorMask)
    }
    destroy() {
        this._colorStack = null
    }
}
var Pj = O(() => {
    w0();
    QK.extension = {
        type: [R.WebGLPipes, R.WebGPUPipes, R.CanvasPipes],
        name: "colorMask"
    }
}
);
class ZK {
    constructor(J) {
        this._maskStackHash = {},
            this._maskHash = new WeakMap,
            this._renderer = J
    }
    push(J, Q, Z) {
        var $;
        let q = J
            , K = this._renderer;
        K.renderPipes.batch.break(Z),
            K.renderPipes.blendMode.setBlendMode(q.mask, "none", Z),
            Z.add({
                renderPipeId: "stencilMask",
                action: "pushMaskBegin",
                mask: J,
                inverse: Q._maskOptions.inverse,
                canBundle: !1
            });
        let V = q.mask;
        if (V.includeInBuild = !0,
            !this._maskHash.has(q))
            this._maskHash.set(q, {
                instructionsStart: 0,
                instructionsLength: 0
            });
        let z = this._maskHash.get(q);
        z.instructionsStart = Z.instructionSize,
            V.collectRenderables(Z, K, null),
            V.includeInBuild = !1,
            K.renderPipes.batch.break(Z),
            Z.add({
                renderPipeId: "stencilMask",
                action: "pushMaskEnd",
                mask: J,
                inverse: Q._maskOptions.inverse,
                canBundle: !1
            });
        let W = Z.instructionSize - z.instructionsStart - 1;
        z.instructionsLength = W;
        let H = K.renderTarget.renderTarget.uid;
        ($ = this._maskStackHash)[H] ?? ($[H] = 0)
    }
    pop(J, Q, Z) {
        let $ = J
            , q = this._renderer;
        q.renderPipes.batch.break(Z),
            q.renderPipes.blendMode.setBlendMode($.mask, "none", Z),
            Z.add({
                renderPipeId: "stencilMask",
                action: "popMaskBegin",
                inverse: Q._maskOptions.inverse,
                canBundle: !1
            });
        let K = this._maskHash.get(J);
        for (let V = 0; V < K.instructionsLength; V++)
            Z.instructions[Z.instructionSize++] = Z.instructions[K.instructionsStart++];
        Z.add({
            renderPipeId: "stencilMask",
            action: "popMaskEnd",
            canBundle: !1
        })
    }
    execute(J) {
        var Q;
        let Z = this._renderer
            , $ = Z.renderTarget.renderTarget.uid
            , q = (Q = this._maskStackHash)[$] ?? (Q[$] = 0);
        if (J.action === "pushMaskBegin")
            Z.renderTarget.ensureDepthStencil(),
                Z.stencil.setStencilMode(Z7.RENDERING_MASK_ADD, q),
                q++,
                Z.colorMask.setMask(0);
        else if (J.action === "pushMaskEnd") {
            if (J.inverse)
                Z.stencil.setStencilMode(Z7.INVERSE_MASK_ACTIVE, q);
            else
                Z.stencil.setStencilMode(Z7.MASK_ACTIVE, q);
            Z.colorMask.setMask(15)
        } else if (J.action === "popMaskBegin") {
            if (Z.colorMask.setMask(0),
                q !== 0)
                Z.stencil.setStencilMode(Z7.RENDERING_MASK_REMOVE, q);
            else
                Z.renderTarget.clear(null, s7.STENCIL),
                    Z.stencil.setStencilMode(Z7.DISABLED, q);
            q--
        } else if (J.action === "popMaskEnd") {
            if (J.inverse)
                Z.stencil.setStencilMode(Z7.INVERSE_MASK_ACTIVE, q);
            else
                Z.stencil.setStencilMode(Z7.MASK_ACTIVE, q);
            Z.colorMask.setMask(15)
        }
        this._maskStackHash[$] = q
    }
    destroy() {
        this._renderer = null,
            this._maskStackHash = null,
            this._maskHash = null
    }
}
var Dj = O(() => {
    w0();
    MZ();
    OQ();
    ZK.extension = {
        type: [R.WebGLPipes, R.WebGPUPipes, R.CanvasPipes],
        name: "stencilMask"
    }
}
);
var wG = class J {
    constructor() {
        this.clearBeforeRender = !0,
            this._backgroundColor = new E8(0),
            this.color = this._backgroundColor,
            this.alpha = 1
    }
    init(Q) {
        Q = {
            ...J.defaultOptions,
            ...Q
        },
            this.clearBeforeRender = Q.clearBeforeRender,
            this.color = Q.background || Q.backgroundColor || this._backgroundColor,
            this.alpha = Q.backgroundAlpha,
            this._backgroundColor.setAlpha(Q.backgroundAlpha)
    }
    get color() {
        return this._backgroundColor
    }
    set color(Q) {
        if (E8.shared.setValue(Q).alpha < 1 && this._backgroundColor.alpha === 1)
            m0("Cannot set a transparent background on an opaque canvas. To enable transparency, set backgroundAlpha < 1 when initializing your Application.");
        this._backgroundColor.setValue(Q)
    }
    get alpha() {
        return this._backgroundColor.alpha
    }
    set alpha(Q) {
        this._backgroundColor.setAlpha(Q)
    }
    get colorRgba() {
        return this._backgroundColor.toArray()
    }
    destroy() { }
}
    , Aj;
var Ej = O(() => {
    T7();
    w0();
    B6();
    wG.extension = {
        type: [R.WebGLSystem, R.WebGPUSystem, R.CanvasSystem],
        name: "background",
        priority: 0
    };
    wG.defaultOptions = {
        backgroundAlpha: 1,
        backgroundColor: 0,
        clearBeforeRender: !0
    };
    Aj = wG
}
);
class $K {
    constructor(J) {
        this._isAdvanced = !1,
            this._filterHash = Object.create(null),
            this._renderer = J,
            this._renderer.runners.prerender.add(this)
    }
    prerender() {
        this._activeBlendMode = "normal",
            this._isAdvanced = !1
    }
    setBlendMode(J, Q, Z) {
        if (this._activeBlendMode === Q) {
            if (this._isAdvanced)
                this._renderableList.push(J);
            return
        }
        if (this._activeBlendMode = Q,
            this._isAdvanced)
            this._endAdvancedBlendMode(Z);
        if (this._isAdvanced = !!qW[Q],
            this._isAdvanced)
            this._beginAdvancedBlendMode(Z),
                this._renderableList.push(J)
    }
    _beginAdvancedBlendMode(J) {
        this._renderer.renderPipes.batch.break(J);
        let Q = this._activeBlendMode;
        if (!qW[Q]) {
            m0(`Unable to assign BlendMode: '${Q}'. You may want to include: import 'pixi.js/advanced-blend-modes'`);
            return
        }
        let Z = this._filterHash[Q];
        if (!Z)
            Z = this._filterHash[Q] = new P9,
                Z.filters = [new qW[Q]];
        let $ = {
            renderPipeId: "filter",
            action: "pushFilter",
            renderables: [],
            filterEffect: Z,
            canBundle: !1
        };
        this._renderableList = $.renderables,
            J.add($)
    }
    _endAdvancedBlendMode(J) {
        this._renderableList = null,
            this._renderer.renderPipes.batch.break(J),
            J.add({
                renderPipeId: "filter",
                action: "popFilter",
                canBundle: !1
            })
    }
    buildStart() {
        this._isAdvanced = !1
    }
    buildEnd(J) {
        if (this._isAdvanced)
            this._endAdvancedBlendMode(J)
    }
    destroy() {
        this._renderer = null,
            this._renderableList = null;
        for (let J in this._filterHash)
            this._filterHash[J].destroy();
        this._filterHash = null
    }
}
var qW;
var Mj = O(() => {
    w0();
    x1();
    B6();
    qW = {};
    e0.handle(R.BlendMode, (J) => {
        if (!J.name)
            throw new Error("BlendMode extension must have a name property");
        qW[J.name] = J.ref
    }
        , (J) => {
            delete qW[J.name]
        }
    );
    $K.extension = {
        type: [R.WebGLPipes, R.WebGPUPipes, R.CanvasPipes],
        name: "blendMode"
    }
}
);
var jG, BG = class J {
    constructor(Q) {
        this._renderer = Q
    }
    _normalizeOptions(Q, Z = {}) {
        if (Q instanceof m8 || Q instanceof _0)
            return {
                target: Q,
                ...Z
            };
        return {
            ...Z,
            ...Q
        }
    }
    async image(Q) {
        let Z = a0.get().createImage();
        return Z.src = await this.base64(Q),
            Z
    }
    async base64(Q) {
        Q = this._normalizeOptions(Q, J.defaultImageOptions);
        let { format: Z, quality: $ } = Q
            , q = this.canvas(Q);
        if (q.toBlob !== void 0)
            return new Promise((K, V) => {
                q.toBlob((z) => {
                    if (!z) {
                        V(new Error("ICanvas.toBlob failed!"));
                        return
                    }
                    let W = new FileReader;
                    W.onload = () => K(W.result),
                        W.onerror = V,
                        W.readAsDataURL(z)
                }
                    , jG[Z], $)
            }
            );
        if (q.toDataURL !== void 0)
            return q.toDataURL(jG[Z], $);
        if (q.convertToBlob !== void 0) {
            let K = await q.convertToBlob({
                type: jG[Z],
                quality: $
            });
            return new Promise((V, z) => {
                let W = new FileReader;
                W.onload = () => V(W.result),
                    W.onerror = z,
                    W.readAsDataURL(K)
            }
            )
        }
        throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")
    }
    canvas(Q) {
        Q = this._normalizeOptions(Q);
        let Z = Q.target
            , $ = this._renderer;
        if (Z instanceof _0)
            return $.texture.generateCanvas(Z);
        let q = $.textureGenerator.generateTexture(Q)
            , K = $.texture.generateCanvas(q);
        return q.destroy(!0),
            K
    }
    pixels(Q) {
        Q = this._normalizeOptions(Q);
        let Z = Q.target
            , $ = this._renderer
            , q = Z instanceof _0 ? Z : $.textureGenerator.generateTexture(Q)
            , K = $.texture.getPixels(q);
        if (Z instanceof m8)
            q.destroy(!0);
        return K
    }
    texture(Q) {
        if (Q = this._normalizeOptions(Q),
            Q.target instanceof _0)
            return Q.target;
        return this._renderer.textureGenerator.generateTexture(Q)
    }
    download(Q) {
        Q = this._normalizeOptions(Q);
        let Z = this.canvas(Q)
            , $ = document.createElement("a");
        $.download = Q.filename ?? "image.png",
            $.href = Z.toDataURL("image/png"),
            document.body.appendChild($),
            $.click(),
            document.body.removeChild($)
    }
    log(Q) {
        let Z = Q.width ?? 200;
        Q = this._normalizeOptions(Q);
        let q = this.canvas(Q).toDataURL()
            , K = ["font-size: 1px;", `padding: ${Z}px 300px;`, `background: url(${q}) no-repeat;`, "background-size: contain;"].join(" ")
    }
    destroy() {
        this._renderer = null
    }
}
    , _j;
var Rj = O(() => {
    M6();
    w0();
    zJ();
    W6();
    jG = {
        png: "image/png",
        jpg: "image/jpeg",
        webp: "image/webp"
    };
    BG.extension = {
        type: [R.WebGLSystem, R.WebGPUSystem],
        name: "extract"
    };
    BG.defaultImageOptions = {
        format: "png",
        quality: 1
    };
    _j = BG
}
);
var qK;
var bj = O(() => {
    n7();
    W6();
    qK = class qK extends _0 {
        static create(J) {
            return new qK({
                source: new $6(J)
            })
        }
        resize(J, Q, Z) {
            return this.source.resize(J, Q, Z),
                this
        }
    }
}
);
class KK {
    constructor(J) {
        this._renderer = J
    }
    generateTexture(J) {
        if (J instanceof m8)
            J = {
                target: J,
                frame: void 0,
                textureSourceOptions: {},
                resolution: void 0
            };
        let Q = J.resolution || this._renderer.resolution
            , Z = J.antialias || this._renderer.view.antialias
            , $ = J.target
            , q = J.clearColor;
        if (q)
            q = Array.isArray(q) && q.length === 4 ? q : E8.shared.setValue(q).toArray();
        else
            q = jm;
        let K = J.frame?.copyTo(Nm) || tQ($, wm).rectangle;
        K.width = Math.max(K.width, 1 / Q) | 0,
            K.height = Math.max(K.height, 1 / Q) | 0;
        let V = qK.create({
            ...J.textureSourceOptions,
            width: K.width,
            height: K.height,
            resolution: Q,
            antialias: Z
        })
            , z = f0.shared.translate(-K.x, -K.y);
        return this._renderer.render({
            container: $,
            transform: z,
            target: V,
            clearColor: q
        }),
            V.source.updateMipmaps(),
            V
    }
    destroy() {
        this._renderer = null
    }
}
var Nm, wm, jm;
var vj = O(() => {
    T7();
    w0();
    Z6();
    E7();
    VJ();
    d1();
    zJ();
    bj();
    Nm = new v8,
        wm = new E6,
        jm = [0, 0, 0, 0];
    KK.extension = {
        type: [R.WebGLSystem, R.WebGPUSystem],
        name: "textureGenerator"
    }
}
);
class VK {
    constructor(J) {
        this._stackIndex = 0,
            this._globalUniformDataStack = [],
            this._uniformsPool = [],
            this._activeUniforms = [],
            this._bindGroupPool = [],
            this._activeBindGroups = [],
            this._renderer = J
    }
    reset() {
        this._stackIndex = 0;
        for (let J = 0; J < this._activeUniforms.length; J++)
            this._uniformsPool.push(this._activeUniforms[J]);
        for (let J = 0; J < this._activeBindGroups.length; J++)
            this._bindGroupPool.push(this._activeBindGroups[J]);
        this._activeUniforms.length = 0,
            this._activeBindGroups.length = 0
    }
    start(J) {
        this.reset(),
            this.push(J)
    }
    bind({ size: J, projectionMatrix: Q, worldTransformMatrix: Z, worldColor: $, offset: q }) {
        let K = this._renderer.renderTarget.renderTarget
            , V = this._stackIndex ? this._globalUniformDataStack[this._stackIndex - 1] : {
                projectionData: K,
                worldTransformMatrix: new f0,
                worldColor: 4294967295,
                offset: new z6
            }
            , z = {
                projectionMatrix: Q || this._renderer.renderTarget.projectionMatrix,
                resolution: J || K.size,
                worldTransformMatrix: Z || V.worldTransformMatrix,
                worldColor: $ || V.worldColor,
                offset: q || V.offset,
                bindGroup: null
            }
            , W = this._uniformsPool.pop() || this._createUniforms();
        this._activeUniforms.push(W);
        let H = W.uniforms;
        H.uProjectionMatrix = z.projectionMatrix,
            H.uResolution = z.resolution,
            H.uWorldTransformMatrix.copyFrom(z.worldTransformMatrix),
            H.uWorldTransformMatrix.tx -= z.offset.x,
            H.uWorldTransformMatrix.ty -= z.offset.y,
            T5(z.worldColor, H.uWorldColorAlpha, 0),
            W.update();
        let Y;
        if (this._renderer.renderPipes.uniformBatch)
            Y = this._renderer.renderPipes.uniformBatch.getUniformBindGroup(W, !1);
        else
            Y = this._bindGroupPool.pop() || new QJ,
                this._activeBindGroups.push(Y),
                Y.setResource(W, 0);
        z.bindGroup = Y,
            this._currentGlobalUniformData = z
    }
    push(J) {
        this.bind(J),
            this._globalUniformDataStack[this._stackIndex++] = this._currentGlobalUniformData
    }
    pop() {
        if (this._currentGlobalUniformData = this._globalUniformDataStack[--this._stackIndex - 1],
            this._renderer.type === W7.WEBGL)
            this._currentGlobalUniformData.bindGroup.resources[0].update()
    }
    get bindGroup() {
        return this._currentGlobalUniformData.bindGroup
    }
    get globalUniformData() {
        return this._currentGlobalUniformData
    }
    get uniformGroup() {
        return this._currentGlobalUniformData.bindGroup.resources[0]
    }
    _createUniforms() {
        return new Y6({
            uProjectionMatrix: {
                value: new f0,
                type: "mat3x3<f32>"
            },
            uWorldTransformMatrix: {
                value: new f0,
                type: "mat3x3<f32>"
            },
            uWorldColorAlpha: {
                value: new Float32Array(4),
                type: "vec4<f32>"
            },
            uResolution: {
                value: [0, 0],
                type: "vec2<f32>"
            }
        }, {
            isStatic: !0
        })
    }
    destroy() {
        this._renderer = null
    }
}
var Sj = O(() => {
    w0();
    Z6();
    cJ();
    kZ();
    R9();
    $5();
    _7();
    VK.extension = {
        type: [R.WebGLSystem, R.WebGPUSystem, R.CanvasSystem],
        name: "globalUniforms"
    }
}
);
class zK {
    constructor() {
        this._tasks = [],
            this._offset = 0
    }
    init() {
        n6.system.add(this._update, this)
    }
    repeat(J, Q, Z = !0) {
        let $ = Bm++
            , q = 0;
        if (Z)
            this._offset += 1000,
                q = this._offset;
        return this._tasks.push({
            func: J,
            duration: Q,
            start: performance.now(),
            offset: q,
            last: performance.now(),
            repeat: !0,
            id: $
        }),
            $
    }
    cancel(J) {
        for (let Q = 0; Q < this._tasks.length; Q++)
            if (this._tasks[Q].id === J) {
                this._tasks.splice(Q, 1);
                return
            }
    }
    _update() {
        let J = performance.now();
        for (let Q = 0; Q < this._tasks.length; Q++) {
            let Z = this._tasks[Q];
            if (J - Z.offset - Z.last >= Z.duration) {
                let $ = J - Z.start;
                Z.func($),
                    Z.last = J
            }
        }
    }
    destroy() {
        n6.system.remove(this._update, this),
            this._tasks.length = 0
    }
}
var Bm = 1;
var Tj = O(() => {
    w0();
    E9();
    zK.extension = {
        type: [R.WebGLSystem, R.WebGPUSystem, R.CanvasSystem],
        name: "scheduler",
        priority: 0
    }
}
);
function yj(J) {
    if (R_)
        return;
    if (a0.get().getNavigator().userAgent.toLowerCase().indexOf("chrome") > -1) {
        let Q = [`%c  %c  %c  %c  %c PixiJS %c v${_Z} (${J}) http://www.pixijs.com/

`, "background: #E72264; padding:5px 0;", "background: #6CA2EA; padding:5px 0;", "background: #B5D33D; padding:5px 0;", "background: #FED23F; padding:5px 0;", "color: #FFFFFF; background: #E72264; padding:5px 0;", "color: #E72264; background: #FFFFFF; padding:5px 0;"];
        globalThis.console.log(...Q)
    } else if (globalThis.console)
        globalThis.console.log(`PixiJS ${_Z} - ${J} - http://www.pixijs.com/`);
    R_ = !0
}
var R_ = !1;
var fj = O(() => {
    M6();
    ez()
}
);
class h$ {
    constructor(J) {
        this._renderer = J
    }
    init(J) {
        if (J.hello) {
            let Q = this._renderer.name;
            if (this._renderer.type === W7.WEBGL)
                Q += ` ${this._renderer.context.webGLVersion}`;
            yj(Q)
        }
    }
}
var hj = O(() => {
    w0();
    fj();
    $5();
    h$.extension = {
        type: [R.WebGLSystem, R.WebGPUSystem, R.CanvasSystem],
        name: "hello",
        priority: -2
    };
    h$.defaultOptions = {
        hello: !1
    }
}
);
function xj(J) {
    let Q = !1;
    for (let $ in J)
        if (J[$] == null) {
            Q = !0;
            break
        }
    if (!Q)
        return J;
    let Z = Object.create(null);
    for (let $ in J) {
        let q = J[$];
        if (q)
            Z[$] = q
    }
    return Z
}
function gj(J) {
    let Q = 0;
    for (let Z = 0; Z < J.length; Z++)
        if (J[Z] == null)
            Q++;
        else
            J[Z - Q] = J[Z];
    return J.length -= Q,
        J
}
var mj = () => { }
    ;
var km = 0, kG = class J {
    constructor(Q) {
        this._managedRenderables = [],
            this._managedHashes = [],
            this._managedArrays = [],
            this._renderer = Q
    }
    init(Q) {
        Q = {
            ...J.defaultOptions,
            ...Q
        },
            this.maxUnusedTime = Q.renderableGCMaxUnusedTime,
            this._frequency = Q.renderableGCFrequency,
            this.enabled = Q.renderableGCActive
    }
    get enabled() {
        return !!this._handler
    }
    set enabled(Q) {
        if (this.enabled === Q)
            return;
        if (Q)
            this._handler = this._renderer.scheduler.repeat(() => this.run(), this._frequency, !1),
                this._hashHandler = this._renderer.scheduler.repeat(() => {
                    for (let Z of this._managedHashes)
                        Z.context[Z.hash] = xj(Z.context[Z.hash])
                }
                    , this._frequency),
                this._arrayHandler = this._renderer.scheduler.repeat(() => {
                    for (let Z of this._managedArrays)
                        gj(Z.context[Z.hash])
                }
                    , this._frequency);
        else
            this._renderer.scheduler.cancel(this._handler),
                this._renderer.scheduler.cancel(this._hashHandler),
                this._renderer.scheduler.cancel(this._arrayHandler)
    }
    addManagedHash(Q, Z) {
        this._managedHashes.push({
            context: Q,
            hash: Z
        })
    }
    addManagedArray(Q, Z) {
        this._managedArrays.push({
            context: Q,
            hash: Z
        })
    }
    prerender({ container: Q }) {
        this._now = performance.now(),
            Q.renderGroup.gcTick = km++,
            this._updateInstructionGCTick(Q.renderGroup, Q.renderGroup.gcTick)
    }
    addRenderable(Q) {
        if (!this.enabled)
            return;
        if (Q._lastUsed === -1)
            this._managedRenderables.push(Q),
                Q.once("destroyed", this._removeRenderable, this);
        Q._lastUsed = this._now
    }
    run() {
        let Q = this._now
            , Z = this._managedRenderables
            , $ = this._renderer.renderPipes
            , q = 0;
        for (let K = 0; K < Z.length; K++) {
            let V = Z[K];
            if (V === null) {
                q++;
                continue
            }
            let z = V.renderGroup ?? V.parentRenderGroup
                , W = z?.instructionSet?.gcTick ?? -1;
            if ((z?.gcTick ?? 0) === W)
                V._lastUsed = Q;
            if (Q - V._lastUsed > this.maxUnusedTime) {
                if (!V.destroyed) {
                    let H = $;
                    if (z)
                        z.structureDidChange = !0;
                    H[V.renderPipeId].destroyRenderable(V)
                }
                V._lastUsed = -1,
                    q++,
                    V.off("destroyed", this._removeRenderable, this)
            } else
                Z[K - q] = V
        }
        Z.length -= q
    }
    destroy() {
        this.enabled = !1,
            this._renderer = null,
            this._managedRenderables.length = 0,
            this._managedHashes.length = 0,
            this._managedArrays.length = 0
    }
    _removeRenderable(Q) {
        let Z = this._managedRenderables.indexOf(Q);
        if (Z >= 0)
            Q.off("destroyed", this._removeRenderable, this),
                this._managedRenderables[Z] = null
    }
    _updateInstructionGCTick(Q, Z) {
        Q.instructionSet.gcTick = Z;
        for (let $ of Q.renderGroupChildren)
            this._updateInstructionGCTick($, Z)
    }
}
    , cj;
var dj = O(() => {
    w0();
    mj();
    kG.extension = {
        type: [R.WebGLSystem, R.WebGPUSystem],
        name: "renderableGC",
        priority: 0
    };
    kG.defaultOptions = {
        renderableGCActive: !0,
        renderableGCMaxUnusedTime: 60000,
        renderableGCFrequency: 30000
    };
    cj = kG
}
);
var CG = class J {
    constructor(Q) {
        this._renderer = Q,
            this.count = 0,
            this.checkCount = 0
    }
    init(Q) {
        Q = {
            ...J.defaultOptions,
            ...Q
        },
            this.checkCountMax = Q.textureGCCheckCountMax,
            this.maxIdle = Q.textureGCAMaxIdle ?? Q.textureGCMaxIdle,
            this.active = Q.textureGCActive
    }
    postrender() {
        if (!this._renderer.renderingToScreen)
            return;
        if (this.count++,
            !this.active)
            return;
        if (this.checkCount++,
            this.checkCount > this.checkCountMax)
            this.checkCount = 0,
                this.run()
    }
    run() {
        let Q = this._renderer.texture.managedTextures;
        for (let Z = 0; Z < Q.length; Z++) {
            let $ = Q[Z];
            if ($.autoGarbageCollect && $.resource && $._touched > -1 && this.count - $._touched > this.maxIdle)
                $._touched = -1,
                    $.unload()
        }
    }
    destroy() {
        this._renderer = null
    }
}
    , pj;
var uj = O(() => {
    w0();
    CG.extension = {
        type: [R.WebGLSystem, R.WebGPUSystem],
        name: "textureGC"
    };
    CG.defaultOptions = {
        textureGCActive: !0,
        textureGCAMaxIdle: null,
        textureGCMaxIdle: 3600,
        textureGCCheckCountMax: 600
    };
    pj = CG
}
);
var b_ = class J {
    constructor(Q = {}) {
        if (this.uid = i8("renderTarget"),
            this.colorTextures = [],
            this.dirtyId = 0,
            this.isRoot = !1,
            this._size = new Float32Array(2),
            this._managedColorTextures = !1,
            Q = {
                ...J.defaultOptions,
                ...Q
            },
            this.stencil = Q.stencil,
            this.depth = Q.depth,
            this.isRoot = Q.isRoot,
            typeof Q.colorTextures === "number") {
            this._managedColorTextures = !0;
            for (let Z = 0; Z < Q.colorTextures; Z++)
                this.colorTextures.push(new $6({
                    width: Q.width,
                    height: Q.height,
                    resolution: Q.resolution,
                    antialias: Q.antialias
                }))
        } else {
            this.colorTextures = [...Q.colorTextures.map(($) => $.source)];
            let Z = this.colorTexture.source;
            this.resize(Z.width, Z.height, Z._resolution)
        }
        if (this.colorTexture.source.on("resize", this.onSourceResize, this),
            Q.depthStencilTexture || this.stencil)
            if (Q.depthStencilTexture instanceof _0 || Q.depthStencilTexture instanceof $6)
                this.depthStencilTexture = Q.depthStencilTexture.source;
            else
                this.ensureDepthStencilTexture()
    }
    get size() {
        let Q = this._size;
        return Q[0] = this.pixelWidth,
            Q[1] = this.pixelHeight,
            Q
    }
    get width() {
        return this.colorTexture.source.width
    }
    get height() {
        return this.colorTexture.source.height
    }
    get pixelWidth() {
        return this.colorTexture.source.pixelWidth
    }
    get pixelHeight() {
        return this.colorTexture.source.pixelHeight
    }
    get resolution() {
        return this.colorTexture.source._resolution
    }
    get colorTexture() {
        return this.colorTextures[0]
    }
    onSourceResize(Q) {
        this.resize(Q.width, Q.height, Q._resolution, !0)
    }
    ensureDepthStencilTexture() {
        if (!this.depthStencilTexture)
            this.depthStencilTexture = new $6({
                width: this.width,
                height: this.height,
                resolution: this.resolution,
                format: "depth24plus-stencil8",
                autoGenerateMipmaps: !1,
                antialias: !1,
                mipLevelCount: 1
            })
    }
    resize(Q, Z, $ = this.resolution, q = !1) {
        if (this.dirtyId++,
            this.colorTextures.forEach((K, V) => {
                if (q && V === 0)
                    return;
                K.source.resize(Q, Z, $)
            }
            ),
            this.depthStencilTexture)
            this.depthStencilTexture.source.resize(Q, Z, $)
    }
    destroy() {
        if (this.colorTexture.source.off("resize", this.onSourceResize, this),
            this._managedColorTextures)
            this.colorTextures.forEach((Q) => {
                Q.destroy()
            }
            );
        if (this.depthStencilTexture)
            this.depthStencilTexture.destroy(),
                delete this.depthStencilTexture
    }
}
    , x$;
var KW = O(() => {
    l7();
    n7();
    W6();
    b_.defaultOptions = {
        width: 0,
        height: 0,
        resolution: 1,
        colorTextures: 1,
        stencil: !1,
        depth: !1,
        antialias: !1,
        isRoot: !1
    };
    x$ = b_
}
);
function WK(J, Q) {
    if (!VW.has(J)) {
        let Z = new _0({
            source: new kJ({
                resource: J,
                ...Q
            })
        })
            , $ = () => {
                if (VW.get(J) === Z)
                    VW.delete(J)
            }
            ;
        Z.once("destroy", $),
            Z.source.once("destroy", $),
            VW.set(J, Z)
    }
    return VW.get(J)
}
var VW;
var zW = O(() => {
    $Z();
    W6();
    VW = new Map
}
);
var OG = class J {
    get autoDensity() {
        return this.texture.source.autoDensity
    }
    set autoDensity(Q) {
        this.texture.source.autoDensity = Q
    }
    get resolution() {
        return this.texture.source._resolution
    }
    set resolution(Q) {
        this.texture.source.resize(this.texture.source.width, this.texture.source.height, Q)
    }
    init(Q) {
        if (Q = {
            ...J.defaultOptions,
            ...Q
        },
            Q.view)
            c0(Y8, "ViewSystem.view has been renamed to ViewSystem.canvas"),
                Q.canvas = Q.view;
        this.screen = new v8(0, 0, Q.width, Q.height),
            this.canvas = Q.canvas || a0.get().createCanvas(),
            this.antialias = !!Q.antialias,
            this.texture = WK(this.canvas, Q),
            this.renderTarget = new x$({
                colorTextures: [this.texture],
                depth: !!Q.depth,
                isRoot: !0
            }),
            this.texture.source.transparent = Q.backgroundAlpha < 1,
            this.resolution = Q.resolution
    }
    resize(Q, Z, $) {
        this.texture.source.resize(Q, Z, $),
            this.screen.width = this.texture.frame.width,
            this.screen.height = this.texture.frame.height
    }
    destroy(Q = !1) {
        if ((typeof Q === "boolean" ? Q : !!Q?.removeView) && this.canvas.parentNode)
            this.canvas.parentNode.removeChild(this.canvas)
    }
}
    , lj;
var oj = O(() => {
    M6();
    w0();
    E7();
    O6();
    KW();
    zW();
    OG.extension = {
        type: [R.WebGLSystem, R.WebGPUSystem, R.CanvasSystem],
        name: "view",
        priority: 0
    };
    OG.defaultOptions = {
        width: 800,
        height: 600,
        autoDensity: !1,
        antialias: !1
    };
    lj = OG
}
);
var HK, YK;
var WW = O(() => {
    Wj();
    Hj();
    wj();
    jj();
    JW();
    Bj();
    Gj();
    Pj();
    Dj();
    Ej();
    Mj();
    Rj();
    vj();
    Sj();
    Tj();
    hj();
    dj();
    uj();
    oj();
    HK = [Aj, VK, h$, lj, aq, pj, KK, _j, eq, cj, zK],
        YK = [$K, QW, rq, iq, JK, ZK, QK, sq]
}
);
class XK {
    constructor(J) {
        this._hash = Object.create(null),
            this._renderer = J,
            this._renderer.renderableGC.addManagedHash(this, "_hash")
    }
    contextChange(J) {
        this._gpu = J
    }
    getBindGroup(J, Q, Z) {
        return J._updateKey(),
            this._hash[J._key] || this._createBindGroup(J, Q, Z)
    }
    _createBindGroup(J, Q, Z) {
        let $ = this._gpu.device
            , q = Q.layout[Z]
            , K = []
            , V = this._renderer;
        for (let H in q) {
            let Y = J.resources[H] ?? J.resources[q[H]], U;
            if (Y._resourceType === "uniformGroup") {
                let N = Y;
                V.ubo.updateUniformGroup(N);
                let j = N.buffer;
                U = {
                    buffer: V.buffer.getGPUBuffer(j),
                    offset: 0,
                    size: j.descriptor.size
                }
            } else if (Y._resourceType === "buffer") {
                let N = Y;
                U = {
                    buffer: V.buffer.getGPUBuffer(N),
                    offset: 0,
                    size: N.descriptor.size
                }
            } else if (Y._resourceType === "bufferResource") {
                let N = Y;
                U = {
                    buffer: V.buffer.getGPUBuffer(N.buffer),
                    offset: N.offset,
                    size: N.size
                }
            } else if (Y._resourceType === "textureSampler") {
                let N = Y;
                U = V.texture.getGpuSampler(N)
            } else if (Y._resourceType === "textureSource") {
                let N = Y;
                U = V.texture.getGpuSource(N).createView({})
            }
            K.push({
                binding: q[H],
                resource: U
            })
        }
        let z = V.shader.getProgramData(Q).bindGroups[Z]
            , W = $.createBindGroup({
                layout: z,
                entries: K
            });
        return this._hash[J._key] = W,
            W
    }
    destroy() {
        for (let J of Object.keys(this._hash))
            this._hash[J] = null;
        this._hash = null,
            this._renderer = null
    }
}
var nj = O(() => {
    w0();
    XK.extension = {
        type: [R.WebGPUSystem],
        name: "bindGroup"
    }
}
);
class UK {
    constructor(J) {
        this._gpuBuffers = Object.create(null),
            this._managedBuffers = [],
            J.renderableGC.addManagedHash(this, "_gpuBuffers")
    }
    contextChange(J) {
        this._gpu = J
    }
    getGPUBuffer(J) {
        return this._gpuBuffers[J.uid] || this.createGPUBuffer(J)
    }
    updateBuffer(J) {
        let Q = this._gpuBuffers[J.uid] || this.createGPUBuffer(J)
            , Z = J.data;
        if (J._updateID && Z)
            J._updateID = 0,
                this._gpu.device.queue.writeBuffer(Q, 0, Z.buffer, 0, (J._updateSize || Z.byteLength) + 3 & -4);
        return Q
    }
    destroyAll() {
        for (let J in this._gpuBuffers)
            this._gpuBuffers[J].destroy();
        this._gpuBuffers = {}
    }
    createGPUBuffer(J) {
        if (!this._gpuBuffers[J.uid])
            J.on("update", this.updateBuffer, this),
                J.on("change", this.onBufferChange, this),
                J.on("destroy", this.onBufferDestroy, this),
                this._managedBuffers.push(J);
        let Q = this._gpu.device.createBuffer(J.descriptor);
        if (J._updateID = 0,
            J.data)
            B$(J.data.buffer, Q.getMappedRange()),
                Q.unmap();
        return this._gpuBuffers[J.uid] = Q,
            Q
    }
    onBufferChange(J) {
        this._gpuBuffers[J.uid].destroy(),
            J._updateID = 0,
            this._gpuBuffers[J.uid] = this.createGPUBuffer(J)
    }
    onBufferDestroy(J) {
        this._managedBuffers.splice(this._managedBuffers.indexOf(J), 1),
            this._destroyBuffer(J)
    }
    destroy() {
        this._managedBuffers.forEach((J) => this._destroyBuffer(J)),
            this._managedBuffers = null,
            this._gpuBuffers = null
    }
    _destroyBuffer(J) {
        this._gpuBuffers[J.uid].destroy(),
            J.off("update", this.updateBuffer, this),
            J.off("change", this.onBufferChange, this),
            J.off("destroy", this.onBufferDestroy, this),
            this._gpuBuffers[J.uid] = null
    }
}
var sj = O(() => {
    w0();
    mV();
    UK.extension = {
        type: [R.WebGPUSystem],
        name: "buffer"
    }
}
);
class NK {
    constructor(J) {
        this._colorMaskCache = 15,
            this._renderer = J
    }
    setMask(J) {
        if (this._colorMaskCache === J)
            return;
        this._colorMaskCache = J,
            this._renderer.pipeline.setColorMask(J)
    }
    destroy() {
        this._renderer = null,
            this._colorMaskCache = null
    }
}
var ij = O(() => {
    w0();
    NK.extension = {
        type: [R.WebGPUSystem],
        name: "colorMask"
    }
}
);
class g$ {
    constructor(J) {
        this._renderer = J
    }
    async init(J) {
        if (this._initPromise)
            return this._initPromise;
        return this._initPromise = (J.gpu ? Promise.resolve(J.gpu) : this._createDeviceAndAdaptor(J)).then((Q) => {
            this.gpu = Q,
                this._renderer.runners.contextChange.emit(this.gpu)
        }
        ),
            this._initPromise
    }
    contextChange(J) {
        this._renderer.gpu = J
    }
    async _createDeviceAndAdaptor(J) {
        let Q = await a0.get().getNavigator().gpu.requestAdapter({
            powerPreference: J.powerPreference,
            forceFallbackAdapter: J.forceFallbackAdapter
        })
            , Z = ["texture-compression-bc", "texture-compression-astc", "texture-compression-etc2"].filter((q) => Q.features.has(q))
            , $ = await Q.requestDevice({
                requiredFeatures: Z
            });
        return {
            adapter: Q,
            device: $
        }
    }
    destroy() {
        this.gpu = null,
            this._renderer = null
    }
}
var aj = O(() => {
    M6();
    w0();
    g$.extension = {
        type: [R.WebGPUSystem],
        name: "device"
    };
    g$.defaultOptions = {
        powerPreference: void 0,
        forceFallbackAdapter: !1
    }
}
);
class wK {
    constructor(J) {
        this._boundBindGroup = Object.create(null),
            this._boundVertexBuffer = Object.create(null),
            this._renderer = J
    }
    renderStart() {
        this.commandFinished = new Promise((J) => {
            this._resolveCommandFinished = J
        }
        ),
            this.commandEncoder = this._renderer.gpu.device.createCommandEncoder()
    }
    beginRenderPass(J) {
        this.endRenderPass(),
            this._clearCache(),
            this.renderPassEncoder = this.commandEncoder.beginRenderPass(J.descriptor)
    }
    endRenderPass() {
        if (this.renderPassEncoder)
            this.renderPassEncoder.end();
        this.renderPassEncoder = null
    }
    setViewport(J) {
        this.renderPassEncoder.setViewport(J.x, J.y, J.width, J.height, 0, 1)
    }
    setPipelineFromGeometryProgramAndState(J, Q, Z, $) {
        let q = this._renderer.pipeline.getPipeline(J, Q, Z, $);
        this.setPipeline(q)
    }
    setPipeline(J) {
        if (this._boundPipeline === J)
            return;
        this._boundPipeline = J,
            this.renderPassEncoder.setPipeline(J)
    }
    _setVertexBuffer(J, Q) {
        if (this._boundVertexBuffer[J] === Q)
            return;
        this._boundVertexBuffer[J] = Q,
            this.renderPassEncoder.setVertexBuffer(J, this._renderer.buffer.updateBuffer(Q))
    }
    _setIndexBuffer(J) {
        if (this._boundIndexBuffer === J)
            return;
        this._boundIndexBuffer = J;
        let Q = J.data.BYTES_PER_ELEMENT === 2 ? "uint16" : "uint32";
        this.renderPassEncoder.setIndexBuffer(this._renderer.buffer.updateBuffer(J), Q)
    }
    resetBindGroup(J) {
        this._boundBindGroup[J] = null
    }
    setBindGroup(J, Q, Z) {
        if (this._boundBindGroup[J] === Q)
            return;
        this._boundBindGroup[J] = Q,
            Q._touch(this._renderer.textureGC.count);
        let $ = this._renderer.bindGroup.getBindGroup(Q, Z, J);
        this.renderPassEncoder.setBindGroup(J, $)
    }
    setGeometry(J, Q) {
        let Z = this._renderer.pipeline.getBufferNamesToBind(J, Q);
        for (let $ in Z)
            this._setVertexBuffer($, J.attributes[Z[$]].buffer);
        if (J.indexBuffer)
            this._setIndexBuffer(J.indexBuffer)
    }
    _setShaderBindGroups(J, Q) {
        for (let Z in J.groups) {
            let $ = J.groups[Z];
            if (!Q)
                this._syncBindGroup($);
            this.setBindGroup(Z, $, J.gpuProgram)
        }
    }
    _syncBindGroup(J) {
        for (let Q in J.resources) {
            let Z = J.resources[Q];
            if (Z.isUniformGroup)
                this._renderer.ubo.updateUniformGroup(Z)
        }
    }
    draw(J) {
        let { geometry: Q, shader: Z, state: $, topology: q, size: K, start: V, instanceCount: z, skipSync: W } = J;
        if (this.setPipelineFromGeometryProgramAndState(Q, Z.gpuProgram, $, q),
            this.setGeometry(Q, Z.gpuProgram),
            this._setShaderBindGroups(Z, W),
            Q.indexBuffer)
            this.renderPassEncoder.drawIndexed(K || Q.indexBuffer.data.length, z ?? Q.instanceCount, V || 0);
        else
            this.renderPassEncoder.draw(K || Q.getSize(), z ?? Q.instanceCount, V || 0)
    }
    finishRenderPass() {
        if (this.renderPassEncoder)
            this.renderPassEncoder.end(),
                this.renderPassEncoder = null
    }
    postrender() {
        this.finishRenderPass(),
            this._gpu.device.queue.submit([this.commandEncoder.finish()]),
            this._resolveCommandFinished(),
            this.commandEncoder = null
    }
    restoreRenderPass() {
        let J = this._renderer.renderTarget.adaptor.getDescriptor(this._renderer.renderTarget.renderTarget, !1, [0, 0, 0, 1]);
        this.renderPassEncoder = this.commandEncoder.beginRenderPass(J);
        let Q = this._boundPipeline
            , Z = {
                ...this._boundVertexBuffer
            }
            , $ = this._boundIndexBuffer
            , q = {
                ...this._boundBindGroup
            };
        this._clearCache();
        let K = this._renderer.renderTarget.viewport;
        this.renderPassEncoder.setViewport(K.x, K.y, K.width, K.height, 0, 1),
            this.setPipeline(Q);
        for (let V in Z)
            this._setVertexBuffer(V, Z[V]);
        for (let V in q)
            this.setBindGroup(V, q[V], null);
        this._setIndexBuffer($)
    }
    _clearCache() {
        for (let J = 0; J < 16; J++)
            this._boundBindGroup[J] = null,
                this._boundVertexBuffer[J] = null;
        this._boundIndexBuffer = null,
            this._boundPipeline = null
    }
    destroy() {
        this._renderer = null,
            this._gpu = null,
            this._boundBindGroup = null,
            this._boundVertexBuffer = null,
            this._boundIndexBuffer = null,
            this._boundPipeline = null
    }
    contextChange(J) {
        this._gpu = J
    }
}
var rj = O(() => {
    w0();
    wK.extension = {
        type: [R.WebGPUSystem],
        name: "encoder",
        priority: 1
    }
}
);
class jK {
    constructor(J) {
        this._renderer = J
    }
    contextChange() {
        this.maxTextures = this._renderer.device.gpu.device.limits.maxSampledTexturesPerShaderStage,
            this.maxBatchableTextures = this.maxTextures
    }
    destroy() { }
}
var tj = O(() => {
    w0();
    jK.extension = {
        type: [R.WebGPUSystem],
        name: "limits"
    }
}
);
class BK {
    constructor(J) {
        this._renderTargetStencilState = Object.create(null),
            this._renderer = J,
            J.renderTarget.onRenderTargetChange.add(this)
    }
    onRenderTargetChange(J) {
        let Q = this._renderTargetStencilState[J.uid];
        if (!Q)
            Q = this._renderTargetStencilState[J.uid] = {
                stencilMode: Z7.DISABLED,
                stencilReference: 0
            };
        this._activeRenderTarget = J,
            this.setStencilMode(Q.stencilMode, Q.stencilReference)
    }
    setStencilMode(J, Q) {
        let Z = this._renderTargetStencilState[this._activeRenderTarget.uid];
        Z.stencilMode = J,
            Z.stencilReference = Q;
        let $ = this._renderer;
        $.pipeline.setStencilMode(J),
            $.encoder.renderPassEncoder.setStencilReference(Q)
    }
    destroy() {
        this._renderer.renderTarget.onRenderTargetChange.remove(this),
            this._renderer = null,
            this._activeRenderTarget = null,
            this._renderTargetStencilState = null
    }
}
var ej = O(() => {
    w0();
    OQ();
    BK.extension = {
        type: [R.WebGPUSystem],
        name: "stencil"
    }
}
);
class m$ {
    constructor(J) {
        this._syncFunctionHash = Object.create(null),
            this._adaptor = J,
            this._systemCheck()
    }
    _systemCheck() {
        if (!uq())
            throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")
    }
    ensureUniformGroup(J) {
        let Q = this.getUniformGroupData(J);
        J.buffer || (J.buffer = new P7({
            data: new Float32Array(Q.layout.size / 4),
            usage: a8.UNIFORM | a8.COPY_DST
        }))
    }
    getUniformGroupData(J) {
        return this._syncFunctionHash[J._signature] || this._initUniformGroup(J)
    }
    _initUniformGroup(J) {
        let Q = J._signature
            , Z = this._syncFunctionHash[Q];
        if (!Z) {
            let $ = Object.keys(J.uniformStructures).map((V) => J.uniformStructures[V])
                , q = this._adaptor.createUboElements($)
                , K = this._generateUboSync(q.uboElements);
            Z = this._syncFunctionHash[Q] = {
                layout: q,
                syncFunction: K
            }
        }
        return this._syncFunctionHash[Q]
    }
    _generateUboSync(J) {
        return this._adaptor.generateUboSync(J)
    }
    syncUniformGroup(J, Q, Z) {
        let $ = this.getUniformGroupData(J);
        J.buffer || (J.buffer = new P7({
            data: new Float32Array($.layout.size / 4),
            usage: a8.UNIFORM | a8.COPY_DST
        }));
        let q = null;
        if (!Q)
            Q = J.buffer.data,
                q = J.buffer.dataInt32;
        return Z || (Z = 0),
            $.syncFunction(J.uniforms, Q, q, Z),
            !0
    }
    updateUniformGroup(J) {
        if (J.isStatic && !J._dirtyId)
            return !1;
        J._dirtyId = 0;
        let Q = this.syncUniformGroup(J);
        return J.buffer.update(),
            Q
    }
    destroy() {
        this._syncFunctionHash = null
    }
}
var HW = O(() => {
    nz();
    b9();
    Q9()
}
);
function JB(J) {
    let Q = J.map(($) => ({
        data: $,
        offset: 0,
        size: 0
    }))
        , Z = 0;
    for (let $ = 0; $ < Q.length; $++) {
        let q = Q[$]
            , K = c$[q.data.type].size
            , V = c$[q.data.type].align;
        if (!c$[q.data.type])
            throw new Error(`[Pixi.js] WebGPU UniformBuffer: Unknown type ${q.data.type}`);
        if (q.data.size > 1)
            K = Math.max(K, V) * q.data.size;
        Z = Math.ceil(Z / V) * V,
            q.size = K,
            q.offset = Z,
            Z += K
    }
    return Z = Math.ceil(Z / 16) * 16,
    {
        uboElements: Q,
        size: Z
    }
}
var c$;
var YW = O(() => {
    c$ = {
        i32: {
            align: 4,
            size: 4
        },
        u32: {
            align: 4,
            size: 4
        },
        f32: {
            align: 4,
            size: 4
        },
        f16: {
            align: 2,
            size: 2
        },
        "vec2<i32>": {
            align: 8,
            size: 8
        },
        "vec2<u32>": {
            align: 8,
            size: 8
        },
        "vec2<f32>": {
            align: 8,
            size: 8
        },
        "vec2<f16>": {
            align: 4,
            size: 4
        },
        "vec3<i32>": {
            align: 16,
            size: 12
        },
        "vec3<u32>": {
            align: 16,
            size: 12
        },
        "vec3<f32>": {
            align: 16,
            size: 12
        },
        "vec3<f16>": {
            align: 8,
            size: 6
        },
        "vec4<i32>": {
            align: 16,
            size: 16
        },
        "vec4<u32>": {
            align: 16,
            size: 16
        },
        "vec4<f32>": {
            align: 16,
            size: 16
        },
        "vec4<f16>": {
            align: 8,
            size: 8
        },
        "mat2x2<f32>": {
            align: 8,
            size: 16
        },
        "mat2x2<f16>": {
            align: 4,
            size: 8
        },
        "mat3x2<f32>": {
            align: 8,
            size: 24
        },
        "mat3x2<f16>": {
            align: 4,
            size: 12
        },
        "mat4x2<f32>": {
            align: 8,
            size: 32
        },
        "mat4x2<f16>": {
            align: 4,
            size: 16
        },
        "mat2x3<f32>": {
            align: 16,
            size: 32
        },
        "mat2x3<f16>": {
            align: 8,
            size: 16
        },
        "mat3x3<f32>": {
            align: 16,
            size: 48
        },
        "mat3x3<f16>": {
            align: 8,
            size: 24
        },
        "mat4x3<f32>": {
            align: 16,
            size: 64
        },
        "mat4x3<f16>": {
            align: 8,
            size: 32
        },
        "mat2x4<f32>": {
            align: 16,
            size: 32
        },
        "mat2x4<f16>": {
            align: 8,
            size: 16
        },
        "mat3x4<f32>": {
            align: 16,
            size: 48
        },
        "mat3x4<f16>": {
            align: 8,
            size: 24
        },
        "mat4x4<f32>": {
            align: 16,
            size: 64
        },
        "mat4x4<f16>": {
            align: 8,
            size: 32
        }
    }
}
);
var W9;
var XW = O(() => {
    W9 = [{
        type: "mat3x3<f32>",
        test: (J) => {
            return J.value.a !== void 0
        }
        ,
        ubo: `
            var matrix = uv[name].toArray(true);
            data[offset] = matrix[0];
            data[offset + 1] = matrix[1];
            data[offset + 2] = matrix[2];
            data[offset + 4] = matrix[3];
            data[offset + 5] = matrix[4];
            data[offset + 6] = matrix[5];
            data[offset + 8] = matrix[6];
            data[offset + 9] = matrix[7];
            data[offset + 10] = matrix[8];
        `,
        uniform: `
            gl.uniformMatrix3fv(ud[name].location, false, uv[name].toArray(true));
        `
    }, {
        type: "vec4<f32>",
        test: (J) => J.type === "vec4<f32>" && J.size === 1 && J.value.width !== void 0,
        ubo: `
            v = uv[name];
            data[offset] = v.x;
            data[offset + 1] = v.y;
            data[offset + 2] = v.width;
            data[offset + 3] = v.height;
        `,
        uniform: `
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height) {
                cv[0] = v.x;
                cv[1] = v.y;
                cv[2] = v.width;
                cv[3] = v.height;
                gl.uniform4f(ud[name].location, v.x, v.y, v.width, v.height);
            }
        `
    }, {
        type: "vec2<f32>",
        test: (J) => J.type === "vec2<f32>" && J.size === 1 && J.value.x !== void 0,
        ubo: `
            v = uv[name];
            data[offset] = v.x;
            data[offset + 1] = v.y;
        `,
        uniform: `
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.x || cv[1] !== v.y) {
                cv[0] = v.x;
                cv[1] = v.y;
                gl.uniform2f(ud[name].location, v.x, v.y);
            }
        `
    }, {
        type: "vec4<f32>",
        test: (J) => J.type === "vec4<f32>" && J.size === 1 && J.value.red !== void 0,
        ubo: `
            v = uv[name];
            data[offset] = v.red;
            data[offset + 1] = v.green;
            data[offset + 2] = v.blue;
            data[offset + 3] = v.alpha;
        `,
        uniform: `
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha) {
                cv[0] = v.red;
                cv[1] = v.green;
                cv[2] = v.blue;
                cv[3] = v.alpha;
                gl.uniform4f(ud[name].location, v.red, v.green, v.blue, v.alpha);
            }
        `
    }, {
        type: "vec3<f32>",
        test: (J) => J.type === "vec3<f32>" && J.size === 1 && J.value.red !== void 0,
        ubo: `
            v = uv[name];
            data[offset] = v.red;
            data[offset + 1] = v.green;
            data[offset + 2] = v.blue;
        `,
        uniform: `
            cv = ud[name].value;
            v = uv[name];
            if (cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue) {
                cv[0] = v.red;
                cv[1] = v.green;
                cv[2] = v.blue;
                gl.uniform3f(ud[name].location, v.red, v.green, v.blue);
            }
        `
    }]
}
);
function kK(J, Q, Z, $) {
    let q = [`
        var v = null;
        var v2 = null;
        var t = 0;
        var index = 0;
        var name = null;
        var arrayOffset = null;
    `]
        , K = 0;
    for (let z = 0; z < J.length; z++) {
        let W = J[z]
            , H = W.data.name
            , Y = !1
            , U = 0;
        for (let N = 0; N < W9.length; N++)
            if (W9[N].test(W.data)) {
                U = W.offset / 4,
                    q.push(`name = "${H}";`, `offset += ${U - K};`, W9[N][Q] || W9[N].ubo),
                    Y = !0;
                break
            }
        if (!Y)
            if (W.data.size > 1)
                U = W.offset / 4,
                    q.push(Z(W, U - K));
            else {
                let N = $[W.data.type];
                U = W.offset / 4,
                    q.push(`
                    v = uv.${H};
                    offset += ${U - K};
                    ${N};
                `)
            }
        K = U
    }
    let V = q.join(`
`);
    return new Function("uv", "data", "dataInt32", "offset", V)
}
var UW = O(() => {
    XW()
}
);
function CK(J, Q) {
    return `
        for (let i = 0; i < ${J * Q}; i++) {
            data[offset + (((i / ${J})|0) * 4) + (i % ${J})] = v[i];
        }
    `
}
var NW, QB;
var wW = O(() => {
    NW = {
        f32: `
        data[offset] = v;`,
        i32: `
        dataInt32[offset] = v;`,
        "vec2<f32>": `
        data[offset] = v[0];
        data[offset + 1] = v[1];`,
        "vec3<f32>": `
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];`,
        "vec4<f32>": `
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];
        data[offset + 3] = v[3];`,
        "vec2<i32>": `
        dataInt32[offset] = v[0];
        dataInt32[offset + 1] = v[1];`,
        "vec3<i32>": `
        dataInt32[offset] = v[0];
        dataInt32[offset + 1] = v[1];
        dataInt32[offset + 2] = v[2];`,
        "vec4<i32>": `
        dataInt32[offset] = v[0];
        dataInt32[offset + 1] = v[1];
        dataInt32[offset + 2] = v[2];
        dataInt32[offset + 3] = v[3];`,
        "mat2x2<f32>": `
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 4] = v[2];
        data[offset + 5] = v[3];`,
        "mat3x3<f32>": `
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];
        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];
        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];`,
        "mat4x4<f32>": `
        for (let i = 0; i < 16; i++) {
            data[offset + i] = v[i];
        }`,
        "mat3x2<f32>": CK(3, 2),
        "mat4x2<f32>": CK(4, 2),
        "mat2x3<f32>": CK(2, 3),
        "mat4x3<f32>": CK(4, 3),
        "mat2x4<f32>": CK(2, 4),
        "mat3x4<f32>": CK(3, 4)
    },
        QB = {
            ...NW,
            "mat2x2<f32>": `
        data[offset] = v[0];
        data[offset + 1] = v[1];
        data[offset + 2] = v[2];
        data[offset + 3] = v[3];
    `
        }
}
);
function ZB(J, Q) {
    let { size: Z, align: $ } = c$[J.data.type]
        , q = ($ - Z) / 4
        , K = J.data.type.indexOf("i32") >= 0 ? "dataInt32" : "data";
    return `
         v = uv.${J.data.name};
         ${Q !== 0 ? `offset += ${Q};` : ""}

         arrayOffset = offset;

         t = 0;

         for(var i=0; i < ${J.data.size * (Z / 4)}; i++)
         {
             for(var j = 0; j < ${Z / 4}; j++)
             {
                 ${K}[arrayOffset++] = v[t++];
             }
             ${q !== 0 ? `arrayOffset += ${q};` : ""}
         }
     `
}
var $B = O(() => {
    YW()
}
);
function qB(J) {
    return kK(J, "uboWgsl", ZB, QB)
}
var KB = O(() => {
    UW();
    wW();
    $B()
}
);
var OK;
var VB = O(() => {
    w0();
    HW();
    YW();
    KB();
    OK = class OK extends m$ {
        constructor() {
            super({
                createUboElements: JB,
                generateUboSync: qB
            })
        }
    }
        ;
    OK.extension = {
        type: [R.WebGPUSystem],
        name: "ubo"
    }
}
);
var MQ;
var IK = O(() => {
    wJ();
    l7();
    MQ = class MQ extends o6 {
        constructor({ buffer: J, offset: Q, size: Z }) {
            super();
            this.uid = i8("buffer"),
                this._resourceType = "bufferResource",
                this._touched = 0,
                this._resourceId = i8("resource"),
                this._bufferResource = !0,
                this.destroyed = !1,
                this.buffer = J,
                this.offset = Q | 0,
                this.size = Z,
                this.buffer.on("change", this.onBufferChange, this)
        }
        onBufferChange() {
            this._resourceId = i8("resource"),
                this.emit("change", this)
        }
        destroy(J = !1) {
            if (this.destroyed = !0,
                J)
                this.buffer.destroy();
            this.emit("change", this),
                this.buffer = null
        }
    }
}
);
class jW {
    constructor({ minUniformOffsetAlignment: J }) {
        this._minUniformOffsetAlignment = 256,
            this.byteIndex = 0,
            this._minUniformOffsetAlignment = J,
            this.data = new Float32Array(65535)
    }
    clear() {
        this.byteIndex = 0
    }
    addEmptyGroup(J) {
        if (J > this._minUniformOffsetAlignment / 4)
            throw new Error(`UniformBufferBatch: array is too large: ${J * 4}`);
        let Q = this.byteIndex
            , Z = Q + J * 4;
        if (Z = Math.ceil(Z / this._minUniformOffsetAlignment) * this._minUniformOffsetAlignment,
            Z > this.data.length * 4)
            throw new Error("UniformBufferBatch: ubo batch got too big");
        return this.byteIndex = Z,
            Q
    }
    addGroup(J) {
        let Q = this.addEmptyGroup(J.length);
        for (let Z = 0; Z < J.length; Z++)
            this.data[Q / 4 + Z] = J[Z];
        return Q
    }
    destroy() {
        this.data = null
    }
}
var zB = () => { }
    ;
class LK {
    constructor(J) {
        this._bindGroupHash = Object.create(null),
            this._buffers = [],
            this._bindGroups = [],
            this._bufferResources = [],
            this._renderer = J,
            this._renderer.renderableGC.addManagedHash(this, "_bindGroupHash"),
            this._batchBuffer = new jW({
                minUniformOffsetAlignment: RZ
            });
        let Q = 256 / RZ;
        for (let Z = 0; Z < Q; Z++) {
            let $ = a8.UNIFORM | a8.COPY_DST;
            if (Z === 0)
                $ |= a8.COPY_SRC;
            this._buffers.push(new P7({
                data: this._batchBuffer.data,
                usage: $
            }))
        }
    }
    renderEnd() {
        this._uploadBindGroups(),
            this._resetBindGroups()
    }
    _resetBindGroups() {
        for (let J in this._bindGroupHash)
            this._bindGroupHash[J] = null;
        this._batchBuffer.clear()
    }
    getUniformBindGroup(J, Q) {
        if (!Q && this._bindGroupHash[J.uid])
            return this._bindGroupHash[J.uid];
        this._renderer.ubo.ensureUniformGroup(J);
        let Z = J.buffer.data
            , $ = this._batchBuffer.addEmptyGroup(Z.length);
        return this._renderer.ubo.syncUniformGroup(J, this._batchBuffer.data, $ / 4),
            this._bindGroupHash[J.uid] = this._getBindGroup($ / RZ),
            this._bindGroupHash[J.uid]
    }
    getUboResource(J) {
        this._renderer.ubo.updateUniformGroup(J);
        let Q = J.buffer.data
            , Z = this._batchBuffer.addGroup(Q);
        return this._getBufferResource(Z / RZ)
    }
    getArrayBindGroup(J) {
        let Q = this._batchBuffer.addGroup(J);
        return this._getBindGroup(Q / RZ)
    }
    getArrayBufferResource(J) {
        let Z = this._batchBuffer.addGroup(J) / RZ;
        return this._getBufferResource(Z)
    }
    _getBufferResource(J) {
        if (!this._bufferResources[J]) {
            let Q = this._buffers[J % 2];
            this._bufferResources[J] = new MQ({
                buffer: Q,
                offset: (J / 2 | 0) * 256,
                size: RZ
            })
        }
        return this._bufferResources[J]
    }
    _getBindGroup(J) {
        if (!this._bindGroups[J]) {
            let Q = new QJ({
                0: this._getBufferResource(J)
            });
            this._bindGroups[J] = Q
        }
        return this._bindGroups[J]
    }
    _uploadBindGroups() {
        let J = this._renderer.buffer
            , Q = this._buffers[0];
        Q.update(this._batchBuffer.byteIndex),
            J.updateBuffer(Q);
        let Z = this._renderer.gpu.device.createCommandEncoder();
        for (let $ = 1; $ < this._buffers.length; $++) {
            let q = this._buffers[$];
            Z.copyBufferToBuffer(J.getGPUBuffer(Q), RZ, J.getGPUBuffer(q), 0, this._batchBuffer.byteIndex)
        }
        this._renderer.gpu.device.queue.submit([Z.finish()])
    }
    destroy() {
        for (let J = 0; J < this._bindGroups.length; J++)
            this._bindGroups[J].destroy();
        this._bindGroups = null,
            this._bindGroupHash = null;
        for (let J = 0; J < this._buffers.length; J++)
            this._buffers[J].destroy();
        this._buffers = null;
        for (let J = 0; J < this._bufferResources.length; J++)
            this._bufferResources[J].destroy();
        this._bufferResources = null,
            this._batchBuffer.destroy(),
            this._bindGroupHash = null,
            this._renderer = null
    }
}
var RZ = 128;
var WB = O(() => {
    w0();
    b9();
    IK();
    Q9();
    zB();
    R9();
    LK.extension = {
        type: [R.WebGPUPipes],
        name: "uniformBatch"
    }
}
);
function FK(J, Q) {
    for (let Z in J.attributes) {
        let $ = J.attributes[Z]
            , q = Q[Z];
        if (q)
            $.format ?? ($.format = q.format),
                $.offset ?? ($.offset = q.offset),
                $.instance ?? ($.instance = q.instance);
        else
            m0(`Attribute ${Z} is not present in the shader, but is present in the geometry. Unable to infer attribute details.`)
    }
    Cm(J)
}
function Cm(J) {
    let { buffers: Q, attributes: Z } = J
        , $ = {}
        , q = {};
    for (let K in Q) {
        let V = Q[K];
        $[V.uid] = 0,
            q[V.uid] = 0
    }
    for (let K in Z) {
        let V = Z[K];
        $[V.buffer.uid] += EJ(V.format).stride
    }
    for (let K in Z) {
        let V = Z[K];
        V.stride ?? (V.stride = $[V.buffer.uid]),
            V.start ?? (V.start = q[V.buffer.uid]),
            q[V.buffer.uid] += EJ(V.format).stride
    }
}
var BW = O(() => {
    B6();
    LQ()
}
);
var f5;
var kW = O(() => {
    OQ();
    f5 = [];
    f5[Z7.NONE] = void 0;
    f5[Z7.DISABLED] = {
        stencilWriteMask: 0,
        stencilReadMask: 0
    };
    f5[Z7.RENDERING_MASK_ADD] = {
        stencilFront: {
            compare: "equal",
            passOp: "increment-clamp"
        },
        stencilBack: {
            compare: "equal",
            passOp: "increment-clamp"
        }
    };
    f5[Z7.RENDERING_MASK_REMOVE] = {
        stencilFront: {
            compare: "equal",
            passOp: "decrement-clamp"
        },
        stencilBack: {
            compare: "equal",
            passOp: "decrement-clamp"
        }
    };
    f5[Z7.MASK_ACTIVE] = {
        stencilWriteMask: 0,
        stencilFront: {
            compare: "equal",
            passOp: "keep"
        },
        stencilBack: {
            compare: "equal",
            passOp: "keep"
        }
    };
    f5[Z7.INVERSE_MASK_ACTIVE] = {
        stencilWriteMask: 0,
        stencilFront: {
            compare: "not-equal",
            passOp: "keep"
        },
        stencilBack: {
            compare: "not-equal",
            passOp: "keep"
        }
    }
}
);
function Im(J, Q, Z, $, q) {
    return J << 24 | Q << 16 | Z << 10 | $ << 5 | q
}
function Lm(J, Q, Z, $) {
    return Z << 6 | J << 3 | $ << 1 | Q
}
class GK {
    constructor(J) {
        this._moduleCache = Object.create(null),
            this._bufferLayoutsCache = Object.create(null),
            this._bindingNamesCache = Object.create(null),
            this._pipeCache = Object.create(null),
            this._pipeStateCaches = Object.create(null),
            this._colorMask = 15,
            this._multisampleCount = 1,
            this._renderer = J
    }
    contextChange(J) {
        this._gpu = J,
            this.setStencilMode(Z7.DISABLED),
            this._updatePipeHash()
    }
    setMultisampleCount(J) {
        if (this._multisampleCount === J)
            return;
        this._multisampleCount = J,
            this._updatePipeHash()
    }
    setRenderTarget(J) {
        this._multisampleCount = J.msaaSamples,
            this._depthStencilAttachment = J.descriptor.depthStencilAttachment ? 1 : 0,
            this._updatePipeHash()
    }
    setColorMask(J) {
        if (this._colorMask === J)
            return;
        this._colorMask = J,
            this._updatePipeHash()
    }
    setStencilMode(J) {
        if (this._stencilMode === J)
            return;
        this._stencilMode = J,
            this._stencilState = f5[J],
            this._updatePipeHash()
    }
    setPipeline(J, Q, Z, $) {
        let q = this.getPipeline(J, Q, Z);
        $.setPipeline(q)
    }
    getPipeline(J, Q, Z, $) {
        if (!J._layoutKey)
            FK(J, Q.attributeData),
                this._generateBufferKey(J);
        $ || ($ = J.topology);
        let q = Im(J._layoutKey, Q._layoutKey, Z.data, Z._blendModeId, Om[$]);
        if (this._pipeCache[q])
            return this._pipeCache[q];
        return this._pipeCache[q] = this._createPipeline(J, Q, Z, $),
            this._pipeCache[q]
    }
    _createPipeline(J, Q, Z, $) {
        let q = this._gpu.device
            , K = this._createVertexBufferLayouts(J, Q)
            , V = this._renderer.state.getColorTargets(Z);
        V[0].writeMask = this._stencilMode === Z7.RENDERING_MASK_ADD ? 0 : this._colorMask;
        let z = this._renderer.shader.getProgramData(Q).pipeline
            , W = {
                vertex: {
                    module: this._getModule(Q.vertex.source),
                    entryPoint: Q.vertex.entryPoint,
                    buffers: K
                },
                fragment: {
                    module: this._getModule(Q.fragment.source),
                    entryPoint: Q.fragment.entryPoint,
                    targets: V
                },
                primitive: {
                    topology: $,
                    cullMode: Z.cullMode
                },
                layout: z,
                multisample: {
                    count: this._multisampleCount
                },
                label: "PIXI Pipeline"
            };
        if (this._depthStencilAttachment)
            W.depthStencil = {
                ...this._stencilState,
                format: "depth24plus-stencil8",
                depthWriteEnabled: Z.depthTest,
                depthCompare: Z.depthTest ? "less" : "always"
            };
        return q.createRenderPipeline(W)
    }
    _getModule(J) {
        return this._moduleCache[J] || this._createModule(J)
    }
    _createModule(J) {
        let Q = this._gpu.device;
        return this._moduleCache[J] = Q.createShaderModule({
            code: J
        }),
            this._moduleCache[J]
    }
    _generateBufferKey(J) {
        let Q = []
            , Z = 0
            , $ = Object.keys(J.attributes).sort();
        for (let K = 0; K < $.length; K++) {
            let V = J.attributes[$[K]];
            Q[Z++] = V.offset,
                Q[Z++] = V.format,
                Q[Z++] = V.stride,
                Q[Z++] = V.instance
        }
        let q = Q.join("|");
        return J._layoutKey = Z9(q, "geometry"),
            J._layoutKey
    }
    _generateAttributeLocationsKey(J) {
        let Q = []
            , Z = 0
            , $ = Object.keys(J.attributeData).sort();
        for (let K = 0; K < $.length; K++) {
            let V = J.attributeData[$[K]];
            Q[Z++] = V.location
        }
        let q = Q.join("|");
        return J._attributeLocationsKey = Z9(q, "programAttributes"),
            J._attributeLocationsKey
    }
    getBufferNamesToBind(J, Q) {
        let Z = J._layoutKey << 16 | Q._attributeLocationsKey;
        if (this._bindingNamesCache[Z])
            return this._bindingNamesCache[Z];
        let $ = this._createVertexBufferLayouts(J, Q)
            , q = Object.create(null)
            , K = Q.attributeData;
        for (let V = 0; V < $.length; V++) {
            let W = Object.values($[V].attributes)[0].shaderLocation;
            for (let H in K)
                if (K[H].location === W) {
                    q[V] = H;
                    break
                }
        }
        return this._bindingNamesCache[Z] = q,
            q
    }
    _createVertexBufferLayouts(J, Q) {
        if (!Q._attributeLocationsKey)
            this._generateAttributeLocationsKey(Q);
        let Z = J._layoutKey << 16 | Q._attributeLocationsKey;
        if (this._bufferLayoutsCache[Z])
            return this._bufferLayoutsCache[Z];
        let $ = [];
        return J.buffers.forEach((q) => {
            let K = {
                arrayStride: 0,
                stepMode: "vertex",
                attributes: []
            }
                , V = K.attributes;
            for (let z in Q.attributeData) {
                let W = J.attributes[z];
                if ((W.divisor ?? 1) !== 1)
                    m0(`Attribute ${z} has an invalid divisor value of '${W.divisor}'. WebGPU only supports a divisor value of 1`);
                if (W.buffer === q)
                    K.arrayStride = W.stride,
                        K.stepMode = W.instance ? "instance" : "vertex",
                        V.push({
                            shaderLocation: Q.attributeData[z].location,
                            offset: W.offset,
                            format: W.format
                        })
            }
            if (V.length)
                $.push(K)
        }
        ),
            this._bufferLayoutsCache[Z] = $,
            $
    }
    _updatePipeHash() {
        let J = Lm(this._stencilMode, this._multisampleCount, this._colorMask, this._depthStencilAttachment);
        if (!this._pipeStateCaches[J])
            this._pipeStateCaches[J] = Object.create(null);
        this._pipeCache = this._pipeStateCaches[J]
    }
    destroy() {
        this._renderer = null,
            this._bufferLayoutsCache = null
    }
}
var Om;
var HB = O(() => {
    w0();
    B6();
    BW();
    OQ();
    C$();
    kW();
    Om = {
        "point-list": 0,
        "line-list": 1,
        "line-strip": 2,
        "triangle-list": 3,
        "triangle-strip": 4
    };
    GK.extension = {
        type: [R.WebGPUSystem],
        name: "pipeline"
    }
}
);
function YB(J, Q, Z, $, q, K) {
    let V = K ? 1 : -1;
    return J.identity(),
        J.a = 1 / $ * 2,
        J.d = V * (1 / q * 2),
        J.tx = -1 - Q * J.a,
        J.ty = -V - Z * J.d,
        J
}
var XB = () => { }
    ;
function UB(J) {
    let Q = J.colorTexture.source.resource;
    return globalThis.HTMLCanvasElement && Q instanceof HTMLCanvasElement && document.body.contains(Q)
}
var NB = () => { }
    ;
class d$ {
    constructor(J) {
        this.rootViewPort = new v8,
            this.viewport = new v8,
            this.onRenderTargetChange = new S$("onRenderTargetChange"),
            this.projectionMatrix = new f0,
            this.defaultClearColor = [0, 0, 0, 0],
            this._renderSurfaceToRenderTargetHash = new Map,
            this._gpuRenderTargetHash = Object.create(null),
            this._renderTargetStack = [],
            this._renderer = J,
            J.renderableGC.addManagedHash(this, "_gpuRenderTargetHash")
    }
    finishRenderPass() {
        this.adaptor.finishRenderPass(this.renderTarget)
    }
    renderStart({ target: J, clear: Q, clearColor: Z, frame: $ }) {
        this._renderTargetStack.length = 0,
            this.push(J, Q, Z, $),
            this.rootViewPort.copyFrom(this.viewport),
            this.rootRenderTarget = this.renderTarget,
            this.renderingToScreen = UB(this.rootRenderTarget),
            this.adaptor.prerender?.(this.rootRenderTarget)
    }
    postrender() {
        this.adaptor.postrender?.(this.rootRenderTarget)
    }
    bind(J, Q = !0, Z, $) {
        let q = this.getRenderTarget(J)
            , K = this.renderTarget !== q;
        this.renderTarget = q,
            this.renderSurface = J;
        let V = this.getGpuRenderTarget(q);
        if (q.pixelWidth !== V.width || q.pixelHeight !== V.height)
            this.adaptor.resizeGpuRenderTarget(q),
                V.width = q.pixelWidth,
                V.height = q.pixelHeight;
        let z = q.colorTexture
            , W = this.viewport
            , H = z.pixelWidth
            , Y = z.pixelHeight;
        if (!$ && J instanceof _0)
            $ = J.frame;
        if ($) {
            let U = z._resolution;
            W.x = $.x * U + 0.5 | 0,
                W.y = $.y * U + 0.5 | 0,
                W.width = $.width * U + 0.5 | 0,
                W.height = $.height * U + 0.5 | 0
        } else
            W.x = 0,
                W.y = 0,
                W.width = H,
                W.height = Y;
        if (YB(this.projectionMatrix, 0, 0, W.width / z.resolution, W.height / z.resolution, !q.isRoot),
            this.adaptor.startRenderPass(q, Q, Z, W),
            K)
            this.onRenderTargetChange.emit(q);
        return q
    }
    clear(J, Q = s7.ALL, Z) {
        if (!Q)
            return;
        if (J)
            J = this.getRenderTarget(J);
        this.adaptor.clear(J || this.renderTarget, Q, Z, this.viewport)
    }
    contextChange() {
        this._gpuRenderTargetHash = Object.create(null)
    }
    push(J, Q = s7.ALL, Z, $) {
        let q = this.bind(J, Q, Z, $);
        return this._renderTargetStack.push({
            renderTarget: q,
            frame: $
        }),
            q
    }
    pop() {
        this._renderTargetStack.pop();
        let J = this._renderTargetStack[this._renderTargetStack.length - 1];
        this.bind(J.renderTarget, !1, null, J.frame)
    }
    getRenderTarget(J) {
        if (J.isTexture)
            J = J.source;
        return this._renderSurfaceToRenderTargetHash.get(J) ?? this._initRenderTarget(J)
    }
    copyToTexture(J, Q, Z, $, q) {
        if (Z.x < 0)
            $.width += Z.x,
                q.x -= Z.x,
                Z.x = 0;
        if (Z.y < 0)
            $.height += Z.y,
                q.y -= Z.y,
                Z.y = 0;
        let { pixelWidth: K, pixelHeight: V } = J;
        return $.width = Math.min($.width, K - Z.x),
            $.height = Math.min($.height, V - Z.y),
            this.adaptor.copyToTexture(J, Q, Z, $, q)
    }
    ensureDepthStencil() {
        if (!this.renderTarget.stencil)
            this.renderTarget.stencil = !0,
                this.adaptor.startRenderPass(this.renderTarget, !1, null, this.viewport)
    }
    destroy() {
        this._renderer = null,
            this._renderSurfaceToRenderTargetHash.forEach((J, Q) => {
                if (J !== Q)
                    J.destroy()
            }
            ),
            this._renderSurfaceToRenderTargetHash.clear(),
            this._gpuRenderTargetHash = Object.create(null)
    }
    _initRenderTarget(J) {
        let Q = null;
        if (kJ.test(J))
            J = WK(J).source;
        if (J instanceof x$)
            Q = J;
        else if (J instanceof $6) {
            if (Q = new x$({
                colorTextures: [J]
            }),
                J.source instanceof kJ)
                Q.isRoot = !0;
            J.once("destroy", () => {
                Q.destroy(),
                    this._renderSurfaceToRenderTargetHash.delete(J);
                let Z = this._gpuRenderTargetHash[Q.uid];
                if (Z)
                    this._gpuRenderTargetHash[Q.uid] = null,
                        this.adaptor.destroyGpuRenderTarget(Z)
            }
            )
        }
        return this._renderSurfaceToRenderTargetHash.set(J, Q),
            Q
    }
    getGpuRenderTarget(J) {
        return this._gpuRenderTargetHash[J.uid] || (this._gpuRenderTargetHash[J.uid] = this.adaptor.initGpuRenderTarget(J))
    }
    resetState() {
        this.renderTarget = null,
            this.renderSurface = null
    }
}
var CW = O(() => {
    Z6();
    E7();
    MZ();
    XB();
    sz();
    $Z();
    n7();
    W6();
    zW();
    NB();
    KW()
}
);
class OW {
    constructor() {
        this.contexts = [],
            this.msaaTextures = [],
            this.msaaSamples = 1
    }
}
var wB = () => { }
    ;
class IW {
    init(J, Q) {
        this._renderer = J,
            this._renderTargetSystem = Q
    }
    copyToTexture(J, Q, Z, $, q) {
        let K = this._renderer
            , V = this._getGpuColorTexture(J)
            , z = K.texture.getGpuSource(Q.source);
        return K.encoder.commandEncoder.copyTextureToTexture({
            texture: V,
            origin: Z
        }, {
            texture: z,
            origin: q
        }, $),
            Q
    }
    startRenderPass(J, Q = !0, Z, $) {
        let K = this._renderTargetSystem.getGpuRenderTarget(J)
            , V = this.getDescriptor(J, Q, Z);
        K.descriptor = V,
            this._renderer.pipeline.setRenderTarget(K),
            this._renderer.encoder.beginRenderPass(K),
            this._renderer.encoder.setViewport($)
    }
    finishRenderPass() {
        this._renderer.encoder.endRenderPass()
    }
    _getGpuColorTexture(J) {
        let Q = this._renderTargetSystem.getGpuRenderTarget(J);
        if (Q.contexts[0])
            return Q.contexts[0].getCurrentTexture();
        return this._renderer.texture.getGpuSource(J.colorTextures[0].source)
    }
    getDescriptor(J, Q, Z) {
        if (typeof Q === "boolean")
            Q = Q ? s7.ALL : s7.NONE;
        let $ = this._renderTargetSystem, q = $.getGpuRenderTarget(J), K = J.colorTextures.map((W, H) => {
            let Y = q.contexts[H], U, N;
            if (Y)
                U = Y.getCurrentTexture().createView();
            else
                U = this._renderer.texture.getGpuSource(W).createView({
                    mipLevelCount: 1
                });
            if (q.msaaTextures[H])
                N = U,
                    U = this._renderer.texture.getTextureView(q.msaaTextures[H]);
            let j = Q & s7.COLOR ? "clear" : "load";
            return Z ?? (Z = $.defaultClearColor),
            {
                view: U,
                resolveTarget: N,
                clearValue: Z,
                storeOp: "store",
                loadOp: j
            }
        }
        ), V;
        if ((J.stencil || J.depth) && !J.depthStencilTexture)
            J.ensureDepthStencilTexture(),
                J.depthStencilTexture.source.sampleCount = q.msaa ? 4 : 1;
        if (J.depthStencilTexture) {
            let W = Q & s7.STENCIL ? "clear" : "load"
                , H = Q & s7.DEPTH ? "clear" : "load";
            V = {
                view: this._renderer.texture.getGpuSource(J.depthStencilTexture.source).createView(),
                stencilStoreOp: "store",
                stencilLoadOp: W,
                depthClearValue: 1,
                depthLoadOp: H,
                depthStoreOp: "store"
            }
        }
        return {
            colorAttachments: K,
            depthStencilAttachment: V
        }
    }
    clear(J, Q = !0, Z, $) {
        if (!Q)
            return;
        let { gpu: q, encoder: K } = this._renderer
            , V = q.device;
        if (K.commandEncoder === null) {
            let W = V.createCommandEncoder()
                , H = this.getDescriptor(J, Q, Z)
                , Y = W.beginRenderPass(H);
            Y.setViewport($.x, $.y, $.width, $.height, 0, 1),
                Y.end();
            let U = W.finish();
            V.queue.submit([U])
        } else
            this.startRenderPass(J, Q, Z, $)
    }
    initGpuRenderTarget(J) {
        J.isRoot = !0;
        let Q = new OW;
        if (J.colorTextures.forEach((Z, $) => {
            if (Z instanceof kJ) {
                let q = Z.resource.getContext("webgpu")
                    , K = Z.transparent ? "premultiplied" : "opaque";
                try {
                    q.configure({
                        device: this._renderer.gpu.device,
                        usage: GPUTextureUsage.TEXTURE_BINDING | GPUTextureUsage.COPY_DST | GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.COPY_SRC,
                        format: "bgra8unorm",
                        alphaMode: K
                    })
                } catch (V) { }
                Q.contexts[$] = q
            }
            if (Q.msaa = Z.source.antialias,
                Z.source.antialias) {
                let q = new $6({
                    width: 0,
                    height: 0,
                    sampleCount: 4
                });
                Q.msaaTextures[$] = q
            }
        }
        ),
            Q.msaa) {
            if (Q.msaaSamples = 4,
                J.depthStencilTexture)
                J.depthStencilTexture.source.sampleCount = 4
        }
        return Q
    }
    destroyGpuRenderTarget(J) {
        J.contexts.forEach((Q) => {
            Q.unconfigure()
        }
        ),
            J.msaaTextures.forEach((Q) => {
                Q.destroy()
            }
            ),
            J.msaaTextures.length = 0,
            J.contexts.length = 0
    }
    ensureDepthStencilTexture(J) {
        let Q = this._renderTargetSystem.getGpuRenderTarget(J);
        if (J.depthStencilTexture && Q.msaa)
            J.depthStencilTexture.source.sampleCount = 4
    }
    resizeGpuRenderTarget(J) {
        let Q = this._renderTargetSystem.getGpuRenderTarget(J);
        if (Q.width = J.width,
            Q.height = J.height,
            Q.msaa)
            J.colorTextures.forEach((Z, $) => {
                Q.msaaTextures[$]?.resize(Z.source.width, Z.source.height, Z.source._resolution)
            }
            )
    }
}
var jB = O(() => {
    MZ();
    $Z();
    n7();
    wB()
}
);
var PK;
var BB = O(() => {
    w0();
    CW();
    jB();
    PK = class PK extends d$ {
        constructor(J) {
            super(J);
            this.adaptor = new IW,
                this.adaptor.init(J, this)
        }
    }
        ;
    PK.extension = {
        type: [R.WebGPUSystem],
        name: "renderTarget"
    }
}
);
class DK {
    constructor() {
        this._gpuProgramData = Object.create(null)
    }
    contextChange(J) {
        this._gpu = J
    }
    getProgramData(J) {
        return this._gpuProgramData[J._layoutKey] || this._createGPUProgramData(J)
    }
    _createGPUProgramData(J) {
        let Q = this._gpu.device
            , Z = J.gpuLayout.map((q) => Q.createBindGroupLayout({
                entries: q
            }))
            , $ = {
                bindGroupLayouts: Z
            };
        return this._gpuProgramData[J._layoutKey] = {
            bindGroups: Z,
            pipeline: Q.createPipelineLayout($)
        },
            this._gpuProgramData[J._layoutKey]
    }
    destroy() {
        this._gpu = null,
            this._gpuProgramData = null
    }
}
var kB = O(() => {
    w0();
    DK.extension = {
        type: [R.WebGPUSystem],
        name: "shader"
    }
}
);
var CJ;
var CB = O(() => {
    CJ = {};
    CJ.normal = {
        alpha: {
            srcFactor: "one",
            dstFactor: "one-minus-src-alpha",
            operation: "add"
        },
        color: {
            srcFactor: "one",
            dstFactor: "one-minus-src-alpha",
            operation: "add"
        }
    };
    CJ.add = {
        alpha: {
            srcFactor: "src-alpha",
            dstFactor: "one-minus-src-alpha",
            operation: "add"
        },
        color: {
            srcFactor: "one",
            dstFactor: "one",
            operation: "add"
        }
    };
    CJ.multiply = {
        alpha: {
            srcFactor: "one",
            dstFactor: "one-minus-src-alpha",
            operation: "add"
        },
        color: {
            srcFactor: "dst",
            dstFactor: "one-minus-src-alpha",
            operation: "add"
        }
    };
    CJ.screen = {
        alpha: {
            srcFactor: "one",
            dstFactor: "one-minus-src-alpha",
            operation: "add"
        },
        color: {
            srcFactor: "one",
            dstFactor: "one-minus-src",
            operation: "add"
        }
    };
    CJ.overlay = {
        alpha: {
            srcFactor: "one",
            dstFactor: "one-minus-src-alpha",
            operation: "add"
        },
        color: {
            srcFactor: "one",
            dstFactor: "one-minus-src",
            operation: "add"
        }
    };
    CJ.none = {
        alpha: {
            srcFactor: "one",
            dstFactor: "one-minus-src-alpha",
            operation: "add"
        },
        color: {
            srcFactor: "zero",
            dstFactor: "zero",
            operation: "add"
        }
    };
    CJ["normal-npm"] = {
        alpha: {
            srcFactor: "one",
            dstFactor: "one-minus-src-alpha",
            operation: "add"
        },
        color: {
            srcFactor: "src-alpha",
            dstFactor: "one-minus-src-alpha",
            operation: "add"
        }
    };
    CJ["add-npm"] = {
        alpha: {
            srcFactor: "one",
            dstFactor: "one",
            operation: "add"
        },
        color: {
            srcFactor: "src-alpha",
            dstFactor: "one",
            operation: "add"
        }
    };
    CJ["screen-npm"] = {
        alpha: {
            srcFactor: "one",
            dstFactor: "one-minus-src-alpha",
            operation: "add"
        },
        color: {
            srcFactor: "src-alpha",
            dstFactor: "one-minus-src",
            operation: "add"
        }
    };
    CJ.erase = {
        alpha: {
            srcFactor: "zero",
            dstFactor: "one-minus-src-alpha",
            operation: "add"
        },
        color: {
            srcFactor: "zero",
            dstFactor: "one-minus-src",
            operation: "add"
        }
    };
    CJ.min = {
        alpha: {
            srcFactor: "one",
            dstFactor: "one",
            operation: "min"
        },
        color: {
            srcFactor: "one",
            dstFactor: "one",
            operation: "min"
        }
    };
    CJ.max = {
        alpha: {
            srcFactor: "one",
            dstFactor: "one",
            operation: "max"
        },
        color: {
            srcFactor: "one",
            dstFactor: "one",
            operation: "max"
        }
    }
}
);
class AK {
    constructor() {
        this.defaultState = new U7,
            this.defaultState.blend = !0
    }
    contextChange(J) {
        this.gpu = J
    }
    getColorTargets(J) {
        return [{
            format: "bgra8unorm",
            writeMask: 0,
            blend: CJ[J.blendMode] || CJ.normal
        }]
    }
    destroy() {
        this.gpu = null
    }
}
var OB = O(() => {
    w0();
    q5();
    CB();
    AK.extension = {
        type: [R.WebGPUSystem],
        name: "state"
    }
}
);
var IB;
var LB = O(() => {
    IB = {
        type: "image",
        upload(J, Q, Z) {
            let $ = J.resource
                , q = (J.pixelWidth | 0) * (J.pixelHeight | 0)
                , K = $.byteLength / q;
            Z.device.queue.writeTexture({
                texture: Q
            }, $, {
                offset: 0,
                rowsPerImage: J.pixelHeight,
                bytesPerRow: J.pixelHeight * K
            }, {
                width: J.pixelWidth,
                height: J.pixelHeight,
                depthOrArrayLayers: 1
            })
        }
    }
}
);
var LW, Fm, FB;
var GB = O(() => {
    LW = {
        "bc1-rgba-unorm": {
            blockBytes: 8,
            blockWidth: 4,
            blockHeight: 4
        },
        "bc2-rgba-unorm": {
            blockBytes: 16,
            blockWidth: 4,
            blockHeight: 4
        },
        "bc3-rgba-unorm": {
            blockBytes: 16,
            blockWidth: 4,
            blockHeight: 4
        },
        "bc7-rgba-unorm": {
            blockBytes: 16,
            blockWidth: 4,
            blockHeight: 4
        },
        "etc1-rgb-unorm": {
            blockBytes: 8,
            blockWidth: 4,
            blockHeight: 4
        },
        "etc2-rgba8unorm": {
            blockBytes: 16,
            blockWidth: 4,
            blockHeight: 4
        },
        "astc-4x4-unorm": {
            blockBytes: 16,
            blockWidth: 4,
            blockHeight: 4
        }
    },
        Fm = {
            blockBytes: 4,
            blockWidth: 1,
            blockHeight: 1
        },
        FB = {
            type: "compressed",
            upload(J, Q, Z) {
                let { pixelWidth: $, pixelHeight: q } = J
                    , K = LW[J.format] || Fm;
                for (let V = 0; V < J.resource.length; V++) {
                    let z = J.resource[V]
                        , W = Math.ceil($ / K.blockWidth) * K.blockBytes;
                    Z.device.queue.writeTexture({
                        texture: Q,
                        mipLevel: V
                    }, z, {
                        offset: 0,
                        bytesPerRow: W
                    }, {
                        width: Math.ceil($ / K.blockWidth) * K.blockWidth,
                        height: Math.ceil(q / K.blockHeight) * K.blockHeight,
                        depthOrArrayLayers: 1
                    }),
                        $ = Math.max($ >> 1, 1),
                        q = Math.max(q >> 1, 1)
                }
            }
        }
}
);
var EK;
var FW = O(() => {
    M6();
    B6();
    EK = {
        type: "image",
        upload(J, Q, Z) {
            let $ = J.resource;
            if (!$)
                return;
            if (globalThis.HTMLImageElement && $ instanceof HTMLImageElement) {
                let z = a0.get().createCanvas($.width, $.height);
                z.getContext("2d").drawImage($, 0, 0, $.width, $.height),
                    J.resource = z,
                    m0("ImageSource: Image element passed, converting to canvas and replacing resource.")
            }
            let q = Math.min(Q.width, J.resourceWidth || J.pixelWidth)
                , K = Math.min(Q.height, J.resourceHeight || J.pixelHeight)
                , V = J.alphaMode === "premultiply-alpha-on-upload";
            Z.device.queue.copyExternalImageToTexture({
                source: $
            }, {
                texture: Q,
                premultipliedAlpha: V
            }, {
                width: q,
                height: K
            })
        }
    }
}
);
var PB;
var DB = O(() => {
    FW();
    PB = {
        type: "video",
        upload(J, Q, Z) {
            EK.upload(J, Q, Z)
        }
    }
}
);
class GW {
    constructor(J) {
        this.device = J,
            this.sampler = J.createSampler({
                minFilter: "linear"
            }),
            this.pipelines = {}
    }
    _getMipmapPipeline(J) {
        let Q = this.pipelines[J];
        if (!Q) {
            if (!this.mipmapShaderModule)
                this.mipmapShaderModule = this.device.createShaderModule({
                    code: `
                        var<private> pos : array<vec2<f32>, 3> = array<vec2<f32>, 3>(
                        vec2<f32>(-1.0, -1.0), vec2<f32>(-1.0, 3.0), vec2<f32>(3.0, -1.0));

                        struct VertexOutput {
                        @builtin(position) position : vec4<f32>,
                        @location(0) texCoord : vec2<f32>,
                        };

                        @vertex
                        fn vertexMain(@builtin(vertex_index) vertexIndex : u32) -> VertexOutput {
                        var output : VertexOutput;
                        output.texCoord = pos[vertexIndex] * vec2<f32>(0.5, -0.5) + vec2<f32>(0.5);
                        output.position = vec4<f32>(pos[vertexIndex], 0.0, 1.0);
                        return output;
                        }

                        @group(0) @binding(0) var imgSampler : sampler;
                        @group(0) @binding(1) var img : texture_2d<f32>;

                        @fragment
                        fn fragmentMain(@location(0) texCoord : vec2<f32>) -> @location(0) vec4<f32> {
                        return textureSample(img, imgSampler, texCoord);
                        }
                    `
                });
            Q = this.device.createRenderPipeline({
                layout: "auto",
                vertex: {
                    module: this.mipmapShaderModule,
                    entryPoint: "vertexMain"
                },
                fragment: {
                    module: this.mipmapShaderModule,
                    entryPoint: "fragmentMain",
                    targets: [{
                        format: J
                    }]
                }
            }),
                this.pipelines[J] = Q
        }
        return Q
    }
    generateMipmap(J) {
        let Q = this._getMipmapPipeline(J.format);
        if (J.dimension === "3d" || J.dimension === "1d")
            throw new Error("Generating mipmaps for non-2d textures is currently unsupported!");
        let Z = J
            , $ = J.depthOrArrayLayers || 1
            , q = J.usage & GPUTextureUsage.RENDER_ATTACHMENT;
        if (!q) {
            let z = {
                size: {
                    width: Math.ceil(J.width / 2),
                    height: Math.ceil(J.height / 2),
                    depthOrArrayLayers: $
                },
                format: J.format,
                usage: GPUTextureUsage.TEXTURE_BINDING | GPUTextureUsage.COPY_SRC | GPUTextureUsage.RENDER_ATTACHMENT,
                mipLevelCount: J.mipLevelCount - 1
            };
            Z = this.device.createTexture(z)
        }
        let K = this.device.createCommandEncoder({})
            , V = Q.getBindGroupLayout(0);
        for (let z = 0; z < $; ++z) {
            let W = J.createView({
                baseMipLevel: 0,
                mipLevelCount: 1,
                dimension: "2d",
                baseArrayLayer: z,
                arrayLayerCount: 1
            })
                , H = q ? 1 : 0;
            for (let Y = 1; Y < J.mipLevelCount; ++Y) {
                let U = Z.createView({
                    baseMipLevel: H++,
                    mipLevelCount: 1,
                    dimension: "2d",
                    baseArrayLayer: z,
                    arrayLayerCount: 1
                })
                    , N = K.beginRenderPass({
                        colorAttachments: [{
                            view: U,
                            storeOp: "store",
                            loadOp: "clear",
                            clearValue: {
                                r: 0,
                                g: 0,
                                b: 0,
                                a: 0
                            }
                        }]
                    })
                    , j = this.device.createBindGroup({
                        layout: V,
                        entries: [{
                            binding: 0,
                            resource: this.sampler
                        }, {
                            binding: 1,
                            resource: W
                        }]
                    });
                N.setPipeline(Q),
                    N.setBindGroup(0, j),
                    N.draw(3, 1, 0, 0),
                    N.end(),
                    W = U
            }
        }
        if (!q) {
            let z = {
                width: Math.ceil(J.width / 2),
                height: Math.ceil(J.height / 2),
                depthOrArrayLayers: $
            };
            for (let W = 1; W < J.mipLevelCount; ++W)
                K.copyTextureToTexture({
                    texture: Z,
                    mipLevel: W - 1
                }, {
                    texture: J,
                    mipLevel: W
                }, z),
                    z.width = Math.ceil(z.width / 2),
                    z.height = Math.ceil(z.height / 2)
        }
        if (this.device.queue.submit([K.finish()]),
            !q)
            Z.destroy();
        return J
    }
}
var AB = () => { }
    ;
class MK {
    constructor(J) {
        this.managedTextures = [],
            this._gpuSources = Object.create(null),
            this._gpuSamplers = Object.create(null),
            this._bindGroupHash = Object.create(null),
            this._textureViewHash = Object.create(null),
            this._uploads = {
                image: EK,
                buffer: IB,
                video: PB,
                compressed: FB
            },
            this._renderer = J,
            J.renderableGC.addManagedHash(this, "_gpuSources"),
            J.renderableGC.addManagedHash(this, "_gpuSamplers"),
            J.renderableGC.addManagedHash(this, "_bindGroupHash"),
            J.renderableGC.addManagedHash(this, "_textureViewHash")
    }
    contextChange(J) {
        this._gpu = J
    }
    initSource(J) {
        if (this._gpuSources[J.uid])
            return this._gpuSources[J.uid];
        return this._initSource(J)
    }
    _initSource(J) {
        if (J.autoGenerateMipmaps) {
            let z = Math.max(J.pixelWidth, J.pixelHeight);
            J.mipLevelCount = Math.floor(Math.log2(z)) + 1
        }
        let Q = GPUTextureUsage.TEXTURE_BINDING | GPUTextureUsage.COPY_DST;
        if (J.uploadMethodId !== "compressed")
            Q |= GPUTextureUsage.RENDER_ATTACHMENT,
                Q |= GPUTextureUsage.COPY_SRC;
        let Z = LW[J.format] || {
            blockBytes: 4,
            blockWidth: 1,
            blockHeight: 1
        }
            , $ = Math.ceil(J.pixelWidth / Z.blockWidth) * Z.blockWidth
            , q = Math.ceil(J.pixelHeight / Z.blockHeight) * Z.blockHeight
            , K = {
                label: J.label,
                size: {
                    width: $,
                    height: q
                },
                format: J.format,
                sampleCount: J.sampleCount,
                mipLevelCount: J.mipLevelCount,
                dimension: J.dimension,
                usage: Q
            }
            , V = this._gpuSources[J.uid] = this._gpu.device.createTexture(K);
        if (!this.managedTextures.includes(J))
            J.on("update", this.onSourceUpdate, this),
                J.on("resize", this.onSourceResize, this),
                J.on("destroy", this.onSourceDestroy, this),
                J.on("unload", this.onSourceUnload, this),
                J.on("updateMipmaps", this.onUpdateMipmaps, this),
                this.managedTextures.push(J);
        return this.onSourceUpdate(J),
            V
    }
    onSourceUpdate(J) {
        let Q = this.getGpuSource(J);
        if (!Q)
            return;
        if (this._uploads[J.uploadMethodId])
            this._uploads[J.uploadMethodId].upload(J, Q, this._gpu);
        if (J.autoGenerateMipmaps && J.mipLevelCount > 1)
            this.onUpdateMipmaps(J)
    }
    onSourceUnload(J) {
        let Q = this._gpuSources[J.uid];
        if (Q)
            this._gpuSources[J.uid] = null,
                Q.destroy()
    }
    onUpdateMipmaps(J) {
        if (!this._mipmapGenerator)
            this._mipmapGenerator = new GW(this._gpu.device);
        let Q = this.getGpuSource(J);
        this._mipmapGenerator.generateMipmap(Q)
    }
    onSourceDestroy(J) {
        J.off("update", this.onSourceUpdate, this),
            J.off("unload", this.onSourceUnload, this),
            J.off("destroy", this.onSourceDestroy, this),
            J.off("resize", this.onSourceResize, this),
            J.off("updateMipmaps", this.onUpdateMipmaps, this),
            this.managedTextures.splice(this.managedTextures.indexOf(J), 1),
            this.onSourceUnload(J)
    }
    onSourceResize(J) {
        let Q = this._gpuSources[J.uid];
        if (!Q)
            this.initSource(J);
        else if (Q.width !== J.pixelWidth || Q.height !== J.pixelHeight)
            this._textureViewHash[J.uid] = null,
                this._bindGroupHash[J.uid] = null,
                this.onSourceUnload(J),
                this.initSource(J)
    }
    _initSampler(J) {
        return this._gpuSamplers[J._resourceId] = this._gpu.device.createSampler(J),
            this._gpuSamplers[J._resourceId]
    }
    getGpuSampler(J) {
        return this._gpuSamplers[J._resourceId] || this._initSampler(J)
    }
    getGpuSource(J) {
        return this._gpuSources[J.uid] || this.initSource(J)
    }
    getTextureBindGroup(J) {
        return this._bindGroupHash[J.uid] ?? this._createTextureBindGroup(J)
    }
    _createTextureBindGroup(J) {
        let Q = J.source;
        return this._bindGroupHash[J.uid] = new QJ({
            0: Q,
            1: Q.style,
            2: new Y6({
                uTextureMatrix: {
                    type: "mat3x3<f32>",
                    value: J.textureMatrix.mapCoord
                }
            })
        }),
            this._bindGroupHash[J.uid]
    }
    getTextureView(J) {
        let Q = J.source;
        return this._textureViewHash[Q.uid] ?? this._createTextureView(Q)
    }
    _createTextureView(J) {
        return this._textureViewHash[J.uid] = this.getGpuSource(J).createView(),
            this._textureViewHash[J.uid]
    }
    generateCanvas(J) {
        let Q = this._renderer
            , Z = Q.gpu.device.createCommandEncoder()
            , $ = a0.get().createCanvas();
        $.width = J.source.pixelWidth,
            $.height = J.source.pixelHeight;
        let q = $.getContext("webgpu");
        return q.configure({
            device: Q.gpu.device,
            usage: GPUTextureUsage.COPY_DST | GPUTextureUsage.COPY_SRC,
            format: a0.get().getNavigator().gpu.getPreferredCanvasFormat(),
            alphaMode: "premultiplied"
        }),
            Z.copyTextureToTexture({
                texture: Q.texture.getGpuSource(J.source),
                origin: {
                    x: 0,
                    y: 0
                }
            }, {
                texture: q.getCurrentTexture()
            }, {
                width: $.width,
                height: $.height
            }),
            Q.gpu.device.queue.submit([Z.finish()]),
            $
    }
    getPixels(J) {
        let Q = this.generateCanvas(J)
            , Z = oJ.getOptimalCanvasAndContext(Q.width, Q.height)
            , $ = Z.context;
        $.drawImage(Q, 0, 0);
        let { width: q, height: K } = Q
            , V = $.getImageData(0, 0, q, K)
            , z = new Uint8ClampedArray(V.data.buffer);
        return oJ.returnCanvasAndContext(Z),
        {
            pixels: z,
            width: q,
            height: K
        }
    }
    destroy() {
        this.managedTextures.slice().forEach((J) => this.onSourceDestroy(J)),
            this.managedTextures = null;
        for (let J of Object.keys(this._bindGroupHash)) {
            let Q = Number(J);
            this._bindGroupHash[Q]?.destroy(),
                this._bindGroupHash[Q] = null
        }
        this._gpu = null,
            this._mipmapGenerator = null,
            this._gpuSources = null,
            this._bindGroupHash = null,
            this._textureViewHash = null,
            this._gpuSamplers = null
    }
}
var EB = O(() => {
    M6();
    w0();
    _7();
    LZ();
    R9();
    LB();
    GB();
    FW();
    DB();
    AB();
    MK.extension = {
        type: [R.WebGPUSystem],
        name: "texture"
    }
}
);
var y_ = {};
WL(y_, {
    WebGPURenderer: () => MB
});
var Gm, Pm, Dm, v_, S_, T_, MB;
var _B = O(() => {
    w0();
    Zj();
    Kj();
    zj();
    T$();
    WW();
    $5();
    nj();
    sj();
    ij();
    aj();
    rj();
    tj();
    ej();
    VB();
    WB();
    HB();
    BB();
    kB();
    OB();
    EB();
    Gm = [...HK, OK, wK, g$, jK, UK, MK, PK, DK, AK, GK, NK, BK, XK],
        Pm = [...YK, LK],
        Dm = [nq, oq, lq],
        v_ = [],
        S_ = [],
        T_ = [];
    e0.handleByNamedList(R.WebGPUSystem, v_);
    e0.handleByNamedList(R.WebGPUPipes, S_);
    e0.handleByNamedList(R.WebGPUPipesAdaptor, T_);
    e0.add(...Gm, ...Pm, ...Dm);
    MB = class MB extends x9 {
        constructor() {
            let J = {
                name: "webgpu",
                type: W7.WEBGPU,
                systems: v_,
                renderPipes: S_,
                renderPipeAdaptors: T_
            };
            super(J)
        }
    }
}
);
class _K {
    contextChange(J) {
        let Q = new Y6({
            uColor: {
                value: new Float32Array([1, 1, 1, 1]),
                type: "vec4<f32>"
            },
            uTransformMatrix: {
                value: new f0,
                type: "mat3x3<f32>"
            },
            uRound: {
                value: 0,
                type: "f32"
            }
        })
            , Z = J.limits.maxBatchableTextures
            , $ = b5({
                name: "graphics",
                bits: [HZ, XZ(Z), PZ, S5]
            });
        this.shader = new k7({
            glProgram: $,
            resources: {
                localUniforms: Q,
                batchSamplers: UZ(Z)
            }
        })
    }
    execute(J, Q) {
        let Z = Q.context
            , $ = Z.customShader || this.shader
            , q = J.renderer
            , K = q.graphicsContext
            , { batcher: V, instructions: z } = K.getContextRenderData(Z);
        $.groups[0] = q.globalUniforms.bindGroup,
            q.state.set(J.state),
            q.shader.bind($),
            q.geometry.bind(V.geometry, $.glProgram);
        let W = z.instructions;
        for (let H = 0; H < z.instructionSize; H++) {
            let Y = W[H];
            if (Y.size) {
                for (let U = 0; U < Y.textures.count; U++)
                    q.texture.bind(Y.textures.textures[U], U);
                q.geometry.draw(Y.topology, Y.size, Y.start)
            }
        }
    }
    destroy() {
        this.shader.destroy(!0),
            this.shader = null
    }
}
var RB = O(() => {
    w0();
    Z6();
    v9();
    O$();
    I$();
    DZ();
    S9();
    Uq();
    k5();
    _7();
    _K.extension = {
        type: [R.WebGLPipesAdaptor],
        name: "graphics"
    }
}
);
class RK {
    init() {
        let J = b5({
            name: "mesh",
            bits: [PZ, qj, S5]
        });
        this._shader = new k7({
            glProgram: J,
            resources: {
                uTexture: _0.EMPTY.source,
                textureUniforms: {
                    uTextureMatrix: {
                        type: "mat3x3<f32>",
                        value: new f0
                    }
                }
            }
        })
    }
    execute(J, Q) {
        let Z = J.renderer
            , $ = Q._shader;
        if (!$) {
            $ = this._shader;
            let q = Q.texture
                , K = q.source;
            $.resources.uTexture = K,
                $.resources.uSampler = K.style,
                $.resources.textureUniforms.uniforms.uTextureMatrix = q.textureMatrix.mapCoord
        } else if (!$.glProgram) {
            m0("Mesh shader has no glProgram", Q.shader);
            return
        }
        $.groups[100] = Z.globalUniforms.bindGroup,
            $.groups[101] = J.localUniformsBindGroup,
            Z.encoder.draw({
                geometry: Q._geometry,
                shader: $,
                state: Q.state
            })
    }
    destroy() {
        this._shader.destroy(!0),
            this._shader = null
    }
}
var bB = O(() => {
    w0();
    Z6();
    v9();
    DZ();
    S9();
    iz();
    k5();
    W6();
    B6();
    RK.extension = {
        type: [R.WebGLPipesAdaptor],
        name: "mesh"
    }
}
);
class bK {
    constructor() {
        this._tempState = U7.for2d(),
            this._didUploadHash = {}
    }
    init(J) {
        J.renderer.runners.contextChange.add(this)
    }
    contextChange() {
        this._didUploadHash = {}
    }
    start(J, Q, Z) {
        let $ = J.renderer
            , q = this._didUploadHash[Z.uid];
        if ($.shader.bind(Z, q),
            !q)
            this._didUploadHash[Z.uid] = !0;
        $.shader.updateUniformGroup($.globalUniforms.uniformGroup),
            $.geometry.bind(Q, Z.glProgram)
    }
    execute(J, Q) {
        let Z = J.renderer;
        this._tempState.blendMode = Q.blendMode,
            Z.state.set(this._tempState);
        let $ = Q.textures.textures;
        for (let q = 0; q < Q.textures.count; q++)
            Z.texture.bind($[q], q);
        Z.geometry.draw(Q.topology, Q.size, Q.start)
    }
}
var vB = O(() => {
    w0();
    q5();
    bK.extension = {
        type: [R.WebGLPipesAdaptor],
        name: "batch"
    }
}
);
var p$;
var SB = O(() => {
    p$ = ((J) => {
        return J[J.ELEMENT_ARRAY_BUFFER = 34963] = "ELEMENT_ARRAY_BUFFER",
            J[J.ARRAY_BUFFER = 34962] = "ARRAY_BUFFER",
            J[J.UNIFORM_BUFFER = 35345] = "UNIFORM_BUFFER",
            J
    }
    )(p$ || {})
}
);
class PW {
    constructor(J, Q) {
        this._lastBindBaseLocation = -1,
            this._lastBindCallId = -1,
            this.buffer = J || null,
            this.updateID = -1,
            this.byteLength = -1,
            this.type = Q
    }
}
var TB = () => { }
    ;
class vK {
    constructor(J) {
        this._gpuBuffers = Object.create(null),
            this._boundBufferBases = Object.create(null),
            this._minBaseLocation = 0,
            this._nextBindBaseIndex = this._minBaseLocation,
            this._bindCallId = 0,
            this._renderer = J,
            this._renderer.renderableGC.addManagedHash(this, "_gpuBuffers")
    }
    destroy() {
        this._renderer = null,
            this._gl = null,
            this._gpuBuffers = null,
            this._boundBufferBases = null
    }
    contextChange() {
        this._gl = this._renderer.gl,
            this._gpuBuffers = Object.create(null),
            this._maxBindings = this._renderer.limits.maxUniformBindings
    }
    getGlBuffer(J) {
        return this._gpuBuffers[J.uid] || this.createGLBuffer(J)
    }
    bind(J) {
        let { _gl: Q } = this
            , Z = this.getGlBuffer(J);
        Q.bindBuffer(Z.type, Z.buffer)
    }
    bindBufferBase(J, Q) {
        let { _gl: Z } = this;
        if (this._boundBufferBases[Q] !== J)
            this._boundBufferBases[Q] = J,
                J._lastBindBaseLocation = Q,
                Z.bindBufferBase(Z.UNIFORM_BUFFER, Q, J.buffer)
    }
    nextBindBase(J) {
        if (this._bindCallId++,
            this._minBaseLocation = 0,
            J) {
            if (this._boundBufferBases[0] = null,
                this._minBaseLocation = 1,
                this._nextBindBaseIndex < 1)
                this._nextBindBaseIndex = 1
        }
    }
    freeLocationForBufferBase(J) {
        let Q = this.getLastBindBaseLocation(J);
        if (Q >= this._minBaseLocation)
            return J._lastBindCallId = this._bindCallId,
                Q;
        let Z = 0
            , $ = this._nextBindBaseIndex;
        while (Z < 2) {
            if ($ >= this._maxBindings)
                $ = this._minBaseLocation,
                    Z++;
            let q = this._boundBufferBases[$];
            if (q && q._lastBindCallId === this._bindCallId) {
                $++;
                continue
            }
            break
        }
        if (Q = $,
            this._nextBindBaseIndex = $ + 1,
            Z >= 2)
            return -1;
        return J._lastBindCallId = this._bindCallId,
            this._boundBufferBases[Q] = null,
            Q
    }
    getLastBindBaseLocation(J) {
        let Q = J._lastBindBaseLocation;
        if (this._boundBufferBases[Q] === J)
            return Q;
        return -1
    }
    bindBufferRange(J, Q, Z, $) {
        let { _gl: q } = this;
        Z || (Z = 0),
            Q || (Q = 0),
            this._boundBufferBases[Q] = null,
            q.bindBufferRange(q.UNIFORM_BUFFER, Q || 0, J.buffer, Z * 256, $ || 256)
    }
    updateBuffer(J) {
        let { _gl: Q } = this
            , Z = this.getGlBuffer(J);
        if (J._updateID === Z.updateID)
            return Z;
        Z.updateID = J._updateID,
            Q.bindBuffer(Z.type, Z.buffer);
        let $ = J.data
            , q = J.descriptor.usage & a8.STATIC ? Q.STATIC_DRAW : Q.DYNAMIC_DRAW;
        if ($)
            if (Z.byteLength >= $.byteLength)
                Q.bufferSubData(Z.type, 0, $, 0, J._updateSize / $.BYTES_PER_ELEMENT);
            else
                Z.byteLength = $.byteLength,
                    Q.bufferData(Z.type, $, q);
        else
            Z.byteLength = J.descriptor.size,
                Q.bufferData(Z.type, Z.byteLength, q);
        return Z
    }
    destroyAll() {
        let J = this._gl;
        for (let Q in this._gpuBuffers)
            J.deleteBuffer(this._gpuBuffers[Q].buffer);
        this._gpuBuffers = Object.create(null)
    }
    onBufferDestroy(J, Q) {
        let Z = this._gpuBuffers[J.uid]
            , $ = this._gl;
        if (!Q)
            $.deleteBuffer(Z.buffer);
        this._gpuBuffers[J.uid] = null
    }
    createGLBuffer(J) {
        let { _gl: Q } = this
            , Z = p$.ARRAY_BUFFER;
        if (J.descriptor.usage & a8.INDEX)
            Z = p$.ELEMENT_ARRAY_BUFFER;
        else if (J.descriptor.usage & a8.UNIFORM)
            Z = p$.UNIFORM_BUFFER;
        let $ = new PW(Q.createBuffer(), Z);
        return this._gpuBuffers[J.uid] = $,
            J.on("destroy", this.onBufferDestroy, this),
            $
    }
    resetState() {
        this._boundBufferBases = Object.create(null)
    }
}
var yB = O(() => {
    w0();
    Q9();
    SB();
    TB();
    vK.extension = {
        type: [R.WebGLSystem],
        name: "buffer"
    }
}
);
var IG = class J {
    constructor(Q) {
        this.supports = {
            uint32Indices: !0,
            uniformBufferObject: !0,
            vertexArrayObject: !0,
            srgbTextures: !0,
            nonPowOf2wrapping: !0,
            msaa: !0,
            nonPowOf2mipmaps: !0
        },
            this._renderer = Q,
            this.extensions = Object.create(null),
            this.handleContextLost = this.handleContextLost.bind(this),
            this.handleContextRestored = this.handleContextRestored.bind(this)
    }
    get isLost() {
        return !this.gl || this.gl.isContextLost()
    }
    contextChange(Q) {
        this.gl = Q,
            this._renderer.gl = Q
    }
    init(Q) {
        Q = {
            ...J.defaultOptions,
            ...Q
        };
        let Z = this.multiView = Q.multiView;
        if (Q.context && Z)
            m0("Renderer created with both a context and multiview enabled. Disabling multiView as both cannot work together."),
                Z = !1;
        if (Z)
            this.canvas = a0.get().createCanvas(this._renderer.canvas.width, this._renderer.canvas.height);
        else
            this.canvas = this._renderer.view.canvas;
        if (Q.context)
            this.initFromContext(Q.context);
        else {
            let $ = this._renderer.background.alpha < 1
                , q = Q.premultipliedAlpha ?? !0
                , K = Q.antialias && !this._renderer.backBuffer.useBackBuffer;
            this.createContext(Q.preferWebGLVersion, {
                alpha: $,
                premultipliedAlpha: q,
                antialias: K,
                stencil: !0,
                preserveDrawingBuffer: Q.preserveDrawingBuffer,
                powerPreference: Q.powerPreference ?? "default"
            })
        }
    }
    ensureCanvasSize(Q) {
        if (!this.multiView) {
            if (Q !== this.canvas)
                m0("multiView is disabled, but targetCanvas is not the main canvas");
            return
        }
        let { canvas: Z } = this;
        if (Z.width < Q.width || Z.height < Q.height)
            Z.width = Math.max(Q.width, Q.width),
                Z.height = Math.max(Q.height, Q.height)
    }
    initFromContext(Q) {
        this.gl = Q,
            this.webGLVersion = Q instanceof a0.get().getWebGLRenderingContext() ? 1 : 2,
            this.getExtensions(),
            this.validateContext(Q),
            this._renderer.runners.contextChange.emit(Q);
        let Z = this._renderer.view.canvas;
        Z.addEventListener("webglcontextlost", this.handleContextLost, !1),
            Z.addEventListener("webglcontextrestored", this.handleContextRestored, !1)
    }
    createContext(Q, Z) {
        let $, q = this.canvas;
        if (Q === 2)
            $ = q.getContext("webgl2", Z);
        if (!$) {
            if ($ = q.getContext("webgl", Z),
                !$)
                throw new Error("This browser does not support WebGL. Try using the canvas renderer")
        }
        this.gl = $,
            this.initFromContext(this.gl)
    }
    getExtensions() {
        let { gl: Q } = this
            , Z = {
                anisotropicFiltering: Q.getExtension("EXT_texture_filter_anisotropic"),
                floatTextureLinear: Q.getExtension("OES_texture_float_linear"),
                s3tc: Q.getExtension("WEBGL_compressed_texture_s3tc"),
                s3tc_sRGB: Q.getExtension("WEBGL_compressed_texture_s3tc_srgb"),
                etc: Q.getExtension("WEBGL_compressed_texture_etc"),
                etc1: Q.getExtension("WEBGL_compressed_texture_etc1"),
                pvrtc: Q.getExtension("WEBGL_compressed_texture_pvrtc") || Q.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),
                atc: Q.getExtension("WEBGL_compressed_texture_atc"),
                astc: Q.getExtension("WEBGL_compressed_texture_astc"),
                bptc: Q.getExtension("EXT_texture_compression_bptc"),
                rgtc: Q.getExtension("EXT_texture_compression_rgtc"),
                loseContext: Q.getExtension("WEBGL_lose_context")
            };
        if (this.webGLVersion === 1)
            this.extensions = {
                ...Z,
                drawBuffers: Q.getExtension("WEBGL_draw_buffers"),
                depthTexture: Q.getExtension("WEBGL_depth_texture"),
                vertexArrayObject: Q.getExtension("OES_vertex_array_object") || Q.getExtension("MOZ_OES_vertex_array_object") || Q.getExtension("WEBKIT_OES_vertex_array_object"),
                uint32ElementIndex: Q.getExtension("OES_element_index_uint"),
                floatTexture: Q.getExtension("OES_texture_float"),
                floatTextureLinear: Q.getExtension("OES_texture_float_linear"),
                textureHalfFloat: Q.getExtension("OES_texture_half_float"),
                textureHalfFloatLinear: Q.getExtension("OES_texture_half_float_linear"),
                vertexAttribDivisorANGLE: Q.getExtension("ANGLE_instanced_arrays"),
                srgb: Q.getExtension("EXT_sRGB")
            };
        else {
            this.extensions = {
                ...Z,
                colorBufferFloat: Q.getExtension("EXT_color_buffer_float")
            };
            let $ = Q.getExtension("WEBGL_provoking_vertex");
            if ($)
                $.provokingVertexWEBGL($.FIRST_VERTEX_CONVENTION_WEBGL)
        }
    }
    handleContextLost(Q) {
        if (Q.preventDefault(),
            this._contextLossForced)
            this._contextLossForced = !1,
                setTimeout(() => {
                    if (this.gl.isContextLost())
                        this.extensions.loseContext?.restoreContext()
                }
                    , 0)
    }
    handleContextRestored() {
        this.getExtensions(),
            this._renderer.runners.contextChange.emit(this.gl)
    }
    destroy() {
        let Q = this._renderer.view.canvas;
        this._renderer = null,
            Q.removeEventListener("webglcontextlost", this.handleContextLost),
            Q.removeEventListener("webglcontextrestored", this.handleContextRestored),
            this.gl.useProgram(null),
            this.extensions.loseContext?.loseContext()
    }
    forceContextLoss() {
        this.extensions.loseContext?.loseContext(),
            this._contextLossForced = !0
    }
    validateContext(Q) {
        let Z = Q.getContextAttributes();
        if (Z && !Z.stencil)
            m0("Provided WebGL context does not have a stencil buffer, masks may not render correctly");
        let $ = this.supports
            , q = this.webGLVersion === 2
            , K = this.extensions;
        if ($.uint32Indices = q || !!K.uint32ElementIndex,
            $.uniformBufferObject = q,
            $.vertexArrayObject = q || !!K.vertexArrayObject,
            $.srgbTextures = q || !!K.srgb,
            $.nonPowOf2wrapping = q,
            $.nonPowOf2mipmaps = q,
            $.msaa = q,
            !$.uint32Indices)
            m0("Provided WebGL context does not support 32 index buffer, large scenes may not render correctly")
    }
}
    , fB;
var hB = O(() => {
    M6();
    w0();
    B6();
    IG.extension = {
        type: [R.WebGLSystem],
        name: "context"
    };
    IG.defaultOptions = {
        context: null,
        premultipliedAlpha: !0,
        preserveDrawingBuffer: !1,
        powerPreference: void 0,
        preferWebGLVersion: 2,
        multiView: !1
    };
    fB = IG
}
);
var SK, DW, I6;
var AW = O(() => {
    SK = ((J) => {
        return J[J.RGBA = 6408] = "RGBA",
            J[J.RGB = 6407] = "RGB",
            J[J.RG = 33319] = "RG",
            J[J.RED = 6403] = "RED",
            J[J.RGBA_INTEGER = 36249] = "RGBA_INTEGER",
            J[J.RGB_INTEGER = 36248] = "RGB_INTEGER",
            J[J.RG_INTEGER = 33320] = "RG_INTEGER",
            J[J.RED_INTEGER = 36244] = "RED_INTEGER",
            J[J.ALPHA = 6406] = "ALPHA",
            J[J.LUMINANCE = 6409] = "LUMINANCE",
            J[J.LUMINANCE_ALPHA = 6410] = "LUMINANCE_ALPHA",
            J[J.DEPTH_COMPONENT = 6402] = "DEPTH_COMPONENT",
            J[J.DEPTH_STENCIL = 34041] = "DEPTH_STENCIL",
            J
    }
    )(SK || {}),
        DW = ((J) => {
            return J[J.TEXTURE_2D = 3553] = "TEXTURE_2D",
                J[J.TEXTURE_CUBE_MAP = 34067] = "TEXTURE_CUBE_MAP",
                J[J.TEXTURE_2D_ARRAY = 35866] = "TEXTURE_2D_ARRAY",
                J[J.TEXTURE_CUBE_MAP_POSITIVE_X = 34069] = "TEXTURE_CUBE_MAP_POSITIVE_X",
                J[J.TEXTURE_CUBE_MAP_NEGATIVE_X = 34070] = "TEXTURE_CUBE_MAP_NEGATIVE_X",
                J[J.TEXTURE_CUBE_MAP_POSITIVE_Y = 34071] = "TEXTURE_CUBE_MAP_POSITIVE_Y",
                J[J.TEXTURE_CUBE_MAP_NEGATIVE_Y = 34072] = "TEXTURE_CUBE_MAP_NEGATIVE_Y",
                J[J.TEXTURE_CUBE_MAP_POSITIVE_Z = 34073] = "TEXTURE_CUBE_MAP_POSITIVE_Z",
                J[J.TEXTURE_CUBE_MAP_NEGATIVE_Z = 34074] = "TEXTURE_CUBE_MAP_NEGATIVE_Z",
                J
        }
        )(DW || {}),
        I6 = ((J) => {
            return J[J.UNSIGNED_BYTE = 5121] = "UNSIGNED_BYTE",
                J[J.UNSIGNED_SHORT = 5123] = "UNSIGNED_SHORT",
                J[J.UNSIGNED_SHORT_5_6_5 = 33635] = "UNSIGNED_SHORT_5_6_5",
                J[J.UNSIGNED_SHORT_4_4_4_4 = 32819] = "UNSIGNED_SHORT_4_4_4_4",
                J[J.UNSIGNED_SHORT_5_5_5_1 = 32820] = "UNSIGNED_SHORT_5_5_5_1",
                J[J.UNSIGNED_INT = 5125] = "UNSIGNED_INT",
                J[J.UNSIGNED_INT_10F_11F_11F_REV = 35899] = "UNSIGNED_INT_10F_11F_11F_REV",
                J[J.UNSIGNED_INT_2_10_10_10_REV = 33640] = "UNSIGNED_INT_2_10_10_10_REV",
                J[J.UNSIGNED_INT_24_8 = 34042] = "UNSIGNED_INT_24_8",
                J[J.UNSIGNED_INT_5_9_9_9_REV = 35902] = "UNSIGNED_INT_5_9_9_9_REV",
                J[J.BYTE = 5120] = "BYTE",
                J[J.SHORT = 5122] = "SHORT",
                J[J.INT = 5124] = "INT",
                J[J.FLOAT = 5126] = "FLOAT",
                J[J.FLOAT_32_UNSIGNED_INT_24_8_REV = 36269] = "FLOAT_32_UNSIGNED_INT_24_8_REV",
                J[J.HALF_FLOAT = 36193] = "HALF_FLOAT",
                J
        }
        )(I6 || {})
}
);
function xB(J) {
    return f_[J] ?? f_.float32
}
var f_;
var gB = O(() => {
    AW();
    f_ = {
        uint8x2: I6.UNSIGNED_BYTE,
        uint8x4: I6.UNSIGNED_BYTE,
        sint8x2: I6.BYTE,
        sint8x4: I6.BYTE,
        unorm8x2: I6.UNSIGNED_BYTE,
        unorm8x4: I6.UNSIGNED_BYTE,
        snorm8x2: I6.BYTE,
        snorm8x4: I6.BYTE,
        uint16x2: I6.UNSIGNED_SHORT,
        uint16x4: I6.UNSIGNED_SHORT,
        sint16x2: I6.SHORT,
        sint16x4: I6.SHORT,
        unorm16x2: I6.UNSIGNED_SHORT,
        unorm16x4: I6.UNSIGNED_SHORT,
        snorm16x2: I6.SHORT,
        snorm16x4: I6.SHORT,
        float16x2: I6.HALF_FLOAT,
        float16x4: I6.HALF_FLOAT,
        float32: I6.FLOAT,
        float32x2: I6.FLOAT,
        float32x3: I6.FLOAT,
        float32x4: I6.FLOAT,
        uint32: I6.UNSIGNED_INT,
        uint32x2: I6.UNSIGNED_INT,
        uint32x3: I6.UNSIGNED_INT,
        uint32x4: I6.UNSIGNED_INT,
        sint32: I6.INT,
        sint32x2: I6.INT,
        sint32x3: I6.INT,
        sint32x4: I6.INT
    }
}
);
class TK {
    constructor(J) {
        this._geometryVaoHash = Object.create(null),
            this._renderer = J,
            this._activeGeometry = null,
            this._activeVao = null,
            this.hasVao = !0,
            this.hasInstance = !0,
            this._renderer.renderableGC.addManagedHash(this, "_geometryVaoHash")
    }
    contextChange() {
        let J = this.gl = this._renderer.gl;
        if (!this._renderer.context.supports.vertexArrayObject)
            throw new Error("[PixiJS] Vertex Array Objects are not supported on this device");
        let Q = this._renderer.context.extensions.vertexArrayObject;
        if (Q)
            J.createVertexArray = () => Q.createVertexArrayOES(),
                J.bindVertexArray = ($) => Q.bindVertexArrayOES($),
                J.deleteVertexArray = ($) => Q.deleteVertexArrayOES($);
        let Z = this._renderer.context.extensions.vertexAttribDivisorANGLE;
        if (Z)
            J.drawArraysInstanced = ($, q, K, V) => {
                Z.drawArraysInstancedANGLE($, q, K, V)
            }
                ,
                J.drawElementsInstanced = ($, q, K, V, z) => {
                    Z.drawElementsInstancedANGLE($, q, K, V, z)
                }
                ,
                J.vertexAttribDivisor = ($, q) => Z.vertexAttribDivisorANGLE($, q);
        this._activeGeometry = null,
            this._activeVao = null,
            this._geometryVaoHash = Object.create(null)
    }
    bind(J, Q) {
        let Z = this.gl;
        this._activeGeometry = J;
        let $ = this.getVao(J, Q);
        if (this._activeVao !== $)
            this._activeVao = $,
                Z.bindVertexArray($);
        this.updateBuffers()
    }
    resetState() {
        this.unbind()
    }
    updateBuffers() {
        let J = this._activeGeometry
            , Q = this._renderer.buffer;
        for (let Z = 0; Z < J.buffers.length; Z++) {
            let $ = J.buffers[Z];
            Q.updateBuffer($)
        }
    }
    checkCompatibility(J, Q) {
        let Z = J.attributes
            , $ = Q._attributeData;
        for (let q in $)
            if (!Z[q])
                throw new Error(`shader and geometry incompatible, geometry missing the "${q}" attribute`)
    }
    getSignature(J, Q) {
        let Z = J.attributes
            , $ = Q._attributeData
            , q = ["g", J.uid];
        for (let K in Z)
            if ($[K])
                q.push(K, $[K].location);
        return q.join("-")
    }
    getVao(J, Q) {
        return this._geometryVaoHash[J.uid]?.[Q._key] || this.initGeometryVao(J, Q)
    }
    initGeometryVao(J, Q, Z = !0) {
        let $ = this._renderer.gl
            , q = this._renderer.buffer;
        this._renderer.shader._getProgramData(Q),
            this.checkCompatibility(J, Q);
        let K = this.getSignature(J, Q);
        if (!this._geometryVaoHash[J.uid])
            this._geometryVaoHash[J.uid] = Object.create(null),
                J.on("destroy", this.onGeometryDestroy, this);
        let V = this._geometryVaoHash[J.uid]
            , z = V[K];
        if (z)
            return V[Q._key] = z,
                z;
        FK(J, Q._attributeData);
        let W = J.buffers;
        z = $.createVertexArray(),
            $.bindVertexArray(z);
        for (let H = 0; H < W.length; H++) {
            let Y = W[H];
            q.bind(Y)
        }
        return this.activateVao(J, Q),
            V[Q._key] = z,
            V[K] = z,
            $.bindVertexArray(null),
            z
    }
    onGeometryDestroy(J, Q) {
        let Z = this._geometryVaoHash[J.uid]
            , $ = this.gl;
        if (Z) {
            if (Q)
                for (let q in Z) {
                    if (this._activeVao !== Z[q])
                        this.unbind();
                    $.deleteVertexArray(Z[q])
                }
            this._geometryVaoHash[J.uid] = null
        }
    }
    destroyAll(J = !1) {
        let Q = this.gl;
        for (let Z in this._geometryVaoHash) {
            if (J)
                for (let $ in this._geometryVaoHash[Z]) {
                    let q = this._geometryVaoHash[Z];
                    if (this._activeVao !== q)
                        this.unbind();
                    Q.deleteVertexArray(q[$])
                }
            this._geometryVaoHash[Z] = null
        }
    }
    activateVao(J, Q) {
        let Z = this._renderer.gl
            , $ = this._renderer.buffer
            , q = J.attributes;
        if (J.indexBuffer)
            $.bind(J.indexBuffer);
        let K = null;
        for (let V in q) {
            let z = q[V]
                , W = z.buffer
                , H = $.getGlBuffer(W)
                , Y = Q._attributeData[V];
            if (Y) {
                if (K !== H)
                    $.bind(W),
                        K = H;
                let U = Y.location;
                Z.enableVertexAttribArray(U);
                let N = EJ(z.format)
                    , j = xB(z.format);
                if (Y.format?.substring(1, 4) === "int")
                    Z.vertexAttribIPointer(U, N.size, j, z.stride, z.offset);
                else
                    Z.vertexAttribPointer(U, N.size, j, N.normalised, z.stride, z.offset);
                if (z.instance)
                    if (this.hasInstance) {
                        let k = z.divisor ?? 1;
                        Z.vertexAttribDivisor(U, k)
                    } else
                        throw new Error("geometry error, GPU Instancing is not supported on this device")
            }
        }
    }
    draw(J, Q, Z, $) {
        let { gl: q } = this._renderer
            , K = this._activeGeometry
            , V = Am[J || K.topology];
        if ($ ?? ($ = K.instanceCount),
            K.indexBuffer) {
            let z = K.indexBuffer.data.BYTES_PER_ELEMENT
                , W = z === 2 ? q.UNSIGNED_SHORT : q.UNSIGNED_INT;
            if ($ > 1)
                q.drawElementsInstanced(V, Q || K.indexBuffer.data.length, W, (Z || 0) * z, $);
            else
                q.drawElements(V, Q || K.indexBuffer.data.length, W, (Z || 0) * z)
        } else if ($ > 1)
            q.drawArraysInstanced(V, Z || 0, Q || K.getSize(), $);
        else
            q.drawArrays(V, Z || 0, Q || K.getSize());
        return this
    }
    unbind() {
        this.gl.bindVertexArray(null),
            this._activeVao = null,
            this._activeGeometry = null
    }
    destroy() {
        this._renderer = null,
            this.gl = null,
            this._activeVao = null,
            this._activeGeometry = null
    }
}
var Am;
var mB = O(() => {
    w0();
    LQ();
    BW();
    gB();
    Am = {
        "point-list": 0,
        "line-list": 1,
        "line-strip": 3,
        "triangle-list": 4,
        "triangle-strip": 5
    };
    TK.extension = {
        type: [R.WebGLSystem],
        name: "geometry"
    }
}
);
var Em, LG = class J {
    constructor(Q) {
        this.useBackBuffer = !1,
            this._useBackBufferThisRender = !1,
            this._renderer = Q
    }
    init(Q = {}) {
        let { useBackBuffer: Z, antialias: $ } = {
            ...J.defaultOptions,
            ...Q
        };
        if (this.useBackBuffer = Z,
            this._antialias = $,
            !this._renderer.context.supports.msaa)
            m0("antialiasing, is not supported on when using the back buffer"),
                this._antialias = !1;
        this._state = U7.for2d();
        let q = new j7({
            vertex: `
                attribute vec2 aPosition;
                out vec2 vUv;

                void main() {
                    gl_Position = vec4(aPosition, 0.0, 1.0);

                    vUv = (aPosition + 1.0) / 2.0;

                    // flip dem UVs
                    vUv.y = 1.0 - vUv.y;
                }`,
            fragment: `
                in vec2 vUv;
                out vec4 finalColor;

                uniform sampler2D uTexture;

                void main() {
                    finalColor = texture(uTexture, vUv);
                }`,
            name: "big-triangle"
        });
        this._bigTriangleShader = new k7({
            glProgram: q,
            resources: {
                uTexture: _0.WHITE.source
            }
        })
    }
    renderStart(Q) {
        let Z = this._renderer.renderTarget.getRenderTarget(Q.target);
        if (this._useBackBufferThisRender = this.useBackBuffer && !!Z.isRoot,
            this._useBackBufferThisRender) {
            let $ = this._renderer.renderTarget.getRenderTarget(Q.target);
            this._targetTexture = $.colorTexture,
                Q.target = this._getBackBufferTexture($.colorTexture)
        }
    }
    renderEnd() {
        this._presentBackBuffer()
    }
    _presentBackBuffer() {
        let Q = this._renderer;
        if (Q.renderTarget.finishRenderPass(),
            !this._useBackBufferThisRender)
            return;
        Q.renderTarget.bind(this._targetTexture, !1),
            this._bigTriangleShader.resources.uTexture = this._backBufferTexture.source,
            Q.encoder.draw({
                geometry: Em,
                shader: this._bigTriangleShader,
                state: this._state
            })
    }
    _getBackBufferTexture(Q) {
        return this._backBufferTexture = this._backBufferTexture || new _0({
            source: new $6({
                width: Q.width,
                height: Q.height,
                resolution: Q._resolution,
                antialias: this._antialias
            })
        }),
            this._backBufferTexture.source.resize(Q.width, Q.height, Q._resolution),
            this._backBufferTexture
    }
    destroy() {
        if (this._backBufferTexture)
            this._backBufferTexture.destroy(),
                this._backBufferTexture = null
    }
}
    , cB;
var dB = O(() => {
    w0();
    B6();
    IQ();
    k5();
    q5();
    n7();
    W6();
    lJ();
    Em = new uJ({
        attributes: {
            aPosition: [-1, -1, 3, -1, -1, 3]
        }
    });
    LG.extension = {
        type: [R.WebGLSystem],
        name: "backBuffer",
        priority: 1
    };
    LG.defaultOptions = {
        useBackBuffer: !1
    };
    cB = LG
}
);
class yK {
    constructor(J) {
        this._colorMaskCache = 15,
            this._renderer = J
    }
    setMask(J) {
        if (this._colorMaskCache === J)
            return;
        this._colorMaskCache = J,
            this._renderer.gl.colorMask(!!(J & 8), !!(J & 4), !!(J & 2), !!(J & 1))
    }
}
var pB = O(() => {
    w0();
    yK.extension = {
        type: [R.WebGLSystem],
        name: "colorMask"
    }
}
);
class fK {
    constructor(J) {
        this.commandFinished = Promise.resolve(),
            this._renderer = J
    }
    setGeometry(J, Q) {
        this._renderer.geometry.bind(J, Q.glProgram)
    }
    finishRenderPass() { }
    draw(J) {
        let Q = this._renderer
            , { geometry: Z, shader: $, state: q, skipSync: K, topology: V, size: z, start: W, instanceCount: H } = J;
        if (Q.shader.bind($, K),
            Q.geometry.bind(Z, Q.shader._activeProgram),
            q)
            Q.state.set(q);
        Q.geometry.draw(V, z, W, H ?? Z.instanceCount)
    }
    destroy() {
        this._renderer = null
    }
}
var uB = O(() => {
    w0();
    fK.extension = {
        type: [R.WebGLSystem],
        name: "encoder"
    }
}
);
class hK {
    constructor(J) {
        this._renderer = J
    }
    contextChange() {
        let J = this._renderer.gl;
        this.maxTextures = J.getParameter(J.MAX_TEXTURE_IMAGE_UNITS),
            this.maxBatchableTextures = Hq(this.maxTextures, J),
            this.maxUniformBindings = J.getParameter(J.MAX_UNIFORM_BUFFER_BINDINGS)
    }
    destroy() { }
}
var lB = O(() => {
    w0();
    dV();
    hK.extension = {
        type: [R.WebGLSystem],
        name: "limits"
    }
}
);
class xK {
    constructor(J) {
        this._stencilCache = {
            enabled: !1,
            stencilReference: 0,
            stencilMode: Z7.NONE
        },
            this._renderTargetStencilState = Object.create(null),
            J.renderTarget.onRenderTargetChange.add(this)
    }
    contextChange(J) {
        this._gl = J,
            this._comparisonFuncMapping = {
                always: J.ALWAYS,
                never: J.NEVER,
                equal: J.EQUAL,
                "not-equal": J.NOTEQUAL,
                less: J.LESS,
                "less-equal": J.LEQUAL,
                greater: J.GREATER,
                "greater-equal": J.GEQUAL
            },
            this._stencilOpsMapping = {
                keep: J.KEEP,
                zero: J.ZERO,
                replace: J.REPLACE,
                invert: J.INVERT,
                "increment-clamp": J.INCR,
                "decrement-clamp": J.DECR,
                "increment-wrap": J.INCR_WRAP,
                "decrement-wrap": J.DECR_WRAP
            },
            this.resetState()
    }
    onRenderTargetChange(J) {
        if (this._activeRenderTarget === J)
            return;
        this._activeRenderTarget = J;
        let Q = this._renderTargetStencilState[J.uid];
        if (!Q)
            Q = this._renderTargetStencilState[J.uid] = {
                stencilMode: Z7.DISABLED,
                stencilReference: 0
            };
        this.setStencilMode(Q.stencilMode, Q.stencilReference)
    }
    resetState() {
        this._stencilCache.enabled = !1,
            this._stencilCache.stencilMode = Z7.NONE,
            this._stencilCache.stencilReference = 0
    }
    setStencilMode(J, Q) {
        let Z = this._renderTargetStencilState[this._activeRenderTarget.uid]
            , $ = this._gl
            , q = f5[J]
            , K = this._stencilCache;
        if (Z.stencilMode = J,
            Z.stencilReference = Q,
            J === Z7.DISABLED) {
            if (this._stencilCache.enabled)
                this._stencilCache.enabled = !1,
                    $.disable($.STENCIL_TEST);
            return
        }
        if (!this._stencilCache.enabled)
            this._stencilCache.enabled = !0,
                $.enable($.STENCIL_TEST);
        if (J !== K.stencilMode || K.stencilReference !== Q)
            K.stencilMode = J,
                K.stencilReference = Q,
                $.stencilFunc(this._comparisonFuncMapping[q.stencilBack.compare], Q, 255),
                $.stencilOp($.KEEP, $.KEEP, this._stencilOpsMapping[q.stencilBack.passOp])
    }
}
var oB = O(() => {
    w0();
    kW();
    OQ();
    xK.extension = {
        type: [R.WebGLSystem],
        name: "stencil"
    }
}
);
function nB(J) {
    let Q = J.map((K) => ({
        data: K,
        offset: 0,
        size: 0
    }))
        , Z = 16
        , $ = 0
        , q = 0;
    for (let K = 0; K < Q.length; K++) {
        let V = Q[K];
        if ($ = EW[V.data.type],
            !$)
            throw new Error(`Unknown type ${V.data.type}`);
        if (V.data.size > 1)
            $ = Math.max($, 16) * V.data.size;
        let z = $ === 12 ? 16 : $;
        V.size = $;
        let W = q % 16;
        if (W > 0 && 16 - W < z)
            q += (16 - W) % 16;
        else
            q += ($ - W % $) % $;
        V.offset = q,
            q += $
    }
    return q = Math.ceil(q / 16) * 16,
    {
        uboElements: Q,
        size: q
    }
}
var EW;
var MW = O(() => {
    EW = {
        f32: 4,
        i32: 4,
        "vec2<f32>": 8,
        "vec3<f32>": 12,
        "vec4<f32>": 16,
        "vec2<i32>": 8,
        "vec3<i32>": 12,
        "vec4<i32>": 16,
        "mat2x2<f32>": 32,
        "mat3x3<f32>": 48,
        "mat4x4<f32>": 64
    }
}
);
function sB(J, Q) {
    let Z = Math.max(EW[J.data.type] / 16, 1)
        , $ = J.data.value.length / J.data.size
        , q = (4 - $ % 4) % 4
        , K = J.data.type.indexOf("i32") >= 0 ? "dataInt32" : "data";
    return `
        v = uv.${J.data.name};
        offset += ${Q};

        arrayOffset = offset;

        t = 0;

        for(var i=0; i < ${J.data.size * Z}; i++)
        {
            for(var j = 0; j < ${$}; j++)
            {
                ${K}[arrayOffset++] = v[t++];
            }
            ${q !== 0 ? `arrayOffset += ${q};` : ""}
        }
    `
}
var iB = O(() => {
    MW()
}
);
function aB(J) {
    return kK(J, "uboStd40", sB, NW)
}
var rB = O(() => {
    UW();
    wW();
    iB()
}
);
var gK;
var tB = O(() => {
    w0();
    HW();
    MW();
    rB();
    gK = class gK extends m$ {
        constructor() {
            super({
                createUboElements: nB,
                generateUboSync: aB
            })
        }
    }
        ;
    gK.extension = {
        type: [R.WebGLSystem],
        name: "ubo"
    }
}
);
class _W {
    constructor() {
        this.width = -1,
            this.height = -1,
            this.msaa = !1,
            this.msaaRenderBuffer = []
    }
}
var eB = () => { }
    ;
class RW {
    constructor() {
        this._clearColorCache = [0, 0, 0, 0],
            this._viewPortCache = new v8
    }
    init(J, Q) {
        this._renderer = J,
            this._renderTargetSystem = Q,
            J.runners.contextChange.add(this)
    }
    contextChange() {
        this._clearColorCache = [0, 0, 0, 0],
            this._viewPortCache = new v8
    }
    copyToTexture(J, Q, Z, $, q) {
        let K = this._renderTargetSystem
            , V = this._renderer
            , z = K.getGpuRenderTarget(J)
            , W = V.gl;
        return this.finishRenderPass(J),
            W.bindFramebuffer(W.FRAMEBUFFER, z.resolveTargetFramebuffer),
            V.texture.bind(Q, 0),
            W.copyTexSubImage2D(W.TEXTURE_2D, 0, q.x, q.y, Z.x, Z.y, $.width, $.height),
            Q
    }
    startRenderPass(J, Q = !0, Z, $) {
        let q = this._renderTargetSystem
            , K = J.colorTexture
            , V = q.getGpuRenderTarget(J)
            , z = $.y;
        if (J.isRoot)
            z = K.pixelHeight - $.height;
        J.colorTextures.forEach((Y) => {
            this._renderer.texture.unbind(Y)
        }
        );
        let W = this._renderer.gl;
        W.bindFramebuffer(W.FRAMEBUFFER, V.framebuffer);
        let H = this._viewPortCache;
        if (H.x !== $.x || H.y !== z || H.width !== $.width || H.height !== $.height)
            H.x = $.x,
                H.y = z,
                H.width = $.width,
                H.height = $.height,
                W.viewport($.x, z, $.width, $.height);
        if (!V.depthStencilRenderBuffer && (J.stencil || J.depth))
            this._initStencil(V);
        this.clear(J, Q, Z)
    }
    finishRenderPass(J) {
        let Z = this._renderTargetSystem.getGpuRenderTarget(J);
        if (!Z.msaa)
            return;
        let $ = this._renderer.gl;
        $.bindFramebuffer($.FRAMEBUFFER, Z.resolveTargetFramebuffer),
            $.bindFramebuffer($.READ_FRAMEBUFFER, Z.framebuffer),
            $.blitFramebuffer(0, 0, Z.width, Z.height, 0, 0, Z.width, Z.height, $.COLOR_BUFFER_BIT, $.NEAREST),
            $.bindFramebuffer($.FRAMEBUFFER, Z.framebuffer)
    }
    initGpuRenderTarget(J) {
        let Z = this._renderer.gl
            , $ = new _W;
        if (J.colorTexture instanceof kJ)
            return this._renderer.context.ensureCanvasSize(J.colorTexture.resource),
                $.framebuffer = null,
                $;
        return this._initColor(J, $),
            Z.bindFramebuffer(Z.FRAMEBUFFER, null),
            $
    }
    destroyGpuRenderTarget(J) {
        let Q = this._renderer.gl;
        if (J.framebuffer)
            Q.deleteFramebuffer(J.framebuffer),
                J.framebuffer = null;
        if (J.resolveTargetFramebuffer)
            Q.deleteFramebuffer(J.resolveTargetFramebuffer),
                J.resolveTargetFramebuffer = null;
        if (J.depthStencilRenderBuffer)
            Q.deleteRenderbuffer(J.depthStencilRenderBuffer),
                J.depthStencilRenderBuffer = null;
        J.msaaRenderBuffer.forEach((Z) => {
            Q.deleteRenderbuffer(Z)
        }
        ),
            J.msaaRenderBuffer = null
    }
    clear(J, Q, Z) {
        if (!Q)
            return;
        let $ = this._renderTargetSystem;
        if (typeof Q === "boolean")
            Q = Q ? s7.ALL : s7.NONE;
        let q = this._renderer.gl;
        if (Q & s7.COLOR) {
            Z ?? (Z = $.defaultClearColor);
            let K = this._clearColorCache
                , V = Z;
            if (K[0] !== V[0] || K[1] !== V[1] || K[2] !== V[2] || K[3] !== V[3])
                K[0] = V[0],
                    K[1] = V[1],
                    K[2] = V[2],
                    K[3] = V[3],
                    q.clearColor(V[0], V[1], V[2], V[3])
        }
        q.clear(Q)
    }
    resizeGpuRenderTarget(J) {
        if (J.isRoot)
            return;
        let Z = this._renderTargetSystem.getGpuRenderTarget(J);
        if (this._resizeColor(J, Z),
            J.stencil || J.depth)
            this._resizeStencil(Z)
    }
    _initColor(J, Q) {
        let Z = this._renderer
            , $ = Z.gl
            , q = $.createFramebuffer();
        if (Q.resolveTargetFramebuffer = q,
            $.bindFramebuffer($.FRAMEBUFFER, q),
            Q.width = J.colorTexture.source.pixelWidth,
            Q.height = J.colorTexture.source.pixelHeight,
            J.colorTextures.forEach((K, V) => {
                let z = K.source;
                if (z.antialias)
                    if (Z.context.supports.msaa)
                        Q.msaa = !0;
                    else
                        m0("[RenderTexture] Antialiasing on textures is not supported in WebGL1");
                Z.texture.bindSource(z, 0);
                let H = Z.texture.getGlSource(z).texture;
                $.framebufferTexture2D($.FRAMEBUFFER, $.COLOR_ATTACHMENT0 + V, 3553, H, 0)
            }
            ),
            Q.msaa) {
            let K = $.createFramebuffer();
            Q.framebuffer = K,
                $.bindFramebuffer($.FRAMEBUFFER, K),
                J.colorTextures.forEach((V, z) => {
                    let W = $.createRenderbuffer();
                    Q.msaaRenderBuffer[z] = W
                }
                )
        } else
            Q.framebuffer = q;
        this._resizeColor(J, Q)
    }
    _resizeColor(J, Q) {
        let Z = J.colorTexture.source;
        if (Q.width = Z.pixelWidth,
            Q.height = Z.pixelHeight,
            J.colorTextures.forEach(($, q) => {
                if (q === 0)
                    return;
                $.source.resize(Z.width, Z.height, Z._resolution)
            }
            ),
            Q.msaa) {
            let $ = this._renderer
                , q = $.gl
                , K = Q.framebuffer;
            q.bindFramebuffer(q.FRAMEBUFFER, K),
                J.colorTextures.forEach((V, z) => {
                    let W = V.source;
                    $.texture.bindSource(W, 0);
                    let Y = $.texture.getGlSource(W).internalFormat
                        , U = Q.msaaRenderBuffer[z];
                    q.bindRenderbuffer(q.RENDERBUFFER, U),
                        q.renderbufferStorageMultisample(q.RENDERBUFFER, 4, Y, W.pixelWidth, W.pixelHeight),
                        q.framebufferRenderbuffer(q.FRAMEBUFFER, q.COLOR_ATTACHMENT0 + z, q.RENDERBUFFER, U)
                }
                )
        }
    }
    _initStencil(J) {
        if (J.framebuffer === null)
            return;
        let Q = this._renderer.gl
            , Z = Q.createRenderbuffer();
        J.depthStencilRenderBuffer = Z,
            Q.bindRenderbuffer(Q.RENDERBUFFER, Z),
            Q.framebufferRenderbuffer(Q.FRAMEBUFFER, Q.DEPTH_STENCIL_ATTACHMENT, Q.RENDERBUFFER, Z),
            this._resizeStencil(J)
    }
    _resizeStencil(J) {
        let Q = this._renderer.gl;
        if (Q.bindRenderbuffer(Q.RENDERBUFFER, J.depthStencilRenderBuffer),
            J.msaa)
            Q.renderbufferStorageMultisample(Q.RENDERBUFFER, 4, Q.DEPTH24_STENCIL8, J.width, J.height);
        else
            Q.renderbufferStorage(Q.RENDERBUFFER, this._renderer.context.webGLVersion === 2 ? Q.DEPTH24_STENCIL8 : Q.DEPTH_STENCIL, J.width, J.height)
    }
    prerender(J) {
        let Q = J.colorTexture.resource;
        if (this._renderer.context.multiView && kJ.test(Q))
            this._renderer.context.ensureCanvasSize(Q)
    }
    postrender(J) {
        if (!this._renderer.context.multiView)
            return;
        if (kJ.test(J.colorTexture.resource)) {
            let Q = this._renderer.context.canvas
                , Z = J.colorTexture;
            Z.context2D.drawImage(Q, 0, Z.pixelHeight - Q.height)
        }
    }
}
var Jk = O(() => {
    E7();
    B6();
    $Z();
    MZ();
    eB()
}
);
var mK;
var Qk = O(() => {
    w0();
    CW();
    Jk();
    mK = class mK extends d$ {
        constructor(J) {
            super(J);
            this.adaptor = new RW,
                this.adaptor.init(J, this)
        }
    }
        ;
    mK.extension = {
        type: [R.WebGLSystem],
        name: "renderTarget"
    }
}
);
function Zk(J, Q) {
    let Z = []
        , $ = [`
        var g = s.groups;
        var sS = r.shader;
        var p = s.glProgram;
        var ugS = r.uniformGroup;
        var resources;
    `]
        , q = !1
        , K = 0
        , V = Q._getProgramData(J.glProgram);
    for (let W in J.groups) {
        let H = J.groups[W];
        Z.push(`
            resources = g[${W}].resources;
        `);
        for (let Y in H.resources) {
            let U = H.resources[Y];
            if (U instanceof Y6)
                if (U.ubo) {
                    let N = J._uniformBindMap[W][Number(Y)];
                    Z.push(`
                        sS.bindUniformBlock(
                            resources[${Y}],
                            '${N}',
                            ${J.glProgram._uniformBlockData[N].index}
                        );
                    `)
                } else
                    Z.push(`
                        ugS.updateUniformGroup(resources[${Y}], p, sD);
                    `);
            else if (U instanceof MQ) {
                let N = J._uniformBindMap[W][Number(Y)];
                Z.push(`
                    sS.bindUniformBlock(
                        resources[${Y}],
                        '${N}',
                        ${J.glProgram._uniformBlockData[N].index}
                    );
                `)
            } else if (U instanceof $6) {
                let N = J._uniformBindMap[W][Y]
                    , j = V.uniformData[N];
                if (j) {
                    if (!q)
                        q = !0,
                            $.push(`
                        var tS = r.texture;
                        `);
                    Q._gl.uniform1i(j.location, K),
                        Z.push(`
                        tS.bind(resources[${Y}], ${K});
                    `),
                        K++
                }
            }
        }
    }
    let z = [...$, ...Z].join(`
`);
    return new Function("r", "s", "sD", z)
}
var $k = O(() => {
    IK();
    _7();
    n7()
}
);
class bW {
    constructor(J, Q) {
        this.program = J,
            this.uniformData = Q,
            this.uniformGroups = {},
            this.uniformDirtyGroups = {},
            this.uniformBlockBindings = {}
    }
    destroy() {
        this.uniformData = null,
            this.uniformGroups = null,
            this.uniformDirtyGroups = null,
            this.uniformBlockBindings = null,
            this.program = null
    }
}
var qk = () => { }
    ;
function vW(J, Q, Z) {
    let $ = J.createShader(Q);
    return J.shaderSource($, Z),
        J.compileShader($),
        $
}
var Kk = () => { }
    ;
function FG(J) {
    let Q = new Array(J);
    for (let Z = 0; Z < Q.length; Z++)
        Q[Z] = !1;
    return Q
}
function cK(J, Q) {
    switch (J) {
        case "float":
            return 0;
        case "vec2":
            return new Float32Array(2 * Q);
        case "vec3":
            return new Float32Array(3 * Q);
        case "vec4":
            return new Float32Array(4 * Q);
        case "int":
        case "uint":
        case "sampler2D":
        case "sampler2DArray":
            return 0;
        case "ivec2":
            return new Int32Array(2 * Q);
        case "ivec3":
            return new Int32Array(3 * Q);
        case "ivec4":
            return new Int32Array(4 * Q);
        case "uvec2":
            return new Uint32Array(2 * Q);
        case "uvec3":
            return new Uint32Array(3 * Q);
        case "uvec4":
            return new Uint32Array(4 * Q);
        case "bool":
            return !1;
        case "bvec2":
            return FG(2 * Q);
        case "bvec3":
            return FG(3 * Q);
        case "bvec4":
            return FG(4 * Q);
        case "mat2":
            return new Float32Array([1, 0, 0, 1]);
        case "mat3":
            return new Float32Array([1, 0, 0, 0, 1, 0, 0, 0, 1]);
        case "mat4":
            return new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1])
    }
    return null
}
var SW = () => { }
    ;
function TW(J, Q) {
    if (!Vk) {
        let Z = Object.keys(h_);
        Vk = {};
        for (let $ = 0; $ < Z.length; ++$) {
            let q = Z[$];
            Vk[J[q]] = h_[q]
        }
    }
    return Vk[Q]
}
function zk(J, Q) {
    let Z = TW(J, Q);
    return Mm[Z] || "float32"
}
var Vk = null, h_, Mm;
var yW = O(() => {
    h_ = {
        FLOAT: "float",
        FLOAT_VEC2: "vec2",
        FLOAT_VEC3: "vec3",
        FLOAT_VEC4: "vec4",
        INT: "int",
        INT_VEC2: "ivec2",
        INT_VEC3: "ivec3",
        INT_VEC4: "ivec4",
        UNSIGNED_INT: "uint",
        UNSIGNED_INT_VEC2: "uvec2",
        UNSIGNED_INT_VEC3: "uvec3",
        UNSIGNED_INT_VEC4: "uvec4",
        BOOL: "bool",
        BOOL_VEC2: "bvec2",
        BOOL_VEC3: "bvec3",
        BOOL_VEC4: "bvec4",
        FLOAT_MAT2: "mat2",
        FLOAT_MAT3: "mat3",
        FLOAT_MAT4: "mat4",
        SAMPLER_2D: "sampler2D",
        INT_SAMPLER_2D: "sampler2D",
        UNSIGNED_INT_SAMPLER_2D: "sampler2D",
        SAMPLER_CUBE: "samplerCube",
        INT_SAMPLER_CUBE: "samplerCube",
        UNSIGNED_INT_SAMPLER_CUBE: "samplerCube",
        SAMPLER_2D_ARRAY: "sampler2DArray",
        INT_SAMPLER_2D_ARRAY: "sampler2DArray",
        UNSIGNED_INT_SAMPLER_2D_ARRAY: "sampler2DArray"
    },
        Mm = {
            float: "float32",
            vec2: "float32x2",
            vec3: "float32x3",
            vec4: "float32x4",
            int: "sint32",
            ivec2: "sint32x2",
            ivec3: "sint32x3",
            ivec4: "sint32x4",
            uint: "uint32",
            uvec2: "uint32x2",
            uvec3: "uint32x3",
            uvec4: "uint32x4",
            bool: "uint32",
            bvec2: "uint32x2",
            bvec3: "uint32x3",
            bvec4: "uint32x4"
        }
}
);
function Wk(J, Q, Z = !1) {
    let $ = {}
        , q = Q.getProgramParameter(J, Q.ACTIVE_ATTRIBUTES);
    for (let V = 0; V < q; V++) {
        let z = Q.getActiveAttrib(J, V);
        if (z.name.startsWith("gl_"))
            continue;
        let W = zk(Q, z.type);
        $[z.name] = {
            location: 0,
            format: W,
            stride: EJ(W).stride,
            offset: 0,
            instance: !1,
            start: 0
        }
    }
    let K = Object.keys($);
    if (Z) {
        K.sort((V, z) => V > z ? 1 : -1);
        for (let V = 0; V < K.length; V++)
            $[K[V]].location = V,
                Q.bindAttribLocation(J, V, K[V]);
        Q.linkProgram(J)
    } else
        for (let V = 0; V < K.length; V++)
            $[K[V]].location = Q.getAttribLocation(J, K[V]);
    return $
}
var Hk = O(() => {
    LQ();
    yW()
}
);
function Yk(J, Q) {
    if (!Q.ACTIVE_UNIFORM_BLOCKS)
        return {};
    let Z = {}
        , $ = Q.getProgramParameter(J, Q.ACTIVE_UNIFORM_BLOCKS);
    for (let q = 0; q < $; q++) {
        let K = Q.getActiveUniformBlockName(J, q)
            , V = Q.getUniformBlockIndex(J, K)
            , z = Q.getActiveUniformBlockParameter(J, q, Q.UNIFORM_BLOCK_DATA_SIZE);
        Z[K] = {
            name: K,
            index: V,
            size: z
        }
    }
    return Z
}
var Xk = () => { }
    ;
function Uk(J, Q) {
    let Z = {}
        , $ = Q.getProgramParameter(J, Q.ACTIVE_UNIFORMS);
    for (let q = 0; q < $; q++) {
        let K = Q.getActiveUniform(J, q)
            , V = K.name.replace(/\[.*?\]$/, "")
            , z = !!K.name.match(/\[.*?\]$/)
            , W = TW(Q, K.type);
        Z[V] = {
            name: V,
            index: q,
            type: W,
            size: K.size,
            isArray: z,
            value: cK(W, K.size)
        }
    }
    return Z
}
var Nk = O(() => {
    SW();
    yW()
}
);
function x_(J, Q) {
    let Z = J.getShaderSource(Q).split(`
`).map((H, Y) => `${Y}: ${H}`)
        , q = J.getShaderInfoLog(Q).split(`
`)
        , K = {}
        , V = q.map((H) => parseFloat(H.replace(/^ERROR\: 0\:([\d]+)\:.*$/, "$1"))).filter((H) => {
            if (H && !K[H])
                return K[H] = !0,
                    !0;
            return !1
        }
        )
        , z = [""];
    V.forEach((H) => {
        Z[H - 1] = `%c${Z[H - 1]}%c`,
            z.push("background: #FF0000; color:#FFFFFF; font-size: 10px", "font-size: 10px")
    }
    );
    let W = Z.join(`
`);
    z[0] = W
}
function wk(J, Q, Z, $) {
    if (!J.getProgramParameter(Q, J.LINK_STATUS)) {
        if (!J.getShaderParameter(Z, J.COMPILE_STATUS))
            x_(J, Z);
        if (!J.getShaderParameter($, J.COMPILE_STATUS))
            x_(J, $);
        if (J.getProgramInfoLog(Q) !== "")
            ;
    }
}
var jk = () => { }
    ;
function Bk(J, Q) {
    let Z = vW(J, J.VERTEX_SHADER, Q.vertex)
        , $ = vW(J, J.FRAGMENT_SHADER, Q.fragment)
        , q = J.createProgram();
    J.attachShader(q, Z),
        J.attachShader(q, $);
    let K = Q.transformFeedbackVaryings;
    if (K)
        if (typeof J.transformFeedbackVaryings !== "function")
            m0("TransformFeedback is not supported but TransformFeedbackVaryings are given.");
        else
            J.transformFeedbackVaryings(q, K.names, K.bufferMode === "separate" ? J.SEPARATE_ATTRIBS : J.INTERLEAVED_ATTRIBS);
    if (J.linkProgram(q),
        !J.getProgramParameter(q, J.LINK_STATUS))
        wk(J, q, Z, $);
    Q._attributeData = Wk(q, J, !/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(Q.vertex)),
        Q._uniformData = Uk(q, J),
        Q._uniformBlockData = Yk(q, J),
        J.deleteShader(Z),
        J.deleteShader($);
    let V = {};
    for (let W in Q._uniformData) {
        let H = Q._uniformData[W];
        V[W] = {
            location: J.getUniformLocation(q, W),
            value: cK(H.type, H.size)
        }
    }
    return new bW(q, V)
}
var kk = O(() => {
    B6();
    qk();
    Kk();
    SW();
    Hk();
    Xk();
    Nk();
    jk()
}
);
class dK {
    constructor(J) {
        this._activeProgram = null,
            this._programDataHash = Object.create(null),
            this._shaderSyncFunctions = Object.create(null),
            this._renderer = J,
            this._renderer.renderableGC.addManagedHash(this, "_programDataHash")
    }
    contextChange(J) {
        this._gl = J,
            this._programDataHash = Object.create(null),
            this._shaderSyncFunctions = Object.create(null),
            this._activeProgram = null
    }
    bind(J, Q) {
        if (this._setProgram(J.glProgram),
            Q)
            return;
        Ck.textureCount = 0,
            Ck.blockIndex = 0;
        let Z = this._shaderSyncFunctions[J.glProgram._key];
        if (!Z)
            Z = this._shaderSyncFunctions[J.glProgram._key] = this._generateShaderSync(J, this);
        this._renderer.buffer.nextBindBase(!!J.glProgram.transformFeedbackVaryings),
            Z(this._renderer, J, Ck)
    }
    updateUniformGroup(J) {
        this._renderer.uniformGroup.updateUniformGroup(J, this._activeProgram, Ck)
    }
    bindUniformBlock(J, Q, Z = 0) {
        let $ = this._renderer.buffer
            , q = this._getProgramData(this._activeProgram)
            , K = J._bufferResource;
        if (!K)
            this._renderer.ubo.updateUniformGroup(J);
        let V = J.buffer
            , z = $.updateBuffer(V)
            , W = $.freeLocationForBufferBase(z);
        if (K) {
            let { offset: Y, size: U } = J;
            if (Y === 0 && U === V.data.byteLength)
                $.bindBufferBase(z, W);
            else
                $.bindBufferRange(z, W, Y)
        } else if ($.getLastBindBaseLocation(z) !== W)
            $.bindBufferBase(z, W);
        let H = this._activeProgram._uniformBlockData[Q].index;
        if (q.uniformBlockBindings[Z] === W)
            return;
        q.uniformBlockBindings[Z] = W,
            this._renderer.gl.uniformBlockBinding(q.program, H, W)
    }
    _setProgram(J) {
        if (this._activeProgram === J)
            return;
        this._activeProgram = J;
        let Q = this._getProgramData(J);
        this._gl.useProgram(Q.program)
    }
    _getProgramData(J) {
        return this._programDataHash[J._key] || this._createProgramData(J)
    }
    _createProgramData(J) {
        let Q = J._key;
        return this._programDataHash[Q] = Bk(this._gl, J),
            this._programDataHash[Q]
    }
    destroy() {
        for (let J of Object.keys(this._programDataHash))
            this._programDataHash[J].destroy(),
                this._programDataHash[J] = null;
        this._programDataHash = null
    }
    _generateShaderSync(J, Q) {
        return Zk(J, Q)
    }
    resetState() {
        this._activeProgram = null
    }
}
var Ck;
var Ok = O(() => {
    w0();
    $k();
    kk();
    Ck = {
        textureCount: 0,
        blockIndex: 0
    };
    dK.extension = {
        type: [R.WebGLSystem],
        name: "shader"
    }
}
);
var Ik, Lk;
var Fk = O(() => {
    Ik = {
        f32: `if (cv !== v) {
            cu.value = v;
            gl.uniform1f(location, v);
        }`,
        "vec2<f32>": `if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2f(location, v[0], v[1]);
        }`,
        "vec3<f32>": `if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3f(location, v[0], v[1], v[2]);
        }`,
        "vec4<f32>": `if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4f(location, v[0], v[1], v[2], v[3]);
        }`,
        i32: `if (cv !== v) {
            cu.value = v;
            gl.uniform1i(location, v);
        }`,
        "vec2<i32>": `if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2i(location, v[0], v[1]);
        }`,
        "vec3<i32>": `if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3i(location, v[0], v[1], v[2]);
        }`,
        "vec4<i32>": `if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4i(location, v[0], v[1], v[2], v[3]);
        }`,
        u32: `if (cv !== v) {
            cu.value = v;
            gl.uniform1ui(location, v);
        }`,
        "vec2<u32>": `if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2ui(location, v[0], v[1]);
        }`,
        "vec3<u32>": `if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3ui(location, v[0], v[1], v[2]);
        }`,
        "vec4<u32>": `if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
        }`,
        bool: `if (cv !== v) {
            cu.value = v;
            gl.uniform1i(location, v);
        }`,
        "vec2<bool>": `if (cv[0] !== v[0] || cv[1] !== v[1]) {
            cv[0] = v[0];
            cv[1] = v[1];
            gl.uniform2i(location, v[0], v[1]);
        }`,
        "vec3<bool>": `if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            gl.uniform3i(location, v[0], v[1], v[2]);
        }`,
        "vec4<bool>": `if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {
            cv[0] = v[0];
            cv[1] = v[1];
            cv[2] = v[2];
            cv[3] = v[3];
            gl.uniform4i(location, v[0], v[1], v[2], v[3]);
        }`,
        "mat2x2<f32>": "gl.uniformMatrix2fv(location, false, v);",
        "mat3x3<f32>": "gl.uniformMatrix3fv(location, false, v);",
        "mat4x4<f32>": "gl.uniformMatrix4fv(location, false, v);"
    },
        Lk = {
            f32: "gl.uniform1fv(location, v);",
            "vec2<f32>": "gl.uniform2fv(location, v);",
            "vec3<f32>": "gl.uniform3fv(location, v);",
            "vec4<f32>": "gl.uniform4fv(location, v);",
            "mat2x2<f32>": "gl.uniformMatrix2fv(location, false, v);",
            "mat3x3<f32>": "gl.uniformMatrix3fv(location, false, v);",
            "mat4x4<f32>": "gl.uniformMatrix4fv(location, false, v);",
            i32: "gl.uniform1iv(location, v);",
            "vec2<i32>": "gl.uniform2iv(location, v);",
            "vec3<i32>": "gl.uniform3iv(location, v);",
            "vec4<i32>": "gl.uniform4iv(location, v);",
            u32: "gl.uniform1iv(location, v);",
            "vec2<u32>": "gl.uniform2iv(location, v);",
            "vec3<u32>": "gl.uniform3iv(location, v);",
            "vec4<u32>": "gl.uniform4iv(location, v);",
            bool: "gl.uniform1iv(location, v);",
            "vec2<bool>": "gl.uniform2iv(location, v);",
            "vec3<bool>": "gl.uniform3iv(location, v);",
            "vec4<bool>": "gl.uniform4iv(location, v);"
        }
}
);
function Gk(J, Q) {
    let Z = [`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
        var name = null;
    `];
    for (let $ in J.uniforms) {
        if (!Q[$]) {
            if (J.uniforms[$] instanceof Y6)
                if (J.uniforms[$].ubo)
                    Z.push(`
                        renderer.shader.bindUniformBlock(uv.${$}, "${$}");
                    `);
                else
                    Z.push(`
                        renderer.shader.updateUniformGroup(uv.${$});
                    `);
            else if (J.uniforms[$] instanceof MQ)
                Z.push(`
                        renderer.shader.bindBufferResource(uv.${$}, "${$}");
                    `);
            continue
        }
        let q = J.uniformStructures[$]
            , K = !1;
        for (let V = 0; V < W9.length; V++) {
            let z = W9[V];
            if (q.type === z.type && z.test(q)) {
                Z.push(`name = "${$}";`, W9[V].uniform),
                    K = !0;
                break
            }
        }
        if (!K) {
            let z = (q.size === 1 ? Ik : Lk)[q.type].replace("location", `ud["${$}"].location`);
            Z.push(`
            cu = ud["${$}"];
            cv = cu.value;
            v = uv["${$}"];
            ${z};`)
        }
    }
    return new Function("ud", "uv", "renderer", "syncData", Z.join(`
`))
}
var Pk = O(() => {
    IK();
    _7();
    XW();
    Fk()
}
);
class pK {
    constructor(J) {
        this._cache = {},
            this._uniformGroupSyncHash = {},
            this._renderer = J,
            this.gl = null,
            this._cache = {}
    }
    contextChange(J) {
        this.gl = J
    }
    updateUniformGroup(J, Q, Z) {
        let $ = this._renderer.shader._getProgramData(Q);
        if (!J.isStatic || J._dirtyId !== $.uniformDirtyGroups[J.uid])
            $.uniformDirtyGroups[J.uid] = J._dirtyId,
                this._getUniformSyncFunction(J, Q)($.uniformData, J.uniforms, this._renderer, Z)
    }
    _getUniformSyncFunction(J, Q) {
        return this._uniformGroupSyncHash[J._signature]?.[Q._key] || this._createUniformSyncFunction(J, Q)
    }
    _createUniformSyncFunction(J, Q) {
        let Z = this._uniformGroupSyncHash[J._signature] || (this._uniformGroupSyncHash[J._signature] = {})
            , $ = this._getSignature(J, Q._uniformData, "u");
        if (!this._cache[$])
            this._cache[$] = this._generateUniformsSync(J, Q._uniformData);
        return Z[Q._key] = this._cache[$],
            Z[Q._key]
    }
    _generateUniformsSync(J, Q) {
        return Gk(J, Q)
    }
    _getSignature(J, Q, Z) {
        let $ = J.uniforms
            , q = [`${Z}-`];
        for (let K in $)
            if (q.push(K),
                Q[K])
                q.push(Q[K].type);
        return q.join("-")
    }
    destroy() {
        this._renderer = null,
            this._cache = null
    }
}
var Dk = O(() => {
    w0();
    Pk();
    pK.extension = {
        type: [R.WebGLSystem],
        name: "uniformGroup"
    }
}
);
function Ak(J) {
    let Q = {};
    if (Q.normal = [J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q.add = [J.ONE, J.ONE],
        Q.multiply = [J.DST_COLOR, J.ONE_MINUS_SRC_ALPHA, J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q.screen = [J.ONE, J.ONE_MINUS_SRC_COLOR, J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q.none = [0, 0],
        Q["normal-npm"] = [J.SRC_ALPHA, J.ONE_MINUS_SRC_ALPHA, J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q["add-npm"] = [J.SRC_ALPHA, J.ONE, J.ONE, J.ONE],
        Q["screen-npm"] = [J.SRC_ALPHA, J.ONE_MINUS_SRC_COLOR, J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q.erase = [J.ZERO, J.ONE_MINUS_SRC_ALPHA],
        !(J instanceof a0.get().getWebGLRenderingContext()))
        Q.min = [J.ONE, J.ONE, J.ONE, J.ONE, J.MIN, J.MIN],
            Q.max = [J.ONE, J.ONE, J.ONE, J.ONE, J.MAX, J.MAX];
    else {
        let $ = J.getExtension("EXT_blend_minmax");
        if ($)
            Q.min = [J.ONE, J.ONE, J.ONE, J.ONE, $.MIN_EXT, $.MIN_EXT],
                Q.max = [J.ONE, J.ONE, J.ONE, J.ONE, $.MAX_EXT, $.MAX_EXT]
    }
    return Q
}
var Ek = O(() => {
    M6()
}
);
var _m = 0, Rm = 1, bm = 2, vm = 3, Sm = 4, Tm = 5, g_ = class J {
    constructor(Q) {
        this._invertFrontFace = !1,
            this.gl = null,
            this.stateId = 0,
            this.polygonOffset = 0,
            this.blendMode = "none",
            this._blendEq = !1,
            this.map = [],
            this.map[_m] = this.setBlend,
            this.map[Rm] = this.setOffset,
            this.map[bm] = this.setCullFace,
            this.map[vm] = this.setDepthTest,
            this.map[Sm] = this.setFrontFace,
            this.map[Tm] = this.setDepthMask,
            this.checks = [],
            this.defaultState = U7.for2d(),
            Q.renderTarget.onRenderTargetChange.add(this)
    }
    onRenderTargetChange(Q) {
        if (this._invertFrontFace = !Q.isRoot,
            this._cullFace)
            this.setFrontFace(this._frontFace);
        else
            this._frontFaceDirty = !0
    }
    contextChange(Q) {
        this.gl = Q,
            this.blendModesMap = Ak(Q),
            this.resetState()
    }
    set(Q) {
        if (Q || (Q = this.defaultState),
            this.stateId !== Q.data) {
            let Z = this.stateId ^ Q.data
                , $ = 0;
            while (Z) {
                if (Z & 1)
                    this.map[$].call(this, !!(Q.data & 1 << $));
                Z >>= 1,
                    $++
            }
            this.stateId = Q.data
        }
        for (let Z = 0; Z < this.checks.length; Z++)
            this.checks[Z](this, Q)
    }
    forceState(Q) {
        Q || (Q = this.defaultState);
        for (let Z = 0; Z < this.map.length; Z++)
            this.map[Z].call(this, !!(Q.data & 1 << Z));
        for (let Z = 0; Z < this.checks.length; Z++)
            this.checks[Z](this, Q);
        this.stateId = Q.data
    }
    setBlend(Q) {
        this._updateCheck(J._checkBlendMode, Q),
            this.gl[Q ? "enable" : "disable"](this.gl.BLEND)
    }
    setOffset(Q) {
        this._updateCheck(J._checkPolygonOffset, Q),
            this.gl[Q ? "enable" : "disable"](this.gl.POLYGON_OFFSET_FILL)
    }
    setDepthTest(Q) {
        this.gl[Q ? "enable" : "disable"](this.gl.DEPTH_TEST)
    }
    setDepthMask(Q) {
        this.gl.depthMask(Q)
    }
    setCullFace(Q) {
        if (this._cullFace = Q,
            this.gl[Q ? "enable" : "disable"](this.gl.CULL_FACE),
            this._cullFace && this._frontFaceDirty)
            this.setFrontFace(this._frontFace)
    }
    setFrontFace(Q) {
        this._frontFace = Q,
            this._frontFaceDirty = !1;
        let Z = this._invertFrontFace ? !Q : Q;
        if (this._glFrontFace !== Z)
            this._glFrontFace = Z,
                this.gl.frontFace(this.gl[Z ? "CW" : "CCW"])
    }
    setBlendMode(Q) {
        if (!this.blendModesMap[Q])
            Q = "normal";
        if (Q === this.blendMode)
            return;
        this.blendMode = Q;
        let Z = this.blendModesMap[Q]
            , $ = this.gl;
        if (Z.length === 2)
            $.blendFunc(Z[0], Z[1]);
        else
            $.blendFuncSeparate(Z[0], Z[1], Z[2], Z[3]);
        if (Z.length === 6)
            this._blendEq = !0,
                $.blendEquationSeparate(Z[4], Z[5]);
        else if (this._blendEq)
            this._blendEq = !1,
                $.blendEquationSeparate($.FUNC_ADD, $.FUNC_ADD)
    }
    setPolygonOffset(Q, Z) {
        this.gl.polygonOffset(Q, Z)
    }
    resetState() {
        this._glFrontFace = !1,
            this._frontFace = !1,
            this._cullFace = !1,
            this._frontFaceDirty = !1,
            this._invertFrontFace = !1,
            this.gl.frontFace(this.gl.CCW),
            this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL, !1),
            this.forceState(this.defaultState),
            this._blendEq = !0,
            this.blendMode = "",
            this.setBlendMode("normal")
    }
    _updateCheck(Q, Z) {
        let $ = this.checks.indexOf(Q);
        if (Z && $ === -1)
            this.checks.push(Q);
        else if (!Z && $ !== -1)
            this.checks.splice($, 1)
    }
    static _checkBlendMode(Q, Z) {
        Q.setBlendMode(Z.blendMode)
    }
    static _checkPolygonOffset(Q, Z) {
        Q.setPolygonOffset(1, Z.polygonOffset)
    }
    destroy() {
        this.gl = null,
            this.checks.length = 0
    }
}
    , Mk;
var _k = O(() => {
    w0();
    q5();
    Ek();
    g_.extension = {
        type: [R.WebGLSystem],
        name: "state"
    };
    Mk = g_
}
);
class fW {
    constructor(J) {
        this.target = DW.TEXTURE_2D,
            this.texture = J,
            this.width = -1,
            this.height = -1,
            this.type = I6.UNSIGNED_BYTE,
            this.internalFormat = SK.RGBA,
            this.format = SK.RGBA,
            this.samplerType = 0
    }
}
var Rk = O(() => {
    AW()
}
);
var bk;
var vk = O(() => {
    bk = {
        id: "buffer",
        upload(J, Q, Z) {
            if (Q.width === J.width || Q.height === J.height)
                Z.texSubImage2D(Z.TEXTURE_2D, 0, 0, 0, J.width, J.height, Q.format, Q.type, J.resource);
            else
                Z.texImage2D(Q.target, 0, Q.internalFormat, J.width, J.height, 0, Q.format, Q.type, J.resource);
            Q.width = J.width,
                Q.height = J.height
        }
    }
}
);
var ym, Sk;
var Tk = O(() => {
    ym = {
        "bc1-rgba-unorm": !0,
        "bc1-rgba-unorm-srgb": !0,
        "bc2-rgba-unorm": !0,
        "bc2-rgba-unorm-srgb": !0,
        "bc3-rgba-unorm": !0,
        "bc3-rgba-unorm-srgb": !0,
        "bc4-r-unorm": !0,
        "bc4-r-snorm": !0,
        "bc5-rg-unorm": !0,
        "bc5-rg-snorm": !0,
        "bc6h-rgb-ufloat": !0,
        "bc6h-rgb-float": !0,
        "bc7-rgba-unorm": !0,
        "bc7-rgba-unorm-srgb": !0,
        "etc2-rgb8unorm": !0,
        "etc2-rgb8unorm-srgb": !0,
        "etc2-rgb8a1unorm": !0,
        "etc2-rgb8a1unorm-srgb": !0,
        "etc2-rgba8unorm": !0,
        "etc2-rgba8unorm-srgb": !0,
        "eac-r11unorm": !0,
        "eac-r11snorm": !0,
        "eac-rg11unorm": !0,
        "eac-rg11snorm": !0,
        "astc-4x4-unorm": !0,
        "astc-4x4-unorm-srgb": !0,
        "astc-5x4-unorm": !0,
        "astc-5x4-unorm-srgb": !0,
        "astc-5x5-unorm": !0,
        "astc-5x5-unorm-srgb": !0,
        "astc-6x5-unorm": !0,
        "astc-6x5-unorm-srgb": !0,
        "astc-6x6-unorm": !0,
        "astc-6x6-unorm-srgb": !0,
        "astc-8x5-unorm": !0,
        "astc-8x5-unorm-srgb": !0,
        "astc-8x6-unorm": !0,
        "astc-8x6-unorm-srgb": !0,
        "astc-8x8-unorm": !0,
        "astc-8x8-unorm-srgb": !0,
        "astc-10x5-unorm": !0,
        "astc-10x5-unorm-srgb": !0,
        "astc-10x6-unorm": !0,
        "astc-10x6-unorm-srgb": !0,
        "astc-10x8-unorm": !0,
        "astc-10x8-unorm-srgb": !0,
        "astc-10x10-unorm": !0,
        "astc-10x10-unorm-srgb": !0,
        "astc-12x10-unorm": !0,
        "astc-12x10-unorm-srgb": !0,
        "astc-12x12-unorm": !0,
        "astc-12x12-unorm-srgb": !0
    },
        Sk = {
            id: "compressed",
            upload(J, Q, Z) {
                Z.pixelStorei(Z.UNPACK_ALIGNMENT, 4);
                let { pixelWidth: $, pixelHeight: q } = J
                    , K = !!ym[J.format];
                for (let V = 0; V < J.resource.length; V++) {
                    let z = J.resource[V];
                    if (K)
                        Z.compressedTexImage2D(Z.TEXTURE_2D, V, Q.internalFormat, $, q, 0, z);
                    else
                        Z.texImage2D(Z.TEXTURE_2D, V, Q.internalFormat, $, q, 0, Q.format, Q.type, z);
                    $ = Math.max($ >> 1, 1),
                        q = Math.max(q >> 1, 1)
                }
            }
        }
}
);
var uK;
var hW = O(() => {
    uK = {
        id: "image",
        upload(J, Q, Z, $) {
            let { width: q, height: K } = Q
                , V = J.pixelWidth
                , z = J.pixelHeight
                , W = J.resourceWidth
                , H = J.resourceHeight;
            if (W < V || H < z) {
                if (q !== V || K !== z)
                    Z.texImage2D(Q.target, 0, Q.internalFormat, V, z, 0, Q.format, Q.type, null);
                if ($ === 2)
                    Z.texSubImage2D(Z.TEXTURE_2D, 0, 0, 0, W, H, Q.format, Q.type, J.resource);
                else
                    Z.texSubImage2D(Z.TEXTURE_2D, 0, 0, 0, Q.format, Q.type, J.resource)
            } else if (q === V && K === z)
                Z.texSubImage2D(Z.TEXTURE_2D, 0, 0, 0, Q.format, Q.type, J.resource);
            else if ($ === 2)
                Z.texImage2D(Q.target, 0, Q.internalFormat, V, z, 0, Q.format, Q.type, J.resource);
            else
                Z.texImage2D(Q.target, 0, Q.internalFormat, Q.format, Q.type, J.resource);
            Q.width = V,
                Q.height = z
        }
    }
}
);
var yk;
var fk = O(() => {
    hW();
    yk = {
        id: "video",
        upload(J, Q, Z, $) {
            if (!J.isValid) {
                Z.texImage2D(Q.target, 0, Q.internalFormat, 1, 1, 0, Q.format, Q.type, null);
                return
            }
            uK.upload(J, Q, Z, $)
        }
    }
}
);
var xW, hk, lK, xk;
var gk = O(() => {
    xW = {
        linear: 9729,
        nearest: 9728
    },
        hk = {
            linear: {
                linear: 9987,
                nearest: 9985
            },
            nearest: {
                linear: 9986,
                nearest: 9984
            }
        },
        lK = {
            "clamp-to-edge": 33071,
            repeat: 10497,
            "mirror-repeat": 33648
        },
        xk = {
            never: 512,
            less: 513,
            equal: 514,
            "less-equal": 515,
            greater: 516,
            "not-equal": 517,
            "greater-equal": 518,
            always: 519
        }
}
);
function gW(J, Q, Z, $, q, K, V, z) {
    let W = K;
    if (!z || J.addressModeU !== "repeat" || J.addressModeV !== "repeat" || J.addressModeW !== "repeat") {
        let H = lK[V ? "clamp-to-edge" : J.addressModeU]
            , Y = lK[V ? "clamp-to-edge" : J.addressModeV]
            , U = lK[V ? "clamp-to-edge" : J.addressModeW];
        if (Q[q](W, Q.TEXTURE_WRAP_S, H),
            Q[q](W, Q.TEXTURE_WRAP_T, Y),
            Q.TEXTURE_WRAP_R)
            Q[q](W, Q.TEXTURE_WRAP_R, U)
    }
    if (!z || J.magFilter !== "linear")
        Q[q](W, Q.TEXTURE_MAG_FILTER, xW[J.magFilter]);
    if (Z) {
        if (!z || J.mipmapFilter !== "linear") {
            let H = hk[J.minFilter][J.mipmapFilter];
            Q[q](W, Q.TEXTURE_MIN_FILTER, H)
        }
    } else
        Q[q](W, Q.TEXTURE_MIN_FILTER, xW[J.minFilter]);
    if ($ && J.maxAnisotropy > 1) {
        let H = Math.min(J.maxAnisotropy, Q.getParameter($.MAX_TEXTURE_MAX_ANISOTROPY_EXT));
        Q[q](W, $.TEXTURE_MAX_ANISOTROPY_EXT, H)
    }
    if (J.compare)
        Q[q](W, Q.TEXTURE_COMPARE_FUNC, xk[J.compare])
}
var mk = O(() => {
    gk()
}
);
function ck(J) {
    return {
        r8unorm: J.RED,
        r8snorm: J.RED,
        r8uint: J.RED,
        r8sint: J.RED,
        r16uint: J.RED,
        r16sint: J.RED,
        r16float: J.RED,
        rg8unorm: J.RG,
        rg8snorm: J.RG,
        rg8uint: J.RG,
        rg8sint: J.RG,
        r32uint: J.RED,
        r32sint: J.RED,
        r32float: J.RED,
        rg16uint: J.RG,
        rg16sint: J.RG,
        rg16float: J.RG,
        rgba8unorm: J.RGBA,
        "rgba8unorm-srgb": J.RGBA,
        rgba8snorm: J.RGBA,
        rgba8uint: J.RGBA,
        rgba8sint: J.RGBA,
        bgra8unorm: J.RGBA,
        "bgra8unorm-srgb": J.RGBA,
        rgb9e5ufloat: J.RGB,
        rgb10a2unorm: J.RGBA,
        rg11b10ufloat: J.RGB,
        rg32uint: J.RG,
        rg32sint: J.RG,
        rg32float: J.RG,
        rgba16uint: J.RGBA,
        rgba16sint: J.RGBA,
        rgba16float: J.RGBA,
        rgba32uint: J.RGBA,
        rgba32sint: J.RGBA,
        rgba32float: J.RGBA,
        stencil8: J.STENCIL_INDEX8,
        depth16unorm: J.DEPTH_COMPONENT,
        depth24plus: J.DEPTH_COMPONENT,
        "depth24plus-stencil8": J.DEPTH_STENCIL,
        depth32float: J.DEPTH_COMPONENT,
        "depth32float-stencil8": J.DEPTH_STENCIL
    }
}
var dk = () => { }
    ;
function pk(J, Q) {
    let Z = {}
        , $ = J.RGBA;
    if (!(J instanceof a0.get().getWebGLRenderingContext()))
        Z = {
            "rgba8unorm-srgb": J.SRGB8_ALPHA8,
            "bgra8unorm-srgb": J.SRGB8_ALPHA8
        },
            $ = J.RGBA8;
    else if (Q.srgb)
        Z = {
            "rgba8unorm-srgb": Q.srgb.SRGB8_ALPHA8_EXT,
            "bgra8unorm-srgb": Q.srgb.SRGB8_ALPHA8_EXT
        };
    return {
        r8unorm: J.R8,
        r8snorm: J.R8_SNORM,
        r8uint: J.R8UI,
        r8sint: J.R8I,
        r16uint: J.R16UI,
        r16sint: J.R16I,
        r16float: J.R16F,
        rg8unorm: J.RG8,
        rg8snorm: J.RG8_SNORM,
        rg8uint: J.RG8UI,
        rg8sint: J.RG8I,
        r32uint: J.R32UI,
        r32sint: J.R32I,
        r32float: J.R32F,
        rg16uint: J.RG16UI,
        rg16sint: J.RG16I,
        rg16float: J.RG16F,
        rgba8unorm: J.RGBA,
        ...Z,
        rgba8snorm: J.RGBA8_SNORM,
        rgba8uint: J.RGBA8UI,
        rgba8sint: J.RGBA8I,
        bgra8unorm: $,
        rgb9e5ufloat: J.RGB9_E5,
        rgb10a2unorm: J.RGB10_A2,
        rg11b10ufloat: J.R11F_G11F_B10F,
        rg32uint: J.RG32UI,
        rg32sint: J.RG32I,
        rg32float: J.RG32F,
        rgba16uint: J.RGBA16UI,
        rgba16sint: J.RGBA16I,
        rgba16float: J.RGBA16F,
        rgba32uint: J.RGBA32UI,
        rgba32sint: J.RGBA32I,
        rgba32float: J.RGBA32F,
        stencil8: J.STENCIL_INDEX8,
        depth16unorm: J.DEPTH_COMPONENT16,
        depth24plus: J.DEPTH_COMPONENT24,
        "depth24plus-stencil8": J.DEPTH24_STENCIL8,
        depth32float: J.DEPTH_COMPONENT32F,
        "depth32float-stencil8": J.DEPTH32F_STENCIL8,
        ...Q.s3tc ? {
            "bc1-rgba-unorm": Q.s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT,
            "bc2-rgba-unorm": Q.s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT,
            "bc3-rgba-unorm": Q.s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT
        } : {},
        ...Q.s3tc_sRGB ? {
            "bc1-rgba-unorm-srgb": Q.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,
            "bc2-rgba-unorm-srgb": Q.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,
            "bc3-rgba-unorm-srgb": Q.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT
        } : {},
        ...Q.rgtc ? {
            "bc4-r-unorm": Q.rgtc.COMPRESSED_RED_RGTC1_EXT,
            "bc4-r-snorm": Q.rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT,
            "bc5-rg-unorm": Q.rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT,
            "bc5-rg-snorm": Q.rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT
        } : {},
        ...Q.bptc ? {
            "bc6h-rgb-float": Q.bptc.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,
            "bc6h-rgb-ufloat": Q.bptc.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,
            "bc7-rgba-unorm": Q.bptc.COMPRESSED_RGBA_BPTC_UNORM_EXT,
            "bc7-rgba-unorm-srgb": Q.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT
        } : {},
        ...Q.etc ? {
            "etc2-rgb8unorm": Q.etc.COMPRESSED_RGB8_ETC2,
            "etc2-rgb8unorm-srgb": Q.etc.COMPRESSED_SRGB8_ETC2,
            "etc2-rgb8a1unorm": Q.etc.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,
            "etc2-rgb8a1unorm-srgb": Q.etc.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,
            "etc2-rgba8unorm": Q.etc.COMPRESSED_RGBA8_ETC2_EAC,
            "etc2-rgba8unorm-srgb": Q.etc.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC,
            "eac-r11unorm": Q.etc.COMPRESSED_R11_EAC,
            "eac-rg11unorm": Q.etc.COMPRESSED_SIGNED_RG11_EAC
        } : {},
        ...Q.astc ? {
            "astc-4x4-unorm": Q.astc.COMPRESSED_RGBA_ASTC_4x4_KHR,
            "astc-4x4-unorm-srgb": Q.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR,
            "astc-5x4-unorm": Q.astc.COMPRESSED_RGBA_ASTC_5x4_KHR,
            "astc-5x4-unorm-srgb": Q.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR,
            "astc-5x5-unorm": Q.astc.COMPRESSED_RGBA_ASTC_5x5_KHR,
            "astc-5x5-unorm-srgb": Q.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR,
            "astc-6x5-unorm": Q.astc.COMPRESSED_RGBA_ASTC_6x5_KHR,
            "astc-6x5-unorm-srgb": Q.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR,
            "astc-6x6-unorm": Q.astc.COMPRESSED_RGBA_ASTC_6x6_KHR,
            "astc-6x6-unorm-srgb": Q.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR,
            "astc-8x5-unorm": Q.astc.COMPRESSED_RGBA_ASTC_8x5_KHR,
            "astc-8x5-unorm-srgb": Q.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR,
            "astc-8x6-unorm": Q.astc.COMPRESSED_RGBA_ASTC_8x6_KHR,
            "astc-8x6-unorm-srgb": Q.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR,
            "astc-8x8-unorm": Q.astc.COMPRESSED_RGBA_ASTC_8x8_KHR,
            "astc-8x8-unorm-srgb": Q.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR,
            "astc-10x5-unorm": Q.astc.COMPRESSED_RGBA_ASTC_10x5_KHR,
            "astc-10x5-unorm-srgb": Q.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR,
            "astc-10x6-unorm": Q.astc.COMPRESSED_RGBA_ASTC_10x6_KHR,
            "astc-10x6-unorm-srgb": Q.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR,
            "astc-10x8-unorm": Q.astc.COMPRESSED_RGBA_ASTC_10x8_KHR,
            "astc-10x8-unorm-srgb": Q.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR,
            "astc-10x10-unorm": Q.astc.COMPRESSED_RGBA_ASTC_10x10_KHR,
            "astc-10x10-unorm-srgb": Q.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR,
            "astc-12x10-unorm": Q.astc.COMPRESSED_RGBA_ASTC_12x10_KHR,
            "astc-12x10-unorm-srgb": Q.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR,
            "astc-12x12-unorm": Q.astc.COMPRESSED_RGBA_ASTC_12x12_KHR,
            "astc-12x12-unorm-srgb": Q.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR
        } : {}
    }
}
var uk = O(() => {
    M6()
}
);
function lk(J) {
    return {
        r8unorm: J.UNSIGNED_BYTE,
        r8snorm: J.BYTE,
        r8uint: J.UNSIGNED_BYTE,
        r8sint: J.BYTE,
        r16uint: J.UNSIGNED_SHORT,
        r16sint: J.SHORT,
        r16float: J.HALF_FLOAT,
        rg8unorm: J.UNSIGNED_BYTE,
        rg8snorm: J.BYTE,
        rg8uint: J.UNSIGNED_BYTE,
        rg8sint: J.BYTE,
        r32uint: J.UNSIGNED_INT,
        r32sint: J.INT,
        r32float: J.FLOAT,
        rg16uint: J.UNSIGNED_SHORT,
        rg16sint: J.SHORT,
        rg16float: J.HALF_FLOAT,
        rgba8unorm: J.UNSIGNED_BYTE,
        "rgba8unorm-srgb": J.UNSIGNED_BYTE,
        rgba8snorm: J.BYTE,
        rgba8uint: J.UNSIGNED_BYTE,
        rgba8sint: J.BYTE,
        bgra8unorm: J.UNSIGNED_BYTE,
        "bgra8unorm-srgb": J.UNSIGNED_BYTE,
        rgb9e5ufloat: J.UNSIGNED_INT_5_9_9_9_REV,
        rgb10a2unorm: J.UNSIGNED_INT_2_10_10_10_REV,
        rg11b10ufloat: J.UNSIGNED_INT_10F_11F_11F_REV,
        rg32uint: J.UNSIGNED_INT,
        rg32sint: J.INT,
        rg32float: J.FLOAT,
        rgba16uint: J.UNSIGNED_SHORT,
        rgba16sint: J.SHORT,
        rgba16float: J.HALF_FLOAT,
        rgba32uint: J.UNSIGNED_INT,
        rgba32sint: J.INT,
        rgba32float: J.FLOAT,
        stencil8: J.UNSIGNED_BYTE,
        depth16unorm: J.UNSIGNED_SHORT,
        depth24plus: J.UNSIGNED_INT,
        "depth24plus-stencil8": J.UNSIGNED_INT_24_8,
        depth32float: J.FLOAT,
        "depth32float-stencil8": J.FLOAT_32_UNSIGNED_INT_24_8_REV
    }
}
var ok = () => { }
    ;
var nk = () => { }
    ;
class oK {
    constructor(J) {
        this.managedTextures = [],
            this._glTextures = Object.create(null),
            this._glSamplers = Object.create(null),
            this._boundTextures = [],
            this._activeTextureLocation = -1,
            this._boundSamplers = Object.create(null),
            this._uploads = {
                image: uK,
                buffer: bk,
                video: yk,
                compressed: Sk
            },
            this._premultiplyAlpha = !1,
            this._useSeparateSamplers = !1,
            this._renderer = J,
            this._renderer.renderableGC.addManagedHash(this, "_glTextures"),
            this._renderer.renderableGC.addManagedHash(this, "_glSamplers")
    }
    contextChange(J) {
        if (this._gl = J,
            !this._mapFormatToInternalFormat)
            this._mapFormatToInternalFormat = pk(J, this._renderer.context.extensions),
                this._mapFormatToType = lk(J),
                this._mapFormatToFormat = ck(J);
        this._glTextures = Object.create(null),
            this._glSamplers = Object.create(null),
            this._boundSamplers = Object.create(null),
            this._premultiplyAlpha = !1;
        for (let Q = 0; Q < 16; Q++)
            this.bind(_0.EMPTY, Q)
    }
    initSource(J) {
        this.bind(J)
    }
    bind(J, Q = 0) {
        let Z = J.source;
        if (J) {
            if (this.bindSource(Z, Q),
                this._useSeparateSamplers)
                this._bindSampler(Z.style, Q)
        } else if (this.bindSource(null, Q),
            this._useSeparateSamplers)
            this._bindSampler(null, Q)
    }
    bindSource(J, Q = 0) {
        let Z = this._gl;
        if (J._touched = this._renderer.textureGC.count,
            this._boundTextures[Q] !== J) {
            this._boundTextures[Q] = J,
                this._activateLocation(Q),
                J || (J = _0.EMPTY.source);
            let $ = this.getGlSource(J);
            Z.bindTexture($.target, $.texture)
        }
    }
    _bindSampler(J, Q = 0) {
        let Z = this._gl;
        if (!J) {
            this._boundSamplers[Q] = null,
                Z.bindSampler(Q, null);
            return
        }
        let $ = this._getGlSampler(J);
        if (this._boundSamplers[Q] !== $)
            this._boundSamplers[Q] = $,
                Z.bindSampler(Q, $)
    }
    unbind(J) {
        let Q = J.source
            , Z = this._boundTextures
            , $ = this._gl;
        for (let q = 0; q < Z.length; q++)
            if (Z[q] === Q) {
                this._activateLocation(q);
                let K = this.getGlSource(Q);
                $.bindTexture(K.target, null),
                    Z[q] = null
            }
    }
    _activateLocation(J) {
        if (this._activeTextureLocation !== J)
            this._activeTextureLocation = J,
                this._gl.activeTexture(this._gl.TEXTURE0 + J)
    }
    _initSource(J) {
        let Q = this._gl
            , Z = new fW(Q.createTexture());
        if (Z.type = this._mapFormatToType[J.format],
            Z.internalFormat = this._mapFormatToInternalFormat[J.format],
            Z.format = this._mapFormatToFormat[J.format],
            J.autoGenerateMipmaps && (this._renderer.context.supports.nonPowOf2mipmaps || J.isPowerOfTwo)) {
            let $ = Math.max(J.width, J.height);
            J.mipLevelCount = Math.floor(Math.log2($)) + 1
        }
        if (this._glTextures[J.uid] = Z,
            !this.managedTextures.includes(J))
            J.on("update", this.onSourceUpdate, this),
                J.on("resize", this.onSourceUpdate, this),
                J.on("styleChange", this.onStyleChange, this),
                J.on("destroy", this.onSourceDestroy, this),
                J.on("unload", this.onSourceUnload, this),
                J.on("updateMipmaps", this.onUpdateMipmaps, this),
                this.managedTextures.push(J);
        return this.onSourceUpdate(J),
            this.updateStyle(J, !1),
            Z
    }
    onStyleChange(J) {
        this.updateStyle(J, !1)
    }
    updateStyle(J, Q) {
        let Z = this._gl
            , $ = this.getGlSource(J);
        Z.bindTexture(Z.TEXTURE_2D, $.texture),
            this._boundTextures[this._activeTextureLocation] = J,
            gW(J.style, Z, J.mipLevelCount > 1, this._renderer.context.extensions.anisotropicFiltering, "texParameteri", Z.TEXTURE_2D, !this._renderer.context.supports.nonPowOf2wrapping && !J.isPowerOfTwo, Q)
    }
    onSourceUnload(J) {
        let Q = this._glTextures[J.uid];
        if (!Q)
            return;
        this.unbind(J),
            this._glTextures[J.uid] = null,
            this._gl.deleteTexture(Q.texture)
    }
    onSourceUpdate(J) {
        let Q = this._gl
            , Z = this.getGlSource(J);
        Q.bindTexture(Q.TEXTURE_2D, Z.texture),
            this._boundTextures[this._activeTextureLocation] = J;
        let $ = J.alphaMode === "premultiply-alpha-on-upload";
        if (this._premultiplyAlpha !== $)
            this._premultiplyAlpha = $,
                Q.pixelStorei(Q.UNPACK_PREMULTIPLY_ALPHA_WEBGL, $);
        if (this._uploads[J.uploadMethodId])
            this._uploads[J.uploadMethodId].upload(J, Z, Q, this._renderer.context.webGLVersion);
        else
            Q.texImage2D(Q.TEXTURE_2D, 0, Q.RGBA, J.pixelWidth, J.pixelHeight, 0, Q.RGBA, Q.UNSIGNED_BYTE, null);
        if (J.autoGenerateMipmaps && J.mipLevelCount > 1)
            this.onUpdateMipmaps(J, !1)
    }
    onUpdateMipmaps(J, Q = !0) {
        if (Q)
            this.bindSource(J, 0);
        let Z = this.getGlSource(J);
        this._gl.generateMipmap(Z.target)
    }
    onSourceDestroy(J) {
        J.off("destroy", this.onSourceDestroy, this),
            J.off("update", this.onSourceUpdate, this),
            J.off("resize", this.onSourceUpdate, this),
            J.off("unload", this.onSourceUnload, this),
            J.off("styleChange", this.onStyleChange, this),
            J.off("updateMipmaps", this.onUpdateMipmaps, this),
            this.managedTextures.splice(this.managedTextures.indexOf(J), 1),
            this.onSourceUnload(J)
    }
    _initSampler(J) {
        let Q = this._gl
            , Z = this._gl.createSampler();
        return this._glSamplers[J._resourceId] = Z,
            gW(J, Q, this._boundTextures[this._activeTextureLocation].mipLevelCount > 1, this._renderer.context.extensions.anisotropicFiltering, "samplerParameteri", Z, !1, !0),
            this._glSamplers[J._resourceId]
    }
    _getGlSampler(J) {
        return this._glSamplers[J._resourceId] || this._initSampler(J)
    }
    getGlSource(J) {
        return this._glTextures[J.uid] || this._initSource(J)
    }
    generateCanvas(J) {
        let { pixels: Q, width: Z, height: $ } = this.getPixels(J)
            , q = a0.get().createCanvas();
        q.width = Z,
            q.height = $;
        let K = q.getContext("2d");
        if (K) {
            let V = K.createImageData(Z, $);
            V.data.set(Q),
                K.putImageData(V, 0, 0)
        }
        return q
    }
    getPixels(J) {
        let Q = J.source.resolution
            , Z = J.frame
            , $ = Math.max(Math.round(Z.width * Q), 1)
            , q = Math.max(Math.round(Z.height * Q), 1)
            , K = new Uint8Array(fm * $ * q)
            , V = this._renderer
            , z = V.renderTarget.getRenderTarget(J)
            , W = V.renderTarget.getGpuRenderTarget(z)
            , H = V.gl;
        return H.bindFramebuffer(H.FRAMEBUFFER, W.resolveTargetFramebuffer),
            H.readPixels(Math.round(Z.x * Q), Math.round(Z.y * Q), $, q, H.RGBA, H.UNSIGNED_BYTE, K),
        {
            pixels: new Uint8ClampedArray(K.buffer),
            width: $,
            height: q
        }
    }
    destroy() {
        this.managedTextures.slice().forEach((J) => this.onSourceDestroy(J)),
            this.managedTextures = null,
            this._renderer = null
    }
    resetState() {
        this._activeTextureLocation = -1,
            this._boundTextures.fill(_0.EMPTY.source),
            this._boundSamplers = Object.create(null);
        let J = this._gl;
        this._premultiplyAlpha = !1,
            J.pixelStorei(J.UNPACK_PREMULTIPLY_ALPHA_WEBGL, this._premultiplyAlpha)
    }
}
var fm = 4;
var sk = O(() => {
    M6();
    w0();
    W6();
    Rk();
    vk();
    Tk();
    hW();
    fk();
    mk();
    dk();
    uk();
    ok();
    nk();
    oK.extension = {
        type: [R.WebGLSystem],
        name: "texture"
    }
}
);
var p_ = {};
WL(p_, {
    WebGLRenderer: () => ik
});
var hm, xm, gm, m_, c_, d_, ik;
var ak = O(() => {
    w0();
    RB();
    bB();
    vB();
    T$();
    WW();
    $5();
    yB();
    hB();
    mB();
    dB();
    pB();
    uB();
    lB();
    oB();
    tB();
    Qk();
    Ok();
    Dk();
    _k();
    sk();
    hm = [...HK, gK, cB, fB, hK, vK, oK, mK, TK, pK, dK, fK, Mk, xK, yK],
        xm = [...YK],
        gm = [bK, RK, _K],
        m_ = [],
        c_ = [],
        d_ = [];
    e0.handleByNamedList(R.WebGLSystem, m_);
    e0.handleByNamedList(R.WebGLPipes, c_);
    e0.handleByNamedList(R.WebGLPipesAdaptor, d_);
    e0.add(...hm, ...xm, ...gm);
    ik = class ik extends x9 {
        constructor() {
            let J = {
                name: "webgl",
                type: W7.WEBGL,
                systems: m_,
                renderPipes: c_,
                renderPipeAdaptors: d_
            };
            super(J)
        }
    }
}
);
var JH = G5((cc) => {
    function gc(J, Q, Z) {
        if (Z === void 0)
            Z = Array.prototype;
        if (J && typeof Z.find === "function")
            return Z.find.call(J, Q);
        for (var $ = 0; $ < J.length; $++)
            if (Object.prototype.hasOwnProperty.call(J, $)) {
                var q = J[$];
                if (Q.call(void 0, q, $, J))
                    return q
            }
    }
    function SG(J, Q) {
        if (Q === void 0)
            Q = Object;
        return Q && typeof Q.freeze === "function" ? Q.freeze(J) : J
    }
    function mc(J, Q) {
        if (J === null || typeof J !== "object")
            throw new TypeError("target is not an object");
        for (var Z in Q)
            if (Object.prototype.hasOwnProperty.call(Q, Z))
                J[Z] = Q[Z];
        return J
    }
    var zR = SG({
        HTML: "text/html",
        isHTML: function (J) {
            return J === zR.HTML
        },
        XML_APPLICATION: "application/xml",
        XML_TEXT: "text/xml",
        XML_XHTML_APPLICATION: "application/xhtml+xml",
        XML_SVG_IMAGE: "image/svg+xml"
    })
        , WR = SG({
            HTML: "http://www.w3.org/1999/xhtml",
            isHTML: function (J) {
                return J === WR.HTML
            },
            SVG: "http://www.w3.org/2000/svg",
            XML: "http://www.w3.org/XML/1998/namespace",
            XMLNS: "http://www.w3.org/2000/xmlns/"
        });
    cc.assign = mc;
    cc.find = gc;
    cc.freeze = SG;
    cc.MIME_TYPE = zR;
    cc.NAMESPACE = WR
}
);
var uG = G5((Vd) => {
    var BR = JH()
        , u9 = BR.find
        , QH = BR.NAMESPACE;
    function nc(J) {
        return J !== ""
    }
    function sc(J) {
        return J ? J.split(/[\t\n\f\r ]+/).filter(nc) : []
    }
    function ic(J, Q) {
        if (!J.hasOwnProperty(Q))
            J[Q] = !0;
        return J
    }
    function HR(J) {
        if (!J)
            return [];
        var Q = sc(J);
        return Object.keys(Q.reduce(ic, {}))
    }
    function ac(J) {
        return function (Q) {
            return J && J.indexOf(Q) !== -1
        }
    }
    function $H(J, Q) {
        for (var Z in J)
            if (Object.prototype.hasOwnProperty.call(J, Z))
                Q[Z] = J[Z]
    }
    function z5(J, Q) {
        var Z = J.prototype;
        if (!(Z instanceof Q)) {
            let q = function () { };
            var $ = q;
            q.prototype = Q.prototype,
                q = new q,
                $H(Z, q),
                J.prototype = Z = q
        }
        if (Z.constructor != J)
            Z.constructor = J
    }
    var W5 = {}
        , Y9 = W5.ELEMENT_NODE = 1
        , K4 = W5.ATTRIBUTE_NODE = 2
        , bC = W5.TEXT_NODE = 3
        , kR = W5.CDATA_SECTION_NODE = 4
        , CR = W5.ENTITY_REFERENCE_NODE = 5
        , rc = W5.ENTITY_NODE = 6
        , OR = W5.PROCESSING_INSTRUCTION_NODE = 7
        , IR = W5.COMMENT_NODE = 8
        , LR = W5.DOCUMENT_NODE = 9
        , FR = W5.DOCUMENT_TYPE_NODE = 10
        , RQ = W5.DOCUMENT_FRAGMENT_NODE = 11
        , tc = W5.NOTATION_NODE = 12
        , vJ = {}
        , YJ = {}
        , gk0 = vJ.INDEX_SIZE_ERR = (YJ[1] = "Index size error",
            1)
        , mk0 = vJ.DOMSTRING_SIZE_ERR = (YJ[2] = "DOMString size error",
            2)
        , V5 = vJ.HIERARCHY_REQUEST_ERR = (YJ[3] = "Hierarchy request error",
            3)
        , ck0 = vJ.WRONG_DOCUMENT_ERR = (YJ[4] = "Wrong document",
            4)
        , dk0 = vJ.INVALID_CHARACTER_ERR = (YJ[5] = "Invalid character",
            5)
        , pk0 = vJ.NO_DATA_ALLOWED_ERR = (YJ[6] = "No data allowed",
            6)
        , uk0 = vJ.NO_MODIFICATION_ALLOWED_ERR = (YJ[7] = "No modification allowed",
            7)
        , GR = vJ.NOT_FOUND_ERR = (YJ[8] = "Not found",
            8)
        , lk0 = vJ.NOT_SUPPORTED_ERR = (YJ[9] = "Not supported",
            9)
        , YR = vJ.INUSE_ATTRIBUTE_ERR = (YJ[10] = "Attribute in use",
            10)
        , ok0 = vJ.INVALID_STATE_ERR = (YJ[11] = "Invalid state",
            11)
        , nk0 = vJ.SYNTAX_ERR = (YJ[12] = "Syntax error",
            12)
        , sk0 = vJ.INVALID_MODIFICATION_ERR = (YJ[13] = "Invalid modification",
            13)
        , ik0 = vJ.NAMESPACE_ERR = (YJ[14] = "Invalid namespace",
            14)
        , ak0 = vJ.INVALID_ACCESS_ERR = (YJ[15] = "Invalid access",
            15);
    function h7(J, Q) {
        if (Q instanceof Error)
            var Z = Q;
        else if (Z = this,
            Error.call(this, YJ[J]),
            this.message = YJ[J],
            Error.captureStackTrace)
            Error.captureStackTrace(this, h7);
        if (Z.code = J,
            Q)
            this.message = this.message + ": " + Q;
        return Z
    }
    h7.prototype = Error.prototype;
    $H(vJ, h7);
    function _Q() { }
    _Q.prototype = {
        length: 0,
        item: function (J) {
            return J >= 0 && J < this.length ? this[J] : null
        },
        toString: function (J, Q) {
            for (var Z = [], $ = 0; $ < this.length; $++)
                q4(this[$], Z, J, Q);
            return Z.join("")
        },
        filter: function (J) {
            return Array.prototype.filter.call(this, J)
        },
        indexOf: function (J) {
            return Array.prototype.indexOf.call(this, J)
        }
    };
    function V4(J, Q) {
        this._node = J,
            this._refresh = Q,
            fG(this)
    }
    function fG(J) {
        var Q = J._node._inc || J._node.ownerDocument._inc;
        if (J._inc !== Q) {
            var Z = J._refresh(J._node);
            if (yR(J, "length", Z.length),
                !J.$$length || Z.length < J.$$length) {
                for (var $ = Z.length; $ in J; $++)
                    if (Object.prototype.hasOwnProperty.call(J, $))
                        delete J[$]
            }
            $H(Z, J),
                J._inc = Q
        }
    }
    V4.prototype.item = function (J) {
        return fG(this),
            this[J] || null
    }
        ;
    z5(V4, _Q);
    function vC() { }
    function PR(J, Q) {
        var Z = J.length;
        while (Z--)
            if (J[Z] === Q)
                return Z
    }
    function XR(J, Q, Z, $) {
        if ($)
            Q[PR(Q, $)] = Z;
        else
            Q[Q.length++] = Z;
        if (J) {
            Z.ownerElement = J;
            var q = J.ownerDocument;
            if (q)
                $ && ER(q, J, $),
                    ec(q, J, Z)
        }
    }
    function UR(J, Q, Z) {
        var $ = PR(Q, Z);
        if ($ >= 0) {
            var q = Q.length - 1;
            while ($ < q)
                Q[$] = Q[++$];
            if (Q.length = q,
                J) {
                var K = J.ownerDocument;
                if (K)
                    ER(K, J, Z),
                        Z.ownerElement = null
            }
        } else
            throw new h7(GR, new Error(J.tagName + "@" + Z))
    }
    vC.prototype = {
        length: 0,
        item: _Q.prototype.item,
        getNamedItem: function (J) {
            var Q = this.length;
            while (Q--) {
                var Z = this[Q];
                if (Z.nodeName == J)
                    return Z
            }
        },
        setNamedItem: function (J) {
            var Q = J.ownerElement;
            if (Q && Q != this._ownerElement)
                throw new h7(YR);
            var Z = this.getNamedItem(J.nodeName);
            return XR(this._ownerElement, this, J, Z),
                Z
        },
        setNamedItemNS: function (J) {
            var Q = J.ownerElement, Z;
            if (Q && Q != this._ownerElement)
                throw new h7(YR);
            return Z = this.getNamedItemNS(J.namespaceURI, J.localName),
                XR(this._ownerElement, this, J, Z),
                Z
        },
        removeNamedItem: function (J) {
            var Q = this.getNamedItem(J);
            return UR(this._ownerElement, this, Q),
                Q
        },
        removeNamedItemNS: function (J, Q) {
            var Z = this.getNamedItemNS(J, Q);
            return UR(this._ownerElement, this, Z),
                Z
        },
        getNamedItemNS: function (J, Q) {
            var Z = this.length;
            while (Z--) {
                var $ = this[Z];
                if ($.localName == Q && $.namespaceURI == J)
                    return $
            }
            return null
        }
    };
    function DR() { }
    DR.prototype = {
        hasFeature: function (J, Q) {
            return !0
        },
        createDocument: function (J, Q, Z) {
            var $ = new qH;
            if ($.implementation = this,
                $.childNodes = new _Q,
                $.doctype = Z || null,
                Z)
                $.appendChild(Z);
            if (Q) {
                var q = $.createElementNS(J, Q);
                $.appendChild(q)
            }
            return $
        },
        createDocumentType: function (J, Q, Z) {
            var $ = new yC;
            return $.name = J,
                $.nodeName = J,
                $.publicId = Q || "",
                $.systemId = Z || "",
                $
        }
    };
    function i6() { }
    i6.prototype = {
        firstChild: null,
        lastChild: null,
        previousSibling: null,
        nextSibling: null,
        attributes: null,
        parentNode: null,
        childNodes: null,
        ownerDocument: null,
        nodeValue: null,
        namespaceURI: null,
        prefix: null,
        localName: null,
        insertBefore: function (J, Q) {
            return SC(this, J, Q)
        },
        replaceChild: function (J, Q) {
            if (SC(this, J, Q, _R),
                Q)
                this.removeChild(Q)
        },
        removeChild: function (J) {
            return MR(this, J)
        },
        appendChild: function (J) {
            return this.insertBefore(J, null)
        },
        hasChildNodes: function () {
            return this.firstChild != null
        },
        cloneNode: function (J) {
            return yG(this.ownerDocument || this, this, J)
        },
        normalize: function () {
            var J = this.firstChild;
            while (J) {
                var Q = J.nextSibling;
                if (Q && Q.nodeType == bC && J.nodeType == bC)
                    this.removeChild(Q),
                        J.appendData(Q.data);
                else
                    J.normalize(),
                        J = Q
            }
        },
        isSupported: function (J, Q) {
            return this.ownerDocument.implementation.hasFeature(J, Q)
        },
        hasAttributes: function () {
            return this.attributes.length > 0
        },
        lookupPrefix: function (J) {
            var Q = this;
            while (Q) {
                var Z = Q._nsMap;
                if (Z) {
                    for (var $ in Z)
                        if (Object.prototype.hasOwnProperty.call(Z, $) && Z[$] === J)
                            return $
                }
                Q = Q.nodeType == K4 ? Q.ownerDocument : Q.parentNode
            }
            return null
        },
        lookupNamespaceURI: function (J) {
            var Q = this;
            while (Q) {
                var Z = Q._nsMap;
                if (Z) {
                    if (Object.prototype.hasOwnProperty.call(Z, J))
                        return Z[J]
                }
                Q = Q.nodeType == K4 ? Q.ownerDocument : Q.parentNode
            }
            return null
        },
        isDefaultNamespace: function (J) {
            var Q = this.lookupPrefix(J);
            return Q == null
        }
    };
    function AR(J) {
        return J == "<" && "&lt;" || J == ">" && "&gt;" || J == "&" && "&amp;" || J == '"' && "&quot;" || "&#" + J.charCodeAt() + ";"
    }
    $H(W5, i6);
    $H(W5, i6.prototype);
    function ZH(J, Q) {
        if (Q(J))
            return !0;
        if (J = J.firstChild)
            do
                if (ZH(J, Q))
                    return !0;
            while (J = J.nextSibling)
    }
    function qH() {
        this.ownerDocument = this
    }
    function ec(J, Q, Z) {
        J && J._inc++;
        var $ = Z.namespaceURI;
        if ($ === QH.XMLNS)
            Q._nsMap[Z.prefix ? Z.localName : ""] = Z.value
    }
    function ER(J, Q, Z, $) {
        J && J._inc++;
        var q = Z.namespaceURI;
        if (q === QH.XMLNS)
            delete Q._nsMap[Z.prefix ? Z.localName : ""]
    }
    function hG(J, Q, Z) {
        if (J && J._inc) {
            J._inc++;
            var $ = Q.childNodes;
            if (Z)
                $[$.length++] = Z;
            else {
                var q = Q.firstChild
                    , K = 0;
                while (q)
                    $[K++] = q,
                        q = q.nextSibling;
                $.length = K,
                    delete $[$.length]
            }
        }
    }
    function MR(J, Q) {
        var { previousSibling: Z, nextSibling: $ } = Q;
        if (Z)
            Z.nextSibling = $;
        else
            J.firstChild = $;
        if ($)
            $.previousSibling = Z;
        else
            J.lastChild = Z;
        return Q.parentNode = null,
            Q.previousSibling = null,
            Q.nextSibling = null,
            hG(J.ownerDocument, J),
            Q
    }
    function Jd(J) {
        return J && (J.nodeType === i6.DOCUMENT_NODE || J.nodeType === i6.DOCUMENT_FRAGMENT_NODE || J.nodeType === i6.ELEMENT_NODE)
    }
    function Qd(J) {
        return J && (l9(J) || xG(J) || bQ(J) || J.nodeType === i6.DOCUMENT_FRAGMENT_NODE || J.nodeType === i6.COMMENT_NODE || J.nodeType === i6.PROCESSING_INSTRUCTION_NODE)
    }
    function bQ(J) {
        return J && J.nodeType === i6.DOCUMENT_TYPE_NODE
    }
    function l9(J) {
        return J && J.nodeType === i6.ELEMENT_NODE
    }
    function xG(J) {
        return J && J.nodeType === i6.TEXT_NODE
    }
    function NR(J, Q) {
        var Z = J.childNodes || [];
        if (u9(Z, l9) || bQ(Q))
            return !1;
        var $ = u9(Z, bQ);
        return !(Q && $ && Z.indexOf($) > Z.indexOf(Q))
    }
    function wR(J, Q) {
        var Z = J.childNodes || [];
        function $(K) {
            return l9(K) && K !== Q
        }
        if (u9(Z, $))
            return !1;
        var q = u9(Z, bQ);
        return !(Q && q && Z.indexOf(q) > Z.indexOf(Q))
    }
    function Zd(J, Q, Z) {
        if (!Jd(J))
            throw new h7(V5, "Unexpected parent node type " + J.nodeType);
        if (Z && Z.parentNode !== J)
            throw new h7(GR, "child not in parent");
        if (!Qd(Q) || bQ(Q) && J.nodeType !== i6.DOCUMENT_NODE)
            throw new h7(V5, "Unexpected node type " + Q.nodeType + " for parent node type " + J.nodeType)
    }
    function $d(J, Q, Z) {
        var $ = J.childNodes || []
            , q = Q.childNodes || [];
        if (Q.nodeType === i6.DOCUMENT_FRAGMENT_NODE) {
            var K = q.filter(l9);
            if (K.length > 1 || u9(q, xG))
                throw new h7(V5, "More than one element or text in fragment");
            if (K.length === 1 && !NR(J, Z))
                throw new h7(V5, "Element in fragment can not be inserted before doctype")
        }
        if (l9(Q)) {
            if (!NR(J, Z))
                throw new h7(V5, "Only one element can be added and only after doctype")
        }
        if (bQ(Q)) {
            if (u9($, bQ))
                throw new h7(V5, "Only one doctype is allowed");
            var V = u9($, l9);
            if (Z && $.indexOf(V) < $.indexOf(Z))
                throw new h7(V5, "Doctype can only be inserted before an element");
            if (!Z && V)
                throw new h7(V5, "Doctype can not be appended since element is present")
        }
    }
    function _R(J, Q, Z) {
        var $ = J.childNodes || []
            , q = Q.childNodes || [];
        if (Q.nodeType === i6.DOCUMENT_FRAGMENT_NODE) {
            var K = q.filter(l9);
            if (K.length > 1 || u9(q, xG))
                throw new h7(V5, "More than one element or text in fragment");
            if (K.length === 1 && !wR(J, Z))
                throw new h7(V5, "Element in fragment can not be inserted before doctype")
        }
        if (l9(Q)) {
            if (!wR(J, Z))
                throw new h7(V5, "Only one element can be added and only after doctype")
        }
        if (bQ(Q)) {
            let W = function (H) {
                return bQ(H) && H !== Z
            };
            var z = W;
            if (u9($, W))
                throw new h7(V5, "Only one doctype is allowed");
            var V = u9($, l9);
            if (Z && $.indexOf(V) < $.indexOf(Z))
                throw new h7(V5, "Doctype can only be inserted before an element")
        }
    }
    function SC(J, Q, Z, $) {
        if (Zd(J, Q, Z),
            J.nodeType === i6.DOCUMENT_NODE)
            ($ || $d)(J, Q, Z);
        var q = Q.parentNode;
        if (q)
            q.removeChild(Q);
        if (Q.nodeType === RQ) {
            var K = Q.firstChild;
            if (K == null)
                return Q;
            var V = Q.lastChild
        } else
            K = V = Q;
        var z = Z ? Z.previousSibling : J.lastChild;
        if (K.previousSibling = z,
            V.nextSibling = Z,
            z)
            z.nextSibling = K;
        else
            J.firstChild = K;
        if (Z == null)
            J.lastChild = V;
        else
            Z.previousSibling = V;
        do
            K.parentNode = J;
        while (K !== V && (K = K.nextSibling));
        if (hG(J.ownerDocument || J, J),
            Q.nodeType == RQ)
            Q.firstChild = Q.lastChild = null;
        return Q
    }
    function qd(J, Q) {
        if (Q.parentNode)
            Q.parentNode.removeChild(Q);
        if (Q.parentNode = J,
            Q.previousSibling = J.lastChild,
            Q.nextSibling = null,
            Q.previousSibling)
            Q.previousSibling.nextSibling = Q;
        else
            J.firstChild = Q;
        return J.lastChild = Q,
            hG(J.ownerDocument, J, Q),
            Q
    }
    qH.prototype = {
        nodeName: "#document",
        nodeType: LR,
        doctype: null,
        documentElement: null,
        _inc: 1,
        insertBefore: function (J, Q) {
            if (J.nodeType == RQ) {
                var Z = J.firstChild;
                while (Z) {
                    var $ = Z.nextSibling;
                    this.insertBefore(Z, Q),
                        Z = $
                }
                return J
            }
            if (SC(this, J, Q),
                J.ownerDocument = this,
                this.documentElement === null && J.nodeType === Y9)
                this.documentElement = J;
            return J
        },
        removeChild: function (J) {
            if (this.documentElement == J)
                this.documentElement = null;
            return MR(this, J)
        },
        replaceChild: function (J, Q) {
            if (SC(this, J, Q, _R),
                J.ownerDocument = this,
                Q)
                this.removeChild(Q);
            if (l9(J))
                this.documentElement = J
        },
        importNode: function (J, Q) {
            return TR(this, J, Q)
        },
        getElementById: function (J) {
            var Q = null;
            return ZH(this.documentElement, function (Z) {
                if (Z.nodeType == Y9) {
                    if (Z.getAttribute("id") == J)
                        return Q = Z,
                            !0
                }
            }),
                Q
        },
        getElementsByClassName: function (J) {
            var Q = HR(J);
            return new V4(this, function (Z) {
                var $ = [];
                if (Q.length > 0)
                    ZH(Z.documentElement, function (q) {
                        if (q !== Z && q.nodeType === Y9) {
                            var K = q.getAttribute("class");
                            if (K) {
                                var V = J === K;
                                if (!V) {
                                    var z = HR(K);
                                    V = Q.every(ac(z))
                                }
                                if (V)
                                    $.push(q)
                            }
                        }
                    });
                return $
            }
            )
        },
        createElement: function (J) {
            var Q = new u$;
            Q.ownerDocument = this,
                Q.nodeName = J,
                Q.tagName = J,
                Q.localName = J,
                Q.childNodes = new _Q;
            var Z = Q.attributes = new vC;
            return Z._ownerElement = Q,
                Q
        },
        createDocumentFragment: function () {
            var J = new fC;
            return J.ownerDocument = this,
                J.childNodes = new _Q,
                J
        },
        createTextNode: function (J) {
            var Q = new gG;
            return Q.ownerDocument = this,
                Q.appendData(J),
                Q
        },
        createComment: function (J) {
            var Q = new mG;
            return Q.ownerDocument = this,
                Q.appendData(J),
                Q
        },
        createCDATASection: function (J) {
            var Q = new cG;
            return Q.ownerDocument = this,
                Q.appendData(J),
                Q
        },
        createProcessingInstruction: function (J, Q) {
            var Z = new pG;
            return Z.ownerDocument = this,
                Z.tagName = Z.nodeName = Z.target = J,
                Z.nodeValue = Z.data = Q,
                Z
        },
        createAttribute: function (J) {
            var Q = new TC;
            return Q.ownerDocument = this,
                Q.name = J,
                Q.nodeName = J,
                Q.localName = J,
                Q.specified = !0,
                Q
        },
        createEntityReference: function (J) {
            var Q = new dG;
            return Q.ownerDocument = this,
                Q.nodeName = J,
                Q
        },
        createElementNS: function (J, Q) {
            var Z = new u$
                , $ = Q.split(":")
                , q = Z.attributes = new vC;
            if (Z.childNodes = new _Q,
                Z.ownerDocument = this,
                Z.nodeName = Q,
                Z.tagName = Q,
                Z.namespaceURI = J,
                $.length == 2)
                Z.prefix = $[0],
                    Z.localName = $[1];
            else
                Z.localName = Q;
            return q._ownerElement = Z,
                Z
        },
        createAttributeNS: function (J, Q) {
            var Z = new TC
                , $ = Q.split(":");
            if (Z.ownerDocument = this,
                Z.nodeName = Q,
                Z.name = Q,
                Z.namespaceURI = J,
                Z.specified = !0,
                $.length == 2)
                Z.prefix = $[0],
                    Z.localName = $[1];
            else
                Z.localName = Q;
            return Z
        }
    };
    z5(qH, i6);
    function u$() {
        this._nsMap = {}
    }
    u$.prototype = {
        nodeType: Y9,
        hasAttribute: function (J) {
            return this.getAttributeNode(J) != null
        },
        getAttribute: function (J) {
            var Q = this.getAttributeNode(J);
            return Q && Q.value || ""
        },
        getAttributeNode: function (J) {
            return this.attributes.getNamedItem(J)
        },
        setAttribute: function (J, Q) {
            var Z = this.ownerDocument.createAttribute(J);
            Z.value = Z.nodeValue = "" + Q,
                this.setAttributeNode(Z)
        },
        removeAttribute: function (J) {
            var Q = this.getAttributeNode(J);
            Q && this.removeAttributeNode(Q)
        },
        appendChild: function (J) {
            if (J.nodeType === RQ)
                return this.insertBefore(J, null);
            else
                return qd(this, J)
        },
        setAttributeNode: function (J) {
            return this.attributes.setNamedItem(J)
        },
        setAttributeNodeNS: function (J) {
            return this.attributes.setNamedItemNS(J)
        },
        removeAttributeNode: function (J) {
            return this.attributes.removeNamedItem(J.nodeName)
        },
        removeAttributeNS: function (J, Q) {
            var Z = this.getAttributeNodeNS(J, Q);
            Z && this.removeAttributeNode(Z)
        },
        hasAttributeNS: function (J, Q) {
            return this.getAttributeNodeNS(J, Q) != null
        },
        getAttributeNS: function (J, Q) {
            var Z = this.getAttributeNodeNS(J, Q);
            return Z && Z.value || ""
        },
        setAttributeNS: function (J, Q, Z) {
            var $ = this.ownerDocument.createAttributeNS(J, Q);
            $.value = $.nodeValue = "" + Z,
                this.setAttributeNode($)
        },
        getAttributeNodeNS: function (J, Q) {
            return this.attributes.getNamedItemNS(J, Q)
        },
        getElementsByTagName: function (J) {
            return new V4(this, function (Q) {
                var Z = [];
                return ZH(Q, function ($) {
                    if ($ !== Q && $.nodeType == Y9 && (J === "*" || $.tagName == J))
                        Z.push($)
                }),
                    Z
            }
            )
        },
        getElementsByTagNameNS: function (J, Q) {
            return new V4(this, function (Z) {
                var $ = [];
                return ZH(Z, function (q) {
                    if (q !== Z && q.nodeType === Y9 && (J === "*" || q.namespaceURI === J) && (Q === "*" || q.localName == Q))
                        $.push(q)
                }),
                    $
            }
            )
        }
    };
    qH.prototype.getElementsByTagName = u$.prototype.getElementsByTagName;
    qH.prototype.getElementsByTagNameNS = u$.prototype.getElementsByTagNameNS;
    z5(u$, i6);
    function TC() { }
    TC.prototype.nodeType = K4;
    z5(TC, i6);
    function KH() { }
    KH.prototype = {
        data: "",
        substringData: function (J, Q) {
            return this.data.substring(J, J + Q)
        },
        appendData: function (J) {
            J = this.data + J,
                this.nodeValue = this.data = J,
                this.length = J.length
        },
        insertData: function (J, Q) {
            this.replaceData(J, 0, Q)
        },
        appendChild: function (J) {
            throw new Error(YJ[V5])
        },
        deleteData: function (J, Q) {
            this.replaceData(J, Q, "")
        },
        replaceData: function (J, Q, Z) {
            var $ = this.data.substring(0, J)
                , q = this.data.substring(J + Q);
            Z = $ + Z + q,
                this.nodeValue = this.data = Z,
                this.length = Z.length
        }
    };
    z5(KH, i6);
    function gG() { }
    gG.prototype = {
        nodeName: "#text",
        nodeType: bC,
        splitText: function (J) {
            var Q = this.data
                , Z = Q.substring(J);
            Q = Q.substring(0, J),
                this.data = this.nodeValue = Q,
                this.length = Q.length;
            var $ = this.ownerDocument.createTextNode(Z);
            if (this.parentNode)
                this.parentNode.insertBefore($, this.nextSibling);
            return $
        }
    };
    z5(gG, KH);
    function mG() { }
    mG.prototype = {
        nodeName: "#comment",
        nodeType: IR
    };
    z5(mG, KH);
    function cG() { }
    cG.prototype = {
        nodeName: "#cdata-section",
        nodeType: kR
    };
    z5(cG, KH);
    function yC() { }
    yC.prototype.nodeType = FR;
    z5(yC, i6);
    function RR() { }
    RR.prototype.nodeType = tc;
    z5(RR, i6);
    function bR() { }
    bR.prototype.nodeType = rc;
    z5(bR, i6);
    function dG() { }
    dG.prototype.nodeType = CR;
    z5(dG, i6);
    function fC() { }
    fC.prototype.nodeName = "#document-fragment";
    fC.prototype.nodeType = RQ;
    z5(fC, i6);
    function pG() { }
    pG.prototype.nodeType = OR;
    z5(pG, i6);
    function vR() { }
    vR.prototype.serializeToString = function (J, Q, Z) {
        return SR.call(J, Q, Z)
    }
        ;
    i6.prototype.toString = SR;
    function SR(J, Q) {
        var Z = []
            , $ = this.nodeType == 9 && this.documentElement || this
            , q = $.prefix
            , K = $.namespaceURI;
        if (K && q == null) {
            var q = $.lookupPrefix(K);
            if (q == null)
                var V = [{
                    namespace: K,
                    prefix: null
                }]
        }
        return q4(this, Z, J, Q, V),
            Z.join("")
    }
    function jR(J, Q, Z) {
        var $ = J.prefix || ""
            , q = J.namespaceURI;
        if (!q)
            return !1;
        if ($ === "xml" && q === QH.XML || q === QH.XMLNS)
            return !1;
        var K = Z.length;
        while (K--) {
            var V = Z[K];
            if (V.prefix === $)
                return V.namespace !== q
        }
        return !0
    }
    function TG(J, Q, Z) {
        J.push(" ", Q, '="', Z.replace(/[<>&"\t\n\r]/g, AR), '"')
    }
    function q4(J, Q, Z, $, q) {
        if (!q)
            q = [];
        if ($)
            if (J = $(J),
                J) {
                if (typeof J == "string") {
                    Q.push(J);
                    return
                }
            } else
                return;
        switch (J.nodeType) {
            case Y9:
                var K = J.attributes
                    , V = K.length
                    , P = J.firstChild
                    , z = J.tagName;
                Z = QH.isHTML(J.namespaceURI) || Z;
                var W = z;
                if (!Z && !J.prefix && J.namespaceURI) {
                    var H;
                    for (var Y = 0; Y < K.length; Y++)
                        if (K.item(Y).name === "xmlns") {
                            H = K.item(Y).value;
                            break
                        }
                    if (!H)
                        for (var U = q.length - 1; U >= 0; U--) {
                            var N = q[U];
                            if (N.prefix === "" && N.namespace === J.namespaceURI) {
                                H = N.namespace;
                                break
                            }
                        }
                    if (H !== J.namespaceURI)
                        for (var U = q.length - 1; U >= 0; U--) {
                            var N = q[U];
                            if (N.namespace === J.namespaceURI) {
                                if (N.prefix)
                                    W = N.prefix + ":" + z;
                                break
                            }
                        }
                }
                Q.push("<", W);
                for (var j = 0; j < V; j++) {
                    var k = K.item(j);
                    if (k.prefix == "xmlns")
                        q.push({
                            prefix: k.localName,
                            namespace: k.value
                        });
                    else if (k.nodeName == "xmlns")
                        q.push({
                            prefix: "",
                            namespace: k.value
                        })
                }
                for (var j = 0; j < V; j++) {
                    var k = K.item(j);
                    if (jR(k, Z, q)) {
                        var L = k.prefix || ""
                            , F = k.namespaceURI;
                        TG(Q, L ? "xmlns:" + L : "xmlns", F),
                            q.push({
                                prefix: L,
                                namespace: F
                            })
                    }
                    q4(k, Q, Z, $, q)
                }
                if (z === W && jR(J, Z, q)) {
                    var L = J.prefix || ""
                        , F = J.namespaceURI;
                    TG(Q, L ? "xmlns:" + L : "xmlns", F),
                        q.push({
                            prefix: L,
                            namespace: F
                        })
                }
                if (P || Z && !/^(?:meta|link|img|br|hr|input)$/i.test(z)) {
                    if (Q.push(">"),
                        Z && /^script$/i.test(z))
                        while (P) {
                            if (P.data)
                                Q.push(P.data);
                            else
                                q4(P, Q, Z, $, q.slice());
                            P = P.nextSibling
                        }
                    else
                        while (P)
                            q4(P, Q, Z, $, q.slice()),
                                P = P.nextSibling;
                    Q.push("</", W, ">")
                } else
                    Q.push("/>");
                return;
            case LR:
            case RQ:
                var P = J.firstChild;
                while (P)
                    q4(P, Q, Z, $, q.slice()),
                        P = P.nextSibling;
                return;
            case K4:
                return TG(Q, J.name, J.value);
            case bC:
                return Q.push(J.data.replace(/[<&>]/g, AR));
            case kR:
                return Q.push("<![CDATA[", J.data, "]]>");
            case IR:
                return Q.push("<!--", J.data, "-->");
            case FR:
                var { publicId: M, systemId: v } = J;
                if (Q.push("<!DOCTYPE ", J.name),
                    M) {
                    if (Q.push(" PUBLIC ", M),
                        v && v != ".")
                        Q.push(" ", v);
                    Q.push(">")
                } else if (v && v != ".")
                    Q.push(" SYSTEM ", v, ">");
                else {
                    var E = J.internalSubset;
                    if (E)
                        Q.push(" [", E, "]");
                    Q.push(">")
                }
                return;
            case OR:
                return Q.push("<?", J.target, " ", J.data, "?>");
            case CR:
                return Q.push("&", J.nodeName, ";");
            default:
                Q.push("??", J.nodeName)
        }
    }
    function TR(J, Q, Z) {
        var $;
        switch (Q.nodeType) {
            case Y9:
                $ = Q.cloneNode(!1),
                    $.ownerDocument = J;
            case RQ:
                break;
            case K4:
                Z = !0;
                break
        }
        if (!$)
            $ = Q.cloneNode(!1);
        if ($.ownerDocument = J,
            $.parentNode = null,
            Z) {
            var q = Q.firstChild;
            while (q)
                $.appendChild(TR(J, q, Z)),
                    q = q.nextSibling
        }
        return $
    }
    function yG(J, Q, Z) {
        var $ = new Q.constructor;
        for (var q in Q)
            if (Object.prototype.hasOwnProperty.call(Q, q)) {
                var K = Q[q];
                if (typeof K != "object") {
                    if (K != $[q])
                        $[q] = K
                }
            }
        if (Q.childNodes)
            $.childNodes = new _Q;
        switch ($.ownerDocument = J,
        $.nodeType) {
            case Y9:
                var V = Q.attributes
                    , z = $.attributes = new vC
                    , W = V.length;
                z._ownerElement = $;
                for (var H = 0; H < W; H++)
                    $.setAttributeNode(yG(J, V.item(H), !0));
                break;
            case K4:
                Z = !0
        }
        if (Z) {
            var Y = Q.firstChild;
            while (Y)
                $.appendChild(yG(J, Y, Z)),
                    Y = Y.nextSibling
        }
        return $
    }
    function yR(J, Q, Z) {
        J[Q] = Z
    }
    try {
        if (Object.defineProperty) {
            let J = function (Q) {
                switch (Q.nodeType) {
                    case Y9:
                    case RQ:
                        var Z = [];
                        Q = Q.firstChild;
                        while (Q) {
                            if (Q.nodeType !== 7 && Q.nodeType !== 8)
                                Z.push(J(Q));
                            Q = Q.nextSibling
                        }
                        return Z.join("");
                    default:
                        return Q.nodeValue
                }
            };
            Kd = J,
                Object.defineProperty(V4.prototype, "length", {
                    get: function () {
                        return fG(this),
                            this.$$length
                    }
                }),
                Object.defineProperty(i6.prototype, "textContent", {
                    get: function () {
                        return J(this)
                    },
                    set: function (Q) {
                        switch (this.nodeType) {
                            case Y9:
                            case RQ:
                                while (this.firstChild)
                                    this.removeChild(this.firstChild);
                                if (Q || String(Q))
                                    this.appendChild(this.ownerDocument.createTextNode(Q));
                                break;
                            default:
                                this.data = Q,
                                    this.value = Q,
                                    this.nodeValue = Q
                        }
                    }
                }),
                yR = function (Q, Z, $) {
                    Q["$$" + Z] = $
                }
        }
    } catch (J) { }
    var Kd;
    Vd.DocumentType = yC;
    Vd.DOMException = h7;
    Vd.DOMImplementation = DR;
    Vd.Element = u$;
    Vd.Node = i6;
    Vd.NodeList = _Q;
    Vd.XMLSerializer = vR
}
);
var xR = G5((wd) => {
    var fR = JH().freeze;
    wd.XML_ENTITIES = fR({
        amp: "&",
        apos: "'",
        gt: ">",
        lt: "<",
        quot: '"'
    });
    wd.HTML_ENTITIES = fR({
        Aacute: "Á",
        aacute: "á",
        Abreve: "Ă",
        abreve: "ă",
        ac: "∾",
        acd: "∿",
        acE: "∾̳",
        Acirc: "Â",
        acirc: "â",
        acute: "´",
        Acy: "А",
        acy: "а",
        AElig: "Æ",
        aelig: "æ",
        af: "⁡",
        Afr: "\uD835\uDD04",
        afr: "\uD835\uDD1E",
        Agrave: "À",
        agrave: "à",
        alefsym: "ℵ",
        aleph: "ℵ",
        Alpha: "Α",
        alpha: "α",
        Amacr: "Ā",
        amacr: "ā",
        amalg: "⨿",
        AMP: "&",
        amp: "&",
        And: "⩓",
        and: "∧",
        andand: "⩕",
        andd: "⩜",
        andslope: "⩘",
        andv: "⩚",
        ang: "∠",
        ange: "⦤",
        angle: "∠",
        angmsd: "∡",
        angmsdaa: "⦨",
        angmsdab: "⦩",
        angmsdac: "⦪",
        angmsdad: "⦫",
        angmsdae: "⦬",
        angmsdaf: "⦭",
        angmsdag: "⦮",
        angmsdah: "⦯",
        angrt: "∟",
        angrtvb: "⊾",
        angrtvbd: "⦝",
        angsph: "∢",
        angst: "Å",
        angzarr: "⍼",
        Aogon: "Ą",
        aogon: "ą",
        Aopf: "\uD835\uDD38",
        aopf: "\uD835\uDD52",
        ap: "≈",
        apacir: "⩯",
        apE: "⩰",
        ape: "≊",
        apid: "≋",
        apos: "'",
        ApplyFunction: "⁡",
        approx: "≈",
        approxeq: "≊",
        Aring: "Å",
        aring: "å",
        Ascr: "\uD835\uDC9C",
        ascr: "\uD835\uDCB6",
        Assign: "≔",
        ast: "*",
        asymp: "≈",
        asympeq: "≍",
        Atilde: "Ã",
        atilde: "ã",
        Auml: "Ä",
        auml: "ä",
        awconint: "∳",
        awint: "⨑",
        backcong: "≌",
        backepsilon: "϶",
        backprime: "‵",
        backsim: "∽",
        backsimeq: "⋍",
        Backslash: "∖",
        Barv: "⫧",
        barvee: "⊽",
        Barwed: "⌆",
        barwed: "⌅",
        barwedge: "⌅",
        bbrk: "⎵",
        bbrktbrk: "⎶",
        bcong: "≌",
        Bcy: "Б",
        bcy: "б",
        bdquo: "„",
        becaus: "∵",
        Because: "∵",
        because: "∵",
        bemptyv: "⦰",
        bepsi: "϶",
        bernou: "ℬ",
        Bernoullis: "ℬ",
        Beta: "Β",
        beta: "β",
        beth: "ℶ",
        between: "≬",
        Bfr: "\uD835\uDD05",
        bfr: "\uD835\uDD1F",
        bigcap: "⋂",
        bigcirc: "◯",
        bigcup: "⋃",
        bigodot: "⨀",
        bigoplus: "⨁",
        bigotimes: "⨂",
        bigsqcup: "⨆",
        bigstar: "★",
        bigtriangledown: "▽",
        bigtriangleup: "△",
        biguplus: "⨄",
        bigvee: "⋁",
        bigwedge: "⋀",
        bkarow: "⤍",
        blacklozenge: "⧫",
        blacksquare: "▪",
        blacktriangle: "▴",
        blacktriangledown: "▾",
        blacktriangleleft: "◂",
        blacktriangleright: "▸",
        blank: "␣",
        blk12: "▒",
        blk14: "░",
        blk34: "▓",
        block: "█",
        bne: "=⃥",
        bnequiv: "≡⃥",
        bNot: "⫭",
        bnot: "⌐",
        Bopf: "\uD835\uDD39",
        bopf: "\uD835\uDD53",
        bot: "⊥",
        bottom: "⊥",
        bowtie: "⋈",
        boxbox: "⧉",
        boxDL: "╗",
        boxDl: "╖",
        boxdL: "╕",
        boxdl: "┐",
        boxDR: "╔",
        boxDr: "╓",
        boxdR: "╒",
        boxdr: "┌",
        boxH: "═",
        boxh: "─",
        boxHD: "╦",
        boxHd: "╤",
        boxhD: "╥",
        boxhd: "┬",
        boxHU: "╩",
        boxHu: "╧",
        boxhU: "╨",
        boxhu: "┴",
        boxminus: "⊟",
        boxplus: "⊞",
        boxtimes: "⊠",
        boxUL: "╝",
        boxUl: "╜",
        boxuL: "╛",
        boxul: "┘",
        boxUR: "╚",
        boxUr: "╙",
        boxuR: "╘",
        boxur: "└",
        boxV: "║",
        boxv: "│",
        boxVH: "╬",
        boxVh: "╫",
        boxvH: "╪",
        boxvh: "┼",
        boxVL: "╣",
        boxVl: "╢",
        boxvL: "╡",
        boxvl: "┤",
        boxVR: "╠",
        boxVr: "╟",
        boxvR: "╞",
        boxvr: "├",
        bprime: "‵",
        Breve: "˘",
        breve: "˘",
        brvbar: "¦",
        Bscr: "ℬ",
        bscr: "\uD835\uDCB7",
        bsemi: "⁏",
        bsim: "∽",
        bsime: "⋍",
        bsol: "\\",
        bsolb: "⧅",
        bsolhsub: "⟈",
        bull: "•",
        bullet: "•",
        bump: "≎",
        bumpE: "⪮",
        bumpe: "≏",
        Bumpeq: "≎",
        bumpeq: "≏",
        Cacute: "Ć",
        cacute: "ć",
        Cap: "⋒",
        cap: "∩",
        capand: "⩄",
        capbrcup: "⩉",
        capcap: "⩋",
        capcup: "⩇",
        capdot: "⩀",
        CapitalDifferentialD: "ⅅ",
        caps: "∩︀",
        caret: "⁁",
        caron: "ˇ",
        Cayleys: "ℭ",
        ccaps: "⩍",
        Ccaron: "Č",
        ccaron: "č",
        Ccedil: "Ç",
        ccedil: "ç",
        Ccirc: "Ĉ",
        ccirc: "ĉ",
        Cconint: "∰",
        ccups: "⩌",
        ccupssm: "⩐",
        Cdot: "Ċ",
        cdot: "ċ",
        cedil: "¸",
        Cedilla: "¸",
        cemptyv: "⦲",
        cent: "¢",
        CenterDot: "·",
        centerdot: "·",
        Cfr: "ℭ",
        cfr: "\uD835\uDD20",
        CHcy: "Ч",
        chcy: "ч",
        check: "✓",
        checkmark: "✓",
        Chi: "Χ",
        chi: "χ",
        cir: "○",
        circ: "ˆ",
        circeq: "≗",
        circlearrowleft: "↺",
        circlearrowright: "↻",
        circledast: "⊛",
        circledcirc: "⊚",
        circleddash: "⊝",
        CircleDot: "⊙",
        circledR: "®",
        circledS: "Ⓢ",
        CircleMinus: "⊖",
        CirclePlus: "⊕",
        CircleTimes: "⊗",
        cirE: "⧃",
        cire: "≗",
        cirfnint: "⨐",
        cirmid: "⫯",
        cirscir: "⧂",
        ClockwiseContourIntegral: "∲",
        CloseCurlyDoubleQuote: "”",
        CloseCurlyQuote: "’",
        clubs: "♣",
        clubsuit: "♣",
        Colon: "∷",
        colon: ":",
        Colone: "⩴",
        colone: "≔",
        coloneq: "≔",
        comma: ",",
        commat: "@",
        comp: "∁",
        compfn: "∘",
        complement: "∁",
        complexes: "ℂ",
        cong: "≅",
        congdot: "⩭",
        Congruent: "≡",
        Conint: "∯",
        conint: "∮",
        ContourIntegral: "∮",
        Copf: "ℂ",
        copf: "\uD835\uDD54",
        coprod: "∐",
        Coproduct: "∐",
        COPY: "©",
        copy: "©",
        copysr: "℗",
        CounterClockwiseContourIntegral: "∳",
        crarr: "↵",
        Cross: "⨯",
        cross: "✗",
        Cscr: "\uD835\uDC9E",
        cscr: "\uD835\uDCB8",
        csub: "⫏",
        csube: "⫑",
        csup: "⫐",
        csupe: "⫒",
        ctdot: "⋯",
        cudarrl: "⤸",
        cudarrr: "⤵",
        cuepr: "⋞",
        cuesc: "⋟",
        cularr: "↶",
        cularrp: "⤽",
        Cup: "⋓",
        cup: "∪",
        cupbrcap: "⩈",
        CupCap: "≍",
        cupcap: "⩆",
        cupcup: "⩊",
        cupdot: "⊍",
        cupor: "⩅",
        cups: "∪︀",
        curarr: "↷",
        curarrm: "⤼",
        curlyeqprec: "⋞",
        curlyeqsucc: "⋟",
        curlyvee: "⋎",
        curlywedge: "⋏",
        curren: "¤",
        curvearrowleft: "↶",
        curvearrowright: "↷",
        cuvee: "⋎",
        cuwed: "⋏",
        cwconint: "∲",
        cwint: "∱",
        cylcty: "⌭",
        Dagger: "‡",
        dagger: "†",
        daleth: "ℸ",
        Darr: "↡",
        dArr: "⇓",
        darr: "↓",
        dash: "‐",
        Dashv: "⫤",
        dashv: "⊣",
        dbkarow: "⤏",
        dblac: "˝",
        Dcaron: "Ď",
        dcaron: "ď",
        Dcy: "Д",
        dcy: "д",
        DD: "ⅅ",
        dd: "ⅆ",
        ddagger: "‡",
        ddarr: "⇊",
        DDotrahd: "⤑",
        ddotseq: "⩷",
        deg: "°",
        Del: "∇",
        Delta: "Δ",
        delta: "δ",
        demptyv: "⦱",
        dfisht: "⥿",
        Dfr: "\uD835\uDD07",
        dfr: "\uD835\uDD21",
        dHar: "⥥",
        dharl: "⇃",
        dharr: "⇂",
        DiacriticalAcute: "´",
        DiacriticalDot: "˙",
        DiacriticalDoubleAcute: "˝",
        DiacriticalGrave: "`",
        DiacriticalTilde: "˜",
        diam: "⋄",
        Diamond: "⋄",
        diamond: "⋄",
        diamondsuit: "♦",
        diams: "♦",
        die: "¨",
        DifferentialD: "ⅆ",
        digamma: "ϝ",
        disin: "⋲",
        div: "÷",
        divide: "÷",
        divideontimes: "⋇",
        divonx: "⋇",
        DJcy: "Ђ",
        djcy: "ђ",
        dlcorn: "⌞",
        dlcrop: "⌍",
        dollar: "$",
        Dopf: "\uD835\uDD3B",
        dopf: "\uD835\uDD55",
        Dot: "¨",
        dot: "˙",
        DotDot: "⃜",
        doteq: "≐",
        doteqdot: "≑",
        DotEqual: "≐",
        dotminus: "∸",
        dotplus: "∔",
        dotsquare: "⊡",
        doublebarwedge: "⌆",
        DoubleContourIntegral: "∯",
        DoubleDot: "¨",
        DoubleDownArrow: "⇓",
        DoubleLeftArrow: "⇐",
        DoubleLeftRightArrow: "⇔",
        DoubleLeftTee: "⫤",
        DoubleLongLeftArrow: "⟸",
        DoubleLongLeftRightArrow: "⟺",
        DoubleLongRightArrow: "⟹",
        DoubleRightArrow: "⇒",
        DoubleRightTee: "⊨",
        DoubleUpArrow: "⇑",
        DoubleUpDownArrow: "⇕",
        DoubleVerticalBar: "∥",
        DownArrow: "↓",
        Downarrow: "⇓",
        downarrow: "↓",
        DownArrowBar: "⤓",
        DownArrowUpArrow: "⇵",
        DownBreve: "̑",
        downdownarrows: "⇊",
        downharpoonleft: "⇃",
        downharpoonright: "⇂",
        DownLeftRightVector: "⥐",
        DownLeftTeeVector: "⥞",
        DownLeftVector: "↽",
        DownLeftVectorBar: "⥖",
        DownRightTeeVector: "⥟",
        DownRightVector: "⇁",
        DownRightVectorBar: "⥗",
        DownTee: "⊤",
        DownTeeArrow: "↧",
        drbkarow: "⤐",
        drcorn: "⌟",
        drcrop: "⌌",
        Dscr: "\uD835\uDC9F",
        dscr: "\uD835\uDCB9",
        DScy: "Ѕ",
        dscy: "ѕ",
        dsol: "⧶",
        Dstrok: "Đ",
        dstrok: "đ",
        dtdot: "⋱",
        dtri: "▿",
        dtrif: "▾",
        duarr: "⇵",
        duhar: "⥯",
        dwangle: "⦦",
        DZcy: "Џ",
        dzcy: "џ",
        dzigrarr: "⟿",
        Eacute: "É",
        eacute: "é",
        easter: "⩮",
        Ecaron: "Ě",
        ecaron: "ě",
        ecir: "≖",
        Ecirc: "Ê",
        ecirc: "ê",
        ecolon: "≕",
        Ecy: "Э",
        ecy: "э",
        eDDot: "⩷",
        Edot: "Ė",
        eDot: "≑",
        edot: "ė",
        ee: "ⅇ",
        efDot: "≒",
        Efr: "\uD835\uDD08",
        efr: "\uD835\uDD22",
        eg: "⪚",
        Egrave: "È",
        egrave: "è",
        egs: "⪖",
        egsdot: "⪘",
        el: "⪙",
        Element: "∈",
        elinters: "⏧",
        ell: "ℓ",
        els: "⪕",
        elsdot: "⪗",
        Emacr: "Ē",
        emacr: "ē",
        empty: "∅",
        emptyset: "∅",
        EmptySmallSquare: "◻",
        emptyv: "∅",
        EmptyVerySmallSquare: "▫",
        emsp: " ",
        emsp13: " ",
        emsp14: " ",
        ENG: "Ŋ",
        eng: "ŋ",
        ensp: " ",
        Eogon: "Ę",
        eogon: "ę",
        Eopf: "\uD835\uDD3C",
        eopf: "\uD835\uDD56",
        epar: "⋕",
        eparsl: "⧣",
        eplus: "⩱",
        epsi: "ε",
        Epsilon: "Ε",
        epsilon: "ε",
        epsiv: "ϵ",
        eqcirc: "≖",
        eqcolon: "≕",
        eqsim: "≂",
        eqslantgtr: "⪖",
        eqslantless: "⪕",
        Equal: "⩵",
        equals: "=",
        EqualTilde: "≂",
        equest: "≟",
        Equilibrium: "⇌",
        equiv: "≡",
        equivDD: "⩸",
        eqvparsl: "⧥",
        erarr: "⥱",
        erDot: "≓",
        Escr: "ℰ",
        escr: "ℯ",
        esdot: "≐",
        Esim: "⩳",
        esim: "≂",
        Eta: "Η",
        eta: "η",
        ETH: "Ð",
        eth: "ð",
        Euml: "Ë",
        euml: "ë",
        euro: "€",
        excl: "!",
        exist: "∃",
        Exists: "∃",
        expectation: "ℰ",
        ExponentialE: "ⅇ",
        exponentiale: "ⅇ",
        fallingdotseq: "≒",
        Fcy: "Ф",
        fcy: "ф",
        female: "♀",
        ffilig: "ﬃ",
        fflig: "ﬀ",
        ffllig: "ﬄ",
        Ffr: "\uD835\uDD09",
        ffr: "\uD835\uDD23",
        filig: "ﬁ",
        FilledSmallSquare: "◼",
        FilledVerySmallSquare: "▪",
        fjlig: "fj",
        flat: "♭",
        fllig: "ﬂ",
        fltns: "▱",
        fnof: "ƒ",
        Fopf: "\uD835\uDD3D",
        fopf: "\uD835\uDD57",
        ForAll: "∀",
        forall: "∀",
        fork: "⋔",
        forkv: "⫙",
        Fouriertrf: "ℱ",
        fpartint: "⨍",
        frac12: "½",
        frac13: "⅓",
        frac14: "¼",
        frac15: "⅕",
        frac16: "⅙",
        frac18: "⅛",
        frac23: "⅔",
        frac25: "⅖",
        frac34: "¾",
        frac35: "⅗",
        frac38: "⅜",
        frac45: "⅘",
        frac56: "⅚",
        frac58: "⅝",
        frac78: "⅞",
        frasl: "⁄",
        frown: "⌢",
        Fscr: "ℱ",
        fscr: "\uD835\uDCBB",
        gacute: "ǵ",
        Gamma: "Γ",
        gamma: "γ",
        Gammad: "Ϝ",
        gammad: "ϝ",
        gap: "⪆",
        Gbreve: "Ğ",
        gbreve: "ğ",
        Gcedil: "Ģ",
        Gcirc: "Ĝ",
        gcirc: "ĝ",
        Gcy: "Г",
        gcy: "г",
        Gdot: "Ġ",
        gdot: "ġ",
        gE: "≧",
        ge: "≥",
        gEl: "⪌",
        gel: "⋛",
        geq: "≥",
        geqq: "≧",
        geqslant: "⩾",
        ges: "⩾",
        gescc: "⪩",
        gesdot: "⪀",
        gesdoto: "⪂",
        gesdotol: "⪄",
        gesl: "⋛︀",
        gesles: "⪔",
        Gfr: "\uD835\uDD0A",
        gfr: "\uD835\uDD24",
        Gg: "⋙",
        gg: "≫",
        ggg: "⋙",
        gimel: "ℷ",
        GJcy: "Ѓ",
        gjcy: "ѓ",
        gl: "≷",
        gla: "⪥",
        glE: "⪒",
        glj: "⪤",
        gnap: "⪊",
        gnapprox: "⪊",
        gnE: "≩",
        gne: "⪈",
        gneq: "⪈",
        gneqq: "≩",
        gnsim: "⋧",
        Gopf: "\uD835\uDD3E",
        gopf: "\uD835\uDD58",
        grave: "`",
        GreaterEqual: "≥",
        GreaterEqualLess: "⋛",
        GreaterFullEqual: "≧",
        GreaterGreater: "⪢",
        GreaterLess: "≷",
        GreaterSlantEqual: "⩾",
        GreaterTilde: "≳",
        Gscr: "\uD835\uDCA2",
        gscr: "ℊ",
        gsim: "≳",
        gsime: "⪎",
        gsiml: "⪐",
        Gt: "≫",
        GT: ">",
        gt: ">",
        gtcc: "⪧",
        gtcir: "⩺",
        gtdot: "⋗",
        gtlPar: "⦕",
        gtquest: "⩼",
        gtrapprox: "⪆",
        gtrarr: "⥸",
        gtrdot: "⋗",
        gtreqless: "⋛",
        gtreqqless: "⪌",
        gtrless: "≷",
        gtrsim: "≳",
        gvertneqq: "≩︀",
        gvnE: "≩︀",
        Hacek: "ˇ",
        hairsp: " ",
        half: "½",
        hamilt: "ℋ",
        HARDcy: "Ъ",
        hardcy: "ъ",
        hArr: "⇔",
        harr: "↔",
        harrcir: "⥈",
        harrw: "↭",
        Hat: "^",
        hbar: "ℏ",
        Hcirc: "Ĥ",
        hcirc: "ĥ",
        hearts: "♥",
        heartsuit: "♥",
        hellip: "…",
        hercon: "⊹",
        Hfr: "ℌ",
        hfr: "\uD835\uDD25",
        HilbertSpace: "ℋ",
        hksearow: "⤥",
        hkswarow: "⤦",
        hoarr: "⇿",
        homtht: "∻",
        hookleftarrow: "↩",
        hookrightarrow: "↪",
        Hopf: "ℍ",
        hopf: "\uD835\uDD59",
        horbar: "―",
        HorizontalLine: "─",
        Hscr: "ℋ",
        hscr: "\uD835\uDCBD",
        hslash: "ℏ",
        Hstrok: "Ħ",
        hstrok: "ħ",
        HumpDownHump: "≎",
        HumpEqual: "≏",
        hybull: "⁃",
        hyphen: "‐",
        Iacute: "Í",
        iacute: "í",
        ic: "⁣",
        Icirc: "Î",
        icirc: "î",
        Icy: "И",
        icy: "и",
        Idot: "İ",
        IEcy: "Е",
        iecy: "е",
        iexcl: "¡",
        iff: "⇔",
        Ifr: "ℑ",
        ifr: "\uD835\uDD26",
        Igrave: "Ì",
        igrave: "ì",
        ii: "ⅈ",
        iiiint: "⨌",
        iiint: "∭",
        iinfin: "⧜",
        iiota: "℩",
        IJlig: "Ĳ",
        ijlig: "ĳ",
        Im: "ℑ",
        Imacr: "Ī",
        imacr: "ī",
        image: "ℑ",
        ImaginaryI: "ⅈ",
        imagline: "ℐ",
        imagpart: "ℑ",
        imath: "ı",
        imof: "⊷",
        imped: "Ƶ",
        Implies: "⇒",
        in: "∈",
        incare: "℅",
        infin: "∞",
        infintie: "⧝",
        inodot: "ı",
        Int: "∬",
        int: "∫",
        intcal: "⊺",
        integers: "ℤ",
        Integral: "∫",
        intercal: "⊺",
        Intersection: "⋂",
        intlarhk: "⨗",
        intprod: "⨼",
        InvisibleComma: "⁣",
        InvisibleTimes: "⁢",
        IOcy: "Ё",
        iocy: "ё",
        Iogon: "Į",
        iogon: "į",
        Iopf: "\uD835\uDD40",
        iopf: "\uD835\uDD5A",
        Iota: "Ι",
        iota: "ι",
        iprod: "⨼",
        iquest: "¿",
        Iscr: "ℐ",
        iscr: "\uD835\uDCBE",
        isin: "∈",
        isindot: "⋵",
        isinE: "⋹",
        isins: "⋴",
        isinsv: "⋳",
        isinv: "∈",
        it: "⁢",
        Itilde: "Ĩ",
        itilde: "ĩ",
        Iukcy: "І",
        iukcy: "і",
        Iuml: "Ï",
        iuml: "ï",
        Jcirc: "Ĵ",
        jcirc: "ĵ",
        Jcy: "Й",
        jcy: "й",
        Jfr: "\uD835\uDD0D",
        jfr: "\uD835\uDD27",
        jmath: "ȷ",
        Jopf: "\uD835\uDD41",
        jopf: "\uD835\uDD5B",
        Jscr: "\uD835\uDCA5",
        jscr: "\uD835\uDCBF",
        Jsercy: "Ј",
        jsercy: "ј",
        Jukcy: "Є",
        jukcy: "є",
        Kappa: "Κ",
        kappa: "κ",
        kappav: "ϰ",
        Kcedil: "Ķ",
        kcedil: "ķ",
        Kcy: "К",
        kcy: "к",
        Kfr: "\uD835\uDD0E",
        kfr: "\uD835\uDD28",
        kgreen: "ĸ",
        KHcy: "Х",
        khcy: "х",
        KJcy: "Ќ",
        kjcy: "ќ",
        Kopf: "\uD835\uDD42",
        kopf: "\uD835\uDD5C",
        Kscr: "\uD835\uDCA6",
        kscr: "\uD835\uDCC0",
        lAarr: "⇚",
        Lacute: "Ĺ",
        lacute: "ĺ",
        laemptyv: "⦴",
        lagran: "ℒ",
        Lambda: "Λ",
        lambda: "λ",
        Lang: "⟪",
        lang: "⟨",
        langd: "⦑",
        langle: "⟨",
        lap: "⪅",
        Laplacetrf: "ℒ",
        laquo: "«",
        Larr: "↞",
        lArr: "⇐",
        larr: "←",
        larrb: "⇤",
        larrbfs: "⤟",
        larrfs: "⤝",
        larrhk: "↩",
        larrlp: "↫",
        larrpl: "⤹",
        larrsim: "⥳",
        larrtl: "↢",
        lat: "⪫",
        lAtail: "⤛",
        latail: "⤙",
        late: "⪭",
        lates: "⪭︀",
        lBarr: "⤎",
        lbarr: "⤌",
        lbbrk: "❲",
        lbrace: "{",
        lbrack: "[",
        lbrke: "⦋",
        lbrksld: "⦏",
        lbrkslu: "⦍",
        Lcaron: "Ľ",
        lcaron: "ľ",
        Lcedil: "Ļ",
        lcedil: "ļ",
        lceil: "⌈",
        lcub: "{",
        Lcy: "Л",
        lcy: "л",
        ldca: "⤶",
        ldquo: "“",
        ldquor: "„",
        ldrdhar: "⥧",
        ldrushar: "⥋",
        ldsh: "↲",
        lE: "≦",
        le: "≤",
        LeftAngleBracket: "⟨",
        LeftArrow: "←",
        Leftarrow: "⇐",
        leftarrow: "←",
        LeftArrowBar: "⇤",
        LeftArrowRightArrow: "⇆",
        leftarrowtail: "↢",
        LeftCeiling: "⌈",
        LeftDoubleBracket: "⟦",
        LeftDownTeeVector: "⥡",
        LeftDownVector: "⇃",
        LeftDownVectorBar: "⥙",
        LeftFloor: "⌊",
        leftharpoondown: "↽",
        leftharpoonup: "↼",
        leftleftarrows: "⇇",
        LeftRightArrow: "↔",
        Leftrightarrow: "⇔",
        leftrightarrow: "↔",
        leftrightarrows: "⇆",
        leftrightharpoons: "⇋",
        leftrightsquigarrow: "↭",
        LeftRightVector: "⥎",
        LeftTee: "⊣",
        LeftTeeArrow: "↤",
        LeftTeeVector: "⥚",
        leftthreetimes: "⋋",
        LeftTriangle: "⊲",
        LeftTriangleBar: "⧏",
        LeftTriangleEqual: "⊴",
        LeftUpDownVector: "⥑",
        LeftUpTeeVector: "⥠",
        LeftUpVector: "↿",
        LeftUpVectorBar: "⥘",
        LeftVector: "↼",
        LeftVectorBar: "⥒",
        lEg: "⪋",
        leg: "⋚",
        leq: "≤",
        leqq: "≦",
        leqslant: "⩽",
        les: "⩽",
        lescc: "⪨",
        lesdot: "⩿",
        lesdoto: "⪁",
        lesdotor: "⪃",
        lesg: "⋚︀",
        lesges: "⪓",
        lessapprox: "⪅",
        lessdot: "⋖",
        lesseqgtr: "⋚",
        lesseqqgtr: "⪋",
        LessEqualGreater: "⋚",
        LessFullEqual: "≦",
        LessGreater: "≶",
        lessgtr: "≶",
        LessLess: "⪡",
        lesssim: "≲",
        LessSlantEqual: "⩽",
        LessTilde: "≲",
        lfisht: "⥼",
        lfloor: "⌊",
        Lfr: "\uD835\uDD0F",
        lfr: "\uD835\uDD29",
        lg: "≶",
        lgE: "⪑",
        lHar: "⥢",
        lhard: "↽",
        lharu: "↼",
        lharul: "⥪",
        lhblk: "▄",
        LJcy: "Љ",
        ljcy: "љ",
        Ll: "⋘",
        ll: "≪",
        llarr: "⇇",
        llcorner: "⌞",
        Lleftarrow: "⇚",
        llhard: "⥫",
        lltri: "◺",
        Lmidot: "Ŀ",
        lmidot: "ŀ",
        lmoust: "⎰",
        lmoustache: "⎰",
        lnap: "⪉",
        lnapprox: "⪉",
        lnE: "≨",
        lne: "⪇",
        lneq: "⪇",
        lneqq: "≨",
        lnsim: "⋦",
        loang: "⟬",
        loarr: "⇽",
        lobrk: "⟦",
        LongLeftArrow: "⟵",
        Longleftarrow: "⟸",
        longleftarrow: "⟵",
        LongLeftRightArrow: "⟷",
        Longleftrightarrow: "⟺",
        longleftrightarrow: "⟷",
        longmapsto: "⟼",
        LongRightArrow: "⟶",
        Longrightarrow: "⟹",
        longrightarrow: "⟶",
        looparrowleft: "↫",
        looparrowright: "↬",
        lopar: "⦅",
        Lopf: "\uD835\uDD43",
        lopf: "\uD835\uDD5D",
        loplus: "⨭",
        lotimes: "⨴",
        lowast: "∗",
        lowbar: "_",
        LowerLeftArrow: "↙",
        LowerRightArrow: "↘",
        loz: "◊",
        lozenge: "◊",
        lozf: "⧫",
        lpar: "(",
        lparlt: "⦓",
        lrarr: "⇆",
        lrcorner: "⌟",
        lrhar: "⇋",
        lrhard: "⥭",
        lrm: "‎",
        lrtri: "⊿",
        lsaquo: "‹",
        Lscr: "ℒ",
        lscr: "\uD835\uDCC1",
        Lsh: "↰",
        lsh: "↰",
        lsim: "≲",
        lsime: "⪍",
        lsimg: "⪏",
        lsqb: "[",
        lsquo: "‘",
        lsquor: "‚",
        Lstrok: "Ł",
        lstrok: "ł",
        Lt: "≪",
        LT: "<",
        lt: "<",
        ltcc: "⪦",
        ltcir: "⩹",
        ltdot: "⋖",
        lthree: "⋋",
        ltimes: "⋉",
        ltlarr: "⥶",
        ltquest: "⩻",
        ltri: "◃",
        ltrie: "⊴",
        ltrif: "◂",
        ltrPar: "⦖",
        lurdshar: "⥊",
        luruhar: "⥦",
        lvertneqq: "≨︀",
        lvnE: "≨︀",
        macr: "¯",
        male: "♂",
        malt: "✠",
        maltese: "✠",
        Map: "⤅",
        map: "↦",
        mapsto: "↦",
        mapstodown: "↧",
        mapstoleft: "↤",
        mapstoup: "↥",
        marker: "▮",
        mcomma: "⨩",
        Mcy: "М",
        mcy: "м",
        mdash: "—",
        mDDot: "∺",
        measuredangle: "∡",
        MediumSpace: " ",
        Mellintrf: "ℳ",
        Mfr: "\uD835\uDD10",
        mfr: "\uD835\uDD2A",
        mho: "℧",
        micro: "µ",
        mid: "∣",
        midast: "*",
        midcir: "⫰",
        middot: "·",
        minus: "−",
        minusb: "⊟",
        minusd: "∸",
        minusdu: "⨪",
        MinusPlus: "∓",
        mlcp: "⫛",
        mldr: "…",
        mnplus: "∓",
        models: "⊧",
        Mopf: "\uD835\uDD44",
        mopf: "\uD835\uDD5E",
        mp: "∓",
        Mscr: "ℳ",
        mscr: "\uD835\uDCC2",
        mstpos: "∾",
        Mu: "Μ",
        mu: "μ",
        multimap: "⊸",
        mumap: "⊸",
        nabla: "∇",
        Nacute: "Ń",
        nacute: "ń",
        nang: "∠⃒",
        nap: "≉",
        napE: "⩰̸",
        napid: "≋̸",
        napos: "ŉ",
        napprox: "≉",
        natur: "♮",
        natural: "♮",
        naturals: "ℕ",
        nbsp: " ",
        nbump: "≎̸",
        nbumpe: "≏̸",
        ncap: "⩃",
        Ncaron: "Ň",
        ncaron: "ň",
        Ncedil: "Ņ",
        ncedil: "ņ",
        ncong: "≇",
        ncongdot: "⩭̸",
        ncup: "⩂",
        Ncy: "Н",
        ncy: "н",
        ndash: "–",
        ne: "≠",
        nearhk: "⤤",
        neArr: "⇗",
        nearr: "↗",
        nearrow: "↗",
        nedot: "≐̸",
        NegativeMediumSpace: "​",
        NegativeThickSpace: "​",
        NegativeThinSpace: "​",
        NegativeVeryThinSpace: "​",
        nequiv: "≢",
        nesear: "⤨",
        nesim: "≂̸",
        NestedGreaterGreater: "≫",
        NestedLessLess: "≪",
        NewLine: `
`,
        nexist: "∄",
        nexists: "∄",
        Nfr: "\uD835\uDD11",
        nfr: "\uD835\uDD2B",
        ngE: "≧̸",
        nge: "≱",
        ngeq: "≱",
        ngeqq: "≧̸",
        ngeqslant: "⩾̸",
        nges: "⩾̸",
        nGg: "⋙̸",
        ngsim: "≵",
        nGt: "≫⃒",
        ngt: "≯",
        ngtr: "≯",
        nGtv: "≫̸",
        nhArr: "⇎",
        nharr: "↮",
        nhpar: "⫲",
        ni: "∋",
        nis: "⋼",
        nisd: "⋺",
        niv: "∋",
        NJcy: "Њ",
        njcy: "њ",
        nlArr: "⇍",
        nlarr: "↚",
        nldr: "‥",
        nlE: "≦̸",
        nle: "≰",
        nLeftarrow: "⇍",
        nleftarrow: "↚",
        nLeftrightarrow: "⇎",
        nleftrightarrow: "↮",
        nleq: "≰",
        nleqq: "≦̸",
        nleqslant: "⩽̸",
        nles: "⩽̸",
        nless: "≮",
        nLl: "⋘̸",
        nlsim: "≴",
        nLt: "≪⃒",
        nlt: "≮",
        nltri: "⋪",
        nltrie: "⋬",
        nLtv: "≪̸",
        nmid: "∤",
        NoBreak: "⁠",
        NonBreakingSpace: " ",
        Nopf: "ℕ",
        nopf: "\uD835\uDD5F",
        Not: "⫬",
        not: "¬",
        NotCongruent: "≢",
        NotCupCap: "≭",
        NotDoubleVerticalBar: "∦",
        NotElement: "∉",
        NotEqual: "≠",
        NotEqualTilde: "≂̸",
        NotExists: "∄",
        NotGreater: "≯",
        NotGreaterEqual: "≱",
        NotGreaterFullEqual: "≧̸",
        NotGreaterGreater: "≫̸",
        NotGreaterLess: "≹",
        NotGreaterSlantEqual: "⩾̸",
        NotGreaterTilde: "≵",
        NotHumpDownHump: "≎̸",
        NotHumpEqual: "≏̸",
        notin: "∉",
        notindot: "⋵̸",
        notinE: "⋹̸",
        notinva: "∉",
        notinvb: "⋷",
        notinvc: "⋶",
        NotLeftTriangle: "⋪",
        NotLeftTriangleBar: "⧏̸",
        NotLeftTriangleEqual: "⋬",
        NotLess: "≮",
        NotLessEqual: "≰",
        NotLessGreater: "≸",
        NotLessLess: "≪̸",
        NotLessSlantEqual: "⩽̸",
        NotLessTilde: "≴",
        NotNestedGreaterGreater: "⪢̸",
        NotNestedLessLess: "⪡̸",
        notni: "∌",
        notniva: "∌",
        notnivb: "⋾",
        notnivc: "⋽",
        NotPrecedes: "⊀",
        NotPrecedesEqual: "⪯̸",
        NotPrecedesSlantEqual: "⋠",
        NotReverseElement: "∌",
        NotRightTriangle: "⋫",
        NotRightTriangleBar: "⧐̸",
        NotRightTriangleEqual: "⋭",
        NotSquareSubset: "⊏̸",
        NotSquareSubsetEqual: "⋢",
        NotSquareSuperset: "⊐̸",
        NotSquareSupersetEqual: "⋣",
        NotSubset: "⊂⃒",
        NotSubsetEqual: "⊈",
        NotSucceeds: "⊁",
        NotSucceedsEqual: "⪰̸",
        NotSucceedsSlantEqual: "⋡",
        NotSucceedsTilde: "≿̸",
        NotSuperset: "⊃⃒",
        NotSupersetEqual: "⊉",
        NotTilde: "≁",
        NotTildeEqual: "≄",
        NotTildeFullEqual: "≇",
        NotTildeTilde: "≉",
        NotVerticalBar: "∤",
        npar: "∦",
        nparallel: "∦",
        nparsl: "⫽⃥",
        npart: "∂̸",
        npolint: "⨔",
        npr: "⊀",
        nprcue: "⋠",
        npre: "⪯̸",
        nprec: "⊀",
        npreceq: "⪯̸",
        nrArr: "⇏",
        nrarr: "↛",
        nrarrc: "⤳̸",
        nrarrw: "↝̸",
        nRightarrow: "⇏",
        nrightarrow: "↛",
        nrtri: "⋫",
        nrtrie: "⋭",
        nsc: "⊁",
        nsccue: "⋡",
        nsce: "⪰̸",
        Nscr: "\uD835\uDCA9",
        nscr: "\uD835\uDCC3",
        nshortmid: "∤",
        nshortparallel: "∦",
        nsim: "≁",
        nsime: "≄",
        nsimeq: "≄",
        nsmid: "∤",
        nspar: "∦",
        nsqsube: "⋢",
        nsqsupe: "⋣",
        nsub: "⊄",
        nsubE: "⫅̸",
        nsube: "⊈",
        nsubset: "⊂⃒",
        nsubseteq: "⊈",
        nsubseteqq: "⫅̸",
        nsucc: "⊁",
        nsucceq: "⪰̸",
        nsup: "⊅",
        nsupE: "⫆̸",
        nsupe: "⊉",
        nsupset: "⊃⃒",
        nsupseteq: "⊉",
        nsupseteqq: "⫆̸",
        ntgl: "≹",
        Ntilde: "Ñ",
        ntilde: "ñ",
        ntlg: "≸",
        ntriangleleft: "⋪",
        ntrianglelefteq: "⋬",
        ntriangleright: "⋫",
        ntrianglerighteq: "⋭",
        Nu: "Ν",
        nu: "ν",
        num: "#",
        numero: "№",
        numsp: " ",
        nvap: "≍⃒",
        nVDash: "⊯",
        nVdash: "⊮",
        nvDash: "⊭",
        nvdash: "⊬",
        nvge: "≥⃒",
        nvgt: ">⃒",
        nvHarr: "⤄",
        nvinfin: "⧞",
        nvlArr: "⤂",
        nvle: "≤⃒",
        nvlt: "<⃒",
        nvltrie: "⊴⃒",
        nvrArr: "⤃",
        nvrtrie: "⊵⃒",
        nvsim: "∼⃒",
        nwarhk: "⤣",
        nwArr: "⇖",
        nwarr: "↖",
        nwarrow: "↖",
        nwnear: "⤧",
        Oacute: "Ó",
        oacute: "ó",
        oast: "⊛",
        ocir: "⊚",
        Ocirc: "Ô",
        ocirc: "ô",
        Ocy: "О",
        ocy: "о",
        odash: "⊝",
        Odblac: "Ő",
        odblac: "ő",
        odiv: "⨸",
        odot: "⊙",
        odsold: "⦼",
        OElig: "Œ",
        oelig: "œ",
        ofcir: "⦿",
        Ofr: "\uD835\uDD12",
        ofr: "\uD835\uDD2C",
        ogon: "˛",
        Ograve: "Ò",
        ograve: "ò",
        ogt: "⧁",
        ohbar: "⦵",
        ohm: "Ω",
        oint: "∮",
        olarr: "↺",
        olcir: "⦾",
        olcross: "⦻",
        oline: "‾",
        olt: "⧀",
        Omacr: "Ō",
        omacr: "ō",
        Omega: "Ω",
        omega: "ω",
        Omicron: "Ο",
        omicron: "ο",
        omid: "⦶",
        ominus: "⊖",
        Oopf: "\uD835\uDD46",
        oopf: "\uD835\uDD60",
        opar: "⦷",
        OpenCurlyDoubleQuote: "“",
        OpenCurlyQuote: "‘",
        operp: "⦹",
        oplus: "⊕",
        Or: "⩔",
        or: "∨",
        orarr: "↻",
        ord: "⩝",
        order: "ℴ",
        orderof: "ℴ",
        ordf: "ª",
        ordm: "º",
        origof: "⊶",
        oror: "⩖",
        orslope: "⩗",
        orv: "⩛",
        oS: "Ⓢ",
        Oscr: "\uD835\uDCAA",
        oscr: "ℴ",
        Oslash: "Ø",
        oslash: "ø",
        osol: "⊘",
        Otilde: "Õ",
        otilde: "õ",
        Otimes: "⨷",
        otimes: "⊗",
        otimesas: "⨶",
        Ouml: "Ö",
        ouml: "ö",
        ovbar: "⌽",
        OverBar: "‾",
        OverBrace: "⏞",
        OverBracket: "⎴",
        OverParenthesis: "⏜",
        par: "∥",
        para: "¶",
        parallel: "∥",
        parsim: "⫳",
        parsl: "⫽",
        part: "∂",
        PartialD: "∂",
        Pcy: "П",
        pcy: "п",
        percnt: "%",
        period: ".",
        permil: "‰",
        perp: "⊥",
        pertenk: "‱",
        Pfr: "\uD835\uDD13",
        pfr: "\uD835\uDD2D",
        Phi: "Φ",
        phi: "φ",
        phiv: "ϕ",
        phmmat: "ℳ",
        phone: "☎",
        Pi: "Π",
        pi: "π",
        pitchfork: "⋔",
        piv: "ϖ",
        planck: "ℏ",
        planckh: "ℎ",
        plankv: "ℏ",
        plus: "+",
        plusacir: "⨣",
        plusb: "⊞",
        pluscir: "⨢",
        plusdo: "∔",
        plusdu: "⨥",
        pluse: "⩲",
        PlusMinus: "±",
        plusmn: "±",
        plussim: "⨦",
        plustwo: "⨧",
        pm: "±",
        Poincareplane: "ℌ",
        pointint: "⨕",
        Popf: "ℙ",
        popf: "\uD835\uDD61",
        pound: "£",
        Pr: "⪻",
        pr: "≺",
        prap: "⪷",
        prcue: "≼",
        prE: "⪳",
        pre: "⪯",
        prec: "≺",
        precapprox: "⪷",
        preccurlyeq: "≼",
        Precedes: "≺",
        PrecedesEqual: "⪯",
        PrecedesSlantEqual: "≼",
        PrecedesTilde: "≾",
        preceq: "⪯",
        precnapprox: "⪹",
        precneqq: "⪵",
        precnsim: "⋨",
        precsim: "≾",
        Prime: "″",
        prime: "′",
        primes: "ℙ",
        prnap: "⪹",
        prnE: "⪵",
        prnsim: "⋨",
        prod: "∏",
        Product: "∏",
        profalar: "⌮",
        profline: "⌒",
        profsurf: "⌓",
        prop: "∝",
        Proportion: "∷",
        Proportional: "∝",
        propto: "∝",
        prsim: "≾",
        prurel: "⊰",
        Pscr: "\uD835\uDCAB",
        pscr: "\uD835\uDCC5",
        Psi: "Ψ",
        psi: "ψ",
        puncsp: " ",
        Qfr: "\uD835\uDD14",
        qfr: "\uD835\uDD2E",
        qint: "⨌",
        Qopf: "ℚ",
        qopf: "\uD835\uDD62",
        qprime: "⁗",
        Qscr: "\uD835\uDCAC",
        qscr: "\uD835\uDCC6",
        quaternions: "ℍ",
        quatint: "⨖",
        quest: "?",
        questeq: "≟",
        QUOT: '"',
        quot: '"',
        rAarr: "⇛",
        race: "∽̱",
        Racute: "Ŕ",
        racute: "ŕ",
        radic: "√",
        raemptyv: "⦳",
        Rang: "⟫",
        rang: "⟩",
        rangd: "⦒",
        range: "⦥",
        rangle: "⟩",
        raquo: "»",
        Rarr: "↠",
        rArr: "⇒",
        rarr: "→",
        rarrap: "⥵",
        rarrb: "⇥",
        rarrbfs: "⤠",
        rarrc: "⤳",
        rarrfs: "⤞",
        rarrhk: "↪",
        rarrlp: "↬",
        rarrpl: "⥅",
        rarrsim: "⥴",
        Rarrtl: "⤖",
        rarrtl: "↣",
        rarrw: "↝",
        rAtail: "⤜",
        ratail: "⤚",
        ratio: "∶",
        rationals: "ℚ",
        RBarr: "⤐",
        rBarr: "⤏",
        rbarr: "⤍",
        rbbrk: "❳",
        rbrace: "}",
        rbrack: "]",
        rbrke: "⦌",
        rbrksld: "⦎",
        rbrkslu: "⦐",
        Rcaron: "Ř",
        rcaron: "ř",
        Rcedil: "Ŗ",
        rcedil: "ŗ",
        rceil: "⌉",
        rcub: "}",
        Rcy: "Р",
        rcy: "р",
        rdca: "⤷",
        rdldhar: "⥩",
        rdquo: "”",
        rdquor: "”",
        rdsh: "↳",
        Re: "ℜ",
        real: "ℜ",
        realine: "ℛ",
        realpart: "ℜ",
        reals: "ℝ",
        rect: "▭",
        REG: "®",
        reg: "®",
        ReverseElement: "∋",
        ReverseEquilibrium: "⇋",
        ReverseUpEquilibrium: "⥯",
        rfisht: "⥽",
        rfloor: "⌋",
        Rfr: "ℜ",
        rfr: "\uD835\uDD2F",
        rHar: "⥤",
        rhard: "⇁",
        rharu: "⇀",
        rharul: "⥬",
        Rho: "Ρ",
        rho: "ρ",
        rhov: "ϱ",
        RightAngleBracket: "⟩",
        RightArrow: "→",
        Rightarrow: "⇒",
        rightarrow: "→",
        RightArrowBar: "⇥",
        RightArrowLeftArrow: "⇄",
        rightarrowtail: "↣",
        RightCeiling: "⌉",
        RightDoubleBracket: "⟧",
        RightDownTeeVector: "⥝",
        RightDownVector: "⇂",
        RightDownVectorBar: "⥕",
        RightFloor: "⌋",
        rightharpoondown: "⇁",
        rightharpoonup: "⇀",
        rightleftarrows: "⇄",
        rightleftharpoons: "⇌",
        rightrightarrows: "⇉",
        rightsquigarrow: "↝",
        RightTee: "⊢",
        RightTeeArrow: "↦",
        RightTeeVector: "⥛",
        rightthreetimes: "⋌",
        RightTriangle: "⊳",
        RightTriangleBar: "⧐",
        RightTriangleEqual: "⊵",
        RightUpDownVector: "⥏",
        RightUpTeeVector: "⥜",
        RightUpVector: "↾",
        RightUpVectorBar: "⥔",
        RightVector: "⇀",
        RightVectorBar: "⥓",
        ring: "˚",
        risingdotseq: "≓",
        rlarr: "⇄",
        rlhar: "⇌",
        rlm: "‏",
        rmoust: "⎱",
        rmoustache: "⎱",
        rnmid: "⫮",
        roang: "⟭",
        roarr: "⇾",
        robrk: "⟧",
        ropar: "⦆",
        Ropf: "ℝ",
        ropf: "\uD835\uDD63",
        roplus: "⨮",
        rotimes: "⨵",
        RoundImplies: "⥰",
        rpar: ")",
        rpargt: "⦔",
        rppolint: "⨒",
        rrarr: "⇉",
        Rrightarrow: "⇛",
        rsaquo: "›",
        Rscr: "ℛ",
        rscr: "\uD835\uDCC7",
        Rsh: "↱",
        rsh: "↱",
        rsqb: "]",
        rsquo: "’",
        rsquor: "’",
        rthree: "⋌",
        rtimes: "⋊",
        rtri: "▹",
        rtrie: "⊵",
        rtrif: "▸",
        rtriltri: "⧎",
        RuleDelayed: "⧴",
        ruluhar: "⥨",
        rx: "℞",
        Sacute: "Ś",
        sacute: "ś",
        sbquo: "‚",
        Sc: "⪼",
        sc: "≻",
        scap: "⪸",
        Scaron: "Š",
        scaron: "š",
        sccue: "≽",
        scE: "⪴",
        sce: "⪰",
        Scedil: "Ş",
        scedil: "ş",
        Scirc: "Ŝ",
        scirc: "ŝ",
        scnap: "⪺",
        scnE: "⪶",
        scnsim: "⋩",
        scpolint: "⨓",
        scsim: "≿",
        Scy: "С",
        scy: "с",
        sdot: "⋅",
        sdotb: "⊡",
        sdote: "⩦",
        searhk: "⤥",
        seArr: "⇘",
        searr: "↘",
        searrow: "↘",
        sect: "§",
        semi: ";",
        seswar: "⤩",
        setminus: "∖",
        setmn: "∖",
        sext: "✶",
        Sfr: "\uD835\uDD16",
        sfr: "\uD835\uDD30",
        sfrown: "⌢",
        sharp: "♯",
        SHCHcy: "Щ",
        shchcy: "щ",
        SHcy: "Ш",
        shcy: "ш",
        ShortDownArrow: "↓",
        ShortLeftArrow: "←",
        shortmid: "∣",
        shortparallel: "∥",
        ShortRightArrow: "→",
        ShortUpArrow: "↑",
        shy: "­",
        Sigma: "Σ",
        sigma: "σ",
        sigmaf: "ς",
        sigmav: "ς",
        sim: "∼",
        simdot: "⩪",
        sime: "≃",
        simeq: "≃",
        simg: "⪞",
        simgE: "⪠",
        siml: "⪝",
        simlE: "⪟",
        simne: "≆",
        simplus: "⨤",
        simrarr: "⥲",
        slarr: "←",
        SmallCircle: "∘",
        smallsetminus: "∖",
        smashp: "⨳",
        smeparsl: "⧤",
        smid: "∣",
        smile: "⌣",
        smt: "⪪",
        smte: "⪬",
        smtes: "⪬︀",
        SOFTcy: "Ь",
        softcy: "ь",
        sol: "/",
        solb: "⧄",
        solbar: "⌿",
        Sopf: "\uD835\uDD4A",
        sopf: "\uD835\uDD64",
        spades: "♠",
        spadesuit: "♠",
        spar: "∥",
        sqcap: "⊓",
        sqcaps: "⊓︀",
        sqcup: "⊔",
        sqcups: "⊔︀",
        Sqrt: "√",
        sqsub: "⊏",
        sqsube: "⊑",
        sqsubset: "⊏",
        sqsubseteq: "⊑",
        sqsup: "⊐",
        sqsupe: "⊒",
        sqsupset: "⊐",
        sqsupseteq: "⊒",
        squ: "□",
        Square: "□",
        square: "□",
        SquareIntersection: "⊓",
        SquareSubset: "⊏",
        SquareSubsetEqual: "⊑",
        SquareSuperset: "⊐",
        SquareSupersetEqual: "⊒",
        SquareUnion: "⊔",
        squarf: "▪",
        squf: "▪",
        srarr: "→",
        Sscr: "\uD835\uDCAE",
        sscr: "\uD835\uDCC8",
        ssetmn: "∖",
        ssmile: "⌣",
        sstarf: "⋆",
        Star: "⋆",
        star: "☆",
        starf: "★",
        straightepsilon: "ϵ",
        straightphi: "ϕ",
        strns: "¯",
        Sub: "⋐",
        sub: "⊂",
        subdot: "⪽",
        subE: "⫅",
        sube: "⊆",
        subedot: "⫃",
        submult: "⫁",
        subnE: "⫋",
        subne: "⊊",
        subplus: "⪿",
        subrarr: "⥹",
        Subset: "⋐",
        subset: "⊂",
        subseteq: "⊆",
        subseteqq: "⫅",
        SubsetEqual: "⊆",
        subsetneq: "⊊",
        subsetneqq: "⫋",
        subsim: "⫇",
        subsub: "⫕",
        subsup: "⫓",
        succ: "≻",
        succapprox: "⪸",
        succcurlyeq: "≽",
        Succeeds: "≻",
        SucceedsEqual: "⪰",
        SucceedsSlantEqual: "≽",
        SucceedsTilde: "≿",
        succeq: "⪰",
        succnapprox: "⪺",
        succneqq: "⪶",
        succnsim: "⋩",
        succsim: "≿",
        SuchThat: "∋",
        Sum: "∑",
        sum: "∑",
        sung: "♪",
        Sup: "⋑",
        sup: "⊃",
        sup1: "¹",
        sup2: "²",
        sup3: "³",
        supdot: "⪾",
        supdsub: "⫘",
        supE: "⫆",
        supe: "⊇",
        supedot: "⫄",
        Superset: "⊃",
        SupersetEqual: "⊇",
        suphsol: "⟉",
        suphsub: "⫗",
        suplarr: "⥻",
        supmult: "⫂",
        supnE: "⫌",
        supne: "⊋",
        supplus: "⫀",
        Supset: "⋑",
        supset: "⊃",
        supseteq: "⊇",
        supseteqq: "⫆",
        supsetneq: "⊋",
        supsetneqq: "⫌",
        supsim: "⫈",
        supsub: "⫔",
        supsup: "⫖",
        swarhk: "⤦",
        swArr: "⇙",
        swarr: "↙",
        swarrow: "↙",
        swnwar: "⤪",
        szlig: "ß",
        Tab: "\t",
        target: "⌖",
        Tau: "Τ",
        tau: "τ",
        tbrk: "⎴",
        Tcaron: "Ť",
        tcaron: "ť",
        Tcedil: "Ţ",
        tcedil: "ţ",
        Tcy: "Т",
        tcy: "т",
        tdot: "⃛",
        telrec: "⌕",
        Tfr: "\uD835\uDD17",
        tfr: "\uD835\uDD31",
        there4: "∴",
        Therefore: "∴",
        therefore: "∴",
        Theta: "Θ",
        theta: "θ",
        thetasym: "ϑ",
        thetav: "ϑ",
        thickapprox: "≈",
        thicksim: "∼",
        ThickSpace: "  ",
        thinsp: " ",
        ThinSpace: " ",
        thkap: "≈",
        thksim: "∼",
        THORN: "Þ",
        thorn: "þ",
        Tilde: "∼",
        tilde: "˜",
        TildeEqual: "≃",
        TildeFullEqual: "≅",
        TildeTilde: "≈",
        times: "×",
        timesb: "⊠",
        timesbar: "⨱",
        timesd: "⨰",
        tint: "∭",
        toea: "⤨",
        top: "⊤",
        topbot: "⌶",
        topcir: "⫱",
        Topf: "\uD835\uDD4B",
        topf: "\uD835\uDD65",
        topfork: "⫚",
        tosa: "⤩",
        tprime: "‴",
        TRADE: "™",
        trade: "™",
        triangle: "▵",
        triangledown: "▿",
        triangleleft: "◃",
        trianglelefteq: "⊴",
        triangleq: "≜",
        triangleright: "▹",
        trianglerighteq: "⊵",
        tridot: "◬",
        trie: "≜",
        triminus: "⨺",
        TripleDot: "⃛",
        triplus: "⨹",
        trisb: "⧍",
        tritime: "⨻",
        trpezium: "⏢",
        Tscr: "\uD835\uDCAF",
        tscr: "\uD835\uDCC9",
        TScy: "Ц",
        tscy: "ц",
        TSHcy: "Ћ",
        tshcy: "ћ",
        Tstrok: "Ŧ",
        tstrok: "ŧ",
        twixt: "≬",
        twoheadleftarrow: "↞",
        twoheadrightarrow: "↠",
        Uacute: "Ú",
        uacute: "ú",
        Uarr: "↟",
        uArr: "⇑",
        uarr: "↑",
        Uarrocir: "⥉",
        Ubrcy: "Ў",
        ubrcy: "ў",
        Ubreve: "Ŭ",
        ubreve: "ŭ",
        Ucirc: "Û",
        ucirc: "û",
        Ucy: "У",
        ucy: "у",
        udarr: "⇅",
        Udblac: "Ű",
        udblac: "ű",
        udhar: "⥮",
        ufisht: "⥾",
        Ufr: "\uD835\uDD18",
        ufr: "\uD835\uDD32",
        Ugrave: "Ù",
        ugrave: "ù",
        uHar: "⥣",
        uharl: "↿",
        uharr: "↾",
        uhblk: "▀",
        ulcorn: "⌜",
        ulcorner: "⌜",
        ulcrop: "⌏",
        ultri: "◸",
        Umacr: "Ū",
        umacr: "ū",
        uml: "¨",
        UnderBar: "_",
        UnderBrace: "⏟",
        UnderBracket: "⎵",
        UnderParenthesis: "⏝",
        Union: "⋃",
        UnionPlus: "⊎",
        Uogon: "Ų",
        uogon: "ų",
        Uopf: "\uD835\uDD4C",
        uopf: "\uD835\uDD66",
        UpArrow: "↑",
        Uparrow: "⇑",
        uparrow: "↑",
        UpArrowBar: "⤒",
        UpArrowDownArrow: "⇅",
        UpDownArrow: "↕",
        Updownarrow: "⇕",
        updownarrow: "↕",
        UpEquilibrium: "⥮",
        upharpoonleft: "↿",
        upharpoonright: "↾",
        uplus: "⊎",
        UpperLeftArrow: "↖",
        UpperRightArrow: "↗",
        Upsi: "ϒ",
        upsi: "υ",
        upsih: "ϒ",
        Upsilon: "Υ",
        upsilon: "υ",
        UpTee: "⊥",
        UpTeeArrow: "↥",
        upuparrows: "⇈",
        urcorn: "⌝",
        urcorner: "⌝",
        urcrop: "⌎",
        Uring: "Ů",
        uring: "ů",
        urtri: "◹",
        Uscr: "\uD835\uDCB0",
        uscr: "\uD835\uDCCA",
        utdot: "⋰",
        Utilde: "Ũ",
        utilde: "ũ",
        utri: "▵",
        utrif: "▴",
        uuarr: "⇈",
        Uuml: "Ü",
        uuml: "ü",
        uwangle: "⦧",
        vangrt: "⦜",
        varepsilon: "ϵ",
        varkappa: "ϰ",
        varnothing: "∅",
        varphi: "ϕ",
        varpi: "ϖ",
        varpropto: "∝",
        vArr: "⇕",
        varr: "↕",
        varrho: "ϱ",
        varsigma: "ς",
        varsubsetneq: "⊊︀",
        varsubsetneqq: "⫋︀",
        varsupsetneq: "⊋︀",
        varsupsetneqq: "⫌︀",
        vartheta: "ϑ",
        vartriangleleft: "⊲",
        vartriangleright: "⊳",
        Vbar: "⫫",
        vBar: "⫨",
        vBarv: "⫩",
        Vcy: "В",
        vcy: "в",
        VDash: "⊫",
        Vdash: "⊩",
        vDash: "⊨",
        vdash: "⊢",
        Vdashl: "⫦",
        Vee: "⋁",
        vee: "∨",
        veebar: "⊻",
        veeeq: "≚",
        vellip: "⋮",
        Verbar: "‖",
        verbar: "|",
        Vert: "‖",
        vert: "|",
        VerticalBar: "∣",
        VerticalLine: "|",
        VerticalSeparator: "❘",
        VerticalTilde: "≀",
        VeryThinSpace: " ",
        Vfr: "\uD835\uDD19",
        vfr: "\uD835\uDD33",
        vltri: "⊲",
        vnsub: "⊂⃒",
        vnsup: "⊃⃒",
        Vopf: "\uD835\uDD4D",
        vopf: "\uD835\uDD67",
        vprop: "∝",
        vrtri: "⊳",
        Vscr: "\uD835\uDCB1",
        vscr: "\uD835\uDCCB",
        vsubnE: "⫋︀",
        vsubne: "⊊︀",
        vsupnE: "⫌︀",
        vsupne: "⊋︀",
        Vvdash: "⊪",
        vzigzag: "⦚",
        Wcirc: "Ŵ",
        wcirc: "ŵ",
        wedbar: "⩟",
        Wedge: "⋀",
        wedge: "∧",
        wedgeq: "≙",
        weierp: "℘",
        Wfr: "\uD835\uDD1A",
        wfr: "\uD835\uDD34",
        Wopf: "\uD835\uDD4E",
        wopf: "\uD835\uDD68",
        wp: "℘",
        wr: "≀",
        wreath: "≀",
        Wscr: "\uD835\uDCB2",
        wscr: "\uD835\uDCCC",
        xcap: "⋂",
        xcirc: "◯",
        xcup: "⋃",
        xdtri: "▽",
        Xfr: "\uD835\uDD1B",
        xfr: "\uD835\uDD35",
        xhArr: "⟺",
        xharr: "⟷",
        Xi: "Ξ",
        xi: "ξ",
        xlArr: "⟸",
        xlarr: "⟵",
        xmap: "⟼",
        xnis: "⋻",
        xodot: "⨀",
        Xopf: "\uD835\uDD4F",
        xopf: "\uD835\uDD69",
        xoplus: "⨁",
        xotime: "⨂",
        xrArr: "⟹",
        xrarr: "⟶",
        Xscr: "\uD835\uDCB3",
        xscr: "\uD835\uDCCD",
        xsqcup: "⨆",
        xuplus: "⨄",
        xutri: "△",
        xvee: "⋁",
        xwedge: "⋀",
        Yacute: "Ý",
        yacute: "ý",
        YAcy: "Я",
        yacy: "я",
        Ycirc: "Ŷ",
        ycirc: "ŷ",
        Ycy: "Ы",
        ycy: "ы",
        yen: "¥",
        Yfr: "\uD835\uDD1C",
        yfr: "\uD835\uDD36",
        YIcy: "Ї",
        yicy: "ї",
        Yopf: "\uD835\uDD50",
        yopf: "\uD835\uDD6A",
        Yscr: "\uD835\uDCB4",
        yscr: "\uD835\uDCCE",
        YUcy: "Ю",
        yucy: "ю",
        Yuml: "Ÿ",
        yuml: "ÿ",
        Zacute: "Ź",
        zacute: "ź",
        Zcaron: "Ž",
        zcaron: "ž",
        Zcy: "З",
        zcy: "з",
        Zdot: "Ż",
        zdot: "ż",
        zeetrf: "ℨ",
        ZeroWidthSpace: "​",
        Zeta: "Ζ",
        zeta: "ζ",
        Zfr: "ℨ",
        zfr: "\uD835\uDD37",
        ZHcy: "Ж",
        zhcy: "ж",
        zigrarr: "⇝",
        Zopf: "ℤ",
        zopf: "\uD835\uDD6B",
        Zscr: "\uD835\uDCB5",
        zscr: "\uD835\uDCCF",
        zwj: "‍",
        zwnj: "‌"
    });
    wd.entityMap = wd.HTML_ENTITIES
}
);
var oR = G5((Pd) => {
    var HH = JH().NAMESPACE
        , lG = /[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/
        , gR = new RegExp("[\\-\\.0-9" + lG.source.slice(1, -1) + "\\u00B7\\u0300-\\u036F\\u203F-\\u2040]")
        , mR = new RegExp("^" + lG.source + gR.source + "*(?::" + lG.source + gR.source + "*)?$")
        , VH = 0
        , vZ = 1
        , z4 = 2
        , zH = 3
        , W4 = 4
        , H4 = 5
        , WH = 6
        , hC = 7;
    function Y4(J, Q) {
        if (this.message = J,
            this.locator = Q,
            Error.captureStackTrace)
            Error.captureStackTrace(this, Y4)
    }
    Y4.prototype = new Error;
    Y4.prototype.name = Y4.name;
    function pR() { }
    pR.prototype = {
        parse: function (J, Q, Z) {
            var $ = this.domBuilder;
            $.startDocument(),
                uR(Q, Q = {}),
                kd(J, Q, Z, $, this.errorHandler),
                $.endDocument()
        }
    };
    function kd(J, Q, Z, $, q) {
        function K(E0) {
            if (E0 > 65535) {
                E0 -= 65536;
                var v0 = 55296 + (E0 >> 10)
                    , G6 = 56320 + (E0 & 1023);
                return String.fromCharCode(v0, G6)
            } else
                return String.fromCharCode(E0)
        }
        function V(E0) {
            var v0 = E0.slice(1, -1);
            if (Object.hasOwnProperty.call(Z, v0))
                return Z[v0];
            else if (v0.charAt(0) === "#")
                return K(parseInt(v0.substr(1).replace("x", "0x")));
            else
                return q.error("entity not found:" + E0),
                    E0
        }
        function z(E0) {
            if (E0 > L) {
                var v0 = J.substring(L, E0).replace(/&#?\w+;/g, V);
                N && W(L),
                    $.characters(v0, 0, E0 - L),
                    L = E0
            }
        }
        function W(E0, v0) {
            while (E0 >= Y && (v0 = U.exec(J)))
                H = v0.index,
                    Y = H + v0[0].length,
                    N.lineNumber++;
            N.columnNumber = E0 - H + 1
        }
        var H = 0
            , Y = 0
            , U = /.*(?:\r\n?|\n)|.*$/g
            , N = $.locator
            , j = [{
                currentNSMap: Q
            }]
            , k = {}
            , L = 0;
        while (!0) {
            try {
                var F = J.indexOf("<", L);
                if (F < 0) {
                    if (!J.substr(L).match(/^\s*$/)) {
                        var P = $.doc
                            , M = P.createTextNode(J.substr(L));
                        P.appendChild(M),
                            $.currentElement = M
                    }
                    return
                }
                if (F > L)
                    z(F);
                switch (J.charAt(F + 1)) {
                    case "/":
                        var o = J.indexOf(">", F + 3)
                            , v = J.substring(F + 2, o).replace(/[ \t\n\r]+$/g, "")
                            , E = j.pop();
                        if (o < 0)
                            v = J.substring(F + 2).replace(/[\s<].*/, ""),
                                q.error("end tag name: " + v + " is not complete:" + E.tagName),
                                o = F + 1 + v.length;
                        else if (v.match(/\s</))
                            v = v.replace(/[\s<].*/, ""),
                                q.error("end tag name: " + v + " maybe not complete"),
                                o = F + 1 + v.length;
                        var n = E.localNSMap
                            , u = E.tagName == v
                            , b = u || E.tagName && E.tagName.toLowerCase() == v.toLowerCase();
                        if (b) {
                            if ($.endElement(E.uri, E.localName, v),
                                n) {
                                for (var i in n)
                                    if (Object.prototype.hasOwnProperty.call(n, i))
                                        $.endPrefixMapping(i)
                            }
                            if (!u)
                                q.fatalError("end tag name: " + v + " is not match the current start tagName:" + E.tagName)
                        } else
                            j.push(E);
                        o++;
                        break;
                    case "?":
                        N && W(F),
                            o = Fd(J, F, $);
                        break;
                    case "!":
                        N && W(F),
                            o = Ld(J, F, $, q);
                        break;
                    default:
                        N && W(F);
                        var g = new lR
                            , l = j[j.length - 1].currentNSMap
                            , o = Cd(J, F, g, l, V, q)
                            , F0 = g.length;
                        if (!g.closed && Id(J, o, g.tagName, k)) {
                            if (g.closed = !0,
                                !Z.nbsp)
                                q.warning("unclosed xml attribute")
                        }
                        if (N && F0) {
                            var b0 = cR(N, {});
                            for (var d0 = 0; d0 < F0; d0++) {
                                var H8 = g[d0];
                                W(H8.offset),
                                    H8.locator = cR(N, {})
                            }
                            if ($.locator = b0,
                                dR(g, $, l))
                                j.push(g);
                            $.locator = N
                        } else if (dR(g, $, l))
                            j.push(g);
                        if (HH.isHTML(g.uri) && !g.closed)
                            o = Od(J, o, g.tagName, V, $);
                        else
                            o++
                }
            } catch (E0) {
                if (E0 instanceof Y4)
                    throw E0;
                q.error("element parse error: " + E0),
                    o = -1
            }
            if (o > L)
                L = o;
            else
                z(Math.max(F, L) + 1)
        }
    }
    function cR(J, Q) {
        return Q.lineNumber = J.lineNumber,
            Q.columnNumber = J.columnNumber,
            Q
    }
    function Cd(J, Q, Z, $, q, K) {
        function V(j, k, L) {
            if (Z.attributeNames.hasOwnProperty(j))
                K.fatalError("Attribute " + j + " redefined");
            Z.addValue(j, k.replace(/[\t\n\r]/g, " ").replace(/&#?\w+;/g, q), L)
        }
        var z, W, H = ++Q, Y = VH;
        while (!0) {
            var U = J.charAt(H);
            switch (U) {
                case "=":
                    if (Y === vZ)
                        z = J.slice(Q, H),
                            Y = zH;
                    else if (Y === z4)
                        Y = zH;
                    else
                        throw new Error("attribute equal must after attrName");
                    break;
                case "'":
                case '"':
                    if (Y === zH || Y === vZ) {
                        if (Y === vZ)
                            K.warning('attribute value must after "="'),
                                z = J.slice(Q, H);
                        if (Q = H + 1,
                            H = J.indexOf(U, Q),
                            H > 0)
                            W = J.slice(Q, H),
                                V(z, W, Q - 1),
                                Y = H4;
                        else
                            throw new Error("attribute value no end '" + U + "' match")
                    } else if (Y == W4)
                        W = J.slice(Q, H),
                            V(z, W, Q),
                            K.warning('attribute "' + z + '" missed start quot(' + U + ")!!"),
                            Q = H + 1,
                            Y = H4;
                    else
                        throw new Error('attribute value must after "="');
                    break;
                case "/":
                    switch (Y) {
                        case VH:
                            Z.setTagName(J.slice(Q, H));
                        case H4:
                        case WH:
                        case hC:
                            Y = hC,
                                Z.closed = !0;
                        case W4:
                        case vZ:
                            break;
                        case z4:
                            Z.closed = !0;
                            break;
                        default:
                            throw new Error("attribute invalid close char('/')")
                    }
                    break;
                case "":
                    if (K.error("unexpected end of input"),
                        Y == VH)
                        Z.setTagName(J.slice(Q, H));
                    return H;
                case ">":
                    switch (Y) {
                        case VH:
                            Z.setTagName(J.slice(Q, H));
                        case H4:
                        case WH:
                        case hC:
                            break;
                        case W4:
                        case vZ:
                            if (W = J.slice(Q, H),
                                W.slice(-1) === "/")
                                Z.closed = !0,
                                    W = W.slice(0, -1);
                        case z4:
                            if (Y === z4)
                                W = z;
                            if (Y == W4)
                                K.warning('attribute "' + W + '" missed quot(")!'),
                                    V(z, W, Q);
                            else {
                                if (!HH.isHTML($[""]) || !W.match(/^(?:disabled|checked|selected)$/i))
                                    K.warning('attribute "' + W + '" missed value!! "' + W + '" instead!!');
                                V(W, W, Q)
                            }
                            break;
                        case zH:
                            throw new Error("attribute value missed!!")
                    }
                    return H;
                case "":
                    U = " ";
                default:
                    if (U <= " ")
                        switch (Y) {
                            case VH:
                                Z.setTagName(J.slice(Q, H)),
                                    Y = WH;
                                break;
                            case vZ:
                                z = J.slice(Q, H),
                                    Y = z4;
                                break;
                            case W4:
                                var W = J.slice(Q, H);
                                K.warning('attribute "' + W + '" missed quot(")!!'),
                                    V(z, W, Q);
                            case H4:
                                Y = WH;
                                break
                        }
                    else
                        switch (Y) {
                            case z4:
                                var N = Z.tagName;
                                if (!HH.isHTML($[""]) || !z.match(/^(?:disabled|checked|selected)$/i))
                                    K.warning('attribute "' + z + '" missed value!! "' + z + '" instead2!!');
                                V(z, z, Q),
                                    Q = H,
                                    Y = vZ;
                                break;
                            case H4:
                                K.warning('attribute space is required"' + z + '"!!');
                            case WH:
                                Y = vZ,
                                    Q = H;
                                break;
                            case zH:
                                Y = W4,
                                    Q = H;
                                break;
                            case hC:
                                throw new Error("elements closed character '/' and '>' must be connected to")
                        }
            }
            H++
        }
    }
    function dR(J, Q, Z) {
        var $ = J.tagName
            , q = null
            , U = J.length;
        while (U--) {
            var K = J[U]
                , V = K.qName
                , z = K.value
                , N = V.indexOf(":");
            if (N > 0)
                var W = K.prefix = V.slice(0, N)
                    , H = V.slice(N + 1)
                    , Y = W === "xmlns" && H;
            else
                H = V,
                    W = null,
                    Y = V === "xmlns" && "";
            if (K.localName = H,
                Y !== !1) {
                if (q == null)
                    q = {},
                        uR(Z, Z = {});
                Z[Y] = q[Y] = z,
                    K.uri = HH.XMLNS,
                    Q.startPrefixMapping(Y, z)
            }
        }
        var U = J.length;
        while (U--) {
            K = J[U];
            var W = K.prefix;
            if (W) {
                if (W === "xml")
                    K.uri = HH.XML;
                if (W !== "xmlns")
                    K.uri = Z[W || ""]
            }
        }
        var N = $.indexOf(":");
        if (N > 0)
            W = J.prefix = $.slice(0, N),
                H = J.localName = $.slice(N + 1);
        else
            W = null,
                H = J.localName = $;
        var j = J.uri = Z[W || ""];
        if (Q.startElement(j, H, $, J),
            J.closed) {
            if (Q.endElement(j, H, $),
                q) {
                for (W in q)
                    if (Object.prototype.hasOwnProperty.call(q, W))
                        Q.endPrefixMapping(W)
            }
        } else
            return J.currentNSMap = Z,
                J.localNSMap = q,
                !0
    }
    function Od(J, Q, Z, $, q) {
        if (/^(?:script|textarea)$/i.test(Z)) {
            var K = J.indexOf("</" + Z + ">", Q)
                , V = J.substring(Q + 1, K);
            if (/[&<]/.test(V)) {
                if (/^script$/i.test(Z))
                    return q.characters(V, 0, V.length),
                        K;
                return V = V.replace(/&#?\w+;/g, $),
                    q.characters(V, 0, V.length),
                    K
            }
        }
        return Q + 1
    }
    function Id(J, Q, Z, $) {
        var q = $[Z];
        if (q == null) {
            if (q = J.lastIndexOf("</" + Z + ">"),
                q < Q)
                q = J.lastIndexOf("</" + Z);
            $[Z] = q
        }
        return q < Q
    }
    function uR(J, Q) {
        for (var Z in J)
            if (Object.prototype.hasOwnProperty.call(J, Z))
                Q[Z] = J[Z]
    }
    function Ld(J, Q, Z, $) {
        var q = J.charAt(Q + 2);
        switch (q) {
            case "-":
                if (J.charAt(Q + 3) === "-") {
                    var K = J.indexOf("-->", Q + 4);
                    if (K > Q)
                        return Z.comment(J, Q + 4, K - Q - 4),
                            K + 3;
                    else
                        return $.error("Unclosed comment"),
                            -1
                } else
                    return -1;
            default:
                if (J.substr(Q + 3, 6) == "CDATA[") {
                    var K = J.indexOf("]]>", Q + 9);
                    return Z.startCDATA(),
                        Z.characters(J, Q + 9, K - Q - 9),
                        Z.endCDATA(),
                        K + 3
                }
                var V = Gd(J, Q)
                    , z = V.length;
                if (z > 1 && /!doctype/i.test(V[0][0])) {
                    var W = V[1][0]
                        , H = !1
                        , Y = !1;
                    if (z > 3) {
                        if (/^public$/i.test(V[2][0]))
                            H = V[3][0],
                                Y = z > 4 && V[4][0];
                        else if (/^system$/i.test(V[2][0]))
                            Y = V[3][0]
                    }
                    var U = V[z - 1];
                    return Z.startDTD(W, H, Y),
                        Z.endDTD(),
                        U.index + U[0].length
                }
        }
        return -1
    }
    function Fd(J, Q, Z) {
        var $ = J.indexOf("?>", Q);
        if ($) {
            var q = J.substring(Q, $).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);
            if (q) {
                var K = q[0].length;
                return Z.processingInstruction(q[1], q[2]),
                    $ + 2
            } else
                return -1
        }
        return -1
    }
    function lR() {
        this.attributeNames = {}
    }
    lR.prototype = {
        setTagName: function (J) {
            if (!mR.test(J))
                throw new Error("invalid tagName:" + J);
            this.tagName = J
        },
        addValue: function (J, Q, Z) {
            if (!mR.test(J))
                throw new Error("invalid attribute:" + J);
            this.attributeNames[J] = this.length,
                this[this.length++] = {
                    qName: J,
                    value: Q,
                    offset: Z
                }
        },
        length: 0,
        getLocalName: function (J) {
            return this[J].localName
        },
        getLocator: function (J) {
            return this[J].locator
        },
        getQName: function (J) {
            return this[J].qName
        },
        getURI: function (J) {
            return this[J].uri
        },
        getValue: function (J) {
            return this[J].value
        }
    };
    function Gd(J, Q) {
        var Z, $ = [], q = /'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;
        q.lastIndex = Q,
            q.exec(J);
        while (Z = q.exec(J))
            if ($.push(Z),
                Z[1])
                return $
    }
    Pd.XMLReader = pR;
    Pd.ParseError = Y4
}
);
var eR = G5((Td) => {
    var Ed = JH()
        , Md = uG()
        , nR = xR()
        , aR = oR()
        , _d = Md.DOMImplementation
        , sR = Ed.NAMESPACE
        , Rd = aR.ParseError
        , bd = aR.XMLReader;
    function rR(J) {
        return J.replace(/\r[\n\u0085]/g, `
`).replace(/[\r\u0085\u2028]/g, `
`)
    }
    function tR(J) {
        this.options = J || {
            locator: {}
        }
    }
    tR.prototype.parseFromString = function (J, Q) {
        var Z = this.options
            , $ = new bd
            , q = Z.domBuilder || new YH
            , K = Z.errorHandler
            , V = Z.locator
            , z = Z.xmlns || {}
            , W = /\/x?html?$/.test(Q)
            , H = W ? nR.HTML_ENTITIES : nR.XML_ENTITIES;
        if (V)
            q.setDocumentLocator(V);
        if ($.errorHandler = vd(K, q, V),
            $.domBuilder = Z.domBuilder || q,
            W)
            z[""] = sR.HTML;
        z.xml = z.xml || sR.XML;
        var Y = Z.normalizeLineEndings || rR;
        if (J && typeof J === "string")
            $.parse(Y(J), z, H);
        else
            $.errorHandler.error("invalid doc source");
        return q.doc
    }
        ;
    function vd(J, Q, Z) {
        if (!J) {
            if (Q instanceof YH)
                return Q;
            J = Q
        }
        var $ = {}
            , q = J instanceof Function;
        Z = Z || {};
        function K(V) {
            var z = J[V];
            if (!z && q)
                z = J.length == 2 ? function (W) {
                    J(V, W)
                }
                    : J;
            $[V] = z && function (W) {
                z("[xmldom " + V + "]	" + W + Sd(Z))
            }
                || function () { }
        }
        return K("warning"),
            K("error"),
            K("fatalError"),
            $
    }
    function YH() {
        this.cdata = !1
    }
    function X4(J, Q) {
        Q.lineNumber = J.lineNumber,
            Q.columnNumber = J.columnNumber
    }
    YH.prototype = {
        startDocument: function () {
            if (this.doc = new _d().createDocument(null, null, null),
                this.locator)
                this.doc.documentURI = this.locator.systemId
        },
        startElement: function (J, Q, Z, $) {
            var q = this.doc
                , K = q.createElementNS(J, Z || Q)
                , V = $.length;
            xC(this, K),
                this.currentElement = K,
                this.locator && X4(this.locator, K);
            for (var z = 0; z < V; z++) {
                var J = $.getURI(z)
                    , W = $.getValue(z)
                    , Z = $.getQName(z)
                    , H = q.createAttributeNS(J, Z);
                this.locator && X4($.getLocator(z), H),
                    H.value = H.nodeValue = W,
                    K.setAttributeNode(H)
            }
        },
        endElement: function (J, Q, Z) {
            var $ = this.currentElement
                , q = $.tagName;
            this.currentElement = $.parentNode
        },
        startPrefixMapping: function (J, Q) { },
        endPrefixMapping: function (J) { },
        processingInstruction: function (J, Q) {
            var Z = this.doc.createProcessingInstruction(J, Q);
            this.locator && X4(this.locator, Z),
                xC(this, Z)
        },
        ignorableWhitespace: function (J, Q, Z) { },
        characters: function (J, Q, Z) {
            if (J = iR.apply(this, arguments),
                J) {
                if (this.cdata)
                    var $ = this.doc.createCDATASection(J);
                else
                    var $ = this.doc.createTextNode(J);
                if (this.currentElement)
                    this.currentElement.appendChild($);
                else if (/^\s*$/.test(J))
                    this.doc.appendChild($);
                this.locator && X4(this.locator, $)
            }
        },
        skippedEntity: function (J) { },
        endDocument: function () {
            this.doc.normalize()
        },
        setDocumentLocator: function (J) {
            if (this.locator = J)
                J.lineNumber = 0
        },
        comment: function (J, Q, Z) {
            J = iR.apply(this, arguments);
            var $ = this.doc.createComment(J);
            this.locator && X4(this.locator, $),
                xC(this, $)
        },
        startCDATA: function () {
            this.cdata = !0
        },
        endCDATA: function () {
            this.cdata = !1
        },
        startDTD: function (J, Q, Z) {
            var $ = this.doc.implementation;
            if ($ && $.createDocumentType) {
                var q = $.createDocumentType(J, Q, Z);
                this.locator && X4(this.locator, q),
                    xC(this, q),
                    this.doc.doctype = q
            }
        },
        warning: function (J) { },
        error: function (J) { },
        fatalError: function (J) {
            throw new Rd(J, this.locator)
        }
    };
    function Sd(J) {
        if (J)
            return `
@` + (J.systemId || "") + "#[line:" + J.lineNumber + ",col:" + J.columnNumber + "]"
    }
    function iR(J, Q, Z) {
        if (typeof J == "string")
            return J.substr(Q, Z);
        else {
            if (J.length >= Q + Z || Q)
                return new java.lang.String(J, Q, Z) + "";
            return J
        }
    }
    "endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g, function (J) {
        YH.prototype[J] = function () {
            return null
        }
    });
    function xC(J, Q) {
        if (!J.currentElement)
            J.doc.appendChild(Q);
        else
            J.currentElement.appendChild(Q)
    }
    Td.__DOMHandler = YH;
    Td.normalizeLineEndings = rR;
    Td.DOMParser = tR
}
);
var O5, sG, $O, T8, B4, r0, SQ, r8, Q8, x5, GH, U9, I5, fZ, qO, iJ, i7, a6, H5;
var l8 = O(() => {
    O5 = ((J) => (J[J.WEBGL_LEGACY = 0] = "WEBGL_LEGACY",
        J[J.WEBGL = 1] = "WEBGL",
        J[J.WEBGL2 = 2] = "WEBGL2",
        J))(O5 || {}),
        sG = ((J) => (J[J.UNKNOWN = 0] = "UNKNOWN",
            J[J.WEBGL = 1] = "WEBGL",
            J[J.CANVAS = 2] = "CANVAS",
            J))(sG || {}),
        $O = ((J) => (J[J.COLOR = 16384] = "COLOR",
            J[J.DEPTH = 256] = "DEPTH",
            J[J.STENCIL = 1024] = "STENCIL",
            J))($O || {}),
        T8 = ((J) => (J[J.NORMAL = 0] = "NORMAL",
            J[J.ADD = 1] = "ADD",
            J[J.MULTIPLY = 2] = "MULTIPLY",
            J[J.SCREEN = 3] = "SCREEN",
            J[J.OVERLAY = 4] = "OVERLAY",
            J[J.DARKEN = 5] = "DARKEN",
            J[J.LIGHTEN = 6] = "LIGHTEN",
            J[J.COLOR_DODGE = 7] = "COLOR_DODGE",
            J[J.COLOR_BURN = 8] = "COLOR_BURN",
            J[J.HARD_LIGHT = 9] = "HARD_LIGHT",
            J[J.SOFT_LIGHT = 10] = "SOFT_LIGHT",
            J[J.DIFFERENCE = 11] = "DIFFERENCE",
            J[J.EXCLUSION = 12] = "EXCLUSION",
            J[J.HUE = 13] = "HUE",
            J[J.SATURATION = 14] = "SATURATION",
            J[J.COLOR = 15] = "COLOR",
            J[J.LUMINOSITY = 16] = "LUMINOSITY",
            J[J.NORMAL_NPM = 17] = "NORMAL_NPM",
            J[J.ADD_NPM = 18] = "ADD_NPM",
            J[J.SCREEN_NPM = 19] = "SCREEN_NPM",
            J[J.NONE = 20] = "NONE",
            J[J.SRC_OVER = 0] = "SRC_OVER",
            J[J.SRC_IN = 21] = "SRC_IN",
            J[J.SRC_OUT = 22] = "SRC_OUT",
            J[J.SRC_ATOP = 23] = "SRC_ATOP",
            J[J.DST_OVER = 24] = "DST_OVER",
            J[J.DST_IN = 25] = "DST_IN",
            J[J.DST_OUT = 26] = "DST_OUT",
            J[J.DST_ATOP = 27] = "DST_ATOP",
            J[J.ERASE = 26] = "ERASE",
            J[J.SUBTRACT = 28] = "SUBTRACT",
            J[J.XOR = 29] = "XOR",
            J))(T8 || {}),
        B4 = ((J) => (J[J.POINTS = 0] = "POINTS",
            J[J.LINES = 1] = "LINES",
            J[J.LINE_LOOP = 2] = "LINE_LOOP",
            J[J.LINE_STRIP = 3] = "LINE_STRIP",
            J[J.TRIANGLES = 4] = "TRIANGLES",
            J[J.TRIANGLE_STRIP = 5] = "TRIANGLE_STRIP",
            J[J.TRIANGLE_FAN = 6] = "TRIANGLE_FAN",
            J))(B4 || {}),
        r0 = ((J) => (J[J.RGBA = 6408] = "RGBA",
            J[J.RGB = 6407] = "RGB",
            J[J.RG = 33319] = "RG",
            J[J.RED = 6403] = "RED",
            J[J.RGBA_INTEGER = 36249] = "RGBA_INTEGER",
            J[J.RGB_INTEGER = 36248] = "RGB_INTEGER",
            J[J.RG_INTEGER = 33320] = "RG_INTEGER",
            J[J.RED_INTEGER = 36244] = "RED_INTEGER",
            J[J.ALPHA = 6406] = "ALPHA",
            J[J.LUMINANCE = 6409] = "LUMINANCE",
            J[J.LUMINANCE_ALPHA = 6410] = "LUMINANCE_ALPHA",
            J[J.DEPTH_COMPONENT = 6402] = "DEPTH_COMPONENT",
            J[J.DEPTH_STENCIL = 34041] = "DEPTH_STENCIL",
            J))(r0 || {}),
        SQ = ((J) => (J[J.TEXTURE_2D = 3553] = "TEXTURE_2D",
            J[J.TEXTURE_CUBE_MAP = 34067] = "TEXTURE_CUBE_MAP",
            J[J.TEXTURE_2D_ARRAY = 35866] = "TEXTURE_2D_ARRAY",
            J[J.TEXTURE_CUBE_MAP_POSITIVE_X = 34069] = "TEXTURE_CUBE_MAP_POSITIVE_X",
            J[J.TEXTURE_CUBE_MAP_NEGATIVE_X = 34070] = "TEXTURE_CUBE_MAP_NEGATIVE_X",
            J[J.TEXTURE_CUBE_MAP_POSITIVE_Y = 34071] = "TEXTURE_CUBE_MAP_POSITIVE_Y",
            J[J.TEXTURE_CUBE_MAP_NEGATIVE_Y = 34072] = "TEXTURE_CUBE_MAP_NEGATIVE_Y",
            J[J.TEXTURE_CUBE_MAP_POSITIVE_Z = 34073] = "TEXTURE_CUBE_MAP_POSITIVE_Z",
            J[J.TEXTURE_CUBE_MAP_NEGATIVE_Z = 34074] = "TEXTURE_CUBE_MAP_NEGATIVE_Z",
            J))(SQ || {}),
        r8 = ((J) => (J[J.UNSIGNED_BYTE = 5121] = "UNSIGNED_BYTE",
            J[J.UNSIGNED_SHORT = 5123] = "UNSIGNED_SHORT",
            J[J.UNSIGNED_SHORT_5_6_5 = 33635] = "UNSIGNED_SHORT_5_6_5",
            J[J.UNSIGNED_SHORT_4_4_4_4 = 32819] = "UNSIGNED_SHORT_4_4_4_4",
            J[J.UNSIGNED_SHORT_5_5_5_1 = 32820] = "UNSIGNED_SHORT_5_5_5_1",
            J[J.UNSIGNED_INT = 5125] = "UNSIGNED_INT",
            J[J.UNSIGNED_INT_10F_11F_11F_REV = 35899] = "UNSIGNED_INT_10F_11F_11F_REV",
            J[J.UNSIGNED_INT_2_10_10_10_REV = 33640] = "UNSIGNED_INT_2_10_10_10_REV",
            J[J.UNSIGNED_INT_24_8 = 34042] = "UNSIGNED_INT_24_8",
            J[J.UNSIGNED_INT_5_9_9_9_REV = 35902] = "UNSIGNED_INT_5_9_9_9_REV",
            J[J.BYTE = 5120] = "BYTE",
            J[J.SHORT = 5122] = "SHORT",
            J[J.INT = 5124] = "INT",
            J[J.FLOAT = 5126] = "FLOAT",
            J[J.FLOAT_32_UNSIGNED_INT_24_8_REV = 36269] = "FLOAT_32_UNSIGNED_INT_24_8_REV",
            J[J.HALF_FLOAT = 36193] = "HALF_FLOAT",
            J))(r8 || {}),
        Q8 = ((J) => (J[J.FLOAT = 0] = "FLOAT",
            J[J.INT = 1] = "INT",
            J[J.UINT = 2] = "UINT",
            J))(Q8 || {}),
        x5 = ((J) => (J[J.NEAREST = 0] = "NEAREST",
            J[J.LINEAR = 1] = "LINEAR",
            J))(x5 || {}),
        GH = ((J) => (J[J.CLAMP = 33071] = "CLAMP",
            J[J.REPEAT = 10497] = "REPEAT",
            J[J.MIRRORED_REPEAT = 33648] = "MIRRORED_REPEAT",
            J))(GH || {}),
        U9 = ((J) => (J[J.OFF = 0] = "OFF",
            J[J.POW2 = 1] = "POW2",
            J[J.ON = 2] = "ON",
            J[J.ON_MANUAL = 3] = "ON_MANUAL",
            J))(U9 || {}),
        I5 = ((J) => (J[J.NPM = 0] = "NPM",
            J[J.UNPACK = 1] = "UNPACK",
            J[J.PMA = 2] = "PMA",
            J[J.NO_PREMULTIPLIED_ALPHA = 0] = "NO_PREMULTIPLIED_ALPHA",
            J[J.PREMULTIPLY_ON_UPLOAD = 1] = "PREMULTIPLY_ON_UPLOAD",
            J[J.PREMULTIPLIED_ALPHA = 2] = "PREMULTIPLIED_ALPHA",
            J))(I5 || {}),
        fZ = ((J) => (J[J.NO = 0] = "NO",
            J[J.YES = 1] = "YES",
            J[J.AUTO = 2] = "AUTO",
            J[J.BLEND = 0] = "BLEND",
            J[J.CLEAR = 1] = "CLEAR",
            J[J.BLIT = 2] = "BLIT",
            J))(fZ || {}),
        qO = ((J) => (J[J.AUTO = 0] = "AUTO",
            J[J.MANUAL = 1] = "MANUAL",
            J))(qO || {}),
        iJ = ((J) => (J.LOW = "lowp",
            J.MEDIUM = "mediump",
            J.HIGH = "highp",
            J))(iJ || {}),
        i7 = ((J) => (J[J.NONE = 0] = "NONE",
            J[J.SCISSOR = 1] = "SCISSOR",
            J[J.STENCIL = 2] = "STENCIL",
            J[J.SPRITE = 3] = "SPRITE",
            J[J.COLOR = 4] = "COLOR",
            J))(i7 || {}),
        a6 = ((J) => (J[J.NONE = 0] = "NONE",
            J[J.LOW = 2] = "LOW",
            J[J.MEDIUM = 4] = "MEDIUM",
            J[J.HIGH = 8] = "HIGH",
            J))(a6 || {}),
        H5 = ((J) => (J[J.ELEMENT_ARRAY_BUFFER = 34963] = "ELEMENT_ARRAY_BUFFER",
            J[J.ARRAY_BUFFER = 34962] = "ARRAY_BUFFER",
            J[J.UNIFORM_BUFFER = 35345] = "UNIFORM_BUFFER",
            J))(H5 || {})
}
);
var iG;
var aG = O(() => {
    iG = {
        createCanvas: (J, Q) => {
            let Z = document.createElement("canvas");
            return Z.width = J,
                Z.height = Q,
                Z
        }
        ,
        getCanvasRenderingContext2D: () => CanvasRenderingContext2D,
        getWebGLRenderingContext: () => WebGLRenderingContext,
        getNavigator: () => navigator,
        getBaseUrl: () => document.baseURI ?? global.location.href,
        getFontFaceSet: () => document.fonts,
        fetch: (J, Q) => fetch(J, Q).catch((e) => console.log(e)),
        parseXML: (J) => new DOMParser().parseFromString(J, "text/xml")
    }
}
);
var L8;
var xb = O(() => {
    aG();
    L8 = {
        ADAPTER: iG,
        RESOLUTION: 1,
        CREATE_IMAGE_BITMAP: !1,
        ROUND_PIXELS: !1
    }
}
);
var Wu, N9;
var gb = O(() => {
    kF();
    Wu = ZZ.default ?? ZZ,
        N9 = Wu(globalThis.navigator)
}
);
var $7 = O(() => {
    aG();
    xb();
    gb()
}
);
var KO = O(() => {
    $7();
    $7();
    L8.RETINA_PREFIX = /@([0-9\.]+)x/;
    L8.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT = !1
}
);
var cb = G5((ld0, rG) => {
    var Hu = Object.prototype.hasOwnProperty
        , aJ = "~";
    function PH() { }
    if (Object.create) {
        if (PH.prototype = Object.create(null),
            !new PH().__proto__)
            aJ = !1
    }
    function Yu(J, Q, Z) {
        this.fn = J,
            this.context = Q,
            this.once = Z || !1
    }
    function mb(J, Q, Z, $, q) {
        if (typeof Z !== "function")
            throw new TypeError("The listener must be a function");
        var K = new Yu(Z, $ || J, q)
            , V = aJ ? aJ + Q : Q;
        if (!J._events[V])
            J._events[V] = K,
                J._eventsCount++;
        else if (!J._events[V].fn)
            J._events[V].push(K);
        else
            J._events[V] = [J._events[V], K];
        return J
    }
    function VO(J, Q) {
        if (--J._eventsCount === 0)
            J._events = new PH;
        else
            delete J._events[Q]
    }
    function SJ() {
        this._events = new PH,
            this._eventsCount = 0
    }
    SJ.prototype.eventNames = function J() {
        var Q = [], Z, $;
        if (this._eventsCount === 0)
            return Q;
        for ($ in Z = this._events)
            if (Hu.call(Z, $))
                Q.push(aJ ? $.slice(1) : $);
        if (Object.getOwnPropertySymbols)
            return Q.concat(Object.getOwnPropertySymbols(Z));
        return Q
    }
        ;
    SJ.prototype.listeners = function J(Q) {
        var Z = aJ ? aJ + Q : Q
            , $ = this._events[Z];
        if (!$)
            return [];
        if ($.fn)
            return [$.fn];
        for (var q = 0, K = $.length, V = new Array(K); q < K; q++)
            V[q] = $[q].fn;
        return V
    }
        ;
    SJ.prototype.listenerCount = function J(Q) {
        var Z = aJ ? aJ + Q : Q
            , $ = this._events[Z];
        if (!$)
            return 0;
        if ($.fn)
            return 1;
        return $.length
    }
        ;
    SJ.prototype.emit = function J(Q, Z, $, q, K, V) {
        var z = aJ ? aJ + Q : Q;
        if (!this._events[z])
            return !1;
        var W = this._events[z], H = arguments.length, Y, U;
        if (W.fn) {
            if (W.once)
                this.removeListener(Q, W.fn, void 0, !0);
            switch (H) {
                case 1:
                    return W.fn.call(W.context),
                        !0;
                case 2:
                    return W.fn.call(W.context, Z),
                        !0;
                case 3:
                    return W.fn.call(W.context, Z, $),
                        !0;
                case 4:
                    return W.fn.call(W.context, Z, $, q),
                        !0;
                case 5:
                    return W.fn.call(W.context, Z, $, q, K),
                        !0;
                case 6:
                    return W.fn.call(W.context, Z, $, q, K, V),
                        !0
            }
            for (U = 1,
                Y = new Array(H - 1); U < H; U++)
                Y[U - 1] = arguments[U];
            W.fn.apply(W.context, Y)
        } else {
            var N = W.length, j;
            for (U = 0; U < N; U++) {
                if (W[U].once)
                    this.removeListener(Q, W[U].fn, void 0, !0);
                switch (H) {
                    case 1:
                        W[U].fn.call(W[U].context);
                        break;
                    case 2:
                        W[U].fn.call(W[U].context, Z);
                        break;
                    case 3:
                        W[U].fn.call(W[U].context, Z, $);
                        break;
                    case 4:
                        W[U].fn.call(W[U].context, Z, $, q);
                        break;
                    default:
                        if (!Y)
                            for (j = 1,
                                Y = new Array(H - 1); j < H; j++)
                                Y[j - 1] = arguments[j];
                        W[U].fn.apply(W[U].context, Y)
                }
            }
        }
        return !0
    }
        ;
    SJ.prototype.on = function J(Q, Z, $) {
        return mb(this, Q, Z, $, !1)
    }
        ;
    SJ.prototype.once = function J(Q, Z, $) {
        return mb(this, Q, Z, $, !0)
    }
        ;
    SJ.prototype.removeListener = function J(Q, Z, $, q) {
        var K = aJ ? aJ + Q : Q;
        if (!this._events[K])
            return this;
        if (!Z)
            return VO(this, K),
                this;
        var V = this._events[K];
        if (V.fn) {
            if (V.fn === Z && (!q || V.once) && (!$ || V.context === $))
                VO(this, K)
        } else {
            for (var z = 0, W = [], H = V.length; z < H; z++)
                if (V[z].fn !== Z || q && !V[z].once || $ && V[z].context !== $)
                    W.push(V[z]);
            if (W.length)
                this._events[K] = W.length === 1 ? W[0] : W;
            else
                VO(this, K)
        }
        return this
    }
        ;
    SJ.prototype.removeAllListeners = function J(Q) {
        var Z;
        if (Q) {
            if (Z = aJ ? aJ + Q : Q,
                this._events[Z])
                VO(this, Z)
        } else
            this._events = new PH,
                this._eventsCount = 0;
        return this
    }
        ;
    SJ.prototype.off = SJ.prototype.removeListener;
    SJ.prototype.addListener = SJ.prototype.on;
    SJ.prefixed = aJ;
    SJ.EventEmitter = SJ;
    if (typeof rG !== "undefined")
        rG.exports = SJ
}
);
var ob = G5((od0, QP) => {
    QP.exports = HO;
    QP.exports.default = HO;
    function HO(J, Q, Z) {
        Z = Z || 2;
        var $ = Q && Q.length
            , q = $ ? Q[0] * Z : J.length
            , K = pb(J, 0, q, Z, !0)
            , V = [];
        if (!K || K.next === K.prev)
            return V;
        var z, W, H, Y, U, N, j;
        if ($)
            K = ju(J, Q, K, Z);
        if (J.length > 80 * Z) {
            z = H = J[0],
                W = Y = J[1];
            for (var k = Z; k < q; k += Z) {
                if (U = J[k],
                    N = J[k + 1],
                    U < z)
                    z = U;
                if (N < W)
                    W = N;
                if (U > H)
                    H = U;
                if (N > Y)
                    Y = N
            }
            j = Math.max(H - z, Y - W),
                j = j !== 0 ? 32767 / j : 0
        }
        return DH(K, V, Z, z, W, j, 0),
            V
    }
    function pb(J, Q, Z, $, q) {
        var K, V;
        if (q === JP(J, Q, Z, $) > 0)
            for (K = Q; K < Z; K += $)
                V = db(K, J[K], J[K + 1], V);
        else
            for (K = Z - $; K >= Q; K -= $)
                V = db(K, J[K], J[K + 1], V);
        if (V && YO(V, V.next))
            EH(V),
                V = V.next;
        return V
    }
    function t$(J, Q) {
        if (!J)
            return J;
        if (!Q)
            Q = J;
        var Z = J, $;
        do
            if ($ = !1,
                !Z.steiner && (YO(Z, Z.next) || A7(Z.prev, Z, Z.next) === 0)) {
                if (EH(Z),
                    Z = Q = Z.prev,
                    Z === Z.next)
                    break;
                $ = !0
            } else
                Z = Z.next;
        while ($ || Z !== Q);
        return Q
    }
    function DH(J, Q, Z, $, q, K, V) {
        if (!J)
            return;
        if (!V && K)
            Iu(J, $, q, K);
        var z = J, W, H;
        while (J.prev !== J.next) {
            if (W = J.prev,
                H = J.next,
                K ? Uu(J, $, q, K) : Xu(J)) {
                Q.push(W.i / Z | 0),
                    Q.push(J.i / Z | 0),
                    Q.push(H.i / Z | 0),
                    EH(J),
                    J = H.next,
                    z = H.next;
                continue
            }
            if (J = H,
                J === z) {
                if (!V)
                    DH(t$(J), Q, Z, $, q, K, 1);
                else if (V === 1)
                    J = Nu(t$(J), Q, Z),
                        DH(J, Q, Z, $, q, K, 2);
                else if (V === 2)
                    wu(J, Q, Z, $, q, K);
                break
            }
        }
    }
    function Xu(J) {
        var Q = J.prev
            , Z = J
            , $ = J.next;
        if (A7(Q, Z, $) >= 0)
            return !1;
        var q = Q.x
            , K = Z.x
            , V = $.x
            , z = Q.y
            , W = Z.y
            , H = $.y
            , Y = q < K ? q < V ? q : V : K < V ? K : V
            , U = z < W ? z < H ? z : H : W < H ? W : H
            , N = q > K ? q > V ? q : V : K > V ? K : V
            , j = z > W ? z > H ? z : H : W > H ? W : H
            , k = $.next;
        while (k !== Q) {
            if (k.x >= Y && k.x <= N && k.y >= U && k.y <= j && k4(q, z, K, W, V, H, k.x, k.y) && A7(k.prev, k, k.next) >= 0)
                return !1;
            k = k.next
        }
        return !0
    }
    function Uu(J, Q, Z, $) {
        var q = J.prev
            , K = J
            , V = J.next;
        if (A7(q, K, V) >= 0)
            return !1;
        var z = q.x
            , W = K.x
            , H = V.x
            , Y = q.y
            , U = K.y
            , N = V.y
            , j = z < W ? z < H ? z : H : W < H ? W : H
            , k = Y < U ? Y < N ? Y : N : U < N ? U : N
            , L = z > W ? z > H ? z : H : W > H ? W : H
            , F = Y > U ? Y > N ? Y : N : U > N ? U : N
            , P = tG(j, k, Q, Z, $)
            , M = tG(L, F, Q, Z, $)
            , v = J.prevZ
            , E = J.nextZ;
        while (v && v.z >= P && E && E.z <= M) {
            if (v.x >= j && v.x <= L && v.y >= k && v.y <= F && v !== q && v !== V && k4(z, Y, W, U, H, N, v.x, v.y) && A7(v.prev, v, v.next) >= 0)
                return !1;
            if (v = v.prevZ,
                E.x >= j && E.x <= L && E.y >= k && E.y <= F && E !== q && E !== V && k4(z, Y, W, U, H, N, E.x, E.y) && A7(E.prev, E, E.next) >= 0)
                return !1;
            E = E.nextZ
        }
        while (v && v.z >= P) {
            if (v.x >= j && v.x <= L && v.y >= k && v.y <= F && v !== q && v !== V && k4(z, Y, W, U, H, N, v.x, v.y) && A7(v.prev, v, v.next) >= 0)
                return !1;
            v = v.prevZ
        }
        while (E && E.z <= M) {
            if (E.x >= j && E.x <= L && E.y >= k && E.y <= F && E !== q && E !== V && k4(z, Y, W, U, H, N, E.x, E.y) && A7(E.prev, E, E.next) >= 0)
                return !1;
            E = E.nextZ
        }
        return !0
    }
    function Nu(J, Q, Z) {
        var $ = J;
        do {
            var q = $.prev
                , K = $.next.next;
            if (!YO(q, K) && ub(q, $, $.next, K) && AH(q, K) && AH(K, q))
                Q.push(q.i / Z | 0),
                    Q.push($.i / Z | 0),
                    Q.push(K.i / Z | 0),
                    EH($),
                    EH($.next),
                    $ = J = K;
            $ = $.next
        } while ($ !== J);
        return t$($)
    }
    function wu(J, Q, Z, $, q, K) {
        var V = J;
        do {
            var z = V.next.next;
            while (z !== V.prev) {
                if (V.i !== z.i && Gu(V, z)) {
                    var W = lb(V, z);
                    V = t$(V, V.next),
                        W = t$(W, W.next),
                        DH(V, Q, Z, $, q, K, 0),
                        DH(W, Q, Z, $, q, K, 0);
                    return
                }
                z = z.next
            }
            V = V.next
        } while (V !== J)
    }
    function ju(J, Q, Z, $) {
        var q = [], K, V, z, W, H;
        for (K = 0,
            V = Q.length; K < V; K++) {
            if (z = Q[K] * $,
                W = K < V - 1 ? Q[K + 1] * $ : J.length,
                H = pb(J, z, W, $, !1),
                H === H.next)
                H.steiner = !0;
            q.push(Fu(H))
        }
        q.sort(Bu);
        for (K = 0; K < q.length; K++)
            Z = ku(q[K], Z);
        return Z
    }
    function Bu(J, Q) {
        return J.x - Q.x
    }
    function ku(J, Q) {
        var Z = Cu(J, Q);
        if (!Z)
            return Q;
        var $ = lb(Z, J);
        return t$($, $.next),
            t$(Z, Z.next)
    }
    function Cu(J, Q) {
        var Z = Q, $ = J.x, q = J.y, K = -1 / 0, V;
        do {
            if (q <= Z.y && q >= Z.next.y && Z.next.y !== Z.y) {
                var z = Z.x + (q - Z.y) * (Z.next.x - Z.x) / (Z.next.y - Z.y);
                if (z <= $ && z > K) {
                    if (K = z,
                        V = Z.x < Z.next.x ? Z : Z.next,
                        z === $)
                        return V
                }
            }
            Z = Z.next
        } while (Z !== Q);
        if (!V)
            return null;
        var W = V, H = V.x, Y = V.y, U = 1 / 0, N;
        Z = V;
        do {
            if ($ >= Z.x && Z.x >= H && $ !== Z.x && k4(q < Y ? $ : K, q, H, Y, q < Y ? K : $, q, Z.x, Z.y)) {
                if (N = Math.abs(q - Z.y) / ($ - Z.x),
                    AH(Z, J) && (N < U || N === U && (Z.x > V.x || Z.x === V.x && Ou(V, Z))))
                    V = Z,
                        U = N
            }
            Z = Z.next
        } while (Z !== W);
        return V
    }
    function Ou(J, Q) {
        return A7(J.prev, J, Q.prev) < 0 && A7(Q.next, J, J.next) < 0
    }
    function Iu(J, Q, Z, $) {
        var q = J;
        do {
            if (q.z === 0)
                q.z = tG(q.x, q.y, Q, Z, $);
            q.prevZ = q.prev,
                q.nextZ = q.next,
                q = q.next
        } while (q !== J);
        q.prevZ.nextZ = null,
            q.prevZ = null,
            Lu(q)
    }
    function Lu(J) {
        var Q, Z, $, q, K, V, z, W, H = 1;
        do {
            Z = J,
                J = null,
                K = null,
                V = 0;
            while (Z) {
                V++,
                    $ = Z,
                    z = 0;
                for (Q = 0; Q < H; Q++)
                    if (z++,
                        $ = $.nextZ,
                        !$)
                        break;
                W = H;
                while (z > 0 || W > 0 && $) {
                    if (z !== 0 && (W === 0 || !$ || Z.z <= $.z))
                        q = Z,
                            Z = Z.nextZ,
                            z--;
                    else
                        q = $,
                            $ = $.nextZ,
                            W--;
                    if (K)
                        K.nextZ = q;
                    else
                        J = q;
                    q.prevZ = K,
                        K = q
                }
                Z = $
            }
            K.nextZ = null,
                H *= 2
        } while (V > 1);
        return J
    }
    function tG(J, Q, Z, $, q) {
        return J = (J - Z) * q | 0,
            Q = (Q - $) * q | 0,
            J = (J | J << 8) & 16711935,
            J = (J | J << 4) & 252645135,
            J = (J | J << 2) & 858993459,
            J = (J | J << 1) & 1431655765,
            Q = (Q | Q << 8) & 16711935,
            Q = (Q | Q << 4) & 252645135,
            Q = (Q | Q << 2) & 858993459,
            Q = (Q | Q << 1) & 1431655765,
            J | Q << 1
    }
    function Fu(J) {
        var Q = J
            , Z = J;
        do {
            if (Q.x < Z.x || Q.x === Z.x && Q.y < Z.y)
                Z = Q;
            Q = Q.next
        } while (Q !== J);
        return Z
    }
    function k4(J, Q, Z, $, q, K, V, z) {
        return (q - V) * (Q - z) >= (J - V) * (K - z) && (J - V) * ($ - z) >= (Z - V) * (Q - z) && (Z - V) * (K - z) >= (q - V) * ($ - z)
    }
    function Gu(J, Q) {
        return J.next.i !== Q.i && J.prev.i !== Q.i && !Pu(J, Q) && (AH(J, Q) && AH(Q, J) && Du(J, Q) && (A7(J.prev, J, Q.prev) || A7(J, Q.prev, Q)) || YO(J, Q) && A7(J.prev, J, J.next) > 0 && A7(Q.prev, Q, Q.next) > 0)
    }
    function A7(J, Q, Z) {
        return (Q.y - J.y) * (Z.x - Q.x) - (Q.x - J.x) * (Z.y - Q.y)
    }
    function YO(J, Q) {
        return J.x === Q.x && J.y === Q.y
    }
    function ub(J, Q, Z, $) {
        var q = WO(A7(J, Q, Z))
            , K = WO(A7(J, Q, $))
            , V = WO(A7(Z, $, J))
            , z = WO(A7(Z, $, Q));
        if (q !== K && V !== z)
            return !0;
        if (q === 0 && zO(J, Z, Q))
            return !0;
        if (K === 0 && zO(J, $, Q))
            return !0;
        if (V === 0 && zO(Z, J, $))
            return !0;
        if (z === 0 && zO(Z, Q, $))
            return !0;
        return !1
    }
    function zO(J, Q, Z) {
        return Q.x <= Math.max(J.x, Z.x) && Q.x >= Math.min(J.x, Z.x) && Q.y <= Math.max(J.y, Z.y) && Q.y >= Math.min(J.y, Z.y)
    }
    function WO(J) {
        return J > 0 ? 1 : J < 0 ? -1 : 0
    }
    function Pu(J, Q) {
        var Z = J;
        do {
            if (Z.i !== J.i && Z.next.i !== J.i && Z.i !== Q.i && Z.next.i !== Q.i && ub(Z, Z.next, J, Q))
                return !0;
            Z = Z.next
        } while (Z !== J);
        return !1
    }
    function AH(J, Q) {
        return A7(J.prev, J, J.next) < 0 ? A7(J, Q, J.next) >= 0 && A7(J, J.prev, Q) >= 0 : A7(J, Q, J.prev) < 0 || A7(J, J.next, Q) < 0
    }
    function Du(J, Q) {
        var Z = J
            , $ = !1
            , q = (J.x + Q.x) / 2
            , K = (J.y + Q.y) / 2;
        do {
            if (Z.y > K !== Z.next.y > K && Z.next.y !== Z.y && q < (Z.next.x - Z.x) * (K - Z.y) / (Z.next.y - Z.y) + Z.x)
                $ = !$;
            Z = Z.next
        } while (Z !== J);
        return $
    }
    function lb(J, Q) {
        var Z = new eG(J.i, J.x, J.y)
            , $ = new eG(Q.i, Q.x, Q.y)
            , q = J.next
            , K = Q.prev;
        return J.next = Q,
            Q.prev = J,
            Z.next = q,
            q.prev = Z,
            $.next = Z,
            Z.prev = $,
            K.next = $,
            $.prev = K,
            $
    }
    function db(J, Q, Z, $) {
        var q = new eG(J, Q, Z);
        if (!$)
            q.prev = q,
                q.next = q;
        else
            q.next = $.next,
                q.prev = $,
                $.next.prev = q,
                $.next = q;
        return q
    }
    function EH(J) {
        if (J.next.prev = J.prev,
            J.prev.next = J.next,
            J.prevZ)
            J.prevZ.nextZ = J.nextZ;
        if (J.nextZ)
            J.nextZ.prevZ = J.prevZ
    }
    function eG(J, Q, Z) {
        this.i = J,
            this.x = Q,
            this.y = Z,
            this.prev = null,
            this.next = null,
            this.z = 0,
            this.prevZ = null,
            this.nextZ = null,
            this.steiner = !1
    }
    HO.deviation = function (J, Q, Z, $) {
        var q = Q && Q.length
            , K = q ? Q[0] * Z : J.length
            , V = Math.abs(JP(J, 0, K, Z));
        if (q)
            for (var z = 0, W = Q.length; z < W; z++) {
                var H = Q[z] * Z
                    , Y = z < W - 1 ? Q[z + 1] * Z : J.length;
                V -= Math.abs(JP(J, H, Y, Z))
            }
        var U = 0;
        for (z = 0; z < $.length; z += 3) {
            var N = $[z] * Z
                , j = $[z + 1] * Z
                , k = $[z + 2] * Z;
            U += Math.abs((J[N] - J[k]) * (J[j + 1] - J[N + 1]) - (J[N] - J[j]) * (J[k + 1] - J[N + 1]))
        }
        return V === 0 && U === 0 ? 0 : Math.abs((U - V) / V)
    }
        ;
    function JP(J, Q, Z, $) {
        var q = 0;
        for (var K = Q, V = Z - $; K < Z; K += $)
            q += (J[V] - J[K]) * (J[K + 1] + J[V + 1]),
                V = K;
        return q
    }
    HO.flatten = function (J) {
        var Q = J[0][0].length
            , Z = {
                vertices: [],
                holes: [],
                dimensions: Q
            }
            , $ = 0;
        for (var q = 0; q < J.length; q++) {
            for (var K = 0; K < J[q].length; K++)
                for (var V = 0; V < Q; V++)
                    Z.vertices.push(J[q][K][V]);
            if (q > 0)
                $ += J[q - 1].length,
                    Z.holes.push($)
        }
        return Z
    }
}
);
function ab(J) {
    return typeof J === "string"
}
function rb(J) {
    return typeof J === "object" && J !== null
}
function XO(J) {
    return J === null
}
function Eu(J) {
    return J == null
}
function TQ() {
    this.protocol = null,
        this.slashes = null,
        this.auth = null,
        this.host = null,
        this.port = null,
        this.hostname = null,
        this.hash = null,
        this.search = null,
        this.query = null,
        this.pathname = null,
        this.path = null,
        this.href = null
}
function tb(J, Q, Z) {
    if (J && rb(J) && J instanceof TQ)
        return J;
    var $ = new TQ;
    return $.parse(J, Q, Z),
        $
}
var Au, nd0, Mu, _u, Ru, bu, vu, ZP, nb, sb, Su = 255, ib, Tu, yu, $P, C4, qP;
var eb = O(() => {
    ({ URL: Au, URLSearchParams: nd0 } = globalThis);
    Mu = /^([a-z0-9.+-]+:)/i,
        _u = /:[0-9]*$/,
        Ru = /^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,
        bu = ["<", ">", '"', "`", " ", "\r", `
`, "\t"],
        vu = ["{", "}", "|", "\\", "^", "`"].concat(bu),
        ZP = ["'"].concat(vu),
        nb = ["%", "/", "?", ";", "#"].concat(ZP),
        sb = ["/", "?", "#"],
        ib = /^[+a-z0-9A-Z_-]{0,63}$/,
        Tu = /^([+a-z0-9A-Z_-]{0,63})(.*)$/,
        yu = {
            javascript: !0,
            "javascript:": !0
        },
        $P = {
            javascript: !0,
            "javascript:": !0
        },
        C4 = {
            http: !0,
            https: !0,
            ftp: !0,
            gopher: !0,
            file: !0,
            "http:": !0,
            "https:": !0,
            "ftp:": !0,
            "gopher:": !0,
            "file:": !0
        },
        qP = {
            parse(J) {
                var Q = decodeURIComponent;
                return (J + "").replace(/\+/g, " ").split("&").filter(Boolean).reduce(function (Z, $, q) {
                    var K = $.split("=")
                        , V = Q(K[0] || "")
                        , z = Q(K[1] || "")
                        , W = Z[V];
                    return Z[V] = W === void 0 ? z : [].concat(W, z),
                        Z
                }, {})
            },
            stringify(J) {
                var Q = encodeURIComponent;
                return Object.keys(J || {}).reduce(function (Z, $) {
                    return [].concat(J[$]).forEach(function (q) {
                        Z.push(Q($) + "=" + Q(q))
                    }),
                        Z
                }, []).join("&").replace(/\s/g, "+")
            }
        };
    TQ.prototype.parse = function (J, Q, Z) {
        if (!ab(J))
            throw new TypeError("Parameter 'url' must be a string, not " + typeof J);
        var $ = J.indexOf("?")
            , q = $ !== -1 && $ < J.indexOf("#") ? "?" : "#"
            , K = J.split(q)
            , V = /\\/g;
        K[0] = K[0].replace(V, "/"),
            J = K.join(q);
        var z = J;
        if (z = z.trim(),
            !Z && J.split("#").length === 1) {
            var W = Ru.exec(z);
            if (W) {
                if (this.path = z,
                    this.href = z,
                    this.pathname = W[1],
                    W[2])
                    if (this.search = W[2],
                        Q)
                        this.query = qP.parse(this.search.substr(1));
                    else
                        this.query = this.search.substr(1);
                else if (Q)
                    this.search = "",
                        this.query = {};
                return this
            }
        }
        var H = Mu.exec(z);
        if (H) {
            H = H[0];
            var Y = H.toLowerCase();
            this.protocol = Y,
                z = z.substr(H.length)
        }
        if (Z || H || z.match(/^\/\/[^@\/]+@[^@\/]+/)) {
            var U = z.substr(0, 2) === "//";
            if (U && !(H && $P[H]))
                z = z.substr(2),
                    this.slashes = !0
        }
        if (!$P[H] && (U || H && !C4[H])) {
            var N = -1;
            for (var j = 0; j < sb.length; j++) {
                var k = z.indexOf(sb[j]);
                if (k !== -1 && (N === -1 || k < N))
                    N = k
            }
            var L, F;
            if (N === -1)
                F = z.lastIndexOf("@");
            else
                F = z.lastIndexOf("@", N);
            if (F !== -1)
                L = z.slice(0, F),
                    z = z.slice(F + 1),
                    this.auth = decodeURIComponent(L);
            N = -1;
            for (var j = 0; j < nb.length; j++) {
                var k = z.indexOf(nb[j]);
                if (k !== -1 && (N === -1 || k < N))
                    N = k
            }
            if (N === -1)
                N = z.length;
            this.host = z.slice(0, N),
                z = z.slice(N),
                this.parseHost(),
                this.hostname = this.hostname || "";
            var P = this.hostname[0] === "[" && this.hostname[this.hostname.length - 1] === "]";
            if (!P) {
                var M = this.hostname.split(/\./);
                for (var j = 0, v = M.length; j < v; j++) {
                    var E = M[j];
                    if (!E)
                        continue;
                    if (!E.match(ib)) {
                        var n = "";
                        for (var u = 0, b = E.length; u < b; u++)
                            if (E.charCodeAt(u) > 127)
                                n += "x";
                            else
                                n += E[u];
                        if (!n.match(ib)) {
                            var i = M.slice(0, j)
                                , g = M.slice(j + 1)
                                , l = E.match(Tu);
                            if (l)
                                i.push(l[1]),
                                    g.unshift(l[2]);
                            if (g.length)
                                z = "/" + g.join(".") + z;
                            this.hostname = i.join(".");
                            break
                        }
                    }
                }
            }
            if (this.hostname.length > Su)
                this.hostname = "";
            else
                this.hostname = this.hostname.toLowerCase();
            if (!P)
                this.hostname = new Au(`https://${this.hostname}`).hostname;
            var o = this.port ? ":" + this.port : ""
                , F0 = this.hostname || "";
            if (this.host = F0 + o,
                this.href += this.host,
                P) {
                if (this.hostname = this.hostname.substr(1, this.hostname.length - 2),
                    z[0] !== "/")
                    z = "/" + z
            }
        }
        if (!yu[Y])
            for (var j = 0, v = ZP.length; j < v; j++) {
                var b0 = ZP[j];
                if (z.indexOf(b0) === -1)
                    continue;
                var d0 = encodeURIComponent(b0);
                if (d0 === b0)
                    d0 = escape(b0);
                z = z.split(b0).join(d0)
            }
        var H8 = z.indexOf("#");
        if (H8 !== -1)
            this.hash = z.substr(H8),
                z = z.slice(0, H8);
        var E0 = z.indexOf("?");
        if (E0 !== -1) {
            if (this.search = z.substr(E0),
                this.query = z.substr(E0 + 1),
                Q)
                this.query = qP.parse(this.query);
            z = z.slice(0, E0)
        } else if (Q)
            this.search = "",
                this.query = {};
        if (z)
            this.pathname = z;
        if (C4[Y] && this.hostname && !this.pathname)
            this.pathname = "/";
        if (this.pathname || this.search) {
            var o = this.pathname || ""
                , v0 = this.search || "";
            this.path = o + v0
        }
        return this.href = this.format(),
            this
    }
        ;
    TQ.prototype.format = function () {
        var J = this.auth || "";
        if (J)
            J = encodeURIComponent(J),
                J = J.replace(/%3A/i, ":"),
                J += "@";
        var Q = this.protocol || ""
            , Z = this.pathname || ""
            , $ = this.hash || ""
            , q = !1
            , K = "";
        if (this.host)
            q = J + this.host;
        else if (this.hostname) {
            if (q = J + (this.hostname.indexOf(":") === -1 ? this.hostname : "[" + this.hostname + "]"),
                this.port)
                q += ":" + this.port
        }
        if (this.query && rb(this.query) && Object.keys(this.query).length)
            K = qP.stringify(this.query);
        var V = this.search || K && "?" + K || "";
        if (Q && Q.substr(-1) !== ":")
            Q += ":";
        if (this.slashes || (!Q || C4[Q]) && q !== !1) {
            if (q = "//" + (q || ""),
                Z && Z.charAt(0) !== "/")
                Z = "/" + Z
        } else if (!q)
            q = "";
        if ($ && $.charAt(0) !== "#")
            $ = "#" + $;
        if (V && V.charAt(0) !== "?")
            V = "?" + V;
        return Z = Z.replace(/[?#]/g, function (z) {
            return encodeURIComponent(z)
        }),
            V = V.replace("#", "%23"),
            Q + q + Z + V + $
    }
        ;
    TQ.prototype.resolve = function (J) {
        return this.resolveObject(tb(J, !1, !0)).format()
    }
        ;
    TQ.prototype.resolveObject = function (J) {
        if (ab(J)) {
            var Q = new TQ;
            Q.parse(J, !1, !0),
                J = Q
        }
        var Z = new TQ
            , $ = Object.keys(this);
        for (var q = 0; q < $.length; q++) {
            var K = $[q];
            Z[K] = this[K]
        }
        if (Z.hash = J.hash,
            J.href === "")
            return Z.href = Z.format(),
                Z;
        if (J.slashes && !J.protocol) {
            var V = Object.keys(J);
            for (var z = 0; z < V.length; z++) {
                var W = V[z];
                if (W !== "protocol")
                    Z[W] = J[W]
            }
            if (C4[Z.protocol] && Z.hostname && !Z.pathname)
                Z.path = Z.pathname = "/";
            return Z.href = Z.format(),
                Z
        }
        if (J.protocol && J.protocol !== Z.protocol) {
            if (!C4[J.protocol]) {
                var H = Object.keys(J);
                for (var Y = 0; Y < H.length; Y++) {
                    var U = H[Y];
                    Z[U] = J[U]
                }
                return Z.href = Z.format(),
                    Z
            }
            if (Z.protocol = J.protocol,
                !J.host && !$P[J.protocol]) {
                var v = (J.pathname || "").split("/");
                while (v.length && !(J.host = v.shift()))
                    ;
                if (!J.host)
                    J.host = "";
                if (!J.hostname)
                    J.hostname = "";
                if (v[0] !== "")
                    v.unshift("");
                if (v.length < 2)
                    v.unshift("");
                Z.pathname = v.join("/")
            } else
                Z.pathname = J.pathname;
            if (Z.search = J.search,
                Z.query = J.query,
                Z.host = J.host || "",
                Z.auth = J.auth,
                Z.hostname = J.hostname || J.host,
                Z.port = J.port,
                Z.pathname || Z.search) {
                var N = Z.pathname || ""
                    , j = Z.search || "";
                Z.path = N + j
            }
            return Z.slashes = Z.slashes || J.slashes,
                Z.href = Z.format(),
                Z
        }
        var k = Z.pathname && Z.pathname.charAt(0) === "/"
            , L = J.host || J.pathname && J.pathname.charAt(0) === "/"
            , F = L || k || Z.host && J.pathname
            , P = F
            , M = Z.pathname && Z.pathname.split("/") || []
            , v = J.pathname && J.pathname.split("/") || []
            , E = Z.protocol && !C4[Z.protocol];
        if (E) {
            if (Z.hostname = "",
                Z.port = null,
                Z.host)
                if (M[0] === "")
                    M[0] = Z.host;
                else
                    M.unshift(Z.host);
            if (Z.host = "",
                J.protocol) {
                if (J.hostname = null,
                    J.port = null,
                    J.host)
                    if (v[0] === "")
                        v[0] = J.host;
                    else
                        v.unshift(J.host);
                J.host = null
            }
            F = F && (v[0] === "" || M[0] === "")
        }
        if (L)
            Z.host = J.host || J.host === "" ? J.host : Z.host,
                Z.hostname = J.hostname || J.hostname === "" ? J.hostname : Z.hostname,
                Z.search = J.search,
                Z.query = J.query,
                M = v;
        else if (v.length) {
            if (!M)
                M = [];
            M.pop(),
                M = M.concat(v),
                Z.search = J.search,
                Z.query = J.query
        } else if (!Eu(J.search)) {
            if (E) {
                Z.hostname = Z.host = M.shift();
                var n = Z.host && Z.host.indexOf("@") > 0 ? Z.host.split("@") : !1;
                if (n)
                    Z.auth = n.shift(),
                        Z.host = Z.hostname = n.shift()
            }
            if (Z.search = J.search,
                Z.query = J.query,
                !XO(Z.pathname) || !XO(Z.search))
                Z.path = (Z.pathname ? Z.pathname : "") + (Z.search ? Z.search : "");
            return Z.href = Z.format(),
                Z
        }
        if (!M.length) {
            if (Z.pathname = null,
                Z.search)
                Z.path = "/" + Z.search;
            else
                Z.path = null;
            return Z.href = Z.format(),
                Z
        }
        var u = M.slice(-1)[0]
            , b = (Z.host || J.host || M.length > 1) && (u === "." || u === "..") || u === ""
            , i = 0;
        for (var g = M.length; g >= 0; g--)
            if (u = M[g],
                u === ".")
                M.splice(g, 1);
            else if (u === "..")
                M.splice(g, 1),
                    i++;
            else if (i)
                M.splice(g, 1),
                    i--;
        if (!F && !P)
            for (; i--; i)
                M.unshift("..");
        if (F && M[0] !== "" && (!M[0] || M[0].charAt(0) !== "/"))
            M.unshift("");
        if (b && M.join("/").substr(-1) !== "/")
            M.push("");
        var l = M[0] === "" || M[0] && M[0].charAt(0) === "/";
        if (E) {
            Z.hostname = Z.host = l ? "" : M.length ? M.shift() : "";
            var n = Z.host && Z.host.indexOf("@") > 0 ? Z.host.split("@") : !1;
            if (n)
                Z.auth = n.shift(),
                    Z.host = Z.hostname = n.shift()
        }
        if (F = F || Z.host && M.length,
            F && !l)
            M.unshift("");
        if (!M.length)
            Z.pathname = null,
                Z.path = null;
        else
            Z.pathname = M.join("/");
        if (!XO(Z.pathname) || !XO(Z.search))
            Z.path = (Z.pathname ? Z.pathname : "") + (Z.search ? Z.search : "");
        return Z.auth = J.auth || Z.auth,
            Z.slashes = Z.slashes || J.slashes,
            Z.href = Z.format(),
            Z
    }
        ;
    TQ.prototype.parseHost = function () {
        var J = this.host
            , Q = _u.exec(J);
        if (Q) {
            if (Q = Q[0],
                Q !== ":")
                this.port = Q.substr(1);
            J = J.substr(0, J.length - Q.length)
        }
        if (J)
            this.hostname = J
    }
}
);
function j6(J, Q, Z = 3) {
    if (Jv[Q])
        return;
    let $ = new Error().stack;
    typeof $ > "u" || ($ = $.split(`
`).splice(Z).join(`
`)),
        Jv[Q] = !0
}
var Jv;
var O4 = O(() => {
    Jv = {}
}
);
var Qv = O(() => {
    eb();
    O4()
}
);
var Zv = O(() => {
    $7()
}
);
var $v = O(() => {
    l8()
}
);
var qv = O(() => {
    O4()
}
);
function VP() {
    return typeof KP > "u" && (KP = function () {
        let J = {
            stencil: !0,
            failIfMajorPerformanceCaveat: L8.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT
        };
        try {
            if (!L8.ADAPTER.getWebGLRenderingContext())
                return !1;
            let Q = L8.ADAPTER.createCanvas()
                , Z = Q.getContext("webgl", J) || Q.getContext("experimental-webgl", J)
                , $ = !!Z?.getContextAttributes()?.stencil;
            if (Z) {
                let q = Z.getExtension("WEBGL_lose_context");
                q && q.loseContext()
            }
            return Z = null,
                $
        } catch {
            return !1
        }
    }()),
        KP
}
var KP;
var Kv = O(() => {
    KO();
    $7()
}
);
var I4 = class J {
    constructor(Q = 16777215) {
        this._value = null,
            this._components = new Float32Array(4),
            this._components.fill(1),
            this._int = 16777215,
            this.value = Q
    }
    get red() {
        return this._components[0]
    }
    get green() {
        return this._components[1]
    }
    get blue() {
        return this._components[2]
    }
    get alpha() {
        return this._components[3]
    }
    setValue(Q) {
        return this.value = Q,
            this
    }
    set value(Q) {
        if (Q instanceof J)
            this._value = this.cloneSource(Q._value),
                this._int = Q._int,
                this._components.set(Q._components);
        else {
            if (Q === null)
                throw new Error("Cannot set PIXI.Color#value to null");
            (this._value === null || !this.isSourceEqual(this._value, Q)) && (this.normalize(Q),
                this._value = this.cloneSource(Q))
        }
    }
    get value() {
        return this._value
    }
    cloneSource(Q) {
        return typeof Q == "string" || typeof Q == "number" || Q instanceof Number || Q === null ? Q : Array.isArray(Q) || ArrayBuffer.isView(Q) ? Q.slice(0) : typeof Q == "object" && Q !== null ? {
            ...Q
        } : Q
    }
    isSourceEqual(Q, Z) {
        let $ = typeof Q;
        if ($ !== typeof Z)
            return !1;
        if ($ === "number" || $ === "string" || Q instanceof Number)
            return Q === Z;
        if (Array.isArray(Q) && Array.isArray(Z) || ArrayBuffer.isView(Q) && ArrayBuffer.isView(Z))
            return Q.length !== Z.length ? !1 : Q.every((q, K) => q === Z[K]);
        if (Q !== null && Z !== null) {
            let q = Object.keys(Q)
                , K = Object.keys(Z);
            return q.length !== K.length ? !1 : q.every((V) => Q[V] === Z[V])
        }
        return Q === Z
    }
    toRgba() {
        let [Q, Z, $, q] = this._components;
        return {
            r: Q,
            g: Z,
            b: $,
            a: q
        }
    }
    toRgb() {
        let [Q, Z, $] = this._components;
        return {
            r: Q,
            g: Z,
            b: $
        }
    }
    toRgbaString() {
        let [Q, Z, $] = this.toUint8RgbArray();
        return `rgba(${Q},${Z},${$},${this.alpha})`
    }
    toUint8RgbArray(Q) {
        let [Z, $, q] = this._components;
        return Q = Q ?? [],
            Q[0] = Math.round(Z * 255),
            Q[1] = Math.round($ * 255),
            Q[2] = Math.round(q * 255),
            Q
    }
    toRgbArray(Q) {
        Q = Q ?? [];
        let [Z, $, q] = this._components;
        return Q[0] = Z,
            Q[1] = $,
            Q[2] = q,
            Q
    }
    toNumber() {
        return this._int
    }
    toLittleEndianNumber() {
        let Q = this._int;
        return (Q >> 16) + (Q & 65280) + ((Q & 255) << 16)
    }
    multiply(Q) {
        let [Z, $, q, K] = J.temp.setValue(Q)._components;
        return this._components[0] *= Z,
            this._components[1] *= $,
            this._components[2] *= q,
            this._components[3] *= K,
            this.refreshInt(),
            this._value = null,
            this
    }
    premultiply(Q, Z = !0) {
        return Z && (this._components[0] *= Q,
            this._components[1] *= Q,
            this._components[2] *= Q),
            this._components[3] = Q,
            this.refreshInt(),
            this._value = null,
            this
    }
    toPremultiplied(Q, Z = !0) {
        if (Q === 1)
            return -16777216 + this._int;
        if (Q === 0)
            return Z ? 0 : this._int;
        let $ = this._int >> 16 & 255
            , q = this._int >> 8 & 255
            , K = this._int & 255;
        return Z && ($ = $ * Q + 0.5 | 0,
            q = q * Q + 0.5 | 0,
            K = K * Q + 0.5 | 0),
            (Q * 255 << 24) + ($ << 16) + (q << 8) + K
    }
    toHex() {
        let Q = this._int.toString(16);
        return `#${"000000".substring(0, 6 - Q.length) + Q}`
    }
    toHexa() {
        let Q = Math.round(this._components[3] * 255).toString(16);
        return this.toHex() + "00".substring(0, 2 - Q.length) + Q
    }
    setAlpha(Q) {
        return this._components[3] = this._clamp(Q),
            this
    }
    round(Q) {
        let [Z, $, q] = this._components;
        return this._components[0] = Math.round(Z * Q) / Q,
            this._components[1] = Math.round($ * Q) / Q,
            this._components[2] = Math.round(q * Q) / Q,
            this.refreshInt(),
            this._value = null,
            this
    }
    toArray(Q) {
        Q = Q ?? [];
        let [Z, $, q, K] = this._components;
        return Q[0] = Z,
            Q[1] = $,
            Q[2] = q,
            Q[3] = K,
            Q
    }
    normalize(Q) {
        let Z, $, q, K;
        if ((typeof Q == "number" || Q instanceof Number) && Q >= 0 && Q <= 16777215) {
            let V = Q;
            Z = (V >> 16 & 255) / 255,
                $ = (V >> 8 & 255) / 255,
                q = (V & 255) / 255,
                K = 1
        } else if ((Array.isArray(Q) || Q instanceof Float32Array) && Q.length >= 3 && Q.length <= 4)
            Q = this._clamp(Q),
                [Z, $, q, K = 1] = Q;
        else if ((Q instanceof Uint8Array || Q instanceof Uint8ClampedArray) && Q.length >= 3 && Q.length <= 4)
            Q = this._clamp(Q, 0, 255),
                [Z, $, q, K = 255] = Q,
                Z /= 255,
                $ /= 255,
                q /= 255,
                K /= 255;
        else if (typeof Q == "string" || typeof Q == "object") {
            if (typeof Q == "string") {
                let z = J.HEX_PATTERN.exec(Q);
                z && (Q = `#${z[2]}`)
            }
            let V = B5(Q);
            V.isValid() && ({ r: Z, g: $, b: q, a: K } = V.rgba,
                Z /= 255,
                $ /= 255,
                q /= 255)
        }
        if (Z !== void 0)
            this._components[0] = Z,
                this._components[1] = $,
                this._components[2] = q,
                this._components[3] = K,
                this.refreshInt();
        else
            throw new Error(`Unable to convert color ${Q}`)
    }
    refreshInt() {
        this._clamp(this._components);
        let [Q, Z, $] = this._components;
        this._int = (Q * 255 << 16) + (Z * 255 << 8) + ($ * 255 | 0)
    }
    _clamp(Q, Z = 0, $ = 1) {
        return typeof Q == "number" ? Math.min(Math.max(Q, Z), $) : (Q.forEach((q, K) => {
            Q[K] = Math.min(Math.max(q, Z), $)
        }
        ),
            Q)
    }
}
    , w9;
var Vv = O(() => {
    zF();
    dY([XV]);
    I4.shared = new I4,
        I4.temp = new I4,
        I4.HEX_PATTERN = /^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;
    w9 = I4
}
);
var hZ = O(() => {
    Vv()
}
);
var zv = O(() => {
    hZ();
    O4()
}
);
function fu() {
    let J = []
        , Q = [];
    for (let $ = 0; $ < 32; $++)
        J[$] = $,
            Q[$] = $;
    J[T8.NORMAL_NPM] = T8.NORMAL,
        J[T8.ADD_NPM] = T8.ADD,
        J[T8.SCREEN_NPM] = T8.SCREEN,
        Q[T8.NORMAL] = T8.NORMAL_NPM,
        Q[T8.ADD] = T8.ADD_NPM,
        Q[T8.SCREEN] = T8.SCREEN_NPM;
    let Z = [];
    return Z.push(Q),
        Z.push(J),
        Z
}
var zP;
var Wv = O(() => {
    hZ();
    l8();
    O4();
    zP = fu()
}
);
var WP = () => { }
    ;
var Hv = () => { }
    ;
function L4(J) {
    if (J.BYTES_PER_ELEMENT === 4)
        return J instanceof Float32Array ? "Float32Array" : J instanceof Uint32Array ? "Uint32Array" : "Int32Array";
    if (J.BYTES_PER_ELEMENT === 2) {
        if (J instanceof Uint16Array)
            return "Uint16Array"
    } else if (J.BYTES_PER_ELEMENT === 1 && J instanceof Uint8Array)
        return "Uint8Array";
    return null
}
var HP = () => { }
    ;
var Yv = O(() => {
    HP()
}
);
function e$(J) {
    return J += J === 0 ? 1 : 0,
        --J,
        J |= J >>> 1,
        J |= J >>> 2,
        J |= J >>> 4,
        J |= J >>> 8,
        J |= J >>> 16,
        J + 1
}
function UO(J) {
    return !(J & J - 1) && !!J
}
function NO(J) {
    let Q = (J > 65535 ? 1 : 0) << 4;
    J >>>= Q;
    let Z = (J > 255 ? 1 : 0) << 3;
    return J >>>= Z,
        Q |= Z,
        Z = (J > 15 ? 1 : 0) << 2,
        J >>>= Z,
        Q |= Z,
        Z = (J > 3 ? 1 : 0) << 1,
        J >>>= Z,
        Q |= Z,
        Q | J >> 1
}
var Xv = () => { }
    ;
function YP(J, Q, Z) {
    let $ = J.length, q;
    if (Q >= $ || Z === 0)
        return;
    Z = Q + Z > $ ? $ - Q : Z;
    let K = $ - Z;
    for (q = Q; q < K; ++q)
        J[q] = J[q + Z];
    J.length = K
}
var Uv = () => { }
    ;
var Nv = () => { }
    ;
function yQ() {
    return ++hu
}
var hu = 0;
var wv = () => { }
    ;
var jv = class {
    constructor(J, Q, Z, $) {
        this.left = J,
            this.top = Q,
            this.right = Z,
            this.bottom = $
    }
    get width() {
        return this.right - this.left
    }
    get height() {
        return this.bottom - this.top
    }
    isEmpty() {
        return this.left === this.right || this.top === this.bottom
    }
}
    ;
var XP = O(() => {
    jv.EMPTY = new jv(0, 0, 0, 0)
}
);
var wO, L5, o9;
var Bv = O(() => {
    wO = {},
        L5 = Object.create(null),
        o9 = Object.create(null)
}
);
var kv = O(() => {
    $7()
}
);
var UP = O(() => {
    XP()
}
);
var Cv = O(() => {
    UP()
}
);
var Ov = O(() => {
    WP()
}
);
function NP(J, Q = globalThis.location) {
    if (J.startsWith("data:"))
        return "";
    Q = Q || globalThis.location;
    let Z = new URL(J, document.baseURI);
    return Z.hostname !== Q.hostname || Z.port !== Q.port || Z.protocol !== Q.protocol ? "anonymous" : ""
}
var Iv = () => { }
    ;
function jO(J, Q = 1) {
    let Z = L8.RETINA_PREFIX?.exec(J);
    return Z ? parseFloat(Z[1]) : Q
}
var Lv = O(() => {
    KO();
    $7()
}
);
var J1, cu;
var OJ = O(() => {
    KO();
    $7();
    J1 = oZ(cb(), 1),
        cu = oZ(ob(), 1);
    Qv();
    Zv();
    $v();
    qv();
    Kv();
    zv();
    Wv();
    WP();
    Hv();
    HP();
    Yv();
    Xv();
    Uv();
    Nv();
    wv();
    O4();
    XP();
    Bv();
    kv();
    UP();
    Cv();
    Ov();
    Iv();
    Lv()
}
);
var B8, wP = (J) => {
    if (typeof J == "function" || typeof J == "object" && J.extension) {
        if (!J.extension)
            throw new Error("Extension class must have an extension object");
        J = {
            ...typeof J.extension != "object" ? {
                type: J.extension
            } : J.extension,
            ref: J
        }
    }
    if (typeof J == "object")
        J = {
            ...J
        };
    else
        throw new Error("Invalid extension type");
    return typeof J.type == "string" && (J.type = [J.type]),
        J
}
    , Fv = (J, Q) => wP(J).priority ?? Q, F8;
var r6 = O(() => {
    B8 = ((J) => (J.Renderer = "renderer",
        J.Application = "application",
        J.RendererSystem = "renderer-webgl-system",
        J.RendererPlugin = "renderer-webgl-plugin",
        J.CanvasRendererSystem = "renderer-canvas-system",
        J.CanvasRendererPlugin = "renderer-canvas-plugin",
        J.Asset = "asset",
        J.LoadParser = "load-parser",
        J.ResolveParser = "resolve-parser",
        J.CacheParser = "cache-parser",
        J.DetectionParser = "detection-parser",
        J))(B8 || {}),
        F8 = {
            _addHandlers: {},
            _removeHandlers: {},
            _queue: {},
            remove(...J) {
                return J.map(wP).forEach((Q) => {
                    Q.type.forEach((Z) => this._removeHandlers[Z]?.(Q))
                }
                ),
                    this
            },
            add(...J) {
                return J.map(wP).forEach((Q) => {
                    Q.type.forEach((Z) => {
                        let $ = this._addHandlers
                            , q = this._queue;
                        $[Z] ? $[Z]?.(Q) : (q[Z] = q[Z] || [],
                            q[Z]?.push(Q))
                    }
                    )
                }
                ),
                    this
            },
            handle(J, Q, Z) {
                let $ = this._addHandlers
                    , q = this._removeHandlers;
                if ($[J] || q[J])
                    throw new Error(`Extension type ${J} already has a handler`);
                $[J] = Q,
                    q[J] = Z;
                let K = this._queue;
                return K[J] && (K[J]?.forEach((V) => Q(V)),
                    delete K[J]),
                    this
            },
            handleByMap(J, Q) {
                return this.handle(J, (Z) => {
                    Z.name && (Q[Z.name] = Z.ref)
                }
                    , (Z) => {
                        Z.name && delete Q[Z.name]
                    }
                )
            },
            handleByList(J, Q, Z = -1) {
                return this.handle(J, ($) => {
                    Q.includes($.ref) || (Q.push($.ref),
                        Q.sort((q, K) => Fv(K, Z) - Fv(q, Z)))
                }
                    , ($) => {
                        let q = Q.indexOf($.ref);
                        q !== -1 && Q.splice(q, 1)
                    }
                )
            }
        }
}
);
class BO {
    constructor(J) {
        typeof J == "number" ? this.rawBinaryData = new ArrayBuffer(J) : J instanceof Uint8Array ? this.rawBinaryData = J.buffer : this.rawBinaryData = J,
            this.uint32View = new Uint32Array(this.rawBinaryData),
            this.float32View = new Float32Array(this.rawBinaryData)
    }
    get int8View() {
        return this._int8View || (this._int8View = new Int8Array(this.rawBinaryData)),
            this._int8View
    }
    get uint8View() {
        return this._uint8View || (this._uint8View = new Uint8Array(this.rawBinaryData)),
            this._uint8View
    }
    get int16View() {
        return this._int16View || (this._int16View = new Int16Array(this.rawBinaryData)),
            this._int16View
    }
    get uint16View() {
        return this._uint16View || (this._uint16View = new Uint16Array(this.rawBinaryData)),
            this._uint16View
    }
    get int32View() {
        return this._int32View || (this._int32View = new Int32Array(this.rawBinaryData)),
            this._int32View
    }
    view(J) {
        return this[`${J}View`]
    }
    destroy() {
        this.rawBinaryData = null,
            this._int8View = null,
            this._uint8View = null,
            this._int16View = null,
            this._uint16View = null,
            this._int32View = null,
            this.uint32View = null,
            this.float32View = null
    }
    static sizeOf(J) {
        switch (J) {
            case "int8":
            case "uint8":
                return 1;
            case "int16":
            case "uint16":
                return 2;
            case "int32":
            case "uint32":
            case "float32":
                return 4;
            default:
                throw new Error(`${J} isn't a valid view type`)
        }
    }
}
var jP = () => { }
    ;
function uu(J) {
    let Q = "";
    for (let Z = 0; Z < J; ++Z)
        Z > 0 && (Q += `
else `),
            Z < J - 1 && (Q += `if(test == ${Z}.0){}`);
    return Q
}
function kO(J, Q) {
    if (J === 0)
        throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");
    let Z = Q.createShader(Q.FRAGMENT_SHADER);
    for (; ;) {
        let $ = pu.replace(/%forloop%/gi, uu(J));
        if (Q.shaderSource(Z, $),
            Q.compileShader(Z),
            !Q.getShaderParameter(Z, Q.COMPILE_STATUS))
            J = J / 2 | 0;
        else
            break
    }
    return J
}
var pu;
var CO = O(() => {
    pu = ["precision mediump float;", "void main(void){", "float test = 0.1;", "%forloop%", "gl_FragColor = vec4(0.0);", "}"].join(`
`)
}
);
class n9 {
    constructor() {
        this.data = 0,
            this.blendMode = T8.NORMAL,
            this.polygonOffset = 0,
            this.blend = !0,
            this.depthMask = !0
    }
    get blend() {
        return !!(this.data & 1 << BP)
    }
    set blend(J) {
        !!(this.data & 1 << BP) !== J && (this.data ^= 1 << BP)
    }
    get offsets() {
        return !!(this.data & 1 << kP)
    }
    set offsets(J) {
        !!(this.data & 1 << kP) !== J && (this.data ^= 1 << kP)
    }
    get culling() {
        return !!(this.data & 1 << CP)
    }
    set culling(J) {
        !!(this.data & 1 << CP) !== J && (this.data ^= 1 << CP)
    }
    get depthTest() {
        return !!(this.data & 1 << OP)
    }
    set depthTest(J) {
        !!(this.data & 1 << OP) !== J && (this.data ^= 1 << OP)
    }
    get depthMask() {
        return !!(this.data & 1 << LP)
    }
    set depthMask(J) {
        !!(this.data & 1 << LP) !== J && (this.data ^= 1 << LP)
    }
    get clockwiseFrontFace() {
        return !!(this.data & 1 << IP)
    }
    set clockwiseFrontFace(J) {
        !!(this.data & 1 << IP) !== J && (this.data ^= 1 << IP)
    }
    get blendMode() {
        return this._blendMode
    }
    set blendMode(J) {
        this.blend = J !== T8.NONE,
            this._blendMode = J
    }
    get polygonOffset() {
        return this._polygonOffset
    }
    set polygonOffset(J) {
        this.offsets = !!J,
            this._polygonOffset = J
    }
    static for2d() {
        let J = new n9;
        return J.depthTest = !1,
            J.blend = !0,
            J
    }
}
var BP = 0
    , kP = 1
    , CP = 2
    , OP = 3
    , IP = 4
    , LP = 5;
var MH = O(() => {
    l8();
    n9.prototype.toString = function () {
        return `[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`
    }
}
);
function F4(J, Q) {
    if (!J)
        return null;
    let Z = "";
    if (typeof J == "string") {
        let $ = /\.(\w{3,4})(?:$|\?|#)/i.exec(J);
        $ && (Z = $[1].toLowerCase())
    }
    for (let $ = _H.length - 1; $ >= 0; --$) {
        let q = _H[$];
        if (q.test && q.test(J, Z))
            return new q(J, Q)
    }
    throw new Error("Unrecognized source type to auto-detect Resource")
}
var _H;
var G4 = O(() => {
    _H = []
}
);
class a7 {
    constructor(J) {
        this.items = [],
            this._name = J,
            this._aliasCount = 0
    }
    emit(J, Q, Z, $, q, K, V, z) {
        if (arguments.length > 8)
            throw new Error("max arguments reached");
        let { name: W, items: H } = this;
        this._aliasCount++;
        for (let Y = 0, U = H.length; Y < U; Y++)
            H[Y][W](J, Q, Z, $, q, K, V, z);
        return H === this.items && this._aliasCount--,
            this
    }
    ensureNonAliasedItems() {
        this._aliasCount > 0 && this.items.length > 1 && (this._aliasCount = 0,
            this.items = this.items.slice(0))
    }
    add(J) {
        return J[this._name] && (this.ensureNonAliasedItems(),
            this.remove(J),
            this.items.push(J)),
            this
    }
    remove(J) {
        let Q = this.items.indexOf(J);
        return Q !== -1 && (this.ensureNonAliasedItems(),
            this.items.splice(Q, 1)),
            this
    }
    contains(J) {
        return this.items.includes(J)
    }
    removeAll() {
        return this.ensureNonAliasedItems(),
            this.items.length = 0,
            this
    }
    destroy() {
        this.removeAll(),
            this.items.length = 0,
            this._name = ""
    }
    get empty() {
        return this.items.length === 0
    }
    get name() {
        return this._name
    }
}
var Gv = O(() => {
    Object.defineProperties(a7.prototype, {
        dispatch: {
            value: a7.prototype.emit
        },
        run: {
            value: a7.prototype.emit
        }
    })
}
);
var fQ = O(() => {
    Gv()
}
);
class g5 {
    constructor(J = 0, Q = 0) {
        this._width = J,
            this._height = Q,
            this.destroyed = !1,
            this.internal = !1,
            this.onResize = new a7("setRealSize"),
            this.onUpdate = new a7("update"),
            this.onError = new a7("onError")
    }
    bind(J) {
        this.onResize.add(J),
            this.onUpdate.add(J),
            this.onError.add(J),
            (this._width || this._height) && this.onResize.emit(this._width, this._height)
    }
    unbind(J) {
        this.onResize.remove(J),
            this.onUpdate.remove(J),
            this.onError.remove(J)
    }
    resize(J, Q) {
        (J !== this._width || Q !== this._height) && (this._width = J,
            this._height = Q,
            this.onResize.emit(J, Q))
    }
    get valid() {
        return !!this._width && !!this._height
    }
    update() {
        this.destroyed || this.onUpdate.emit()
    }
    load() {
        return Promise.resolve(this)
    }
    get width() {
        return this._width
    }
    get height() {
        return this._height
    }
    style(J, Q, Z) {
        return !1
    }
    dispose() { }
    destroy() {
        this.destroyed || (this.destroyed = !0,
            this.dispose(),
            this.onError.removeAll(),
            this.onError = null,
            this.onResize.removeAll(),
            this.onResize = null,
            this.onUpdate.removeAll(),
            this.onUpdate = null)
    }
    static test(J, Q) {
        return !1
    }
}
var Q1 = O(() => {
    fQ()
}
);
var P4;
var OO = O(() => {
    l8();
    Q1();
    P4 = class P4 extends g5 {
        constructor(J, Q) {
            let { width: Z, height: $ } = Q || {};
            if (!Z || !$)
                throw new Error("BufferResource width or height invalid");
            super(Z, $),
                this.data = J,
                this.unpackAlignment = Q.unpackAlignment ?? 4
        }
        upload(J, Q, Z) {
            let $ = J.gl;
            $.pixelStorei($.UNPACK_ALIGNMENT, this.unpackAlignment),
                $.pixelStorei($.UNPACK_PREMULTIPLY_ALPHA_WEBGL, Q.alphaMode === I5.UNPACK);
            let { realWidth: q, realHeight: K } = Q;
            return Z.width === q && Z.height === K ? $.texSubImage2D(Q.target, 0, 0, 0, q, K, Q.format, Z.type, this.data) : (Z.width = q,
                Z.height = K,
                $.texImage2D(Q.target, 0, Z.internalFormat, q, K, 0, Q.format, Z.type, this.data)),
                !0
        }
        dispose() {
            this.data = null
        }
        static test(J) {
            return J === null || J instanceof Int8Array || J instanceof Uint8Array || J instanceof Uint8ClampedArray || J instanceof Int16Array || J instanceof Uint16Array || J instanceof Int32Array || J instanceof Uint32Array || J instanceof Float32Array
        }
    }
}
);
var lu, FP, L6;
var hQ = O(() => {
    l8();
    $7();
    OJ();
    G4();
    OO();
    Q1();
    lu = {
        scaleMode: x5.NEAREST,
        alphaMode: I5.NPM
    },
        FP = class J extends J1.default {
            constructor(Q = null, Z = null) {
                super(),
                    Z = Object.assign({}, J.defaultOptions, Z);
                let { alphaMode: $, mipmap: q, anisotropicLevel: K, scaleMode: V, width: z, height: W, wrapMode: H, format: Y, type: U, target: N, resolution: j, resourceOptions: k } = Z;
                Q && !(Q instanceof g5) && (Q = F4(Q, k),
                    Q.internal = !0),
                    this.resolution = j || L8.RESOLUTION,
                    this.width = Math.round((z || 0) * this.resolution) / this.resolution,
                    this.height = Math.round((W || 0) * this.resolution) / this.resolution,
                    this._mipmap = q,
                    this.anisotropicLevel = K,
                    this._wrapMode = H,
                    this._scaleMode = V,
                    this.format = Y,
                    this.type = U,
                    this.target = N,
                    this.alphaMode = $,
                    this.uid = yQ(),
                    this.touched = 0,
                    this.isPowerOfTwo = !1,
                    this._refreshPOT(),
                    this._glTextures = {},
                    this.dirtyId = 0,
                    this.dirtyStyleId = 0,
                    this.cacheId = null,
                    this.valid = z > 0 && W > 0,
                    this.textureCacheIds = [],
                    this.destroyed = !1,
                    this.resource = null,
                    this._batchEnabled = 0,
                    this._batchLocation = 0,
                    this.parentTextureArray = null,
                    this.setResource(Q)
            }
            get realWidth() {
                return Math.round(this.width * this.resolution)
            }
            get realHeight() {
                return Math.round(this.height * this.resolution)
            }
            get mipmap() {
                return this._mipmap
            }
            set mipmap(Q) {
                this._mipmap !== Q && (this._mipmap = Q,
                    this.dirtyStyleId++)
            }
            get scaleMode() {
                return this._scaleMode
            }
            set scaleMode(Q) {
                this._scaleMode !== Q && (this._scaleMode = Q,
                    this.dirtyStyleId++)
            }
            get wrapMode() {
                return this._wrapMode
            }
            set wrapMode(Q) {
                this._wrapMode !== Q && (this._wrapMode = Q,
                    this.dirtyStyleId++)
            }
            setStyle(Q, Z) {
                let $;
                return Q !== void 0 && Q !== this.scaleMode && (this.scaleMode = Q,
                    $ = !0),
                    Z !== void 0 && Z !== this.mipmap && (this.mipmap = Z,
                        $ = !0),
                    $ && this.dirtyStyleId++,
                    this
            }
            setSize(Q, Z, $) {
                return $ = $ || this.resolution,
                    this.setRealSize(Q * $, Z * $, $)
            }
            setRealSize(Q, Z, $) {
                return this.resolution = $ || this.resolution,
                    this.width = Math.round(Q) / this.resolution,
                    this.height = Math.round(Z) / this.resolution,
                    this._refreshPOT(),
                    this.update(),
                    this
            }
            _refreshPOT() {
                this.isPowerOfTwo = UO(this.realWidth) && UO(this.realHeight)
            }
            setResolution(Q) {
                let Z = this.resolution;
                return Z === Q ? this : (this.resolution = Q,
                    this.valid && (this.width = Math.round(this.width * Z) / Q,
                        this.height = Math.round(this.height * Z) / Q,
                        this.emit("update", this)),
                    this._refreshPOT(),
                    this)
            }
            setResource(Q) {
                if (this.resource === Q)
                    return this;
                if (this.resource)
                    throw new Error("Resource can be set only once");
                return Q.bind(this),
                    this.resource = Q,
                    this
            }
            update() {
                this.valid ? (this.dirtyId++,
                    this.dirtyStyleId++,
                    this.emit("update", this)) : this.width > 0 && this.height > 0 && (this.valid = !0,
                        this.emit("loaded", this),
                        this.emit("update", this))
            }
            onError(Q) {
                this.emit("error", this, Q)
            }
            destroy() {
                this.resource && (this.resource.unbind(this),
                    this.resource.internal && this.resource.destroy(),
                    this.resource = null),
                    this.cacheId && (delete o9[this.cacheId],
                        delete L5[this.cacheId],
                        this.cacheId = null),
                    this.valid = !1,
                    this.dispose(),
                    J.removeFromCache(this),
                    this.textureCacheIds = null,
                    this.destroyed = !0,
                    this.emit("destroyed", this),
                    this.removeAllListeners()
            }
            dispose() {
                this.emit("dispose", this)
            }
            castToBaseTexture() {
                return this
            }
            static from(Q, Z, $ = L8.STRICT_TEXTURE_CACHE) {
                let q = typeof Q == "string"
                    , K = null;
                if (q)
                    K = Q;
                else {
                    if (!Q._pixiId) {
                        let z = Z?.pixiIdPrefix || "pixiid";
                        Q._pixiId = `${z}_${yQ()}`
                    }
                    K = Q._pixiId
                }
                let V = o9[K];
                if (q && $ && !V)
                    throw new Error(`The cacheId "${K}" does not exist in BaseTextureCache.`);
                return V || (V = new J(Q, Z),
                    V.cacheId = K,
                    J.addToCache(V, K)),
                    V
            }
            static fromBuffer(Q, Z, $, q) {
                Q = Q || new Float32Array(Z * $ * 4);
                let K = new P4(Q, {
                    width: Z,
                    height: $,
                    ...q?.resourceOptions
                }), V, z;
                return Q instanceof Float32Array ? (V = r0.RGBA,
                    z = r8.FLOAT) : Q instanceof Int32Array ? (V = r0.RGBA_INTEGER,
                        z = r8.INT) : Q instanceof Uint32Array ? (V = r0.RGBA_INTEGER,
                            z = r8.UNSIGNED_INT) : Q instanceof Int16Array ? (V = r0.RGBA_INTEGER,
                                z = r8.SHORT) : Q instanceof Uint16Array ? (V = r0.RGBA_INTEGER,
                                    z = r8.UNSIGNED_SHORT) : Q instanceof Int8Array ? (V = r0.RGBA,
                                        z = r8.BYTE) : (V = r0.RGBA,
                                            z = r8.UNSIGNED_BYTE),
                    K.internal = !0,
                    new J(K, Object.assign({}, lu, {
                        type: z,
                        format: V
                    }, q))
            }
            static addToCache(Q, Z) {
                Z && (Q.textureCacheIds.includes(Z) || Q.textureCacheIds.push(Z),
                    o9[Z] && o9[Z],
                    o9[Z] = Q)
            }
            static removeFromCache(Q) {
                if (typeof Q == "string") {
                    let Z = o9[Q];
                    if (Z) {
                        let $ = Z.textureCacheIds.indexOf(Q);
                        return $ > -1 && Z.textureCacheIds.splice($, 1),
                            delete o9[Q],
                            Z
                    }
                } else if (Q?.textureCacheIds) {
                    for (let Z = 0; Z < Q.textureCacheIds.length; ++Z)
                        delete o9[Q.textureCacheIds[Z]];
                    return Q.textureCacheIds.length = 0,
                        Q
                }
                return null
            }
        }
        ;
    FP.defaultOptions = {
        mipmap: U9.POW2,
        anisotropicLevel: 0,
        scaleMode: x5.LINEAR,
        wrapMode: GH.CLAMP,
        alphaMode: I5.UNPACK,
        target: SQ.TEXTURE_2D,
        format: r0.RGBA,
        type: r8.UNSIGNED_BYTE
    },
        FP._globalBatch = 0;
    L6 = FP
}
);
class IO {
    constructor() {
        this.texArray = null,
            this.blend = 0,
            this.type = B4.TRIANGLES,
            this.start = 0,
            this.size = 0,
            this.data = null
    }
}
var GP = O(() => {
    l8()
}
);
class r7 {
    constructor(J, Q = !0, Z = !1) {
        this.data = J || new Float32Array(1),
            this._glBuffers = {},
            this._updateID = 0,
            this.index = Z,
            this.static = Q,
            this.id = ou++,
            this.disposeRunner = new a7("disposeBuffer")
    }
    update(J) {
        J instanceof Array && (J = new Float32Array(J)),
            this.data = J || this.data,
            this._updateID++
    }
    dispose() {
        this.disposeRunner.emit(this, !1)
    }
    destroy() {
        this.dispose(),
            this.data = null
    }
    set index(J) {
        this.type = J ? H5.ELEMENT_ARRAY_BUFFER : H5.ARRAY_BUFFER
    }
    get index() {
        return this.type === H5.ELEMENT_ARRAY_BUFFER
    }
    static from(J) {
        return J instanceof Array && (J = new Float32Array(J)),
            new r7(J)
    }
}
var ou = 0;
var D4 = O(() => {
    l8();
    fQ()
}
);
class A4 {
    constructor(J, Q = 0, Z = !1, $ = r8.FLOAT, q, K, V, z = 1) {
        this.buffer = J,
            this.size = Q,
            this.normalized = Z,
            this.type = $,
            this.stride = q,
            this.start = K,
            this.instance = V,
            this.divisor = z
    }
    destroy() {
        this.buffer = null
    }
    static from(J, Q, Z, $, q) {
        return new A4(J, Q, Z, $, q)
    }
}
var PP = O(() => {
    l8()
}
);
function Pv(J, Q) {
    let Z = 0
        , $ = 0
        , q = {};
    for (let W = 0; W < J.length; W++)
        $ += Q[W],
            Z += J[W].length;
    let K = new ArrayBuffer(Z * 4)
        , V = null
        , z = 0;
    for (let W = 0; W < J.length; W++) {
        let H = Q[W]
            , Y = J[W]
            , U = L4(Y);
        q[U] || (q[U] = new nu[U](K)),
            V = q[U];
        for (let N = 0; N < Y.length; N++) {
            let j = (N / H | 0) * $ + z
                , k = N % H;
            V[j + k] = Y[N]
        }
        z += H
    }
    return new Float32Array(K)
}
var nu;
var Dv = O(() => {
    OJ();
    nu = {
        Float32Array,
        Uint32Array,
        Int32Array,
        Uint8Array
    }
}
);
class s9 {
    constructor(J = [], Q = {}) {
        this.buffers = J,
            this.indexBuffer = null,
            this.attributes = Q,
            this.glVertexArrayObjects = {},
            this.id = su++,
            this.instanced = !1,
            this.instanceCount = 1,
            this.disposeRunner = new a7("disposeGeometry"),
            this.refCount = 0
    }
    addAttribute(J, Q, Z = 0, $ = !1, q, K, V, z = !1) {
        if (!Q)
            throw new Error("You must pass a buffer when creating an attribute");
        Q instanceof r7 || (Q instanceof Array && (Q = new Float32Array(Q)),
            Q = new r7(Q));
        let W = J.split("|");
        if (W.length > 1) {
            for (let Y = 0; Y < W.length; Y++)
                this.addAttribute(W[Y], Q, Z, $, q);
            return this
        }
        let H = this.buffers.indexOf(Q);
        return H === -1 && (this.buffers.push(Q),
            H = this.buffers.length - 1),
            this.attributes[J] = new A4(H, Z, $, q, K, V, z),
            this.instanced = this.instanced || z,
            this
    }
    getAttribute(J) {
        return this.attributes[J]
    }
    getBuffer(J) {
        return this.buffers[this.getAttribute(J).buffer]
    }
    addIndex(J) {
        return J instanceof r7 || (J instanceof Array && (J = new Uint16Array(J)),
            J = new r7(J)),
            J.type = H5.ELEMENT_ARRAY_BUFFER,
            this.indexBuffer = J,
            this.buffers.includes(J) || this.buffers.push(J),
            this
    }
    getIndex() {
        return this.indexBuffer
    }
    interleave() {
        if (this.buffers.length === 1 || this.buffers.length === 2 && this.indexBuffer)
            return this;
        let J = [], Q = [], Z = new r7, $;
        for ($ in this.attributes) {
            let q = this.attributes[$]
                , K = this.buffers[q.buffer];
            J.push(K.data),
                Q.push(q.size * Av[q.type] / 4),
                q.buffer = 0
        }
        for (Z.data = Pv(J, Q),
            $ = 0; $ < this.buffers.length; $++)
            this.buffers[$] !== this.indexBuffer && this.buffers[$].destroy();
        return this.buffers = [Z],
            this.indexBuffer && this.buffers.push(this.indexBuffer),
            this
    }
    getSize() {
        for (let J in this.attributes) {
            let Q = this.attributes[J];
            return this.buffers[Q.buffer].data.length / (Q.stride / 4 || Q.size)
        }
        return 0
    }
    dispose() {
        this.disposeRunner.emit(this, !1)
    }
    destroy() {
        this.dispose(),
            this.buffers = null,
            this.indexBuffer = null,
            this.attributes = null
    }
    clone() {
        let J = new s9;
        for (let Q = 0; Q < this.buffers.length; Q++)
            J.buffers[Q] = new r7(this.buffers[Q].data.slice(0));
        for (let Q in this.attributes) {
            let Z = this.attributes[Q];
            J.attributes[Q] = new A4(Z.buffer, Z.size, Z.normalized, Z.type, Z.stride, Z.start, Z.instance)
        }
        return this.indexBuffer && (J.indexBuffer = J.buffers[this.buffers.indexOf(this.indexBuffer)],
            J.indexBuffer.type = H5.ELEMENT_ARRAY_BUFFER),
            J
    }
    static merge(J) {
        let Q = new s9, Z = [], $ = [], q = [], K;
        for (let V = 0; V < J.length; V++) {
            K = J[V];
            for (let z = 0; z < K.buffers.length; z++)
                $[z] = $[z] || 0,
                    $[z] += K.buffers[z].data.length,
                    q[z] = 0
        }
        for (let V = 0; V < K.buffers.length; V++)
            Z[V] = new iu[L4(K.buffers[V].data)]($[V]),
                Q.buffers[V] = new r7(Z[V]);
        for (let V = 0; V < J.length; V++) {
            K = J[V];
            for (let z = 0; z < K.buffers.length; z++)
                Z[z].set(K.buffers[z].data, q[z]),
                    q[z] += K.buffers[z].data.length
        }
        if (Q.attributes = K.attributes,
            K.indexBuffer) {
            Q.indexBuffer = Q.buffers[K.buffers.indexOf(K.indexBuffer)],
                Q.indexBuffer.type = H5.ELEMENT_ARRAY_BUFFER;
            let V = 0
                , z = 0
                , W = 0
                , H = 0;
            for (let Y = 0; Y < K.buffers.length; Y++)
                if (K.buffers[Y] !== K.indexBuffer) {
                    H = Y;
                    break
                }
            for (let Y in K.attributes) {
                let U = K.attributes[Y];
                (U.buffer | 0) === H && (z += U.size * Av[U.type] / 4)
            }
            for (let Y = 0; Y < J.length; Y++) {
                let U = J[Y].indexBuffer.data;
                for (let N = 0; N < U.length; N++)
                    Q.indexBuffer.data[N + W] += V;
                V += J[Y].buffers[H].data.length / z,
                    W += U.length
            }
        }
        return Q
    }
}
var Av, su = 0, iu;
var RH = O(() => {
    l8();
    fQ();
    OJ();
    PP();
    D4();
    Dv();
    Av = {
        5126: 4,
        5123: 2,
        5121: 1
    },
        iu = {
            Float32Array,
            Uint32Array,
            Int32Array,
            Uint8Array,
            Uint16Array
        }
}
);
var LO;
var DP = O(() => {
    l8();
    D4();
    RH();
    LO = class LO extends s9 {
        constructor(J = !1) {
            super(),
                this._buffer = new r7(null, J, !1),
                this._indexBuffer = new r7(null, J, !0),
                this.addAttribute("aVertexPosition", this._buffer, 2, !1, r8.FLOAT).addAttribute("aTextureCoord", this._buffer, 2, !1, r8.FLOAT).addAttribute("aColor", this._buffer, 4, !0, r8.UNSIGNED_BYTE).addAttribute("aTextureId", this._buffer, 1, !0, r8.FLOAT).addIndex(this._indexBuffer)
        }
    }
}
);
var AP, au, ru, m5;
var xZ = O(() => {
    AP = Math.PI * 2,
        au = 180 / Math.PI,
        ru = Math.PI / 180,
        m5 = ((J) => (J[J.POLY = 0] = "POLY",
            J[J.RECT = 1] = "RECT",
            J[J.CIRC = 2] = "CIRC",
            J[J.ELIP = 3] = "ELIP",
            J[J.RREC = 4] = "RREC",
            J))(m5 || {})
}
);
class t7 {
    constructor(J = 0, Q = 0) {
        this.x = 0,
            this.y = 0,
            this.x = J,
            this.y = Q
    }
    clone() {
        return new t7(this.x, this.y)
    }
    copyFrom(J) {
        return this.set(J.x, J.y),
            this
    }
    copyTo(J) {
        return J.set(this.x, this.y),
            J
    }
    equals(J) {
        return J.x === this.x && J.y === this.y
    }
    set(J = 0, Q = J) {
        return this.x = J,
            this.y = Q,
            this
    }
}
var FO = O(() => {
    t7.prototype.toString = function () {
        return `[@pixi/math:Point x=${this.x} y=${this.y}]`
    }
}
);
class _6 {
    constructor(J = 0, Q = 0, Z = 0, $ = 0) {
        this.x = Number(J),
            this.y = Number(Q),
            this.width = Number(Z),
            this.height = Number($),
            this.type = m5.RECT
    }
    get left() {
        return this.x
    }
    get right() {
        return this.x + this.width
    }
    get top() {
        return this.y
    }
    get bottom() {
        return this.y + this.height
    }
    static get EMPTY() {
        return new _6(0, 0, 0, 0)
    }
    clone() {
        return new _6(this.x, this.y, this.width, this.height)
    }
    copyFrom(J) {
        return this.x = J.x,
            this.y = J.y,
            this.width = J.width,
            this.height = J.height,
            this
    }
    copyTo(J) {
        return J.x = this.x,
            J.y = this.y,
            J.width = this.width,
            J.height = this.height,
            J
    }
    contains(J, Q) {
        return this.width <= 0 || this.height <= 0 ? !1 : J >= this.x && J < this.x + this.width && Q >= this.y && Q < this.y + this.height
    }
    intersects(J, Q) {
        if (!Q) {
            let b = this.x < J.x ? J.x : this.x;
            if ((this.right > J.right ? J.right : this.right) <= b)
                return !1;
            let i = this.y < J.y ? J.y : this.y;
            return (this.bottom > J.bottom ? J.bottom : this.bottom) > i
        }
        let Z = this.left
            , $ = this.right
            , q = this.top
            , K = this.bottom;
        if ($ <= Z || K <= q)
            return !1;
        let V = GO[0].set(J.left, J.top)
            , z = GO[1].set(J.left, J.bottom)
            , W = GO[2].set(J.right, J.top)
            , H = GO[3].set(J.right, J.bottom);
        if (W.x <= V.x || z.y <= V.y)
            return !1;
        let Y = Math.sign(Q.a * Q.d - Q.b * Q.c);
        if (Y === 0 || (Q.apply(V, V),
            Q.apply(z, z),
            Q.apply(W, W),
            Q.apply(H, H),
            Math.max(V.x, z.x, W.x, H.x) <= Z || Math.min(V.x, z.x, W.x, H.x) >= $ || Math.max(V.y, z.y, W.y, H.y) <= q || Math.min(V.y, z.y, W.y, H.y) >= K))
            return !1;
        let U = Y * (z.y - V.y)
            , N = Y * (V.x - z.x)
            , j = U * Z + N * q
            , k = U * $ + N * q
            , L = U * Z + N * K
            , F = U * $ + N * K;
        if (Math.max(j, k, L, F) <= U * V.x + N * V.y || Math.min(j, k, L, F) >= U * H.x + N * H.y)
            return !1;
        let P = Y * (V.y - W.y)
            , M = Y * (W.x - V.x)
            , v = P * Z + M * q
            , E = P * $ + M * q
            , n = P * Z + M * K
            , u = P * $ + M * K;
        return !(Math.max(v, E, n, u) <= P * V.x + M * V.y || Math.min(v, E, n, u) >= P * H.x + M * H.y)
    }
    pad(J = 0, Q = J) {
        return this.x -= J,
            this.y -= Q,
            this.width += J * 2,
            this.height += Q * 2,
            this
    }
    fit(J) {
        let Q = Math.max(this.x, J.x)
            , Z = Math.min(this.x + this.width, J.x + J.width)
            , $ = Math.max(this.y, J.y)
            , q = Math.min(this.y + this.height, J.y + J.height);
        return this.x = Q,
            this.width = Math.max(Z - Q, 0),
            this.y = $,
            this.height = Math.max(q - $, 0),
            this
    }
    ceil(J = 1, Q = 0.001) {
        let Z = Math.ceil((this.x + this.width - Q) * J) / J
            , $ = Math.ceil((this.y + this.height - Q) * J) / J;
        return this.x = Math.floor((this.x + Q) * J) / J,
            this.y = Math.floor((this.y + Q) * J) / J,
            this.width = Z - this.x,
            this.height = $ - this.y,
            this
    }
    enlarge(J) {
        let Q = Math.min(this.x, J.x)
            , Z = Math.max(this.x + this.width, J.x + J.width)
            , $ = Math.min(this.y, J.y)
            , q = Math.max(this.y + this.height, J.y + J.height);
        return this.x = Q,
            this.width = Z - Q,
            this.y = $,
            this.height = q - $,
            this
    }
}
var GO;
var PO = O(() => {
    xZ();
    FO();
    GO = [new t7, new t7, new t7, new t7];
    _6.prototype.toString = function () {
        return `[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`
    }
}
);
class DO {
    constructor(J = 0, Q = 0, Z = 0) {
        this.x = J,
            this.y = Q,
            this.radius = Z,
            this.type = m5.CIRC
    }
    clone() {
        return new DO(this.x, this.y, this.radius)
    }
    contains(J, Q) {
        if (this.radius <= 0)
            return !1;
        let Z = this.radius * this.radius
            , $ = this.x - J
            , q = this.y - Q;
        return $ *= $,
            q *= q,
            $ + q <= Z
    }
    getBounds() {
        return new _6(this.x - this.radius, this.y - this.radius, this.radius * 2, this.radius * 2)
    }
}
var Ev = O(() => {
    xZ();
    PO();
    DO.prototype.toString = function () {
        return `[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`
    }
}
);
class AO {
    constructor(J = 0, Q = 0, Z = 0, $ = 0) {
        this.x = J,
            this.y = Q,
            this.width = Z,
            this.height = $,
            this.type = m5.ELIP
    }
    clone() {
        return new AO(this.x, this.y, this.width, this.height)
    }
    contains(J, Q) {
        if (this.width <= 0 || this.height <= 0)
            return !1;
        let Z = (J - this.x) / this.width
            , $ = (Q - this.y) / this.height;
        return Z *= Z,
            $ *= $,
            Z + $ <= 1
    }
    getBounds() {
        return new _6(this.x - this.width, this.y - this.height, this.width, this.height)
    }
}
var Mv = O(() => {
    xZ();
    PO();
    AO.prototype.toString = function () {
        return `[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`
    }
}
);
class EO {
    constructor(...J) {
        let Q = Array.isArray(J[0]) ? J[0] : J;
        if (typeof Q[0] != "number") {
            let Z = [];
            for (let $ = 0, q = Q.length; $ < q; $++)
                Z.push(Q[$].x, Q[$].y);
            Q = Z
        }
        this.points = Q,
            this.type = m5.POLY,
            this.closeStroke = !0
    }
    clone() {
        let J = this.points.slice()
            , Q = new EO(J);
        return Q.closeStroke = this.closeStroke,
            Q
    }
    contains(J, Q) {
        let Z = !1
            , $ = this.points.length / 2;
        for (let q = 0, K = $ - 1; q < $; K = q++) {
            let V = this.points[q * 2]
                , z = this.points[q * 2 + 1]
                , W = this.points[K * 2]
                , H = this.points[K * 2 + 1];
            z > Q != H > Q && J < (W - V) * ((Q - z) / (H - z)) + V && (Z = !Z)
        }
        return Z
    }
}
var _v = O(() => {
    xZ();
    EO.prototype.toString = function () {
        return `[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((J, Q) => `${J}, ${Q}`, "")}]`
    }
}
);
class MO {
    constructor(J = 0, Q = 0, Z = 0, $ = 0, q = 20) {
        this.x = J,
            this.y = Q,
            this.width = Z,
            this.height = $,
            this.radius = q,
            this.type = m5.RREC
    }
    clone() {
        return new MO(this.x, this.y, this.width, this.height, this.radius)
    }
    contains(J, Q) {
        if (this.width <= 0 || this.height <= 0)
            return !1;
        if (J >= this.x && J <= this.x + this.width && Q >= this.y && Q <= this.y + this.height) {
            let Z = Math.max(0, Math.min(this.radius, Math.min(this.width, this.height) / 2));
            if (Q >= this.y + Z && Q <= this.y + this.height - Z || J >= this.x + Z && J <= this.x + this.width - Z)
                return !0;
            let $ = J - (this.x + Z)
                , q = Q - (this.y + Z)
                , K = Z * Z;
            if ($ * $ + q * q <= K || ($ = J - (this.x + this.width - Z),
                $ * $ + q * q <= K) || (q = Q - (this.y + this.height - Z),
                    $ * $ + q * q <= K) || ($ = J - (this.x + Z),
                        $ * $ + q * q <= K))
                return !0
        }
        return !1
    }
}
var Rv = O(() => {
    xZ();
    MO.prototype.toString = function () {
        return `[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`
    }
}
);
class t6 {
    constructor(J = 1, Q = 0, Z = 0, $ = 1, q = 0, K = 0) {
        this.array = null,
            this.a = J,
            this.b = Q,
            this.c = Z,
            this.d = $,
            this.tx = q,
            this.ty = K
    }
    fromArray(J) {
        this.a = J[0],
            this.b = J[1],
            this.c = J[3],
            this.d = J[4],
            this.tx = J[2],
            this.ty = J[5]
    }
    set(J, Q, Z, $, q, K) {
        return this.a = J,
            this.b = Q,
            this.c = Z,
            this.d = $,
            this.tx = q,
            this.ty = K,
            this
    }
    toArray(J, Q) {
        this.array || (this.array = new Float32Array(9));
        let Z = Q || this.array;
        return J ? (Z[0] = this.a,
            Z[1] = this.b,
            Z[2] = 0,
            Z[3] = this.c,
            Z[4] = this.d,
            Z[5] = 0,
            Z[6] = this.tx,
            Z[7] = this.ty,
            Z[8] = 1) : (Z[0] = this.a,
                Z[1] = this.c,
                Z[2] = this.tx,
                Z[3] = this.b,
                Z[4] = this.d,
                Z[5] = this.ty,
                Z[6] = 0,
                Z[7] = 0,
                Z[8] = 1),
            Z
    }
    apply(J, Q) {
        Q = Q || new t7;
        let { x: Z, y: $ } = J;
        return Q.x = this.a * Z + this.c * $ + this.tx,
            Q.y = this.b * Z + this.d * $ + this.ty,
            Q
    }
    applyInverse(J, Q) {
        Q = Q || new t7;
        let Z = 1 / (this.a * this.d + this.c * -this.b)
            , $ = J.x
            , q = J.y;
        return Q.x = this.d * Z * $ + -this.c * Z * q + (this.ty * this.c - this.tx * this.d) * Z,
            Q.y = this.a * Z * q + -this.b * Z * $ + (-this.ty * this.a + this.tx * this.b) * Z,
            Q
    }
    translate(J, Q) {
        return this.tx += J,
            this.ty += Q,
            this
    }
    scale(J, Q) {
        return this.a *= J,
            this.d *= Q,
            this.c *= J,
            this.b *= Q,
            this.tx *= J,
            this.ty *= Q,
            this
    }
    rotate(J) {
        let Q = Math.cos(J)
            , Z = Math.sin(J)
            , $ = this.a
            , q = this.c
            , K = this.tx;
        return this.a = $ * Q - this.b * Z,
            this.b = $ * Z + this.b * Q,
            this.c = q * Q - this.d * Z,
            this.d = q * Z + this.d * Q,
            this.tx = K * Q - this.ty * Z,
            this.ty = K * Z + this.ty * Q,
            this
    }
    append(J) {
        let Q = this.a
            , Z = this.b
            , $ = this.c
            , q = this.d;
        return this.a = J.a * Q + J.b * $,
            this.b = J.a * Z + J.b * q,
            this.c = J.c * Q + J.d * $,
            this.d = J.c * Z + J.d * q,
            this.tx = J.tx * Q + J.ty * $ + this.tx,
            this.ty = J.tx * Z + J.ty * q + this.ty,
            this
    }
    setTransform(J, Q, Z, $, q, K, V, z, W) {
        return this.a = Math.cos(V + W) * q,
            this.b = Math.sin(V + W) * q,
            this.c = -Math.sin(V - z) * K,
            this.d = Math.cos(V - z) * K,
            this.tx = J - (Z * this.a + $ * this.c),
            this.ty = Q - (Z * this.b + $ * this.d),
            this
    }
    prepend(J) {
        let Q = this.tx;
        if (J.a !== 1 || J.b !== 0 || J.c !== 0 || J.d !== 1) {
            let Z = this.a
                , $ = this.c;
            this.a = Z * J.a + this.b * J.c,
                this.b = Z * J.b + this.b * J.d,
                this.c = $ * J.a + this.d * J.c,
                this.d = $ * J.b + this.d * J.d
        }
        return this.tx = Q * J.a + this.ty * J.c + J.tx,
            this.ty = Q * J.b + this.ty * J.d + J.ty,
            this
    }
    decompose(J) {
        let Q = this.a
            , Z = this.b
            , $ = this.c
            , q = this.d
            , K = J.pivot
            , V = -Math.atan2(-$, q)
            , z = Math.atan2(Z, Q)
            , W = Math.abs(V + z);
        return W < 0.00001 || Math.abs(AP - W) < 0.00001 ? (J.rotation = z,
            J.skew.x = J.skew.y = 0) : (J.rotation = 0,
                J.skew.x = V,
                J.skew.y = z),
            J.scale.x = Math.sqrt(Q * Q + Z * Z),
            J.scale.y = Math.sqrt($ * $ + q * q),
            J.position.x = this.tx + (K.x * Q + K.y * $),
            J.position.y = this.ty + (K.x * Z + K.y * q),
            J
    }
    invert() {
        let J = this.a
            , Q = this.b
            , Z = this.c
            , $ = this.d
            , q = this.tx
            , K = J * $ - Q * Z;
        return this.a = $ / K,
            this.b = -Q / K,
            this.c = -Z / K,
            this.d = J / K,
            this.tx = (Z * this.ty - $ * q) / K,
            this.ty = -(J * this.ty - Q * q) / K,
            this
    }
    identity() {
        return this.a = 1,
            this.b = 0,
            this.c = 0,
            this.d = 1,
            this.tx = 0,
            this.ty = 0,
            this
    }
    clone() {
        let J = new t6;
        return J.a = this.a,
            J.b = this.b,
            J.c = this.c,
            J.d = this.d,
            J.tx = this.tx,
            J.ty = this.ty,
            J
    }
    copyTo(J) {
        return J.a = this.a,
            J.b = this.b,
            J.c = this.c,
            J.d = this.d,
            J.tx = this.tx,
            J.ty = this.ty,
            J
    }
    copyFrom(J) {
        return this.a = J.a,
            this.b = J.b,
            this.c = J.c,
            this.d = J.d,
            this.tx = J.tx,
            this.ty = J.ty,
            this
    }
    static get IDENTITY() {
        return new t6
    }
    static get TEMP_MATRIX() {
        return new t6
    }
}
var _O = O(() => {
    xZ();
    FO();
    t6.prototype.toString = function () {
        return `[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`
    }
}
);
function tu() {
    for (let J = 0; J < 16; J++) {
        let Q = [];
        EP.push(Q);
        for (let Z = 0; Z < 16; Z++) {
            let $ = RO(Z1[J] * Z1[Z] + q1[J] * $1[Z])
                , q = RO($1[J] * Z1[Z] + K1[J] * $1[Z])
                , K = RO(Z1[J] * q1[Z] + q1[J] * K1[Z])
                , V = RO($1[J] * q1[Z] + K1[J] * K1[Z]);
            for (let z = 0; z < 16; z++)
                if (Z1[z] === $ && $1[z] === q && q1[z] === K && K1[z] === V) {
                    Q.push(z);
                    break
                }
        }
    }
    for (let J = 0; J < 16; J++) {
        let Q = new t6;
        Q.set(Z1[J], $1[J], q1[J], K1[J], 0, 0),
            bv.push(Q)
    }
}
var Z1, $1, q1, K1, EP, bv, RO, N7;
var vv = O(() => {
    _O();
    Z1 = [1, 1, 0, -1, -1, -1, 0, 1, 1, 1, 0, -1, -1, -1, 0, 1],
        $1 = [0, 1, 1, 1, 0, -1, -1, -1, 0, 1, 1, 1, 0, -1, -1, -1],
        q1 = [0, -1, -1, -1, 0, 1, 1, 1, 0, 1, 1, 1, 0, -1, -1, -1],
        K1 = [1, 1, 0, -1, -1, -1, 0, 1, -1, -1, 0, 1, 1, 1, 0, -1],
        EP = [],
        bv = [],
        RO = Math.sign;
    tu();
    N7 = {
        E: 0,
        SE: 1,
        S: 2,
        SW: 3,
        W: 4,
        NW: 5,
        N: 6,
        NE: 7,
        MIRROR_VERTICAL: 8,
        MAIN_DIAGONAL: 10,
        MIRROR_HORIZONTAL: 12,
        REVERSE_DIAGONAL: 14,
        uX: (J) => Z1[J],
        uY: (J) => $1[J],
        vX: (J) => q1[J],
        vY: (J) => K1[J],
        inv: (J) => J & 8 ? J & 15 : -J & 7,
        add: (J, Q) => EP[J][Q],
        sub: (J, Q) => EP[J][N7.inv(Q)],
        rotate180: (J) => J ^ 4,
        isVertical: (J) => (J & 3) === 2,
        byDirection: (J, Q) => Math.abs(J) * 2 <= Math.abs(Q) ? Q >= 0 ? N7.S : N7.N : Math.abs(Q) * 2 <= Math.abs(J) ? J > 0 ? N7.E : N7.W : Q > 0 ? J > 0 ? N7.SE : N7.SW : J > 0 ? N7.NE : N7.NW,
        matrixAppendRotationInv: (J, Q, Z = 0, $ = 0) => {
            let q = bv[N7.inv(Q)];
            q.tx = Z,
                q.ty = $,
                J.append(q)
        }
    }
}
);
class xQ {
    constructor(J, Q, Z = 0, $ = 0) {
        this._x = Z,
            this._y = $,
            this.cb = J,
            this.scope = Q
    }
    clone(J = this.cb, Q = this.scope) {
        return new xQ(J, Q, this._x, this._y)
    }
    set(J = 0, Q = J) {
        return (this._x !== J || this._y !== Q) && (this._x = J,
            this._y = Q,
            this.cb.call(this.scope)),
            this
    }
    copyFrom(J) {
        return (this._x !== J.x || this._y !== J.y) && (this._x = J.x,
            this._y = J.y,
            this.cb.call(this.scope)),
            this
    }
    copyTo(J) {
        return J.set(this._x, this._y),
            J
    }
    equals(J) {
        return J.x === this._x && J.y === this._y
    }
    get x() {
        return this._x
    }
    set x(J) {
        this._x !== J && (this._x = J,
            this.cb.call(this.scope))
    }
    get y() {
        return this._y
    }
    set y(J) {
        this._y !== J && (this._y = J,
            this.cb.call(this.scope))
    }
}
var MP = O(() => {
    xQ.prototype.toString = function () {
        return `[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`
    }
}
);
var _P = class {
    constructor() {
        this.worldTransform = new t6,
            this.localTransform = new t6,
            this.position = new xQ(this.onChange, this, 0, 0),
            this.scale = new xQ(this.onChange, this, 1, 1),
            this.pivot = new xQ(this.onChange, this, 0, 0),
            this.skew = new xQ(this.updateSkew, this, 0, 0),
            this._rotation = 0,
            this._cx = 1,
            this._sx = 0,
            this._cy = 0,
            this._sy = 1,
            this._localID = 0,
            this._currentLocalID = 0,
            this._worldID = 0,
            this._parentID = 0
    }
    onChange() {
        this._localID++
    }
    updateSkew() {
        this._cx = Math.cos(this._rotation + this.skew.y),
            this._sx = Math.sin(this._rotation + this.skew.y),
            this._cy = -Math.sin(this._rotation - this.skew.x),
            this._sy = Math.cos(this._rotation - this.skew.x),
            this._localID++
    }
    updateLocalTransform() {
        let J = this.localTransform;
        this._localID !== this._currentLocalID && (J.a = this._cx * this.scale.x,
            J.b = this._sx * this.scale.x,
            J.c = this._cy * this.scale.y,
            J.d = this._sy * this.scale.y,
            J.tx = this.position.x - (this.pivot.x * J.a + this.pivot.y * J.c),
            J.ty = this.position.y - (this.pivot.x * J.b + this.pivot.y * J.d),
            this._currentLocalID = this._localID,
            this._parentID = -1)
    }
    updateTransform(J) {
        let Q = this.localTransform;
        if (this._localID !== this._currentLocalID && (Q.a = this._cx * this.scale.x,
            Q.b = this._sx * this.scale.x,
            Q.c = this._cy * this.scale.y,
            Q.d = this._sy * this.scale.y,
            Q.tx = this.position.x - (this.pivot.x * Q.a + this.pivot.y * Q.c),
            Q.ty = this.position.y - (this.pivot.x * Q.b + this.pivot.y * Q.d),
            this._currentLocalID = this._localID,
            this._parentID = -1),
            this._parentID !== J._worldID) {
            let Z = J.worldTransform
                , $ = this.worldTransform;
            $.a = Q.a * Z.a + Q.b * Z.c,
                $.b = Q.a * Z.b + Q.b * Z.d,
                $.c = Q.c * Z.a + Q.d * Z.c,
                $.d = Q.c * Z.b + Q.d * Z.d,
                $.tx = Q.tx * Z.a + Q.ty * Z.c + Z.tx,
                $.ty = Q.tx * Z.b + Q.ty * Z.d + Z.ty,
                this._parentID = J._worldID,
                this._worldID++
        }
    }
    setFromMatrix(J) {
        J.decompose(this),
            this._localID++
    }
    get rotation() {
        return this._rotation
    }
    set rotation(J) {
        this._rotation !== J && (this._rotation = J,
            this.updateSkew())
    }
}
    , bO;
var Sv = O(() => {
    _O();
    MP();
    _P.IDENTITY = new _P;
    bO = _P;
    bO.prototype.toString = function () {
        return `[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`
    }
}
);
var TJ = O(() => {
    Ev();
    Mv();
    _v();
    PO();
    Rv();
    vv();
    _O();
    MP();
    FO();
    Sv();
    xZ()
}
);
var Tv = `varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`;
var yv = () => { }
    ;
var fv = `attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;
var hv = () => { }
    ;
function vO(J, Q, Z) {
    let $ = J.createShader(Q);
    return J.shaderSource($, Z),
        J.compileShader($),
        $
}
var RP = () => { }
    ;
function bP(J) {
    let Q = new Array(J);
    for (let Z = 0; Z < Q.length; Z++)
        Q[Z] = !1;
    return Q
}
function bH(J, Q) {
    switch (J) {
        case "float":
            return 0;
        case "vec2":
            return new Float32Array(2 * Q);
        case "vec3":
            return new Float32Array(3 * Q);
        case "vec4":
            return new Float32Array(4 * Q);
        case "int":
        case "uint":
        case "sampler2D":
        case "sampler2DArray":
            return 0;
        case "ivec2":
            return new Int32Array(2 * Q);
        case "ivec3":
            return new Int32Array(3 * Q);
        case "ivec4":
            return new Int32Array(4 * Q);
        case "uvec2":
            return new Uint32Array(2 * Q);
        case "uvec3":
            return new Uint32Array(3 * Q);
        case "uvec4":
            return new Uint32Array(4 * Q);
        case "bool":
            return !1;
        case "bvec2":
            return bP(2 * Q);
        case "bvec3":
            return bP(3 * Q);
        case "bvec4":
            return bP(4 * Q);
        case "mat2":
            return new Float32Array([1, 0, 0, 1]);
        case "mat3":
            return new Float32Array([1, 0, 0, 0, 1, 0, 0, 0, 1]);
        case "mat4":
            return new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1])
    }
    return null
}
var SO = () => { }
    ;
var i9;
var vH = O(() => {
    i9 = [{
        test: (J) => J.type === "float" && J.size === 1 && !J.isArray,
        code: (J) => `
            if(uv["${J}"] !== ud["${J}"].value)
            {
                ud["${J}"].value = uv["${J}"]
                gl.uniform1f(ud["${J}"].location, uv["${J}"])
            }
            `
    }, {
        test: (J, Q) => (J.type === "sampler2D" || J.type === "samplerCube" || J.type === "sampler2DArray") && J.size === 1 && !J.isArray && (Q == null || Q.castToBaseTexture !== void 0),
        code: (J) => `t = syncData.textureCount++;

            renderer.texture.bind(uv["${J}"], t);

            if(ud["${J}"].value !== t)
            {
                ud["${J}"].value = t;
                gl.uniform1i(ud["${J}"].location, t);
; // eslint-disable-line max-len
            }`
    }, {
        test: (J, Q) => J.type === "mat3" && J.size === 1 && !J.isArray && Q.a !== void 0,
        code: (J) => `
            gl.uniformMatrix3fv(ud["${J}"].location, false, uv["${J}"].toArray(true));
            `,
        codeUbo: (J) => `
                var ${J}_matrix = uv.${J}.toArray(true);

                data[offset] = ${J}_matrix[0];
                data[offset+1] = ${J}_matrix[1];
                data[offset+2] = ${J}_matrix[2];
        
                data[offset + 4] = ${J}_matrix[3];
                data[offset + 5] = ${J}_matrix[4];
                data[offset + 6] = ${J}_matrix[5];
        
                data[offset + 8] = ${J}_matrix[6];
                data[offset + 9] = ${J}_matrix[7];
                data[offset + 10] = ${J}_matrix[8];
            `
    }, {
        test: (J, Q) => J.type === "vec2" && J.size === 1 && !J.isArray && Q.x !== void 0,
        code: (J) => `
                cv = ud["${J}"].value;
                v = uv["${J}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${J}"].location, v.x, v.y);
                }`,
        codeUbo: (J) => `
                v = uv.${J};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `
    }, {
        test: (J) => J.type === "vec2" && J.size === 1 && !J.isArray,
        code: (J) => `
                cv = ud["${J}"].value;
                v = uv["${J}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${J}"].location, v[0], v[1]);
                }
            `
    }, {
        test: (J, Q) => J.type === "vec4" && J.size === 1 && !J.isArray && Q.width !== void 0,
        code: (J) => `
                cv = ud["${J}"].value;
                v = uv["${J}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${J}"].location, v.x, v.y, v.width, v.height)
                }`,
        codeUbo: (J) => `
                    v = uv.${J};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `
    }, {
        test: (J, Q) => J.type === "vec4" && J.size === 1 && !J.isArray && Q.red !== void 0,
        code: (J) => `
                cv = ud["${J}"].value;
                v = uv["${J}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${J}"].location, v.red, v.green, v.blue, v.alpha)
                }`,
        codeUbo: (J) => `
                    v = uv.${J};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `
    }, {
        test: (J, Q) => J.type === "vec3" && J.size === 1 && !J.isArray && Q.red !== void 0,
        code: (J) => `
                cv = ud["${J}"].value;
                v = uv["${J}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${J}"].location, v.red, v.green, v.blue)
                }`,
        codeUbo: (J) => `
                    v = uv.${J};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `
    }, {
        test: (J) => J.type === "vec4" && J.size === 1 && !J.isArray,
        code: (J) => `
                cv = ud["${J}"].value;
                v = uv["${J}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${J}"].location, v[0], v[1], v[2], v[3])
                }`
    }]
}
);
function vP(J, Q) {
    let Z = [`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];
    for (let $ in J.uniforms) {
        let q = Q[$];
        if (!q) {
            J.uniforms[$]?.group === !0 && (J.uniforms[$].ubo ? Z.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${$}, '${$}');
                    `) : Z.push(`
                        renderer.shader.syncUniformGroup(uv.${$}, syncData);
                    `));
            continue
        }
        let K = J.uniforms[$]
            , V = !1;
        for (let z = 0; z < i9.length; z++)
            if (i9[z].test(q, K)) {
                Z.push(i9[z].code($, K)),
                    V = !0;
                break
            }
        if (!V) {
            let z = (q.size === 1 && !q.isArray ? eu : Jl)[q.type].replace("location", `ud["${$}"].location`);
            Z.push(`
            cu = ud["${$}"];
            cv = cu.value;
            v = uv["${$}"];
            ${z};`)
        }
    }
    return new Function("ud", "uv", "renderer", "syncData", Z.join(`
`))
}
var eu, Jl;
var SP = O(() => {
    vH();
    eu = {
        float: `
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,
        vec2: `
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,
        vec3: `
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,
        vec4: `
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,
        int: `
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,
        ivec2: `
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,
        ivec3: `
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,
        ivec4: `
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,
        uint: `
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,
        uvec2: `
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,
        uvec3: `
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,
        uvec4: `
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,
        bool: `
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,
        bvec2: `
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,
        bvec3: `
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,
        bvec4: `
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,
        mat2: "gl.uniformMatrix2fv(location, false, v)",
        mat3: "gl.uniformMatrix3fv(location, false, v)",
        mat4: "gl.uniformMatrix4fv(location, false, v)",
        sampler2D: `
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,
        samplerCube: `
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,
        sampler2DArray: `
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`
    },
        Jl = {
            float: "gl.uniform1fv(location, v)",
            vec2: "gl.uniform2fv(location, v)",
            vec3: "gl.uniform3fv(location, v)",
            vec4: "gl.uniform4fv(location, v)",
            mat4: "gl.uniformMatrix4fv(location, false, v)",
            mat3: "gl.uniformMatrix3fv(location, false, v)",
            mat2: "gl.uniformMatrix2fv(location, false, v)",
            int: "gl.uniform1iv(location, v)",
            ivec2: "gl.uniform2iv(location, v)",
            ivec3: "gl.uniform3iv(location, v)",
            ivec4: "gl.uniform4iv(location, v)",
            uint: "gl.uniform1uiv(location, v)",
            uvec2: "gl.uniform2uiv(location, v)",
            uvec3: "gl.uniform3uiv(location, v)",
            uvec4: "gl.uniform4uiv(location, v)",
            bool: "gl.uniform1iv(location, v)",
            bvec2: "gl.uniform2iv(location, v)",
            bvec3: "gl.uniform3iv(location, v)",
            bvec4: "gl.uniform4iv(location, v)",
            sampler2D: "gl.uniform1iv(location, v)",
            samplerCube: "gl.uniform1iv(location, v)",
            sampler2DArray: "gl.uniform1iv(location, v)"
        }
}
);
function yO() {
    if (TO === xv || TO?.isContextLost()) {
        let J = L8.ADAPTER.createCanvas(), Q;
        L8.PREFER_ENV >= O5.WEBGL2 && (Q = J.getContext("webgl2", {})),
            Q || (Q = J.getContext("webgl", {}) || J.getContext("experimental-webgl", {}),
                Q ? Q.getExtension("WEBGL_draw_buffers") : Q = null),
            TO = Q
    }
    return TO
}
var xv, TO;
var fO = O(() => {
    l8();
    $7();
    xv = {},
        TO = xv
}
);
function TP() {
    if (!hO) {
        hO = iJ.MEDIUM;
        let J = yO();
        if (J && J.getShaderPrecisionFormat) {
            let Q = J.getShaderPrecisionFormat(J.FRAGMENT_SHADER, J.HIGH_FLOAT);
            Q && (hO = Q.precision ? iJ.HIGH : iJ.MEDIUM)
        }
    }
    return hO
}
var hO;
var yP = O(() => {
    l8();
    fO()
}
);
function gv(J, Q) {
    let Z = J.getShaderSource(Q).split(`
`).map((H, Y) => `${Y}: ${H}`)
        , $ = J.getShaderInfoLog(Q)
        , q = $.split(`
`)
        , K = {}
        , V = q.map((H) => parseFloat(H.replace(/^ERROR\: 0\:([\d]+)\:.*$/, "$1"))).filter((H) => H && !K[H] ? (K[H] = !0,
            !0) : !1)
        , z = [""];
    V.forEach((H) => {
        Z[H - 1] = `%c${Z[H - 1]}%c`,
            z.push("background: #FF0000; color:#FFFFFF; font-size: 10px", "font-size: 10px")
    }
    );
    let W = Z.join(`
`);
    z[0] = W
}
function fP(J, Q, Z, $) {
    J.getProgramParameter(Q, J.LINK_STATUS) || (J.getShaderParameter(Z, J.COMPILE_STATUS) || gv(J, Z),
        J.getShaderParameter($, J.COMPILE_STATUS) || gv(J, $),
        J.getProgramInfoLog(Q))
}
var hP = () => { }
    ;
function SH(J) {
    return Ql[J]
}
var Ql;
var xO = O(() => {
    Ql = {
        float: 1,
        vec2: 2,
        vec3: 3,
        vec4: 4,
        int: 1,
        ivec2: 2,
        ivec3: 3,
        ivec4: 4,
        uint: 1,
        uvec2: 2,
        uvec3: 3,
        uvec4: 4,
        bool: 1,
        bvec2: 2,
        bvec3: 3,
        bvec4: 4,
        mat2: 4,
        mat3: 9,
        mat4: 16,
        sampler2D: 1
    }
}
);
function TH(J, Q) {
    if (!gO) {
        let Z = Object.keys(mv);
        gO = {};
        for (let $ = 0; $ < Z.length; ++$) {
            let q = Z[$];
            gO[J[q]] = mv[q]
        }
    }
    return gO[Q]
}
var gO = null, mv;
var mO = O(() => {
    mv = {
        FLOAT: "float",
        FLOAT_VEC2: "vec2",
        FLOAT_VEC3: "vec3",
        FLOAT_VEC4: "vec4",
        INT: "int",
        INT_VEC2: "ivec2",
        INT_VEC3: "ivec3",
        INT_VEC4: "ivec4",
        UNSIGNED_INT: "uint",
        UNSIGNED_INT_VEC2: "uvec2",
        UNSIGNED_INT_VEC3: "uvec3",
        UNSIGNED_INT_VEC4: "uvec4",
        BOOL: "bool",
        BOOL_VEC2: "bvec2",
        BOOL_VEC3: "bvec3",
        BOOL_VEC4: "bvec4",
        FLOAT_MAT2: "mat2",
        FLOAT_MAT3: "mat3",
        FLOAT_MAT4: "mat4",
        SAMPLER_2D: "sampler2D",
        INT_SAMPLER_2D: "sampler2D",
        UNSIGNED_INT_SAMPLER_2D: "sampler2D",
        SAMPLER_CUBE: "samplerCube",
        INT_SAMPLER_CUBE: "samplerCube",
        UNSIGNED_INT_SAMPLER_CUBE: "samplerCube",
        SAMPLER_2D_ARRAY: "sampler2DArray",
        INT_SAMPLER_2D_ARRAY: "sampler2DArray",
        UNSIGNED_INT_SAMPLER_2D_ARRAY: "sampler2DArray"
    }
}
);
function cO(J, Q, Z) {
    if (J.substring(0, 9) !== "precision") {
        let $ = Q;
        return Q === iJ.HIGH && Z !== iJ.HIGH && ($ = iJ.MEDIUM),
            `precision ${$} float;
${J}`
    } else if (Z !== iJ.HIGH && J.substring(0, 15) === "precision highp")
        return J.replace("precision highp", "precision mediump");
    return J
}
var xP = O(() => {
    l8()
}
);
function dO() {
    if (typeof yH == "boolean")
        return yH;
    try {
        yH = new Function("param1", "param2", "param3", "return param1[param2] === param3;")({
            a: "b"
        }, "a", "b") === !0
    } catch {
        yH = !1
    }
    return yH
}
var yH;
var pO = () => { }
    ;
var uO = O(() => {
    CO();
    RP();
    SO();
    SP();
    yP();
    fO();
    hP();
    xO();
    mO();
    xP();
    vH();
    pO()
}
);
var Zl = 0, lO, gP = class J {
    constructor(Q, Z, $ = "pixi-shader", q = {}) {
        this.extra = {},
            this.id = Zl++,
            this.vertexSrc = Q || J.defaultVertexSrc,
            this.fragmentSrc = Z || J.defaultFragmentSrc,
            this.vertexSrc = this.vertexSrc.trim(),
            this.fragmentSrc = this.fragmentSrc.trim(),
            this.extra = q,
            this.vertexSrc.substring(0, 8) !== "#version" && ($ = $.replace(/\s+/g, "-"),
                lO[$] ? (lO[$]++,
                    $ += `-${lO[$]}`) : lO[$] = 1,
                this.vertexSrc = `#define SHADER_NAME ${$}
${this.vertexSrc}`,
                this.fragmentSrc = `#define SHADER_NAME ${$}
${this.fragmentSrc}`,
                this.vertexSrc = cO(this.vertexSrc, J.defaultVertexPrecision, iJ.HIGH),
                this.fragmentSrc = cO(this.fragmentSrc, J.defaultFragmentPrecision, TP())),
            this.glPrograms = {},
            this.syncUniforms = null
    }
    static get defaultVertexSrc() {
        return fv
    }
    static get defaultFragmentSrc() {
        return Tv
    }
    static from(Q, Z, $) {
        let q = Q + Z
            , K = wO[q];
        return K || (wO[q] = K = new J(Q, Z, $)),
            K
    }
}
    , c5;
var E4 = O(() => {
    l8();
    OJ();
    yv();
    hv();
    uO();
    xP();
    yP();
    lO = {};
    gP.defaultVertexPrecision = iJ.HIGH,
        gP.defaultFragmentPrecision = N9.apple.device ? iJ.HIGH : iJ.MEDIUM;
    c5 = gP
}
);
class rJ {
    constructor(J, Q, Z) {
        this.group = !0,
            this.syncUniforms = {},
            this.dirtyId = 0,
            this.id = $l++,
            this.static = !!Q,
            this.ubo = !!Z,
            J instanceof r7 ? (this.buffer = J,
                this.buffer.type = H5.UNIFORM_BUFFER,
                this.autoManage = !1,
                this.ubo = !0) : (this.uniforms = J,
                    this.ubo && (this.buffer = new r7(new Float32Array(1)),
                        this.buffer.type = H5.UNIFORM_BUFFER,
                        this.autoManage = !0))
    }
    update() {
        this.dirtyId++,
            !this.autoManage && this.buffer && this.buffer.update()
    }
    add(J, Q, Z) {
        if (!this.ubo)
            this.uniforms[J] = new rJ(Q, Z);
        else
            throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")
    }
    static from(J, Q, Z) {
        return new rJ(J, Q, Z)
    }
    static uboFrom(J, Q) {
        return new rJ(J, Q ?? !0, !0)
    }
}
var $l = 0;
var M4 = O(() => {
    l8();
    D4()
}
);
class V1 {
    constructor(J, Q) {
        this.uniformBindCount = 0,
            this.program = J,
            Q ? Q instanceof rJ ? this.uniformGroup = Q : this.uniformGroup = new rJ(Q) : this.uniformGroup = new rJ({}),
            this.disposeRunner = new a7("disposeShader")
    }
    checkUniformExists(J, Q) {
        if (Q.uniforms[J])
            return !0;
        for (let Z in Q.uniforms) {
            let $ = Q.uniforms[Z];
            if ($.group === !0 && this.checkUniformExists(J, $))
                return !0
        }
        return !1
    }
    destroy() {
        this.uniformGroup = null,
            this.disposeRunner.emit(this),
            this.disposeRunner.destroy()
    }
    get uniforms() {
        return this.uniformGroup.uniforms
    }
    static from(J, Q, Z) {
        let $ = c5.from(J, Q);
        return new V1($, Z)
    }
}
var oO = O(() => {
    fQ();
    E4();
    M4()
}
);
class nO {
    constructor(J, Q) {
        if (this.vertexSrc = J,
            this.fragTemplate = Q,
            this.programCache = {},
            this.defaultGroupCache = {},
            !Q.includes("%count%"))
            throw new Error('Fragment template must contain "%count%".');
        if (!Q.includes("%forloop%"))
            throw new Error('Fragment template must contain "%forloop%".')
    }
    generateShader(J) {
        if (!this.programCache[J]) {
            let Z = new Int32Array(J);
            for (let q = 0; q < J; q++)
                Z[q] = q;
            this.defaultGroupCache[J] = rJ.from({
                uSamplers: Z
            }, !0);
            let $ = this.fragTemplate;
            $ = $.replace(/%count%/gi, `${J}`),
                $ = $.replace(/%forloop%/gi, this.generateSampleSrc(J)),
                this.programCache[J] = new c5(this.vertexSrc, $)
        }
        let Q = {
            tint: new Float32Array([1, 1, 1, 1]),
            translationMatrix: new t6,
            default: this.defaultGroupCache[J]
        };
        return new V1(this.programCache[J], Q)
    }
    generateSampleSrc(J) {
        let Q = "";
        Q += `
`,
            Q += `
`;
        for (let Z = 0; Z < J; Z++)
            Z > 0 && (Q += `
else `),
                Z < J - 1 && (Q += `if(vTextureId < ${Z}.5)`),
                Q += `
{`,
                Q += `
	color = texture2D(uSamplers[${Z}], vTextureCoord);`,
                Q += `
}`;
        return Q += `
`,
            Q += `
`,
            Q
    }
}
var mP = O(() => {
    TJ();
    E4();
    oO();
    M4()
}
);
class sO {
    constructor() {
        this.elements = [],
            this.ids = [],
            this.count = 0
    }
    clear() {
        for (let J = 0; J < this.count; J++)
            this.elements[J] = null;
        this.count = 0
    }
}
var cP = () => { }
    ;
function cv() {
    return !N9.apple.device
}
var dv = O(() => {
    $7()
}
);
function pv(J) {
    let Q = !0
        , Z = L8.ADAPTER.getNavigator();
    if (N9.tablet || N9.phone) {
        if (N9.apple.device) {
            let $ = Z.userAgent.match(/OS (\d+)_(\d+)?/);
            $ && parseInt($[1], 10) < 11 && (Q = !1)
        }
        if (N9.android.device) {
            let $ = Z.userAgent.match(/Android\s([0-9.]*)/);
            $ && parseInt($[1], 10) < 7 && (Q = !1)
        }
    }
    return Q ? J : 4
}
var uv = O(() => {
    $7()
}
);
class _4 {
    constructor(J) {
        this.renderer = J
    }
    flush() { }
    destroy() {
        this.renderer = null
    }
    start() { }
    stop() {
        this.flush()
    }
    render(J) { }
}
var iO = () => { }
    ;
var lv = `varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`;
var ov = () => { }
    ;
var nv = `precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;
var sv = () => { }
    ;
var fH, gQ;
var dP = O(() => {
    hZ();
    l8();
    r6();
    $7();
    OJ();
    jP();
    CO();
    MH();
    hQ();
    GP();
    DP();
    mP();
    cP();
    dv();
    uv();
    iO();
    ov();
    sv();
    fH = class J extends _4 {
        constructor(Q) {
            super(Q),
                this.setShaderGenerator(),
                this.geometryClass = LO,
                this.vertexSize = 6,
                this.state = n9.for2d(),
                this.size = J.defaultBatchSize * 4,
                this._vertexCount = 0,
                this._indexCount = 0,
                this._bufferedElements = [],
                this._bufferedTextures = [],
                this._bufferSize = 0,
                this._shader = null,
                this._packedGeometries = [],
                this._packedGeometryPoolSize = 2,
                this._flushId = 0,
                this._aBuffers = {},
                this._iBuffers = {},
                this.maxTextures = 1,
                this.renderer.on("prerender", this.onPrerender, this),
                Q.runners.contextChange.add(this),
                this._dcIndex = 0,
                this._aIndex = 0,
                this._iIndex = 0,
                this._attributeBuffer = null,
                this._indexBuffer = null,
                this._tempBoundTextures = []
        }
        static get defaultMaxTextures() {
            return this._defaultMaxTextures = this._defaultMaxTextures ?? pv(32),
                this._defaultMaxTextures
        }
        static set defaultMaxTextures(Q) {
            this._defaultMaxTextures = Q
        }
        static get canUploadSameBuffer() {
            return this._canUploadSameBuffer = this._canUploadSameBuffer ?? cv(),
                this._canUploadSameBuffer
        }
        static set canUploadSameBuffer(Q) {
            this._canUploadSameBuffer = Q
        }
        get MAX_TEXTURES() {
            return j6("7.1.0", "BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),
                this.maxTextures
        }
        static get defaultVertexSrc() {
            return nv
        }
        static get defaultFragmentTemplate() {
            return lv
        }
        setShaderGenerator({ vertex: Q = J.defaultVertexSrc, fragment: Z = J.defaultFragmentTemplate } = {}) {
            this.shaderGenerator = new nO(Q, Z)
        }
        contextChange() {
            let Q = this.renderer.gl;
            L8.PREFER_ENV === O5.WEBGL_LEGACY ? this.maxTextures = 1 : (this.maxTextures = Math.min(Q.getParameter(Q.MAX_TEXTURE_IMAGE_UNITS), J.defaultMaxTextures),
                this.maxTextures = kO(this.maxTextures, Q)),
                this._shader = this.shaderGenerator.generateShader(this.maxTextures);
            for (let Z = 0; Z < this._packedGeometryPoolSize; Z++)
                this._packedGeometries[Z] = new this.geometryClass;
            this.initFlushBuffers()
        }
        initFlushBuffers() {
            let { _drawCallPool: Q, _textureArrayPool: Z } = J
                , $ = this.size / 4
                , q = Math.floor($ / this.maxTextures) + 1;
            for (; Q.length < $;)
                Q.push(new IO);
            for (; Z.length < q;)
                Z.push(new sO);
            for (let K = 0; K < this.maxTextures; K++)
                this._tempBoundTextures[K] = null
        }
        onPrerender() {
            this._flushId = 0
        }
        render(Q) {
            Q._texture.valid && (this._vertexCount + Q.vertexData.length / 2 > this.size && this.flush(),
                this._vertexCount += Q.vertexData.length / 2,
                this._indexCount += Q.indices.length,
                this._bufferedTextures[this._bufferSize] = Q._texture.baseTexture,
                this._bufferedElements[this._bufferSize++] = Q)
        }
        buildTexturesAndDrawCalls() {
            let { _bufferedTextures: Q, maxTextures: Z } = this
                , $ = J._textureArrayPool
                , q = this.renderer.batch
                , K = this._tempBoundTextures
                , V = this.renderer.textureGC.count
                , z = ++L6._globalBatch
                , W = 0
                , H = $[0]
                , Y = 0;
            q.copyBoundTextures(K, Z);
            for (let U = 0; U < this._bufferSize; ++U) {
                let N = Q[U];
                Q[U] = null,
                    N._batchEnabled !== z && (H.count >= Z && (q.boundArray(H, K, z, Z),
                        this.buildDrawCalls(H, Y, U),
                        Y = U,
                        H = $[++W],
                        ++z),
                        N._batchEnabled = z,
                        N.touched = V,
                        H.elements[H.count++] = N)
            }
            H.count > 0 && (q.boundArray(H, K, z, Z),
                this.buildDrawCalls(H, Y, this._bufferSize),
                ++W,
                ++z);
            for (let U = 0; U < K.length; U++)
                K[U] = null;
            L6._globalBatch = z
        }
        buildDrawCalls(Q, Z, $) {
            let { _bufferedElements: q, _attributeBuffer: K, _indexBuffer: V, vertexSize: z } = this
                , W = J._drawCallPool
                , H = this._dcIndex
                , Y = this._aIndex
                , U = this._iIndex
                , N = W[H];
            N.start = this._iIndex,
                N.texArray = Q;
            for (let j = Z; j < $; ++j) {
                let k = q[j]
                    , L = k._texture.baseTexture
                    , F = zP[L.alphaMode ? 1 : 0][k.blendMode];
                q[j] = null,
                    Z < j && N.blend !== F && (N.size = U - N.start,
                        Z = j,
                        N = W[++H],
                        N.texArray = Q,
                        N.start = U),
                    this.packInterleavedGeometry(k, K, V, Y, U),
                    Y += k.vertexData.length / 2 * z,
                    U += k.indices.length,
                    N.blend = F
            }
            Z < $ && (N.size = U - N.start,
                ++H),
                this._dcIndex = H,
                this._aIndex = Y,
                this._iIndex = U
        }
        bindAndClearTexArray(Q) {
            let Z = this.renderer.texture;
            for (let $ = 0; $ < Q.count; $++)
                Z.bind(Q.elements[$], Q.ids[$]),
                    Q.elements[$] = null;
            Q.count = 0
        }
        updateGeometry() {
            let { _packedGeometries: Q, _attributeBuffer: Z, _indexBuffer: $ } = this;
            J.canUploadSameBuffer ? (Q[this._flushId]._buffer.update(Z.rawBinaryData),
                Q[this._flushId]._indexBuffer.update($),
                this.renderer.geometry.updateBuffers()) : (this._packedGeometryPoolSize <= this._flushId && (this._packedGeometryPoolSize++,
                    Q[this._flushId] = new this.geometryClass),
                    Q[this._flushId]._buffer.update(Z.rawBinaryData),
                    Q[this._flushId]._indexBuffer.update($),
                    this.renderer.geometry.bind(Q[this._flushId]),
                    this.renderer.geometry.updateBuffers(),
                    this._flushId++)
        }
        drawBatches() {
            let Q = this._dcIndex
                , { gl: Z, state: $ } = this.renderer
                , q = J._drawCallPool
                , K = null;
            for (let V = 0; V < Q; V++) {
                let { texArray: z, type: W, size: H, start: Y, blend: U } = q[V];
                K !== z && (K = z,
                    this.bindAndClearTexArray(z)),
                    this.state.blendMode = U,
                    $.set(this.state),
                    Z.drawElements(W, H, Z.UNSIGNED_SHORT, Y * 2)
            }
        }
        flush() {
            this._vertexCount !== 0 && (this._attributeBuffer = this.getAttributeBuffer(this._vertexCount),
                this._indexBuffer = this.getIndexBuffer(this._indexCount),
                this._aIndex = 0,
                this._iIndex = 0,
                this._dcIndex = 0,
                this.buildTexturesAndDrawCalls(),
                this.updateGeometry(),
                this.drawBatches(),
                this._bufferSize = 0,
                this._vertexCount = 0,
                this._indexCount = 0)
        }
        start() {
            this.renderer.state.set(this.state),
                this.renderer.texture.ensureSamplerType(this.maxTextures),
                this.renderer.shader.bind(this._shader),
                J.canUploadSameBuffer && this.renderer.geometry.bind(this._packedGeometries[this._flushId])
        }
        stop() {
            this.flush()
        }
        destroy() {
            for (let Q = 0; Q < this._packedGeometryPoolSize; Q++)
                this._packedGeometries[Q] && this._packedGeometries[Q].destroy();
            this.renderer.off("prerender", this.onPrerender, this),
                this._aBuffers = null,
                this._iBuffers = null,
                this._packedGeometries = null,
                this._attributeBuffer = null,
                this._indexBuffer = null,
                this._shader && (this._shader.destroy(),
                    this._shader = null),
                super.destroy()
        }
        getAttributeBuffer(Q) {
            let Z = e$(Math.ceil(Q / 8))
                , $ = NO(Z)
                , q = Z * 8;
            this._aBuffers.length <= $ && (this._iBuffers.length = $ + 1);
            let K = this._aBuffers[q];
            return K || (this._aBuffers[q] = K = new BO(q * this.vertexSize * 4)),
                K
        }
        getIndexBuffer(Q) {
            let Z = e$(Math.ceil(Q / 12))
                , $ = NO(Z)
                , q = Z * 12;
            this._iBuffers.length <= $ && (this._iBuffers.length = $ + 1);
            let K = this._iBuffers[$];
            return K || (this._iBuffers[$] = K = new Uint16Array(q)),
                K
        }
        packInterleavedGeometry(Q, Z, $, q, K) {
            let { uint32View: V, float32View: z } = Z
                , W = q / this.vertexSize
                , H = Q.uvs
                , Y = Q.indices
                , U = Q.vertexData
                , N = Q._texture.baseTexture._batchLocation
                , j = Math.min(Q.worldAlpha, 1)
                , k = w9.shared.setValue(Q._tintRGB).toPremultiplied(j, Q._texture.baseTexture.alphaMode > 0);
            for (let L = 0; L < U.length; L += 2)
                z[q++] = U[L],
                    z[q++] = U[L + 1],
                    z[q++] = H[L],
                    z[q++] = H[L + 1],
                    V[q++] = k,
                    z[q++] = N;
            for (let L = 0; L < Y.length; L++)
                $[K++] = W + Y[L]
        }
    }
        ;
    fH.defaultBatchSize = 4096,
        fH.extension = {
            name: "batch",
            type: B8.RendererPlugin
        },
        fH._drawCallPool = [],
        fH._textureArrayPool = [];
    gQ = fH;
    F8.add(gQ)
}
);
var iv = `varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`;
var av = () => { }
    ;
var rv = `attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;
var tv = () => { }
    ;
var pP, d5;
var hH = O(() => {
    l8();
    E4();
    oO();
    MH();
    av();
    tv();
    pP = class J extends V1 {
        constructor(Q, Z, $) {
            let q = c5.from(Q || J.defaultVertexSrc, Z || J.defaultFragmentSrc);
            super(q, $),
                this.padding = 0,
                this.resolution = J.defaultResolution,
                this.multisample = J.defaultMultisample,
                this.enabled = !0,
                this.autoFit = !0,
                this.state = new n9
        }
        apply(Q, Z, $, q, K) {
            Q.applyFilter(this, Z, $, q)
        }
        get blendMode() {
            return this.state.blendMode
        }
        set blendMode(Q) {
            this.state.blendMode = Q
        }
        get resolution() {
            return this._resolution
        }
        set resolution(Q) {
            this._resolution = Q
        }
        static get defaultVertexSrc() {
            return rv
        }
        static get defaultFragmentSrc() {
            return iv
        }
    }
        ;
    pP.defaultResolution = 1,
        pP.defaultMultisample = a6.NONE;
    d5 = pP
}
);
class gZ {
    constructor() {
        this.clearBeforeRender = !0,
            this._backgroundColor = new w9(0),
            this.alpha = 1
    }
    init(J) {
        this.clearBeforeRender = J.clearBeforeRender;
        let { backgroundColor: Q, background: Z, backgroundAlpha: $ } = J
            , q = Z ?? Q;
        q !== void 0 && (this.color = q),
            this.alpha = $
    }
    get color() {
        return this._backgroundColor.value
    }
    set color(J) {
        this._backgroundColor.setValue(J)
    }
    get alpha() {
        return this._backgroundColor.alpha
    }
    set alpha(J) {
        this._backgroundColor.setAlpha(J)
    }
    get backgroundColor() {
        return this._backgroundColor
    }
    destroy() { }
}
var aO = O(() => {
    hZ();
    r6();
    gZ.defaultOptions = {
        backgroundAlpha: 1,
        backgroundColor: 0,
        clearBeforeRender: !0
    },
        gZ.extension = {
            type: [B8.RendererSystem, B8.CanvasRendererSystem],
            name: "background"
        };
    F8.add(gZ)
}
);
class xH {
    constructor(J) {
        this.renderer = J,
            this.emptyRenderer = new _4(J),
            this.currentRenderer = this.emptyRenderer
    }
    setObjectRenderer(J) {
        this.currentRenderer !== J && (this.currentRenderer.stop(),
            this.currentRenderer = J,
            this.currentRenderer.start())
    }
    flush() {
        this.setObjectRenderer(this.emptyRenderer)
    }
    reset() {
        this.setObjectRenderer(this.emptyRenderer)
    }
    copyBoundTextures(J, Q) {
        let { boundTextures: Z } = this.renderer.texture;
        for (let $ = Q - 1; $ >= 0; --$)
            J[$] = Z[$] || null,
                J[$] && (J[$]._batchLocation = $)
    }
    boundArray(J, Q, Z, $) {
        let { elements: q, ids: K, count: V } = J
            , z = 0;
        for (let W = 0; W < V; W++) {
            let H = q[W]
                , Y = H._batchLocation;
            if (Y >= 0 && Y < $ && Q[Y] === H) {
                K[W] = Y;
                continue
            }
            for (; z < $;) {
                let U = Q[z];
                if (U && U._batchEnabled === Z && U._batchLocation === z) {
                    z++;
                    continue
                }
                K[W] = z,
                    H._batchLocation = z,
                    Q[z] = H;
                break
            }
        }
    }
    destroy() {
        this.renderer = null
    }
}
var uP = O(() => {
    r6();
    iO();
    xH.extension = {
        type: B8.RendererSystem,
        name: "batch"
    };
    F8.add(xH)
}
);
class mZ {
    constructor(J) {
        this.renderer = J,
            this.webGLVersion = 1,
            this.extensions = {},
            this.supports = {
                uint32Indices: !1
            },
            this.handleContextLost = this.handleContextLost.bind(this),
            this.handleContextRestored = this.handleContextRestored.bind(this)
    }
    get isLost() {
        return !this.gl || this.gl.isContextLost()
    }
    contextChange(J) {
        this.gl = J,
            this.renderer.gl = J,
            this.renderer.CONTEXT_UID = ev++
    }
    init(J) {
        if (J.context)
            this.initFromContext(J.context);
        else {
            let Q = this.renderer.background.alpha < 1
                , Z = J.premultipliedAlpha;
            this.preserveDrawingBuffer = J.preserveDrawingBuffer,
                this.useContextAlpha = J.useContextAlpha,
                this.powerPreference = J.powerPreference,
                this.initFromOptions({
                    alpha: Q,
                    premultipliedAlpha: Z,
                    antialias: J.antialias,
                    stencil: !0,
                    preserveDrawingBuffer: J.preserveDrawingBuffer,
                    powerPreference: J.powerPreference
                })
        }
    }
    initFromContext(J) {
        this.gl = J,
            this.validateContext(J),
            this.renderer.gl = J,
            this.renderer.CONTEXT_UID = ev++,
            this.renderer.runners.contextChange.emit(J);
        let Q = this.renderer.view;
        Q.addEventListener !== void 0 && (Q.addEventListener("webglcontextlost", this.handleContextLost, !1),
            Q.addEventListener("webglcontextrestored", this.handleContextRestored, !1))
    }
    initFromOptions(J) {
        let Q = this.createContext(this.renderer.view, J);
        this.initFromContext(Q)
    }
    createContext(J, Q) {
        let Z;
        if (L8.PREFER_ENV >= O5.WEBGL2 && (Z = J.getContext("webgl2", Q)),
            Z)
            this.webGLVersion = 2;
        else if (this.webGLVersion = 1,
            Z = J.getContext("webgl", Q) || J.getContext("experimental-webgl", Q),
            !Z)
            throw new Error("This browser does not support WebGL. Try using the canvas renderer");
        return this.gl = Z,
            this.getExtensions(),
            this.gl
    }
    getExtensions() {
        let { gl: J } = this
            , Q = {
                loseContext: J.getExtension("WEBGL_lose_context"),
                anisotropicFiltering: J.getExtension("EXT_texture_filter_anisotropic"),
                floatTextureLinear: J.getExtension("OES_texture_float_linear"),
                s3tc: J.getExtension("WEBGL_compressed_texture_s3tc"),
                s3tc_sRGB: J.getExtension("WEBGL_compressed_texture_s3tc_srgb"),
                etc: J.getExtension("WEBGL_compressed_texture_etc"),
                etc1: J.getExtension("WEBGL_compressed_texture_etc1"),
                pvrtc: J.getExtension("WEBGL_compressed_texture_pvrtc") || J.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),
                atc: J.getExtension("WEBGL_compressed_texture_atc"),
                astc: J.getExtension("WEBGL_compressed_texture_astc"),
                bptc: J.getExtension("EXT_texture_compression_bptc")
            };
        this.webGLVersion === 1 ? Object.assign(this.extensions, Q, {
            drawBuffers: J.getExtension("WEBGL_draw_buffers"),
            depthTexture: J.getExtension("WEBGL_depth_texture"),
            vertexArrayObject: J.getExtension("OES_vertex_array_object") || J.getExtension("MOZ_OES_vertex_array_object") || J.getExtension("WEBKIT_OES_vertex_array_object"),
            uint32ElementIndex: J.getExtension("OES_element_index_uint"),
            floatTexture: J.getExtension("OES_texture_float"),
            floatTextureLinear: J.getExtension("OES_texture_float_linear"),
            textureHalfFloat: J.getExtension("OES_texture_half_float"),
            textureHalfFloatLinear: J.getExtension("OES_texture_half_float_linear")
        }) : this.webGLVersion === 2 && Object.assign(this.extensions, Q, {
            colorBufferFloat: J.getExtension("EXT_color_buffer_float")
        })
    }
    handleContextLost(J) {
        J.preventDefault(),
            setTimeout(() => {
                this.gl.isContextLost() && this.extensions.loseContext && this.extensions.loseContext.restoreContext()
            }
                , 0)
    }
    handleContextRestored() {
        this.renderer.runners.contextChange.emit(this.gl)
    }
    destroy() {
        let J = this.renderer.view;
        this.renderer = null,
            J.removeEventListener !== void 0 && (J.removeEventListener("webglcontextlost", this.handleContextLost),
                J.removeEventListener("webglcontextrestored", this.handleContextRestored)),
            this.gl.useProgram(null),
            this.extensions.loseContext && this.extensions.loseContext.loseContext()
    }
    postrender() {
        this.renderer.objectRenderer.renderingToScreen && this.gl.flush()
    }
    validateContext(J) {
        let Q = J.getContextAttributes()
            , Z = "WebGL2RenderingContext" in globalThis && J instanceof globalThis.WebGL2RenderingContext;
        Z && (this.webGLVersion = 2),
            Q && Q.stencil;
        let $ = Z || !!J.getExtension("OES_element_index_uint");
        this.supports.uint32Indices = $
    }
}
var ev = 0;
var rO = O(() => {
    l8();
    r6();
    $7();
    mZ.defaultOptions = {
        context: null,
        antialias: !1,
        premultipliedAlpha: !0,
        preserveDrawingBuffer: !1,
        powerPreference: "default"
    },
        mZ.extension = {
            type: B8.RendererSystem,
            name: "context"
        };
    F8.add(mZ)
}
);
class z1 {
    constructor(J, Q) {
        if (this.width = Math.round(J),
            this.height = Math.round(Q),
            !this.width || !this.height)
            throw new Error("Framebuffer width or height is zero");
        this.stencil = !1,
            this.depth = !1,
            this.dirtyId = 0,
            this.dirtyFormat = 0,
            this.dirtySize = 0,
            this.depthTexture = null,
            this.colorTextures = [],
            this.glFramebuffers = {},
            this.disposeRunner = new a7("disposeFramebuffer"),
            this.multisample = a6.NONE
    }
    get colorTexture() {
        return this.colorTextures[0]
    }
    addColorTexture(J = 0, Q) {
        return this.colorTextures[J] = Q || new L6(null, {
            scaleMode: x5.NEAREST,
            resolution: 1,
            mipmap: U9.OFF,
            width: this.width,
            height: this.height
        }),
            this.dirtyId++,
            this.dirtyFormat++,
            this
    }
    addDepthTexture(J) {
        return this.depthTexture = J || new L6(null, {
            scaleMode: x5.NEAREST,
            resolution: 1,
            width: this.width,
            height: this.height,
            mipmap: U9.OFF,
            format: r0.DEPTH_COMPONENT,
            type: r8.UNSIGNED_SHORT
        }),
            this.dirtyId++,
            this.dirtyFormat++,
            this
    }
    enableDepth() {
        return this.depth = !0,
            this.dirtyId++,
            this.dirtyFormat++,
            this
    }
    enableStencil() {
        return this.stencil = !0,
            this.dirtyId++,
            this.dirtyFormat++,
            this
    }
    resize(J, Q) {
        if (J = Math.round(J),
            Q = Math.round(Q),
            !J || !Q)
            throw new Error("Framebuffer width and height must not be zero");
        if (!(J === this.width && Q === this.height)) {
            this.width = J,
                this.height = Q,
                this.dirtyId++,
                this.dirtySize++;
            for (let Z = 0; Z < this.colorTextures.length; Z++) {
                let $ = this.colorTextures[Z]
                    , q = $.resolution;
                $.setSize(J / q, Q / q)
            }
            if (this.depthTexture) {
                let Z = this.depthTexture.resolution;
                this.depthTexture.setSize(J / Z, Q / Z)
            }
        }
    }
    dispose() {
        this.disposeRunner.emit(this, !1)
    }
    destroyDepthTexture() {
        this.depthTexture && (this.depthTexture.destroy(),
            this.depthTexture = null,
            ++this.dirtyId,
            ++this.dirtyFormat)
    }
}
var tO = O(() => {
    l8();
    fQ();
    hQ()
}
);
var R4;
var eO = O(() => {
    hZ();
    l8();
    tO();
    hQ();
    R4 = class R4 extends L6 {
        constructor(J = {}) {
            if (typeof J == "number") {
                let Q = arguments[0]
                    , Z = arguments[1]
                    , $ = arguments[2]
                    , q = arguments[3];
                J = {
                    width: Q,
                    height: Z,
                    scaleMode: $,
                    resolution: q
                }
            }
            J.width = J.width ?? 100,
                J.height = J.height ?? 100,
                J.multisample ?? (J.multisample = a6.NONE),
                super(null, J),
                this.mipmap = U9.OFF,
                this.valid = !0,
                this._clear = new w9([0, 0, 0, 0]),
                this.framebuffer = new z1(this.realWidth, this.realHeight).addColorTexture(0, this),
                this.framebuffer.multisample = J.multisample,
                this.maskStack = [],
                this.filterStack = [{}]
        }
        set clearColor(J) {
            this._clear.setValue(J)
        }
        get clearColor() {
            return this._clear.value
        }
        get clear() {
            return this._clear
        }
        get multisample() {
            return this.framebuffer.multisample
        }
        set multisample(J) {
            this.framebuffer.multisample = J
        }
        resize(J, Q) {
            this.framebuffer.resize(J * this.resolution, Q * this.resolution),
                this.setRealSize(this.framebuffer.width, this.framebuffer.height)
        }
        dispose() {
            this.framebuffer.dispose(),
                super.dispose()
        }
        destroy() {
            super.destroy(),
                this.framebuffer.destroyDepthTexture(),
                this.framebuffer = null
        }
    }
}
);
var XJ;
var mQ = O(() => {
    l8();
    OJ();
    Q1();
    XJ = class XJ extends g5 {
        constructor(J) {
            let Q = J
                , Z = Q.naturalWidth || Q.videoWidth || Q.displayWidth || Q.width
                , $ = Q.naturalHeight || Q.videoHeight || Q.displayHeight || Q.height;
            super(Z, $),
                this.source = J,
                this.noSubImage = !1
        }
        static crossOrigin(J, Q, Z) {
            Z === void 0 && !Q.startsWith("data:") ? J.crossOrigin = NP(Q) : Z !== !1 && (J.crossOrigin = typeof Z == "string" ? Z : "anonymous")
        }
        upload(J, Q, Z, $) {
            let q = J.gl
                , K = Q.realWidth
                , V = Q.realHeight;
            if ($ = $ || this.source,
                typeof HTMLImageElement < "u" && $ instanceof HTMLImageElement) {
                if (!$.complete || $.naturalWidth === 0)
                    return !1
            } else if (typeof HTMLVideoElement < "u" && $ instanceof HTMLVideoElement && $.readyState <= 1)
                return !1;
            return q.pixelStorei(q.UNPACK_PREMULTIPLY_ALPHA_WEBGL, Q.alphaMode === I5.UNPACK),
                !this.noSubImage && Q.target === q.TEXTURE_2D && Z.width === K && Z.height === V ? q.texSubImage2D(q.TEXTURE_2D, 0, 0, 0, Q.format, Z.type, $) : (Z.width = K,
                    Z.height = V,
                    q.texImage2D(Q.target, 0, Z.internalFormat, Q.format, Z.type, $)),
                !0
        }
        update() {
            if (this.destroyed)
                return;
            let J = this.source
                , Q = J.naturalWidth || J.videoWidth || J.width
                , Z = J.naturalHeight || J.videoHeight || J.height;
            this.resize(Q, Z),
                super.update()
        }
        dispose() {
            this.source = null
        }
    }
}
);
var b4;
var JI = O(() => {
    l8();
    $7();
    mQ();
    b4 = class b4 extends XJ {
        constructor(J, Q) {
            if (Q = Q || {},
                typeof J == "string") {
                let Z = new Image;
                XJ.crossOrigin(Z, J, Q.crossorigin),
                    Z.src = J,
                    J = Z
            }
            super(J),
                !J.complete && this._width && this._height && (this._width = 0,
                    this._height = 0),
                this.url = J.src,
                this._process = null,
                this.preserveBitmap = !1,
                this.createBitmap = (Q.createBitmap ?? L8.CREATE_IMAGE_BITMAP) && !!globalThis.createImageBitmap,
                this.alphaMode = typeof Q.alphaMode == "number" ? Q.alphaMode : null,
                this.bitmap = null,
                this._load = null,
                Q.autoLoad !== !1 && this.load()
        }
        load(J) {
            return this._load ? this._load : (J !== void 0 && (this.createBitmap = J),
                this._load = new Promise((Q, Z) => {
                    let $ = this.source;
                    this.url = $.src;
                    let q = () => {
                        this.destroyed || ($.onload = null,
                            $.onerror = null,
                            this.update(),
                            this._load = null,
                            this.createBitmap ? Q(this.process()) : Q(this))
                    }
                        ;
                    $.complete && $.src ? q() : ($.onload = q,
                        $.onerror = (K) => {
                            Z(K),
                                this.onError.emit(K)
                        }
                    )
                }
                ),
                this._load)
        }
        process() {
            let J = this.source;
            if (this._process !== null)
                return this._process;
            if (this.bitmap !== null || !globalThis.createImageBitmap)
                return Promise.resolve(this);
            let Q = globalThis.createImageBitmap
                , Z = !J.crossOrigin || J.crossOrigin === "anonymous";
            return this._process = fetch(J.src, {
                mode: Z ? "cors" : "no-cors"
            }).catch((e) => console.log(e)).then(($) => $.blob()).then(($) => Q($, 0, 0, J.width, J.height, {
                premultiplyAlpha: this.alphaMode === null || this.alphaMode === I5.UNPACK ? "premultiply" : "none"
            })).then(($) => this.destroyed ? Promise.reject() : (this.bitmap = $,
                this.update(),
                this._process = null,
                Promise.resolve(this))),
                this._process
        }
        upload(J, Q, Z) {
            if (typeof this.alphaMode == "number" && (Q.alphaMode = this.alphaMode),
                !this.createBitmap)
                return super.upload(J, Q, Z);
            if (!this.bitmap && (this.process(),
                !this.bitmap))
                return !1;
            if (super.upload(J, Q, Z, this.bitmap),
                !this.preserveBitmap) {
                let $ = !0
                    , q = Q._glTextures;
                for (let K in q) {
                    let V = q[K];
                    if (V !== Z && V.dirtyId !== Q.dirtyId) {
                        $ = !1;
                        break
                    }
                }
                $ && (this.bitmap.close && this.bitmap.close(),
                    this.bitmap = null)
            }
            return !0
        }
        dispose() {
            this.source.onload = null,
                this.source.onerror = null,
                super.dispose(),
                this.bitmap && (this.bitmap.close(),
                    this.bitmap = null),
                this._process = null,
                this._load = null
        }
        static test(J) {
            return typeof HTMLImageElement < "u" && (typeof J == "string" || J instanceof HTMLImageElement)
        }
    }
}
);
class v4 {
    constructor() {
        this.x0 = 0,
            this.y0 = 0,
            this.x1 = 1,
            this.y1 = 0,
            this.x2 = 1,
            this.y2 = 1,
            this.x3 = 0,
            this.y3 = 1,
            this.uvsFloat32 = new Float32Array(8)
    }
    set(J, Q, Z) {
        let { width: $, height: q } = Q;
        if (Z) {
            let K = J.width / 2 / $
                , V = J.height / 2 / q
                , z = J.x / $ + K
                , W = J.y / q + V;
            Z = N7.add(Z, N7.NW),
                this.x0 = z + K * N7.uX(Z),
                this.y0 = W + V * N7.uY(Z),
                Z = N7.add(Z, 2),
                this.x1 = z + K * N7.uX(Z),
                this.y1 = W + V * N7.uY(Z),
                Z = N7.add(Z, 2),
                this.x2 = z + K * N7.uX(Z),
                this.y2 = W + V * N7.uY(Z),
                Z = N7.add(Z, 2),
                this.x3 = z + K * N7.uX(Z),
                this.y3 = W + V * N7.uY(Z)
        } else
            this.x0 = J.x / $,
                this.y0 = J.y / q,
                this.x1 = (J.x + J.width) / $,
                this.y1 = J.y / q,
                this.x2 = (J.x + J.width) / $,
                this.y2 = (J.y + J.height) / q,
                this.x3 = J.x / $,
                this.y3 = (J.y + J.height) / q;
        this.uvsFloat32[0] = this.x0,
            this.uvsFloat32[1] = this.y0,
            this.uvsFloat32[2] = this.x1,
            this.uvsFloat32[3] = this.y1,
            this.uvsFloat32[4] = this.x2,
            this.uvsFloat32[5] = this.y2,
            this.uvsFloat32[6] = this.x3,
            this.uvsFloat32[7] = this.y3
    }
}
var lP = O(() => {
    TJ();
    v4.prototype.toString = function () {
        return `[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`
    }
}
);
function QI(J) {
    J.destroy = function () { }
        ,
        J.on = function () { }
        ,
        J.once = function () { }
        ,
        J.emit = function () { }
}
var JS, e6;
var oP = O(() => {
    TJ();
    $7();
    OJ();
    hQ();
    JI();
    lP();
    JS = new v4;
    e6 = class e6 extends J1.default {
        constructor(J, Q, Z, $, q, K, V) {
            if (super(),
                this.noFrame = !1,
                Q || (this.noFrame = !0,
                    Q = new _6(0, 0, 1, 1)),
                J instanceof e6 && (J = J.baseTexture),
                this.baseTexture = J,
                this._frame = Q,
                this.trim = $,
                this.valid = !1,
                this.destroyed = !1,
                this._uvs = JS,
                this.uvMatrix = null,
                this.orig = Z || Q,
                this._rotate = Number(q || 0),
                q === !0)
                this._rotate = 2;
            else if (this._rotate % 2 !== 0)
                throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");
            this.defaultAnchor = K ? new t7(K.x, K.y) : new t7(0, 0),
                this.defaultBorders = V,
                this._updateID = 0,
                this.textureCacheIds = [],
                J.valid ? this.noFrame ? J.valid && this.onBaseTextureUpdated(J) : this.frame = Q : J.once("loaded", this.onBaseTextureUpdated, this),
                this.noFrame && J.on("update", this.onBaseTextureUpdated, this)
        }
        update() {
            this.baseTexture.resource && this.baseTexture.resource.update()
        }
        onBaseTextureUpdated(J) {
            if (this.noFrame) {
                if (!this.baseTexture.valid)
                    return;
                this._frame.width = J.width,
                    this._frame.height = J.height,
                    this.valid = !0,
                    this.updateUvs()
            } else
                this.frame = this._frame;
            this.emit("update", this)
        }
        destroy(J) {
            if (this.baseTexture) {
                if (J) {
                    let { resource: Q } = this.baseTexture;
                    Q?.url && L5[Q.url] && e6.removeFromCache(Q.url),
                        this.baseTexture.destroy()
                }
                this.baseTexture.off("loaded", this.onBaseTextureUpdated, this),
                    this.baseTexture.off("update", this.onBaseTextureUpdated, this),
                    this.baseTexture = null
            }
            this._frame = null,
                this._uvs = null,
                this.trim = null,
                this.orig = null,
                this.valid = !1,
                e6.removeFromCache(this),
                this.textureCacheIds = null,
                this.destroyed = !0,
                this.emit("destroyed", this),
                this.removeAllListeners()
        }
        clone() {
            let J = this._frame.clone()
                , Q = this._frame === this.orig ? J : this.orig.clone()
                , Z = new e6(this.baseTexture, !this.noFrame && J, Q, this.trim?.clone(), this.rotate, this.defaultAnchor, this.defaultBorders);
            return this.noFrame && (Z._frame = J),
                Z
        }
        updateUvs() {
            this._uvs === JS && (this._uvs = new v4),
                this._uvs.set(this._frame, this.baseTexture, this.rotate),
                this._updateID++
        }
        static from(J, Q = {}, Z = L8.STRICT_TEXTURE_CACHE) {
            let $ = typeof J == "string"
                , q = null;
            if ($)
                q = J;
            else if (J instanceof L6) {
                if (!J.cacheId) {
                    let V = Q?.pixiIdPrefix || "pixiid";
                    J.cacheId = `${V}-${yQ()}`,
                        L6.addToCache(J, J.cacheId)
                }
                q = J.cacheId
            } else {
                if (!J._pixiId) {
                    let V = Q?.pixiIdPrefix || "pixiid";
                    J._pixiId = `${V}_${yQ()}`
                }
                q = J._pixiId
            }
            let K = L5[q];
            if ($ && Z && !K)
                throw new Error(`The cacheId "${q}" does not exist in TextureCache.`);
            return !K && !(J instanceof L6) ? (Q.resolution || (Q.resolution = jO(J)),
                K = new e6(new L6(J, Q)),
                K.baseTexture.cacheId = q,
                L6.addToCache(K.baseTexture, q),
                e6.addToCache(K, q)) : !K && J instanceof L6 && (K = new e6(J),
                    e6.addToCache(K, q)),
                K
        }
        static fromURL(J, Q) {
            let Z = Object.assign({
                autoLoad: !1
            }, Q?.resourceOptions)
                , $ = e6.from(J, Object.assign({
                    resourceOptions: Z
                }, Q), !1)
                , q = $.baseTexture.resource;
            return $.baseTexture.valid ? Promise.resolve($) : q.load().then(() => Promise.resolve($))
        }
        static fromBuffer(J, Q, Z, $) {
            return new e6(L6.fromBuffer(J, Q, Z, $))
        }
        static fromLoader(J, Q, Z, $) {
            let q = new L6(J, Object.assign({
                scaleMode: L6.defaultOptions.scaleMode,
                resolution: jO(Q)
            }, $))
                , { resource: K } = q;
            K instanceof b4 && (K.url = Q);
            let V = new e6(q);
            return Z || (Z = Q),
                L6.addToCache(V.baseTexture, Z),
                e6.addToCache(V, Z),
                Z !== Q && (L6.addToCache(V.baseTexture, Q),
                    e6.addToCache(V, Q)),
                V.baseTexture.valid ? Promise.resolve(V) : new Promise((z) => {
                    V.baseTexture.once("loaded", () => z(V))
                }
                )
        }
        static addToCache(J, Q) {
            Q && (J.textureCacheIds.includes(Q) || J.textureCacheIds.push(Q),
                L5[Q] && L5[Q],
                L5[Q] = J)
        }
        static removeFromCache(J) {
            if (typeof J == "string") {
                let Q = L5[J];
                if (Q) {
                    let Z = Q.textureCacheIds.indexOf(J);
                    return Z > -1 && Q.textureCacheIds.splice(Z, 1),
                        delete L5[J],
                        Q
                }
            } else if (J?.textureCacheIds) {
                for (let Q = 0; Q < J.textureCacheIds.length; ++Q)
                    L5[J.textureCacheIds[Q]] === J && delete L5[J.textureCacheIds[Q]];
                return J.textureCacheIds.length = 0,
                    J
            }
            return null
        }
        get resolution() {
            return this.baseTexture.resolution
        }
        get frame() {
            return this._frame
        }
        set frame(J) {
            this._frame = J,
                this.noFrame = !1;
            let { x: Q, y: Z, width: $, height: q } = J
                , K = Q + $ > this.baseTexture.width
                , V = Z + q > this.baseTexture.height;
            if (K || V) {
                let z = K && V ? "and" : "or"
                    , W = `X: ${Q} + ${$} = ${Q + $} > ${this.baseTexture.width}`
                    , H = `Y: ${Z} + ${q} = ${Z + q} > ${this.baseTexture.height}`;
                throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${W} ${z} ${H}`)
            }
            this.valid = $ && q && this.baseTexture.valid,
                !this.trim && !this.rotate && (this.orig = J),
                this.valid && this.updateUvs()
        }
        get rotate() {
            return this._rotate
        }
        set rotate(J) {
            this._rotate = J,
                this.valid && this.updateUvs()
        }
        get width() {
            return this.orig.width
        }
        get height() {
            return this.orig.height
        }
        castToBaseTexture() {
            return this.baseTexture
        }
        static get EMPTY() {
            return e6._EMPTY || (e6._EMPTY = new e6(new L6),
                QI(e6._EMPTY),
                QI(e6._EMPTY.baseTexture)),
                e6._EMPTY
        }
        static get WHITE() {
            if (!e6._WHITE) {
                let J = L8.ADAPTER.createCanvas(16, 16)
                    , Q = J.getContext("2d");
                J.width = 16,
                    J.height = 16,
                    Q.fillStyle = "white",
                    Q.fillRect(0, 0, 16, 16),
                    e6._WHITE = new e6(L6.from(J)),
                    QI(e6._WHITE),
                    QI(e6._WHITE.baseTexture)
            }
            return e6._WHITE
        }
    }
}
);
var W1;
var ZI = O(() => {
    oP();
    eO();
    W1 = class W1 extends e6 {
        constructor(J, Q) {
            super(J, Q),
                this.valid = !0,
                this.filterFrame = null,
                this.filterPoolKey = null,
                this.updateUvs()
        }
        get framebuffer() {
            return this.baseTexture.framebuffer
        }
        get multisample() {
            return this.framebuffer.multisample
        }
        set multisample(J) {
            this.framebuffer.multisample = J
        }
        resize(J, Q, Z = !0) {
            let $ = this.baseTexture.resolution
                , q = Math.round(J * $) / $
                , K = Math.round(Q * $) / $;
            this.valid = q > 0 && K > 0,
                this._frame.width = this.orig.width = q,
                this._frame.height = this.orig.height = K,
                Z && this.baseTexture.resize(q, K),
                this.updateUvs()
        }
        setResolution(J) {
            let { baseTexture: Q } = this;
            Q.resolution !== J && (Q.setResolution(J),
                this.resize(Q.width, Q.height, !1))
        }
        static create(J) {
            return new W1(new R4(J))
        }
    }
}
);
class gH {
    constructor(J) {
        this.texturePool = {},
            this.textureOptions = J || {},
            this.enableFullScreen = !1,
            this._pixelsWidth = 0,
            this._pixelsHeight = 0
    }
    createTexture(J, Q, Z = a6.NONE) {
        let $ = new R4(Object.assign({
            width: J,
            height: Q,
            resolution: 1,
            multisample: Z
        }, this.textureOptions));
        return new W1($)
    }
    getOptimalTexture(J, Q, Z = 1, $ = a6.NONE) {
        let q;
        J = Math.max(Math.ceil(J * Z - 0.000001), 1),
            Q = Math.max(Math.ceil(Q * Z - 0.000001), 1),
            !this.enableFullScreen || J !== this._pixelsWidth || Q !== this._pixelsHeight ? (J = e$(J),
                Q = e$(Q),
                q = ((J & 65535) << 16 | Q & 65535) >>> 0,
                $ > 1 && (q += $ * 4294967296)) : q = $ > 1 ? -$ : -1,
            this.texturePool[q] || (this.texturePool[q] = []);
        let K = this.texturePool[q].pop();
        return K || (K = this.createTexture(J, Q, $)),
            K.filterPoolKey = q,
            K.setResolution(Z),
            K
    }
    getFilterTexture(J, Q, Z) {
        let $ = this.getOptimalTexture(J.width, J.height, Q || J.resolution, Z || a6.NONE);
        return $.filterFrame = J.filterFrame,
            $
    }
    returnTexture(J) {
        let Q = J.filterPoolKey;
        J.filterFrame = null,
            this.texturePool[Q].push(J)
    }
    returnFilterTexture(J) {
        this.returnTexture(J)
    }
    clear(J) {
        if (J = J !== !1,
            J)
            for (let Q in this.texturePool) {
                let Z = this.texturePool[Q];
                if (Z)
                    for (let $ = 0; $ < Z.length; $++)
                        Z[$].destroy(!0)
            }
        this.texturePool = {}
    }
    setScreenSize(J) {
        if (!(J.width === this._pixelsWidth && J.height === this._pixelsHeight)) {
            this.enableFullScreen = J.width > 0 && J.height > 0;
            for (let Q in this.texturePool) {
                if (!(Number(Q) < 0))
                    continue;
                let Z = this.texturePool[Q];
                if (Z)
                    for (let $ = 0; $ < Z.length; $++)
                        Z[$].destroy(!0);
                this.texturePool[Q] = []
            }
            this._pixelsWidth = J.width,
                this._pixelsHeight = J.height
        }
    }
}
var nP = O(() => {
    l8();
    OJ();
    eO();
    ZI();
    gH.SCREEN_KEY = -1
}
);
var $I;
var sP = O(() => {
    RH();
    $I = class $I extends s9 {
        constructor() {
            super(),
                this.addAttribute("aVertexPosition", new Float32Array([0, 0, 1, 0, 1, 1, 0, 1])).addIndex([0, 1, 3, 2])
        }
    }
}
);
var qI;
var iP = O(() => {
    D4();
    RH();
    qI = class qI extends s9 {
        constructor() {
            super(),
                this.vertices = new Float32Array([-1, -1, 1, -1, 1, 1, -1, 1]),
                this.uvs = new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]),
                this.vertexBuffer = new r7(this.vertices),
                this.uvBuffer = new r7(this.uvs),
                this.addAttribute("aVertexPosition", this.vertexBuffer).addAttribute("aTextureCoord", this.uvBuffer).addIndex([0, 1, 2, 0, 2, 3])
        }
        map(J, Q) {
            let Z = 0
                , $ = 0;
            return this.uvs[0] = Z,
                this.uvs[1] = $,
                this.uvs[2] = Z + Q.width / J.width,
                this.uvs[3] = $,
                this.uvs[4] = Z + Q.width / J.width,
                this.uvs[5] = $ + Q.height / J.height,
                this.uvs[6] = Z,
                this.uvs[7] = $ + Q.height / J.height,
                Z = Q.x,
                $ = Q.y,
                this.vertices[0] = Z,
                this.vertices[1] = $,
                this.vertices[2] = Z + Q.width,
                this.vertices[3] = $,
                this.vertices[4] = Z + Q.width,
                this.vertices[5] = $ + Q.height,
                this.vertices[6] = Z,
                this.vertices[7] = $ + Q.height,
                this.invalidate(),
                this
        }
        invalidate() {
            return this.vertexBuffer._updateID++,
                this.uvBuffer._updateID++,
                this
        }
    }
}
);
class KI {
    constructor() {
        this.renderTexture = null,
            this.target = null,
            this.legacy = !1,
            this.resolution = 1,
            this.multisample = a6.NONE,
            this.sourceFrame = new _6,
            this.destinationFrame = new _6,
            this.bindingSourceFrame = new _6,
            this.bindingDestinationFrame = new _6,
            this.filters = [],
            this.transform = null
    }
    clear() {
        this.target = null,
            this.filters = null,
            this.renderTexture = null
    }
}
var aP = O(() => {
    l8();
    TJ()
}
);
class mH {
    constructor(J) {
        this.renderer = J,
            this.defaultFilterStack = [{}],
            this.texturePool = new gH,
            this.statePool = [],
            this.quad = new $I,
            this.quadUv = new qI,
            this.tempRect = new _6,
            this.activeState = {},
            this.globalUniforms = new rJ({
                outputFrame: new _6,
                inputSize: new Float32Array(4),
                inputPixel: new Float32Array(4),
                inputClamp: new Float32Array(4),
                resolution: 1,
                filterArea: new Float32Array(4),
                filterClamp: new Float32Array(4)
            }, !0),
            this.forceClear = !1,
            this.useMaxPadding = !1
    }
    init() {
        this.texturePool.setScreenSize(this.renderer.view)
    }
    push(J, Q) {
        let Z = this.renderer, $ = this.defaultFilterStack, q = this.statePool.pop() || new KI, K = Z.renderTexture, V, z;
        if (K.current) {
            let L = K.current;
            V = L.resolution,
                z = L.multisample
        } else
            V = Z.resolution,
                z = Z.multisample;
        let W = Q[0].resolution || V
            , H = Q[0].multisample ?? z
            , Y = Q[0].padding
            , U = Q[0].autoFit
            , N = Q[0].legacy ?? !0;
        for (let L = 1; L < Q.length; L++) {
            let F = Q[L];
            W = Math.min(W, F.resolution || V),
                H = Math.min(H, F.multisample ?? z),
                Y = this.useMaxPadding ? Math.max(Y, F.padding) : Y + F.padding,
                U = U && F.autoFit,
                N = N || (F.legacy ?? !0)
        }
        $.length === 1 && (this.defaultFilterStack[0].renderTexture = K.current),
            $.push(q),
            q.resolution = W,
            q.multisample = H,
            q.legacy = N,
            q.target = J,
            q.sourceFrame.copyFrom(J.filterArea || J.getBounds(!0)),
            q.sourceFrame.pad(Y);
        let j = this.tempRect.copyFrom(K.sourceFrame);
        Z.projection.transform && this.transformAABB(rP.copyFrom(Z.projection.transform).invert(), j),
            U ? (q.sourceFrame.fit(j),
                (q.sourceFrame.width <= 0 || q.sourceFrame.height <= 0) && (q.sourceFrame.width = 0,
                    q.sourceFrame.height = 0)) : q.sourceFrame.intersects(j) || (q.sourceFrame.width = 0,
                        q.sourceFrame.height = 0),
            this.roundFrame(q.sourceFrame, K.current ? K.current.resolution : Z.resolution, K.sourceFrame, K.destinationFrame, Z.projection.transform),
            q.renderTexture = this.getOptimalFilterTexture(q.sourceFrame.width, q.sourceFrame.height, W, H),
            q.filters = Q,
            q.destinationFrame.width = q.renderTexture.width,
            q.destinationFrame.height = q.renderTexture.height;
        let k = this.tempRect;
        k.x = 0,
            k.y = 0,
            k.width = q.sourceFrame.width,
            k.height = q.sourceFrame.height,
            q.renderTexture.filterFrame = q.sourceFrame,
            q.bindingSourceFrame.copyFrom(K.sourceFrame),
            q.bindingDestinationFrame.copyFrom(K.destinationFrame),
            q.transform = Z.projection.transform,
            Z.projection.transform = null,
            K.bind(q.renderTexture, q.sourceFrame, k),
            Z.framebuffer.clear(0, 0, 0, 0)
    }
    pop() {
        let J = this.defaultFilterStack
            , Q = J.pop()
            , Z = Q.filters;
        this.activeState = Q;
        let $ = this.globalUniforms.uniforms;
        $.outputFrame = Q.sourceFrame,
            $.resolution = Q.resolution;
        let { inputSize: q, inputPixel: K, inputClamp: V } = $;
        if (q[0] = Q.destinationFrame.width,
            q[1] = Q.destinationFrame.height,
            q[2] = 1 / q[0],
            q[3] = 1 / q[1],
            K[0] = Math.round(q[0] * Q.resolution),
            K[1] = Math.round(q[1] * Q.resolution),
            K[2] = 1 / K[0],
            K[3] = 1 / K[1],
            V[0] = 0.5 * K[2],
            V[1] = 0.5 * K[3],
            V[2] = Q.sourceFrame.width * q[2] - 0.5 * K[2],
            V[3] = Q.sourceFrame.height * q[3] - 0.5 * K[3],
            Q.legacy) {
            let W = $.filterArea;
            W[0] = Q.destinationFrame.width,
                W[1] = Q.destinationFrame.height,
                W[2] = Q.sourceFrame.x,
                W[3] = Q.sourceFrame.y,
                $.filterClamp = $.inputClamp
        }
        this.globalUniforms.update();
        let z = J[J.length - 1];
        if (this.renderer.framebuffer.blit(),
            Z.length === 1)
            Z[0].apply(this, Q.renderTexture, z.renderTexture, fZ.BLEND, Q),
                this.returnFilterTexture(Q.renderTexture);
        else {
            let W = Q.renderTexture
                , H = this.getOptimalFilterTexture(W.width, W.height, Q.resolution);
            H.filterFrame = W.filterFrame;
            let Y = 0;
            for (Y = 0; Y < Z.length - 1; ++Y) {
                Y === 1 && Q.multisample > 1 && (H = this.getOptimalFilterTexture(W.width, W.height, Q.resolution),
                    H.filterFrame = W.filterFrame),
                    Z[Y].apply(this, W, H, fZ.CLEAR, Q);
                let U = W;
                W = H,
                    H = U
            }
            Z[Y].apply(this, W, z.renderTexture, fZ.BLEND, Q),
                Y > 1 && Q.multisample > 1 && this.returnFilterTexture(Q.renderTexture),
                this.returnFilterTexture(W),
                this.returnFilterTexture(H)
        }
        Q.clear(),
            this.statePool.push(Q)
    }
    bindAndClear(J, Q = fZ.CLEAR) {
        let { renderTexture: Z, state: $ } = this.renderer;
        if (J === this.defaultFilterStack[this.defaultFilterStack.length - 1].renderTexture ? this.renderer.projection.transform = this.activeState.transform : this.renderer.projection.transform = null,
            J?.filterFrame) {
            let K = this.tempRect;
            K.x = 0,
                K.y = 0,
                K.width = J.filterFrame.width,
                K.height = J.filterFrame.height,
                Z.bind(J, J.filterFrame, K)
        } else
            J !== this.defaultFilterStack[this.defaultFilterStack.length - 1].renderTexture ? Z.bind(J) : this.renderer.renderTexture.bind(J, this.activeState.bindingSourceFrame, this.activeState.bindingDestinationFrame);
        let q = $.stateId & 1 || this.forceClear;
        (Q === fZ.CLEAR || Q === fZ.BLIT && q) && this.renderer.framebuffer.clear(0, 0, 0, 0)
    }
    applyFilter(J, Q, Z, $) {
        let q = this.renderer;
        q.state.set(J.state),
            this.bindAndClear(Z, $),
            J.uniforms.uSampler = Q,
            J.uniforms.filterGlobals = this.globalUniforms,
            q.shader.bind(J),
            J.legacy = !!J.program.attributeData.aTextureCoord,
            J.legacy ? (this.quadUv.map(Q._frame, Q.filterFrame),
                q.geometry.bind(this.quadUv),
                q.geometry.draw(B4.TRIANGLES)) : (q.geometry.bind(this.quad),
                    q.geometry.draw(B4.TRIANGLE_STRIP))
    }
    calculateSpriteMatrix(J, Q) {
        let { sourceFrame: Z, destinationFrame: $ } = this.activeState
            , { orig: q } = Q._texture
            , K = J.set($.width, 0, 0, $.height, Z.x, Z.y)
            , V = Q.worldTransform.copyTo(t6.TEMP_MATRIX);
        return V.invert(),
            K.prepend(V),
            K.scale(1 / q.width, 1 / q.height),
            K.translate(Q.anchor.x, Q.anchor.y),
            K
    }
    destroy() {
        this.renderer = null,
            this.texturePool.clear(!1)
    }
    getOptimalFilterTexture(J, Q, Z = 1, $ = a6.NONE) {
        return this.texturePool.getOptimalTexture(J, Q, Z, $)
    }
    getFilterTexture(J, Q, Z) {
        if (typeof J == "number") {
            let q = J;
            J = Q,
                Q = q
        }
        J = J || this.activeState.renderTexture;
        let $ = this.texturePool.getOptimalTexture(J.width, J.height, Q || J.resolution, Z || a6.NONE);
        return $.filterFrame = J.filterFrame,
            $
    }
    returnFilterTexture(J) {
        this.texturePool.returnTexture(J)
    }
    emptyPool() {
        this.texturePool.clear(!0)
    }
    resize() {
        this.texturePool.setScreenSize(this.renderer.view)
    }
    transformAABB(J, Q) {
        let Z = VI[0]
            , $ = VI[1]
            , q = VI[2]
            , K = VI[3];
        Z.set(Q.left, Q.top),
            $.set(Q.left, Q.bottom),
            q.set(Q.right, Q.top),
            K.set(Q.right, Q.bottom),
            J.apply(Z, Z),
            J.apply($, $),
            J.apply(q, q),
            J.apply(K, K);
        let V = Math.min(Z.x, $.x, q.x, K.x)
            , z = Math.min(Z.y, $.y, q.y, K.y)
            , W = Math.max(Z.x, $.x, q.x, K.x)
            , H = Math.max(Z.y, $.y, q.y, K.y);
        Q.x = V,
            Q.y = z,
            Q.width = W - V,
            Q.height = H - z
    }
    roundFrame(J, Q, Z, $, q) {
        if (!(J.width <= 0 || J.height <= 0 || Z.width <= 0 || Z.height <= 0)) {
            if (q) {
                let { a: K, b: V, c: z, d: W } = q;
                if ((Math.abs(V) > 0.0001 || Math.abs(z) > 0.0001) && (Math.abs(K) > 0.0001 || Math.abs(W) > 0.0001))
                    return
            }
            q = q ? rP.copyFrom(q) : rP.identity(),
                q.translate(-Z.x, -Z.y).scale($.width / Z.width, $.height / Z.height).translate($.x, $.y),
                this.transformAABB(q, J),
                J.ceil(Q),
                this.transformAABB(q.invert(), J)
        }
    }
}
var VI, rP;
var tP = O(() => {
    l8();
    r6();
    TJ();
    nP();
    M4();
    sP();
    iP();
    aP();
    VI = [new t7, new t7, new t7, new t7],
        rP = new t6;
    mH.extension = {
        type: B8.RendererSystem,
        name: "filter"
    };
    F8.add(mH)
}
);
class zI {
    constructor(J) {
        this.framebuffer = J,
            this.stencil = null,
            this.dirtyId = -1,
            this.dirtyFormat = -1,
            this.dirtySize = -1,
            this.multisample = a6.NONE,
            this.msaaBuffer = null,
            this.blitFramebuffer = null,
            this.mipLevel = 0
    }
}
var eP = O(() => {
    l8()
}
);
class cH {
    constructor(J) {
        this.renderer = J,
            this.managedFramebuffers = [],
            this.unknownFramebuffer = new z1(10, 10),
            this.msaaSamples = null
    }
    contextChange() {
        this.disposeAll(!0);
        let J = this.gl = this.renderer.gl;
        if (this.CONTEXT_UID = this.renderer.CONTEXT_UID,
            this.current = this.unknownFramebuffer,
            this.viewport = new _6,
            this.hasMRT = !0,
            this.writeDepthTexture = !0,
            this.renderer.context.webGLVersion === 1) {
            let Q = this.renderer.context.extensions.drawBuffers
                , Z = this.renderer.context.extensions.depthTexture;
            L8.PREFER_ENV === O5.WEBGL_LEGACY && (Q = null,
                Z = null),
                Q ? J.drawBuffers = ($) => Q.drawBuffersWEBGL($) : (this.hasMRT = !1,
                    J.drawBuffers = () => { }
                ),
                Z || (this.writeDepthTexture = !1)
        } else
            this.msaaSamples = J.getInternalformatParameter(J.RENDERBUFFER, J.RGBA8, J.SAMPLES)
    }
    bind(J, Q, Z = 0) {
        let { gl: $ } = this;
        if (J) {
            let q = J.glFramebuffers[this.CONTEXT_UID] || this.initFramebuffer(J);
            this.current !== J && (this.current = J,
                $.bindFramebuffer($.FRAMEBUFFER, q.framebuffer)),
                q.mipLevel !== Z && (J.dirtyId++,
                    J.dirtyFormat++,
                    q.mipLevel = Z),
                q.dirtyId !== J.dirtyId && (q.dirtyId = J.dirtyId,
                    q.dirtyFormat !== J.dirtyFormat ? (q.dirtyFormat = J.dirtyFormat,
                        q.dirtySize = J.dirtySize,
                        this.updateFramebuffer(J, Z)) : q.dirtySize !== J.dirtySize && (q.dirtySize = J.dirtySize,
                            this.resizeFramebuffer(J)));
            for (let K = 0; K < J.colorTextures.length; K++) {
                let V = J.colorTextures[K];
                this.renderer.texture.unbind(V.parentTextureArray || V)
            }
            if (J.depthTexture && this.renderer.texture.unbind(J.depthTexture),
                Q) {
                let K = Q.width >> Z
                    , V = Q.height >> Z
                    , z = K / Q.width;
                this.setViewport(Q.x * z, Q.y * z, K, V)
            } else {
                let K = J.width >> Z
                    , V = J.height >> Z;
                this.setViewport(0, 0, K, V)
            }
        } else
            this.current && (this.current = null,
                $.bindFramebuffer($.FRAMEBUFFER, null)),
                Q ? this.setViewport(Q.x, Q.y, Q.width, Q.height) : this.setViewport(0, 0, this.renderer.width, this.renderer.height)
    }
    setViewport(J, Q, Z, $) {
        let q = this.viewport;
        J = Math.round(J),
            Q = Math.round(Q),
            Z = Math.round(Z),
            $ = Math.round($),
            (q.width !== Z || q.height !== $ || q.x !== J || q.y !== Q) && (q.x = J,
                q.y = Q,
                q.width = Z,
                q.height = $,
                this.gl.viewport(J, Q, Z, $))
    }
    get size() {
        return this.current ? {
            x: 0,
            y: 0,
            width: this.current.width,
            height: this.current.height
        } : {
            x: 0,
            y: 0,
            width: this.renderer.width,
            height: this.renderer.height
        }
    }
    clear(J, Q, Z, $, q = $O.COLOR | $O.DEPTH) {
        let { gl: K } = this;
        K.clearColor(J, Q, Z, $),
            K.clear(q)
    }
    initFramebuffer(J) {
        let { gl: Q } = this
            , Z = new zI(Q.createFramebuffer());
        return Z.multisample = this.detectSamples(J.multisample),
            J.glFramebuffers[this.CONTEXT_UID] = Z,
            this.managedFramebuffers.push(J),
            J.disposeRunner.add(this),
            Z
    }
    resizeFramebuffer(J) {
        let { gl: Q } = this
            , Z = J.glFramebuffers[this.CONTEXT_UID];
        if (Z.stencil) {
            Q.bindRenderbuffer(Q.RENDERBUFFER, Z.stencil);
            let K;
            this.renderer.context.webGLVersion === 1 ? K = Q.DEPTH_STENCIL : J.depth && J.stencil ? K = Q.DEPTH24_STENCIL8 : J.depth ? K = Q.DEPTH_COMPONENT24 : K = Q.STENCIL_INDEX8,
                Z.msaaBuffer ? Q.renderbufferStorageMultisample(Q.RENDERBUFFER, Z.multisample, K, J.width, J.height) : Q.renderbufferStorage(Q.RENDERBUFFER, K, J.width, J.height)
        }
        let $ = J.colorTextures
            , q = $.length;
        Q.drawBuffers || (q = Math.min(q, 1));
        for (let K = 0; K < q; K++) {
            let V = $[K]
                , z = V.parentTextureArray || V;
            this.renderer.texture.bind(z, 0),
                K === 0 && Z.msaaBuffer && (Q.bindRenderbuffer(Q.RENDERBUFFER, Z.msaaBuffer),
                    Q.renderbufferStorageMultisample(Q.RENDERBUFFER, Z.multisample, z._glTextures[this.CONTEXT_UID].internalFormat, J.width, J.height))
        }
        J.depthTexture && this.writeDepthTexture && this.renderer.texture.bind(J.depthTexture, 0)
    }
    updateFramebuffer(J, Q) {
        let { gl: Z } = this
            , $ = J.glFramebuffers[this.CONTEXT_UID]
            , q = J.colorTextures
            , K = q.length;
        Z.drawBuffers || (K = Math.min(K, 1)),
            $.multisample > 1 && this.canMultisampleFramebuffer(J) ? $.msaaBuffer = $.msaaBuffer || Z.createRenderbuffer() : $.msaaBuffer && (Z.deleteRenderbuffer($.msaaBuffer),
                $.msaaBuffer = null,
                $.blitFramebuffer && ($.blitFramebuffer.dispose(),
                    $.blitFramebuffer = null));
        let V = [];
        for (let z = 0; z < K; z++) {
            let W = q[z]
                , H = W.parentTextureArray || W;
            this.renderer.texture.bind(H, 0),
                z === 0 && $.msaaBuffer ? (Z.bindRenderbuffer(Z.RENDERBUFFER, $.msaaBuffer),
                    Z.renderbufferStorageMultisample(Z.RENDERBUFFER, $.multisample, H._glTextures[this.CONTEXT_UID].internalFormat, J.width, J.height),
                    Z.framebufferRenderbuffer(Z.FRAMEBUFFER, Z.COLOR_ATTACHMENT0, Z.RENDERBUFFER, $.msaaBuffer)) : (Z.framebufferTexture2D(Z.FRAMEBUFFER, Z.COLOR_ATTACHMENT0 + z, W.target, H._glTextures[this.CONTEXT_UID].texture, Q),
                        V.push(Z.COLOR_ATTACHMENT0 + z))
        }
        if (V.length > 1 && Z.drawBuffers(V),
            J.depthTexture && this.writeDepthTexture) {
            let z = J.depthTexture;
            this.renderer.texture.bind(z, 0),
                Z.framebufferTexture2D(Z.FRAMEBUFFER, Z.DEPTH_ATTACHMENT, Z.TEXTURE_2D, z._glTextures[this.CONTEXT_UID].texture, Q)
        }
        if ((J.stencil || J.depth) && !(J.depthTexture && this.writeDepthTexture)) {
            $.stencil = $.stencil || Z.createRenderbuffer();
            let z, W;
            this.renderer.context.webGLVersion === 1 ? (z = Z.DEPTH_STENCIL_ATTACHMENT,
                W = Z.DEPTH_STENCIL) : J.depth && J.stencil ? (z = Z.DEPTH_STENCIL_ATTACHMENT,
                    W = Z.DEPTH24_STENCIL8) : J.depth ? (z = Z.DEPTH_ATTACHMENT,
                        W = Z.DEPTH_COMPONENT24) : (z = Z.STENCIL_ATTACHMENT,
                            W = Z.STENCIL_INDEX8),
                Z.bindRenderbuffer(Z.RENDERBUFFER, $.stencil),
                $.msaaBuffer ? Z.renderbufferStorageMultisample(Z.RENDERBUFFER, $.multisample, W, J.width, J.height) : Z.renderbufferStorage(Z.RENDERBUFFER, W, J.width, J.height),
                Z.framebufferRenderbuffer(Z.FRAMEBUFFER, z, Z.RENDERBUFFER, $.stencil)
        } else
            $.stencil && (Z.deleteRenderbuffer($.stencil),
                $.stencil = null)
    }
    canMultisampleFramebuffer(J) {
        return this.renderer.context.webGLVersion !== 1 && J.colorTextures.length <= 1 && !J.depthTexture
    }
    detectSamples(J) {
        let { msaaSamples: Q } = this
            , Z = a6.NONE;
        if (J <= 1 || Q === null)
            return Z;
        for (let $ = 0; $ < Q.length; $++)
            if (Q[$] <= J) {
                Z = Q[$];
                break
            }
        return Z === 1 && (Z = a6.NONE),
            Z
    }
    blit(J, Q, Z) {
        let { current: $, renderer: q, gl: K, CONTEXT_UID: V } = this;
        if (q.context.webGLVersion !== 2 || !$)
            return;
        let z = $.glFramebuffers[V];
        if (!z)
            return;
        if (!J) {
            if (!z.msaaBuffer)
                return;
            let H = $.colorTextures[0];
            if (!H)
                return;
            z.blitFramebuffer || (z.blitFramebuffer = new z1($.width, $.height),
                z.blitFramebuffer.addColorTexture(0, H)),
                J = z.blitFramebuffer,
                J.colorTextures[0] !== H && (J.colorTextures[0] = H,
                    J.dirtyId++,
                    J.dirtyFormat++),
                (J.width !== $.width || J.height !== $.height) && (J.width = $.width,
                    J.height = $.height,
                    J.dirtyId++,
                    J.dirtySize++)
        }
        Q || (Q = ql,
            Q.width = $.width,
            Q.height = $.height),
            Z || (Z = Q);
        let W = Q.width === Z.width && Q.height === Z.height;
        this.bind(J),
            K.bindFramebuffer(K.READ_FRAMEBUFFER, z.framebuffer),
            K.blitFramebuffer(Q.left, Q.top, Q.right, Q.bottom, Z.left, Z.top, Z.right, Z.bottom, K.COLOR_BUFFER_BIT, W ? K.NEAREST : K.LINEAR),
            K.bindFramebuffer(K.READ_FRAMEBUFFER, J.glFramebuffers[this.CONTEXT_UID].framebuffer)
    }
    disposeFramebuffer(J, Q) {
        let Z = J.glFramebuffers[this.CONTEXT_UID]
            , $ = this.gl;
        if (!Z)
            return;
        delete J.glFramebuffers[this.CONTEXT_UID];
        let q = this.managedFramebuffers.indexOf(J);
        q >= 0 && this.managedFramebuffers.splice(q, 1),
            J.disposeRunner.remove(this),
            Q || ($.deleteFramebuffer(Z.framebuffer),
                Z.msaaBuffer && $.deleteRenderbuffer(Z.msaaBuffer),
                Z.stencil && $.deleteRenderbuffer(Z.stencil)),
            Z.blitFramebuffer && this.disposeFramebuffer(Z.blitFramebuffer, Q)
    }
    disposeAll(J) {
        let Q = this.managedFramebuffers;
        this.managedFramebuffers = [];
        for (let Z = 0; Z < Q.length; Z++)
            this.disposeFramebuffer(Q[Z], J)
    }
    forceStencil() {
        let J = this.current;
        if (!J)
            return;
        let Q = J.glFramebuffers[this.CONTEXT_UID];
        if (!Q || Q.stencil && J.stencil)
            return;
        J.stencil = !0;
        let { width: Z, height: $ } = J
            , q = this.gl
            , K = Q.stencil = q.createRenderbuffer();
        q.bindRenderbuffer(q.RENDERBUFFER, K);
        let V, z;
        this.renderer.context.webGLVersion === 1 ? (V = q.DEPTH_STENCIL_ATTACHMENT,
            z = q.DEPTH_STENCIL) : J.depth ? (V = q.DEPTH_STENCIL_ATTACHMENT,
                z = q.DEPTH24_STENCIL8) : (V = q.STENCIL_ATTACHMENT,
                    z = q.STENCIL_INDEX8),
            Q.msaaBuffer ? q.renderbufferStorageMultisample(q.RENDERBUFFER, Q.multisample, z, Z, $) : q.renderbufferStorage(q.RENDERBUFFER, z, Z, $),
            q.framebufferRenderbuffer(q.FRAMEBUFFER, V, q.RENDERBUFFER, K)
    }
    reset() {
        this.current = this.unknownFramebuffer,
            this.viewport = new _6
    }
    destroy() {
        this.renderer = null
    }
}
var ql;
var JD = O(() => {
    l8();
    r6();
    TJ();
    $7();
    tO();
    eP();
    ql = new _6;
    cH.extension = {
        type: B8.RendererSystem,
        name: "framebuffer"
    };
    F8.add(cH)
}
);
class dH {
    constructor(J) {
        this.renderer = J,
            this._activeGeometry = null,
            this._activeVao = null,
            this.hasVao = !0,
            this.hasInstance = !0,
            this.canUseUInt32ElementIndex = !1,
            this.managedGeometries = {}
    }
    contextChange() {
        this.disposeAll(!0);
        let J = this.gl = this.renderer.gl
            , Q = this.renderer.context;
        if (this.CONTEXT_UID = this.renderer.CONTEXT_UID,
            Q.webGLVersion !== 2) {
            let Z = this.renderer.context.extensions.vertexArrayObject;
            L8.PREFER_ENV === O5.WEBGL_LEGACY && (Z = null),
                Z ? (J.createVertexArray = () => Z.createVertexArrayOES(),
                    J.bindVertexArray = ($) => Z.bindVertexArrayOES($),
                    J.deleteVertexArray = ($) => Z.deleteVertexArrayOES($)) : (this.hasVao = !1,
                        J.createVertexArray = () => null,
                        J.bindVertexArray = () => null,
                        J.deleteVertexArray = () => null)
        }
        if (Q.webGLVersion !== 2) {
            let Z = J.getExtension("ANGLE_instanced_arrays");
            Z ? (J.vertexAttribDivisor = ($, q) => Z.vertexAttribDivisorANGLE($, q),
                J.drawElementsInstanced = ($, q, K, V, z) => Z.drawElementsInstancedANGLE($, q, K, V, z),
                J.drawArraysInstanced = ($, q, K, V) => Z.drawArraysInstancedANGLE($, q, K, V)) : this.hasInstance = !1
        }
        this.canUseUInt32ElementIndex = Q.webGLVersion === 2 || !!Q.extensions.uint32ElementIndex
    }
    bind(J, Q) {
        Q = Q || this.renderer.shader.shader;
        let { gl: Z } = this
            , $ = J.glVertexArrayObjects[this.CONTEXT_UID]
            , q = !1;
        $ || (this.managedGeometries[J.id] = J,
            J.disposeRunner.add(this),
            J.glVertexArrayObjects[this.CONTEXT_UID] = $ = {},
            q = !0);
        let K = $[Q.program.id] || this.initGeometryVao(J, Q, q);
        this._activeGeometry = J,
            this._activeVao !== K && (this._activeVao = K,
                this.hasVao ? Z.bindVertexArray(K) : this.activateVao(J, Q.program)),
            this.updateBuffers()
    }
    reset() {
        this.unbind()
    }
    updateBuffers() {
        let J = this._activeGeometry
            , Q = this.renderer.buffer;
        for (let Z = 0; Z < J.buffers.length; Z++) {
            let $ = J.buffers[Z];
            Q.update($)
        }
    }
    checkCompatibility(J, Q) {
        let Z = J.attributes
            , $ = Q.attributeData;
        for (let q in $)
            if (!Z[q])
                throw new Error(`shader and geometry incompatible, geometry missing the "${q}" attribute`)
    }
    getSignature(J, Q) {
        let Z = J.attributes
            , $ = Q.attributeData
            , q = ["g", J.id];
        for (let K in Z)
            $[K] && q.push(K, $[K].location);
        return q.join("-")
    }
    initGeometryVao(J, Q, Z = !0) {
        let $ = this.gl
            , q = this.CONTEXT_UID
            , K = this.renderer.buffer
            , V = Q.program;
        V.glPrograms[q] || this.renderer.shader.generateProgram(Q),
            this.checkCompatibility(J, V);
        let z = this.getSignature(J, V)
            , W = J.glVertexArrayObjects[this.CONTEXT_UID]
            , H = W[z];
        if (H)
            return W[V.id] = H,
                H;
        let { buffers: Y, attributes: U } = J
            , N = {}
            , j = {};
        for (let k in Y)
            N[k] = 0,
                j[k] = 0;
        for (let k in U)
            !U[k].size && V.attributeData[k] ? U[k].size = V.attributeData[k].size : U[k].size,
                N[U[k].buffer] += U[k].size * QD[U[k].type];
        for (let k in U) {
            let L = U[k]
                , F = L.size;
            L.stride === void 0 && (N[L.buffer] === F * QD[L.type] ? L.stride = 0 : L.stride = N[L.buffer]),
                L.start === void 0 && (L.start = j[L.buffer],
                    j[L.buffer] += F * QD[L.type])
        }
        H = $.createVertexArray(),
            $.bindVertexArray(H);
        for (let k = 0; k < Y.length; k++) {
            let L = Y[k];
            K.bind(L),
                Z && L._glBuffers[q].refCount++
        }
        return this.activateVao(J, V),
            W[V.id] = H,
            W[z] = H,
            $.bindVertexArray(null),
            K.unbind(H5.ARRAY_BUFFER),
            H
    }
    disposeGeometry(J, Q) {
        if (!this.managedGeometries[J.id])
            return;
        delete this.managedGeometries[J.id];
        let Z = J.glVertexArrayObjects[this.CONTEXT_UID]
            , $ = this.gl
            , q = J.buffers
            , K = this.renderer?.buffer;
        if (J.disposeRunner.remove(this),
            !!Z) {
            if (K)
                for (let V = 0; V < q.length; V++) {
                    let z = q[V]._glBuffers[this.CONTEXT_UID];
                    z && (z.refCount--,
                        z.refCount === 0 && !Q && K.dispose(q[V], Q))
                }
            if (!Q) {
                for (let V in Z)
                    if (V[0] === "g") {
                        let z = Z[V];
                        this._activeVao === z && this.unbind(),
                            $.deleteVertexArray(z)
                    }
            }
            delete J.glVertexArrayObjects[this.CONTEXT_UID]
        }
    }
    disposeAll(J) {
        let Q = Object.keys(this.managedGeometries);
        for (let Z = 0; Z < Q.length; Z++)
            this.disposeGeometry(this.managedGeometries[Q[Z]], J)
    }
    activateVao(J, Q) {
        let Z = this.gl
            , $ = this.CONTEXT_UID
            , q = this.renderer.buffer
            , K = J.buffers
            , V = J.attributes;
        J.indexBuffer && q.bind(J.indexBuffer);
        let z = null;
        for (let W in V) {
            let H = V[W]
                , Y = K[H.buffer]
                , U = Y._glBuffers[$];
            if (Q.attributeData[W]) {
                z !== U && (q.bind(Y),
                    z = U);
                let N = Q.attributeData[W].location;
                if (Z.enableVertexAttribArray(N),
                    Z.vertexAttribPointer(N, H.size, H.type || Z.FLOAT, H.normalized, H.stride, H.start),
                    H.instance)
                    if (this.hasInstance)
                        Z.vertexAttribDivisor(N, H.divisor);
                    else
                        throw new Error("geometry error, GPU Instancing is not supported on this device")
            }
        }
    }
    draw(J, Q, Z, $) {
        let { gl: q } = this
            , K = this._activeGeometry;
        if (K.indexBuffer) {
            let V = K.indexBuffer.data.BYTES_PER_ELEMENT
                , z = V === 2 ? q.UNSIGNED_SHORT : q.UNSIGNED_INT;
            (V === 2 || V === 4 && this.canUseUInt32ElementIndex) && (K.instanced ? q.drawElementsInstanced(J, Q || K.indexBuffer.data.length, z, (Z || 0) * V, $ || 1) : q.drawElements(J, Q || K.indexBuffer.data.length, z, (Z || 0) * V))
        } else
            K.instanced ? q.drawArraysInstanced(J, Z, Q || K.getSize(), $ || 1) : q.drawArrays(J, Z, Q || K.getSize());
        return this
    }
    unbind() {
        this.gl.bindVertexArray(null),
            this._activeVao = null,
            this._activeGeometry = null
    }
    destroy() {
        this.renderer = null
    }
}
var QD;
var ZD = O(() => {
    l8();
    r6();
    $7();
    QD = {
        5126: 4,
        5123: 2,
        5121: 1
    };
    dH.extension = {
        type: B8.RendererSystem,
        name: "geometry"
    };
    F8.add(dH)
}
);
class WI {
    constructor(J, Q) {
        this._texture = J,
            this.mapCoord = new t6,
            this.uClampFrame = new Float32Array(4),
            this.uClampOffset = new Float32Array(2),
            this._textureID = -1,
            this._updateID = 0,
            this.clampOffset = 0,
            this.clampMargin = typeof Q > "u" ? 0.5 : Q,
            this.isSimple = !1
    }
    get texture() {
        return this._texture
    }
    set texture(J) {
        this._texture = J,
            this._textureID = -1
    }
    multiplyUvs(J, Q) {
        Q === void 0 && (Q = J);
        let Z = this.mapCoord;
        for (let $ = 0; $ < J.length; $ += 2) {
            let q = J[$]
                , K = J[$ + 1];
            Q[$] = q * Z.a + K * Z.c + Z.tx,
                Q[$ + 1] = q * Z.b + K * Z.d + Z.ty
        }
        return Q
    }
    update(J) {
        let Q = this._texture;
        if (!Q || !Q.valid || !J && this._textureID === Q._updateID)
            return !1;
        this._textureID = Q._updateID,
            this._updateID++;
        let Z = Q._uvs;
        this.mapCoord.set(Z.x1 - Z.x0, Z.y1 - Z.y0, Z.x3 - Z.x0, Z.y3 - Z.y0, Z.x0, Z.y0);
        let { orig: $, trim: q } = Q;
        q && (QS.set($.width / q.width, 0, 0, $.height / q.height, -q.x / q.width, -q.y / q.height),
            this.mapCoord.append(QS));
        let K = Q.baseTexture
            , V = this.uClampFrame
            , z = this.clampMargin / K.resolution
            , W = this.clampOffset;
        return V[0] = (Q._frame.x + z + W) / K.width,
            V[1] = (Q._frame.y + z + W) / K.height,
            V[2] = (Q._frame.x + Q._frame.width - z + W) / K.width,
            V[3] = (Q._frame.y + Q._frame.height - z + W) / K.height,
            this.uClampOffset[0] = W / K.realWidth,
            this.uClampOffset[1] = W / K.realHeight,
            this.isSimple = Q._frame.width === K.width && Q._frame.height === K.height && Q.rotate === 0,
            !0
    }
}
var QS;
var $D = O(() => {
    TJ();
    QS = new t6
}
);
var ZS = `varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`;
var $S = () => { }
    ;
var qS = `attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;
var KS = () => { }
    ;
var HI;
var qD = O(() => {
    TJ();
    $D();
    hH();
    $S();
    KS();
    HI = class HI extends d5 {
        constructor(J, Q, Z) {
            let $ = null;
            typeof J != "string" && Q === void 0 && Z === void 0 && ($ = J,
                J = void 0,
                Q = void 0,
                Z = void 0),
                super(J || qS, Q || ZS, Z),
                this.maskSprite = $,
                this.maskMatrix = new t6
        }
        get maskSprite() {
            return this._maskSprite
        }
        set maskSprite(J) {
            this._maskSprite = J,
                this._maskSprite && (this._maskSprite.renderable = !1)
        }
        apply(J, Q, Z, $) {
            let q = this._maskSprite
                , K = q._texture;
            K.valid && (K.uvMatrix || (K.uvMatrix = new WI(K, 0)),
                K.uvMatrix.update(),
                this.uniforms.npmAlpha = K.baseTexture.alphaMode ? 0 : 1,
                this.uniforms.mask = K,
                this.uniforms.otherMatrix = J.calculateSpriteMatrix(this.maskMatrix, q).prepend(K.uvMatrix.mapCoord),
                this.uniforms.alpha = q.worldAlpha,
                this.uniforms.maskClamp = K.uvMatrix.uClampFrame,
                J.applyFilter(this, Q, Z, $))
        }
    }
}
);
class YI {
    constructor(J = null) {
        this.type = i7.NONE,
            this.autoDetect = !0,
            this.maskObject = J || null,
            this.pooled = !1,
            this.isMaskData = !0,
            this.resolution = null,
            this.multisample = d5.defaultMultisample,
            this.enabled = !0,
            this.colorMask = 15,
            this._filters = null,
            this._stencilCounter = 0,
            this._scissorCounter = 0,
            this._scissorRect = null,
            this._scissorRectLocal = null,
            this._colorMask = 15,
            this._target = null
    }
    get filter() {
        return this._filters ? this._filters[0] : null
    }
    set filter(J) {
        J ? this._filters ? this._filters[0] = J : this._filters = [J] : this._filters = null
    }
    reset() {
        this.pooled && (this.maskObject = null,
            this.type = i7.NONE,
            this.autoDetect = !0),
            this._target = null,
            this._scissorRectLocal = null
    }
    copyCountersOrReset(J) {
        J ? (this._stencilCounter = J._stencilCounter,
            this._scissorCounter = J._scissorCounter,
            this._scissorRect = J._scissorRect) : (this._stencilCounter = 0,
                this._scissorCounter = 0,
                this._scissorRect = null)
    }
}
var KD = O(() => {
    l8();
    hH()
}
);
class pH {
    constructor(J) {
        this.renderer = J,
            this.enableScissor = !0,
            this.alphaMaskPool = [],
            this.maskDataPool = [],
            this.maskStack = [],
            this.alphaMaskIndex = 0
    }
    setMaskStack(J) {
        this.maskStack = J,
            this.renderer.scissor.setMaskStack(J),
            this.renderer.stencil.setMaskStack(J)
    }
    push(J, Q) {
        let Z = Q;
        if (!Z.isMaskData) {
            let q = this.maskDataPool.pop() || new YI;
            q.pooled = !0,
                q.maskObject = Q,
                Z = q
        }
        let $ = this.maskStack.length !== 0 ? this.maskStack[this.maskStack.length - 1] : null;
        if (Z.copyCountersOrReset($),
            Z._colorMask = $ ? $._colorMask : 15,
            Z.autoDetect && this.detect(Z),
            Z._target = J,
            Z.type !== i7.SPRITE && this.maskStack.push(Z),
            Z.enabled)
            switch (Z.type) {
                case i7.SCISSOR:
                    this.renderer.scissor.push(Z);
                    break;
                case i7.STENCIL:
                    this.renderer.stencil.push(Z);
                    break;
                case i7.SPRITE:
                    Z.copyCountersOrReset(null),
                        this.pushSpriteMask(Z);
                    break;
                case i7.COLOR:
                    this.pushColorMask(Z);
                    break;
                default:
                    break
            }
        Z.type === i7.SPRITE && this.maskStack.push(Z)
    }
    pop(J) {
        let Q = this.maskStack.pop();
        if (!(!Q || Q._target !== J)) {
            if (Q.enabled)
                switch (Q.type) {
                    case i7.SCISSOR:
                        this.renderer.scissor.pop(Q);
                        break;
                    case i7.STENCIL:
                        this.renderer.stencil.pop(Q.maskObject);
                        break;
                    case i7.SPRITE:
                        this.popSpriteMask(Q);
                        break;
                    case i7.COLOR:
                        this.popColorMask(Q);
                        break;
                    default:
                        break
                }
            if (Q.reset(),
                Q.pooled && this.maskDataPool.push(Q),
                this.maskStack.length !== 0) {
                let Z = this.maskStack[this.maskStack.length - 1];
                Z.type === i7.SPRITE && Z._filters && (Z._filters[0].maskSprite = Z.maskObject)
            }
        }
    }
    detect(J) {
        let Q = J.maskObject;
        Q ? Q.isSprite ? J.type = i7.SPRITE : this.enableScissor && this.renderer.scissor.testScissor(J) ? J.type = i7.SCISSOR : J.type = i7.STENCIL : J.type = i7.COLOR
    }
    pushSpriteMask(J) {
        let { maskObject: Q } = J
            , Z = J._target
            , $ = J._filters;
        $ || ($ = this.alphaMaskPool[this.alphaMaskIndex],
            $ || ($ = this.alphaMaskPool[this.alphaMaskIndex] = [new HI])),
            $[0].resolution = J.resolution,
            $[0].multisample = J.multisample,
            $[0].maskSprite = Q;
        let q = Z.filterArea;
        Z.filterArea = Q.getBounds(!0),
            this.renderer.filter.push(Z, $),
            Z.filterArea = q,
            J._filters || this.alphaMaskIndex++
    }
    popSpriteMask(J) {
        this.renderer.filter.pop(),
            J._filters ? J._filters[0].maskSprite = null : (this.alphaMaskIndex--,
                this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite = null)
    }
    pushColorMask(J) {
        let Q = J._colorMask
            , Z = J._colorMask = Q & J.colorMask;
        Z !== Q && this.renderer.gl.colorMask((Z & 1) !== 0, (Z & 2) !== 0, (Z & 4) !== 0, (Z & 8) !== 0)
    }
    popColorMask(J) {
        let Q = J._colorMask
            , Z = this.maskStack.length > 0 ? this.maskStack[this.maskStack.length - 1]._colorMask : 15;
        Z !== Q && this.renderer.gl.colorMask((Z & 1) !== 0, (Z & 2) !== 0, (Z & 4) !== 0, (Z & 8) !== 0)
    }
    destroy() {
        this.renderer = null
    }
}
var VD = O(() => {
    l8();
    r6();
    qD();
    KD();
    pH.extension = {
        type: B8.RendererSystem,
        name: "mask"
    };
    F8.add(pH)
}
);
class uH {
    constructor(J) {
        this.renderer = J,
            this.maskStack = [],
            this.glConst = 0
    }
    getStackLength() {
        return this.maskStack.length
    }
    setMaskStack(J) {
        let { gl: Q } = this.renderer
            , Z = this.getStackLength();
        this.maskStack = J;
        let $ = this.getStackLength();
        $ !== Z && ($ === 0 ? Q.disable(this.glConst) : (Q.enable(this.glConst),
            this._useCurrent()))
    }
    _useCurrent() { }
    destroy() {
        this.renderer = null,
            this.maskStack = null
    }
}
var zD = () => { }
    ;
var VS, zS, WS, WD;
var HD = O(() => {
    r6();
    TJ();
    $7();
    zD();
    VS = new t6,
        zS = [],
        WS = class J extends uH {
            constructor(Q) {
                super(Q),
                    this.glConst = L8.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST
            }
            getStackLength() {
                let Q = this.maskStack[this.maskStack.length - 1];
                return Q ? Q._scissorCounter : 0
            }
            calcScissorRect(Q) {
                if (Q._scissorRectLocal)
                    return;
                let Z = Q._scissorRect
                    , { maskObject: $ } = Q
                    , { renderer: q } = this
                    , K = q.renderTexture
                    , V = $.getBounds(!0, zS.pop() ?? new _6);
                this.roundFrameToPixels(V, K.current ? K.current.resolution : q.resolution, K.sourceFrame, K.destinationFrame, q.projection.transform),
                    Z && V.fit(Z),
                    Q._scissorRectLocal = V
            }
            static isMatrixRotated(Q) {
                if (!Q)
                    return !1;
                let { a: Z, b: $, c: q, d: K } = Q;
                return (Math.abs($) > 0.0001 || Math.abs(q) > 0.0001) && (Math.abs(Z) > 0.0001 || Math.abs(K) > 0.0001)
            }
            testScissor(Q) {
                let { maskObject: Z } = Q;
                if (!Z.isFastRect || !Z.isFastRect() || J.isMatrixRotated(Z.worldTransform) || J.isMatrixRotated(this.renderer.projection.transform))
                    return !1;
                this.calcScissorRect(Q);
                let $ = Q._scissorRectLocal;
                return $.width > 0 && $.height > 0
            }
            roundFrameToPixels(Q, Z, $, q, K) {
                J.isMatrixRotated(K) || (K = K ? VS.copyFrom(K) : VS.identity(),
                    K.translate(-$.x, -$.y).scale(q.width / $.width, q.height / $.height).translate(q.x, q.y),
                    this.renderer.filter.transformAABB(K, Q),
                    Q.fit(q),
                    Q.x = Math.round(Q.x * Z),
                    Q.y = Math.round(Q.y * Z),
                    Q.width = Math.round(Q.width * Z),
                    Q.height = Math.round(Q.height * Z))
            }
            push(Q) {
                Q._scissorRectLocal || this.calcScissorRect(Q);
                let { gl: Z } = this.renderer;
                Q._scissorRect || Z.enable(Z.SCISSOR_TEST),
                    Q._scissorCounter++,
                    Q._scissorRect = Q._scissorRectLocal,
                    this._useCurrent()
            }
            pop(Q) {
                let { gl: Z } = this.renderer;
                Q && zS.push(Q._scissorRectLocal),
                    this.getStackLength() > 0 ? this._useCurrent() : Z.disable(Z.SCISSOR_TEST)
            }
            _useCurrent() {
                let Q = this.maskStack[this.maskStack.length - 1]._scissorRect, Z;
                this.renderer.renderTexture.current ? Z = Q.y : Z = this.renderer.height - Q.height - Q.y,
                    this.renderer.gl.scissor(Q.x, Z, Q.width, Q.height)
            }
        }
        ;
    WS.extension = {
        type: B8.RendererSystem,
        name: "scissor"
    };
    WD = WS;
    F8.add(WD)
}
);
var lH;
var YD = O(() => {
    r6();
    $7();
    zD();
    lH = class lH extends uH {
        constructor(J) {
            super(J),
                this.glConst = L8.ADAPTER.getWebGLRenderingContext().STENCIL_TEST
        }
        getStackLength() {
            let J = this.maskStack[this.maskStack.length - 1];
            return J ? J._stencilCounter : 0
        }
        push(J) {
            let Q = J.maskObject
                , { gl: Z } = this.renderer
                , $ = J._stencilCounter;
            $ === 0 && (this.renderer.framebuffer.forceStencil(),
                Z.clearStencil(0),
                Z.clear(Z.STENCIL_BUFFER_BIT),
                Z.enable(Z.STENCIL_TEST)),
                J._stencilCounter++;
            let q = J._colorMask;
            q !== 0 && (J._colorMask = 0,
                Z.colorMask(!1, !1, !1, !1)),
                Z.stencilFunc(Z.EQUAL, $, 4294967295),
                Z.stencilOp(Z.KEEP, Z.KEEP, Z.INCR),
                Q.renderable = !0,
                Q.render(this.renderer),
                this.renderer.batch.flush(),
                Q.renderable = !1,
                q !== 0 && (J._colorMask = q,
                    Z.colorMask((q & 1) !== 0, (q & 2) !== 0, (q & 4) !== 0, (q & 8) !== 0)),
                this._useCurrent()
        }
        pop(J) {
            let Q = this.renderer.gl;
            if (this.getStackLength() === 0)
                Q.disable(Q.STENCIL_TEST);
            else {
                let Z = this.maskStack.length !== 0 ? this.maskStack[this.maskStack.length - 1] : null
                    , $ = Z ? Z._colorMask : 15;
                $ !== 0 && (Z._colorMask = 0,
                    Q.colorMask(!1, !1, !1, !1)),
                    Q.stencilOp(Q.KEEP, Q.KEEP, Q.DECR),
                    J.renderable = !0,
                    J.render(this.renderer),
                    this.renderer.batch.flush(),
                    J.renderable = !1,
                    $ !== 0 && (Z._colorMask = $,
                        Q.colorMask(($ & 1) !== 0, ($ & 2) !== 0, ($ & 4) !== 0, ($ & 8) !== 0)),
                    this._useCurrent()
            }
        }
        _useCurrent() {
            let J = this.renderer.gl;
            J.stencilFunc(J.EQUAL, this.getStackLength(), 4294967295),
                J.stencilOp(J.KEEP, J.KEEP, J.KEEP)
        }
    }
        ;
    lH.extension = {
        type: B8.RendererSystem,
        name: "stencil"
    };
    F8.add(lH)
}
);
class oH {
    constructor(J) {
        this.renderer = J,
            this.plugins = {},
            Object.defineProperties(this.plugins, {
                extract: {
                    enumerable: !1,
                    get() {
                        return j6("7.0.0", "renderer.plugins.extract has moved to renderer.extract"),
                            J.extract
                    }
                },
                prepare: {
                    enumerable: !1,
                    get() {
                        return j6("7.0.0", "renderer.plugins.prepare has moved to renderer.prepare"),
                            J.prepare
                    }
                },
                interaction: {
                    enumerable: !1,
                    get() {
                        return j6("7.0.0", "renderer.plugins.interaction has been deprecated, use renderer.events"),
                            J.events
                    }
                }
            })
    }
    init() {
        let J = this.rendererPlugins;
        for (let Q in J)
            this.plugins[Q] = new J[Q](this.renderer)
    }
    destroy() {
        for (let J in this.plugins)
            this.plugins[J].destroy(),
                this.plugins[J] = null
    }
}
var XD = O(() => {
    r6();
    OJ();
    oH.extension = {
        type: [B8.RendererSystem, B8.CanvasRendererSystem],
        name: "_plugin"
    };
    F8.add(oH)
}
);
class nH {
    constructor(J) {
        this.renderer = J,
            this.destinationFrame = null,
            this.sourceFrame = null,
            this.defaultFrame = null,
            this.projectionMatrix = new t6,
            this.transform = null
    }
    update(J, Q, Z, $) {
        this.destinationFrame = J || this.destinationFrame || this.defaultFrame,
            this.sourceFrame = Q || this.sourceFrame || J,
            this.calculateProjection(this.destinationFrame, this.sourceFrame, Z, $),
            this.transform && this.projectionMatrix.append(this.transform);
        let q = this.renderer;
        q.globalUniforms.uniforms.projectionMatrix = this.projectionMatrix,
            q.globalUniforms.update(),
            q.shader.shader && q.shader.syncUniformGroup(q.shader.shader.uniforms.globals)
    }
    calculateProjection(J, Q, Z, $) {
        let q = this.projectionMatrix
            , K = $ ? -1 : 1;
        q.identity(),
            q.a = 1 / Q.width * 2,
            q.d = K * (1 / Q.height * 2),
            q.tx = -1 - Q.x * q.a,
            q.ty = -K - Q.y * q.d
    }
    setTransform(J) { }
    destroy() {
        this.renderer = null
    }
}
var UD = O(() => {
    r6();
    TJ();
    nH.extension = {
        type: B8.RendererSystem,
        name: "projection"
    };
    F8.add(nH)
}
);
class sH {
    constructor(J) {
        this.renderer = J,
            this._tempMatrix = new t6
    }
    generateTexture(J, Q) {
        let { region: Z, ...$ } = Q || {}
            , q = Z?.copyTo(HS) || J.getLocalBounds(HS, !0)
            , K = $.resolution || this.renderer.resolution;
        q.width = Math.max(q.width, 1 / K),
            q.height = Math.max(q.height, 1 / K),
            $.width = q.width,
            $.height = q.height,
            $.resolution = K,
            $.multisample ?? ($.multisample = this.renderer.multisample);
        let V = W1.create($);
        this._tempMatrix.tx = -q.x,
            this._tempMatrix.ty = -q.y;
        let z = J.transform;
        return J.transform = Kl,
            this.renderer.render(J, {
                renderTexture: V,
                transform: this._tempMatrix,
                skipUpdateTransform: !!J.parent,
                blit: !0
            }),
            J.transform = z,
            V
    }
    destroy() { }
}
var Kl, HS;
var ND = O(() => {
    r6();
    TJ();
    ZI();
    Kl = new bO,
        HS = new _6;
    sH.extension = {
        type: [B8.RendererSystem, B8.CanvasRendererSystem],
        name: "textureGenerator"
    };
    F8.add(sH)
}
);
class aH {
    constructor(J) {
        this.renderer = J,
            this.defaultMaskStack = [],
            this.current = null,
            this.sourceFrame = new _6,
            this.destinationFrame = new _6,
            this.viewportFrame = new _6
    }
    contextChange() {
        let J = this.renderer?.gl.getContextAttributes();
        this._rendererPremultipliedAlpha = !!(J && J.alpha && J.premultipliedAlpha)
    }
    bind(J = null, Q, Z) {
        let $ = this.renderer;
        this.current = J;
        let q, K, V;
        J ? (q = J.baseTexture,
            V = q.resolution,
            Q || (H1.width = J.frame.width,
                H1.height = J.frame.height,
                Q = H1),
            Z || (iH.x = J.frame.x,
                iH.y = J.frame.y,
                iH.width = Q.width,
                iH.height = Q.height,
                Z = iH),
            K = q.framebuffer) : (V = $.resolution,
                Q || (H1.width = $._view.screen.width,
                    H1.height = $._view.screen.height,
                    Q = H1),
                Z || (Z = H1,
                    Z.width = Q.width,
                    Z.height = Q.height));
        let z = this.viewportFrame;
        z.x = Z.x * V,
            z.y = Z.y * V,
            z.width = Z.width * V,
            z.height = Z.height * V,
            J || (z.y = $.view.height - (z.y + z.height)),
            z.ceil(),
            this.renderer.framebuffer.bind(K, z),
            this.renderer.projection.update(Z, Q, V, !K),
            J ? this.renderer.mask.setMaskStack(q.maskStack) : this.renderer.mask.setMaskStack(this.defaultMaskStack),
            this.sourceFrame.copyFrom(Q),
            this.destinationFrame.copyFrom(Z)
    }
    clear(J, Q) {
        let Z = this.current ? this.current.baseTexture.clear : this.renderer.background.backgroundColor
            , $ = w9.shared.setValue(J || Z);
        (this.current && this.current.baseTexture.alphaMode > 0 || !this.current && this._rendererPremultipliedAlpha) && $.premultiply($.alpha);
        let q = this.destinationFrame
            , K = this.current ? this.current.baseTexture : this.renderer._view.screen
            , V = q.width !== K.width || q.height !== K.height;
        if (V) {
            let { x: z, y: W, width: H, height: Y } = this.viewportFrame;
            z = Math.round(z),
                W = Math.round(W),
                H = Math.round(H),
                Y = Math.round(Y),
                this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),
                this.renderer.gl.scissor(z, W, H, Y)
        }
        this.renderer.framebuffer.clear($.red, $.green, $.blue, $.alpha, Q),
            V && this.renderer.scissor.pop()
    }
    resize() {
        this.bind(null)
    }
    reset() {
        this.bind(null)
    }
    destroy() {
        this.renderer = null
    }
}
var H1, iH;
var wD = O(() => {
    hZ();
    r6();
    TJ();
    H1 = new _6,
        iH = new _6;
    aH.extension = {
        type: B8.RendererSystem,
        name: "renderTexture"
    };
    F8.add(aH)
}
);
class XI {
    constructor(J, Q) {
        this.program = J,
            this.uniformData = Q,
            this.uniformGroups = {},
            this.uniformDirtyGroups = {},
            this.uniformBufferBindings = {}
    }
    destroy() {
        this.uniformData = null,
            this.uniformGroups = null,
            this.uniformDirtyGroups = null,
            this.uniformBufferBindings = null,
            this.program = null
    }
}
var jD = () => { }
    ;
function YS(J, Q) {
    let Z = {}
        , $ = Q.getProgramParameter(J, Q.ACTIVE_ATTRIBUTES);
    for (let q = 0; q < $; q++) {
        let K = Q.getActiveAttrib(J, q);
        if (K.name.startsWith("gl_"))
            continue;
        let V = TH(Q, K.type)
            , z = {
                type: V,
                name: K.name,
                size: SH(V),
                location: Q.getAttribLocation(J, K.name)
            };
        Z[K.name] = z
    }
    return Z
}
var XS = O(() => {
    xO();
    mO()
}
);
function US(J, Q) {
    let Z = {}
        , $ = Q.getProgramParameter(J, Q.ACTIVE_UNIFORMS);
    for (let q = 0; q < $; q++) {
        let K = Q.getActiveUniform(J, q)
            , V = K.name.replace(/\[.*?\]$/, "")
            , z = !!K.name.match(/\[.*?\]$/)
            , W = TH(Q, K.type);
        Z[V] = {
            name: V,
            index: q,
            type: W,
            size: K.size,
            isArray: z,
            value: bH(W, K.size)
        }
    }
    return Z
}
var NS = O(() => {
    SO();
    mO()
}
);
function BD(J, Q) {
    let Z = vO(J, J.VERTEX_SHADER, Q.vertexSrc)
        , $ = vO(J, J.FRAGMENT_SHADER, Q.fragmentSrc)
        , q = J.createProgram();
    J.attachShader(q, Z),
        J.attachShader(q, $);
    let K = Q.extra?.transformFeedbackVaryings;
    if (K && (typeof J.transformFeedbackVaryings != "function" || J.transformFeedbackVaryings(q, K.names, K.bufferMode === "separate" ? J.SEPARATE_ATTRIBS : J.INTERLEAVED_ATTRIBS)),
        J.linkProgram(q),
        J.getProgramParameter(q, J.LINK_STATUS) || fP(J, q, Z, $),
        Q.attributeData = YS(q, J),
        Q.uniformData = US(q, J),
        !/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(Q.vertexSrc)) {
        let z = Object.keys(Q.attributeData);
        z.sort((W, H) => W > H ? 1 : -1);
        for (let W = 0; W < z.length; W++)
            Q.attributeData[z[W]].location = W,
                J.bindAttribLocation(q, W, z[W]);
        J.linkProgram(q)
    }
    J.deleteShader(Z),
        J.deleteShader($);
    let V = {};
    for (let z in Q.uniformData) {
        let W = Q.uniformData[z];
        V[z] = {
            location: J.getUniformLocation(q, z),
            value: bH(W.type, W.size)
        }
    }
    return new XI(q, V)
}
var kD = O(() => {
    jD();
    RP();
    SO();
    XS();
    NS();
    hP()
}
);
function Vl(J, Q, Z, $, q) {
    Z.buffer.update(q)
}
function jS(J) {
    let Q = J.map((K) => ({
        data: K,
        offset: 0,
        dataLen: 0,
        dirty: 0
    }))
        , Z = 0
        , $ = 0
        , q = 0;
    for (let K = 0; K < Q.length; K++) {
        let V = Q[K];
        if (Z = wS[V.data.type],
            V.data.size > 1 && (Z = Math.max(Z, 16) * V.data.size),
            V.dataLen = Z,
            $ % Z !== 0 && $ < 16) {
            let z = $ % Z % 16;
            $ += z,
                q += z
        }
        $ + Z > 16 ? (q = Math.ceil(q / 16) * 16,
            V.offset = q,
            q += Z,
            $ = Z) : (V.offset = q,
                $ += Z,
                q += Z)
    }
    return q = Math.ceil(q / 16) * 16,
    {
        uboElements: Q,
        size: q
    }
}
function BS(J, Q) {
    let Z = [];
    for (let $ in J)
        Q[$] && Z.push(Q[$]);
    return Z.sort(($, q) => $.index - q.index),
        Z
}
function CD(J, Q) {
    if (!J.autoManage)
        return {
            size: 0,
            syncFunc: Vl
        };
    let Z = BS(J.uniforms, Q)
        , { uboElements: $, size: q } = jS(Z)
        , K = [`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];
    for (let V = 0; V < $.length; V++) {
        let z = $[V]
            , W = J.uniforms[z.data.name]
            , H = z.data.name
            , Y = !1;
        for (let U = 0; U < i9.length; U++) {
            let N = i9[U];
            if (N.codeUbo && N.test(z.data, W)) {
                K.push(`offset = ${z.offset / 4};`, i9[U].codeUbo(z.data.name, W)),
                    Y = !0;
                break
            }
        }
        if (!Y)
            if (z.data.size > 1) {
                let U = SH(z.data.type)
                    , N = Math.max(wS[z.data.type] / 16, 1)
                    , j = U / N
                    , k = (4 - j % 4) % 4;
                K.push(`
                cv = ud.${H}.value;
                v = uv.${H};
                offset = ${z.offset / 4};

                t = 0;

                for(var i=0; i < ${z.data.size * N}; i++)
                {
                    for(var j = 0; j < ${j}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${k};
                }

                `)
            } else {
                let U = zl[z.data.type];
                K.push(`
                cv = ud.${H}.value;
                v = uv.${H};
                offset = ${z.offset / 4};
                ${U};
                `)
            }
    }
    return K.push(`
       renderer.buffer.update(buffer);
    `),
    {
        size: q,
        syncFunc: new Function("ud", "uv", "renderer", "syncData", "buffer", K.join(`
`))
    }
}
var zl, wS;
var OD = O(() => {
    uO();
    vH();
    xO();
    zl = {
        float: `
        data[offset] = v;
    `,
        vec2: `
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,
        vec3: `
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,
        vec4: `
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,
        mat2: `
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,
        mat3: `
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,
        mat4: `
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `
    },
        wS = {
            float: 4,
            vec2: 8,
            vec3: 12,
            vec4: 16,
            int: 4,
            ivec2: 8,
            ivec3: 12,
            ivec4: 16,
            uint: 4,
            uvec2: 8,
            uvec3: 12,
            uvec4: 16,
            bool: 4,
            bvec2: 8,
            bvec3: 12,
            bvec4: 16,
            mat2: 32,
            mat3: 48,
            mat4: 64
        }
}
);
class rH {
    constructor(J) {
        this.destroyed = !1,
            this.renderer = J,
            this.systemCheck(),
            this.gl = null,
            this.shader = null,
            this.program = null,
            this.cache = {},
            this._uboCache = {},
            this.id = Wl++
    }
    systemCheck() {
        if (!dO())
            throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")
    }
    contextChange(J) {
        this.gl = J,
            this.reset()
    }
    bind(J, Q) {
        J.disposeRunner.add(this),
            J.uniforms.globals = this.renderer.globalUniforms;
        let Z = J.program
            , $ = Z.glPrograms[this.renderer.CONTEXT_UID] || this.generateProgram(J);
        return this.shader = J,
            this.program !== Z && (this.program = Z,
                this.gl.useProgram($.program)),
            Q || (UI.textureCount = 0,
                UI.uboCount = 0,
                this.syncUniformGroup(J.uniformGroup, UI)),
            $
    }
    setUniforms(J) {
        let Q = this.shader.program
            , Z = Q.glPrograms[this.renderer.CONTEXT_UID];
        Q.syncUniforms(Z.uniformData, J, this.renderer)
    }
    syncUniformGroup(J, Q) {
        let Z = this.getGlProgram();
        (!J.static || J.dirtyId !== Z.uniformDirtyGroups[J.id]) && (Z.uniformDirtyGroups[J.id] = J.dirtyId,
            this.syncUniforms(J, Z, Q))
    }
    syncUniforms(J, Q, Z) {
        (J.syncUniforms[this.shader.program.id] || this.createSyncGroups(J))(Q.uniformData, J.uniforms, this.renderer, Z)
    }
    createSyncGroups(J) {
        let Q = this.getSignature(J, this.shader.program.uniformData, "u");
        return this.cache[Q] || (this.cache[Q] = vP(J, this.shader.program.uniformData)),
            J.syncUniforms[this.shader.program.id] = this.cache[Q],
            J.syncUniforms[this.shader.program.id]
    }
    syncUniformBufferGroup(J, Q) {
        let Z = this.getGlProgram();
        if (!J.static || J.dirtyId !== 0 || !Z.uniformGroups[J.id]) {
            J.dirtyId = 0;
            let $ = Z.uniformGroups[J.id] || this.createSyncBufferGroup(J, Z, Q);
            J.buffer.update(),
                $(Z.uniformData, J.uniforms, this.renderer, UI, J.buffer)
        }
        this.renderer.buffer.bindBufferBase(J.buffer, Z.uniformBufferBindings[Q])
    }
    createSyncBufferGroup(J, Q, Z) {
        let { gl: $ } = this.renderer;
        this.renderer.buffer.bind(J.buffer);
        let q = this.gl.getUniformBlockIndex(Q.program, Z);
        Q.uniformBufferBindings[Z] = this.shader.uniformBindCount,
            $.uniformBlockBinding(Q.program, q, this.shader.uniformBindCount),
            this.shader.uniformBindCount++;
        let K = this.getSignature(J, this.shader.program.uniformData, "ubo")
            , V = this._uboCache[K];
        if (V || (V = this._uboCache[K] = CD(J, this.shader.program.uniformData)),
            J.autoManage) {
            let z = new Float32Array(V.size / 4);
            J.buffer.update(z)
        }
        return Q.uniformGroups[J.id] = V.syncFunc,
            Q.uniformGroups[J.id]
    }
    getSignature(J, Q, Z) {
        let $ = J.uniforms
            , q = [`${Z}-`];
        for (let K in $)
            q.push(K),
                Q[K] && q.push(Q[K].type);
        return q.join("-")
    }
    getGlProgram() {
        return this.shader ? this.shader.program.glPrograms[this.renderer.CONTEXT_UID] : null
    }
    generateProgram(J) {
        let Q = this.gl
            , Z = J.program
            , $ = BD(Q, Z);
        return Z.glPrograms[this.renderer.CONTEXT_UID] = $,
            $
    }
    reset() {
        this.program = null,
            this.shader = null
    }
    disposeShader(J) {
        this.shader === J && (this.shader = null)
    }
    destroy() {
        this.renderer = null,
            this.destroyed = !0
    }
}
var Wl = 0, UI;
var ID = O(() => {
    r6();
    uO();
    kD();
    OD();
    pO();
    SP();
    UI = {
        textureCount: 0,
        uboCount: 0
    };
    rH.extension = {
        type: B8.RendererSystem,
        name: "shader"
    };
    F8.add(rH)
}
);
class cZ {
    constructor(J) {
        this.renderer = J
    }
    run(J) {
        let { renderer: Q } = this;
        Q.runners.init.emit(Q.options),
            J.hello,
            Q.resize(Q.screen.width, Q.screen.height)
    }
    destroy() { }
}
var NI = O(() => {
    r6();
    cZ.defaultOptions = {
        hello: !1
    },
        cZ.extension = {
            type: [B8.RendererSystem, B8.CanvasRendererSystem],
            name: "startup"
        };
    F8.add(cZ)
}
);
function kS(J, Q = []) {
    return Q[T8.NORMAL] = [J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.ADD] = [J.ONE, J.ONE],
        Q[T8.MULTIPLY] = [J.DST_COLOR, J.ONE_MINUS_SRC_ALPHA, J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.SCREEN] = [J.ONE, J.ONE_MINUS_SRC_COLOR, J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.OVERLAY] = [J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.DARKEN] = [J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.LIGHTEN] = [J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.COLOR_DODGE] = [J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.COLOR_BURN] = [J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.HARD_LIGHT] = [J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.SOFT_LIGHT] = [J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.DIFFERENCE] = [J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.EXCLUSION] = [J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.HUE] = [J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.SATURATION] = [J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.COLOR] = [J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.LUMINOSITY] = [J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.NONE] = [0, 0],
        Q[T8.NORMAL_NPM] = [J.SRC_ALPHA, J.ONE_MINUS_SRC_ALPHA, J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.ADD_NPM] = [J.SRC_ALPHA, J.ONE, J.ONE, J.ONE],
        Q[T8.SCREEN_NPM] = [J.SRC_ALPHA, J.ONE_MINUS_SRC_COLOR, J.ONE, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.SRC_IN] = [J.DST_ALPHA, J.ZERO],
        Q[T8.SRC_OUT] = [J.ONE_MINUS_DST_ALPHA, J.ZERO],
        Q[T8.SRC_ATOP] = [J.DST_ALPHA, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.DST_OVER] = [J.ONE_MINUS_DST_ALPHA, J.ONE],
        Q[T8.DST_IN] = [J.ZERO, J.SRC_ALPHA],
        Q[T8.DST_OUT] = [J.ZERO, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.DST_ATOP] = [J.ONE_MINUS_DST_ALPHA, J.SRC_ALPHA],
        Q[T8.XOR] = [J.ONE_MINUS_DST_ALPHA, J.ONE_MINUS_SRC_ALPHA],
        Q[T8.SUBTRACT] = [J.ONE, J.ONE, J.ONE, J.ONE, J.FUNC_REVERSE_SUBTRACT, J.FUNC_ADD],
        Q
}
var CS = O(() => {
    l8()
}
);
var Hl = 0, Yl = 1, Xl = 2, Ul = 3, Nl = 4, wl = 5, OS = class J {
    constructor() {
        this.gl = null,
            this.stateId = 0,
            this.polygonOffset = 0,
            this.blendMode = T8.NONE,
            this._blendEq = !1,
            this.map = [],
            this.map[Hl] = this.setBlend,
            this.map[Yl] = this.setOffset,
            this.map[Xl] = this.setCullFace,
            this.map[Ul] = this.setDepthTest,
            this.map[Nl] = this.setFrontFace,
            this.map[wl] = this.setDepthMask,
            this.checks = [],
            this.defaultState = new n9,
            this.defaultState.blend = !0
    }
    contextChange(Q) {
        this.gl = Q,
            this.blendModes = kS(Q),
            this.set(this.defaultState),
            this.reset()
    }
    set(Q) {
        if (Q = Q || this.defaultState,
            this.stateId !== Q.data) {
            let Z = this.stateId ^ Q.data
                , $ = 0;
            for (; Z;)
                Z & 1 && this.map[$].call(this, !!(Q.data & 1 << $)),
                    Z = Z >> 1,
                    $++;
            this.stateId = Q.data
        }
        for (let Z = 0; Z < this.checks.length; Z++)
            this.checks[Z](this, Q)
    }
    forceState(Q) {
        Q = Q || this.defaultState;
        for (let Z = 0; Z < this.map.length; Z++)
            this.map[Z].call(this, !!(Q.data & 1 << Z));
        for (let Z = 0; Z < this.checks.length; Z++)
            this.checks[Z](this, Q);
        this.stateId = Q.data
    }
    setBlend(Q) {
        this.updateCheck(J.checkBlendMode, Q),
            this.gl[Q ? "enable" : "disable"](this.gl.BLEND)
    }
    setOffset(Q) {
        this.updateCheck(J.checkPolygonOffset, Q),
            this.gl[Q ? "enable" : "disable"](this.gl.POLYGON_OFFSET_FILL)
    }
    setDepthTest(Q) {
        this.gl[Q ? "enable" : "disable"](this.gl.DEPTH_TEST)
    }
    setDepthMask(Q) {
        this.gl.depthMask(Q)
    }
    setCullFace(Q) {
        this.gl[Q ? "enable" : "disable"](this.gl.CULL_FACE)
    }
    setFrontFace(Q) {
        this.gl.frontFace(this.gl[Q ? "CW" : "CCW"])
    }
    setBlendMode(Q) {
        if (Q === this.blendMode)
            return;
        this.blendMode = Q;
        let Z = this.blendModes[Q]
            , $ = this.gl;
        Z.length === 2 ? $.blendFunc(Z[0], Z[1]) : $.blendFuncSeparate(Z[0], Z[1], Z[2], Z[3]),
            Z.length === 6 ? (this._blendEq = !0,
                $.blendEquationSeparate(Z[4], Z[5])) : this._blendEq && (this._blendEq = !1,
                    $.blendEquationSeparate($.FUNC_ADD, $.FUNC_ADD))
    }
    setPolygonOffset(Q, Z) {
        this.gl.polygonOffset(Q, Z)
    }
    reset() {
        this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL, !1),
            this.forceState(this.defaultState),
            this._blendEq = !0,
            this.blendMode = -1,
            this.setBlendMode(0)
    }
    updateCheck(Q, Z) {
        let $ = this.checks.indexOf(Q);
        Z && $ === -1 ? this.checks.push(Q) : !Z && $ !== -1 && this.checks.splice($, 1)
    }
    static checkBlendMode(Q, Z) {
        Q.setBlendMode(Z.blendMode)
    }
    static checkPolygonOffset(Q, Z) {
        Q.setPolygonOffset(1, Z.polygonOffset)
    }
    destroy() {
        this.gl = null
    }
}
    , LD;
var FD = O(() => {
    l8();
    r6();
    MH();
    CS();
    OS.extension = {
        type: B8.RendererSystem,
        name: "state"
    };
    LD = OS;
    F8.add(LD)
}
);
var tH;
var wI = O(() => {
    fQ();
    OJ();
    tH = class tH extends J1.default {
        constructor() {
            super(...arguments),
                this.runners = {},
                this._systemsHash = {}
        }
        setup(J) {
            this.addRunners(...J.runners);
            let Q = (J.priority ?? []).filter(($) => J.systems[$])
                , Z = [...Q, ...Object.keys(J.systems).filter(($) => !Q.includes($))];
            for (let $ of Z)
                this.addSystem(J.systems[$], $)
        }
        addRunners(...J) {
            J.forEach((Q) => {
                this.runners[Q] = new a7(Q)
            }
            )
        }
        addSystem(J, Q) {
            let Z = new J(this);
            if (this[Q])
                throw new Error(`Whoops! The name "${Q}" is already in use`);
            this[Q] = Z,
                this._systemsHash[Q] = Z;
            for (let $ in this.runners)
                this.runners[$].add(Z);
            return this
        }
        emitWithCustomOptions(J, Q) {
            let Z = Object.keys(this._systemsHash);
            J.items.forEach(($) => {
                let q = Z.find((K) => this._systemsHash[K] === $);
                $[J.name](Q[q])
            }
            )
        }
        destroy() {
            Object.values(this.runners).forEach((J) => {
                J.destroy()
            }
            ),
                this._systemsHash = {}
        }
    }
}
);
var eH = class J {
    constructor(Q) {
        this.renderer = Q,
            this.count = 0,
            this.checkCount = 0,
            this.maxIdle = J.defaultMaxIdle,
            this.checkCountMax = J.defaultCheckCountMax,
            this.mode = J.defaultMode
    }
    postrender() {
        this.renderer.objectRenderer.renderingToScreen && (this.count++,
            this.mode !== qO.MANUAL && (this.checkCount++,
                this.checkCount > this.checkCountMax && (this.checkCount = 0,
                    this.run())))
    }
    run() {
        let Q = this.renderer.texture
            , Z = Q.managedTextures
            , $ = !1;
        for (let q = 0; q < Z.length; q++) {
            let K = Z[q];
            K.resource && this.count - K.touched > this.maxIdle && (Q.destroyTexture(K, !0),
                Z[q] = null,
                $ = !0)
        }
        if ($) {
            let q = 0;
            for (let K = 0; K < Z.length; K++)
                Z[K] !== null && (Z[q++] = Z[K]);
            Z.length = q
        }
    }
    unload(Q) {
        let Z = this.renderer.texture
            , $ = Q._texture;
        $ && !$.framebuffer && Z.destroyTexture($);
        for (let q = Q.children.length - 1; q >= 0; q--)
            this.unload(Q.children[q])
    }
    destroy() {
        this.renderer = null
    }
}
    , a9;
var jI = O(() => {
    l8();
    r6();
    eH.defaultMode = qO.AUTO,
        eH.defaultMaxIdle = 3600,
        eH.defaultCheckCountMax = 600,
        eH.extension = {
            type: B8.RendererSystem,
            name: "textureGC"
        };
    a9 = eH;
    F8.add(a9)
}
);
class S4 {
    constructor(J) {
        this.texture = J,
            this.width = -1,
            this.height = -1,
            this.dirtyId = -1,
            this.dirtyStyleId = -1,
            this.mipmap = !1,
            this.wrapMode = 33071,
            this.type = r8.UNSIGNED_BYTE,
            this.internalFormat = r0.RGBA,
            this.samplerType = 0
    }
}
var GD = O(() => {
    l8()
}
);
function IS(J) {
    let Q;
    return "WebGL2RenderingContext" in globalThis && J instanceof globalThis.WebGL2RenderingContext ? Q = {
        [J.RGB]: Q8.FLOAT,
        [J.RGBA]: Q8.FLOAT,
        [J.ALPHA]: Q8.FLOAT,
        [J.LUMINANCE]: Q8.FLOAT,
        [J.LUMINANCE_ALPHA]: Q8.FLOAT,
        [J.R8]: Q8.FLOAT,
        [J.R8_SNORM]: Q8.FLOAT,
        [J.RG8]: Q8.FLOAT,
        [J.RG8_SNORM]: Q8.FLOAT,
        [J.RGB8]: Q8.FLOAT,
        [J.RGB8_SNORM]: Q8.FLOAT,
        [J.RGB565]: Q8.FLOAT,
        [J.RGBA4]: Q8.FLOAT,
        [J.RGB5_A1]: Q8.FLOAT,
        [J.RGBA8]: Q8.FLOAT,
        [J.RGBA8_SNORM]: Q8.FLOAT,
        [J.RGB10_A2]: Q8.FLOAT,
        [J.RGB10_A2UI]: Q8.FLOAT,
        [J.SRGB8]: Q8.FLOAT,
        [J.SRGB8_ALPHA8]: Q8.FLOAT,
        [J.R16F]: Q8.FLOAT,
        [J.RG16F]: Q8.FLOAT,
        [J.RGB16F]: Q8.FLOAT,
        [J.RGBA16F]: Q8.FLOAT,
        [J.R32F]: Q8.FLOAT,
        [J.RG32F]: Q8.FLOAT,
        [J.RGB32F]: Q8.FLOAT,
        [J.RGBA32F]: Q8.FLOAT,
        [J.R11F_G11F_B10F]: Q8.FLOAT,
        [J.RGB9_E5]: Q8.FLOAT,
        [J.R8I]: Q8.INT,
        [J.R8UI]: Q8.UINT,
        [J.R16I]: Q8.INT,
        [J.R16UI]: Q8.UINT,
        [J.R32I]: Q8.INT,
        [J.R32UI]: Q8.UINT,
        [J.RG8I]: Q8.INT,
        [J.RG8UI]: Q8.UINT,
        [J.RG16I]: Q8.INT,
        [J.RG16UI]: Q8.UINT,
        [J.RG32I]: Q8.INT,
        [J.RG32UI]: Q8.UINT,
        [J.RGB8I]: Q8.INT,
        [J.RGB8UI]: Q8.UINT,
        [J.RGB16I]: Q8.INT,
        [J.RGB16UI]: Q8.UINT,
        [J.RGB32I]: Q8.INT,
        [J.RGB32UI]: Q8.UINT,
        [J.RGBA8I]: Q8.INT,
        [J.RGBA8UI]: Q8.UINT,
        [J.RGBA16I]: Q8.INT,
        [J.RGBA16UI]: Q8.UINT,
        [J.RGBA32I]: Q8.INT,
        [J.RGBA32UI]: Q8.UINT,
        [J.DEPTH_COMPONENT16]: Q8.FLOAT,
        [J.DEPTH_COMPONENT24]: Q8.FLOAT,
        [J.DEPTH_COMPONENT32F]: Q8.FLOAT,
        [J.DEPTH_STENCIL]: Q8.FLOAT,
        [J.DEPTH24_STENCIL8]: Q8.FLOAT,
        [J.DEPTH32F_STENCIL8]: Q8.FLOAT
    } : Q = {
        [J.RGB]: Q8.FLOAT,
        [J.RGBA]: Q8.FLOAT,
        [J.ALPHA]: Q8.FLOAT,
        [J.LUMINANCE]: Q8.FLOAT,
        [J.LUMINANCE_ALPHA]: Q8.FLOAT,
        [J.DEPTH_STENCIL]: Q8.FLOAT
    },
        Q
}
var LS = O(() => {
    l8()
}
);
function FS(J) {
    let Q;
    return "WebGL2RenderingContext" in globalThis && J instanceof globalThis.WebGL2RenderingContext ? Q = {
        [r8.UNSIGNED_BYTE]: {
            [r0.RGBA]: J.RGBA8,
            [r0.RGB]: J.RGB8,
            [r0.RG]: J.RG8,
            [r0.RED]: J.R8,
            [r0.RGBA_INTEGER]: J.RGBA8UI,
            [r0.RGB_INTEGER]: J.RGB8UI,
            [r0.RG_INTEGER]: J.RG8UI,
            [r0.RED_INTEGER]: J.R8UI,
            [r0.ALPHA]: J.ALPHA,
            [r0.LUMINANCE]: J.LUMINANCE,
            [r0.LUMINANCE_ALPHA]: J.LUMINANCE_ALPHA
        },
        [r8.BYTE]: {
            [r0.RGBA]: J.RGBA8_SNORM,
            [r0.RGB]: J.RGB8_SNORM,
            [r0.RG]: J.RG8_SNORM,
            [r0.RED]: J.R8_SNORM,
            [r0.RGBA_INTEGER]: J.RGBA8I,
            [r0.RGB_INTEGER]: J.RGB8I,
            [r0.RG_INTEGER]: J.RG8I,
            [r0.RED_INTEGER]: J.R8I
        },
        [r8.UNSIGNED_SHORT]: {
            [r0.RGBA_INTEGER]: J.RGBA16UI,
            [r0.RGB_INTEGER]: J.RGB16UI,
            [r0.RG_INTEGER]: J.RG16UI,
            [r0.RED_INTEGER]: J.R16UI,
            [r0.DEPTH_COMPONENT]: J.DEPTH_COMPONENT16
        },
        [r8.SHORT]: {
            [r0.RGBA_INTEGER]: J.RGBA16I,
            [r0.RGB_INTEGER]: J.RGB16I,
            [r0.RG_INTEGER]: J.RG16I,
            [r0.RED_INTEGER]: J.R16I
        },
        [r8.UNSIGNED_INT]: {
            [r0.RGBA_INTEGER]: J.RGBA32UI,
            [r0.RGB_INTEGER]: J.RGB32UI,
            [r0.RG_INTEGER]: J.RG32UI,
            [r0.RED_INTEGER]: J.R32UI,
            [r0.DEPTH_COMPONENT]: J.DEPTH_COMPONENT24
        },
        [r8.INT]: {
            [r0.RGBA_INTEGER]: J.RGBA32I,
            [r0.RGB_INTEGER]: J.RGB32I,
            [r0.RG_INTEGER]: J.RG32I,
            [r0.RED_INTEGER]: J.R32I
        },
        [r8.FLOAT]: {
            [r0.RGBA]: J.RGBA32F,
            [r0.RGB]: J.RGB32F,
            [r0.RG]: J.RG32F,
            [r0.RED]: J.R32F,
            [r0.DEPTH_COMPONENT]: J.DEPTH_COMPONENT32F
        },
        [r8.HALF_FLOAT]: {
            [r0.RGBA]: J.RGBA16F,
            [r0.RGB]: J.RGB16F,
            [r0.RG]: J.RG16F,
            [r0.RED]: J.R16F
        },
        [r8.UNSIGNED_SHORT_5_6_5]: {
            [r0.RGB]: J.RGB565
        },
        [r8.UNSIGNED_SHORT_4_4_4_4]: {
            [r0.RGBA]: J.RGBA4
        },
        [r8.UNSIGNED_SHORT_5_5_5_1]: {
            [r0.RGBA]: J.RGB5_A1
        },
        [r8.UNSIGNED_INT_2_10_10_10_REV]: {
            [r0.RGBA]: J.RGB10_A2,
            [r0.RGBA_INTEGER]: J.RGB10_A2UI
        },
        [r8.UNSIGNED_INT_10F_11F_11F_REV]: {
            [r0.RGB]: J.R11F_G11F_B10F
        },
        [r8.UNSIGNED_INT_5_9_9_9_REV]: {
            [r0.RGB]: J.RGB9_E5
        },
        [r8.UNSIGNED_INT_24_8]: {
            [r0.DEPTH_STENCIL]: J.DEPTH24_STENCIL8
        },
        [r8.FLOAT_32_UNSIGNED_INT_24_8_REV]: {
            [r0.DEPTH_STENCIL]: J.DEPTH32F_STENCIL8
        }
    } : Q = {
        [r8.UNSIGNED_BYTE]: {
            [r0.RGBA]: J.RGBA,
            [r0.RGB]: J.RGB,
            [r0.ALPHA]: J.ALPHA,
            [r0.LUMINANCE]: J.LUMINANCE,
            [r0.LUMINANCE_ALPHA]: J.LUMINANCE_ALPHA
        },
        [r8.UNSIGNED_SHORT_5_6_5]: {
            [r0.RGB]: J.RGB
        },
        [r8.UNSIGNED_SHORT_4_4_4_4]: {
            [r0.RGBA]: J.RGBA
        },
        [r8.UNSIGNED_SHORT_5_5_5_1]: {
            [r0.RGBA]: J.RGBA
        }
    },
        Q
}
var GS = O(() => {
    l8()
}
);
class JY {
    constructor(J) {
        this.renderer = J,
            this.boundTextures = [],
            this.currentLocation = -1,
            this.managedTextures = [],
            this._unknownBoundTextures = !1,
            this.unknownTexture = new L6,
            this.hasIntegerTextures = !1
    }
    contextChange() {
        let J = this.gl = this.renderer.gl;
        this.CONTEXT_UID = this.renderer.CONTEXT_UID,
            this.webGLVersion = this.renderer.context.webGLVersion,
            this.internalFormats = FS(J),
            this.samplerTypes = IS(J);
        let Q = J.getParameter(J.MAX_TEXTURE_IMAGE_UNITS);
        this.boundTextures.length = Q;
        for (let $ = 0; $ < Q; $++)
            this.boundTextures[$] = null;
        this.emptyTextures = {};
        let Z = new S4(J.createTexture());
        J.bindTexture(J.TEXTURE_2D, Z.texture),
            J.texImage2D(J.TEXTURE_2D, 0, J.RGBA, 1, 1, 0, J.RGBA, J.UNSIGNED_BYTE, new Uint8Array(4)),
            this.emptyTextures[J.TEXTURE_2D] = Z,
            this.emptyTextures[J.TEXTURE_CUBE_MAP] = new S4(J.createTexture()),
            J.bindTexture(J.TEXTURE_CUBE_MAP, this.emptyTextures[J.TEXTURE_CUBE_MAP].texture);
        for (let $ = 0; $ < 6; $++)
            J.texImage2D(J.TEXTURE_CUBE_MAP_POSITIVE_X + $, 0, J.RGBA, 1, 1, 0, J.RGBA, J.UNSIGNED_BYTE, null);
        J.texParameteri(J.TEXTURE_CUBE_MAP, J.TEXTURE_MAG_FILTER, J.LINEAR),
            J.texParameteri(J.TEXTURE_CUBE_MAP, J.TEXTURE_MIN_FILTER, J.LINEAR);
        for (let $ = 0; $ < this.boundTextures.length; $++)
            this.bind(null, $)
    }
    bind(J, Q = 0) {
        let { gl: Z } = this;
        if (J = J?.castToBaseTexture(),
            J?.valid && !J.parentTextureArray) {
            J.touched = this.renderer.textureGC.count;
            let $ = J._glTextures[this.CONTEXT_UID] || this.initTexture(J);
            this.boundTextures[Q] !== J && (this.currentLocation !== Q && (this.currentLocation = Q,
                Z.activeTexture(Z.TEXTURE0 + Q)),
                Z.bindTexture(J.target, $.texture)),
                $.dirtyId !== J.dirtyId ? (this.currentLocation !== Q && (this.currentLocation = Q,
                    Z.activeTexture(Z.TEXTURE0 + Q)),
                    this.updateTexture(J)) : $.dirtyStyleId !== J.dirtyStyleId && this.updateTextureStyle(J),
                this.boundTextures[Q] = J
        } else
            this.currentLocation !== Q && (this.currentLocation = Q,
                Z.activeTexture(Z.TEXTURE0 + Q)),
                Z.bindTexture(Z.TEXTURE_2D, this.emptyTextures[Z.TEXTURE_2D].texture),
                this.boundTextures[Q] = null
    }
    reset() {
        this._unknownBoundTextures = !0,
            this.hasIntegerTextures = !1,
            this.currentLocation = -1;
        for (let J = 0; J < this.boundTextures.length; J++)
            this.boundTextures[J] = this.unknownTexture
    }
    unbind(J) {
        let { gl: Q, boundTextures: Z } = this;
        if (this._unknownBoundTextures) {
            this._unknownBoundTextures = !1;
            for (let $ = 0; $ < Z.length; $++)
                Z[$] === this.unknownTexture && this.bind(null, $)
        }
        for (let $ = 0; $ < Z.length; $++)
            Z[$] === J && (this.currentLocation !== $ && (Q.activeTexture(Q.TEXTURE0 + $),
                this.currentLocation = $),
                Q.bindTexture(J.target, this.emptyTextures[J.target].texture),
                Z[$] = null)
    }
    ensureSamplerType(J) {
        let { boundTextures: Q, hasIntegerTextures: Z, CONTEXT_UID: $ } = this;
        if (Z)
            for (let q = J - 1; q >= 0; --q) {
                let K = Q[q];
                K && K._glTextures[$].samplerType !== Q8.FLOAT && this.renderer.texture.unbind(K)
            }
    }
    initTexture(J) {
        let Q = new S4(this.gl.createTexture());
        return Q.dirtyId = -1,
            J._glTextures[this.CONTEXT_UID] = Q,
            this.managedTextures.push(J),
            J.on("dispose", this.destroyTexture, this),
            Q
    }
    initTextureType(J, Q) {
        Q.internalFormat = this.internalFormats[J.type]?.[J.format] ?? J.format,
            Q.samplerType = this.samplerTypes[Q.internalFormat] ?? Q8.FLOAT,
            this.webGLVersion === 2 && J.type === r8.HALF_FLOAT ? Q.type = this.gl.HALF_FLOAT : Q.type = J.type
    }
    updateTexture(J) {
        let Q = J._glTextures[this.CONTEXT_UID];
        if (!Q)
            return;
        let Z = this.renderer;
        if (this.initTextureType(J, Q),
            J.resource?.upload(Z, J, Q))
            Q.samplerType !== Q8.FLOAT && (this.hasIntegerTextures = !0);
        else {
            let { realWidth: $, realHeight: q } = J
                , K = Z.gl;
            (Q.width !== $ || Q.height !== q || Q.dirtyId < 0) && (Q.width = $,
                Q.height = q,
                K.texImage2D(J.target, 0, Q.internalFormat, $, q, 0, J.format, Q.type, null))
        }
        J.dirtyStyleId !== Q.dirtyStyleId && this.updateTextureStyle(J),
            Q.dirtyId = J.dirtyId
    }
    destroyTexture(J, Q) {
        let { gl: Z } = this;
        if (J = J.castToBaseTexture(),
            J._glTextures[this.CONTEXT_UID] && (this.unbind(J),
                Z.deleteTexture(J._glTextures[this.CONTEXT_UID].texture),
                J.off("dispose", this.destroyTexture, this),
                delete J._glTextures[this.CONTEXT_UID],
                !Q)) {
            let $ = this.managedTextures.indexOf(J);
            $ !== -1 && YP(this.managedTextures, $, 1)
        }
    }
    updateTextureStyle(J) {
        let Q = J._glTextures[this.CONTEXT_UID];
        Q && ((J.mipmap === U9.POW2 || this.webGLVersion !== 2) && !J.isPowerOfTwo ? Q.mipmap = !1 : Q.mipmap = J.mipmap >= 1,
            this.webGLVersion !== 2 && !J.isPowerOfTwo ? Q.wrapMode = GH.CLAMP : Q.wrapMode = J.wrapMode,
            J.resource?.style(this.renderer, J, Q) || this.setStyle(J, Q),
            Q.dirtyStyleId = J.dirtyStyleId)
    }
    setStyle(J, Q) {
        let Z = this.gl;
        if (Q.mipmap && J.mipmap !== U9.ON_MANUAL && Z.generateMipmap(J.target),
            Z.texParameteri(J.target, Z.TEXTURE_WRAP_S, Q.wrapMode),
            Z.texParameteri(J.target, Z.TEXTURE_WRAP_T, Q.wrapMode),
            Q.mipmap) {
            Z.texParameteri(J.target, Z.TEXTURE_MIN_FILTER, J.scaleMode === x5.LINEAR ? Z.LINEAR_MIPMAP_LINEAR : Z.NEAREST_MIPMAP_NEAREST);
            let $ = this.renderer.context.extensions.anisotropicFiltering;
            if ($ && J.anisotropicLevel > 0 && J.scaleMode === x5.LINEAR) {
                let q = Math.min(J.anisotropicLevel, Z.getParameter($.MAX_TEXTURE_MAX_ANISOTROPY_EXT));
                Z.texParameterf(J.target, $.TEXTURE_MAX_ANISOTROPY_EXT, q)
            }
        } else
            Z.texParameteri(J.target, Z.TEXTURE_MIN_FILTER, J.scaleMode === x5.LINEAR ? Z.LINEAR : Z.NEAREST);
        Z.texParameteri(J.target, Z.TEXTURE_MAG_FILTER, J.scaleMode === x5.LINEAR ? Z.LINEAR : Z.NEAREST)
    }
    destroy() {
        this.renderer = null
    }
}
var PD = O(() => {
    l8();
    r6();
    OJ();
    hQ();
    GD();
    LS();
    GS();
    JY.extension = {
        type: B8.RendererSystem,
        name: "texture"
    };
    F8.add(JY)
}
);
class QY {
    constructor(J) {
        this.renderer = J
    }
    contextChange() {
        this.gl = this.renderer.gl,
            this.CONTEXT_UID = this.renderer.CONTEXT_UID
    }
    bind(J) {
        let { gl: Q, CONTEXT_UID: Z } = this
            , $ = J._glTransformFeedbacks[Z] || this.createGLTransformFeedback(J);
        Q.bindTransformFeedback(Q.TRANSFORM_FEEDBACK, $)
    }
    unbind() {
        let { gl: J } = this;
        J.bindTransformFeedback(J.TRANSFORM_FEEDBACK, null)
    }
    beginTransformFeedback(J, Q) {
        let { gl: Z, renderer: $ } = this;
        Q && $.shader.bind(Q),
            Z.beginTransformFeedback(J)
    }
    endTransformFeedback() {
        let { gl: J } = this;
        J.endTransformFeedback()
    }
    createGLTransformFeedback(J) {
        let { gl: Q, renderer: Z, CONTEXT_UID: $ } = this
            , q = Q.createTransformFeedback();
        J._glTransformFeedbacks[$] = q,
            Q.bindTransformFeedback(Q.TRANSFORM_FEEDBACK, q);
        for (let K = 0; K < J.buffers.length; K++) {
            let V = J.buffers[K];
            V && (Z.buffer.update(V),
                V._glBuffers[$].refCount++,
                Q.bindBufferBase(Q.TRANSFORM_FEEDBACK_BUFFER, K, V._glBuffers[$].buffer || null))
        }
        return Q.bindTransformFeedback(Q.TRANSFORM_FEEDBACK, null),
            J.disposeRunner.add(this),
            q
    }
    disposeTransformFeedback(J, Q) {
        let Z = J._glTransformFeedbacks[this.CONTEXT_UID]
            , $ = this.gl;
        J.disposeRunner.remove(this);
        let q = this.renderer.buffer;
        if (q)
            for (let K = 0; K < J.buffers.length; K++) {
                let V = J.buffers[K];
                if (!V)
                    continue;
                let z = V._glBuffers[this.CONTEXT_UID];
                z && (z.refCount--,
                    z.refCount === 0 && !Q && q.dispose(V, Q))
            }
        Z && (Q || $.deleteTransformFeedback(Z),
            delete J._glTransformFeedbacks[this.CONTEXT_UID])
    }
    destroy() {
        this.renderer = null
    }
}
var DD = O(() => {
    r6();
    QY.extension = {
        type: B8.RendererSystem,
        name: "transformFeedback"
    };
    F8.add(QY)
}
);
class dZ {
    constructor(J) {
        this.renderer = J
    }
    init(J) {
        this.screen = new _6(0, 0, J.width, J.height),
            this.element = J.view || L8.ADAPTER.createCanvas(),
            this.resolution = J.resolution || L8.RESOLUTION,
            this.autoDensity = !!J.autoDensity
    }
    resizeView(J, Q) {
        this.element.width = Math.round(J * this.resolution),
            this.element.height = Math.round(Q * this.resolution);
        let Z = this.element.width / this.resolution
            , $ = this.element.height / this.resolution;
        this.screen.width = Z,
            this.screen.height = $,
            this.autoDensity && (this.element.style.width = `${Z}px`,
                this.element.style.height = `${$}px`),
            this.renderer.emit("resize", Z, $),
            this.renderer.runners.resize.emit(this.screen.width, this.screen.height)
    }
    destroy(J) {
        J && this.element.parentNode?.removeChild(this.element),
            this.renderer = null,
            this.element = null,
            this.screen = null
    }
}
var BI = O(() => {
    r6();
    TJ();
    $7();
    dZ.defaultOptions = {
        width: 800,
        height: 600,
        resolution: void 0,
        autoDensity: !1
    },
        dZ.extension = {
            type: [B8.RendererSystem, B8.CanvasRendererSystem],
            name: "_view"
        };
    F8.add(dZ)
}
);
var AD = O(() => {
    aO();
    uP();
    rO();
    tP();
    JD();
    ZD();
    VD();
    HD();
    YD();
    XD();
    UD();
    ND();
    wD();
    ID();
    NI();
    FD();
    wI();
    jI();
    PD();
    DD();
    BI()
}
);
var PS = O(() => {
    l8();
    $7();
    OJ();
    dP();
    hH();
    E4();
    AD();
    hQ();
    rO();
    aO();
    BI();
    NI();
    jI();
    L8.PREFER_ENV = O5.WEBGL2;
    L8.STRICT_TEXTURE_CACHE = !1;
    L8.RENDER_OPTIONS = {
        ...mZ.defaultOptions,
        ...gZ.defaultOptions,
        ...dZ.defaultOptions,
        ...cZ.defaultOptions
    };
    Object.defineProperties(L8, {
        WRAP_MODE: {
            get() {
                return L6.defaultOptions.wrapMode
            },
            set(J) {
                j6("7.1.0", "settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),
                    L6.defaultOptions.wrapMode = J
            }
        },
        SCALE_MODE: {
            get() {
                return L6.defaultOptions.scaleMode
            },
            set(J) {
                j6("7.1.0", "settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),
                    L6.defaultOptions.scaleMode = J
            }
        },
        MIPMAP_TEXTURES: {
            get() {
                return L6.defaultOptions.mipmap
            },
            set(J) {
                j6("7.1.0", "settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),
                    L6.defaultOptions.mipmap = J
            }
        },
        ANISOTROPIC_LEVEL: {
            get() {
                return L6.defaultOptions.anisotropicLevel
            },
            set(J) {
                j6("7.1.0", "settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),
                    L6.defaultOptions.anisotropicLevel = J
            }
        },
        FILTER_RESOLUTION: {
            get() {
                return j6("7.1.0", "settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),
                    d5.defaultResolution
            },
            set(J) {
                d5.defaultResolution = J
            }
        },
        FILTER_MULTISAMPLE: {
            get() {
                return j6("7.1.0", "settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),
                    d5.defaultMultisample
            },
            set(J) {
                d5.defaultMultisample = J
            }
        },
        SPRITE_MAX_TEXTURES: {
            get() {
                return gQ.defaultMaxTextures
            },
            set(J) {
                j6("7.1.0", "settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),
                    gQ.defaultMaxTextures = J
            }
        },
        SPRITE_BATCH_SIZE: {
            get() {
                return gQ.defaultBatchSize
            },
            set(J) {
                j6("7.1.0", "settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),
                    gQ.defaultBatchSize = J
            }
        },
        CAN_UPLOAD_SAME_BUFFER: {
            get() {
                return gQ.canUploadSameBuffer
            },
            set(J) {
                j6("7.1.0", "settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),
                    gQ.canUploadSameBuffer = J
            }
        },
        GC_MODE: {
            get() {
                return a9.defaultMode
            },
            set(J) {
                j6("7.1.0", "settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),
                    a9.defaultMode = J
            }
        },
        GC_MAX_IDLE: {
            get() {
                return a9.defaultMaxIdle
            },
            set(J) {
                j6("7.1.0", "settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),
                    a9.defaultMaxIdle = J
            }
        },
        GC_MAX_CHECK_COUNT: {
            get() {
                return a9.defaultCheckCountMax
            },
            set(J) {
                j6("7.1.0", "settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),
                    a9.defaultCheckCountMax = J
            }
        },
        PRECISION_VERTEX: {
            get() {
                return c5.defaultVertexPrecision
            },
            set(J) {
                j6("7.1.0", "settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),
                    c5.defaultVertexPrecision = J
            }
        },
        PRECISION_FRAGMENT: {
            get() {
                return c5.defaultFragmentPrecision
            },
            set(J) {
                j6("7.1.0", "settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),
                    c5.defaultFragmentPrecision = J
            }
        }
    })
}
);
var Y1;
var kI = O(() => {
    Y1 = ((J) => (J[J.INTERACTION = 50] = "INTERACTION",
        J[J.HIGH = 25] = "HIGH",
        J[J.NORMAL = 0] = "NORMAL",
        J[J.LOW = -25] = "LOW",
        J[J.UTILITY = -50] = "UTILITY",
        J))(Y1 || {})
}
);
class ZY {
    constructor(J, Q = null, Z = 0, $ = !1) {
        this.next = null,
            this.previous = null,
            this._destroyed = !1,
            this.fn = J,
            this.context = Q,
            this.priority = Z,
            this.once = $
    }
    match(J, Q = null) {
        return this.fn === J && this.context === Q
    }
    emit(J) {
        this.fn && (this.context ? this.fn.call(this.context, J) : this.fn(J));
        let Q = this.next;
        return this.once && this.destroy(!0),
            this._destroyed && (this.next = null),
            Q
    }
    connect(J) {
        this.previous = J,
            J.next && (J.next.previous = this),
            this.next = J.next,
            J.next = this
    }
    destroy(J = !1) {
        this._destroyed = !0,
            this.fn = null,
            this.context = null,
            this.previous && (this.previous.next = this.next),
            this.next && (this.next.previous = this.previous);
        let Q = this.next;
        return this.next = J ? null : Q,
            this.previous = null,
            Q
    }
}
var DS = () => { }
    ;
var AS = class J {
    constructor() {
        this.autoStart = !1,
            this.deltaTime = 1,
            this.lastTime = -1,
            this.speed = 1,
            this.started = !1,
            this._requestId = null,
            this._maxElapsedMS = 100,
            this._minElapsedMS = 0,
            this._protected = !1,
            this._lastFrame = -1,
            this._head = new ZY(null, null, 1 / 0),
            this.deltaMS = 1 / J.targetFPMS,
            this.elapsedMS = 1 / J.targetFPMS,
            this._tick = (Q) => {
                this._requestId = null,
                    this.started && (this.update(Q),
                        this.started && this._requestId === null && this._head.next && (this._requestId = requestAnimationFrame(this._tick)))
            }
    }
    _requestIfNeeded() {
        this._requestId === null && this._head.next && (this.lastTime = performance.now(),
            this._lastFrame = this.lastTime,
            this._requestId = requestAnimationFrame(this._tick))
    }
    _cancelIfNeeded() {
        this._requestId !== null && (cancelAnimationFrame(this._requestId),
            this._requestId = null)
    }
    _startIfPossible() {
        this.started ? this._requestIfNeeded() : this.autoStart && this.start()
    }
    add(Q, Z, $ = Y1.NORMAL) {
        return this._addListener(new ZY(Q, Z, $))
    }
    addOnce(Q, Z, $ = Y1.NORMAL) {
        return this._addListener(new ZY(Q, Z, $, !0))
    }
    _addListener(Q) {
        let Z = this._head.next
            , $ = this._head;
        if (!Z)
            Q.connect($);
        else {
            for (; Z;) {
                if (Q.priority > Z.priority) {
                    Q.connect($);
                    break
                }
                $ = Z,
                    Z = Z.next
            }
            Q.previous || Q.connect($)
        }
        return this._startIfPossible(),
            this
    }
    remove(Q, Z) {
        let $ = this._head.next;
        for (; $;)
            $.match(Q, Z) ? $ = $.destroy() : $ = $.next;
        return this._head.next || this._cancelIfNeeded(),
            this
    }
    get count() {
        if (!this._head)
            return 0;
        let Q = 0
            , Z = this._head;
        for (; Z = Z.next;)
            Q++;
        return Q
    }
    start() {
        this.started || (this.started = !0,
            this._requestIfNeeded())
    }
    stop() {
        this.started && (this.started = !1,
            this._cancelIfNeeded())
    }
    destroy() {
        if (!this._protected) {
            this.stop();
            let Q = this._head.next;
            for (; Q;)
                Q = Q.destroy(!0);
            this._head.destroy(),
                this._head = null
        }
    }
    update(Q = performance.now()) {
        let Z;
        if (Q > this.lastTime) {
            if (Z = this.elapsedMS = Q - this.lastTime,
                Z > this._maxElapsedMS && (Z = this._maxElapsedMS),
                Z *= this.speed,
                this._minElapsedMS) {
                let K = Q - this._lastFrame | 0;
                if (K < this._minElapsedMS)
                    return;
                this._lastFrame = Q - K % this._minElapsedMS
            }
            this.deltaMS = Z,
                this.deltaTime = this.deltaMS * J.targetFPMS;
            let $ = this._head
                , q = $.next;
            for (; q;)
                q = q.emit(this.deltaTime);
            $.next || this._cancelIfNeeded()
        } else
            this.deltaTime = this.deltaMS = this.elapsedMS = 0;
        this.lastTime = Q
    }
    get FPS() {
        return 1000 / this.elapsedMS
    }
    get minFPS() {
        return 1000 / this._maxElapsedMS
    }
    set minFPS(Q) {
        let Z = Math.min(this.maxFPS, Q)
            , $ = Math.min(Math.max(0, Z) / 1000, J.targetFPMS);
        this._maxElapsedMS = 1 / $
    }
    get maxFPS() {
        return this._minElapsedMS ? Math.round(1000 / this._minElapsedMS) : 0
    }
    set maxFPS(Q) {
        if (Q === 0)
            this._minElapsedMS = 0;
        else {
            let Z = Math.max(this.minFPS, Q);
            this._minElapsedMS = 1 / (Z / 1000)
        }
    }
    static get shared() {
        if (!J._shared) {
            let Q = J._shared = new J;
            Q.autoStart = !0,
                Q._protected = !0
        }
        return J._shared
    }
    static get system() {
        if (!J._system) {
            let Q = J._system = new J;
            Q.autoStart = !0,
                Q._protected = !0
        }
        return J._system
    }
}
    , p5;
var CI = O(() => {
    kI();
    DS();
    AS.targetFPMS = 0.06;
    p5 = AS
}
);
var ES = O(() => {
    $7();
    $7();
    OJ();
    CI();
    Object.defineProperties(L8, {
        TARGET_FPMS: {
            get() {
                return p5.targetFPMS
            },
            set(J) {
                j6("7.1.0", "settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),
                    p5.targetFPMS = J
            }
        }
    })
}
);
class OI {
    static init(J) {
        J = Object.assign({
            autoStart: !0,
            sharedTicker: !1
        }, J),
            Object.defineProperty(this, "ticker", {
                set(Q) {
                    this._ticker && this._ticker.remove(this.render, this),
                        this._ticker = Q,
                        Q && Q.add(this.render, this, Y1.LOW)
                },
                get() {
                    return this._ticker
                }
            }),
            this.stop = () => {
                this._ticker.stop()
            }
            ,
            this.start = () => {
                this._ticker.start()
            }
            ,
            this._ticker = null,
            this.ticker = J.sharedTicker ? p5.shared : new p5,
            J.autoStart && this.start()
    }
    static destroy() {
        if (this._ticker) {
            let J = this._ticker;
            this.ticker = null,
                J.destroy()
        }
    }
}
var MS = O(() => {
    r6();
    kI();
    CI();
    OI.extension = B8.Application;
    F8.add(OI)
}
);
var ED = O(() => {
    ES();
    kI();
    CI();
    MS()
}
);
var jl;
var _S = O(() => {
    r6();
    jl = [];
    F8.handleByList(B8.Renderer, jl)
}
);
var RS = () => { }
    ;
var bS = () => { }
    ;
var vS = O(() => {
    RS();
    bS()
}
);
class II {
    constructor(J) {
        this.renderer = J
    }
    contextChange(J) {
        let Q;
        if (this.renderer.context.webGLVersion === 1) {
            let Z = J.getParameter(J.FRAMEBUFFER_BINDING);
            J.bindFramebuffer(J.FRAMEBUFFER, null),
                Q = J.getParameter(J.SAMPLES),
                J.bindFramebuffer(J.FRAMEBUFFER, Z)
        } else {
            let Z = J.getParameter(J.DRAW_FRAMEBUFFER_BINDING);
            J.bindFramebuffer(J.DRAW_FRAMEBUFFER, null),
                Q = J.getParameter(J.SAMPLES),
                J.bindFramebuffer(J.DRAW_FRAMEBUFFER, Z)
        }
        Q >= a6.HIGH ? this.multisample = a6.HIGH : Q >= a6.MEDIUM ? this.multisample = a6.MEDIUM : Q >= a6.LOW ? this.multisample = a6.LOW : this.multisample = a6.NONE
    }
    destroy() { }
}
var SS = O(() => {
    l8();
    r6();
    II.extension = {
        type: B8.RendererSystem,
        name: "_multisample"
    };
    F8.add(II)
}
);
class MD {
    constructor(J) {
        this.buffer = J || null,
            this.updateID = -1,
            this.byteLength = -1,
            this.refCount = 0
    }
}
var TS = () => { }
    ;
class LI {
    constructor(J) {
        this.renderer = J,
            this.managedBuffers = {},
            this.boundBufferBases = {}
    }
    destroy() {
        this.renderer = null
    }
    contextChange() {
        this.disposeAll(!0),
            this.gl = this.renderer.gl,
            this.CONTEXT_UID = this.renderer.CONTEXT_UID
    }
    bind(J) {
        let { gl: Q, CONTEXT_UID: Z } = this
            , $ = J._glBuffers[Z] || this.createGLBuffer(J);
        Q.bindBuffer(J.type, $.buffer)
    }
    unbind(J) {
        let { gl: Q } = this;
        Q.bindBuffer(J, null)
    }
    bindBufferBase(J, Q) {
        let { gl: Z, CONTEXT_UID: $ } = this;
        if (this.boundBufferBases[Q] !== J) {
            let q = J._glBuffers[$] || this.createGLBuffer(J);
            this.boundBufferBases[Q] = J,
                Z.bindBufferBase(Z.UNIFORM_BUFFER, Q, q.buffer)
        }
    }
    bindBufferRange(J, Q, Z) {
        let { gl: $, CONTEXT_UID: q } = this;
        Z = Z || 0;
        let K = J._glBuffers[q] || this.createGLBuffer(J);
        $.bindBufferRange($.UNIFORM_BUFFER, Q || 0, K.buffer, Z * 256, 256)
    }
    update(J) {
        let { gl: Q, CONTEXT_UID: Z } = this
            , $ = J._glBuffers[Z] || this.createGLBuffer(J);
        if (J._updateID !== $.updateID)
            if ($.updateID = J._updateID,
                Q.bindBuffer(J.type, $.buffer),
                $.byteLength >= J.data.byteLength)
                Q.bufferSubData(J.type, 0, J.data);
            else {
                let q = J.static ? Q.STATIC_DRAW : Q.DYNAMIC_DRAW;
                $.byteLength = J.data.byteLength,
                    Q.bufferData(J.type, J.data, q)
            }
    }
    dispose(J, Q) {
        if (!this.managedBuffers[J.id])
            return;
        delete this.managedBuffers[J.id];
        let Z = J._glBuffers[this.CONTEXT_UID]
            , $ = this.gl;
        J.disposeRunner.remove(this),
            Z && (Q || $.deleteBuffer(Z.buffer),
                delete J._glBuffers[this.CONTEXT_UID])
    }
    disposeAll(J) {
        let Q = Object.keys(this.managedBuffers);
        for (let Z = 0; Z < Q.length; Z++)
            this.dispose(this.managedBuffers[Q[Z]], J)
    }
    createGLBuffer(J) {
        let { CONTEXT_UID: Q, gl: Z } = this;
        return J._glBuffers[Q] = new MD(Z.createBuffer()),
            this.managedBuffers[J.id] = J,
            J.disposeRunner.add(this),
            J._glBuffers[Q]
    }
}
var yS = O(() => {
    r6();
    TS();
    LI.extension = {
        type: B8.RendererSystem,
        name: "buffer"
    };
    F8.add(LI)
}
);
class FI {
    constructor(J) {
        this.renderer = J
    }
    render(J, Q) {
        let Z = this.renderer, $, q, K, V;
        if (Q && ($ = Q.renderTexture,
            q = Q.clear,
            K = Q.transform,
            V = Q.skipUpdateTransform),
            this.renderingToScreen = !$,
            Z.runners.prerender.emit(),
            Z.emit("prerender"),
            Z.projection.transform = K,
            !Z.context.isLost) {
            if ($ || (this.lastObjectRendered = J),
                !V) {
                let z = J.enableTempParent();
                J.updateTransform(),
                    J.disableTempParent(z)
            }
            Z.renderTexture.bind($),
                Z.batch.currentRenderer.start(),
                (q ?? Z.background.clearBeforeRender) && Z.renderTexture.clear(),
                J.render(Z),
                Z.batch.currentRenderer.flush(),
                $ && (Q.blit && Z.framebuffer.blit(),
                    $.baseTexture.update()),
                Z.runners.postrender.emit(),
                Z.projection.transform = null,
                Z.emit("postrender")
        }
    }
    destroy() {
        this.renderer = null,
            this.lastObjectRendered = null
    }
}
var fS = O(() => {
    r6();
    FI.extension = {
        type: B8.RendererSystem,
        name: "objectRenderer"
    };
    F8.add(FI)
}
);
var GI, PI;
var hS = O(() => {
    l8();
    r6();
    TJ();
    $7();
    OJ();
    M4();
    wI();
    GI = class J extends tH {
        constructor(Q) {
            super(),
                this.type = sG.WEBGL,
                Q = Object.assign({}, L8.RENDER_OPTIONS, Q),
                this.gl = null,
                this.CONTEXT_UID = 0,
                this.globalUniforms = new rJ({
                    projectionMatrix: new t6
                }, !0);
            let Z = {
                runners: ["init", "destroy", "contextChange", "resolutionChange", "reset", "update", "postrender", "prerender", "resize"],
                systems: J.__systems,
                priority: ["_view", "textureGenerator", "background", "_plugin", "startup", "context", "state", "texture", "buffer", "geometry", "framebuffer", "transformFeedback", "mask", "scissor", "stencil", "projection", "textureGC", "filter", "renderTexture", "batch", "objectRenderer", "_multisample"]
            };
            this.setup(Z),
                "useContextAlpha" in Q && (j6("7.0.0", "options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),
                    Q.premultipliedAlpha = Q.useContextAlpha && Q.useContextAlpha !== "notMultiplied",
                    Q.backgroundAlpha = Q.useContextAlpha === !1 ? 1 : Q.backgroundAlpha),
                this._plugin.rendererPlugins = J.__plugins,
                this.options = Q,
                this.startup.run(this.options)
        }
        static test(Q) {
            return Q?.forceCanvas ? !1 : VP()
        }
        render(Q, Z) {
            this.objectRenderer.render(Q, Z)
        }
        resize(Q, Z) {
            this._view.resizeView(Q, Z)
        }
        reset() {
            return this.runners.reset.emit(),
                this
        }
        clear() {
            this.renderTexture.bind(),
                this.renderTexture.clear()
        }
        destroy(Q = !1) {
            this.runners.destroy.items.reverse(),
                this.emitWithCustomOptions(this.runners.destroy, {
                    _view: Q
                }),
                super.destroy()
        }
        get plugins() {
            return this._plugin.plugins
        }
        get multisample() {
            return this._multisample.multisample
        }
        get width() {
            return this._view.element.width
        }
        get height() {
            return this._view.element.height
        }
        get resolution() {
            return this._view.resolution
        }
        set resolution(Q) {
            this._view.resolution = Q,
                this.runners.resolutionChange.emit(Q)
        }
        get autoDensity() {
            return this._view.autoDensity
        }
        get view() {
            return this._view.element
        }
        get screen() {
            return this._view.screen
        }
        get lastObjectRendered() {
            return this.objectRenderer.lastObjectRendered
        }
        get renderingToScreen() {
            return this.objectRenderer.renderingToScreen
        }
        get rendererLogId() {
            return `WebGL ${this.context.webGLVersion}`
        }
        get clearBeforeRender() {
            return j6("7.0.0", "renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),
                this.background.clearBeforeRender
        }
        get useContextAlpha() {
            return j6("7.0.0", "renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),
                this.context.useContextAlpha
        }
        get preserveDrawingBuffer() {
            return j6("7.0.0", "renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),
                this.context.preserveDrawingBuffer
        }
        get backgroundColor() {
            return j6("7.0.0", "renderer.backgroundColor has been deprecated, use renderer.background.color instead."),
                this.background.color
        }
        set backgroundColor(Q) {
            j6("7.0.0", "renderer.backgroundColor has been deprecated, use renderer.background.color instead."),
                this.background.color = Q
        }
        get backgroundAlpha() {
            return j6("7.0.0", "renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),
                this.background.alpha
        }
        set backgroundAlpha(Q) {
            j6("7.0.0", "renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),
                this.background.alpha = Q
        }
        get powerPreference() {
            return j6("7.0.0", "renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),
                this.context.powerPreference
        }
        generateTexture(Q, Z) {
            return this.textureGenerator.generateTexture(Q, Z)
        }
    }
        ;
    GI.extension = {
        type: B8.Renderer,
        priority: 1
    },
        GI.__plugins = {},
        GI.__systems = {};
    PI = GI;
    F8.handleByMap(B8.RendererPlugin, PI.__plugins);
    F8.handleByMap(B8.RendererSystem, PI.__systems);
    F8.add(PI)
}
);
var X1;
var $Y = O(() => {
    hQ();
    G4();
    Q1();
    X1 = class X1 extends g5 {
        constructor(J, Q) {
            let { width: Z, height: $ } = Q || {};
            super(Z, $),
                this.items = [],
                this.itemDirtyIds = [];
            for (let q = 0; q < J; q++) {
                let K = new L6;
                this.items.push(K),
                    this.itemDirtyIds.push(-2)
            }
            this.length = J,
                this._load = null,
                this.baseTexture = null
        }
        initFromArray(J, Q) {
            for (let Z = 0; Z < this.length; Z++)
                J[Z] && (J[Z].castToBaseTexture ? this.addBaseTextureAt(J[Z].castToBaseTexture(), Z) : J[Z] instanceof g5 ? this.addResourceAt(J[Z], Z) : this.addResourceAt(F4(J[Z], Q), Z))
        }
        dispose() {
            for (let J = 0, Q = this.length; J < Q; J++)
                this.items[J].destroy();
            this.items = null,
                this.itemDirtyIds = null,
                this._load = null
        }
        addResourceAt(J, Q) {
            if (!this.items[Q])
                throw new Error(`Index ${Q} is out of bounds`);
            return J.valid && !this.valid && this.resize(J.width, J.height),
                this.items[Q].setResource(J),
                this
        }
        bind(J) {
            if (this.baseTexture !== null)
                throw new Error("Only one base texture per TextureArray is allowed");
            super.bind(J);
            for (let Q = 0; Q < this.length; Q++)
                this.items[Q].parentTextureArray = J,
                    this.items[Q].on("update", J.update, J)
        }
        unbind(J) {
            super.unbind(J);
            for (let Q = 0; Q < this.length; Q++)
                this.items[Q].parentTextureArray = null,
                    this.items[Q].off("update", J.update, J)
        }
        load() {
            if (this._load)
                return this._load;
            let J = this.items.map((Q) => Q.resource).filter((Q) => Q).map((Q) => Q.load());
            return this._load = Promise.all(J).then(() => {
                let { realWidth: Q, realHeight: Z } = this.items[0];
                return this.resize(Q, Z),
                    this.update(),
                    Promise.resolve(this)
            }
            ),
                this._load
        }
    }
}
);
var DI;
var _D = O(() => {
    l8();
    $Y();
    DI = class DI extends X1 {
        constructor(J, Q) {
            let { width: Z, height: $ } = Q || {}, q, K;
            Array.isArray(J) ? (q = J,
                K = J.length) : K = J,
                super(K, {
                    width: Z,
                    height: $
                }),
                q && this.initFromArray(q, Q)
        }
        addBaseTextureAt(J, Q) {
            if (J.resource)
                this.addResourceAt(J.resource, Q);
            else
                throw new Error("ArrayResource does not support RenderTexture");
            return this
        }
        bind(J) {
            super.bind(J),
                J.target = SQ.TEXTURE_2D_ARRAY
        }
        upload(J, Q, Z) {
            let { length: $, itemDirtyIds: q, items: K } = this
                , { gl: V } = J;
            Z.dirtyId < 0 && V.texImage3D(V.TEXTURE_2D_ARRAY, 0, Z.internalFormat, this._width, this._height, $, 0, Q.format, Z.type, null);
            for (let z = 0; z < $; z++) {
                let W = K[z];
                q[z] < W.dirtyId && (q[z] = W.dirtyId,
                    W.valid && V.texSubImage3D(V.TEXTURE_2D_ARRAY, 0, 0, 0, z, W.resource.width, W.resource.height, 1, Q.format, Z.type, W.resource.source))
            }
            return !0
        }
    }
}
);
var AI;
var RD = O(() => {
    mQ();
    AI = class AI extends XJ {
        constructor(J) {
            super(J)
        }
        static test(J) {
            let { OffscreenCanvas: Q } = globalThis;
            return Q && J instanceof Q ? !0 : globalThis.HTMLCanvasElement && J instanceof HTMLCanvasElement
        }
    }
}
);
var xS, bD;
var vD = O(() => {
    l8();
    $Y();
    xS = class J extends X1 {
        constructor(Q, Z) {
            let { width: $, height: q, autoLoad: K, linkBaseTexture: V } = Z || {};
            if (Q && Q.length !== J.SIDES)
                throw new Error(`Invalid length. Got ${Q.length}, expected 6`);
            super(6, {
                width: $,
                height: q
            });
            for (let z = 0; z < J.SIDES; z++)
                this.items[z].target = SQ.TEXTURE_CUBE_MAP_POSITIVE_X + z;
            this.linkBaseTexture = V !== !1,
                Q && this.initFromArray(Q, Z),
                K !== !1 && this.load()
        }
        bind(Q) {
            super.bind(Q),
                Q.target = SQ.TEXTURE_CUBE_MAP
        }
        addBaseTextureAt(Q, Z, $) {
            if ($ === void 0 && ($ = this.linkBaseTexture),
                !this.items[Z])
                throw new Error(`Index ${Z} is out of bounds`);
            if (!this.linkBaseTexture || Q.parentTextureArray || Object.keys(Q._glTextures).length > 0)
                if (Q.resource)
                    this.addResourceAt(Q.resource, Z);
                else
                    throw new Error("CubeResource does not support copying of renderTexture.");
            else
                Q.target = SQ.TEXTURE_CUBE_MAP_POSITIVE_X + Z,
                    Q.parentTextureArray = this.baseTexture,
                    this.items[Z] = Q;
            return Q.valid && !this.valid && this.resize(Q.realWidth, Q.realHeight),
                this.items[Z] = Q,
                this
        }
        upload(Q, Z, $) {
            let q = this.itemDirtyIds;
            for (let K = 0; K < J.SIDES; K++) {
                let V = this.items[K];
                (q[K] < V.dirtyId || $.dirtyId < Z.dirtyId) && (V.valid && V.resource ? (V.resource.upload(Q, V, $),
                    q[K] = V.dirtyId) : q[K] < -1 && (Q.gl.texImage2D(V.target, 0, $.internalFormat, Z.realWidth, Z.realHeight, 0, Z.format, $.type, null),
                        q[K] = -1))
            }
            return !0
        }
        static test(Q) {
            return Array.isArray(Q) && Q.length === J.SIDES
        }
    }
        ;
    xS.SIDES = 6;
    bD = xS
}
);
var pZ;
var SD = O(() => {
    l8();
    $7();
    mQ();
    pZ = class pZ extends XJ {
        constructor(J, Q) {
            Q = Q || {};
            let Z, $, q;
            typeof J == "string" ? (Z = pZ.EMPTY,
                $ = J,
                q = !0) : (Z = J,
                    $ = null,
                    q = !1),
                super(Z),
                this.url = $,
                this.crossOrigin = Q.crossOrigin ?? !0,
                this.alphaMode = typeof Q.alphaMode == "number" ? Q.alphaMode : null,
                this.ownsImageBitmap = Q.ownsImageBitmap ?? q,
                this._load = null,
                Q.autoLoad !== !1 && this.load()
        }
        load() {
            return this._load ? this._load : (this._load = new Promise(async (J, Q) => {
                if (this.url === null) {
                    J(this);
                    return
                }
                try {
                    let Z = await L8.ADAPTER.fetch(this.url, {
                        mode: this.crossOrigin ? "cors" : "no-cors"
                    }).catch((e) => console.log(e));
                    if (this.destroyed)
                        return;
                    let $ = await Z.blob();
                    if (this.destroyed)
                        return;
                    let q = await createImageBitmap($, {
                        premultiplyAlpha: this.alphaMode === null || this.alphaMode === I5.UNPACK ? "premultiply" : "none"
                    });
                    if (this.destroyed) {
                        q.close();
                        return
                    }
                    this.source = q,
                        this.update(),
                        J(this)
                } catch (Z) {
                    if (this.destroyed)
                        return;
                    Q(Z),
                        this.onError.emit(Z)
                }
            }
            ),
                this._load)
        }
        upload(J, Q, Z) {
            return this.source instanceof ImageBitmap ? (typeof this.alphaMode == "number" && (Q.alphaMode = this.alphaMode),
                super.upload(J, Q, Z)) : (this.load(),
                    !1)
        }
        dispose() {
            this.ownsImageBitmap && this.source instanceof ImageBitmap && this.source.close(),
                super.dispose(),
                this._load = null
        }
        static test(J) {
            return !!globalThis.createImageBitmap && typeof ImageBitmap < "u" && (typeof J == "string" || J instanceof ImageBitmap)
        }
        static get EMPTY() {
            return pZ._EMPTY = pZ._EMPTY ?? L8.ADAPTER.createCanvas(0, 0),
                pZ._EMPTY
        }
    }
}
);
var TD, yD;
var fD = O(() => {
    $7();
    OJ();
    mQ();
    TD = class J extends XJ {
        constructor(Q, Z) {
            Z = Z || {},
                super(L8.ADAPTER.createCanvas()),
                this._width = 0,
                this._height = 0,
                this.svg = Q,
                this.scale = Z.scale || 1,
                this._overrideWidth = Z.width,
                this._overrideHeight = Z.height,
                this._resolve = null,
                this._crossorigin = Z.crossorigin,
                this._load = null,
                Z.autoLoad !== !1 && this.load()
        }
        load() {
            return this._load ? this._load : (this._load = new Promise((Q) => {
                if (this._resolve = () => {
                    this.update(),
                        Q(this)
                }
                    ,
                    J.SVG_XML.test(this.svg.trim())) {
                    if (!btoa)
                        throw new Error("Your browser doesn't support base64 conversions.");
                    this.svg = `data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`
                }
                this._loadSvg()
            }
            ),
                this._load)
        }
        _loadSvg() {
            let Q = new Image;
            XJ.crossOrigin(Q, this.svg, this._crossorigin),
                Q.src = this.svg,
                Q.onerror = (Z) => {
                    this._resolve && (Q.onerror = null,
                        this.onError.emit(Z))
                }
                ,
                Q.onload = () => {
                    if (!this._resolve)
                        return;
                    let { width: Z, height: $ } = Q;
                    if (!Z || !$)
                        throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");
                    let q = Z * this.scale
                        , K = $ * this.scale;
                    (this._overrideWidth || this._overrideHeight) && (q = this._overrideWidth || this._overrideHeight / $ * Z,
                        K = this._overrideHeight || this._overrideWidth / Z * $),
                        q = Math.round(q),
                        K = Math.round(K);
                    let V = this.source;
                    V.width = q,
                        V.height = K,
                        V._pixiId = `canvas_${yQ()}`,
                        V.getContext("2d").drawImage(Q, 0, 0, Z, $, 0, 0, q, K),
                        this._resolve(),
                        this._resolve = null
                }
        }
        static getSize(Q) {
            let Z = J.SVG_SIZE.exec(Q)
                , $ = {};
            return Z && ($[Z[1]] = Math.round(parseFloat(Z[3])),
                $[Z[5]] = Math.round(parseFloat(Z[7]))),
                $
        }
        dispose() {
            super.dispose(),
                this._resolve = null,
                this._crossorigin = null
        }
        static test(Q, Z) {
            return Z === "svg" || typeof Q == "string" && Q.startsWith("data:image/svg+xml") || typeof Q == "string" && J.SVG_XML.test(Q)
        }
    }
        ;
    TD.SVG_XML = /^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,
        TD.SVG_SIZE = /<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;
    yD = TD
}
);
var hD;
var gS = O(() => {
    mQ();
    hD = class hD extends XJ {
        constructor(J) {
            super(J)
        }
        static test(J) {
            return !!globalThis.VideoFrame && J instanceof globalThis.VideoFrame
        }
    }
}
);
var xD, gD;
var mD = O(() => {
    ED();
    mQ();
    xD = class J extends XJ {
        constructor(Q, Z) {
            if (Z = Z || {},
                !(Q instanceof HTMLVideoElement)) {
                let $ = document.createElement("video");
                Z.autoLoad !== !1 && $.setAttribute("preload", "auto"),
                    Z.playsinline !== !1 && ($.setAttribute("webkit-playsinline", ""),
                        $.setAttribute("playsinline", "")),
                    Z.muted === !0 && ($.setAttribute("muted", ""),
                        $.muted = !0),
                    Z.loop === !0 && $.setAttribute("loop", ""),
                    Z.autoPlay !== !1 && $.setAttribute("autoplay", ""),
                    typeof Q == "string" && (Q = [Q]);
                let q = Q[0].src || Q[0];
                XJ.crossOrigin($, q, Z.crossorigin);
                for (let K = 0; K < Q.length; ++K) {
                    let V = document.createElement("source")
                        , { src: z, mime: W } = Q[K];
                    if (z = z || Q[K],
                        z.startsWith("data:"))
                        W = z.slice(5, z.indexOf(";"));
                    else if (!z.startsWith("blob:")) {
                        let H = z.split("?").shift().toLowerCase()
                            , Y = H.slice(H.lastIndexOf(".") + 1);
                        W = W || J.MIME_TYPES[Y] || `video/${Y}`
                    }
                    V.src = z,
                        W && (V.type = W),
                        $.appendChild(V)
                }
                Q = $
            }
            super(Q),
                this.noSubImage = !0,
                this._autoUpdate = !0,
                this._isConnectedToTicker = !1,
                this._updateFPS = Z.updateFPS || 0,
                this._msToNextUpdate = 0,
                this.autoPlay = Z.autoPlay !== !1,
                this._videoFrameRequestCallback = this._videoFrameRequestCallback.bind(this),
                this._videoFrameRequestCallbackHandle = null,
                this._load = null,
                this._resolve = null,
                this._reject = null,
                this._onCanPlay = this._onCanPlay.bind(this),
                this._onError = this._onError.bind(this),
                this._onPlayStart = this._onPlayStart.bind(this),
                this._onPlayStop = this._onPlayStop.bind(this),
                this._onSeeked = this._onSeeked.bind(this),
                Z.autoLoad !== !1 && this.load()
        }
        update(Q = 0) {
            if (!this.destroyed) {
                if (this._updateFPS) {
                    let Z = p5.shared.elapsedMS * this.source.playbackRate;
                    this._msToNextUpdate = Math.floor(this._msToNextUpdate - Z)
                }
                (!this._updateFPS || this._msToNextUpdate <= 0) && (super.update(),
                    this._msToNextUpdate = this._updateFPS ? Math.floor(1000 / this._updateFPS) : 0)
            }
        }
        _videoFrameRequestCallback() {
            this.update(),
                this.destroyed ? this._videoFrameRequestCallbackHandle = null : this._videoFrameRequestCallbackHandle = this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)
        }
        load() {
            if (this._load)
                return this._load;
            let Q = this.source;
            return (Q.readyState === Q.HAVE_ENOUGH_DATA || Q.readyState === Q.HAVE_FUTURE_DATA) && Q.width && Q.height && (Q.complete = !0),
                Q.addEventListener("play", this._onPlayStart),
                Q.addEventListener("pause", this._onPlayStop),
                Q.addEventListener("seeked", this._onSeeked),
                this._isSourceReady() ? this._onCanPlay() : (Q.addEventListener("canplay", this._onCanPlay),
                    Q.addEventListener("canplaythrough", this._onCanPlay),
                    Q.addEventListener("error", this._onError, !0)),
                this._load = new Promise((Z, $) => {
                    this.valid ? Z(this) : (this._resolve = Z,
                        this._reject = $,
                        Q.load())
                }
                ),
                this._load
        }
        _onError(Q) {
            this.source.removeEventListener("error", this._onError, !0),
                this.onError.emit(Q),
                this._reject && (this._reject(Q),
                    this._reject = null,
                    this._resolve = null)
        }
        _isSourcePlaying() {
            let Q = this.source;
            return !Q.paused && !Q.ended
        }
        _isSourceReady() {
            return this.source.readyState > 2
        }
        _onPlayStart() {
            this.valid || this._onCanPlay(),
                this._configureAutoUpdate()
        }
        _onPlayStop() {
            this._configureAutoUpdate()
        }
        _onSeeked() {
            this._autoUpdate && !this._isSourcePlaying() && (this._msToNextUpdate = 0,
                this.update(),
                this._msToNextUpdate = 0)
        }
        _onCanPlay() {
            let Q = this.source;
            Q.removeEventListener("canplay", this._onCanPlay),
                Q.removeEventListener("canplaythrough", this._onCanPlay);
            let Z = this.valid;
            this._msToNextUpdate = 0,
                this.update(),
                this._msToNextUpdate = 0,
                !Z && this._resolve && (this._resolve(this),
                    this._resolve = null,
                    this._reject = null),
                this._isSourcePlaying() ? this._onPlayStart() : this.autoPlay && Q.play()
        }
        dispose() {
            this._configureAutoUpdate();
            let Q = this.source;
            Q && (Q.removeEventListener("play", this._onPlayStart),
                Q.removeEventListener("pause", this._onPlayStop),
                Q.removeEventListener("seeked", this._onSeeked),
                Q.removeEventListener("canplay", this._onCanPlay),
                Q.removeEventListener("canplaythrough", this._onCanPlay),
                Q.removeEventListener("error", this._onError, !0),
                Q.pause(),
                Q.src = "",
                Q.load()),
                super.dispose()
        }
        get autoUpdate() {
            return this._autoUpdate
        }
        set autoUpdate(Q) {
            Q !== this._autoUpdate && (this._autoUpdate = Q,
                this._configureAutoUpdate())
        }
        get updateFPS() {
            return this._updateFPS
        }
        set updateFPS(Q) {
            Q !== this._updateFPS && (this._updateFPS = Q,
                this._configureAutoUpdate())
        }
        _configureAutoUpdate() {
            this._autoUpdate && this._isSourcePlaying() ? !this._updateFPS && this.source.requestVideoFrameCallback ? (this._isConnectedToTicker && (p5.shared.remove(this.update, this),
                this._isConnectedToTicker = !1,
                this._msToNextUpdate = 0),
                this._videoFrameRequestCallbackHandle === null && (this._videoFrameRequestCallbackHandle = this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))) : (this._videoFrameRequestCallbackHandle !== null && (this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),
                    this._videoFrameRequestCallbackHandle = null),
                    this._isConnectedToTicker || (p5.shared.add(this.update, this),
                        this._isConnectedToTicker = !0,
                        this._msToNextUpdate = 0)) : (this._videoFrameRequestCallbackHandle !== null && (this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),
                            this._videoFrameRequestCallbackHandle = null),
                            this._isConnectedToTicker && (p5.shared.remove(this.update, this),
                                this._isConnectedToTicker = !1,
                                this._msToNextUpdate = 0))
        }
        static test(Q, Z) {
            return globalThis.HTMLVideoElement && Q instanceof HTMLVideoElement || J.TYPES.includes(Z)
        }
    }
        ;
    xD.TYPES = ["mp4", "m4v", "webm", "ogg", "ogv", "h264", "avi", "mov"],
        xD.MIME_TYPES = {
            ogv: "video/ogg",
            mov: "video/quicktime",
            m4v: "video/mp4"
        };
    gD = xD
}
);
var mS = O(() => {
    _D();
    G4();
    G4();
    OO();
    RD();
    vD();
    SD();
    JI();
    fD();
    gS();
    mD();
    mQ();
    Q1();
    $Y();
    _H.push(pZ, b4, AI, gD, hD, yD, P4, bD, DI)
}
);
var cS = O(() => {
    fQ()
}
);
var dS = O(() => {
    PS();
    hZ();
    l8();
    r6();
    TJ();
    fQ();
    $7();
    ED();
    OJ();
    _S();
    aO();
    GP();
    DP();
    dP();
    mP();
    uP();
    cP();
    iO();
    rO();
    hH();
    aP();
    tP();
    qD();
    vS();
    tO();
    JD();
    eP();
    SS();
    PP();
    D4();
    yS();
    RH();
    ZD();
    jP();
    KD();
    VD();
    HD();
    YD();
    XD();
    UD();
    fS();
    hS();
    eO();
    ND();
    ZI();
    nP();
    wD();
    jD();
    E4();
    oO();
    ID();
    M4();
    CO();
    kD();
    OD();
    fO();
    vH();
    pO();
    NI();
    MH();
    FD();
    AD();
    hQ();
    GD();
    mS();
    oP();
    jI();
    $D();
    PD();
    lP();
    cS();
    DD();
    sP();
    iP();
    BI();
    wI();
    mQ();
    Q1();
    $Y();
    _D();
    G4();
    OO();
    RD();
    vD();
    SD();
    JI();
    fD();
    mD()
}
);
var pS = `varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`;
var uS = () => { }
    ;
var lS = `
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;
var oS = () => { }
    ;
var cD;
var nS = O(() => {
    dS();
    uS();
    oS();
    cD = class cD extends d5 {
        constructor() {
            super(lS, pS)
        }
    }
}
);
var sS = {};
WL(sS, {
    FXAAFilter: () => cD
});
var iS = O(() => {
    nS()
}
);
var LY, l6, O3, nT, nZ, B3, I3, L3, F3, NL, HL, YL, G3, d4 = {}, P3 = [], sT = /acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i, FY = Array.isArray;
function ZQ(J, Q) {
    for (var Z in Q)
        J[Z] = Q[Z];
    return J
}
function wL(J) {
    J && J.parentNode && J.parentNode.removeChild(J)
}
function iT(J, Q, Z) {
    var $, q, K, V = {};
    for (K in Q)
        K == "key" ? $ = Q[K] : K == "ref" ? q = Q[K] : V[K] = Q[K];
    if (arguments.length > 2 && (V.children = arguments.length > 3 ? LY.call(arguments, 2) : Z),
        typeof J == "function" && J.defaultProps != null)
        for (K in J.defaultProps)
            V[K] === void 0 && (V[K] = J.defaultProps[K]);
    return CY(J, V, $, q, null)
}
function CY(J, Q, Z, $, q) {
    var K = {
        type: J,
        props: Q,
        key: Z,
        ref: $,
        __k: null,
        __: null,
        __b: 0,
        __e: null,
        __c: null,
        constructor: void 0,
        __v: q == null ? ++O3 : q,
        __i: -1,
        __u: 0
    };
    return q == null && l6.vnode != null && l6.vnode(K),
        K
}
function GJ(J) {
    return J.children
}
function OY(J, Q) {
    this.props = J,
        this.context = Q
}
function G1(J, Q) {
    if (Q == null)
        return J.__ ? G1(J.__, J.__i + 1) : null;
    for (var Z; Q < J.__k.length; Q++)
        if ((Z = J.__k[Q]) != null && Z.__e != null)
            return Z.__e;
    return typeof J.type == "function" ? G1(J) : null
}
function D3(J) {
    var Q, Z;
    if ((J = J.__) != null && J.__c != null) {
        for (J.__e = J.__c.base = null,
            Q = 0; Q < J.__k.length; Q++)
            if ((Z = J.__k[Q]) != null && Z.__e != null) {
                J.__e = J.__c.base = Z.__e;
                break
            }
        return D3(J)
    }
}
function XL(J) {
    (!J.__d && (J.__d = !0) && nZ.push(J) && !IY.__r++ || B3 != l6.debounceRendering) && ((B3 = l6.debounceRendering) || I3)(IY)
}
function IY() {
    for (var J, Q, Z, $, q, K, V, z = 1; nZ.length;)
        nZ.length > z && nZ.sort(L3),
            J = nZ.shift(),
            z = nZ.length,
            J.__d && (Z = void 0,
                q = ($ = (Q = J).__v).__e,
                K = [],
                V = [],
                Q.__P && ((Z = ZQ({}, $)).__v = $.__v + 1,
                    l6.vnode && l6.vnode(Z),
                    jL(Q.__P, Z, $, Q.__n, Q.__P.namespaceURI, 32 & $.__u ? [q] : null, K, q == null ? G1($) : q, !!(32 & $.__u), V),
                    Z.__v = $.__v,
                    Z.__.__k[Z.__i] = Z,
                    M3(K, Z, V),
                    Z.__e != q && D3(Z)));
    IY.__r = 0
}
function A3(J, Q, Z, $, q, K, V, z, W, H, Y) {
    var U, N, j, k, L, F, P = $ && $.__k || P3, M = Q.length;
    for (W = aT(Z, Q, P, W, M),
        U = 0; U < M; U++)
        (j = Z.__k[U]) != null && (N = j.__i == -1 ? d4 : P[j.__i] || d4,
            j.__i = U,
            F = jL(J, j, N, q, K, V, z, W, H, Y),
            k = j.__e,
            j.ref && N.ref != j.ref && (N.ref && BL(N.ref, null, j),
                Y.push(j.ref, j.__c || k, j)),
            L == null && k != null && (L = k),
            4 & j.__u || N.__k === j.__k ? W = E3(j, W, J) : typeof j.type == "function" && F !== void 0 ? W = F : k && (W = k.nextSibling),
            j.__u &= -7);
    return Z.__e = L,
        W
}
function aT(J, Q, Z, $, q) {
    var K, V, z, W, H, Y = Z.length, U = Y, N = 0;
    for (J.__k = new Array(q),
        K = 0; K < q; K++)
        (V = Q[K]) != null && typeof V != "boolean" && typeof V != "function" ? (W = K + N,
            (V = J.__k[K] = typeof V == "string" || typeof V == "number" || typeof V == "bigint" || V.constructor == String ? CY(null, V, null, null, null) : FY(V) ? CY(GJ, {
                children: V
            }, null, null, null) : V.constructor == null && V.__b > 0 ? CY(V.type, V.props, V.key, V.ref ? V.ref : null, V.__v) : V).__ = J,
            V.__b = J.__b + 1,
            z = null,
            (H = V.__i = rT(V, Z, W, U)) != -1 && (U--,
                (z = Z[H]) && (z.__u |= 2)),
            z == null || z.__v == null ? (H == -1 && (q > Y ? N-- : q < Y && N++),
                typeof V.type != "function" && (V.__u |= 4)) : H != W && (H == W - 1 ? N-- : H == W + 1 ? N++ : (H > W ? N-- : N++,
                    V.__u |= 4))) : J.__k[K] = null;
    if (U)
        for (K = 0; K < Y; K++)
            (z = Z[K]) != null && (2 & z.__u) == 0 && (z.__e == $ && ($ = G1(z)),
                R3(z, z));
    return $
}
function E3(J, Q, Z) {
    var $, q;
    if (typeof J.type == "function") {
        for ($ = J.__k,
            q = 0; $ && q < $.length; q++)
            $[q] && ($[q].__ = J,
                Q = E3($[q], Q, Z));
        return Q
    }
    J.__e != Q && (Q && J.type && !Z.contains(Q) && (Q = G1(J)),
        Z.insertBefore(J.__e, Q || null),
        Q = J.__e);
    do
        Q = Q && Q.nextSibling;
    while (Q != null && Q.nodeType == 8);
    return Q
}
function rT(J, Q, Z, $) {
    var q, K, V, z = J.key, W = J.type, H = Q[Z], Y = H != null && (2 & H.__u) == 0;
    if (H === null && J.key == null || Y && z == H.key && W == H.type)
        return Z;
    if ($ > (Y ? 1 : 0)) {
        for (q = Z - 1,
            K = Z + 1; q >= 0 || K < Q.length;)
            if ((H = Q[V = q >= 0 ? q-- : K++]) != null && (2 & H.__u) == 0 && z == H.key && W == H.type)
                return V
    }
    return -1
}
function k3(J, Q, Z) {
    Q[0] == "-" ? J.setProperty(Q, Z == null ? "" : Z) : J[Q] = Z == null ? "" : typeof Z != "number" || sT.test(Q) ? Z : Z + "px"
}
function kY(J, Q, Z, $, q) {
    var K, V;
    J: if (Q == "style")
        if (typeof Z == "string")
            J.style.cssText = Z;
        else {
            if (typeof $ == "string" && (J.style.cssText = $ = ""),
                $)
                for (Q in $)
                    Z && Q in Z || k3(J.style, Q, "");
            if (Z)
                for (Q in Z)
                    $ && Z[Q] == $[Q] || k3(J.style, Q, Z[Q])
        }
    else if (Q[0] == "o" && Q[1] == "n")
        K = Q != (Q = Q.replace(F3, "$1")),
            V = Q.toLowerCase(),
            Q = V in J || Q == "onFocusOut" || Q == "onFocusIn" ? V.slice(2) : Q.slice(2),
            J.l || (J.l = {}),
            J.l[Q + K] = Z,
            Z ? $ ? Z.u = $.u : (Z.u = NL,
                J.addEventListener(Q, K ? YL : HL, K)) : J.removeEventListener(Q, K ? YL : HL, K);
    else {
        if (q == "http://www.w3.org/2000/svg")
            Q = Q.replace(/xlink(H|:h)/, "h").replace(/sName$/, "s");
        else if (Q != "width" && Q != "height" && Q != "href" && Q != "list" && Q != "form" && Q != "tabIndex" && Q != "download" && Q != "rowSpan" && Q != "colSpan" && Q != "role" && Q != "popover" && Q in J)
            try {
                J[Q] = Z == null ? "" : Z;
                break J
            } catch (z) { }
        typeof Z == "function" || (Z == null || Z === !1 && Q[4] != "-" ? J.removeAttribute(Q) : J.setAttribute(Q, Q == "popover" && Z == 1 ? "" : Z))
    }
}
function C3(J) {
    return function (Q) {
        if (this.l) {
            var Z = this.l[Q.type + J];
            if (Q.t == null)
                Q.t = NL++;
            else if (Q.t < Z.u)
                return;
            return Z(l6.event ? l6.event(Q) : Q)
        }
    }
}
function jL(J, Q, Z, $, q, K, V, z, W, H) {
    var Y, U, N, j, k, L, F, P, M, v, E, n, u, b, i, g, l, o = Q.type;
    if (Q.constructor != null)
        return null;
    128 & Z.__u && (W = !!(32 & Z.__u),
        K = [z = Q.__e = Z.__e]),
        (Y = l6.__b) && Y(Q);
    J: if (typeof o == "function")
        try {
            if (P = Q.props,
                M = "prototype" in o && o.prototype.render,
                v = (Y = o.contextType) && $[Y.__c],
                E = Y ? v ? v.props.value : Y.__ : $,
                Z.__c ? F = (U = Q.__c = Z.__c).__ = U.__E : (M ? Q.__c = U = new o(P, E) : (Q.__c = U = new OY(P, E),
                    U.constructor = o,
                    U.render = eT),
                    v && v.sub(U),
                    U.props = P,
                    U.state || (U.state = {}),
                    U.context = E,
                    U.__n = $,
                    N = U.__d = !0,
                    U.__h = [],
                    U._sb = []),
                M && U.__s == null && (U.__s = U.state),
                M && o.getDerivedStateFromProps != null && (U.__s == U.state && (U.__s = ZQ({}, U.__s)),
                    ZQ(U.__s, o.getDerivedStateFromProps(P, U.__s))),
                j = U.props,
                k = U.state,
                U.__v = Q,
                N)
                M && o.getDerivedStateFromProps == null && U.componentWillMount != null && U.componentWillMount(),
                    M && U.componentDidMount != null && U.__h.push(U.componentDidMount);
            else {
                if (M && o.getDerivedStateFromProps == null && P !== j && U.componentWillReceiveProps != null && U.componentWillReceiveProps(P, E),
                    !U.__e && U.shouldComponentUpdate != null && U.shouldComponentUpdate(P, U.__s, E) === !1 || Q.__v == Z.__v) {
                    for (Q.__v != Z.__v && (U.props = P,
                        U.state = U.__s,
                        U.__d = !1),
                        Q.__e = Z.__e,
                        Q.__k = Z.__k,
                        Q.__k.some(function (F0) {
                            F0 && (F0.__ = Q)
                        }),
                        n = 0; n < U._sb.length; n++)
                        U.__h.push(U._sb[n]);
                    U._sb = [],
                        U.__h.length && V.push(U);
                    break J
                }
                U.componentWillUpdate != null && U.componentWillUpdate(P, U.__s, E),
                    M && U.componentDidUpdate != null && U.__h.push(function () {
                        U.componentDidUpdate(j, k, L)
                    })
            }
            if (U.context = E,
                U.props = P,
                U.__P = J,
                U.__e = !1,
                u = l6.__r,
                b = 0,
                M) {
                for (U.state = U.__s,
                    U.__d = !1,
                    u && u(Q),
                    Y = U.render(U.props, U.state, U.context),
                    i = 0; i < U._sb.length; i++)
                    U.__h.push(U._sb[i]);
                U._sb = []
            } else
                do
                    U.__d = !1,
                        u && u(Q),
                        Y = U.render(U.props, U.state, U.context),
                        U.state = U.__s;
                while (U.__d && ++b < 25);
            U.state = U.__s,
                U.getChildContext != null && ($ = ZQ(ZQ({}, $), U.getChildContext())),
                M && !N && U.getSnapshotBeforeUpdate != null && (L = U.getSnapshotBeforeUpdate(j, k)),
                g = Y,
                Y != null && Y.type === GJ && Y.key == null && (g = _3(Y.props.children)),
                z = A3(J, FY(g) ? g : [g], Q, Z, $, q, K, V, z, W, H),
                U.base = Q.__e,
                Q.__u &= -161,
                U.__h.length && V.push(U),
                F && (U.__E = U.__ = null)
        } catch (F0) {
            if (Q.__v = null,
                W || K != null)
                if (F0.then) {
                    for (Q.__u |= W ? 160 : 128; z && z.nodeType == 8 && z.nextSibling;)
                        z = z.nextSibling;
                    K[K.indexOf(z)] = null,
                        Q.__e = z
                } else {
                    for (l = K.length; l--;)
                        wL(K[l]);
                    UL(Q)
                }
            else
                Q.__e = Z.__e,
                    Q.__k = Z.__k,
                    F0.then || UL(Q);
            l6.__e(F0, Q, Z)
        }
    else
        K == null && Q.__v == Z.__v ? (Q.__k = Z.__k,
            Q.__e = Z.__e) : z = Q.__e = tT(Z.__e, Q, Z, $, q, K, V, W, H);
    return (Y = l6.diffed) && Y(Q),
        128 & Q.__u ? void 0 : z
}
function UL(J) {
    J && J.__c && (J.__c.__e = !0),
        J && J.__k && J.__k.forEach(UL)
}
function M3(J, Q, Z) {
    for (var $ = 0; $ < Z.length; $++)
        BL(Z[$], Z[++$], Z[++$]);
    l6.__c && l6.__c(Q, J),
        J.some(function (q) {
            try {
                J = q.__h,
                    q.__h = [],
                    J.some(function (K) {
                        K.call(q)
                    })
            } catch (K) {
                l6.__e(K, q.__v)
            }
        })
}
function _3(J) {
    return typeof J != "object" || J == null || J.__b && J.__b > 0 ? J : FY(J) ? J.map(_3) : ZQ({}, J)
}
function tT(J, Q, Z, $, q, K, V, z, W) {
    var H, Y, U, N, j, k, L, F = Z.props, P = Q.props, M = Q.type;
    if (M == "svg" ? q = "http://www.w3.org/2000/svg" : M == "math" ? q = "http://www.w3.org/1998/Math/MathML" : q || (q = "http://www.w3.org/1999/xhtml"),
        K != null) {
        for (H = 0; H < K.length; H++)
            if ((j = K[H]) && "setAttribute" in j == !!M && (M ? j.localName == M : j.nodeType == 3)) {
                J = j,
                    K[H] = null;
                break
            }
    }
    if (J == null) {
        if (M == null)
            return document.createTextNode(P);
        J = document.createElementNS(q, M, P.is && P),
            z && (l6.__m && l6.__m(Q, K),
                z = !1),
            K = null
    }
    if (M == null)
        F === P || z && J.data == P || (J.data = P);
    else {
        if (K = K && LY.call(J.childNodes),
            F = Z.props || d4,
            !z && K != null)
            for (F = {},
                H = 0; H < J.attributes.length; H++)
                F[(j = J.attributes[H]).name] = j.value;
        for (H in F)
            if (j = F[H],
                H == "children")
                ;
            else if (H == "dangerouslySetInnerHTML")
                U = j;
            else if (!(H in P)) {
                if (H == "value" && "defaultValue" in P || H == "checked" && "defaultChecked" in P)
                    continue;
                kY(J, H, null, j, q)
            }
        for (H in P)
            j = P[H],
                H == "children" ? N = j : H == "dangerouslySetInnerHTML" ? Y = j : H == "value" ? k = j : H == "checked" ? L = j : z && typeof j != "function" || F[H] === j || kY(J, H, j, F[H], q);
        if (Y)
            z || U && (Y.__html == U.__html || Y.__html == J.innerHTML) || (J.innerHTML = Y.__html),
                Q.__k = [];
        else if (U && (J.innerHTML = ""),
            A3(Q.type == "template" ? J.content : J, FY(N) ? N : [N], Q, Z, $, M == "foreignObject" ? "http://www.w3.org/1999/xhtml" : q, K, V, K ? K[0] : Z.__k && G1(Z, 0), z, W),
            K != null)
            for (H = K.length; H--;)
                wL(K[H]);
        z || (H = "value",
            M == "progress" && k == null ? J.removeAttribute("value") : k != null && (k !== J[H] || M == "progress" && !k || M == "option" && k != F[H]) && kY(J, H, k, F[H], q),
            H = "checked",
            L != null && L != J[H] && kY(J, H, L, F[H], q))
    }
    return J
}
function BL(J, Q, Z) {
    try {
        if (typeof J == "function") {
            var $ = typeof J.__u == "function";
            $ && J.__u(),
                $ && Q == null || (J.__u = J(Q))
        } else
            J.current = Q
    } catch (q) {
        l6.__e(q, Z)
    }
}
function R3(J, Q, Z) {
    var $, q;
    if (l6.unmount && l6.unmount(J),
        ($ = J.ref) && ($.current && $.current != J.__e || BL($, null, Q)),
        ($ = J.__c) != null) {
        if ($.componentWillUnmount)
            try {
                $.componentWillUnmount()
            } catch (K) {
                l6.__e(K, Q)
            }
        $.base = $.__P = null
    }
    if ($ = J.__k)
        for (q = 0; q < $.length; q++)
            $[q] && R3($[q], Q, Z || typeof J.type != "function");
    Z || wL(J.__e),
        J.__c = J.__ = J.__e = void 0
}
function eT(J, Q, Z) {
    return this.constructor(J, Z)
}
function b3(J, Q, Z) {
    var $, q, K, V;
    Q == document && (Q = document.documentElement),
        l6.__ && l6.__(J, Q),
        q = ($ = typeof Z == "function") ? null : Z && Z.__k || Q.__k,
        K = [],
        V = [],
        jL(Q, J = (!$ && Z || Q).__k = iT(GJ, null, [J]), q || d4, d4, Q.namespaceURI, !$ && Z ? [Z] : q ? null : Q.firstChild ? LY.call(Q.childNodes) : null, K, !$ && Z ? Z : q ? q.__e : Q.firstChild, $, V),
        M3(K, J, V)
}
function n5(J) {
    function Q(Z) {
        var $, q;
        return this.getChildContext || ($ = new Set,
            (q = {})[Q.__c] = this,
            this.getChildContext = function () {
                return q
            }
            ,
            this.componentWillUnmount = function () {
                $ = null
            }
            ,
            this.shouldComponentUpdate = function (K) {
                this.props.value != K.value && $.forEach(function (V) {
                    V.__e = !0,
                        XL(V)
                })
            }
            ,
            this.sub = function (K) {
                $.add(K);
                var V = K.componentWillUnmount;
                K.componentWillUnmount = function () {
                    $ && $.delete(K),
                        V && V.call(K)
                }
            }
        ),
            Z.children
    }
    return Q.__c = "__cC" + G3++,
        Q.__ = J,
        Q.Provider = Q.__l = (Q.Consumer = function (Z, $) {
            return Z.children($)
        }
        ).contextType = Q,
        Q
}
LY = P3.slice,
    l6 = {
        __e: function (J, Q, Z, $) {
            for (var q, K, V; Q = Q.__;)
                if ((q = Q.__c) && !q.__)
                    try {
                        if ((K = q.constructor) && K.getDerivedStateFromError != null && (q.setState(K.getDerivedStateFromError(J)),
                            V = q.__d),
                            q.componentDidCatch != null && (q.componentDidCatch(J, $ || {}),
                                V = q.__d),
                            V)
                            return q.__E = q
                    } catch (z) {
                        J = z
                    }
            throw J
        }
    },
    O3 = 0,
    nT = function (J) {
        return J != null && J.constructor == null
    }
    ,
    OY.prototype.setState = function (J, Q) {
        var Z;
        Z = this.__s != null && this.__s != this.state ? this.__s : this.__s = ZQ({}, this.state),
            typeof J == "function" && (J = J(ZQ({}, Z), this.props)),
            J && ZQ(Z, J),
            J != null && this.__v && (Q && this._sb.push(Q),
                XL(this))
    }
    ,
    OY.prototype.forceUpdate = function (J) {
        this.__v && (this.__e = !0,
            J && this.__h.push(J),
            XL(this))
    }
    ,
    OY.prototype.render = GJ,
    nZ = [],
    I3 = typeof Promise == "function" ? Promise.prototype.then.bind(Promise.resolve()) : setTimeout,
    L3 = function (J, Q) {
        return J.__v.__b - Q.__v.__b
    }
    ,
    IY.__r = 0,
    F3 = /(PointerCapture)$|Capture$/i,
    NL = 0,
    HL = C3(!1),
    YL = C3(!0),
    G3 = 0;
var P1, F7, kL, v3, p4 = 0, m3 = [], p7 = l6, S3 = p7.__b, T3 = p7.__r, y3 = p7.diffed, f3 = p7.__c, h3 = p7.unmount, x3 = p7.__;
function PY(J, Q) {
    p7.__h && p7.__h(F7, J, p4 || Q),
        p4 = 0;
    var Z = F7.__H || (F7.__H = {
        __: [],
        __h: []
    });
    return J >= Z.__.length && Z.__.push({}),
        Z.__[J]
}
function C8(J) {
    return p4 = 1,
        Jy(d3, J)
}
function Jy(J, Q, Z) {
    var $ = PY(P1++, 2);
    if ($.t = J,
        !$.__c && ($.__ = [Z ? Z(Q) : d3(void 0, Q), function (z) {
            var W = $.__N ? $.__N[0] : $.__[0]
                , H = $.t(W, z);
            W !== H && ($.__N = [H, $.__[1]],
                $.__c.setState({}))
        }
        ],
            $.__c = F7,
            !F7.__f)) {
        var q = function (z, W, H) {
            if (!$.__c.__H)
                return !0;
            var Y = $.__c.__H.__.filter(function (N) {
                return !!N.__c
            });
            if (Y.every(function (N) {
                return !N.__N
            }))
                return !K || K.call(this, z, W, H);
            var U = $.__c.props !== z;
            return Y.forEach(function (N) {
                if (N.__N) {
                    var j = N.__[0];
                    N.__ = N.__N,
                        N.__N = void 0,
                        j !== N.__[0] && (U = !0)
                }
            }),
                K && K.call(this, z, W, H) || U
        };
        F7.__f = !0;
        var { shouldComponentUpdate: K, componentWillUpdate: V } = F7;
        F7.componentWillUpdate = function (z, W, H) {
            if (this.__e) {
                var Y = K;
                K = void 0,
                    q(z, W, H),
                    K = Y
            }
            V && V.call(this, z, W, H)
        }
            ,
            F7.shouldComponentUpdate = q
    }
    return $.__N || $.__
}
function i0(J, Q) {
    var Z = PY(P1++, 3);
    !p7.__s && c3(Z.__H, Q) && (Z.__ = J,
        Z.u = Q,
        F7.__H.__h.push(Z))
}
function n0(J) {
    return p4 = 5,
        pQ(function () {
            return {
                current: J
            }
        }, [])
}
function pQ(J, Q) {
    var Z = PY(P1++, 7);
    return c3(Z.__H, Q) && (Z.__ = J(),
        Z.__H = Q,
        Z.__h = J),
        Z.__
}
function u7(J, Q) {
    return p4 = 8,
        pQ(function () {
            return J
        }, Q)
}
function O9(J) {
    var Q = F7.context[J.__c]
        , Z = PY(P1++, 9);
    return Z.c = J,
        Q ? (Z.__ == null && (Z.__ = !0,
            Q.sub(F7)),
            Q.props.value) : J.__
}
function Qy() {
    for (var J; J = m3.shift();)
        if (J.__P && J.__H)
            try {
                J.__H.__h.forEach(GY),
                    J.__H.__h.forEach(CL),
                    J.__H.__h = []
            } catch (Q) {
                J.__H.__h = [],
                    p7.__e(Q, J.__v)
            }
}
p7.__b = function (J) {
    F7 = null,
        S3 && S3(J)
}
    ,
    p7.__ = function (J, Q) {
        J && Q.__k && Q.__k.__m && (J.__m = Q.__k.__m),
            x3 && x3(J, Q)
    }
    ,
    p7.__r = function (J) {
        T3 && T3(J),
            P1 = 0;
        var Q = (F7 = J.__c).__H;
        Q && (kL === F7 ? (Q.__h = [],
            F7.__h = [],
            Q.__.forEach(function (Z) {
                Z.__N && (Z.__ = Z.__N),
                    Z.u = Z.__N = void 0
            })) : (Q.__h.forEach(GY),
                Q.__h.forEach(CL),
                Q.__h = [],
                P1 = 0)),
            kL = F7
    }
    ,
    p7.diffed = function (J) {
        y3 && y3(J);
        var Q = J.__c;
        Q && Q.__H && (Q.__H.__h.length && (m3.push(Q) !== 1 && v3 === p7.requestAnimationFrame || ((v3 = p7.requestAnimationFrame) || Zy)(Qy)),
            Q.__H.__.forEach(function (Z) {
                Z.u && (Z.__H = Z.u),
                    Z.u = void 0
            })),
            kL = F7 = null
    }
    ,
    p7.__c = function (J, Q) {
        Q.some(function (Z) {
            try {
                Z.__h.forEach(GY),
                    Z.__h = Z.__h.filter(function ($) {
                        return !$.__ || CL($)
                    })
            } catch ($) {
                Q.some(function (q) {
                    q.__h && (q.__h = [])
                }),
                    Q = [],
                    p7.__e($, Z.__v)
            }
        }),
            f3 && f3(J, Q)
    }
    ,
    p7.unmount = function (J) {
        h3 && h3(J);
        var Q, Z = J.__c;
        Z && Z.__H && (Z.__H.__.forEach(function ($) {
            try {
                GY($)
            } catch (q) {
                Q = q
            }
        }),
            Z.__H = void 0,
            Q && p7.__e(Q, Z.__v))
    }
    ;
var g3 = typeof requestAnimationFrame == "function";
function Zy(J) {
    var Q, Z = function () {
        clearTimeout($),
            g3 && cancelAnimationFrame(Q),
            setTimeout(J)
    }, $ = setTimeout(Z, 35);
    g3 && (Q = requestAnimationFrame(Z))
}
function GY(J) {
    var Q = F7
        , Z = J.__c;
    typeof Z == "function" && (J.__c = void 0,
        Z()),
        F7 = Q
}
function CL(J) {
    var Q = F7;
    J.__c = J.__(),
        F7 = Q
}
function c3(J, Q) {
    return !J || J.length !== Q.length || Q.some(function (Z, $) {
        return Z !== J[$]
    })
}
function d3(J, Q) {
    return typeof Q == "function" ? Q(J) : Q
}
var XT = oZ(p3(), 1);
/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */
function R1(J) {
    let Q = J.length;
    while (--Q >= 0)
        J[Q] = 0
}
var $y = 0
    , MA = 1
    , qy = 2
    , Ky = 3
    , Vy = 258
    , uL = 29
    , qV = 256
    , a4 = qV + 1 + uL
    , E1 = 30
    , lL = 19
    , _A = 2 * a4 + 1
    , sZ = 15
    , LL = 16
    , zy = 7
    , oL = 256
    , RA = 16
    , bA = 17
    , vA = 18
    , yL = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0])
    , RY = new Uint8Array([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13])
    , Wy = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 7])
    , SA = new Uint8Array([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15])
    , Hy = 512
    , qQ = new Array((a4 + 2) * 2);
R1(qQ);
var n4 = new Array(E1 * 2);
R1(n4);
var r4 = new Array(Hy);
R1(r4);
var t4 = new Array(Vy - Ky + 1);
R1(t4);
var nL = new Array(uL);
R1(nL);
var bY = new Array(E1);
R1(bY);
function FL(J, Q, Z, $, q) {
    this.static_tree = J,
        this.extra_bits = Q,
        this.extra_base = Z,
        this.elems = $,
        this.max_length = q,
        this.has_stree = J && J.length
}
var TA, yA, fA;
function GL(J, Q) {
    this.dyn_tree = J,
        this.max_code = 0,
        this.stat_desc = Q
}
var hA = (J) => {
    return J < 256 ? r4[J] : r4[256 + (J >>> 7)]
}
    , e4 = (J, Q) => {
        J.pending_buf[J.pending++] = Q & 255,
            J.pending_buf[J.pending++] = Q >>> 8 & 255
    }
    , eJ = (J, Q, Z) => {
        if (J.bi_valid > LL - Z)
            J.bi_buf |= Q << J.bi_valid & 65535,
                e4(J, J.bi_buf),
                J.bi_buf = Q >> LL - J.bi_valid,
                J.bi_valid += Z - LL;
        else
            J.bi_buf |= Q << J.bi_valid & 65535,
                J.bi_valid += Z
    }
    , L9 = (J, Q, Z) => {
        eJ(J, Z[Q * 2], Z[Q * 2 + 1])
    }
    , xA = (J, Q) => {
        let Z = 0;
        do
            Z |= J & 1,
                J >>>= 1,
                Z <<= 1;
        while (--Q > 0);
        return Z >>> 1
    }
    , Yy = (J) => {
        if (J.bi_valid === 16)
            e4(J, J.bi_buf),
                J.bi_buf = 0,
                J.bi_valid = 0;
        else if (J.bi_valid >= 8)
            J.pending_buf[J.pending++] = J.bi_buf & 255,
                J.bi_buf >>= 8,
                J.bi_valid -= 8
    }
    , Xy = (J, Q) => {
        let { dyn_tree: Z, max_code: $ } = Q, q = Q.stat_desc.static_tree, K = Q.stat_desc.has_stree, V = Q.stat_desc.extra_bits, z = Q.stat_desc.extra_base, W = Q.stat_desc.max_length, H, Y, U, N, j, k, L = 0;
        for (N = 0; N <= sZ; N++)
            J.bl_count[N] = 0;
        Z[J.heap[J.heap_max] * 2 + 1] = 0;
        for (H = J.heap_max + 1; H < _A; H++) {
            if (Y = J.heap[H],
                N = Z[Z[Y * 2 + 1] * 2 + 1] + 1,
                N > W)
                N = W,
                    L++;
            if (Z[Y * 2 + 1] = N,
                Y > $)
                continue;
            if (J.bl_count[N]++,
                j = 0,
                Y >= z)
                j = V[Y - z];
            if (k = Z[Y * 2],
                J.opt_len += k * (N + j),
                K)
                J.static_len += k * (q[Y * 2 + 1] + j)
        }
        if (L === 0)
            return;
        do {
            N = W - 1;
            while (J.bl_count[N] === 0)
                N--;
            J.bl_count[N]--,
                J.bl_count[N + 1] += 2,
                J.bl_count[W]--,
                L -= 2
        } while (L > 0);
        for (N = W; N !== 0; N--) {
            Y = J.bl_count[N];
            while (Y !== 0) {
                if (U = J.heap[--H],
                    U > $)
                    continue;
                if (Z[U * 2 + 1] !== N)
                    J.opt_len += (N - Z[U * 2 + 1]) * Z[U * 2],
                        Z[U * 2 + 1] = N;
                Y--
            }
        }
    }
    , gA = (J, Q, Z) => {
        let $ = new Array(sZ + 1), q = 0, K, V;
        for (K = 1; K <= sZ; K++)
            q = q + Z[K - 1] << 1,
                $[K] = q;
        for (V = 0; V <= Q; V++) {
            let z = J[V * 2 + 1];
            if (z === 0)
                continue;
            J[V * 2] = xA($[z]++, z)
        }
    }
    , Uy = () => {
        let J, Q, Z, $, q, K = new Array(sZ + 1);
        Z = 0;
        for ($ = 0; $ < uL - 1; $++) {
            nL[$] = Z;
            for (J = 0; J < 1 << yL[$]; J++)
                t4[Z++] = $
        }
        t4[Z - 1] = $,
            q = 0;
        for ($ = 0; $ < 16; $++) {
            bY[$] = q;
            for (J = 0; J < 1 << RY[$]; J++)
                r4[q++] = $
        }
        q >>= 7;
        for (; $ < E1; $++) {
            bY[$] = q << 7;
            for (J = 0; J < 1 << RY[$] - 7; J++)
                r4[256 + q++] = $
        }
        for (Q = 0; Q <= sZ; Q++)
            K[Q] = 0;
        J = 0;
        while (J <= 143)
            qQ[J * 2 + 1] = 8,
                J++,
                K[8]++;
        while (J <= 255)
            qQ[J * 2 + 1] = 9,
                J++,
                K[9]++;
        while (J <= 279)
            qQ[J * 2 + 1] = 7,
                J++,
                K[7]++;
        while (J <= 287)
            qQ[J * 2 + 1] = 8,
                J++,
                K[8]++;
        gA(qQ, a4 + 1, K);
        for (J = 0; J < E1; J++)
            n4[J * 2 + 1] = 5,
                n4[J * 2] = xA(J, 5);
        TA = new FL(qQ, yL, qV + 1, a4, sZ),
            yA = new FL(n4, RY, 0, E1, sZ),
            fA = new FL(new Array(0), Wy, 0, lL, zy)
    }
    , mA = (J) => {
        let Q;
        for (Q = 0; Q < a4; Q++)
            J.dyn_ltree[Q * 2] = 0;
        for (Q = 0; Q < E1; Q++)
            J.dyn_dtree[Q * 2] = 0;
        for (Q = 0; Q < lL; Q++)
            J.bl_tree[Q * 2] = 0;
        J.dyn_ltree[oL * 2] = 1,
            J.opt_len = J.static_len = 0,
            J.sym_next = J.matches = 0
    }
    , cA = (J) => {
        if (J.bi_valid > 8)
            e4(J, J.bi_buf);
        else if (J.bi_valid > 0)
            J.pending_buf[J.pending++] = J.bi_buf;
        J.bi_buf = 0,
            J.bi_valid = 0
    }
    , u3 = (J, Q, Z, $) => {
        let q = Q * 2
            , K = Z * 2;
        return J[q] < J[K] || J[q] === J[K] && $[Q] <= $[Z]
    }
    , PL = (J, Q, Z) => {
        let $ = J.heap[Z]
            , q = Z << 1;
        while (q <= J.heap_len) {
            if (q < J.heap_len && u3(Q, J.heap[q + 1], J.heap[q], J.depth))
                q++;
            if (u3(Q, $, J.heap[q], J.depth))
                break;
            J.heap[Z] = J.heap[q],
                Z = q,
                q <<= 1
        }
        J.heap[Z] = $
    }
    , l3 = (J, Q, Z) => {
        let $, q, K = 0, V, z;
        if (J.sym_next !== 0)
            do
                if ($ = J.pending_buf[J.sym_buf + K++] & 255,
                    $ += (J.pending_buf[J.sym_buf + K++] & 255) << 8,
                    q = J.pending_buf[J.sym_buf + K++],
                    $ === 0)
                    L9(J, q, Q);
                else {
                    if (V = t4[q],
                        L9(J, V + qV + 1, Q),
                        z = yL[V],
                        z !== 0)
                        q -= nL[V],
                            eJ(J, q, z);
                    if ($--,
                        V = hA($),
                        L9(J, V, Z),
                        z = RY[V],
                        z !== 0)
                        $ -= bY[V],
                            eJ(J, $, z)
                }
            while (K < J.sym_next);
        L9(J, oL, Q)
    }
    , fL = (J, Q) => {
        let Z = Q.dyn_tree, $ = Q.stat_desc.static_tree, q = Q.stat_desc.has_stree, K = Q.stat_desc.elems, V, z, W = -1, H;
        J.heap_len = 0,
            J.heap_max = _A;
        for (V = 0; V < K; V++)
            if (Z[V * 2] !== 0)
                J.heap[++J.heap_len] = W = V,
                    J.depth[V] = 0;
            else
                Z[V * 2 + 1] = 0;
        while (J.heap_len < 2)
            if (H = J.heap[++J.heap_len] = W < 2 ? ++W : 0,
                Z[H * 2] = 1,
                J.depth[H] = 0,
                J.opt_len--,
                q)
                J.static_len -= $[H * 2 + 1];
        Q.max_code = W;
        for (V = J.heap_len >> 1; V >= 1; V--)
            PL(J, Z, V);
        H = K;
        do
            V = J.heap[1],
                J.heap[1] = J.heap[J.heap_len--],
                PL(J, Z, 1),
                z = J.heap[1],
                J.heap[--J.heap_max] = V,
                J.heap[--J.heap_max] = z,
                Z[H * 2] = Z[V * 2] + Z[z * 2],
                J.depth[H] = (J.depth[V] >= J.depth[z] ? J.depth[V] : J.depth[z]) + 1,
                Z[V * 2 + 1] = Z[z * 2 + 1] = H,
                J.heap[1] = H++,
                PL(J, Z, 1);
        while (J.heap_len >= 2);
        J.heap[--J.heap_max] = J.heap[1],
            Xy(J, Q),
            gA(Z, W, J.bl_count)
    }
    , o3 = (J, Q, Z) => {
        let $, q = -1, K, V = Q[1], z = 0, W = 7, H = 4;
        if (V === 0)
            W = 138,
                H = 3;
        Q[(Z + 1) * 2 + 1] = 65535;
        for ($ = 0; $ <= Z; $++) {
            if (K = V,
                V = Q[($ + 1) * 2 + 1],
                ++z < W && K === V)
                continue;
            else if (z < H)
                J.bl_tree[K * 2] += z;
            else if (K !== 0) {
                if (K !== q)
                    J.bl_tree[K * 2]++;
                J.bl_tree[RA * 2]++
            } else if (z <= 10)
                J.bl_tree[bA * 2]++;
            else
                J.bl_tree[vA * 2]++;
            if (z = 0,
                q = K,
                V === 0)
                W = 138,
                    H = 3;
            else if (K === V)
                W = 6,
                    H = 3;
            else
                W = 7,
                    H = 4
        }
    }
    , n3 = (J, Q, Z) => {
        let $, q = -1, K, V = Q[1], z = 0, W = 7, H = 4;
        if (V === 0)
            W = 138,
                H = 3;
        for ($ = 0; $ <= Z; $++) {
            if (K = V,
                V = Q[($ + 1) * 2 + 1],
                ++z < W && K === V)
                continue;
            else if (z < H)
                do
                    L9(J, K, J.bl_tree);
                while (--z !== 0);
            else if (K !== 0) {
                if (K !== q)
                    L9(J, K, J.bl_tree),
                        z--;
                L9(J, RA, J.bl_tree),
                    eJ(J, z - 3, 2)
            } else if (z <= 10)
                L9(J, bA, J.bl_tree),
                    eJ(J, z - 3, 3);
            else
                L9(J, vA, J.bl_tree),
                    eJ(J, z - 11, 7);
            if (z = 0,
                q = K,
                V === 0)
                W = 138,
                    H = 3;
            else if (K === V)
                W = 6,
                    H = 3;
            else
                W = 7,
                    H = 4
        }
    }
    , Ny = (J) => {
        let Q;
        o3(J, J.dyn_ltree, J.l_desc.max_code),
            o3(J, J.dyn_dtree, J.d_desc.max_code),
            fL(J, J.bl_desc);
        for (Q = lL - 1; Q >= 3; Q--)
            if (J.bl_tree[SA[Q] * 2 + 1] !== 0)
                break;
        return J.opt_len += 3 * (Q + 1) + 5 + 5 + 4,
            Q
    }
    , wy = (J, Q, Z, $) => {
        let q;
        eJ(J, Q - 257, 5),
            eJ(J, Z - 1, 5),
            eJ(J, $ - 4, 4);
        for (q = 0; q < $; q++)
            eJ(J, J.bl_tree[SA[q] * 2 + 1], 3);
        n3(J, J.dyn_ltree, Q - 1),
            n3(J, J.dyn_dtree, Z - 1)
    }
    , jy = (J) => {
        let Q = 4093624447, Z;
        for (Z = 0; Z <= 31; Z++,
            Q >>>= 1)
            if (Q & 1 && J.dyn_ltree[Z * 2] !== 0)
                return 0;
        if (J.dyn_ltree[18] !== 0 || J.dyn_ltree[20] !== 0 || J.dyn_ltree[26] !== 0)
            return 1;
        for (Z = 32; Z < qV; Z++)
            if (J.dyn_ltree[Z * 2] !== 0)
                return 1;
        return 0
    }
    , s3 = !1
    , By = (J) => {
        if (!s3)
            Uy(),
                s3 = !0;
        J.l_desc = new GL(J.dyn_ltree, TA),
            J.d_desc = new GL(J.dyn_dtree, yA),
            J.bl_desc = new GL(J.bl_tree, fA),
            J.bi_buf = 0,
            J.bi_valid = 0,
            mA(J)
    }
    , dA = (J, Q, Z, $) => {
        if (eJ(J, ($y << 1) + ($ ? 1 : 0), 3),
            cA(J),
            e4(J, Z),
            e4(J, ~Z),
            Z)
            J.pending_buf.set(J.global.subarray(Q, Q + Z), J.pending);
        J.pending += Z
    }
    , ky = (J) => {
        eJ(J, MA << 1, 3),
            L9(J, oL, qQ),
            Yy(J)
    }
    , Cy = (J, Q, Z, $) => {
        let q, K, V = 0;
        if (J.level > 0) {
            if (J.strm.data_type === 2)
                J.strm.data_type = jy(J);
            if (fL(J, J.l_desc),
                fL(J, J.d_desc),
                V = Ny(J),
                q = J.opt_len + 3 + 7 >>> 3,
                K = J.static_len + 3 + 7 >>> 3,
                K <= q)
                q = K
        } else
            q = K = Z + 5;
        if (Z + 4 <= q && Q !== -1)
            dA(J, Q, Z, $);
        else if (J.strategy === 4 || K === q)
            eJ(J, (MA << 1) + ($ ? 1 : 0), 3),
                l3(J, qQ, n4);
        else
            eJ(J, (qy << 1) + ($ ? 1 : 0), 3),
                wy(J, J.l_desc.max_code + 1, J.d_desc.max_code + 1, V + 1),
                l3(J, J.dyn_ltree, J.dyn_dtree);
        if (mA(J),
            $)
            cA(J)
    }
    , Oy = (J, Q, Z) => {
        if (J.pending_buf[J.sym_buf + J.sym_next++] = Q,
            J.pending_buf[J.sym_buf + J.sym_next++] = Q >> 8,
            J.pending_buf[J.sym_buf + J.sym_next++] = Z,
            Q === 0)
            J.dyn_ltree[Z * 2]++;
        else
            J.matches++,
                Q--,
                J.dyn_ltree[(t4[Z] + qV + 1) * 2]++,
                J.dyn_dtree[hA(Q) * 2]++;
        return J.sym_next === J.sym_end
    }
    , Iy = By
    , Ly = dA
    , Fy = Cy
    , Gy = Oy
    , Py = ky
    , Dy = {
        _tr_init: Iy,
        _tr_stored_block: Ly,
        _tr_flush_block: Fy,
        _tr_tally: Gy,
        _tr_align: Py
    }
    , Ay = (J, Q, Z, $) => {
        let q = J & 65535 | 0
            , K = J >>> 16 & 65535 | 0
            , V = 0;
        while (Z !== 0) {
            V = Z > 2000 ? 2000 : Z,
                Z -= V;
            do
                q = q + Q[$++] | 0,
                    K = K + q | 0;
            while (--V);
            q %= 65521,
                K %= 65521
        }
        return q | K << 16 | 0
    }
    , JV = Ay
    , Ey = () => {
        let J, Q = [];
        for (var Z = 0; Z < 256; Z++) {
            J = Z;
            for (var $ = 0; $ < 8; $++)
                J = J & 1 ? 3988292384 ^ J >>> 1 : J >>> 1;
            Q[Z] = J
        }
        return Q
    }
    , My = new Uint32Array(Ey())
    , _y = (J, Q, Z, $) => {
        let q = My
            , K = $ + Z;
        J ^= -1;
        for (let V = $; V < K; V++)
            J = J >>> 8 ^ q[(J ^ Q[V]) & 255];
        return J ^ -1
    }
    , $J = _y
    , rZ = {
        2: "need dictionary",
        1: "stream end",
        0: "",
        "-1": "file error",
        "-2": "stream error",
        "-3": "data error",
        "-4": "insufficient memory",
        "-5": "buffer error",
        "-6": "incompatible version"
    }
    , J$ = {
        Z_NO_FLUSH: 0,
        Z_PARTIAL_FLUSH: 1,
        Z_SYNC_FLUSH: 2,
        Z_FULL_FLUSH: 3,
        Z_FINISH: 4,
        Z_BLOCK: 5,
        Z_TREES: 6,
        Z_OK: 0,
        Z_STREAM_END: 1,
        Z_NEED_DICT: 2,
        Z_ERRNO: -1,
        Z_STREAM_ERROR: -2,
        Z_DATA_ERROR: -3,
        Z_MEM_ERROR: -4,
        Z_BUF_ERROR: -5,
        Z_NO_COMPRESSION: 0,
        Z_BEST_SPEED: 1,
        Z_BEST_COMPRESSION: 9,
        Z_DEFAULT_COMPRESSION: -1,
        Z_FILTERED: 1,
        Z_HUFFMAN_ONLY: 2,
        Z_RLE: 3,
        Z_FIXED: 4,
        Z_DEFAULT_STRATEGY: 0,
        Z_BINARY: 0,
        Z_TEXT: 1,
        Z_UNKNOWN: 2,
        Z_DEFLATED: 8
    }
    , { _tr_init: Ry, _tr_stored_block: hL, _tr_flush_block: by, _tr_tally: oQ, _tr_align: vy } = Dy
    , { Z_NO_FLUSH: nQ, Z_PARTIAL_FLUSH: Sy, Z_FULL_FLUSH: Ty, Z_FINISH: P5, Z_BLOCK: i3, Z_OK: NJ, Z_STREAM_END: a3, Z_STREAM_ERROR: F9, Z_DATA_ERROR: yy, Z_BUF_ERROR: DL, Z_DEFAULT_COMPRESSION: fy, Z_FILTERED: hy, Z_HUFFMAN_ONLY: DY, Z_RLE: xy, Z_FIXED: gy, Z_DEFAULT_STRATEGY: my, Z_UNKNOWN: cy, Z_DEFLATED: TY } = J$
    , dy = 9
    , py = 15
    , uy = 8
    , ly = 29
    , oy = 256
    , xL = oy + 1 + ly
    , ny = 30
    , sy = 19
    , iy = 2 * xL + 1
    , ay = 15
    , A6 = 3
    , lQ = 258
    , G9 = lQ + A6 + 1
    , ry = 32
    , M1 = 42
    , sL = 57
    , gL = 69
    , mL = 73
    , cL = 91
    , dL = 103
    , iZ = 113
    , l4 = 666
    , gJ = 1
    , b1 = 2
    , tZ = 3
    , v1 = 4
    , ty = 3
    , aZ = (J, Q) => {
        return J.msg = rZ[Q],
            Q
    }
    , r3 = (J) => {
        return J * 2 - (J > 4 ? 9 : 0)
    }
    , uQ = (J) => {
        let Q = J.length;
        while (--Q >= 0)
            J[Q] = 0
    }
    , ey = (J) => {
        let Q, Z, $, q = J.w_size;
        Q = J.hash_size,
            $ = Q;
        do
            Z = J.head[--$],
                J.head[$] = Z >= q ? Z - q : 0;
        while (--Q);
        Q = q,
            $ = Q;
        do
            Z = J.prev[--$],
                J.prev[$] = Z >= q ? Z - q : 0;
        while (--Q)
    }
    , Jf = (J, Q, Z) => (Q << J.hash_shift ^ Z) & J.hash_mask
    , sQ = Jf
    , w5 = (J) => {
        let Q = J.state
            , Z = Q.pending;
        if (Z > J.avail_out)
            Z = J.avail_out;
        if (Z === 0)
            return;
        if (J.output.set(Q.pending_buf.subarray(Q.pending_out, Q.pending_out + Z), J.next_out),
            J.next_out += Z,
            Q.pending_out += Z,
            J.total_out += Z,
            J.avail_out -= Z,
            Q.pending -= Z,
            Q.pending === 0)
            Q.pending_out = 0
    }
    , j5 = (J, Q) => {
        by(J, J.block_start >= 0 ? J.block_start : -1, J.strstart - J.block_start, Q),
            J.block_start = J.strstart,
            w5(J.strm)
    }
    , x6 = (J, Q) => {
        J.pending_buf[J.pending++] = Q
    }
    , u4 = (J, Q) => {
        J.pending_buf[J.pending++] = Q >>> 8 & 255,
            J.pending_buf[J.pending++] = Q & 255
    }
    , pL = (J, Q, Z, $) => {
        let q = J.avail_in;
        if (q > $)
            q = $;
        if (q === 0)
            return 0;
        if (J.avail_in -= q,
            Q.set(J.input.subarray(J.next_in, J.next_in + q), Z),
            J.state.wrap === 1)
            J.adler = JV(J.adler, Q, q, Z);
        else if (J.state.wrap === 2)
            J.adler = $J(J.adler, Q, q, Z);
        return J.next_in += q,
            J.total_in += q,
            q
    }
    , pA = (J, Q) => {
        let { max_chain_length: Z, strstart: $ } = J, q, K, V = J.prev_length, z = J.nice_match, W = J.strstart > J.w_size - G9 ? J.strstart - (J.w_size - G9) : 0, H = J.global, Y = J.w_mask, U = J.prev, N = J.strstart + lQ, j = H[$ + V - 1], k = H[$ + V];
        if (J.prev_length >= J.good_match)
            Z >>= 2;
        if (z > J.lookahead)
            z = J.lookahead;
        do {
            if (q = Q,
                H[q + V] !== k || H[q + V - 1] !== j || H[q] !== H[$] || H[++q] !== H[$ + 1])
                continue;
            $ += 2,
                q++;
            do
                ;
            while (H[++$] === H[++q] && H[++$] === H[++q] && H[++$] === H[++q] && H[++$] === H[++q] && H[++$] === H[++q] && H[++$] === H[++q] && H[++$] === H[++q] && H[++$] === H[++q] && $ < N);
            if (K = lQ - (N - $),
                $ = N - lQ,
                K > V) {
                if (J.match_start = Q,
                    V = K,
                    K >= z)
                    break;
                j = H[$ + V - 1],
                    k = H[$ + V]
            }
        } while ((Q = U[Q & Y]) > W && --Z !== 0);
        if (V <= J.lookahead)
            return V;
        return J.lookahead
    }
    , _1 = (J) => {
        let Q = J.w_size, Z, $, q;
        do {
            if ($ = J.global_size - J.lookahead - J.strstart,
                J.strstart >= Q + (Q - G9)) {
                if (J.global.set(J.global.subarray(Q, Q + Q - $), 0),
                    J.match_start -= Q,
                    J.strstart -= Q,
                    J.block_start -= Q,
                    J.insert > J.strstart)
                    J.insert = J.strstart;
                ey(J),
                    $ += Q
            }
            if (J.strm.avail_in === 0)
                break;
            if (Z = pL(J.strm, J.global, J.strstart + J.lookahead, $),
                J.lookahead += Z,
                J.lookahead + J.insert >= A6) {
                q = J.strstart - J.insert,
                    J.ins_h = J.global[q],
                    J.ins_h = sQ(J, J.ins_h, J.global[q + 1]);
                while (J.insert)
                    if (J.ins_h = sQ(J, J.ins_h, J.global[q + A6 - 1]),
                        J.prev[q & J.w_mask] = J.head[J.ins_h],
                        J.head[J.ins_h] = q,
                        q++,
                        J.insert--,
                        J.lookahead + J.insert < A6)
                        break
            }
        } while (J.lookahead < G9 && J.strm.avail_in !== 0)
    }
    , uA = (J, Q) => {
        let Z = J.pending_buf_size - 5 > J.w_size ? J.w_size : J.pending_buf_size - 5, $, q, K, V = 0, z = J.strm.avail_in;
        do {
            if ($ = 65535,
                K = J.bi_valid + 42 >> 3,
                J.strm.avail_out < K)
                break;
            if (K = J.strm.avail_out - K,
                q = J.strstart - J.block_start,
                $ > q + J.strm.avail_in)
                $ = q + J.strm.avail_in;
            if ($ > K)
                $ = K;
            if ($ < Z && ($ === 0 && Q !== P5 || Q === nQ || $ !== q + J.strm.avail_in))
                break;
            if (V = Q === P5 && $ === q + J.strm.avail_in ? 1 : 0,
                hL(J, 0, 0, V),
                J.pending_buf[J.pending - 4] = $,
                J.pending_buf[J.pending - 3] = $ >> 8,
                J.pending_buf[J.pending - 2] = ~$,
                J.pending_buf[J.pending - 1] = ~$ >> 8,
                w5(J.strm),
                q) {
                if (q > $)
                    q = $;
                J.strm.output.set(J.global.subarray(J.block_start, J.block_start + q), J.strm.next_out),
                    J.strm.next_out += q,
                    J.strm.avail_out -= q,
                    J.strm.total_out += q,
                    J.block_start += q,
                    $ -= q
            }
            if ($)
                pL(J.strm, J.strm.output, J.strm.next_out, $),
                    J.strm.next_out += $,
                    J.strm.avail_out -= $,
                    J.strm.total_out += $
        } while (V === 0);
        if (z -= J.strm.avail_in,
            z) {
            if (z >= J.w_size)
                J.matches = 2,
                    J.global.set(J.strm.input.subarray(J.strm.next_in - J.w_size, J.strm.next_in), 0),
                    J.strstart = J.w_size,
                    J.insert = J.strstart;
            else {
                if (J.global_size - J.strstart <= z) {
                    if (J.strstart -= J.w_size,
                        J.global.set(J.global.subarray(J.w_size, J.w_size + J.strstart), 0),
                        J.matches < 2)
                        J.matches++;
                    if (J.insert > J.strstart)
                        J.insert = J.strstart
                }
                J.global.set(J.strm.input.subarray(J.strm.next_in - z, J.strm.next_in), J.strstart),
                    J.strstart += z,
                    J.insert += z > J.w_size - J.insert ? J.w_size - J.insert : z
            }
            J.block_start = J.strstart
        }
        if (J.high_water < J.strstart)
            J.high_water = J.strstart;
        if (V)
            return v1;
        if (Q !== nQ && Q !== P5 && J.strm.avail_in === 0 && J.strstart === J.block_start)
            return b1;
        if (K = J.global_size - J.strstart,
            J.strm.avail_in > K && J.block_start >= J.w_size) {
            if (J.block_start -= J.w_size,
                J.strstart -= J.w_size,
                J.global.set(J.global.subarray(J.w_size, J.w_size + J.strstart), 0),
                J.matches < 2)
                J.matches++;
            if (K += J.w_size,
                J.insert > J.strstart)
                J.insert = J.strstart
        }
        if (K > J.strm.avail_in)
            K = J.strm.avail_in;
        if (K)
            pL(J.strm, J.global, J.strstart, K),
                J.strstart += K,
                J.insert += K > J.w_size - J.insert ? J.w_size - J.insert : K;
        if (J.high_water < J.strstart)
            J.high_water = J.strstart;
        if (K = J.bi_valid + 42 >> 3,
            K = J.pending_buf_size - K > 65535 ? 65535 : J.pending_buf_size - K,
            Z = K > J.w_size ? J.w_size : K,
            q = J.strstart - J.block_start,
            q >= Z || (q || Q === P5) && Q !== nQ && J.strm.avail_in === 0 && q <= K)
            $ = q > K ? K : q,
                V = Q === P5 && J.strm.avail_in === 0 && $ === q ? 1 : 0,
                hL(J, J.block_start, $, V),
                J.block_start += $,
                w5(J.strm);
        return V ? tZ : gJ
    }
    , AL = (J, Q) => {
        let Z, $;
        for (; ;) {
            if (J.lookahead < G9) {
                if (_1(J),
                    J.lookahead < G9 && Q === nQ)
                    return gJ;
                if (J.lookahead === 0)
                    break
            }
            if (Z = 0,
                J.lookahead >= A6)
                J.ins_h = sQ(J, J.ins_h, J.global[J.strstart + A6 - 1]),
                    Z = J.prev[J.strstart & J.w_mask] = J.head[J.ins_h],
                    J.head[J.ins_h] = J.strstart;
            if (Z !== 0 && J.strstart - Z <= J.w_size - G9)
                J.match_length = pA(J, Z);
            if (J.match_length >= A6)
                if ($ = oQ(J, J.strstart - J.match_start, J.match_length - A6),
                    J.lookahead -= J.match_length,
                    J.match_length <= J.max_lazy_match && J.lookahead >= A6) {
                    J.match_length--;
                    do
                        J.strstart++,
                            J.ins_h = sQ(J, J.ins_h, J.global[J.strstart + A6 - 1]),
                            Z = J.prev[J.strstart & J.w_mask] = J.head[J.ins_h],
                            J.head[J.ins_h] = J.strstart;
                    while (--J.match_length !== 0);
                    J.strstart++
                } else
                    J.strstart += J.match_length,
                        J.match_length = 0,
                        J.ins_h = J.global[J.strstart],
                        J.ins_h = sQ(J, J.ins_h, J.global[J.strstart + 1]);
            else
                $ = oQ(J, 0, J.global[J.strstart]),
                    J.lookahead--,
                    J.strstart++;
            if ($) {
                if (j5(J, !1),
                    J.strm.avail_out === 0)
                    return gJ
            }
        }
        if (J.insert = J.strstart < A6 - 1 ? J.strstart : A6 - 1,
            Q === P5) {
            if (j5(J, !0),
                J.strm.avail_out === 0)
                return tZ;
            return v1
        }
        if (J.sym_next) {
            if (j5(J, !1),
                J.strm.avail_out === 0)
                return gJ
        }
        return b1
    }
    , D1 = (J, Q) => {
        let Z, $, q;
        for (; ;) {
            if (J.lookahead < G9) {
                if (_1(J),
                    J.lookahead < G9 && Q === nQ)
                    return gJ;
                if (J.lookahead === 0)
                    break
            }
            if (Z = 0,
                J.lookahead >= A6)
                J.ins_h = sQ(J, J.ins_h, J.global[J.strstart + A6 - 1]),
                    Z = J.prev[J.strstart & J.w_mask] = J.head[J.ins_h],
                    J.head[J.ins_h] = J.strstart;
            if (J.prev_length = J.match_length,
                J.prev_match = J.match_start,
                J.match_length = A6 - 1,
                Z !== 0 && J.prev_length < J.max_lazy_match && J.strstart - Z <= J.w_size - G9) {
                if (J.match_length = pA(J, Z),
                    J.match_length <= 5 && (J.strategy === hy || J.match_length === A6 && J.strstart - J.match_start > 4096))
                    J.match_length = A6 - 1
            }
            if (J.prev_length >= A6 && J.match_length <= J.prev_length) {
                q = J.strstart + J.lookahead - A6,
                    $ = oQ(J, J.strstart - 1 - J.prev_match, J.prev_length - A6),
                    J.lookahead -= J.prev_length - 1,
                    J.prev_length -= 2;
                do
                    if (++J.strstart <= q)
                        J.ins_h = sQ(J, J.ins_h, J.global[J.strstart + A6 - 1]),
                            Z = J.prev[J.strstart & J.w_mask] = J.head[J.ins_h],
                            J.head[J.ins_h] = J.strstart;
                while (--J.prev_length !== 0);
                if (J.match_available = 0,
                    J.match_length = A6 - 1,
                    J.strstart++,
                    $) {
                    if (j5(J, !1),
                        J.strm.avail_out === 0)
                        return gJ
                }
            } else if (J.match_available) {
                if ($ = oQ(J, 0, J.global[J.strstart - 1]),
                    $)
                    j5(J, !1);
                if (J.strstart++,
                    J.lookahead--,
                    J.strm.avail_out === 0)
                    return gJ
            } else
                J.match_available = 1,
                    J.strstart++,
                    J.lookahead--
        }
        if (J.match_available)
            $ = oQ(J, 0, J.global[J.strstart - 1]),
                J.match_available = 0;
        if (J.insert = J.strstart < A6 - 1 ? J.strstart : A6 - 1,
            Q === P5) {
            if (j5(J, !0),
                J.strm.avail_out === 0)
                return tZ;
            return v1
        }
        if (J.sym_next) {
            if (j5(J, !1),
                J.strm.avail_out === 0)
                return gJ
        }
        return b1
    }
    , Qf = (J, Q) => {
        let Z, $, q, K, V = J.global;
        for (; ;) {
            if (J.lookahead <= lQ) {
                if (_1(J),
                    J.lookahead <= lQ && Q === nQ)
                    return gJ;
                if (J.lookahead === 0)
                    break
            }
            if (J.match_length = 0,
                J.lookahead >= A6 && J.strstart > 0) {
                if (q = J.strstart - 1,
                    $ = V[q],
                    $ === V[++q] && $ === V[++q] && $ === V[++q]) {
                    K = J.strstart + lQ;
                    do
                        ;
                    while ($ === V[++q] && $ === V[++q] && $ === V[++q] && $ === V[++q] && $ === V[++q] && $ === V[++q] && $ === V[++q] && $ === V[++q] && q < K);
                    if (J.match_length = lQ - (K - q),
                        J.match_length > J.lookahead)
                        J.match_length = J.lookahead
                }
            }
            if (J.match_length >= A6)
                Z = oQ(J, 1, J.match_length - A6),
                    J.lookahead -= J.match_length,
                    J.strstart += J.match_length,
                    J.match_length = 0;
            else
                Z = oQ(J, 0, J.global[J.strstart]),
                    J.lookahead--,
                    J.strstart++;
            if (Z) {
                if (j5(J, !1),
                    J.strm.avail_out === 0)
                    return gJ
            }
        }
        if (J.insert = 0,
            Q === P5) {
            if (j5(J, !0),
                J.strm.avail_out === 0)
                return tZ;
            return v1
        }
        if (J.sym_next) {
            if (j5(J, !1),
                J.strm.avail_out === 0)
                return gJ
        }
        return b1
    }
    , Zf = (J, Q) => {
        let Z;
        for (; ;) {
            if (J.lookahead === 0) {
                if (_1(J),
                    J.lookahead === 0) {
                    if (Q === nQ)
                        return gJ;
                    break
                }
            }
            if (J.match_length = 0,
                Z = oQ(J, 0, J.global[J.strstart]),
                J.lookahead--,
                J.strstart++,
                Z) {
                if (j5(J, !1),
                    J.strm.avail_out === 0)
                    return gJ
            }
        }
        if (J.insert = 0,
            Q === P5) {
            if (j5(J, !0),
                J.strm.avail_out === 0)
                return tZ;
            return v1
        }
        if (J.sym_next) {
            if (j5(J, !1),
                J.strm.avail_out === 0)
                return gJ
        }
        return b1
    }
    ;
function I9(J, Q, Z, $, q) {
    this.good_length = J,
        this.max_lazy = Q,
        this.nice_length = Z,
        this.max_chain = $,
        this.func = q
}
var o4 = [new I9(0, 0, 0, 0, uA), new I9(4, 4, 8, 4, AL), new I9(4, 5, 16, 8, AL), new I9(4, 6, 32, 32, AL), new I9(4, 4, 16, 16, D1), new I9(8, 16, 32, 32, D1), new I9(8, 16, 128, 128, D1), new I9(8, 32, 128, 256, D1), new I9(32, 128, 258, 1024, D1), new I9(32, 258, 258, 4096, D1)]
    , $f = (J) => {
        J.global_size = 2 * J.w_size,
            uQ(J.head),
            J.max_lazy_match = o4[J.level].max_lazy,
            J.good_match = o4[J.level].good_length,
            J.nice_match = o4[J.level].nice_length,
            J.max_chain_length = o4[J.level].max_chain,
            J.strstart = 0,
            J.block_start = 0,
            J.lookahead = 0,
            J.insert = 0,
            J.match_length = J.prev_length = A6 - 1,
            J.match_available = 0,
            J.ins_h = 0
    }
    ;
function qf() {
    this.strm = null,
        this.status = 0,
        this.pending_buf = null,
        this.pending_buf_size = 0,
        this.pending_out = 0,
        this.pending = 0,
        this.wrap = 0,
        this.gzhead = null,
        this.gzindex = 0,
        this.method = TY,
        this.last_flush = -1,
        this.w_size = 0,
        this.w_bits = 0,
        this.w_mask = 0,
        this.global = null,
        this.global_size = 0,
        this.prev = null,
        this.head = null,
        this.ins_h = 0,
        this.hash_size = 0,
        this.hash_bits = 0,
        this.hash_mask = 0,
        this.hash_shift = 0,
        this.block_start = 0,
        this.match_length = 0,
        this.prev_match = 0,
        this.match_available = 0,
        this.strstart = 0,
        this.match_start = 0,
        this.lookahead = 0,
        this.prev_length = 0,
        this.max_chain_length = 0,
        this.max_lazy_match = 0,
        this.level = 0,
        this.strategy = 0,
        this.good_match = 0,
        this.nice_match = 0,
        this.dyn_ltree = new Uint16Array(iy * 2),
        this.dyn_dtree = new Uint16Array((2 * ny + 1) * 2),
        this.bl_tree = new Uint16Array((2 * sy + 1) * 2),
        uQ(this.dyn_ltree),
        uQ(this.dyn_dtree),
        uQ(this.bl_tree),
        this.l_desc = null,
        this.d_desc = null,
        this.bl_desc = null,
        this.bl_count = new Uint16Array(ay + 1),
        this.heap = new Uint16Array(2 * xL + 1),
        uQ(this.heap),
        this.heap_len = 0,
        this.heap_max = 0,
        this.depth = new Uint16Array(2 * xL + 1),
        uQ(this.depth),
        this.sym_buf = 0,
        this.lit_bufsize = 0,
        this.sym_next = 0,
        this.sym_end = 0,
        this.opt_len = 0,
        this.static_len = 0,
        this.matches = 0,
        this.insert = 0,
        this.bi_buf = 0,
        this.bi_valid = 0
}
var KV = (J) => {
    if (!J)
        return 1;
    let Q = J.state;
    if (!Q || Q.strm !== J || Q.status !== M1 && Q.status !== sL && Q.status !== gL && Q.status !== mL && Q.status !== cL && Q.status !== dL && Q.status !== iZ && Q.status !== l4)
        return 1;
    return 0
}
    , lA = (J) => {
        if (KV(J))
            return aZ(J, F9);
        J.total_in = J.total_out = 0,
            J.data_type = cy;
        let Q = J.state;
        if (Q.pending = 0,
            Q.pending_out = 0,
            Q.wrap < 0)
            Q.wrap = -Q.wrap;
        return Q.status = Q.wrap === 2 ? sL : Q.wrap ? M1 : iZ,
            J.adler = Q.wrap === 2 ? 0 : 1,
            Q.last_flush = -2,
            Ry(Q),
            NJ
    }
    , oA = (J) => {
        let Q = lA(J);
        if (Q === NJ)
            $f(J.state);
        return Q
    }
    , Kf = (J, Q) => {
        if (KV(J) || J.state.wrap !== 2)
            return F9;
        return J.state.gzhead = Q,
            NJ
    }
    , nA = (J, Q, Z, $, q, K) => {
        if (!J)
            return F9;
        let V = 1;
        if (Q === fy)
            Q = 6;
        if ($ < 0)
            V = 0,
                $ = -$;
        else if ($ > 15)
            V = 2,
                $ -= 16;
        if (q < 1 || q > dy || Z !== TY || $ < 8 || $ > 15 || Q < 0 || Q > 9 || K < 0 || K > gy || $ === 8 && V !== 1)
            return aZ(J, F9);
        if ($ === 8)
            $ = 9;
        let z = new qf;
        return J.state = z,
            z.strm = J,
            z.status = M1,
            z.wrap = V,
            z.gzhead = null,
            z.w_bits = $,
            z.w_size = 1 << z.w_bits,
            z.w_mask = z.w_size - 1,
            z.hash_bits = q + 7,
            z.hash_size = 1 << z.hash_bits,
            z.hash_mask = z.hash_size - 1,
            z.hash_shift = ~~((z.hash_bits + A6 - 1) / A6),
            z.global = new Uint8Array(z.w_size * 2),
            z.head = new Uint16Array(z.hash_size),
            z.prev = new Uint16Array(z.w_size),
            z.lit_bufsize = 1 << q + 6,
            z.pending_buf_size = z.lit_bufsize * 4,
            z.pending_buf = new Uint8Array(z.pending_buf_size),
            z.sym_buf = z.lit_bufsize,
            z.sym_end = (z.lit_bufsize - 1) * 3,
            z.level = Q,
            z.strategy = K,
            z.method = Z,
            oA(J)
    }
    , Vf = (J, Q) => {
        return nA(J, Q, TY, py, uy, my)
    }
    , zf = (J, Q) => {
        if (KV(J) || Q > i3 || Q < 0)
            return J ? aZ(J, F9) : F9;
        let Z = J.state;
        if (!J.output || J.avail_in !== 0 && !J.input || Z.status === l4 && Q !== P5)
            return aZ(J, J.avail_out === 0 ? DL : F9);
        let $ = Z.last_flush;
        if (Z.last_flush = Q,
            Z.pending !== 0) {
            if (w5(J),
                J.avail_out === 0)
                return Z.last_flush = -1,
                    NJ
        } else if (J.avail_in === 0 && r3(Q) <= r3($) && Q !== P5)
            return aZ(J, DL);
        if (Z.status === l4 && J.avail_in !== 0)
            return aZ(J, DL);
        if (Z.status === M1 && Z.wrap === 0)
            Z.status = iZ;
        if (Z.status === M1) {
            let q = TY + (Z.w_bits - 8 << 4) << 8
                , K = -1;
            if (Z.strategy >= DY || Z.level < 2)
                K = 0;
            else if (Z.level < 6)
                K = 1;
            else if (Z.level === 6)
                K = 2;
            else
                K = 3;
            if (q |= K << 6,
                Z.strstart !== 0)
                q |= ry;
            if (q += 31 - q % 31,
                u4(Z, q),
                Z.strstart !== 0)
                u4(Z, J.adler >>> 16),
                    u4(Z, J.adler & 65535);
            if (J.adler = 1,
                Z.status = iZ,
                w5(J),
                Z.pending !== 0)
                return Z.last_flush = -1,
                    NJ
        }
        if (Z.status === sL)
            if (J.adler = 0,
                x6(Z, 31),
                x6(Z, 139),
                x6(Z, 8),
                !Z.gzhead) {
                if (x6(Z, 0),
                    x6(Z, 0),
                    x6(Z, 0),
                    x6(Z, 0),
                    x6(Z, 0),
                    x6(Z, Z.level === 9 ? 2 : Z.strategy >= DY || Z.level < 2 ? 4 : 0),
                    x6(Z, ty),
                    Z.status = iZ,
                    w5(J),
                    Z.pending !== 0)
                    return Z.last_flush = -1,
                        NJ
            } else {
                if (x6(Z, (Z.gzhead.text ? 1 : 0) + (Z.gzhead.hcrc ? 2 : 0) + (!Z.gzhead.extra ? 0 : 4) + (!Z.gzhead.name ? 0 : 8) + (!Z.gzhead.comment ? 0 : 16)),
                    x6(Z, Z.gzhead.time & 255),
                    x6(Z, Z.gzhead.time >> 8 & 255),
                    x6(Z, Z.gzhead.time >> 16 & 255),
                    x6(Z, Z.gzhead.time >> 24 & 255),
                    x6(Z, Z.level === 9 ? 2 : Z.strategy >= DY || Z.level < 2 ? 4 : 0),
                    x6(Z, Z.gzhead.os & 255),
                    Z.gzhead.extra && Z.gzhead.extra.length)
                    x6(Z, Z.gzhead.extra.length & 255),
                        x6(Z, Z.gzhead.extra.length >> 8 & 255);
                if (Z.gzhead.hcrc)
                    J.adler = $J(J.adler, Z.pending_buf, Z.pending, 0);
                Z.gzindex = 0,
                    Z.status = gL
            }
        if (Z.status === gL) {
            if (Z.gzhead.extra) {
                let q = Z.pending
                    , K = (Z.gzhead.extra.length & 65535) - Z.gzindex;
                while (Z.pending + K > Z.pending_buf_size) {
                    let z = Z.pending_buf_size - Z.pending;
                    if (Z.pending_buf.set(Z.gzhead.extra.subarray(Z.gzindex, Z.gzindex + z), Z.pending),
                        Z.pending = Z.pending_buf_size,
                        Z.gzhead.hcrc && Z.pending > q)
                        J.adler = $J(J.adler, Z.pending_buf, Z.pending - q, q);
                    if (Z.gzindex += z,
                        w5(J),
                        Z.pending !== 0)
                        return Z.last_flush = -1,
                            NJ;
                    q = 0,
                        K -= z
                }
                let V = new Uint8Array(Z.gzhead.extra);
                if (Z.pending_buf.set(V.subarray(Z.gzindex, Z.gzindex + K), Z.pending),
                    Z.pending += K,
                    Z.gzhead.hcrc && Z.pending > q)
                    J.adler = $J(J.adler, Z.pending_buf, Z.pending - q, q);
                Z.gzindex = 0
            }
            Z.status = mL
        }
        if (Z.status === mL) {
            if (Z.gzhead.name) {
                let q = Z.pending, K;
                do {
                    if (Z.pending === Z.pending_buf_size) {
                        if (Z.gzhead.hcrc && Z.pending > q)
                            J.adler = $J(J.adler, Z.pending_buf, Z.pending - q, q);
                        if (w5(J),
                            Z.pending !== 0)
                            return Z.last_flush = -1,
                                NJ;
                        q = 0
                    }
                    if (Z.gzindex < Z.gzhead.name.length)
                        K = Z.gzhead.name.charCodeAt(Z.gzindex++) & 255;
                    else
                        K = 0;
                    x6(Z, K)
                } while (K !== 0);
                if (Z.gzhead.hcrc && Z.pending > q)
                    J.adler = $J(J.adler, Z.pending_buf, Z.pending - q, q);
                Z.gzindex = 0
            }
            Z.status = cL
        }
        if (Z.status === cL) {
            if (Z.gzhead.comment) {
                let q = Z.pending, K;
                do {
                    if (Z.pending === Z.pending_buf_size) {
                        if (Z.gzhead.hcrc && Z.pending > q)
                            J.adler = $J(J.adler, Z.pending_buf, Z.pending - q, q);
                        if (w5(J),
                            Z.pending !== 0)
                            return Z.last_flush = -1,
                                NJ;
                        q = 0
                    }
                    if (Z.gzindex < Z.gzhead.comment.length)
                        K = Z.gzhead.comment.charCodeAt(Z.gzindex++) & 255;
                    else
                        K = 0;
                    x6(Z, K)
                } while (K !== 0);
                if (Z.gzhead.hcrc && Z.pending > q)
                    J.adler = $J(J.adler, Z.pending_buf, Z.pending - q, q)
            }
            Z.status = dL
        }
        if (Z.status === dL) {
            if (Z.gzhead.hcrc) {
                if (Z.pending + 2 > Z.pending_buf_size) {
                    if (w5(J),
                        Z.pending !== 0)
                        return Z.last_flush = -1,
                            NJ
                }
                x6(Z, J.adler & 255),
                    x6(Z, J.adler >> 8 & 255),
                    J.adler = 0
            }
            if (Z.status = iZ,
                w5(J),
                Z.pending !== 0)
                return Z.last_flush = -1,
                    NJ
        }
        if (J.avail_in !== 0 || Z.lookahead !== 0 || Q !== nQ && Z.status !== l4) {
            let q = Z.level === 0 ? uA(Z, Q) : Z.strategy === DY ? Zf(Z, Q) : Z.strategy === xy ? Qf(Z, Q) : o4[Z.level].func(Z, Q);
            if (q === tZ || q === v1)
                Z.status = l4;
            if (q === gJ || q === tZ) {
                if (J.avail_out === 0)
                    Z.last_flush = -1;
                return NJ
            }
            if (q === b1) {
                if (Q === Sy)
                    vy(Z);
                else if (Q !== i3) {
                    if (hL(Z, 0, 0, !1),
                        Q === Ty) {
                        if (uQ(Z.head),
                            Z.lookahead === 0)
                            Z.strstart = 0,
                                Z.block_start = 0,
                                Z.insert = 0
                    }
                }
                if (w5(J),
                    J.avail_out === 0)
                    return Z.last_flush = -1,
                        NJ
            }
        }
        if (Q !== P5)
            return NJ;
        if (Z.wrap <= 0)
            return a3;
        if (Z.wrap === 2)
            x6(Z, J.adler & 255),
                x6(Z, J.adler >> 8 & 255),
                x6(Z, J.adler >> 16 & 255),
                x6(Z, J.adler >> 24 & 255),
                x6(Z, J.total_in & 255),
                x6(Z, J.total_in >> 8 & 255),
                x6(Z, J.total_in >> 16 & 255),
                x6(Z, J.total_in >> 24 & 255);
        else
            u4(Z, J.adler >>> 16),
                u4(Z, J.adler & 65535);
        if (w5(J),
            Z.wrap > 0)
            Z.wrap = -Z.wrap;
        return Z.pending !== 0 ? NJ : a3
    }
    , Wf = (J) => {
        if (KV(J))
            return F9;
        let Q = J.state.status;
        return J.state = null,
            Q === iZ ? aZ(J, yy) : NJ
    }
    , Hf = (J, Q) => {
        let Z = Q.length;
        if (KV(J))
            return F9;
        let $ = J.state
            , q = $.wrap;
        if (q === 2 || q === 1 && $.status !== M1 || $.lookahead)
            return F9;
        if (q === 1)
            J.adler = JV(J.adler, Q, Z, 0);
        if ($.wrap = 0,
            Z >= $.w_size) {
            if (q === 0)
                uQ($.head),
                    $.strstart = 0,
                    $.block_start = 0,
                    $.insert = 0;
            let W = new Uint8Array($.w_size);
            W.set(Q.subarray(Z - $.w_size, Z), 0),
                Q = W,
                Z = $.w_size
        }
        let { avail_in: K, next_in: V, input: z } = J;
        J.avail_in = Z,
            J.next_in = 0,
            J.input = Q,
            _1($);
        while ($.lookahead >= A6) {
            let W = $.strstart
                , H = $.lookahead - (A6 - 1);
            do
                $.ins_h = sQ($, $.ins_h, $.global[W + A6 - 1]),
                    $.prev[W & $.w_mask] = $.head[$.ins_h],
                    $.head[$.ins_h] = W,
                    W++;
            while (--H);
            $.strstart = W,
                $.lookahead = A6 - 1,
                _1($)
        }
        return $.strstart += $.lookahead,
            $.block_start = $.strstart,
            $.insert = $.lookahead,
            $.lookahead = 0,
            $.match_length = $.prev_length = A6 - 1,
            $.match_available = 0,
            J.next_in = V,
            J.input = z,
            J.avail_in = K,
            $.wrap = q,
            NJ
    }
    , Yf = Vf
    , Xf = nA
    , Uf = oA
    , Nf = lA
    , wf = Kf
    , jf = zf
    , Bf = Wf
    , kf = Hf
    , Cf = "pako deflate (from Nodeca project)"
    , s4 = {
        deflateInit: Yf,
        deflateInit2: Xf,
        deflateReset: Uf,
        deflateResetKeep: Nf,
        deflateSetHeader: wf,
        deflate: jf,
        deflateEnd: Bf,
        deflateSetDictionary: kf,
        deflateInfo: Cf
    }
    , Of = (J, Q) => {
        return Object.prototype.hasOwnProperty.call(J, Q)
    }
    , If = function (J) {
        let Q = Array.prototype.slice.call(arguments, 1);
        while (Q.length) {
            let Z = Q.shift();
            if (!Z)
                continue;
            if (typeof Z !== "object")
                throw new TypeError(Z + "must be non-object");
            for (let $ in Z)
                if (Of(Z, $))
                    J[$] = Z[$]
        }
        return J
    }
    , Lf = (J) => {
        let Q = 0;
        for (let $ = 0, q = J.length; $ < q; $++)
            Q += J[$].length;
        let Z = new Uint8Array(Q);
        for (let $ = 0, q = 0, K = J.length; $ < K; $++) {
            let V = J[$];
            Z.set(V, q),
                q += V.length
        }
        return Z
    }
    , yY = {
        assign: If,
        flattenChunks: Lf
    }
    , sA = !0;
try {
    String.fromCharCode.apply(null, new Uint8Array(1))
} catch (J) {
    sA = !1
}
var QV = new Uint8Array(256);
for (let J = 0; J < 256; J++)
    QV[J] = J >= 252 ? 6 : J >= 248 ? 5 : J >= 240 ? 4 : J >= 224 ? 3 : J >= 192 ? 2 : 1;
QV[254] = QV[254] = 1;
var Ff = (J) => {
    if (typeof TextEncoder === "function" && TextEncoder.prototype.encode)
        return new TextEncoder().encode(J);
    let Q, Z, $, q, K, V = J.length, z = 0;
    for (q = 0; q < V; q++) {
        if (Z = J.charCodeAt(q),
            (Z & 64512) === 55296 && q + 1 < V) {
            if ($ = J.charCodeAt(q + 1),
                ($ & 64512) === 56320)
                Z = 65536 + (Z - 55296 << 10) + ($ - 56320),
                    q++
        }
        z += Z < 128 ? 1 : Z < 2048 ? 2 : Z < 65536 ? 3 : 4
    }
    Q = new Uint8Array(z);
    for (K = 0,
        q = 0; K < z; q++) {
        if (Z = J.charCodeAt(q),
            (Z & 64512) === 55296 && q + 1 < V) {
            if ($ = J.charCodeAt(q + 1),
                ($ & 64512) === 56320)
                Z = 65536 + (Z - 55296 << 10) + ($ - 56320),
                    q++
        }
        if (Z < 128)
            Q[K++] = Z;
        else if (Z < 2048)
            Q[K++] = 192 | Z >>> 6,
                Q[K++] = 128 | Z & 63;
        else if (Z < 65536)
            Q[K++] = 224 | Z >>> 12,
                Q[K++] = 128 | Z >>> 6 & 63,
                Q[K++] = 128 | Z & 63;
        else
            Q[K++] = 240 | Z >>> 18,
                Q[K++] = 128 | Z >>> 12 & 63,
                Q[K++] = 128 | Z >>> 6 & 63,
                Q[K++] = 128 | Z & 63
    }
    return Q
}
    , Gf = (J, Q) => {
        if (Q < 65534) {
            if (J.subarray && sA)
                return String.fromCharCode.apply(null, J.length === Q ? J : J.subarray(0, Q))
        }
        let Z = "";
        for (let $ = 0; $ < Q; $++)
            Z += String.fromCharCode(J[$]);
        return Z
    }
    , Pf = (J, Q) => {
        let Z = Q || J.length;
        if (typeof TextDecoder === "function" && TextDecoder.prototype.decode)
            return new TextDecoder().decode(J.subarray(0, Q));
        let $, q, K = new Array(Z * 2);
        for (q = 0,
            $ = 0; $ < Z;) {
            let V = J[$++];
            if (V < 128) {
                K[q++] = V;
                continue
            }
            let z = QV[V];
            if (z > 4) {
                K[q++] = 65533,
                    $ += z - 1;
                continue
            }
            V &= z === 2 ? 31 : z === 3 ? 15 : 7;
            while (z > 1 && $ < Z)
                V = V << 6 | J[$++] & 63,
                    z--;
            if (z > 1) {
                K[q++] = 65533;
                continue
            }
            if (V < 65536)
                K[q++] = V;
            else
                V -= 65536,
                    K[q++] = 55296 | V >> 10 & 1023,
                    K[q++] = 56320 | V & 1023
        }
        return Gf(K, q)
    }
    , Df = (J, Q) => {
        if (Q = Q || J.length,
            Q > J.length)
            Q = J.length;
        let Z = Q - 1;
        while (Z >= 0 && (J[Z] & 192) === 128)
            Z--;
        if (Z < 0)
            return Q;
        if (Z === 0)
            return Q;
        return Z + QV[J[Z]] > Q ? Z : Q
    }
    , ZV = {
        string2buf: Ff,
        buf2string: Pf,
        utf8border: Df
    };
function Af() {
    this.input = null,
        this.next_in = 0,
        this.avail_in = 0,
        this.total_in = 0,
        this.output = null,
        this.next_out = 0,
        this.avail_out = 0,
        this.total_out = 0,
        this.msg = "",
        this.state = null,
        this.data_type = 2,
        this.adler = 0
}
var iA = Af
    , aA = Object.prototype.toString
    , { Z_NO_FLUSH: Ef, Z_SYNC_FLUSH: Mf, Z_FULL_FLUSH: _f, Z_FINISH: Rf, Z_OK: vY, Z_STREAM_END: bf, Z_DEFAULT_COMPRESSION: vf, Z_DEFAULT_STRATEGY: Sf, Z_DEFLATED: Tf } = J$;
function VV(J) {
    this.options = yY.assign({
        level: vf,
        method: Tf,
        chunkSize: 16384,
        globalBits: 15,
        memLevel: 8,
        strategy: Sf
    }, J || {});
    let Q = this.options;
    if (Q.raw && Q.globalBits > 0)
        Q.globalBits = -Q.globalBits;
    else if (Q.gzip && Q.globalBits > 0 && Q.globalBits < 16)
        Q.globalBits += 16;
    this.err = 0,
        this.msg = "",
        this.ended = !1,
        this.chunks = [],
        this.strm = new iA,
        this.strm.avail_out = 0;
    let Z = s4.deflateInit2(this.strm, Q.level, Q.method, Q.globalBits, Q.memLevel, Q.strategy);
    if (Z !== vY)
        throw new Error(rZ[Z]);
    if (Q.header)
        s4.deflateSetHeader(this.strm, Q.header);
    if (Q.dictionary) {
        let $;
        if (typeof Q.dictionary === "string")
            $ = ZV.string2buf(Q.dictionary);
        else if (aA.call(Q.dictionary) === "[object ArrayBuffer]")
            $ = new Uint8Array(Q.dictionary);
        else
            $ = Q.dictionary;
        if (Z = s4.deflateSetDictionary(this.strm, $),
            Z !== vY)
            throw new Error(rZ[Z]);
        this._dict_set = !0
    }
}
VV.prototype.push = function (J, Q) {
    let Z = this.strm, $ = this.options.chunkSize, q, K;
    if (this.ended)
        return !1;
    if (Q === ~~Q)
        K = Q;
    else
        K = Q === !0 ? Rf : Ef;
    if (typeof J === "string")
        Z.input = ZV.string2buf(J);
    else if (aA.call(J) === "[object ArrayBuffer]")
        Z.input = new Uint8Array(J);
    else
        Z.input = J;
    Z.next_in = 0,
        Z.avail_in = Z.input.length;
    for (; ;) {
        if (Z.avail_out === 0)
            Z.output = new Uint8Array($),
                Z.next_out = 0,
                Z.avail_out = $;
        if ((K === Mf || K === _f) && Z.avail_out <= 6) {
            this.onData(Z.output.subarray(0, Z.next_out)),
                Z.avail_out = 0;
            continue
        }
        if (q = s4.deflate(Z, K),
            q === bf) {
            if (Z.next_out > 0)
                this.onData(Z.output.subarray(0, Z.next_out));
            return q = s4.deflateEnd(this.strm),
                this.onEnd(q),
                this.ended = !0,
                q === vY
        }
        if (Z.avail_out === 0) {
            this.onData(Z.output);
            continue
        }
        if (K > 0 && Z.next_out > 0) {
            this.onData(Z.output.subarray(0, Z.next_out)),
                Z.avail_out = 0;
            continue
        }
        if (Z.avail_in === 0)
            break
    }
    return !0
}
    ;
VV.prototype.onData = function (J) {
    this.chunks.push(J)
}
    ;
VV.prototype.onEnd = function (J) {
    if (J === vY)
        this.result = yY.flattenChunks(this.chunks);
    this.chunks = [],
        this.err = J,
        this.msg = this.strm.msg
}
    ;
function iL(J, Q) {
    let Z = new VV(Q);
    if (Z.push(J, !0),
        Z.err)
        throw Z.msg || rZ[Z.err];
    return Z.result
}
function yf(J, Q) {
    return Q = Q || {},
        Q.raw = !0,
        iL(J, Q)
}
function ff(J, Q) {
    return Q = Q || {},
        Q.gzip = !0,
        iL(J, Q)
}
var hf = VV
    , xf = iL
    , gf = yf
    , mf = ff
    , cf = J$
    , df = {
        Deflate: hf,
        deflate: xf,
        deflateRaw: gf,
        gzip: mf,
        constants: cf
    }
    , AY = 16209
    , pf = 16191
    , uf = function J(Q, Z) {
        let $, q, K, V, z, W, H, Y, U, N, j, k, L, F, P, M, v, E, n, u, b, i, g, l, o = Q.state;
        $ = Q.next_in,
            g = Q.input,
            q = $ + (Q.avail_in - 5),
            K = Q.next_out,
            l = Q.output,
            V = K - (Z - Q.avail_out),
            z = K + (Q.avail_out - 257),
            W = o.dmax,
            H = o.wsize,
            Y = o.whave,
            U = o.wnext,
            N = o.global,
            j = o.hold,
            k = o.bits,
            L = o.lencode,
            F = o.distcode,
            P = (1 << o.lenbits) - 1,
            M = (1 << o.distbits) - 1;
        J: do {
            if (k < 15)
                j += g[$++] << k,
                    k += 8,
                    j += g[$++] << k,
                    k += 8;
            v = L[j & P];
            Q: for (; ;) {
                if (E = v >>> 24,
                    j >>>= E,
                    k -= E,
                    E = v >>> 16 & 255,
                    E === 0)
                    l[K++] = v & 65535;
                else if (E & 16) {
                    if (n = v & 65535,
                        E &= 15,
                        E) {
                        if (k < E)
                            j += g[$++] << k,
                                k += 8;
                        n += j & (1 << E) - 1,
                            j >>>= E,
                            k -= E
                    }
                    if (k < 15)
                        j += g[$++] << k,
                            k += 8,
                            j += g[$++] << k,
                            k += 8;
                    v = F[j & M];
                    Z: for (; ;) {
                        if (E = v >>> 24,
                            j >>>= E,
                            k -= E,
                            E = v >>> 16 & 255,
                            E & 16) {
                            if (u = v & 65535,
                                E &= 15,
                                k < E) {
                                if (j += g[$++] << k,
                                    k += 8,
                                    k < E)
                                    j += g[$++] << k,
                                        k += 8
                            }
                            if (u += j & (1 << E) - 1,
                                u > W) {
                                Q.msg = "invalid distance too far back",
                                    o.mode = AY;
                                break J
                            }
                            if (j >>>= E,
                                k -= E,
                                E = K - V,
                                u > E) {
                                if (E = u - E,
                                    E > Y) {
                                    if (o.sane) {
                                        Q.msg = "invalid distance too far back",
                                            o.mode = AY;
                                        break J
                                    }
                                }
                                if (b = 0,
                                    i = N,
                                    U === 0) {
                                    if (b += H - E,
                                        E < n) {
                                        n -= E;
                                        do
                                            l[K++] = N[b++];
                                        while (--E);
                                        b = K - u,
                                            i = l
                                    }
                                } else if (U < E) {
                                    if (b += H + U - E,
                                        E -= U,
                                        E < n) {
                                        n -= E;
                                        do
                                            l[K++] = N[b++];
                                        while (--E);
                                        if (b = 0,
                                            U < n) {
                                            E = U,
                                                n -= E;
                                            do
                                                l[K++] = N[b++];
                                            while (--E);
                                            b = K - u,
                                                i = l
                                        }
                                    }
                                } else if (b += U - E,
                                    E < n) {
                                    n -= E;
                                    do
                                        l[K++] = N[b++];
                                    while (--E);
                                    b = K - u,
                                        i = l
                                }
                                while (n > 2)
                                    l[K++] = i[b++],
                                        l[K++] = i[b++],
                                        l[K++] = i[b++],
                                        n -= 3;
                                if (n) {
                                    if (l[K++] = i[b++],
                                        n > 1)
                                        l[K++] = i[b++]
                                }
                            } else {
                                b = K - u;
                                do
                                    l[K++] = l[b++],
                                        l[K++] = l[b++],
                                        l[K++] = l[b++],
                                        n -= 3;
                                while (n > 2);
                                if (n) {
                                    if (l[K++] = l[b++],
                                        n > 1)
                                        l[K++] = l[b++]
                                }
                            }
                        } else if ((E & 64) === 0) {
                            v = F[(v & 65535) + (j & (1 << E) - 1)];
                            continue Z
                        } else {
                            Q.msg = "invalid distance code",
                                o.mode = AY;
                            break J
                        }
                        break
                    }
                } else if ((E & 64) === 0) {
                    v = L[(v & 65535) + (j & (1 << E) - 1)];
                    continue Q
                } else if (E & 32) {
                    o.mode = pf;
                    break J
                } else {
                    Q.msg = "invalid literal/length code",
                        o.mode = AY;
                    break J
                }
                break
            }
        } while ($ < q && K < z);
        n = k >> 3,
            $ -= n,
            k -= n << 3,
            j &= (1 << k) - 1,
            Q.next_in = $,
            Q.next_out = K,
            Q.avail_in = $ < q ? 5 + (q - $) : 5 - ($ - q),
            Q.avail_out = K < z ? 257 + (z - K) : 257 - (K - z),
            o.hold = j,
            o.bits = k;
        return
    }
    , A1 = 15
    , t3 = 852
    , e3 = 592
    , JA = 0
    , EL = 1
    , QA = 2
    , lf = new Uint16Array([3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0])
    , of = new Uint8Array([16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18, 19, 19, 19, 19, 20, 20, 20, 20, 21, 21, 21, 21, 16, 72, 78])
    , nf = new Uint16Array([1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577, 0, 0])
    , sf = new Uint8Array([16, 16, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 64, 64])
    , af = (J, Q, Z, $, q, K, V, z) => {
        let W = z.bits, H = 0, Y = 0, U = 0, N = 0, j = 0, k = 0, L = 0, F = 0, P = 0, M = 0, v, E, n, u, b, i = null, g, l = new Uint16Array(A1 + 1), o = new Uint16Array(A1 + 1), F0 = null, b0, d0, H8;
        for (H = 0; H <= A1; H++)
            l[H] = 0;
        for (Y = 0; Y < $; Y++)
            l[Q[Z + Y]]++;
        j = W;
        for (N = A1; N >= 1; N--)
            if (l[N] !== 0)
                break;
        if (j > N)
            j = N;
        if (N === 0)
            return q[K++] = 20971520,
                q[K++] = 20971520,
                z.bits = 1,
                0;
        for (U = 1; U < N; U++)
            if (l[U] !== 0)
                break;
        if (j < U)
            j = U;
        F = 1;
        for (H = 1; H <= A1; H++)
            if (F <<= 1,
                F -= l[H],
                F < 0)
                return -1;
        if (F > 0 && (J === JA || N !== 1))
            return -1;
        o[1] = 0;
        for (H = 1; H < A1; H++)
            o[H + 1] = o[H] + l[H];
        for (Y = 0; Y < $; Y++)
            if (Q[Z + Y] !== 0)
                V[o[Q[Z + Y]]++] = Y;
        if (J === JA)
            i = F0 = V,
                g = 20;
        else if (J === EL)
            i = lf,
                F0 = of,
                g = 257;
        else
            i = nf,
                F0 = sf,
                g = 0;
        if (M = 0,
            Y = 0,
            H = U,
            b = K,
            k = j,
            L = 0,
            n = -1,
            P = 1 << j,
            u = P - 1,
            J === EL && P > t3 || J === QA && P > e3)
            return 1;
        for (; ;) {
            if (b0 = H - L,
                V[Y] + 1 < g)
                d0 = 0,
                    H8 = V[Y];
            else if (V[Y] >= g)
                d0 = F0[V[Y] - g],
                    H8 = i[V[Y] - g];
            else
                d0 = 96,
                    H8 = 0;
            v = 1 << H - L,
                E = 1 << k,
                U = E;
            do
                E -= v,
                    q[b + (M >> L) + E] = b0 << 24 | d0 << 16 | H8 | 0;
            while (E !== 0);
            v = 1 << H - 1;
            while (M & v)
                v >>= 1;
            if (v !== 0)
                M &= v - 1,
                    M += v;
            else
                M = 0;
            if (Y++,
                --l[H] === 0) {
                if (H === N)
                    break;
                H = Q[Z + V[Y]]
            }
            if (H > j && (M & u) !== n) {
                if (L === 0)
                    L = j;
                b += U,
                    k = H - L,
                    F = 1 << k;
                while (k + L < N) {
                    if (F -= l[k + L],
                        F <= 0)
                        break;
                    k++,
                        F <<= 1
                }
                if (P += 1 << k,
                    J === EL && P > t3 || J === QA && P > e3)
                    return 1;
                n = M & u,
                    q[n] = j << 24 | k << 16 | b - K | 0
            }
        }
        if (M !== 0)
            q[b + M] = H - L << 24 | 4194304 | 0;
        return z.bits = j,
            0
    }
    , i4 = af
    , rf = 0
    , rA = 1
    , tA = 2
    , { Z_FINISH: ZA, Z_BLOCK: tf, Z_TREES: EY, Z_OK: eZ, Z_STREAM_END: ef, Z_NEED_DICT: Jh, Z_STREAM_ERROR: D5, Z_DATA_ERROR: eA, Z_MEM_ERROR: JE, Z_BUF_ERROR: Qh, Z_DEFLATED: $A } = J$
    , fY = 16180
    , qA = 16181
    , KA = 16182
    , VA = 16183
    , zA = 16184
    , WA = 16185
    , HA = 16186
    , YA = 16187
    , XA = 16188
    , UA = 16189
    , SY = 16190
    , $Q = 16191
    , ML = 16192
    , NA = 16193
    , _L = 16194
    , wA = 16195
    , jA = 16196
    , BA = 16197
    , kA = 16198
    , MY = 16199
    , _Y = 16200
    , CA = 16201
    , OA = 16202
    , IA = 16203
    , LA = 16204
    , FA = 16205
    , RL = 16206
    , GA = 16207
    , PA = 16208
    , w7 = 16209
    , QE = 16210
    , ZE = 16211
    , Zh = 852
    , $h = 592
    , qh = 15
    , Kh = qh
    , DA = (J) => {
        return (J >>> 24 & 255) + (J >>> 8 & 65280) + ((J & 65280) << 8) + ((J & 255) << 24)
    }
    ;
function Vh() {
    this.strm = null,
        this.mode = 0,
        this.last = !1,
        this.wrap = 0,
        this.havedict = !1,
        this.flags = 0,
        this.dmax = 0,
        this.check = 0,
        this.total = 0,
        this.head = null,
        this.wbits = 0,
        this.wsize = 0,
        this.whave = 0,
        this.wnext = 0,
        this.global = null,
        this.hold = 0,
        this.bits = 0,
        this.length = 0,
        this.offset = 0,
        this.extra = 0,
        this.lencode = null,
        this.distcode = null,
        this.lenbits = 0,
        this.distbits = 0,
        this.ncode = 0,
        this.nlen = 0,
        this.ndist = 0,
        this.have = 0,
        this.next = null,
        this.lens = new Uint16Array(320),
        this.work = new Uint16Array(288),
        this.lendyn = null,
        this.distdyn = null,
        this.sane = 0,
        this.back = 0,
        this.was = 0
}
var Q$ = (J) => {
    if (!J)
        return 1;
    let Q = J.state;
    if (!Q || Q.strm !== J || Q.mode < fY || Q.mode > ZE)
        return 1;
    return 0
}
    , $E = (J) => {
        if (Q$(J))
            return D5;
        let Q = J.state;
        if (J.total_in = J.total_out = Q.total = 0,
            J.msg = "",
            Q.wrap)
            J.adler = Q.wrap & 1;
        return Q.mode = fY,
            Q.last = 0,
            Q.havedict = 0,
            Q.flags = -1,
            Q.dmax = 32768,
            Q.head = null,
            Q.hold = 0,
            Q.bits = 0,
            Q.lencode = Q.lendyn = new Int32Array(Zh),
            Q.distcode = Q.distdyn = new Int32Array($h),
            Q.sane = 1,
            Q.back = -1,
            eZ
    }
    , qE = (J) => {
        if (Q$(J))
            return D5;
        let Q = J.state;
        return Q.wsize = 0,
            Q.whave = 0,
            Q.wnext = 0,
            $E(J)
    }
    , KE = (J, Q) => {
        let Z;
        if (Q$(J))
            return D5;
        let $ = J.state;
        if (Q < 0)
            Z = 0,
                Q = -Q;
        else if (Z = (Q >> 4) + 5,
            Q < 48)
            Q &= 15;
        if (Q && (Q < 8 || Q > 15))
            return D5;
        if ($.global !== null && $.wbits !== Q)
            $.global = null;
        return $.wrap = Z,
            $.wbits = Q,
            qE(J)
    }
    , VE = (J, Q) => {
        if (!J)
            return D5;
        let Z = new Vh;
        J.state = Z,
            Z.strm = J,
            Z.global = null,
            Z.mode = fY;
        let $ = KE(J, Q);
        if ($ !== eZ)
            J.state = null;
        return $
    }
    , zh = (J) => {
        return VE(J, Kh)
    }
    , AA = !0, bL, vL, Wh = (J) => {
        if (AA) {
            bL = new Int32Array(512),
                vL = new Int32Array(32);
            let Q = 0;
            while (Q < 144)
                J.lens[Q++] = 8;
            while (Q < 256)
                J.lens[Q++] = 9;
            while (Q < 280)
                J.lens[Q++] = 7;
            while (Q < 288)
                J.lens[Q++] = 8;
            i4(rA, J.lens, 0, 288, bL, 0, J.work, {
                bits: 9
            }),
                Q = 0;
            while (Q < 32)
                J.lens[Q++] = 5;
            i4(tA, J.lens, 0, 32, vL, 0, J.work, {
                bits: 5
            }),
                AA = !1
        }
        J.lencode = bL,
            J.lenbits = 9,
            J.distcode = vL,
            J.distbits = 5
    }
    , zE = (J, Q, Z, $) => {
        let q, K = J.state;
        if (K.global === null)
            K.wsize = 1 << K.wbits,
                K.wnext = 0,
                K.whave = 0,
                K.global = new Uint8Array(K.wsize);
        if ($ >= K.wsize)
            K.global.set(Q.subarray(Z - K.wsize, Z), 0),
                K.wnext = 0,
                K.whave = K.wsize;
        else {
            if (q = K.wsize - K.wnext,
                q > $)
                q = $;
            if (K.global.set(Q.subarray(Z - $, Z - $ + q), K.wnext),
                $ -= q,
                $)
                K.global.set(Q.subarray(Z - $, Z), 0),
                    K.wnext = $,
                    K.whave = K.wsize;
            else {
                if (K.wnext += q,
                    K.wnext === K.wsize)
                    K.wnext = 0;
                if (K.whave < K.wsize)
                    K.whave += q
            }
        }
        return 0
    }
    , Hh = (J, Q) => {
        let Z, $, q, K, V, z, W, H, Y, U, N, j, k, L, F = 0, P, M, v, E, n, u, b, i, g = new Uint8Array(4), l, o, F0 = new Uint8Array([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);
        if (Q$(J) || !J.output || !J.input && J.avail_in !== 0)
            return D5;
        if (Z = J.state,
            Z.mode === $Q)
            Z.mode = ML;
        V = J.next_out,
            q = J.output,
            W = J.avail_out,
            K = J.next_in,
            $ = J.input,
            z = J.avail_in,
            H = Z.hold,
            Y = Z.bits,
            U = z,
            N = W,
            i = eZ;
        J: for (; ;)
            switch (Z.mode) {
                case fY:
                    if (Z.wrap === 0) {
                        Z.mode = ML;
                        break
                    }
                    while (Y < 16) {
                        if (z === 0)
                            break J;
                        z--,
                            H += $[K++] << Y,
                            Y += 8
                    }
                    if (Z.wrap & 2 && H === 35615) {
                        if (Z.wbits === 0)
                            Z.wbits = 15;
                        Z.check = 0,
                            g[0] = H & 255,
                            g[1] = H >>> 8 & 255,
                            Z.check = $J(Z.check, g, 2, 0),
                            H = 0,
                            Y = 0,
                            Z.mode = qA;
                        break
                    }
                    if (Z.head)
                        Z.head.done = !1;
                    if (!(Z.wrap & 1) || (((H & 255) << 8) + (H >> 8)) % 31) {
                        J.msg = "incorrect header check",
                            Z.mode = w7;
                        break
                    }
                    if ((H & 15) !== $A) {
                        J.msg = "unknown compression method",
                            Z.mode = w7;
                        break
                    }
                    if (H >>>= 4,
                        Y -= 4,
                        b = (H & 15) + 8,
                        Z.wbits === 0)
                        Z.wbits = b;
                    if (b > 15 || b > Z.wbits) {
                        J.msg = "invalid global size",
                            Z.mode = w7;
                        break
                    }
                    Z.dmax = 1 << Z.wbits,
                        Z.flags = 0,
                        J.adler = Z.check = 1,
                        Z.mode = H & 512 ? UA : $Q,
                        H = 0,
                        Y = 0;
                    break;
                case qA:
                    while (Y < 16) {
                        if (z === 0)
                            break J;
                        z--,
                            H += $[K++] << Y,
                            Y += 8
                    }
                    if (Z.flags = H,
                        (Z.flags & 255) !== $A) {
                        J.msg = "unknown compression method",
                            Z.mode = w7;
                        break
                    }
                    if (Z.flags & 57344) {
                        J.msg = "unknown header flags set",
                            Z.mode = w7;
                        break
                    }
                    if (Z.head)
                        Z.head.text = H >> 8 & 1;
                    if (Z.flags & 512 && Z.wrap & 4)
                        g[0] = H & 255,
                            g[1] = H >>> 8 & 255,
                            Z.check = $J(Z.check, g, 2, 0);
                    H = 0,
                        Y = 0,
                        Z.mode = KA;
                case KA:
                    while (Y < 32) {
                        if (z === 0)
                            break J;
                        z--,
                            H += $[K++] << Y,
                            Y += 8
                    }
                    if (Z.head)
                        Z.head.time = H;
                    if (Z.flags & 512 && Z.wrap & 4)
                        g[0] = H & 255,
                            g[1] = H >>> 8 & 255,
                            g[2] = H >>> 16 & 255,
                            g[3] = H >>> 24 & 255,
                            Z.check = $J(Z.check, g, 4, 0);
                    H = 0,
                        Y = 0,
                        Z.mode = VA;
                case VA:
                    while (Y < 16) {
                        if (z === 0)
                            break J;
                        z--,
                            H += $[K++] << Y,
                            Y += 8
                    }
                    if (Z.head)
                        Z.head.xflags = H & 255,
                            Z.head.os = H >> 8;
                    if (Z.flags & 512 && Z.wrap & 4)
                        g[0] = H & 255,
                            g[1] = H >>> 8 & 255,
                            Z.check = $J(Z.check, g, 2, 0);
                    H = 0,
                        Y = 0,
                        Z.mode = zA;
                case zA:
                    if (Z.flags & 1024) {
                        while (Y < 16) {
                            if (z === 0)
                                break J;
                            z--,
                                H += $[K++] << Y,
                                Y += 8
                        }
                        if (Z.length = H,
                            Z.head)
                            Z.head.extra_len = H;
                        if (Z.flags & 512 && Z.wrap & 4)
                            g[0] = H & 255,
                                g[1] = H >>> 8 & 255,
                                Z.check = $J(Z.check, g, 2, 0);
                        H = 0,
                            Y = 0
                    } else if (Z.head)
                        Z.head.extra = null;
                    Z.mode = WA;
                case WA:
                    if (Z.flags & 1024) {
                        if (j = Z.length,
                            j > z)
                            j = z;
                        if (j) {
                            if (Z.head) {
                                if (b = Z.head.extra_len - Z.length,
                                    !Z.head.extra)
                                    Z.head.extra = new Uint8Array(Z.head.extra_len);
                                Z.head.extra.set($.subarray(K, K + j), b)
                            }
                            if (Z.flags & 512 && Z.wrap & 4)
                                Z.check = $J(Z.check, $, j, K);
                            z -= j,
                                K += j,
                                Z.length -= j
                        }
                        if (Z.length)
                            break J
                    }
                    Z.length = 0,
                        Z.mode = HA;
                case HA:
                    if (Z.flags & 2048) {
                        if (z === 0)
                            break J;
                        j = 0;
                        do
                            if (b = $[K + j++],
                                Z.head && b && Z.length < 65536)
                                Z.head.name += String.fromCharCode(b);
                        while (b && j < z);
                        if (Z.flags & 512 && Z.wrap & 4)
                            Z.check = $J(Z.check, $, j, K);
                        if (z -= j,
                            K += j,
                            b)
                            break J
                    } else if (Z.head)
                        Z.head.name = null;
                    Z.length = 0,
                        Z.mode = YA;
                case YA:
                    if (Z.flags & 4096) {
                        if (z === 0)
                            break J;
                        j = 0;
                        do
                            if (b = $[K + j++],
                                Z.head && b && Z.length < 65536)
                                Z.head.comment += String.fromCharCode(b);
                        while (b && j < z);
                        if (Z.flags & 512 && Z.wrap & 4)
                            Z.check = $J(Z.check, $, j, K);
                        if (z -= j,
                            K += j,
                            b)
                            break J
                    } else if (Z.head)
                        Z.head.comment = null;
                    Z.mode = XA;
                case XA:
                    if (Z.flags & 512) {
                        while (Y < 16) {
                            if (z === 0)
                                break J;
                            z--,
                                H += $[K++] << Y,
                                Y += 8
                        }
                        if (Z.wrap & 4 && H !== (Z.check & 65535)) {
                            J.msg = "header crc mismatch",
                                Z.mode = w7;
                            break
                        }
                        H = 0,
                            Y = 0
                    }
                    if (Z.head)
                        Z.head.hcrc = Z.flags >> 9 & 1,
                            Z.head.done = !0;
                    J.adler = Z.check = 0,
                        Z.mode = $Q;
                    break;
                case UA:
                    while (Y < 32) {
                        if (z === 0)
                            break J;
                        z--,
                            H += $[K++] << Y,
                            Y += 8
                    }
                    J.adler = Z.check = DA(H),
                        H = 0,
                        Y = 0,
                        Z.mode = SY;
                case SY:
                    if (Z.havedict === 0)
                        return J.next_out = V,
                            J.avail_out = W,
                            J.next_in = K,
                            J.avail_in = z,
                            Z.hold = H,
                            Z.bits = Y,
                            Jh;
                    J.adler = Z.check = 1,
                        Z.mode = $Q;
                case $Q:
                    if (Q === tf || Q === EY)
                        break J;
                case ML:
                    if (Z.last) {
                        H >>>= Y & 7,
                            Y -= Y & 7,
                            Z.mode = RL;
                        break
                    }
                    while (Y < 3) {
                        if (z === 0)
                            break J;
                        z--,
                            H += $[K++] << Y,
                            Y += 8
                    }
                    switch (Z.last = H & 1,
                    H >>>= 1,
                    Y -= 1,
                    H & 3) {
                        case 0:
                            Z.mode = NA;
                            break;
                        case 1:
                            if (Wh(Z),
                                Z.mode = MY,
                                Q === EY) {
                                H >>>= 2,
                                    Y -= 2;
                                break J
                            }
                            break;
                        case 2:
                            Z.mode = jA;
                            break;
                        case 3:
                            J.msg = "invalid block type",
                                Z.mode = w7
                    }
                    H >>>= 2,
                        Y -= 2;
                    break;
                case NA:
                    H >>>= Y & 7,
                        Y -= Y & 7;
                    while (Y < 32) {
                        if (z === 0)
                            break J;
                        z--,
                            H += $[K++] << Y,
                            Y += 8
                    }
                    if ((H & 65535) !== (H >>> 16 ^ 65535)) {
                        J.msg = "invalid stored block lengths",
                            Z.mode = w7;
                        break
                    }
                    if (Z.length = H & 65535,
                        H = 0,
                        Y = 0,
                        Z.mode = _L,
                        Q === EY)
                        break J;
                case _L:
                    Z.mode = wA;
                case wA:
                    if (j = Z.length,
                        j) {
                        if (j > z)
                            j = z;
                        if (j > W)
                            j = W;
                        if (j === 0)
                            break J;
                        q.set($.subarray(K, K + j), V),
                            z -= j,
                            K += j,
                            W -= j,
                            V += j,
                            Z.length -= j;
                        break
                    }
                    Z.mode = $Q;
                    break;
                case jA:
                    while (Y < 14) {
                        if (z === 0)
                            break J;
                        z--,
                            H += $[K++] << Y,
                            Y += 8
                    }
                    if (Z.nlen = (H & 31) + 257,
                        H >>>= 5,
                        Y -= 5,
                        Z.ndist = (H & 31) + 1,
                        H >>>= 5,
                        Y -= 5,
                        Z.ncode = (H & 15) + 4,
                        H >>>= 4,
                        Y -= 4,
                        Z.nlen > 286 || Z.ndist > 30) {
                        J.msg = "too many length or distance symbols",
                            Z.mode = w7;
                        break
                    }
                    Z.have = 0,
                        Z.mode = BA;
                case BA:
                    while (Z.have < Z.ncode) {
                        while (Y < 3) {
                            if (z === 0)
                                break J;
                            z--,
                                H += $[K++] << Y,
                                Y += 8
                        }
                        Z.lens[F0[Z.have++]] = H & 7,
                            H >>>= 3,
                            Y -= 3
                    }
                    while (Z.have < 19)
                        Z.lens[F0[Z.have++]] = 0;
                    if (Z.lencode = Z.lendyn,
                        Z.lenbits = 7,
                        l = {
                            bits: Z.lenbits
                        },
                        i = i4(rf, Z.lens, 0, 19, Z.lencode, 0, Z.work, l),
                        Z.lenbits = l.bits,
                        i) {
                        J.msg = "invalid code lengths set",
                            Z.mode = w7;
                        break
                    }
                    Z.have = 0,
                        Z.mode = kA;
                case kA:
                    while (Z.have < Z.nlen + Z.ndist) {
                        for (; ;) {
                            if (F = Z.lencode[H & (1 << Z.lenbits) - 1],
                                P = F >>> 24,
                                M = F >>> 16 & 255,
                                v = F & 65535,
                                P <= Y)
                                break;
                            if (z === 0)
                                break J;
                            z--,
                                H += $[K++] << Y,
                                Y += 8
                        }
                        if (v < 16)
                            H >>>= P,
                                Y -= P,
                                Z.lens[Z.have++] = v;
                        else {
                            if (v === 16) {
                                o = P + 2;
                                while (Y < o) {
                                    if (z === 0)
                                        break J;
                                    z--,
                                        H += $[K++] << Y,
                                        Y += 8
                                }
                                if (H >>>= P,
                                    Y -= P,
                                    Z.have === 0) {
                                    J.msg = "invalid bit length repeat",
                                        Z.mode = w7;
                                    break
                                }
                                b = Z.lens[Z.have - 1],
                                    j = 3 + (H & 3),
                                    H >>>= 2,
                                    Y -= 2
                            } else if (v === 17) {
                                o = P + 3;
                                while (Y < o) {
                                    if (z === 0)
                                        break J;
                                    z--,
                                        H += $[K++] << Y,
                                        Y += 8
                                }
                                H >>>= P,
                                    Y -= P,
                                    b = 0,
                                    j = 3 + (H & 7),
                                    H >>>= 3,
                                    Y -= 3
                            } else {
                                o = P + 7;
                                while (Y < o) {
                                    if (z === 0)
                                        break J;
                                    z--,
                                        H += $[K++] << Y,
                                        Y += 8
                                }
                                H >>>= P,
                                    Y -= P,
                                    b = 0,
                                    j = 11 + (H & 127),
                                    H >>>= 7,
                                    Y -= 7
                            }
                            if (Z.have + j > Z.nlen + Z.ndist) {
                                J.msg = "invalid bit length repeat",
                                    Z.mode = w7;
                                break
                            }
                            while (j--)
                                Z.lens[Z.have++] = b
                        }
                    }
                    if (Z.mode === w7)
                        break;
                    if (Z.lens[256] === 0) {
                        J.msg = "invalid code -- missing end-of-block",
                            Z.mode = w7;
                        break
                    }
                    if (Z.lenbits = 9,
                        l = {
                            bits: Z.lenbits
                        },
                        i = i4(rA, Z.lens, 0, Z.nlen, Z.lencode, 0, Z.work, l),
                        Z.lenbits = l.bits,
                        i) {
                        J.msg = "invalid literal/lengths set",
                            Z.mode = w7;
                        break
                    }
                    if (Z.distbits = 6,
                        Z.distcode = Z.distdyn,
                        l = {
                            bits: Z.distbits
                        },
                        i = i4(tA, Z.lens, Z.nlen, Z.ndist, Z.distcode, 0, Z.work, l),
                        Z.distbits = l.bits,
                        i) {
                        J.msg = "invalid distances set",
                            Z.mode = w7;
                        break
                    }
                    if (Z.mode = MY,
                        Q === EY)
                        break J;
                case MY:
                    Z.mode = _Y;
                case _Y:
                    if (z >= 6 && W >= 258) {
                        if (J.next_out = V,
                            J.avail_out = W,
                            J.next_in = K,
                            J.avail_in = z,
                            Z.hold = H,
                            Z.bits = Y,
                            uf(J, N),
                            V = J.next_out,
                            q = J.output,
                            W = J.avail_out,
                            K = J.next_in,
                            $ = J.input,
                            z = J.avail_in,
                            H = Z.hold,
                            Y = Z.bits,
                            Z.mode === $Q)
                            Z.back = -1;
                        break
                    }
                    Z.back = 0;
                    for (; ;) {
                        if (F = Z.lencode[H & (1 << Z.lenbits) - 1],
                            P = F >>> 24,
                            M = F >>> 16 & 255,
                            v = F & 65535,
                            P <= Y)
                            break;
                        if (z === 0)
                            break J;
                        z--,
                            H += $[K++] << Y,
                            Y += 8
                    }
                    if (M && (M & 240) === 0) {
                        E = P,
                            n = M,
                            u = v;
                        for (; ;) {
                            if (F = Z.lencode[u + ((H & (1 << E + n) - 1) >> E)],
                                P = F >>> 24,
                                M = F >>> 16 & 255,
                                v = F & 65535,
                                E + P <= Y)
                                break;
                            if (z === 0)
                                break J;
                            z--,
                                H += $[K++] << Y,
                                Y += 8
                        }
                        H >>>= E,
                            Y -= E,
                            Z.back += E
                    }
                    if (H >>>= P,
                        Y -= P,
                        Z.back += P,
                        Z.length = v,
                        M === 0) {
                        Z.mode = FA;
                        break
                    }
                    if (M & 32) {
                        Z.back = -1,
                            Z.mode = $Q;
                        break
                    }
                    if (M & 64) {
                        J.msg = "invalid literal/length code",
                            Z.mode = w7;
                        break
                    }
                    Z.extra = M & 15,
                        Z.mode = CA;
                case CA:
                    if (Z.extra) {
                        o = Z.extra;
                        while (Y < o) {
                            if (z === 0)
                                break J;
                            z--,
                                H += $[K++] << Y,
                                Y += 8
                        }
                        Z.length += H & (1 << Z.extra) - 1,
                            H >>>= Z.extra,
                            Y -= Z.extra,
                            Z.back += Z.extra
                    }
                    Z.was = Z.length,
                        Z.mode = OA;
                case OA:
                    for (; ;) {
                        if (F = Z.distcode[H & (1 << Z.distbits) - 1],
                            P = F >>> 24,
                            M = F >>> 16 & 255,
                            v = F & 65535,
                            P <= Y)
                            break;
                        if (z === 0)
                            break J;
                        z--,
                            H += $[K++] << Y,
                            Y += 8
                    }
                    if ((M & 240) === 0) {
                        E = P,
                            n = M,
                            u = v;
                        for (; ;) {
                            if (F = Z.distcode[u + ((H & (1 << E + n) - 1) >> E)],
                                P = F >>> 24,
                                M = F >>> 16 & 255,
                                v = F & 65535,
                                E + P <= Y)
                                break;
                            if (z === 0)
                                break J;
                            z--,
                                H += $[K++] << Y,
                                Y += 8
                        }
                        H >>>= E,
                            Y -= E,
                            Z.back += E
                    }
                    if (H >>>= P,
                        Y -= P,
                        Z.back += P,
                        M & 64) {
                        J.msg = "invalid distance code",
                            Z.mode = w7;
                        break
                    }
                    Z.offset = v,
                        Z.extra = M & 15,
                        Z.mode = IA;
                case IA:
                    if (Z.extra) {
                        o = Z.extra;
                        while (Y < o) {
                            if (z === 0)
                                break J;
                            z--,
                                H += $[K++] << Y,
                                Y += 8
                        }
                        Z.offset += H & (1 << Z.extra) - 1,
                            H >>>= Z.extra,
                            Y -= Z.extra,
                            Z.back += Z.extra
                    }
                    if (Z.offset > Z.dmax) {
                        J.msg = "invalid distance too far back",
                            Z.mode = w7;
                        break
                    }
                    Z.mode = LA;
                case LA:
                    if (W === 0)
                        break J;
                    if (j = N - W,
                        Z.offset > j) {
                        if (j = Z.offset - j,
                            j > Z.whave) {
                            if (Z.sane) {
                                J.msg = "invalid distance too far back",
                                    Z.mode = w7;
                                break
                            }
                        }
                        if (j > Z.wnext)
                            j -= Z.wnext,
                                k = Z.wsize - j;
                        else
                            k = Z.wnext - j;
                        if (j > Z.length)
                            j = Z.length;
                        L = Z.global
                    } else
                        L = q,
                            k = V - Z.offset,
                            j = Z.length;
                    if (j > W)
                        j = W;
                    W -= j,
                        Z.length -= j;
                    do
                        q[V++] = L[k++];
                    while (--j);
                    if (Z.length === 0)
                        Z.mode = _Y;
                    break;
                case FA:
                    if (W === 0)
                        break J;
                    q[V++] = Z.length,
                        W--,
                        Z.mode = _Y;
                    break;
                case RL:
                    if (Z.wrap) {
                        while (Y < 32) {
                            if (z === 0)
                                break J;
                            z--,
                                H |= $[K++] << Y,
                                Y += 8
                        }
                        if (N -= W,
                            J.total_out += N,
                            Z.total += N,
                            Z.wrap & 4 && N)
                            J.adler = Z.check = Z.flags ? $J(Z.check, q, N, V - N) : JV(Z.check, q, N, V - N);
                        if (N = W,
                            Z.wrap & 4 && (Z.flags ? H : DA(H)) !== Z.check) {
                            J.msg = "incorrect data check",
                                Z.mode = w7;
                            break
                        }
                        H = 0,
                            Y = 0
                    }
                    Z.mode = GA;
                case GA:
                    if (Z.wrap && Z.flags) {
                        while (Y < 32) {
                            if (z === 0)
                                break J;
                            z--,
                                H += $[K++] << Y,
                                Y += 8
                        }
                        if (Z.wrap & 4 && H !== (Z.total & 4294967295)) {
                            J.msg = "incorrect length check",
                                Z.mode = w7;
                            break
                        }
                        H = 0,
                            Y = 0
                    }
                    Z.mode = PA;
                case PA:
                    i = ef;
                    break J;
                case w7:
                    i = eA;
                    break J;
                case QE:
                    return JE;
                case ZE:
                default:
                    return D5
            }
        if (J.next_out = V,
            J.avail_out = W,
            J.next_in = K,
            J.avail_in = z,
            Z.hold = H,
            Z.bits = Y,
            Z.wsize || N !== J.avail_out && Z.mode < w7 && (Z.mode < RL || Q !== ZA)) {
            if (zE(J, J.output, J.next_out, N - J.avail_out))
                ;
        }
        if (U -= J.avail_in,
            N -= J.avail_out,
            J.total_in += U,
            J.total_out += N,
            Z.total += N,
            Z.wrap & 4 && N)
            J.adler = Z.check = Z.flags ? $J(Z.check, q, N, J.next_out - N) : JV(Z.check, q, N, J.next_out - N);
        if (J.data_type = Z.bits + (Z.last ? 64 : 0) + (Z.mode === $Q ? 128 : 0) + (Z.mode === MY || Z.mode === _L ? 256 : 0),
            (U === 0 && N === 0 || Q === ZA) && i === eZ)
            i = Qh;
        return i
    }
    , Yh = (J) => {
        if (Q$(J))
            return D5;
        let Q = J.state;
        if (Q.global)
            Q.global = null;
        return J.state = null,
            eZ
    }
    , Xh = (J, Q) => {
        if (Q$(J))
            return D5;
        let Z = J.state;
        if ((Z.wrap & 2) === 0)
            return D5;
        return Z.head = Q,
            Q.done = !1,
            eZ
    }
    , Uh = (J, Q) => {
        let Z = Q.length, $, q, K;
        if (Q$(J))
            return D5;
        if ($ = J.state,
            $.wrap !== 0 && $.mode !== SY)
            return D5;
        if ($.mode === SY) {
            if (q = 1,
                q = JV(q, Q, Z, 0),
                q !== $.check)
                return eA
        }
        if (K = zE(J, Q, Z, Z),
            K)
            return $.mode = QE,
                JE;
        return $.havedict = 1,
            eZ
    }
    , Nh = qE, wh = KE, jh = $E, Bh = zh, kh = VE, Ch = Hh, Oh = Yh, Ih = Xh, Lh = Uh, Fh = "pako inflate (from Nodeca project)", KQ = {
        inflateReset: Nh,
        inflateReset2: wh,
        inflateResetKeep: jh,
        inflateInit: Bh,
        inflateInit2: kh,
        inflate: Ch,
        inflateEnd: Oh,
        inflateGetHeader: Ih,
        inflateSetDictionary: Lh,
        inflateInfo: Fh
    };
function Gh() {
    this.text = 0,
        this.time = 0,
        this.xflags = 0,
        this.os = 0,
        this.extra = null,
        this.extra_len = 0,
        this.name = "",
        this.comment = "",
        this.hcrc = 0,
        this.done = !1
}
var Ph = Gh
    , WE = Object.prototype.toString
    , { Z_NO_FLUSH: Dh, Z_FINISH: Ah, Z_OK: $V, Z_STREAM_END: SL, Z_NEED_DICT: TL, Z_STREAM_ERROR: Eh, Z_DATA_ERROR: EA, Z_MEM_ERROR: Mh } = J$;
function zV(J) {
    this.options = yY.assign({
        chunkSize: 65536,
        globalBits: 15,
        to: ""
    }, J || {});
    let Q = this.options;
    if (Q.raw && Q.globalBits >= 0 && Q.globalBits < 16) {
        if (Q.globalBits = -Q.globalBits,
            Q.globalBits === 0)
            Q.globalBits = -15
    }
    if (Q.globalBits >= 0 && Q.globalBits < 16 && !(J && J.globalBits))
        Q.globalBits += 32;
    if (Q.globalBits > 15 && Q.globalBits < 48) {
        if ((Q.globalBits & 15) === 0)
            Q.globalBits |= 15
    }
    this.err = 0,
        this.msg = "",
        this.ended = !1,
        this.chunks = [],
        this.strm = new iA,
        this.strm.avail_out = 0;
    let Z = KQ.inflateInit2(this.strm, Q.globalBits);
    if (Z !== $V)
        throw new Error(rZ[Z]);
    if (this.header = new Ph,
        KQ.inflateGetHeader(this.strm, this.header),
        Q.dictionary) {
        if (typeof Q.dictionary === "string")
            Q.dictionary = ZV.string2buf(Q.dictionary);
        else if (WE.call(Q.dictionary) === "[object ArrayBuffer]")
            Q.dictionary = new Uint8Array(Q.dictionary);
        if (Q.raw) {
            if (Z = KQ.inflateSetDictionary(this.strm, Q.dictionary),
                Z !== $V)
                throw new Error(rZ[Z])
        }
    }
}
zV.prototype.push = function (J, Q) {
    let Z = this.strm, $ = this.options.chunkSize, q = this.options.dictionary, K, V, z;
    if (this.ended)
        return !1;
    if (Q === ~~Q)
        V = Q;
    else
        V = Q === !0 ? Ah : Dh;
    if (WE.call(J) === "[object ArrayBuffer]")
        Z.input = new Uint8Array(J);
    else
        Z.input = J;
    Z.next_in = 0,
        Z.avail_in = Z.input.length;
    for (; ;) {
        if (Z.avail_out === 0)
            Z.output = new Uint8Array($),
                Z.next_out = 0,
                Z.avail_out = $;
        if (K = KQ.inflate(Z, V),
            K === TL && q) {
            if (K = KQ.inflateSetDictionary(Z, q),
                K === $V)
                K = KQ.inflate(Z, V);
            else if (K === EA)
                K = TL
        }
        while (Z.avail_in > 0 && K === SL && Z.state.wrap > 0 && J[Z.next_in] !== 0)
            KQ.inflateReset(Z),
                K = KQ.inflate(Z, V);
        switch (K) {
            case Eh:
            case EA:
            case TL:
            case Mh:
                return this.onEnd(K),
                    this.ended = !0,
                    !1
        }
        if (z = Z.avail_out,
            Z.next_out) {
            if (Z.avail_out === 0 || K === SL)
                if (this.options.to === "string") {
                    let W = ZV.utf8border(Z.output, Z.next_out)
                        , H = Z.next_out - W
                        , Y = ZV.buf2string(Z.output, W);
                    if (Z.next_out = H,
                        Z.avail_out = $ - H,
                        H)
                        Z.output.set(Z.output.subarray(W, W + H), 0);
                    this.onData(Y)
                } else
                    this.onData(Z.output.length === Z.next_out ? Z.output : Z.output.subarray(0, Z.next_out))
        }
        if (K === $V && z === 0)
            continue;
        if (K === SL)
            return K = KQ.inflateEnd(this.strm),
                this.onEnd(K),
                this.ended = !0,
                !0;
        if (Z.avail_in === 0)
            break
    }
    return !0
}
    ;
zV.prototype.onData = function (J) {
    this.chunks.push(J)
}
    ;
zV.prototype.onEnd = function (J) {
    if (J === $V)
        if (this.options.to === "string")
            this.result = this.chunks.join("");
        else
            this.result = yY.flattenChunks(this.chunks);
    this.chunks = [],
        this.err = J,
        this.msg = this.strm.msg
}
    ;
function aL(J, Q) {
    let Z = new zV(Q);
    if (Z.push(J),
        Z.err)
        throw Z.msg || rZ[Z.err];
    return Z.result
}
function _h(J, Q) {
    return Q = Q || {},
        Q.raw = !0,
        aL(J, Q)
}
var Rh = zV
    , bh = aL
    , vh = _h
    , Sh = aL
    , Th = J$
    , yh = {
        Inflate: Rh,
        inflate: bh,
        inflateRaw: vh,
        ungzip: Sh,
        constants: Th
    }
    , { Deflate: fh, deflate: hh, deflateRaw: xh, gzip: gh } = df
    , { Inflate: mh, inflate: ch, inflateRaw: dh, ungzip: ph } = yh
    , uh = fh
    , lh = hh
    , oh = xh
    , nh = gh
    , sh = mh
    , ih = ch
    , ah = dh
    , rh = ph
    , th = J$
    , HE = {
        Deflate: uh,
        deflate: lh,
        deflateRaw: oh,
        gzip: nh,
        Inflate: sh,
        inflate: ih,
        inflateRaw: ah,
        ungzip: rh,
        constants: th
    };
var kE = oZ(wE(), 1)
    , CE = oZ(BE(), 1)
    , tL = !1;
function OE() {
    let J = kE.default(global, {
        noVariableValueChangeEvent: !0,
        proxy: {
            WebSocketChangeOriginAllowed: !1,
            HttpUrl: "https://luxball.online/rs/",
            WebSocketUrl: "wss://peer.luxball.online"
        }
    });
    if (J.Language.current = new CE.default(J),
        !tL)
        tL = J.Errors;
    return J.Callback.add("KeyDown"),
        J.Callback.add("KeyUp"),
        J.Callback.add("MouseDown"),
        J.Callback.add("MouseUp"),
        J
}
function IE() {
    return tL
}
var eh = 0;
function A(J, Q, Z, $, q, K) {
    Q || (Q = {});
    var V, z, W = Q;
    if ("ref" in W)
        for (z in W = {},
            Q)
            z == "ref" ? V = Q[z] : W[z] = Q[z];
    var H = {
        type: J,
        props: W,
        key: Z,
        ref: V,
        __k: null,
        __: null,
        __b: 0,
        __e: null,
        __c: null,
        constructor: void 0,
        __v: --eh,
        __i: -1,
        __u: 0,
        __source: q,
        __self: K
    };
    if (typeof J == "function" && (V = J.defaultProps))
        for (z in V)
            W[z] === void 0 && (W[z] = V[z]);
    return l6.vnode && l6.vnode(H),
        H
}
var LE = n5({
    room: null,
    setRoom: () => { }
})
    , VQ = []
    , WV = null
    , eL = !1
    , qJ = () => {
        return O9(LE)
    }
    , T1 = (J) => {
        if (WV && eL)
            WV(J);
        else
            VQ.push(J)
    }
    ;
function FE({ children: J }) {
    let [Q, Z] = C8(null)
        , $ = n0(!1);
    i0(() => {
        if (!$.current && VQ.length > 0) {
            let K = VQ[VQ.length - 1];
            Z(K),
                VQ = [],
                $.current = !0
        }
    }
        , []),
        i0(() => { }
            , [Q]),
        i0(() => {
            if (WV = Z,
                eL = !0,
                VQ.length > 0) {
                let K = VQ[VQ.length - 1];
                Z(K),
                    VQ = []
            }
            return () => {
                if (WV === Z)
                    WV = null,
                        eL = !1
            }
        }
            , []);
    let q = {
        room: Q,
        setRoom: Z
    };
    return A(LE.Provider, {
        value: q,
        children: J
    })
}
w0();
var HG = {
    extension: {
        type: R.Environment,
        name: "browser",
        priority: -1
    },
    test: () => !0,
    load: async () => {
        await Promise.resolve().then(() => (F_(),
            Vm))
    }
};
w0();
var YG = {
    extension: {
        type: R.Environment,
        name: "webworker",
        priority: 0
    },
    test: () => typeof self !== "undefined" && self.WorkerGlobalScope !== void 0,
    load: async () => {
        await Promise.resolve().then(() => (G_(),
            zm))
    }
};
w0();
w0();
J2();
sX();
bX();
SX();
w0();
lJ();
Z5();
_7();
W6();
z9();
var Mw = `
in vec2 vTextureCoord;
in vec4 vColor;

out vec4 finalColor;

uniform float uBlend;

uniform sampler2D uTexture;
uniform sampler2D uBackTexture;

{FUNCTIONS}

void main()
{ 
    vec4 back = texture(uBackTexture, vTextureCoord);
    vec4 front = texture(uTexture, vTextureCoord);
    float blendedAlpha = front.a + back.a * (1.0 - front.a);
    
    {MAIN}
}
`;
var _w = `in vec2 aPosition;
out vec2 vTextureCoord;
out vec2 backgroundUv;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;
var Rw = `
struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct BlendUniforms {
  uBlend:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;
@group(0) @binding(3) var uBackTexture: texture_2d<f32>;

@group(1) @binding(0) var<uniform> blendUniforms : BlendUniforms;


struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}

{FUNCTIONS}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>
) -> @location(0) vec4<f32> {


   var back =  textureSample(uBackTexture, uSampler, uv);
   var front = textureSample(uTexture, uSampler, uv);
   var blendedAlpha = front.a + back.a * (1.0 - front.a);
   
   var out = vec4<f32>(0.0,0.0,0.0,0.0);

   {MAIN}

   return out;
}`;
class u8 extends _J {
    constructor(J) {
        let Q = J.gpu
            , Z = D_({
                source: Rw,
                ...Q
            })
            , $ = B7.from({
                vertex: {
                    source: Z,
                    entryPoint: "mainVertex"
                },
                fragment: {
                    source: Z,
                    entryPoint: "mainFragment"
                }
            })
            , q = J.gl
            , K = D_({
                source: Mw,
                ...q
            })
            , V = j7.from({
                vertex: _w,
                fragment: K
            })
            , z = new Y6({
                uBlend: {
                    value: 1,
                    type: "f32"
                }
            });
        super({
            gpuProgram: $,
            glProgram: V,
            blendRequired: !0,
            resources: {
                blendUniforms: z,
                uBackTexture: _0.EMPTY
            }
        })
    }
}
function D_(J) {
    let { source: Q, functions: Z, main: $ } = J;
    return Q.replace("{FUNCTIONS}", Z).replace("{MAIN}", $)
}
var AZ = `
	float getLuminosity(vec3 c) {
		return 0.3 * c.r + 0.59 * c.g + 0.11 * c.b;
	}

	vec3 setLuminosity(vec3 c, float lum) {
		float modLum = lum - getLuminosity(c);
		vec3 color = c.rgb + vec3(modLum);

		// clip back into legal range
		modLum = getLuminosity(color);
		vec3 modLumVec = vec3(modLum);

		float cMin = min(color.r, min(color.g, color.b));
		float cMax = max(color.r, max(color.g, color.b));

		if(cMin < 0.0) {
			color = mix(modLumVec, color, modLum / (modLum - cMin));
		}

		if(cMax > 1.0) {
			color = mix(modLumVec, color, (1.0 - modLum) / (cMax - modLum));
		}

		return color;
	}

	float getSaturation(vec3 c) {
		return max(c.r, max(c.g, c.b)) - min(c.r, min(c.g, c.b));
	}

	vec3 setSaturationMinMidMax(vec3 cSorted, float s) {
		vec3 colorSorted = cSorted;

		if(colorSorted.z > colorSorted.x) {
			colorSorted.y = (((colorSorted.y - colorSorted.x) * s) / (colorSorted.z - colorSorted.x));
			colorSorted.z = s;
		}
		else {
			colorSorted.y = 0.0;
			colorSorted.z = 0.0;
		}

		colorSorted.x = 0.0;

		return colorSorted;
	}

	vec3 setSaturation(vec3 c, float s) {
		vec3 color = c;

		if(color.r <= color.g && color.r <= color.b) {
			if(color.g <= color.b) {
				color = setSaturationMinMidMax(color.rgb, s).rgb;
			}
			else {
				color = setSaturationMinMidMax(color.rbg, s).rbg;
			}
		}
		else if(color.g <= color.r && color.g <= color.b) {
			if(color.r <= color.b) {
				color = setSaturationMinMidMax(color.grb, s).grb;
			}
			else {
				color = setSaturationMinMidMax(color.gbr, s).gbr;
			}
		}
		else {
			// Using bgr for both fixes part of hue
			if(color.r <= color.g) {
				color = setSaturationMinMidMax(color.brg, s).brg;
			}
			else {
				color = setSaturationMinMidMax(color.bgr, s).bgr;
			}
		}

		return color;
	}
    `;
var EZ = `
	fn getLuminosity(c: vec3<f32>) -> f32
	{
		return 0.3*c.r + 0.59*c.g + 0.11*c.b;
	}

	fn setLuminosity(c: vec3<f32>, lum: f32) -> vec3<f32>
	{
		var modLum: f32 = lum - getLuminosity(c);
		var color: vec3<f32> = c.rgb + modLum;

		// clip back into legal range
		modLum = getLuminosity(color);
		let modLumVec = vec3<f32>(modLum);

		let cMin: f32 = min(color.r, min(color.g, color.b));
		let cMax: f32 = max(color.r, max(color.g, color.b));

		if(cMin < 0.0)
		{
			color = mix(modLumVec, color, modLum / (modLum - cMin));
		}

		if(cMax > 1.0)
		{
			color = mix(modLumVec, color, (1 - modLum) / (cMax - modLum));
		}

		return color;
	}

	fn getSaturation(c: vec3<f32>) -> f32
	{
		return max(c.r, max(c.g, c.b)) - min(c.r, min(c.g, c.b));
	}

	fn setSaturationMinMidMax(cSorted: vec3<f32>, s: f32) -> vec3<f32>
	{
		var colorSorted = cSorted;

		if(colorSorted.z > colorSorted.x)
		{
			colorSorted.y = (((colorSorted.y - colorSorted.x) * s) / (colorSorted.z - colorSorted.x));
			colorSorted.z = s;
		}
		else
		{
			colorSorted.y = 0;
			colorSorted.z = 0;
		}

		colorSorted.x = 0;

		return colorSorted;
	}

	fn setSaturation(c: vec3<f32>, s: f32) -> vec3<f32>
	{
		var color = c;

		if (color.r <= color.g && color.r <= color.b)
		{
			if (color.g <= color.b)
			{
				color = vec3<f32>(setSaturationMinMidMax(color.rgb, s)).rgb;
			}
			else
			{
				color = vec3<f32>(setSaturationMinMidMax(color.rbg, s)).rbg;
			}
		}
		else if (color.g <= color.r && color.g <= color.b)
		{
			if (color.r <= color.b)
			{
				color = vec3<f32>(setSaturationMinMidMax(color.grb, s)).grb;
			}
			else
			{
				color = vec3<f32>(setSaturationMinMidMax(color.gbr, s)).gbr;
			}
		}
		else
		{
			// Using bgr for both fixes part of hue
			if (color.r <= color.g)
			{
				color = vec3<f32>(setSaturationMinMidMax(color.brg, s)).brg;
			}
			else
			{
				color  = vec3<f32>(setSaturationMinMidMax(color.bgr, s)).bgr;
			}
		}

		return color;
	}
	`;
class bw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                ${AZ}

                vec3 blendColor(vec3 base, vec3 blend,  float opacity)
                {
                    return (setLuminosity(blend, getLuminosity(base)) * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                finalColor = vec4(blendColor(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `
            },
            gpu: {
                functions: `
                ${EZ}

                fn blendColorOpacity(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    return (setLuminosity(blend, getLuminosity(base)) * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                out = vec4<f32>(blendColorOpacity(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `
            }
        })
    }
}
bw.extension = {
    name: "color",
    type: R.BlendMode
};
w0();
class vw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                float colorBurn(float base, float blend)
                {
                    return max((1.0 - ((1.0 - base) / blend)), 0.0);
                }

                vec3 blendColorBurn(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        colorBurn(base.r, blend.r),
                        colorBurn(base.g, blend.g),
                        colorBurn(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,
                main: `
                finalColor = vec4(blendColorBurn(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
            `
            },
            gpu: {
                functions: `
                fn colorBurn(base:f32, blend:f32) -> f32
                {
                    return max((1.0-((1.0-base)/blend)),0.0);
                }

                fn blendColorBurn(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        colorBurn(base.r, blend.r),
                        colorBurn(base.g, blend.g),
                        colorBurn(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,
                main: `
                out = vec4<f32>(blendColorBurn(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `
            }
        })
    }
}
vw.extension = {
    name: "color-burn",
    type: R.BlendMode
};
w0();
class Sw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                float colorDodge(float base, float blend)
                {
                    return base / (1.0 - blend);
                }

                vec3 blendColorDodge(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        colorDodge(base.r, blend.r),
                        colorDodge(base.g, blend.g),
                        colorDodge(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                finalColor = vec4(blendColorDodge(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `
            },
            gpu: {
                functions: `
                fn colorDodge(base: f32, blend: f32) -> f32
                {
                    return base / (1.0 - blend);
                }

                fn blendColorDodge(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        colorDodge(base.r, blend.r),
                        colorDodge(base.g, blend.g),
                        colorDodge(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                    out = vec4<f32>(blendColorDodge(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `
            }
        })
    }
}
Sw.extension = {
    name: "color-dodge",
    type: R.BlendMode
};
w0();
class Tw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                vec3 blendDarken(vec3 base, vec3 blend, float opacity)
                {
                    return (min(base, blend) * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                finalColor = vec4(blendDarken(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `
            },
            gpu: {
                functions: `
                fn blendDarken(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    return (min(blend,base) * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                out = vec4<f32>(blendDarken(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `
            }
        })
    }
}
Tw.extension = {
    name: "darken",
    type: R.BlendMode
};
w0();
class yw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                vec3 blendDifference(vec3 base, vec3 blend,  float opacity)
                {
                    return (abs(blend - base) * opacity + base * (1.0 - opacity));
                }
            `,
                main: `
                finalColor = vec4(blendDifference(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
            `
            },
            gpu: {
                functions: `
                fn blendDifference(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    return (abs(blend - base) * opacity + base * (1.0 - opacity));
                }
            `,
                main: `
                out = vec4<f32>(blendDifference(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `
            }
        })
    }
}
yw.extension = {
    name: "difference",
    type: R.BlendMode
};
w0();
class fw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                float divide(float base, float blend)
                {
                    return (blend > 0.0) ? clamp(base / blend, 0.0, 1.0) : 1.0;
                }

                vec3 blendDivide(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        divide(base.r, blend.r),
                        divide(base.g, blend.g),
                        divide(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                finalColor = vec4(blendDivide(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `
            },
            gpu: {
                functions: `
                fn divide(base: f32, blend: f32) -> f32
                {
                    return select(1.0, clamp(base / blend, 0.0, 1.0), blend > 0.0);
                }

                fn blendDivide(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        divide(base.r, blend.r),
                        divide(base.g, blend.g),
                        divide(base.b, blend.b)
                    );
                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,
                main: `
                out = vec4<f32>(blendDivide(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `
            }
        })
    }
}
fw.extension = {
    name: "divide",
    type: R.BlendMode
};
w0();
class hw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                vec3 exclusion(vec3 base, vec3 blend)
                {
                    return base + blend - 2.0 * base * blend;
                }

                vec3 blendExclusion(vec3 base, vec3 blend, float opacity)
                {
                    return (exclusion(base, blend) * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                finalColor = vec4(blendExclusion(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `
            },
            gpu: {
                functions: `
                fn exclusion(base: vec3<f32>, blend: vec3<f32>) -> vec3<f32>
                {
                    return base+blend-2.0*base*blend;
                }

                fn blendExclusion(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    return (exclusion(base, blend) * opacity + base * (1.0 - opacity));
                }
            `,
                main: `
                out = vec4<f32>(blendExclusion(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `
            }
        })
    }
}
hw.extension = {
    name: "exclusion",
    type: R.BlendMode
};
w0();
class xw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                float hardLight(float base, float blend)
                {
                    return (blend < 0.5) ? 2.0 * base * blend : 1.0 - 2.0 * (1.0 - base) * (1.0 - blend);
                }

                vec3 blendHardLight(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        hardLight(base.r, blend.r),
                        hardLight(base.g, blend.g),
                        hardLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,
                main: `
                finalColor = vec4(blendHardLight(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
            `
            },
            gpu: {
                functions: `
                fn hardLight(base: f32, blend: f32) -> f32
                {
                    return select(1.0 - 2.0 * (1.0 - base) * (1.0 - blend), 2.0 * base * blend, blend < 0.5);
                }

                fn blendHardLight(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        hardLight(base.r, blend.r),
                        hardLight(base.g, blend.g),
                        hardLight(base.b, blend.b)
                    );
                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                out = vec4<f32>(blendHardLight(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `
            }
        })
    }
}
xw.extension = {
    name: "hard-light",
    type: R.BlendMode
};
w0();
class gw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                float hardMix(float base, float blend)
                {
                    return (base + blend >= 1.0) ? 1.0 : 0.0;
                }

                vec3 blendHardMix(vec3 base, vec3 blend,  float opacity)
                {
                    vec3 blended = vec3(
                        hardMix(base.r, blend.r),
                        hardMix(base.g, blend.g),
                        hardMix(base.b, blend.b)
                    );
                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,
                main: `
                finalColor = vec4(blendHardMix(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
            `
            },
            gpu: {
                functions: `
                fn hardMix(base: f32, blend: f32) -> f32
                {
                    return select(0.0, 1.0, base + blend >= 1.0);
                }

                fn blendHardMix(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended: vec3<f32> = vec3<f32>(
                        hardMix(base.r, blend.r),
                        hardMix(base.g, blend.g),
                        hardMix(base.b, blend.b)
                    );
                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,
                main: `
                out = vec4<f32>(blendHardMix(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `
            }
        })
    }
}
gw.extension = {
    name: "hard-mix",
    type: R.BlendMode
};
w0();
class mw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                vec3 blendLighten(vec3 base, vec3 blend, float opacity)
                {
                    return (max(base, blend) * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                finalColor = vec4(blendLighten(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `
            },
            gpu: {
                functions: `
                fn blendLighten(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    return (max(base, blend) * opacity + base * (1.0 - opacity));
                }
            `,
                main: `
                out = vec4<f32>(blendLighten(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `
            }
        })
    }
}
mw.extension = {
    name: "lighten",
    type: R.BlendMode
};
w0();
class cw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                float linearBurn(float base, float blend)
                {
                    return max(0.0, base + blend - 1.0);
                }

                vec3 blendLinearBurn(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        linearBurn(base.r, blend.r),
                        linearBurn(base.g, blend.g),
                        linearBurn(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                finalColor = vec4(blendLinearBurn(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `
            },
            gpu: {
                functions: `
                fn linearBurn(base: f32, blend: f32) -> f32
                {
                    return max(0.0, base + blend - 1.0);
                }

                fn blendLinearBurn(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        linearBurn(base.r, blend.r),
                        linearBurn(base.g, blend.g),
                        linearBurn(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                out = vec4<f32>(blendLinearBurn(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `
            }
        })
    }
}
cw.extension = {
    name: "linear-burn",
    type: R.BlendMode
};
w0();
class dw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                float linearDodge(float base, float blend) {
                    return min(1.0, base + blend);
                }

                vec3 blendLinearDodge(vec3 base, vec3 blend, float opacity) {
                    vec3 blended = vec3(
                        linearDodge(base.r, blend.r),
                        linearDodge(base.g, blend.g),
                        linearDodge(base.b, blend.b)
                    );
                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                finalColor = vec4(blendLinearDodge(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `
            },
            gpu: {
                functions: `
                fn linearDodge(base: f32, blend: f32) -> f32
                {
                    return min(1, base + blend);
                }

                fn blendLinearDodge(base:vec3<f32>, blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        linearDodge(base.r, blend.r),
                        linearDodge(base.g, blend.g),
                        linearDodge(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,
                main: `
                out = vec4<f32>(blendLinearDodge(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `
            }
        })
    }
}
dw.extension = {
    name: "linear-dodge",
    type: R.BlendMode
};
w0();
class pw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                float linearBurn(float base, float blend) {
                    return max(0.0, base + blend - 1.0);
                }

                float linearDodge(float base, float blend) {
                    return min(1.0, base + blend);
                }

                float linearLight(float base, float blend) {
                    return (blend <= 0.5) ? linearBurn(base,2.0*blend) : linearBurn(base,2.0*(blend-0.5));
                }

                vec3 blendLinearLight(vec3 base, vec3 blend, float opacity) {
                    vec3 blended = vec3(
                        linearLight(base.r, blend.r),
                        linearLight(base.g, blend.g),
                        linearLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,
                main: `
                finalColor = vec4(blendLinearLight(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `
            },
            gpu: {
                functions: `
                fn linearBurn(base: f32, blend: f32) -> f32
                {
                    return max(0.0, base + blend - 1.0);
                }

                fn linearDodge(base: f32, blend: f32) -> f32
                {
                    return min(1.0, base + blend);
                }

                fn linearLight(base: f32, blend: f32) -> f32
                {
                    return select(linearBurn(base,2.0*(blend-0.5)), linearBurn(base,2.0*blend), blend <= 0.5);
                }

                fn blendLinearLightOpacity(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        linearLight(base.r, blend.r),
                        linearLight(base.g, blend.g),
                        linearLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,
                main: `
                out = vec4<f32>(blendLinearLightOpacity(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `
            }
        })
    }
}
pw.extension = {
    name: "linear-light",
    type: R.BlendMode
};
w0();
class uw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                ${AZ}

                vec3 blendLuminosity(vec3 base, vec3 blend,  float opacity)
                {
                    vec3 blendLuminosity = setLuminosity(base, getLuminosity(blend));
                    return (blendLuminosity * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                finalColor = vec4(blendLuminosity(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `
            },
            gpu: {
                functions: `
                ${EZ}

                fn blendLuminosity(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blendLuminosity: vec3<f32> = setLuminosity(base, getLuminosity(blend));
                    return (blendLuminosity * opacity + base * (1.0 - opacity));
                }
            `,
                main: `
                out = vec4<f32>(blendLuminosity(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `
            }
        })
    }
}
uw.extension = {
    name: "luminosity",
    type: R.BlendMode
};
w0();
class lw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                vec3 negation(vec3 base, vec3 blend)
                {
                    return 1.0-abs(1.0-base-blend);
                }

                vec3 blendNegation(vec3 base, vec3 blend, float opacity)
                {
                    return (negation(base, blend) * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                finalColor = vec4(blendNegation(back.rgb, front.rgb, front.a), blendedAlpha) * uBlend;
                `
            },
            gpu: {
                functions: `
                fn blendNegation(base: vec3<f32>, blend: vec3<f32>) -> vec3<f32>
                {
                    return 1.0-abs(1.0-base-blend);
                }

                fn blendNegationOpacity(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    return (blendNegation(base, blend) * opacity + base * (1.0 - opacity));
                }
            `,
                main: `
                out = vec4<f32>(blendNegationOpacity(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `
            }
        })
    }
}
lw.extension = {
    name: "negation",
    type: R.BlendMode
};
w0();
class ow extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                float overlay(float base, float blend)
                {
                    return (base < 0.5) ? (2.0*base*blend) : (1.0-2.0*(1.0-base)*(1.0-blend));
                }

                vec3 blendOverlay(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        overlay(base.r, blend.r),
                        overlay(base.g, blend.g),
                        overlay(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                finalColor = vec4(blendOverlay(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
                `
            },
            gpu: {
                functions: `
                fn overlay(base: f32, blend: f32) -> f32
                {
                    return select((1.0-2.0*(1.0-base)*(1.0-blend)), (2.0*base*blend), base < 0.5);
                }

                fn blendOverlay(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        overlay(base.r, blend.r),
                        overlay(base.g, blend.g),
                        overlay(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                out = vec4<f32>(blendOverlay(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `
            }
        })
    }
}
ow.extension = {
    name: "overlay",
    type: R.BlendMode
};
w0();
class nw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                float pinLight(float base, float blend)
                {
                    return (blend <= 0.5) ? min(base, 2.0 * blend) : max(base, 2.0 * (blend - 0.5));
                }

                vec3 blendPinLight(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        pinLight(base.r, blend.r),
                        pinLight(base.g, blend.g),
                        pinLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,
                main: `
                finalColor = vec4(blendPinLight(back.rgb, front.rgb, front.a), blendedAlpha) * uBlend;
                `
            },
            gpu: {
                functions: `
                fn pinLight(base: f32, blend: f32) -> f32
                {
                    return select(max(base,2.0*(blend-0.5)), min(base,2.0*blend), blend <= 0.5);
                }

                fn blendPinLight(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        pinLight(base.r, blend.r),
                        pinLight(base.g, blend.g),
                        pinLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                out = vec4<f32>(blendPinLight(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `
            }
        })
    }
}
nw.extension = {
    name: "pin-light",
    type: R.BlendMode
};
w0();
class sw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                ${AZ}

                vec3 blendSaturation(vec3 base, vec3 blend,  float opacity)
                {
                    vec3 blendSaturation = setLuminosity(setSaturation(base, getSaturation(blend)), getLuminosity(base));
                    return (blendSaturation * opacity + base * (1.0 - opacity));
                }
            `,
                main: `
                finalColor = vec4(blendSaturation(back.rgb, front.rgb, front.a), blendedAlpha) * uBlend;
            `
            },
            gpu: {
                functions: `
                ${EZ}

                fn blendSaturation(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blendSaturation = setLuminosity(setSaturation(base, getSaturation(blend)), getLuminosity(base));
                    return (blendSaturation * opacity + base * (1.0 - opacity));
                }
            `,
                main: `
                out = vec4<f32>(blendSaturation(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
            `
            }
        })
    }
}
sw.extension = {
    name: "saturation",
    type: R.BlendMode
};
w0();
class iw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                float softLight(float base, float blend)
                {
                    return (blend < 0.5) ? (2.0 * base * blend + base * base * (1.0 - 2.0 * blend)) : (sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend));
                }

                vec3 blendSoftLight(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        softLight(base.r, blend.r),
                        softLight(base.g, blend.g),
                        softLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                finalColor = vec4(blendSoftLight(back.rgb, front.rgb, front.a), blendedAlpha) * uBlend;
                `
            },
            gpu: {
                functions: `
                fn softLight(base: f32, blend: f32) -> f32
                {
                    return select(2.0 * base * blend + base * base * (1.0 - 2.0 * blend), sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend), blend < 0.5);
                }

                fn blendSoftLight(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended: vec3<f32> = vec3<f32>(
                        softLight(base.r, blend.r),
                        softLight(base.g, blend.g),
                        softLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                out = vec4<f32>(blendSoftLight(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `
            }
        })
    }
}
iw.extension = {
    name: "soft-light",
    type: R.BlendMode
};
w0();
class aw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                float subtract(float base, float blend)
                {
                    return max(0.0, base - blend);
                }

                vec3 blendSubtract(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        subtract(base.r, blend.r),
                        subtract(base.g, blend.g),
                        subtract(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                finalColor = vec4(blendSubtract(back.rgb, front.rgb, front.a), blendedAlpha) * uBlend;
                `
            },
            gpu: {
                functions: `
                fn subtract(base: f32, blend: f32) -> f32
                {
                    return max(0, base - blend);
                }

                fn blendSubtract(base:vec3<f32>,  blend:vec3<f32>,  opacity:f32) -> vec3<f32>
                {
                    let blended = vec3<f32>(
                        subtract(base.r, blend.r),
                        subtract(base.g, blend.g),
                        subtract(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                out = vec4<f32>(blendSubtract(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `
            }
        })
    }
}
aw.extension = {
    name: "subtract",
    type: R.BlendMode
};
w0();
class rw extends u8 {
    constructor() {
        super({
            gl: {
                functions: `
                float colorBurn(float base, float blend)
                {
                    return max((1.0-((1.0-base)/blend)),0.0);
                }

                float colorDodge(float base, float blend)
                {
                    return min(1.0, base / (1.0-blend));
                }

                float vividLight(float base, float blend)
                {
                    return (blend < 0.5) ? colorBurn(base,(2.0*blend)) : colorDodge(base,(2.0*(blend-0.5)));
                }

                vec3 blendVividLight(vec3 base, vec3 blend, float opacity)
                {
                    vec3 blended = vec3(
                        vividLight(base.r, blend.r),
                        vividLight(base.g, blend.g),
                        vividLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
            `,
                main: `
                finalColor = vec4(blendVividLight(back.rgb, front.rgb,front.a), blendedAlpha) * uBlend;
            `
            },
            gpu: {
                functions: `
                fn colorBurn(base:f32, blend:f32) -> f32
                {
                    return max((1.0-((1.0-base)/blend)),0.0);
                }

                fn colorDodge(base: f32, blend: f32) -> f32
                {
                    return min(1.0, base / (1.0-blend));
                }

                fn vividLight(base: f32, blend: f32) -> f32
                {
                    return select(colorDodge(base,(2.0*(blend-0.5))), colorBurn(base,(2.0*blend)), blend<0.5);
                }

                fn blendVividLight(base: vec3<f32>, blend: vec3<f32>, opacity: f32) -> vec3<f32>
                {
                    let blended: vec3<f32> = vec3<f32>(
                        vividLight(base.r, blend.r),
                        vividLight(base.g, blend.g),
                        vividLight(base.b, blend.b)
                    );

                    return (blended * opacity + base * (1.0 - opacity));
                }
                `,
                main: `
                out = vec4<f32>(blendVividLight(back.rgb, front.rgb, front.a), blendedAlpha) * blendUniforms.uBlend;
                `
            }
        })
    }
}
rw.extension = {
    name: "vivid-light",
    type: R.BlendMode
};
w0();
M6();
T$();
var Jj;
function g9(J) {
    if (Jj !== void 0)
        return Jj;
    return Jj = (() => {
        let Q = {
            stencil: !0,
            failIfMajorPerformanceCaveat: J ?? x9.defaultOptions.failIfMajorPerformanceCaveat
        };
        try {
            if (!a0.get().getWebGLRenderingContext())
                return !1;
            let $ = a0.get().createCanvas().getContext("webgl", Q)
                , q = !!$?.getContextAttributes()?.stencil;
            if ($) {
                let K = $.getExtension("WEBGL_lose_context");
                if (K)
                    K.loseContext()
            }
            return $ = null,
                q
        } catch (Z) {
            return !1
        }
    }
    )(),
        Jj
}
M6();
var Qj;
async function m9(J = {}) {
    if (Qj !== void 0)
        return Qj;
    return Qj = await (async () => {
        let Q = a0.get().getNavigator().gpu;
        if (!Q)
            return !1;
        try {
            return await (await Q.requestAdapter(J)).requestDevice(),
                !0
        } catch (Z) {
            return !1
        }
    }
    )(),
        Qj
}
T$();
var u_ = ["webgl", "webgpu", "canvas"];
async function rk(J) {
    let Q = [];
    if (J.preference)
        Q.push(J.preference),
            u_.forEach((K) => {
                if (K !== J.preference)
                    Q.push(K)
            }
            );
    else
        Q = u_.slice();
    let Z, $ = {};
    for (let K = 0; K < Q.length; K++) {
        let V = Q[K];
        if (V === "webgpu" && await m9()) {
            let { WebGPURenderer: z } = await Promise.resolve().then(() => (_B(),
                y_));
            Z = z,
                $ = {
                    ...J,
                    ...J.webgpu
                };
            break
        } else if (V === "webgl" && g9(J.failIfMajorPerformanceCaveat ?? x9.defaultOptions.failIfMajorPerformanceCaveat)) {
            let { WebGLRenderer: z } = await Promise.resolve().then(() => (ak(),
                p_));
            Z = z,
                $ = {
                    ...J,
                    ...J.webgl
                };
            break
        } else if (V === "canvas")
            throw $ = {
                ...J
            },
            new Error("CanvasRenderer is not yet implemented")
    }
    if (delete $.webgpu,
        delete $.webgl,
        !Z)
        throw new Error("No available renderer for the current environment");
    let q = new Z;
    return await q.init($),
        q
}
zJ();
JW();
O6();
var l_ = class J {
    constructor(...Q) {
        if (this.stage = new m8,
            Q[0] !== void 0)
            c0(Y8, "Application constructor options are deprecated, please use Application.init() instead.")
    }
    async init(Q) {
        Q = {
            ...Q
        },
            this.renderer = await rk(Q),
            J._plugins.forEach((Z) => {
                Z.init.call(this, Q)
            }
            )
    }
    render() {
        this.renderer.render({
            container: this.stage
        })
    }
    get canvas() {
        return this.renderer.canvas
    }
    get view() {
        return c0(Y8, "Application.view is deprecated, please use Application.canvas instead."),
            this.renderer.canvas
    }
    get screen() {
        return this.renderer.screen
    }
    destroy(Q = !1, Z = !1) {
        let $ = J._plugins.slice(0);
        $.reverse(),
            $.forEach((q) => {
                q.destroy.call(this)
            }
            ),
            this.stage.destroy(Z),
            this.stage = null,
            this.renderer.destroy(Q),
            this.renderer = null
    }
}
    ;
l_._plugins = [];
var mW = l_;
e0.handleByList(R.Application, mW._plugins);
e0.add(tq);
TX();
yX();
w0();
Q5();
TV();
M6();
w0();
wQ();
p1();
E7();
W6();
hz();
R$();
class nK extends _$ {
    constructor(J, Q) {
        super();
        let { textures: Z, data: $ } = J;
        Object.keys($.pages).forEach((q) => {
            let K = $.pages[parseInt(q, 10)]
                , V = Z[K.id];
            this.pages.push({
                texture: V
            })
        }
        ),
            Object.keys($.chars).forEach((q) => {
                let K = $.chars[q]
                    , { frame: V, source: z, rotate: W } = Z[K.page]
                    , H = b6.transformRectCoords(K, V, W, new v8)
                    , Y = new _0({
                        frame: H,
                        orig: new v8(0, 0, K.width, K.height),
                        source: z,
                        rotate: W
                    });
                this.chars[q] = {
                    id: q.codePointAt(0),
                    xOffset: K.xOffset,
                    yOffset: K.yOffset,
                    xAdvance: K.xAdvance,
                    kerning: K.kerning ?? {},
                    texture: Y
                }
            }
            ),
            this.baseRenderedFontSize = $.fontSize,
            this.baseMeasurementFontSize = $.fontSize,
            this.fontMetrics = {
                ascent: 0,
                descent: 0,
                fontSize: $.fontSize
            },
            this.baseLineOffset = $.baseLineOffset,
            this.lineHeight = $.lineHeight,
            this.fontFamily = $.fontFamily,
            this.distanceField = $.distanceField ?? {
                type: "none",
                range: 0
            },
            this.url = Q
    }
    destroy() {
        super.destroy();
        for (let J = 0; J < this.pages.length; J++) {
            let { texture: Q } = this.pages[J];
            Q.destroy(!0)
        }
        this.pages = null
    }
    static install(J) {
        K9.install(J)
    }
    static uninstall(J) {
        K9.uninstall(J)
    }
}
var sK = {
    test(J) {
        return typeof J === "string" && J.startsWith("info face=")
    },
    parse(J) {
        let Q = J.match(/^[a-z]+\s+.+$/gm)
            , Z = {
                info: [],
                common: [],
                page: [],
                char: [],
                chars: [],
                kerning: [],
                kernings: [],
                distanceField: []
            };
        for (let U in Q) {
            let N = Q[U].match(/^[a-z]+/gm)[0]
                , j = Q[U].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm)
                , k = {};
            for (let L in j) {
                let F = j[L].split("=")
                    , P = F[0]
                    , M = F[1].replace(/"/gm, "")
                    , v = parseFloat(M)
                    , E = isNaN(v) ? M : v;
                k[P] = E
            }
            Z[N].push(k)
        }
        let $ = {
            chars: {},
            pages: [],
            lineHeight: 0,
            fontSize: 0,
            fontFamily: "",
            distanceField: null,
            baseLineOffset: 0
        }
            , [q] = Z.info
            , [K] = Z.common
            , [V] = Z.distanceField ?? [];
        if (V)
            $.distanceField = {
                range: parseInt(V.distanceRange, 10),
                type: V.fieldType
            };
        $.fontSize = parseInt(q.size, 10),
            $.fontFamily = q.face,
            $.lineHeight = parseInt(K.lineHeight, 10);
        let z = Z.page;
        for (let U = 0; U < z.length; U++)
            $.pages.push({
                id: parseInt(z[U].id, 10) || 0,
                file: z[U].file
            });
        let W = {};
        $.baseLineOffset = $.lineHeight - parseInt(K.base, 10);
        let H = Z.char;
        for (let U = 0; U < H.length; U++) {
            let N = H[U]
                , j = parseInt(N.id, 10)
                , k = N.letter ?? N.char ?? String.fromCharCode(j);
            if (k === "space")
                k = " ";
            W[j] = k,
                $.chars[k] = {
                    id: j,
                    page: parseInt(N.page, 10) || 0,
                    x: parseInt(N.x, 10),
                    y: parseInt(N.y, 10),
                    width: parseInt(N.width, 10),
                    height: parseInt(N.height, 10),
                    xOffset: parseInt(N.xoffset, 10),
                    yOffset: parseInt(N.yoffset, 10),
                    xAdvance: parseInt(N.xadvance, 10),
                    kerning: {}
                }
        }
        let Y = Z.kerning || [];
        for (let U = 0; U < Y.length; U++) {
            let N = parseInt(Y[U].first, 10)
                , j = parseInt(Y[U].second, 10)
                , k = parseInt(Y[U].amount, 10);
            $.chars[W[j]].kerning[W[N]] = k
        }
        return $
    }
};
M6();
var cW = {
    test(J) {
        let Q = J;
        return typeof Q !== "string" && "getElementsByTagName" in Q && Q.getElementsByTagName("page").length && Q.getElementsByTagName("info")[0].getAttribute("face") !== null
    },
    parse(J) {
        let Q = {
            chars: {},
            pages: [],
            lineHeight: 0,
            fontSize: 0,
            fontFamily: "",
            distanceField: null,
            baseLineOffset: 0
        }
            , Z = J.getElementsByTagName("info")[0]
            , $ = J.getElementsByTagName("common")[0]
            , q = J.getElementsByTagName("distanceField")[0];
        if (q)
            Q.distanceField = {
                type: q.getAttribute("fieldType"),
                range: parseInt(q.getAttribute("distanceRange"), 10)
            };
        let K = J.getElementsByTagName("page")
            , V = J.getElementsByTagName("char")
            , z = J.getElementsByTagName("kerning");
        Q.fontSize = parseInt(Z.getAttribute("size"), 10),
            Q.fontFamily = Z.getAttribute("face"),
            Q.lineHeight = parseInt($.getAttribute("lineHeight"), 10);
        for (let H = 0; H < K.length; H++)
            Q.pages.push({
                id: parseInt(K[H].getAttribute("id"), 10) || 0,
                file: K[H].getAttribute("file")
            });
        let W = {};
        Q.baseLineOffset = Q.lineHeight - parseInt($.getAttribute("base"), 10);
        for (let H = 0; H < V.length; H++) {
            let Y = V[H]
                , U = parseInt(Y.getAttribute("id"), 10)
                , N = Y.getAttribute("letter") ?? Y.getAttribute("char") ?? String.fromCharCode(U);
            if (N === "space")
                N = " ";
            W[U] = N,
                Q.chars[N] = {
                    id: U,
                    page: parseInt(Y.getAttribute("page"), 10) || 0,
                    x: parseInt(Y.getAttribute("x"), 10),
                    y: parseInt(Y.getAttribute("y"), 10),
                    width: parseInt(Y.getAttribute("width"), 10),
                    height: parseInt(Y.getAttribute("height"), 10),
                    xOffset: parseInt(Y.getAttribute("xoffset"), 10),
                    yOffset: parseInt(Y.getAttribute("yoffset"), 10),
                    xAdvance: parseInt(Y.getAttribute("xadvance"), 10),
                    kerning: {}
                }
        }
        for (let H = 0; H < z.length; H++) {
            let Y = parseInt(z[H].getAttribute("first"), 10)
                , U = parseInt(z[H].getAttribute("second"), 10)
                , N = parseInt(z[H].getAttribute("amount"), 10);
            Q.chars[W[U]].kerning[W[Y]] = N
        }
        return Q
    }
};
var dW = {
    test(J) {
        if (typeof J === "string" && J.includes("<font>"))
            return cW.test(a0.get().parseXML(J));
        return !1
    },
    parse(J) {
        return cW.parse(a0.get().parseXML(J))
    }
};
var mm = [".xml", ".fnt"]
    , tk = {
        extension: {
            type: R.CacheParser,
            name: "cacheBitmapFont"
        },
        test: (J) => J instanceof nK,
        getCacheableAssets(J, Q) {
            let Z = {};
            return J.forEach(($) => {
                Z[$] = Q,
                    Z[`${$}-bitmap`] = Q
            }
            ),
                Z[`${Q.fontFamily}-bitmap`] = Q,
                Z
        }
    }
    , ek = {
        extension: {
            type: R.LoadParser,
            priority: X7.Normal
        },
        name: "loadBitmapFont",
        id: "bitmap-font",
        test(J) {
            return mm.includes(y7.extname(J).toLowerCase())
        },
        async testParse(J) {
            return sK.test(J) || dW.test(J)
        },
        async parse(J, Q, Z) {
            let $ = sK.test(J) ? sK.parse(J) : dW.parse(J)
                , { src: q } = Q
                , { pages: K } = $
                , V = []
                , z = $.distanceField ? {
                    scaleMode: "linear",
                    alphaMode: "premultiply-alpha-on-upload",
                    autoGenerateMipmaps: !1,
                    resolution: 1
                } : {};
            for (let U = 0; U < K.length; ++U) {
                let N = K[U].file
                    , j = y7.join(y7.dirname(q), N);
                j = N$(j, q),
                    V.push({
                        src: j,
                        data: z
                    })
            }
            let W = await Z.load(V)
                , H = V.map((U) => W[U.src]);
            return new nK({
                data: $,
                textures: H
            }, q)
        },
        async load(J, Q) {
            return await (await a0.get().fetch(J)).text()
        },
        async unload(J, Q, Z) {
            await Promise.all(J.pages.map(($) => Z.unload($.texture.source._sourceOrigin))),
                J.destroy()
        }
    };
B6();
class pW {
    constructor(J, Q = !1) {
        this._loader = J,
            this._assetList = [],
            this._isLoading = !1,
            this._maxConcurrent = 1,
            this.verbose = Q
    }
    add(J) {
        if (J.forEach((Q) => {
            this._assetList.push(Q)
        }
        ),
            this.verbose)
            ; if (this._isActive && !this._isLoading)
            this._next()
    }
    async _next() {
        if (this._assetList.length && this._isActive) {
            this._isLoading = !0;
            let J = []
                , Q = Math.min(this._assetList.length, this._maxConcurrent);
            for (let Z = 0; Z < Q; Z++)
                J.push(this._assetList.pop());
            await this._loader.load(J),
                this._isLoading = !1,
                this._next()
        }
    }
    get active() {
        return this._isActive
    }
    set active(J) {
        if (this._isActive === J)
            return;
        if (this._isActive = J,
            J && !this._isLoading)
            this._next()
    }
}
t5();
w0();
W6();
var JC = {
    extension: {
        type: R.CacheParser,
        name: "cacheTextureArray"
    },
    test: (J) => Array.isArray(J) && J.every((Q) => Q instanceof _0),
    getCacheableAssets: (J, Q) => {
        let Z = {};
        return J.forEach(($) => {
            Q.forEach((q, K) => {
                Z[$ + (K === 0 ? "" : K + 1)] = q
            }
            )
        }
        ),
            Z
    }
};
w0();
async function iK(J) {
    if ("Image" in globalThis)
        return new Promise((Q) => {
            let Z = new Image;
            Z.onload = () => {
                Q(!0)
            }
                ,
                Z.onerror = () => {
                    Q(!1)
                }
                ,
                Z.src = J
        }
        );
    if ("createImageBitmap" in globalThis && "fetch" in globalThis) {
        try {
            let Q = await (await fetch(J)).blob();
            await createImageBitmap(Q)
        } catch (Q) {
            return !1
        }
        return !0
    }
    return !1
}
var QC = {
    extension: {
        type: R.DetectionParser,
        priority: 1
    },
    test: async () => iK("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),
    add: async (J) => [...J, "avif"],
    remove: async (J) => J.filter((Q) => Q !== "avif")
};
w0();
var o_ = ["png", "jpg", "jpeg"]
    , ZC = {
        extension: {
            type: R.DetectionParser,
            priority: -1
        },
        test: () => Promise.resolve(!0),
        add: async (J) => [...J, ...o_],
        remove: async (J) => J.filter((Q) => !o_.includes(Q))
    };
w0();
var cm = "WorkerGlobalScope" in globalThis && globalThis instanceof globalThis.WorkerGlobalScope;
function c9(J) {
    if (cm)
        return !1;
    return document.createElement("video").canPlayType(J) !== ""
}
var $C = {
    extension: {
        type: R.DetectionParser,
        priority: 0
    },
    test: async () => c9("video/mp4"),
    add: async (J) => [...J, "mp4", "m4v"],
    remove: async (J) => J.filter((Q) => Q !== "mp4" && Q !== "m4v")
};
w0();
var qC = {
    extension: {
        type: R.DetectionParser,
        priority: 0
    },
    test: async () => c9("video/ogg"),
    add: async (J) => [...J, "ogv"],
    remove: async (J) => J.filter((Q) => Q !== "ogv")
};
w0();
var KC = {
    extension: {
        type: R.DetectionParser,
        priority: 0
    },
    test: async () => c9("video/webm"),
    add: async (J) => [...J, "webm"],
    remove: async (J) => J.filter((Q) => Q !== "webm")
};
w0();
var VC = {
    extension: {
        type: R.DetectionParser,
        priority: 0
    },
    test: async () => iK("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),
    add: async (J) => [...J, "webp"],
    remove: async (J) => J.filter((Q) => Q !== "webp")
};
B6();
wQ();
U$();
e1();
class uW {
    constructor() {
        this._parsers = [],
            this._parsersValidated = !1,
            this.parsers = new Proxy(this._parsers, {
                set: (J, Q, Z) => {
                    return this._parsersValidated = !1,
                        J[Q] = Z,
                        !0
                }
            }),
            this.promiseCache = {}
    }
    reset() {
        this._parsersValidated = !1,
            this.promiseCache = {}
    }
    _getLoadPromiseAndParser(J, Q) {
        let Z = {
            promise: null,
            parser: null
        };
        return Z.promise = (async () => {
            let $ = null
                , q = null;
            if (Q.parser || Q.loadParser) {
                if (q = this._parserHash[Q.parser || Q.loadParser],
                    Q.loadParser)
                    m0(`[Assets] "loadParser" is deprecated, use "parser" instead for ${J}`);
                if (!q)
                    m0(`[Assets] specified load parser "${Q.parser || Q.loadParser}" not found while loading ${J}`)
            }
            if (!q) {
                for (let K = 0; K < this.parsers.length; K++) {
                    let V = this.parsers[K];
                    if (V.load && V.test?.(J, Q, this)) {
                        q = V;
                        break
                    }
                }
                if (!q)
                    return m0(`[Assets] ${J} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),
                        null
            }
            $ = await q.load(J, Q, this),
                Z.parser = q;
            for (let K = 0; K < this.parsers.length; K++) {
                let V = this.parsers[K];
                if (V.parse) {
                    if (V.parse && await V.testParse?.($, Q, this))
                        $ = await V.parse($, Q, this) || $,
                            Z.parser = V
                }
            }
            return $
        }
        )(),
            Z
    }
    async load(J, Q) {
        if (!this._parsersValidated)
            this._validateParsers();
        let Z = 0
            , $ = {}
            , q = jQ(J)
            , K = BJ(J, (W) => ({
                alias: [W],
                src: W,
                data: {}
            }))
            , V = K.length
            , z = K.map(async (W) => {
                let H = y7.toAbsolute(W.src);
                if (!$[W.src])
                    try {
                        if (!this.promiseCache[H])
                            this.promiseCache[H] = this._getLoadPromiseAndParser(H, W);
                        if ($[W.src] = await this.promiseCache[H].promise,
                            Q)
                            Q(++Z / V)
                    } catch (Y) {
                        throw delete this.promiseCache[H],
                        delete $[W.src],
                        new Error(`[Loader.load] Failed to load ${H}.
${Y}`)
                    }
            }
            );
        return await Promise.all(z),
            q ? $[K[0].src] : $
    }
    async unload(J) {
        let Z = BJ(J, ($) => ({
            alias: [$],
            src: $
        })).map(async ($) => {
            let q = y7.toAbsolute($.src)
                , K = this.promiseCache[q];
            if (K) {
                let V = await K.promise;
                delete this.promiseCache[q],
                    await K.parser?.unload?.(V, $, this)
            }
        }
        );
        await Promise.all(Z)
    }
    _validateParsers() {
        this._parsersValidated = !0,
            this._parserHash = this._parsers.filter((J) => J.name || J.id).reduce((J, Q) => {
                if (!Q.name && !Q.id)
                    m0("[Assets] parser should have an id");
                else if (J[Q.name] || J[Q.id])
                    m0(`[Assets] parser id conflict "${Q.id}"`);
                if (J[Q.name] = Q,
                    Q.id)
                    J[Q.id] = Q;
                return J
            }
                , {})
    }
}
M6();
w0();
function K5(J, Q) {
    if (Array.isArray(Q)) {
        for (let Z of Q)
            if (J.startsWith(`data:${Z}`))
                return !0;
        return !1
    }
    return J.startsWith(`data:${Q}`)
}
wQ();
function O7(J, Q) {
    let Z = J.split("?")[0]
        , $ = y7.extname(Z).toLowerCase();
    if (Array.isArray(Q))
        return Q.includes($);
    return $ === Q
}
Q5();
var dm = ".json"
    , pm = "application/json"
    , zC = {
        extension: {
            type: R.LoadParser,
            priority: X7.Low
        },
        name: "loadJson",
        id: "json",
        test(J) {
            return K5(J, pm) || O7(J, dm)
        },
        async load(J) {
            return await (await a0.get().fetch(J)).catch((e) => console.log(e)).json()
        }
    };
M6();
w0();
Q5();
var um = ".txt"
    , lm = "text/plain"
    , WC = {
        name: "loadTxt",
        id: "text",
        extension: {
            type: R.LoadParser,
            priority: X7.Low,
            name: "loadTxt"
        },
        test(J) {
            return K5(J, lm) || O7(J, um)
        },
        async load(J) {
            return await (await a0.get().fetch(J)).text()
        }
    };
M6();
w0();
B6();
wQ();
t5();
Q5();
var om = ["normal", "bold", "100", "200", "300", "400", "500", "600", "700", "800", "900"]
    , nm = [".ttf", ".otf", ".woff", ".woff2"]
    , sm = ["font/ttf", "font/otf", "font/woff", "font/woff2"]
    , im = /^(--|-?[A-Z_])[0-9A-Z_-]*$/i;
function GG(J) {
    let Q = y7.extname(J)
        , q = y7.basename(J, Q).replace(/(-|_)/g, " ").toLowerCase().split(" ").map((z) => z.charAt(0).toUpperCase() + z.slice(1))
        , K = q.length > 0;
    for (let z of q)
        if (!z.match(im)) {
            K = !1;
            break
        }
    let V = q.join(" ");
    if (!K)
        V = `"${V.replace(/[\\"]/g, "\\$&")}"`;
    return V
}
var am = /^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;
function rm(J) {
    if (am.test(J))
        return J;
    return encodeURI(J)
}
var HC = {
    extension: {
        type: R.LoadParser,
        priority: X7.Low
    },
    name: "loadWebFont",
    id: "web-font",
    test(J) {
        return K5(J, sm) || O7(J, nm)
    },
    async load(J, Q) {
        let Z = a0.get().getFontFaceSet();
        if (Z) {
            let $ = []
                , q = Q.data?.family ?? GG(J)
                , K = Q.data?.weights?.filter((z) => om.includes(z)) ?? ["normal"]
                , V = Q.data ?? {};
            for (let z = 0; z < K.length; z++) {
                let W = K[z]
                    , H = new FontFace(q, `url(${rm(J)})`, {
                        ...V,
                        weight: W
                    });
                await H.load(),
                    Z.add(H),
                    $.push(H)
            }
            if (H6.has(`${q}-and-url`))
                H6.get(`${q}-and-url`).entries.push({
                    url: J,
                    faces: $
                });
            else
                H6.set(`${q}-and-url`, {
                    entries: [{
                        url: J,
                        faces: $
                    }]
                });
            return $.length === 1 ? $[0] : $
        }
        return m0("[loadWebFont] FontFace API is not supported. Skipping loading font"),
            null
    },
    unload(J) {
        let Q = Array.isArray(J) ? J : [J]
            , Z = Q[0].family
            , $ = H6.get(`${Z}-and-url`)
            , q = $.entries.find((K) => K.faces.some((V) => Q.indexOf(V) !== -1));
        if (q.faces = q.faces.filter((K) => Q.indexOf(K) === -1),
            q.faces.length === 0)
            $.entries = $.entries.filter((K) => K !== q);
        if (Q.forEach((K) => {
            a0.get().getFontFaceSet().delete(K)
        }
        ),
            $.entries.length === 0)
            H6.remove(`${Z}-and-url`)
    }
};
M6();
w0();
qZ();
IZ();
BQ();
function bZ(J, Q = 1) {
    let Z = AJ.RETINA_PREFIX?.exec(J);
    if (Z)
        return parseFloat(Z[1]);
    return Q
}
Q5();
W6();
B6();
t5();
function RJ(J, Q, Z) {
    J.label = Z,
        J._sourceOrigin = Z;
    let $ = new _0({
        source: J,
        label: Z
    })
        , q = () => {
            if (delete Q.promiseCache[Z],
                H6.has(Z))
                H6.remove(Z)
        }
        ;
    return $.source.once("destroy", () => {
        if (Q.promiseCache[Z])
            m0("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),
                q()
    }
    ),
        $.once("destroy", () => {
            if (!J.destroyed)
                m0("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),
                    q()
        }
        ),
        $
}
var tm = ".svg"
    , em = "image/svg+xml"
    , YC = {
        extension: {
            type: R.LoadParser,
            priority: X7.Low,
            name: "loadSVG"
        },
        name: "loadSVG",
        id: "svg",
        config: {
            crossOrigin: "anonymous",
            parseAsGraphicsContext: !1
        },
        test(J) {
            return K5(J, em) || O7(J, tm)
        },
        async load(J, Q, Z) {
            if (Q.data?.parseAsGraphicsContext ?? this.config.parseAsGraphicsContext)
                return Qc(J);
            return Jc(J, Q, Z, this.config.crossOrigin)
        },
        unload(J) {
            J.destroy(!0)
        }
    };
async function Jc(J, Q, Z, $) {
    let K = await (await a0.get().fetch(J)).blob()
        , V = URL.createObjectURL(K)
        , z = a0.get().createImage();
    z.src = V,
        z.crossOrigin = $,
        await z.decode(),
        URL.revokeObjectURL(V);
    let W = Q.data?.width ?? z.width
        , H = Q.data?.height ?? z.height
        , Y = Q.data?.resolution || bZ(J)
        , U = a0.get().createCanvas(W * Y, H * Y);
    U.getContext("2d").drawImage(z, 0, 0, W * Y, H * Y);
    let { parseAsGraphicsContext: j, ...k } = Q.data ?? {}
        , L = new pJ({
            resource: U,
            alphaMode: "premultiply-alpha-on-upload",
            resolution: Y,
            ...k
        });
    return RJ(L, Z, J)
}
async function Qc(J) {
    let Z = await (await a0.get().fetch(J)).text()
        , $ = new f7;
    return $.svg(Z),
        $
}
M6();
w0();
qZ();
var aK = null;
class lW {
    constructor() {
        if (!aK)
            aK = URL.createObjectURL(new Blob([`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`], {
                type: "application/javascript"
            }));
        this.worker = new Worker(aK)
    }
}
lW.revokeObjectURL = function J() {
    if (aK)
        URL.revokeObjectURL(aK),
            aK = null
}
    ;
var rK = null;
class XC {
    constructor() {
        if (!rK)
            rK = URL.createObjectURL(new Blob([`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`], {
                type: "application/javascript"
            }));
        this.worker = new Worker(rK)
    }
}
XC.revokeObjectURL = function J() {
    if (rK)
        URL.revokeObjectURL(rK),
            rK = null
}
    ;
var n_ = 0, PG;
class s_ {
    constructor() {
        this._initialized = !1,
            this._createdWorkers = 0,
            this._workerPool = [],
            this._queue = [],
            this._resolveHash = {}
    }
    isImageBitmapSupported() {
        if (this._isImageBitmapSupported !== void 0)
            return this._isImageBitmapSupported;
        return this._isImageBitmapSupported = new Promise((J) => {
            let { worker: Q } = new lW;
            Q.addEventListener("message", (Z) => {
                Q.terminate(),
                    lW.revokeObjectURL(),
                    J(Z.data)
            }
            )
        }
        ),
            this._isImageBitmapSupported
    }
    loadImageBitmap(J, Q) {
        return this._run("loadImageBitmap", [J, Q?.data?.alphaMode])
    }
    async _initWorkers() {
        if (this._initialized)
            return;
        this._initialized = !0
    }
    _getWorker() {
        if (PG === void 0)
            PG = navigator.hardwareConcurrency || 4;
        let J = this._workerPool.pop();
        if (!J && this._createdWorkers < PG)
            this._createdWorkers++,
                J = new XC().worker,
                J.addEventListener("message", (Q) => {
                    this._complete(Q.data),
                        this._returnWorker(Q.target),
                        this._next()
                }
                );
        return J
    }
    _returnWorker(J) {
        this._workerPool.push(J)
    }
    _complete(J) {
        if (J.error !== void 0)
            this._resolveHash[J.uuid].reject(J.error);
        else
            this._resolveHash[J.uuid].resolve(J.data);
        this._resolveHash[J.uuid] = null
    }
    async _run(J, Q) {
        await this._initWorkers();
        let Z = new Promise(($, q) => {
            this._queue.push({
                id: J,
                arguments: Q,
                resolve: $,
                reject: q
            })
        }
        );
        return this._next(),
            Z
    }
    _next() {
        if (!this._queue.length)
            return;
        let J = this._getWorker();
        if (!J)
            return;
        let Q = this._queue.pop()
            , Z = Q.id;
        this._resolveHash[n_] = {
            resolve: Q.resolve,
            reject: Q.reject
        },
            J.postMessage({
                data: Q.arguments,
                uuid: n_++,
                id: Z
            })
    }
    reset() {
        this._workerPool.forEach((J) => J.terminate()),
            this._workerPool.length = 0,
            Object.values(this._resolveHash).forEach(({ reject: J }) => {
                J?.(new Error("WorkerManager destroyed"))
            }
            ),
            this._resolveHash = {},
            this._queue.length = 0,
            this._initialized = !1,
            this._createdWorkers = 0
    }
}
var oW = new s_;
Q5();
var Zc = [".jpeg", ".jpg", ".png", ".webp", ".avif"]
    , $c = ["image/jpeg", "image/png", "image/webp", "image/avif"];
async function DG(J, Q) {
    let Z = await a0.get().fetch(J);
    if (!Z.ok)
        throw new Error(`[loadImageBitmap] Failed to fetch ${J}: ${Z.status} ${Z.statusText}`);
    let $ = await Z.blob();
    return Q?.data?.alphaMode === "premultiplied-alpha" ? createImageBitmap($, {
        premultiplyAlpha: "none"
    }) : createImageBitmap($)
}
var tK = {
    name: "loadTextures",
    id: "texture",
    extension: {
        type: R.LoadParser,
        priority: X7.High,
        name: "loadTextures"
    },
    config: {
        preferWorkers: !0,
        preferCreateImageBitmap: !0,
        crossOrigin: "anonymous"
    },
    test(J) {
        return K5(J, $c) || O7(J, Zc)
    },
    async load(J, Q, Z) {
        let $ = null;
        if (globalThis.createImageBitmap && this.config.preferCreateImageBitmap)
            if (this.config.preferWorkers && await oW.isImageBitmapSupported())
                $ = await oW.loadImageBitmap(J, Q);
            else
                $ = await DG(J, Q);
        else
            $ = await new Promise((K, V) => {
                if ($ = a0.get().createImage(),
                    $.crossOrigin = this.config.crossOrigin,
                    $.src = J,
                    $.complete)
                    K($);
                else
                    $.onload = () => {
                        K($)
                    }
                        ,
                        $.onerror = V
            }
            );
        let q = new pJ({
            resource: $,
            alphaMode: "premultiply-alpha-on-upload",
            resolution: Q.data?.resolution || bZ(J),
            ...Q.data
        });
        return RJ(q, Z, J)
    },
    unload(J) {
        J.destroy(!0)
    }
};
w0();
xV();
hV();
var qc = [".mp4", ".m4v", ".webm", ".ogg", ".ogv", ".h264", ".avi", ".mov"], AG, EG;
function MG(J, Q, Z) {
    if (Z === void 0 && !Q.startsWith("data:"))
        J.crossOrigin = RG(Q);
    else if (Z !== !1)
        J.crossOrigin = typeof Z === "string" ? Z : "anonymous"
}
function _G(J) {
    return new Promise((Q, Z) => {
        J.addEventListener("canplaythrough", $),
            J.addEventListener("error", q),
            J.load();
        function $() {
            K(),
                Q()
        }
        function q(V) {
            K(),
                Z(V)
        }
        function K() {
            J.removeEventListener("canplaythrough", $),
                J.removeEventListener("error", q)
        }
    }
    )
}
function RG(J, Q = globalThis.location) {
    if (J.startsWith("data:"))
        return "";
    Q || (Q = globalThis.location);
    let Z = new URL(J, document.baseURI);
    if (Z.hostname !== Q.hostname || Z.port !== Q.port || Z.protocol !== Q.protocol)
        return "anonymous";
    return ""
}
function Kc() {
    let J = []
        , Q = [];
    for (let Z of qc) {
        let $ = CQ.MIME_TYPES[Z.substring(1)] || `video/${Z.substring(1)}`;
        if (c9($)) {
            if (J.push(Z),
                !Q.includes($))
                Q.push($)
        }
    }
    return {
        validVideoExtensions: J,
        validVideoMime: Q
    }
}
var UC = {
    name: "loadVideo",
    id: "video",
    extension: {
        type: R.LoadParser,
        name: "loadVideo"
    },
    test(J) {
        if (!AG || !EG) {
            let { validVideoExtensions: $, validVideoMime: q } = Kc();
            AG = $,
                EG = q
        }
        let Q = K5(J, EG)
            , Z = O7(J, AG);
        return Q || Z
    },
    async load(J, Q, Z) {
        let $ = {
            ...CQ.defaultOptions,
            resolution: Q.data?.resolution || bZ(J),
            alphaMode: Q.data?.alphaMode || await Vq(),
            ...Q.data
        }
            , q = document.createElement("video")
            , K = {
                preload: $.autoLoad !== !1 ? "auto" : void 0,
                "webkit-playsinline": $.playsinline !== !1 ? "" : void 0,
                playsinline: $.playsinline !== !1 ? "" : void 0,
                muted: $.muted === !0 ? "" : void 0,
                loop: $.loop === !0 ? "" : void 0,
                autoplay: $.autoPlay !== !1 ? "" : void 0
            };
        if (Object.keys(K).forEach((W) => {
            let H = K[W];
            if (H !== void 0)
                q.setAttribute(W, H)
        }
        ),
            $.muted === !0)
            q.muted = !0;
        MG(q, J, $.crossorigin);
        let V = document.createElement("source"), z;
        if ($.mime)
            z = $.mime;
        else if (J.startsWith("data:"))
            z = J.slice(5, J.indexOf(";"));
        else if (!J.startsWith("blob:")) {
            let W = J.split("?")[0].slice(J.lastIndexOf(".") + 1).toLowerCase();
            z = CQ.MIME_TYPES[W] || `video/${W}`
        }
        if (V.src = J,
            z)
            V.type = z;
        return new Promise((W) => {
            let H = async () => {
                let Y = new CQ({
                    ...$,
                    resource: q
                });
                if (q.removeEventListener("canplay", H),
                    Q.data.preload)
                    await _G(q);
                W(RJ(Y, Z, J))
            }
                ;
            if ($.preload && !$.autoPlay)
                q.load();
            q.addEventListener("canplay", H),
                q.appendChild(V)
        }
        )
    },
    unload(J) {
        J.destroy(!0)
    }
};
w0();
BQ();
w0();
BQ();
var eK = {
    extension: {
        type: R.ResolveParser,
        name: "resolveTexture"
    },
    test: tK.test,
    parse: (J) => ({
        resolution: parseFloat(AJ.RETINA_PREFIX.exec(J)?.[1] ?? "1"),
        format: J.split(".").pop(),
        src: J
    })
};
var NC = {
    extension: {
        type: R.ResolveParser,
        priority: -2,
        name: "resolveJson"
    },
    test: (J) => AJ.RETINA_PREFIX.test(J) && J.endsWith(".json"),
    parse: eK.parse
};
BQ();
U$();
e1();
class wC {
    constructor() {
        this._detections = [],
            this._initialized = !1,
            this.resolver = new AJ,
            this.loader = new uW,
            this.cache = H6,
            this._backgroundLoader = new pW(this.loader),
            this._backgroundLoader.active = !0,
            this.reset()
    }
    async init(J = {}) {
        if (this._initialized) {
            m0("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");
            return
        }
        if (this._initialized = !0,
            J.defaultSearchParams)
            this.resolver.setDefaultSearchParams(J.defaultSearchParams);
        if (J.basePath)
            this.resolver.basePath = J.basePath;
        if (J.bundleIdentifier)
            this.resolver.setBundleIdentifier(J.bundleIdentifier);
        if (J.manifest) {
            let q = J.manifest;
            if (typeof q === "string")
                q = await this.load(q);
            this.resolver.addManifest(q)
        }
        let Q = J.texturePreference?.resolution ?? 1
            , Z = typeof Q === "number" ? [Q] : Q
            , $ = await this._detectFormats({
                preferredFormats: J.texturePreference?.format,
                skipDetections: J.skipDetections,
                detections: this._detections
            });
        if (this.resolver.prefer({
            params: {
                format: $,
                resolution: Z
            }
        }),
            J.preferences)
            this.setPreferences(J.preferences)
    }
    add(J) {
        this.resolver.add(J)
    }
    async load(J, Q) {
        if (!this._initialized)
            await this.init();
        let Z = jQ(J)
            , $ = BJ(J).map((V) => {
                if (typeof V !== "string") {
                    let z = this.resolver.getAlias(V);
                    if (z.some((W) => !this.resolver.hasKey(W)))
                        this.add(V);
                    return Array.isArray(z) ? z[0] : z
                }
                if (!this.resolver.hasKey(V))
                    this.add({
                        alias: V,
                        src: V
                    });
                return V
            }
            )
            , q = this.resolver.resolve($)
            , K = await this._mapLoadToResolve(q, Q);
        return Z ? K[$[0]] : K
    }
    addBundle(J, Q) {
        this.resolver.addBundle(J, Q)
    }
    async loadBundle(J, Q) {
        if (!this._initialized)
            await this.init();
        let Z = !1;
        if (typeof J === "string")
            Z = !0,
                J = [J];
        let $ = this.resolver.resolveBundle(J)
            , q = {}
            , K = Object.keys($)
            , V = 0
            , z = 0
            , W = () => {
                Q?.(++V / z)
            }
            , H = K.map((Y) => {
                let U = $[Y]
                    , N = Object.values(U)
                    , j = [...new Set(N.flat())];
                return z += j.length,
                    this._mapLoadToResolve(U, W).then((k) => {
                        q[Y] = k
                    }
                    )
            }
            );
        return await Promise.all(H),
            Z ? q[J[0]] : q
    }
    async backgroundLoad(J) {
        if (!this._initialized)
            await this.init();
        if (typeof J === "string")
            J = [J];
        let Q = this.resolver.resolve(J);
        this._backgroundLoader.add(Object.values(Q))
    }
    async backgroundLoadBundle(J) {
        if (!this._initialized)
            await this.init();
        if (typeof J === "string")
            J = [J];
        let Q = this.resolver.resolveBundle(J);
        Object.values(Q).forEach((Z) => {
            this._backgroundLoader.add(Object.values(Z))
        }
        )
    }
    reset() {
        this.resolver.reset(),
            this.loader.reset(),
            this.cache.reset(),
            this._initialized = !1
    }
    get(J) {
        if (typeof J === "string")
            return H6.get(J);
        let Q = {};
        for (let Z = 0; Z < J.length; Z++)
            Q[Z] = H6.get(J[Z]);
        return Q
    }
    async _mapLoadToResolve(J, Q) {
        let Z = [...new Set(Object.values(J))];
        this._backgroundLoader.active = !1;
        let $ = await this.loader.load(Z, Q);
        this._backgroundLoader.active = !0;
        let q = {};
        return Z.forEach((K) => {
            let V = $[K.src]
                , z = [K.src];
            if (K.alias)
                z.push(...K.alias);
            z.forEach((W) => {
                q[W] = V
            }
            ),
                H6.set(z, V)
        }
        ),
            q
    }
    async unload(J) {
        if (!this._initialized)
            await this.init();
        let Q = BJ(J).map(($) => typeof $ !== "string" ? $.src : $)
            , Z = this.resolver.resolve(Q);
        await this._unloadFromResolved(Z)
    }
    async unloadBundle(J) {
        if (!this._initialized)
            await this.init();
        J = BJ(J);
        let Q = this.resolver.resolveBundle(J)
            , Z = Object.keys(Q).map(($) => this._unloadFromResolved(Q[$]));
        await Promise.all(Z)
    }
    async _unloadFromResolved(J) {
        let Q = Object.values(J);
        Q.forEach((Z) => {
            H6.remove(Z.src)
        }
        ),
            await this.loader.unload(Q)
    }
    async _detectFormats(J) {
        let Q = [];
        if (J.preferredFormats)
            Q = Array.isArray(J.preferredFormats) ? J.preferredFormats : [J.preferredFormats];
        for (let Z of J.detections)
            if (J.skipDetections || await Z.test())
                Q = await Z.add(Q);
            else if (!J.skipDetections)
                Q = await Z.remove(Q);
        return Q = Q.filter((Z, $) => Q.indexOf(Z) === $),
            Q
    }
    get detections() {
        return this._detections
    }
    setPreferences(J) {
        this.loader.parsers.forEach((Q) => {
            if (!Q.config)
                return;
            Object.keys(Q.config).filter((Z) => (Z in J)).forEach((Z) => {
                Q.config[Z] = J[Z]
            }
            )
        }
        )
    }
}
var d9 = new wC;
e0.handleByList(R.LoadParser, d9.loader.parsers).handleByList(R.ResolveParser, d9.resolver.parsers).handleByList(R.CacheParser, d9.cache.parsers).handleByList(R.DetectionParser, d9.detections);
e0.add(JC, ZC, QC, VC, $C, qC, KC, zC, WC, HC, YC, tK, UC, ek, tk, eK, NC);
var i_ = {
    loader: R.LoadParser,
    resolver: R.ResolveParser,
    cache: R.CacheParser,
    detection: R.DetectionParser
};
e0.handle(R.Asset, (J) => {
    let Q = J.ref;
    Object.entries(i_).filter(([Z]) => !!Q[Z]).forEach(([Z, $]) => e0.add(Object.assign(Q[Z], {
        extension: Q[Z].extension ?? $
    })))
}
    , (J) => {
        let Q = J.ref;
        Object.keys(i_).filter((Z) => !!Q[Z]).forEach((Z) => e0.remove(Q[Z]))
    }
);
t5();
Q5();
BQ();
U$();
TV();
uX();
e1();
T7();
w0();
var a_ = {
    extension: {
        type: R.DetectionParser,
        priority: 3
    },
    test: async () => {
        if (await m9())
            return !0;
        if (g9())
            return !0;
        return !1
    }
    ,
    add: async (J) => [...J, "basis"],
    remove: async (J) => J.filter((Q) => Q !== "basis")
};
Q5();
w0();
n7();
class H9 extends $6 {
    constructor(J) {
        super(J);
        this.uploadMethodId = "compressed",
            this.resource = J.resource,
            this.mipLevelCount = this.resource.length
    }
}
M6();
var jC;
function nW() {
    if (jC)
        return jC;
    let Q = a0.get().createCanvas(1, 1).getContext("webgl");
    if (!Q)
        return [];
    return jC = [...Q.getExtension("EXT_texture_compression_bptc") ? ["bc6h-rgb-ufloat", "bc6h-rgb-float", "bc7-rgba-unorm", "bc7-rgba-unorm-srgb"] : [], ...Q.getExtension("WEBGL_compressed_texture_s3tc") ? ["bc1-rgba-unorm", "bc2-rgba-unorm", "bc3-rgba-unorm"] : [], ...Q.getExtension("WEBGL_compressed_texture_s3tc_srgb") ? ["bc1-rgba-unorm-srgb", "bc2-rgba-unorm-srgb", "bc3-rgba-unorm-srgb"] : [], ...Q.getExtension("EXT_texture_compression_rgtc") ? ["bc4-r-unorm", "bc4-r-snorm", "bc5-rg-unorm", "bc5-rg-snorm"] : [], ...Q.getExtension("WEBGL_compressed_texture_etc") ? ["etc2-rgb8unorm", "etc2-rgb8unorm-srgb", "etc2-rgba8unorm", "etc2-rgba8unorm-srgb", "etc2-rgb8a1unorm", "etc2-rgb8a1unorm-srgb", "eac-r11unorm", "eac-rg11unorm"] : [], ...Q.getExtension("WEBGL_compressed_texture_astc") ? ["astc-4x4-unorm", "astc-4x4-unorm-srgb", "astc-5x4-unorm", "astc-5x4-unorm-srgb", "astc-5x5-unorm", "astc-5x5-unorm-srgb", "astc-6x5-unorm", "astc-6x5-unorm-srgb", "astc-6x6-unorm", "astc-6x6-unorm-srgb", "astc-8x5-unorm", "astc-8x5-unorm-srgb", "astc-8x6-unorm", "astc-8x6-unorm-srgb", "astc-8x8-unorm", "astc-8x8-unorm-srgb", "astc-10x5-unorm", "astc-10x5-unorm-srgb", "astc-10x6-unorm", "astc-10x6-unorm-srgb", "astc-10x8-unorm", "astc-10x8-unorm-srgb", "astc-10x10-unorm", "astc-10x10-unorm-srgb", "astc-12x10-unorm", "astc-12x10-unorm-srgb", "astc-12x12-unorm", "astc-12x12-unorm-srgb"] : []],
        jC
}
M6();
var BC;
async function sW() {
    if (BC)
        return BC;
    let J = await a0.get().getNavigator().gpu.requestAdapter();
    return BC = [...J.features.has("texture-compression-bc") ? ["bc1-rgba-unorm", "bc1-rgba-unorm-srgb", "bc2-rgba-unorm", "bc2-rgba-unorm-srgb", "bc3-rgba-unorm", "bc3-rgba-unorm-srgb", "bc4-r-unorm", "bc4-r-snorm", "bc5-rg-unorm", "bc5-rg-snorm", "bc6h-rgb-ufloat", "bc6h-rgb-float", "bc7-rgba-unorm", "bc7-rgba-unorm-srgb"] : [], ...J.features.has("texture-compression-etc2") ? ["etc2-rgb8unorm", "etc2-rgb8unorm-srgb", "etc2-rgb8a1unorm", "etc2-rgb8a1unorm-srgb", "etc2-rgba8unorm", "etc2-rgba8unorm-srgb", "eac-r11unorm", "eac-r11snorm", "eac-rg11unorm", "eac-rg11snorm"] : [], ...J.features.has("texture-compression-astc") ? ["astc-4x4-unorm", "astc-4x4-unorm-srgb", "astc-5x4-unorm", "astc-5x4-unorm-srgb", "astc-5x5-unorm", "astc-5x5-unorm-srgb", "astc-6x5-unorm", "astc-6x5-unorm-srgb", "astc-6x6-unorm", "astc-6x6-unorm-srgb", "astc-8x5-unorm", "astc-8x5-unorm-srgb", "astc-8x6-unorm", "astc-8x6-unorm-srgb", "astc-8x8-unorm", "astc-8x8-unorm-srgb", "astc-10x5-unorm", "astc-10x5-unorm-srgb", "astc-10x6-unorm", "astc-10x6-unorm-srgb", "astc-10x8-unorm", "astc-10x8-unorm-srgb", "astc-10x10-unorm", "astc-10x10-unorm-srgb", "astc-12x10-unorm", "astc-12x10-unorm-srgb", "astc-12x12-unorm", "astc-12x12-unorm-srgb"] : []],
        BC
}
var kC;
async function J4() {
    if (kC !== void 0)
        return kC;
    return kC = await (async () => {
        let J = await m9()
            , Q = g9();
        if (J && Q) {
            let Z = await sW()
                , $ = nW();
            return Z.filter((q) => $.includes(q))
        } else if (J)
            return await sW();
        else if (Q)
            return nW();
        return []
    }
    )(),
        kC
}
var bG = ["r8unorm", "r8snorm", "r8uint", "r8sint", "r16uint", "r16sint", "r16float", "rg8unorm", "rg8snorm", "rg8uint", "rg8sint", "r32uint", "r32sint", "r32float", "rg16uint", "rg16sint", "rg16float", "rgba8unorm", "rgba8unorm-srgb", "rgba8snorm", "rgba8uint", "rgba8sint", "bgra8unorm", "bgra8unorm-srgb", "rgb9e5ufloat", "rgb10a2unorm", "rg11b10ufloat", "rg32uint", "rg32sint", "rg32float", "rgba16uint", "rgba16sint", "rgba16float", "rgba32uint", "rgba32sint", "rgba32float", "stencil8", "depth16unorm", "depth24plus", "depth24plus-stencil8", "depth32float", "depth32float-stencil8"], CC;
async function p9() {
    if (CC !== void 0)
        return CC;
    let J = await J4();
    return CC = [...bG, ...J],
        CC
}
var Q4 = null;
class OC {
    constructor() {
        if (!Q4)
            Q4 = URL.createObjectURL(new Blob([`(function () {
    'use strict';

    function createLevelBuffers(basisTexture, basisTranscoderFormat) {
      const images = basisTexture.getNumImages();
      const levels = basisTexture.getNumLevels(0);
      const success = basisTexture.startTranscoding();
      if (!success) {
        throw new Error("startTranscoding failed");
      }
      const levelBuffers = [];
      for (let levelIndex = 0; levelIndex < levels; ++levelIndex) {
        for (let sliceIndex = 0; sliceIndex < images; ++sliceIndex) {
          const transcodeSize = basisTexture.getImageTranscodedSizeInBytes(sliceIndex, levelIndex, basisTranscoderFormat);
          const levelBuffer = new Uint8Array(transcodeSize);
          const success2 = basisTexture.transcodeImage(levelBuffer, sliceIndex, levelIndex, basisTranscoderFormat, 1, 0);
          if (!success2) {
            throw new Error("transcodeImage failed");
          }
          levelBuffers.push(levelBuffer);
        }
      }
      return levelBuffers;
    }

    const gpuFormatToBasisTranscoderFormatMap = {
      "bc3-rgba-unorm": 3,
      // cTFBC3_RGBA
      "bc7-rgba-unorm": 6,
      // cTFBC7_RGBA,
      "etc2-rgba8unorm": 1,
      // cTFETC2_RGBA,
      "astc-4x4-unorm": 10,
      // cTFASTC_4x4_RGBA,
      // Uncompressed
      rgba8unorm: 13,
      // cTFRGBA32,
      rgba4unorm: 16
      // cTFRGBA4444,
    };
    function gpuFormatToBasisTranscoderFormat(transcoderFormat) {
      const format = gpuFormatToBasisTranscoderFormatMap[transcoderFormat];
      if (format) {
        return format;
      }
      throw new Error(\`Unsupported transcoderFormat: \${transcoderFormat}\`);
    }

    const settings = {
      jsUrl: "basis/basis_transcoder.js",
      wasmUrl: "basis/basis_transcoder.wasm"
    };
    let basisTranscoderFormat;
    let basisTranscodedTextureFormat;
    let basisPromise;
    async function getBasis() {
      if (!basisPromise) {
        const absoluteJsUrl = new URL(settings.jsUrl, location.origin).href;
        const absoluteWasmUrl = new URL(settings.wasmUrl, location.origin).href;
        importScripts(absoluteJsUrl);
        basisPromise = new Promise((resolve) => {
          BASIS({
            locateFile: (_file) => absoluteWasmUrl
          }).then((module) => {
            module.initializeBasis();
            resolve(module.BasisFile);
          });
        });
      }
      return basisPromise;
    }
    async function fetchBasisTexture(url, BasisTexture) {
      const basisResponse = await fetch(url);
      if (basisResponse.ok) {
        const basisArrayBuffer = await basisResponse.arrayBuffer();
        return new BasisTexture(new Uint8Array(basisArrayBuffer));
      }
      throw new Error(\`Failed to load Basis texture: \${url}\`);
    }
    const preferredTranscodedFormat = [
      "bc7-rgba-unorm",
      "astc-4x4-unorm",
      "etc2-rgba8unorm",
      "bc3-rgba-unorm",
      "rgba8unorm"
    ];
    async function load(url) {
      const BasisTexture = await getBasis();
      const basisTexture = await fetchBasisTexture(url, BasisTexture);
      const levelBuffers = createLevelBuffers(basisTexture, basisTranscoderFormat);
      return {
        width: basisTexture.getImageWidth(0, 0),
        height: basisTexture.getImageHeight(0, 0),
        format: basisTranscodedTextureFormat,
        resource: levelBuffers,
        alphaMode: "no-premultiply-alpha"
      };
    }
    async function init(jsUrl, wasmUrl, supportedTextures) {
      if (jsUrl)
        settings.jsUrl = jsUrl;
      if (wasmUrl)
        settings.wasmUrl = wasmUrl;
      basisTranscodedTextureFormat = preferredTranscodedFormat.filter((format) => supportedTextures.includes(format))[0];
      basisTranscoderFormat = gpuFormatToBasisTranscoderFormat(basisTranscodedTextureFormat);
      await getBasis();
    }
    const messageHandlers = {
      init: async (data) => {
        const { jsUrl, wasmUrl, supportedTextures } = data;
        await init(jsUrl, wasmUrl, supportedTextures);
      },
      load: async (data) => {
        try {
          const textureOptions = await load(data.url);
          return {
            type: "load",
            url: data.url,
            success: true,
            textureOptions,
            transferables: textureOptions.resource?.map((arr) => arr.buffer)
          };
        } catch (e) {
          throw e;
        }
      }
    };
    self.onmessage = async (messageEvent) => {
      const message = messageEvent.data;
      const response = await messageHandlers[message.type](message);
      if (response) {
        self.postMessage(response, response.transferables);
      }
    };

})();
`], {
                type: "application/javascript"
            }));
        this.worker = new Worker(Q4)
    }
}
OC.revokeObjectURL = function J() {
    if (Q4)
        URL.revokeObjectURL(Q4),
            Q4 = null
}
    ;
var iW = {
    jsUrl: "https://files.pixijs.download/transcoders/basis/basis_transcoder.js",
    wasmUrl: "https://files.pixijs.download/transcoders/basis/basis_transcoder.wasm"
};
var aW, r_ = {};
function Vc(J) {
    if (!aW)
        aW = new OC().worker,
            aW.onmessage = (Q) => {
                let { success: Z, url: $, textureOptions: q } = Q.data;
                r_[$](q)
            }
            ,
            aW.postMessage({
                type: "init",
                jsUrl: iW.jsUrl,
                wasmUrl: iW.wasmUrl,
                supportedTextures: J
            });
    return aW
}
function IC(J, Q) {
    let Z = Vc(Q);
    return new Promise(($) => {
        r_[J] = $,
            Z.postMessage({
                type: "load",
                url: J
            })
    }
    )
}
var t_ = {
    extension: {
        type: R.LoadParser,
        priority: X7.High,
        name: "loadBasis"
    },
    name: "loadBasis",
    id: "basis",
    test(J) {
        return O7(J, [".basis"])
    },
    async load(J, Q, Z) {
        let $ = await p9()
            , q = await IC(J, $)
            , K = new H9(q);
        return RJ(K, Z, J)
    },
    unload(J) {
        if (Array.isArray(J))
            J.forEach((Q) => Q.destroy(!0));
        else
            J.destroy(!0)
    }
};
var zc = {
    MAGIC: 0,
    SIZE: 1,
    FLAGS: 2,
    HEIGHT: 3,
    WIDTH: 4,
    MIPMAP_COUNT: 7,
    PIXEL_FORMAT: 19,
    PF_FLAGS: 20,
    FOURCC: 21,
    RGB_BITCOUNT: 22,
    R_BIT_MASK: 23,
    G_BIT_MASK: 24,
    B_BIT_MASK: 25,
    A_BIT_MASK: 26
}
    , Wc = {
        DXGI_FORMAT: 0,
        RESOURCE_DIMENSION: 1,
        MISC_FLAG: 2,
        ARRAY_SIZE: 3,
        MISC_FLAGS2: 4
    }
    , LC = ((J) => {
        return J[J.DXGI_FORMAT_UNKNOWN = 0] = "DXGI_FORMAT_UNKNOWN",
            J[J.DXGI_FORMAT_R32G32B32A32_TYPELESS = 1] = "DXGI_FORMAT_R32G32B32A32_TYPELESS",
            J[J.DXGI_FORMAT_R32G32B32A32_FLOAT = 2] = "DXGI_FORMAT_R32G32B32A32_FLOAT",
            J[J.DXGI_FORMAT_R32G32B32A32_UINT = 3] = "DXGI_FORMAT_R32G32B32A32_UINT",
            J[J.DXGI_FORMAT_R32G32B32A32_SINT = 4] = "DXGI_FORMAT_R32G32B32A32_SINT",
            J[J.DXGI_FORMAT_R32G32B32_TYPELESS = 5] = "DXGI_FORMAT_R32G32B32_TYPELESS",
            J[J.DXGI_FORMAT_R32G32B32_FLOAT = 6] = "DXGI_FORMAT_R32G32B32_FLOAT",
            J[J.DXGI_FORMAT_R32G32B32_UINT = 7] = "DXGI_FORMAT_R32G32B32_UINT",
            J[J.DXGI_FORMAT_R32G32B32_SINT = 8] = "DXGI_FORMAT_R32G32B32_SINT",
            J[J.DXGI_FORMAT_R16G16B16A16_TYPELESS = 9] = "DXGI_FORMAT_R16G16B16A16_TYPELESS",
            J[J.DXGI_FORMAT_R16G16B16A16_FLOAT = 10] = "DXGI_FORMAT_R16G16B16A16_FLOAT",
            J[J.DXGI_FORMAT_R16G16B16A16_UNORM = 11] = "DXGI_FORMAT_R16G16B16A16_UNORM",
            J[J.DXGI_FORMAT_R16G16B16A16_UINT = 12] = "DXGI_FORMAT_R16G16B16A16_UINT",
            J[J.DXGI_FORMAT_R16G16B16A16_SNORM = 13] = "DXGI_FORMAT_R16G16B16A16_SNORM",
            J[J.DXGI_FORMAT_R16G16B16A16_SINT = 14] = "DXGI_FORMAT_R16G16B16A16_SINT",
            J[J.DXGI_FORMAT_R32G32_TYPELESS = 15] = "DXGI_FORMAT_R32G32_TYPELESS",
            J[J.DXGI_FORMAT_R32G32_FLOAT = 16] = "DXGI_FORMAT_R32G32_FLOAT",
            J[J.DXGI_FORMAT_R32G32_UINT = 17] = "DXGI_FORMAT_R32G32_UINT",
            J[J.DXGI_FORMAT_R32G32_SINT = 18] = "DXGI_FORMAT_R32G32_SINT",
            J[J.DXGI_FORMAT_R32G8X24_TYPELESS = 19] = "DXGI_FORMAT_R32G8X24_TYPELESS",
            J[J.DXGI_FORMAT_D32_FLOAT_S8X24_UINT = 20] = "DXGI_FORMAT_D32_FLOAT_S8X24_UINT",
            J[J.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS = 21] = "DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",
            J[J.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT = 22] = "DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",
            J[J.DXGI_FORMAT_R10G10B10A2_TYPELESS = 23] = "DXGI_FORMAT_R10G10B10A2_TYPELESS",
            J[J.DXGI_FORMAT_R10G10B10A2_UNORM = 24] = "DXGI_FORMAT_R10G10B10A2_UNORM",
            J[J.DXGI_FORMAT_R10G10B10A2_UINT = 25] = "DXGI_FORMAT_R10G10B10A2_UINT",
            J[J.DXGI_FORMAT_R11G11B10_FLOAT = 26] = "DXGI_FORMAT_R11G11B10_FLOAT",
            J[J.DXGI_FORMAT_R8G8B8A8_TYPELESS = 27] = "DXGI_FORMAT_R8G8B8A8_TYPELESS",
            J[J.DXGI_FORMAT_R8G8B8A8_UNORM = 28] = "DXGI_FORMAT_R8G8B8A8_UNORM",
            J[J.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB = 29] = "DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",
            J[J.DXGI_FORMAT_R8G8B8A8_UINT = 30] = "DXGI_FORMAT_R8G8B8A8_UINT",
            J[J.DXGI_FORMAT_R8G8B8A8_SNORM = 31] = "DXGI_FORMAT_R8G8B8A8_SNORM",
            J[J.DXGI_FORMAT_R8G8B8A8_SINT = 32] = "DXGI_FORMAT_R8G8B8A8_SINT",
            J[J.DXGI_FORMAT_R16G16_TYPELESS = 33] = "DXGI_FORMAT_R16G16_TYPELESS",
            J[J.DXGI_FORMAT_R16G16_FLOAT = 34] = "DXGI_FORMAT_R16G16_FLOAT",
            J[J.DXGI_FORMAT_R16G16_UNORM = 35] = "DXGI_FORMAT_R16G16_UNORM",
            J[J.DXGI_FORMAT_R16G16_UINT = 36] = "DXGI_FORMAT_R16G16_UINT",
            J[J.DXGI_FORMAT_R16G16_SNORM = 37] = "DXGI_FORMAT_R16G16_SNORM",
            J[J.DXGI_FORMAT_R16G16_SINT = 38] = "DXGI_FORMAT_R16G16_SINT",
            J[J.DXGI_FORMAT_R32_TYPELESS = 39] = "DXGI_FORMAT_R32_TYPELESS",
            J[J.DXGI_FORMAT_D32_FLOAT = 40] = "DXGI_FORMAT_D32_FLOAT",
            J[J.DXGI_FORMAT_R32_FLOAT = 41] = "DXGI_FORMAT_R32_FLOAT",
            J[J.DXGI_FORMAT_R32_UINT = 42] = "DXGI_FORMAT_R32_UINT",
            J[J.DXGI_FORMAT_R32_SINT = 43] = "DXGI_FORMAT_R32_SINT",
            J[J.DXGI_FORMAT_R24G8_TYPELESS = 44] = "DXGI_FORMAT_R24G8_TYPELESS",
            J[J.DXGI_FORMAT_D24_UNORM_S8_UINT = 45] = "DXGI_FORMAT_D24_UNORM_S8_UINT",
            J[J.DXGI_FORMAT_R24_UNORM_X8_TYPELESS = 46] = "DXGI_FORMAT_R24_UNORM_X8_TYPELESS",
            J[J.DXGI_FORMAT_X24_TYPELESS_G8_UINT = 47] = "DXGI_FORMAT_X24_TYPELESS_G8_UINT",
            J[J.DXGI_FORMAT_R8G8_TYPELESS = 48] = "DXGI_FORMAT_R8G8_TYPELESS",
            J[J.DXGI_FORMAT_R8G8_UNORM = 49] = "DXGI_FORMAT_R8G8_UNORM",
            J[J.DXGI_FORMAT_R8G8_UINT = 50] = "DXGI_FORMAT_R8G8_UINT",
            J[J.DXGI_FORMAT_R8G8_SNORM = 51] = "DXGI_FORMAT_R8G8_SNORM",
            J[J.DXGI_FORMAT_R8G8_SINT = 52] = "DXGI_FORMAT_R8G8_SINT",
            J[J.DXGI_FORMAT_R16_TYPELESS = 53] = "DXGI_FORMAT_R16_TYPELESS",
            J[J.DXGI_FORMAT_R16_FLOAT = 54] = "DXGI_FORMAT_R16_FLOAT",
            J[J.DXGI_FORMAT_D16_UNORM = 55] = "DXGI_FORMAT_D16_UNORM",
            J[J.DXGI_FORMAT_R16_UNORM = 56] = "DXGI_FORMAT_R16_UNORM",
            J[J.DXGI_FORMAT_R16_UINT = 57] = "DXGI_FORMAT_R16_UINT",
            J[J.DXGI_FORMAT_R16_SNORM = 58] = "DXGI_FORMAT_R16_SNORM",
            J[J.DXGI_FORMAT_R16_SINT = 59] = "DXGI_FORMAT_R16_SINT",
            J[J.DXGI_FORMAT_R8_TYPELESS = 60] = "DXGI_FORMAT_R8_TYPELESS",
            J[J.DXGI_FORMAT_R8_UNORM = 61] = "DXGI_FORMAT_R8_UNORM",
            J[J.DXGI_FORMAT_R8_UINT = 62] = "DXGI_FORMAT_R8_UINT",
            J[J.DXGI_FORMAT_R8_SNORM = 63] = "DXGI_FORMAT_R8_SNORM",
            J[J.DXGI_FORMAT_R8_SINT = 64] = "DXGI_FORMAT_R8_SINT",
            J[J.DXGI_FORMAT_A8_UNORM = 65] = "DXGI_FORMAT_A8_UNORM",
            J[J.DXGI_FORMAT_R1_UNORM = 66] = "DXGI_FORMAT_R1_UNORM",
            J[J.DXGI_FORMAT_R9G9B9E5_SHAREDEXP = 67] = "DXGI_FORMAT_R9G9B9E5_SHAREDEXP",
            J[J.DXGI_FORMAT_R8G8_B8G8_UNORM = 68] = "DXGI_FORMAT_R8G8_B8G8_UNORM",
            J[J.DXGI_FORMAT_G8R8_G8B8_UNORM = 69] = "DXGI_FORMAT_G8R8_G8B8_UNORM",
            J[J.DXGI_FORMAT_BC1_TYPELESS = 70] = "DXGI_FORMAT_BC1_TYPELESS",
            J[J.DXGI_FORMAT_BC1_UNORM = 71] = "DXGI_FORMAT_BC1_UNORM",
            J[J.DXGI_FORMAT_BC1_UNORM_SRGB = 72] = "DXGI_FORMAT_BC1_UNORM_SRGB",
            J[J.DXGI_FORMAT_BC2_TYPELESS = 73] = "DXGI_FORMAT_BC2_TYPELESS",
            J[J.DXGI_FORMAT_BC2_UNORM = 74] = "DXGI_FORMAT_BC2_UNORM",
            J[J.DXGI_FORMAT_BC2_UNORM_SRGB = 75] = "DXGI_FORMAT_BC2_UNORM_SRGB",
            J[J.DXGI_FORMAT_BC3_TYPELESS = 76] = "DXGI_FORMAT_BC3_TYPELESS",
            J[J.DXGI_FORMAT_BC3_UNORM = 77] = "DXGI_FORMAT_BC3_UNORM",
            J[J.DXGI_FORMAT_BC3_UNORM_SRGB = 78] = "DXGI_FORMAT_BC3_UNORM_SRGB",
            J[J.DXGI_FORMAT_BC4_TYPELESS = 79] = "DXGI_FORMAT_BC4_TYPELESS",
            J[J.DXGI_FORMAT_BC4_UNORM = 80] = "DXGI_FORMAT_BC4_UNORM",
            J[J.DXGI_FORMAT_BC4_SNORM = 81] = "DXGI_FORMAT_BC4_SNORM",
            J[J.DXGI_FORMAT_BC5_TYPELESS = 82] = "DXGI_FORMAT_BC5_TYPELESS",
            J[J.DXGI_FORMAT_BC5_UNORM = 83] = "DXGI_FORMAT_BC5_UNORM",
            J[J.DXGI_FORMAT_BC5_SNORM = 84] = "DXGI_FORMAT_BC5_SNORM",
            J[J.DXGI_FORMAT_B5G6R5_UNORM = 85] = "DXGI_FORMAT_B5G6R5_UNORM",
            J[J.DXGI_FORMAT_B5G5R5A1_UNORM = 86] = "DXGI_FORMAT_B5G5R5A1_UNORM",
            J[J.DXGI_FORMAT_B8G8R8A8_UNORM = 87] = "DXGI_FORMAT_B8G8R8A8_UNORM",
            J[J.DXGI_FORMAT_B8G8R8X8_UNORM = 88] = "DXGI_FORMAT_B8G8R8X8_UNORM",
            J[J.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM = 89] = "DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",
            J[J.DXGI_FORMAT_B8G8R8A8_TYPELESS = 90] = "DXGI_FORMAT_B8G8R8A8_TYPELESS",
            J[J.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB = 91] = "DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",
            J[J.DXGI_FORMAT_B8G8R8X8_TYPELESS = 92] = "DXGI_FORMAT_B8G8R8X8_TYPELESS",
            J[J.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB = 93] = "DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",
            J[J.DXGI_FORMAT_BC6H_TYPELESS = 94] = "DXGI_FORMAT_BC6H_TYPELESS",
            J[J.DXGI_FORMAT_BC6H_UF16 = 95] = "DXGI_FORMAT_BC6H_UF16",
            J[J.DXGI_FORMAT_BC6H_SF16 = 96] = "DXGI_FORMAT_BC6H_SF16",
            J[J.DXGI_FORMAT_BC7_TYPELESS = 97] = "DXGI_FORMAT_BC7_TYPELESS",
            J[J.DXGI_FORMAT_BC7_UNORM = 98] = "DXGI_FORMAT_BC7_UNORM",
            J[J.DXGI_FORMAT_BC7_UNORM_SRGB = 99] = "DXGI_FORMAT_BC7_UNORM_SRGB",
            J[J.DXGI_FORMAT_AYUV = 100] = "DXGI_FORMAT_AYUV",
            J[J.DXGI_FORMAT_Y410 = 101] = "DXGI_FORMAT_Y410",
            J[J.DXGI_FORMAT_Y416 = 102] = "DXGI_FORMAT_Y416",
            J[J.DXGI_FORMAT_NV12 = 103] = "DXGI_FORMAT_NV12",
            J[J.DXGI_FORMAT_P010 = 104] = "DXGI_FORMAT_P010",
            J[J.DXGI_FORMAT_P016 = 105] = "DXGI_FORMAT_P016",
            J[J.DXGI_FORMAT_420_OPAQUE = 106] = "DXGI_FORMAT_420_OPAQUE",
            J[J.DXGI_FORMAT_YUY2 = 107] = "DXGI_FORMAT_YUY2",
            J[J.DXGI_FORMAT_Y210 = 108] = "DXGI_FORMAT_Y210",
            J[J.DXGI_FORMAT_Y216 = 109] = "DXGI_FORMAT_Y216",
            J[J.DXGI_FORMAT_NV11 = 110] = "DXGI_FORMAT_NV11",
            J[J.DXGI_FORMAT_AI44 = 111] = "DXGI_FORMAT_AI44",
            J[J.DXGI_FORMAT_IA44 = 112] = "DXGI_FORMAT_IA44",
            J[J.DXGI_FORMAT_P8 = 113] = "DXGI_FORMAT_P8",
            J[J.DXGI_FORMAT_A8P8 = 114] = "DXGI_FORMAT_A8P8",
            J[J.DXGI_FORMAT_B4G4R4A4_UNORM = 115] = "DXGI_FORMAT_B4G4R4A4_UNORM",
            J[J.DXGI_FORMAT_P208 = 116] = "DXGI_FORMAT_P208",
            J[J.DXGI_FORMAT_V208 = 117] = "DXGI_FORMAT_V208",
            J[J.DXGI_FORMAT_V408 = 118] = "DXGI_FORMAT_V408",
            J[J.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE = 119] = "DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",
            J[J.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE = 120] = "DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",
            J[J.DXGI_FORMAT_FORCE_UINT = 121] = "DXGI_FORMAT_FORCE_UINT",
            J
    }
    )(LC || {})
    , FC = ((J) => {
        return J[J.DDS_DIMENSION_TEXTURE1D = 2] = "DDS_DIMENSION_TEXTURE1D",
            J[J.DDS_DIMENSION_TEXTURE2D = 3] = "DDS_DIMENSION_TEXTURE2D",
            J[J.DDS_DIMENSION_TEXTURE3D = 6] = "DDS_DIMENSION_TEXTURE3D",
            J
    }
    )(FC || {});
function HJ(J) {
    return J.charCodeAt(0) + (J.charCodeAt(1) << 8) + (J.charCodeAt(2) << 16) + (J.charCodeAt(3) << 24)
}
var nJ = ((J) => {
    return J[J.UNKNOWN = 0] = "UNKNOWN",
        J[J.R8G8B8 = 20] = "R8G8B8",
        J[J.A8R8G8B8 = 21] = "A8R8G8B8",
        J[J.X8R8G8B8 = 22] = "X8R8G8B8",
        J[J.R5G6B5 = 23] = "R5G6B5",
        J[J.X1R5G5B5 = 24] = "X1R5G5B5",
        J[J.A1R5G5B5 = 25] = "A1R5G5B5",
        J[J.A4R4G4B4 = 26] = "A4R4G4B4",
        J[J.R3G3B2 = 27] = "R3G3B2",
        J[J.A8 = 28] = "A8",
        J[J.A8R3G3B2 = 29] = "A8R3G3B2",
        J[J.X4R4G4B4 = 30] = "X4R4G4B4",
        J[J.A2B10G10R10 = 31] = "A2B10G10R10",
        J[J.A8B8G8R8 = 32] = "A8B8G8R8",
        J[J.X8B8G8R8 = 33] = "X8B8G8R8",
        J[J.G16R16 = 34] = "G16R16",
        J[J.A2R10G10B10 = 35] = "A2R10G10B10",
        J[J.A16B16G16R16 = 36] = "A16B16G16R16",
        J[J.A8P8 = 40] = "A8P8",
        J[J.P8 = 41] = "P8",
        J[J.L8 = 50] = "L8",
        J[J.A8L8 = 51] = "A8L8",
        J[J.A4L4 = 52] = "A4L4",
        J[J.V8U8 = 60] = "V8U8",
        J[J.L6V5U5 = 61] = "L6V5U5",
        J[J.X8L8V8U8 = 62] = "X8L8V8U8",
        J[J.Q8W8V8U8 = 63] = "Q8W8V8U8",
        J[J.V16U16 = 64] = "V16U16",
        J[J.A2W10V10U10 = 67] = "A2W10V10U10",
        J[J.Q16W16V16U16 = 110] = "Q16W16V16U16",
        J[J.R16F = 111] = "R16F",
        J[J.G16R16F = 112] = "G16R16F",
        J[J.A16B16G16R16F = 113] = "A16B16G16R16F",
        J[J.R32F = 114] = "R32F",
        J[J.G32R32F = 115] = "G32R32F",
        J[J.A32B32G32R32F = 116] = "A32B32G32R32F",
        J[J.UYVY = HJ("UYVY")] = "UYVY",
        J[J.R8G8_B8G8 = HJ("RGBG")] = "R8G8_B8G8",
        J[J.YUY2 = HJ("YUY2")] = "YUY2",
        J[J.D3DFMT_G8R8_G8B8 = HJ("GRGB")] = "D3DFMT_G8R8_G8B8",
        J[J.DXT1 = HJ("DXT1")] = "DXT1",
        J[J.DXT2 = HJ("DXT2")] = "DXT2",
        J[J.DXT3 = HJ("DXT3")] = "DXT3",
        J[J.DXT4 = HJ("DXT4")] = "DXT4",
        J[J.DXT5 = HJ("DXT5")] = "DXT5",
        J[J.ATI1 = HJ("ATI1")] = "ATI1",
        J[J.AT1N = HJ("AT1N")] = "AT1N",
        J[J.ATI2 = HJ("ATI2")] = "ATI2",
        J[J.AT2N = HJ("AT2N")] = "AT2N",
        J[J.BC4U = HJ("BC4U")] = "BC4U",
        J[J.BC4S = HJ("BC4S")] = "BC4S",
        J[J.BC5U = HJ("BC5U")] = "BC5U",
        J[J.BC5S = HJ("BC5S")] = "BC5S",
        J[J.DX10 = HJ("DX10")] = "DX10",
        J
}
)(nJ || {})
    , rW = {
        [nJ.DXT1]: "bc1-rgba-unorm",
        [nJ.DXT2]: "bc2-rgba-unorm",
        [nJ.DXT3]: "bc2-rgba-unorm",
        [nJ.DXT4]: "bc3-rgba-unorm",
        [nJ.DXT5]: "bc3-rgba-unorm",
        [nJ.ATI1]: "bc4-r-unorm",
        [nJ.BC4U]: "bc4-r-unorm",
        [nJ.BC4S]: "bc4-r-snorm",
        [nJ.ATI2]: "bc5-rg-unorm",
        [nJ.BC5U]: "bc5-rg-unorm",
        [nJ.BC5S]: "bc5-rg-snorm",
        [36]: "rgba16uint",
        [110]: "rgba16sint",
        [111]: "r16float",
        [112]: "rg16float",
        [113]: "rgba16float",
        [114]: "r32float",
        [115]: "rg32float",
        [116]: "rgba32float"
    }
    , bJ = {
        [70]: "bc1-rgba-unorm",
        [71]: "bc1-rgba-unorm",
        [72]: "bc1-rgba-unorm-srgb",
        [73]: "bc2-rgba-unorm",
        [74]: "bc2-rgba-unorm",
        [75]: "bc2-rgba-unorm-srgb",
        [76]: "bc3-rgba-unorm",
        [77]: "bc3-rgba-unorm",
        [78]: "bc3-rgba-unorm-srgb",
        [79]: "bc4-r-unorm",
        [80]: "bc4-r-unorm",
        [81]: "bc4-r-snorm",
        [82]: "bc5-rg-unorm",
        [83]: "bc5-rg-unorm",
        [84]: "bc5-rg-snorm",
        [94]: "bc6h-rgb-ufloat",
        [95]: "bc6h-rgb-ufloat",
        [96]: "bc6h-rgb-float",
        [97]: "bc7-rgba-unorm",
        [98]: "bc7-rgba-unorm",
        [99]: "bc7-rgba-unorm-srgb",
        [28]: "rgba8unorm",
        [29]: "rgba8unorm-srgb",
        [87]: "bgra8unorm",
        [91]: "bgra8unorm-srgb",
        [41]: "r32float",
        [49]: "rg8unorm",
        [56]: "r16uint",
        [61]: "r8unorm",
        [24]: "rgb10a2unorm",
        [11]: "rgba16uint",
        [13]: "rgba16sint",
        [10]: "rgba16float",
        [54]: "r16float",
        [34]: "rg16float",
        [16]: "rg32float",
        [2]: "rgba32float"
    }
    , M8 = {
        MAGIC_VALUE: 542327876,
        MAGIC_SIZE: 4,
        HEADER_SIZE: 124,
        HEADER_DX10_SIZE: 20,
        PIXEL_FORMAT_FLAGS: {
            ALPHAPIXELS: 1,
            ALPHA: 2,
            FOURCC: 4,
            RGB: 64,
            RGBA: 65,
            YUV: 512,
            LUMINANCE: 131072,
            LUMINANCEA: 131073
        },
        RESOURCE_MISC_TEXTURECUBE: 4,
        HEADER_FIELDS: zc,
        HEADER_DX10_FIELDS: Wc,
        DXGI_FORMAT: LC,
        D3D10_RESOURCE_DIMENSION: FC,
        D3DFMT: nJ
    }
    , GC = {
        "bc1-rgba-unorm": 8,
        "bc1-rgba-unorm-srgb": 8,
        "bc2-rgba-unorm": 16,
        "bc2-rgba-unorm-srgb": 16,
        "bc3-rgba-unorm": 16,
        "bc3-rgba-unorm-srgb": 16,
        "bc4-r-unorm": 8,
        "bc4-r-snorm": 8,
        "bc5-rg-unorm": 16,
        "bc5-rg-snorm": 16,
        "bc6h-rgb-ufloat": 16,
        "bc6h-rgb-float": 16,
        "bc7-rgba-unorm": 16,
        "bc7-rgba-unorm-srgb": 16
    };
Q5();
w0();
function PC(J, Q) {
    let { format: Z, fourCC: $, width: q, height: K, dataOffset: V, mipmapCount: z } = Yc(J);
    if (!Q.includes(Z))
        throw new Error(`Unsupported texture format: ${$} ${Z}, supported: ${Q}`);
    if (z <= 1)
        return {
            format: Z,
            width: q,
            height: K,
            resource: [new Uint8Array(J, V)],
            alphaMode: "no-premultiply-alpha"
        };
    let W = Hc(Z, q, K, V, z, J);
    return {
        format: Z,
        width: q,
        height: K,
        resource: W,
        alphaMode: "no-premultiply-alpha"
    }
}
function Hc(J, Q, Z, $, q, K) {
    let V = []
        , z = GC[J]
        , W = Q
        , H = Z
        , Y = $;
    for (let U = 0; U < q; ++U) {
        let N = Math.ceil(Math.max(4, W) / 4) * 4
            , j = Math.ceil(Math.max(4, H) / 4) * 4
            , k = z ? N / 4 * j / 4 * z : W * H * 4
            , L = new Uint8Array(K, Y, k);
        V.push(L),
            Y += k,
            W = Math.max(W >> 1, 1),
            H = Math.max(H >> 1, 1)
    }
    return V
}
function Yc(J) {
    let Q = new Uint32Array(J, 0, M8.HEADER_SIZE / Uint32Array.BYTES_PER_ELEMENT);
    if (Q[M8.HEADER_FIELDS.MAGIC] !== M8.MAGIC_VALUE)
        throw new Error("Invalid magic number in DDS header");
    let Z = Q[M8.HEADER_FIELDS.HEIGHT]
        , $ = Q[M8.HEADER_FIELDS.WIDTH]
        , q = Math.max(1, Q[M8.HEADER_FIELDS.MIPMAP_COUNT])
        , K = Q[M8.HEADER_FIELDS.PF_FLAGS]
        , V = Q[M8.HEADER_FIELDS.FOURCC]
        , z = Xc(Q, K, V, J)
        , W = M8.MAGIC_SIZE + M8.HEADER_SIZE + (V === M8.D3DFMT.DX10 ? M8.HEADER_DX10_SIZE : 0);
    return {
        format: z,
        fourCC: V,
        width: $,
        height: Z,
        dataOffset: W,
        mipmapCount: q
    }
}
function Xc(J, Q, Z, $) {
    if (Q & M8.PIXEL_FORMAT_FLAGS.FOURCC) {
        if (Z === M8.D3DFMT.DX10) {
            let q = new Uint32Array($, M8.MAGIC_SIZE + M8.HEADER_SIZE, M8.HEADER_DX10_SIZE / Uint32Array.BYTES_PER_ELEMENT);
            if (q[M8.HEADER_DX10_FIELDS.MISC_FLAG] === M8.RESOURCE_MISC_TEXTURECUBE)
                throw new Error("DDSParser does not support cubemap textures");
            if (q[M8.HEADER_DX10_FIELDS.RESOURCE_DIMENSION] === M8.D3D10_RESOURCE_DIMENSION.DDS_DIMENSION_TEXTURE3D)
                throw new Error("DDSParser does not supported 3D texture data");
            let z = q[M8.HEADER_DX10_FIELDS.DXGI_FORMAT];
            if (z in bJ)
                return bJ[z];
            throw new Error(`DDSParser cannot parse texture data with DXGI format ${z}`)
        }
        if (Z in rW)
            return rW[Z];
        throw new Error(`DDSParser cannot parse texture data with fourCC format ${Z}`)
    }
    if (Q & M8.PIXEL_FORMAT_FLAGS.RGB || Q & M8.PIXEL_FORMAT_FLAGS.RGBA)
        return Uc(J);
    if (Q & M8.PIXEL_FORMAT_FLAGS.YUV)
        throw new Error("DDSParser does not supported YUV uncompressed texture data.");
    if (Q & M8.PIXEL_FORMAT_FLAGS.LUMINANCE || Q & M8.PIXEL_FORMAT_FLAGS.LUMINANCEA)
        throw new Error("DDSParser does not support single-channel (lumninance) texture data!");
    if (Q & M8.PIXEL_FORMAT_FLAGS.ALPHA || Q & M8.PIXEL_FORMAT_FLAGS.ALPHAPIXELS)
        throw new Error("DDSParser does not support single-channel (alpha) texture data!");
    throw new Error("DDSParser failed to load a texture file due to an unknown reason!")
}
function Uc(J) {
    let Q = J[M8.HEADER_FIELDS.RGB_BITCOUNT]
        , Z = J[M8.HEADER_FIELDS.R_BIT_MASK]
        , $ = J[M8.HEADER_FIELDS.G_BIT_MASK]
        , q = J[M8.HEADER_FIELDS.B_BIT_MASK]
        , K = J[M8.HEADER_FIELDS.A_BIT_MASK];
    switch (Q) {
        case 32:
            if (Z === 255 && $ === 65280 && q === 16711680 && K === 4278190080)
                return bJ[M8.DXGI_FORMAT.DXGI_FORMAT_R8G8B8A8_UNORM];
            if (Z === 16711680 && $ === 65280 && q === 255 && K === 4278190080)
                return bJ[M8.DXGI_FORMAT.DXGI_FORMAT_B8G8R8A8_UNORM];
            if (Z === 1072693248 && $ === 1047552 && q === 1023 && K === 3221225472)
                return bJ[M8.DXGI_FORMAT.DXGI_FORMAT_R10G10B10A2_UNORM];
            if (Z === 65535 && $ === 4294901760 && q === 0 && K === 0)
                return bJ[M8.DXGI_FORMAT.DXGI_FORMAT_R16G16_UNORM];
            if (Z === 4294967295 && $ === 0 && q === 0 && K === 0)
                return bJ[M8.DXGI_FORMAT.DXGI_FORMAT_R32_FLOAT];
            break;
        case 24:
            break;
        case 16:
            if (Z === 31744 && $ === 992 && q === 31 && K === 32768)
                return bJ[M8.DXGI_FORMAT.DXGI_FORMAT_B5G5R5A1_UNORM];
            if (Z === 63488 && $ === 2016 && q === 31 && K === 0)
                return bJ[M8.DXGI_FORMAT.DXGI_FORMAT_B5G6R5_UNORM];
            if (Z === 3840 && $ === 240 && q === 15 && K === 61440)
                return bJ[M8.DXGI_FORMAT.DXGI_FORMAT_B4G4R4A4_UNORM];
            if (Z === 255 && $ === 0 && q === 0 && K === 65280)
                return bJ[M8.DXGI_FORMAT.DXGI_FORMAT_R8G8_UNORM];
            if (Z === 65535 && $ === 0 && q === 0 && K === 0)
                return bJ[M8.DXGI_FORMAT.DXGI_FORMAT_R16_UNORM];
            break;
        case 8:
            if (Z === 255 && $ === 0 && q === 0 && K === 0)
                return bJ[M8.DXGI_FORMAT.DXGI_FORMAT_R8_UNORM];
            break
    }
    throw new Error(`DDSParser does not support uncompressed texture with configuration:
                bitCount = ${Q}, rBitMask = ${Z}, gBitMask = ${$}, aBitMask = ${K}`)
}
var e_ = {
    extension: {
        type: R.LoadParser,
        priority: X7.High,
        name: "loadDDS"
    },
    name: "loadDDS",
    id: "dds",
    test(J) {
        return O7(J, [".dds"])
    },
    async load(J, Q, Z) {
        let $ = await p9()
            , K = await (await fetch(J)).arrayBuffer()
            , V = PC(K, $)
            , z = new H9(V);
        return RJ(z, Z, J)
    },
    unload(J) {
        if (Array.isArray(J))
            J.forEach((Q) => Q.destroy(!0));
        else
            J.destroy(!0)
    }
};
Q5();
w0();
var Nc = {
    [33776]: "bc1-rgba-unorm",
    [33777]: "bc1-rgba-unorm",
    [33778]: "bc2-rgba-unorm",
    [33779]: "bc3-rgba-unorm",
    [35916]: "bc1-rgba-unorm-srgb",
    [35917]: "bc1-rgba-unorm-srgb",
    [35918]: "bc2-rgba-unorm-srgb",
    [35919]: "bc3-rgba-unorm-srgb",
    [36283]: "bc4-r-unorm",
    [36284]: "bc4-r-snorm",
    [36285]: "bc5-rg-unorm",
    [36286]: "bc5-rg-snorm",
    [37488]: "eac-r11unorm",
    [37490]: "eac-rg11snorm",
    [37492]: "etc2-rgb8unorm",
    [37496]: "etc2-rgba8unorm",
    [37493]: "etc2-rgb8unorm-srgb",
    [37497]: "etc2-rgba8unorm-srgb",
    [37494]: "etc2-rgb8a1unorm",
    [37495]: "etc2-rgb8a1unorm-srgb",
    [37808]: "astc-4x4-unorm",
    [37840]: "astc-4x4-unorm-srgb",
    [37809]: "astc-5x4-unorm",
    [37841]: "astc-5x4-unorm-srgb",
    [37810]: "astc-5x5-unorm",
    [37842]: "astc-5x5-unorm-srgb",
    [37811]: "astc-6x5-unorm",
    [37843]: "astc-6x5-unorm-srgb",
    [37812]: "astc-6x6-unorm",
    [37844]: "astc-6x6-unorm-srgb",
    [37813]: "astc-8x5-unorm",
    [37845]: "astc-8x5-unorm-srgb",
    [37814]: "astc-8x6-unorm",
    [37846]: "astc-8x6-unorm-srgb",
    [37815]: "astc-8x8-unorm",
    [37847]: "astc-8x8-unorm-srgb",
    [37816]: "astc-10x5-unorm",
    [37848]: "astc-10x5-unorm-srgb",
    [37817]: "astc-10x6-unorm",
    [37849]: "astc-10x6-unorm-srgb",
    [37818]: "astc-10x8-unorm",
    [37850]: "astc-10x8-unorm-srgb",
    [37819]: "astc-10x10-unorm",
    [37851]: "astc-10x10-unorm-srgb",
    [37820]: "astc-12x10-unorm",
    [37852]: "astc-12x10-unorm-srgb",
    [37821]: "astc-12x12-unorm",
    [37853]: "astc-12x12-unorm-srgb",
    [36492]: "bc7-rgba-unorm",
    [36493]: "bc7-rgba-unorm-srgb",
    [36494]: "bc6h-rgb-float",
    [36495]: "bc6h-rgb-ufloat",
    [35907]: "rgba8unorm-srgb",
    [36759]: "rgba8snorm",
    [36220]: "rgba8uint",
    [36238]: "rgba8sint",
    [6408]: "rgba8unorm"
}
    , wc = [171, 75, 84, 88, 32, 49, 49, 187, 13, 10, 26, 10]
    , jc = {
        FILE_IDENTIFIER: 0,
        ENDIANNESS: 12,
        GL_TYPE: 16,
        GL_TYPE_SIZE: 20,
        GL_FORMAT: 24,
        GL_INTERNAL_FORMAT: 28,
        GL_BASE_INTERNAL_FORMAT: 32,
        PIXEL_WIDTH: 36,
        PIXEL_HEIGHT: 40,
        PIXEL_DEPTH: 44,
        NUMBER_OF_ARRAY_ELEMENTS: 48,
        NUMBER_OF_FACES: 52,
        NUMBER_OF_MIPMAP_LEVELS: 56,
        BYTES_OF_KEY_VALUE_DATA: 60
    }
    , Bc = 64
    , kc = 67305985
    , Cc = {
        [5121]: 1,
        [5123]: 2,
        [5124]: 4,
        [5125]: 4,
        [5126]: 4,
        [36193]: 8
    }
    , Oc = {
        [6408]: 4,
        [6407]: 3,
        [33319]: 2,
        [6403]: 1,
        [6409]: 1,
        [6410]: 2,
        [6406]: 1
    }
    , Ic = {
        [32819]: 2,
        [32820]: 2,
        [33635]: 2
    }
    , Lc = {
        [33776]: 0.5,
        [33777]: 0.5,
        [33778]: 1,
        [33779]: 1,
        [35916]: 0.5,
        [35917]: 0.5,
        [35918]: 1,
        [35919]: 1,
        [36283]: 0.5,
        [36284]: 0.5,
        [36285]: 1,
        [36286]: 1,
        [37488]: 0.5,
        [37489]: 0.5,
        [37490]: 1,
        [37491]: 1,
        [37492]: 0.5,
        [37496]: 1,
        [37493]: 0.5,
        [37497]: 1,
        [37494]: 0.5,
        [37495]: 0.5,
        [37808]: 1,
        [37840]: 1,
        [37809]: 0.8,
        [37841]: 0.8,
        [37810]: 0.64,
        [37842]: 0.64,
        [37811]: 0.53375,
        [37843]: 0.53375,
        [37812]: 0.445,
        [37844]: 0.445,
        [37813]: 0.4,
        [37845]: 0.4,
        [37814]: 0.33375,
        [37846]: 0.33375,
        [37815]: 0.25,
        [37847]: 0.25,
        [37816]: 0.32,
        [37848]: 0.32,
        [37817]: 0.26625,
        [37849]: 0.26625,
        [37818]: 0.2,
        [37850]: 0.2,
        [37819]: 0.16,
        [37851]: 0.16,
        [37820]: 0.13375,
        [37852]: 0.13375,
        [37821]: 0.11125,
        [37853]: 0.11125,
        [36492]: 1,
        [36493]: 1,
        [36494]: 1,
        [36495]: 1
    }
    , I7 = {
        FILE_HEADER_SIZE: Bc,
        FILE_IDENTIFIER: wc,
        FORMATS_TO_COMPONENTS: Oc,
        INTERNAL_FORMAT_TO_BYTES_PER_PIXEL: Lc,
        INTERNAL_FORMAT_TO_TEXTURE_FORMATS: Nc,
        FIELDS: jc,
        TYPES_TO_BYTES_PER_COMPONENT: Cc,
        TYPES_TO_BYTES_PER_PIXEL: Ic,
        ENDIANNESS: kc
    };
function DC(J, Q) {
    let Z = new DataView(J);
    if (!Dc(Z))
        throw new Error("Invalid KTX identifier in header");
    let { littleEndian: $, glType: q, glFormat: K, glInternalFormat: V, pixelWidth: z, pixelHeight: W, numberOfMipmapLevels: H, offset: Y } = Pc(Z)
        , U = I7.INTERNAL_FORMAT_TO_TEXTURE_FORMATS[V];
    if (!U)
        throw new Error(`Unknown texture format ${V}`);
    if (!Q.includes(U))
        throw new Error(`Unsupported texture format: ${U}, supportedFormats: ${Q}`);
    let N = Gc(q, K, V)
        , j = Fc(Z, q, N, z, W, Y, H, $);
    return {
        format: U,
        width: z,
        height: W,
        resource: j,
        alphaMode: "no-premultiply-alpha"
    }
}
function Fc(J, Q, Z, $, q, K, V, z) {
    let W = $ + 3 & -4
        , H = q + 3 & -4
        , Y = $ * q;
    if (Q === 0)
        Y = W * H;
    let U = Y * Z
        , N = $
        , j = q
        , k = W
        , L = H
        , F = K
        , P = new Array(V);
    for (let M = 0; M < V; M++) {
        let v = J.getUint32(F, z)
            , E = F + 4;
        P[M] = new Uint8Array(J.buffer, E, U),
            E += U,
            F += v + 4,
            F = F % 4 !== 0 ? F + 4 - F % 4 : F,
            N = N >> 1 || 1,
            j = j >> 1 || 1,
            k = N + 4 - 1 & -4,
            L = j + 4 - 1 & -4,
            U = k * L * Z
    }
    return P
}
function Gc(J, Q, Z) {
    let $ = I7.INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[Z];
    if (J !== 0)
        if (I7.TYPES_TO_BYTES_PER_COMPONENT[J])
            $ = I7.TYPES_TO_BYTES_PER_COMPONENT[J] * I7.FORMATS_TO_COMPONENTS[Q];
        else
            $ = I7.TYPES_TO_BYTES_PER_PIXEL[J];
    if ($ === void 0)
        throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");
    return $
}
function Pc(J) {
    let Q = J.getUint32(I7.FIELDS.ENDIANNESS, !0) === I7.ENDIANNESS
        , Z = J.getUint32(I7.FIELDS.GL_TYPE, Q)
        , $ = J.getUint32(I7.FIELDS.GL_FORMAT, Q)
        , q = J.getUint32(I7.FIELDS.GL_INTERNAL_FORMAT, Q)
        , K = J.getUint32(I7.FIELDS.PIXEL_WIDTH, Q)
        , V = J.getUint32(I7.FIELDS.PIXEL_HEIGHT, Q) || 1
        , z = J.getUint32(I7.FIELDS.PIXEL_DEPTH, Q) || 1
        , W = J.getUint32(I7.FIELDS.NUMBER_OF_ARRAY_ELEMENTS, Q) || 1
        , H = J.getUint32(I7.FIELDS.NUMBER_OF_FACES, Q)
        , Y = J.getUint32(I7.FIELDS.NUMBER_OF_MIPMAP_LEVELS, Q)
        , U = J.getUint32(I7.FIELDS.BYTES_OF_KEY_VALUE_DATA, Q);
    if (V === 0 || z !== 1)
        throw new Error("Only 2D textures are supported");
    if (H !== 1)
        throw new Error("CubeTextures are not supported by KTXLoader yet!");
    if (W !== 1)
        throw new Error("WebGL does not support array textures");
    return {
        littleEndian: Q,
        glType: Z,
        glFormat: $,
        glInternalFormat: q,
        pixelWidth: K,
        pixelHeight: V,
        numberOfMipmapLevels: Y,
        offset: I7.FILE_HEADER_SIZE + U
    }
}
function Dc(J) {
    for (let Q = 0; Q < I7.FILE_IDENTIFIER.length; Q++)
        if (J.getUint8(Q) !== I7.FILE_IDENTIFIER[Q])
            return !1;
    return !0
}
var JR = {
    extension: {
        type: R.LoadParser,
        priority: X7.High,
        name: "loadKTX"
    },
    name: "loadKTX",
    id: "ktx",
    test(J) {
        return O7(J, ".ktx")
    },
    async load(J, Q, Z) {
        let $ = await p9()
            , K = await (await fetch(J)).arrayBuffer()
            , V = DC(K, $)
            , z = new H9(V);
        return RJ(z, Z, J)
    },
    unload(J) {
        if (Array.isArray(J))
            J.forEach((Q) => Q.destroy(!0));
        else
            J.destroy(!0)
    }
};
Q5();
w0();
var Z4 = null;
class AC {
    constructor() {
        if (!Z4)
            Z4 = URL.createObjectURL(new Blob([`(function () {
    'use strict';

    const converters = {
      rgb8unorm: {
        convertedFormat: "rgba8unorm",
        convertFunction: convertRGBtoRGBA
      },
      "rgb8unorm-srgb": {
        convertedFormat: "rgba8unorm-srgb",
        convertFunction: convertRGBtoRGBA
      }
    };
    function convertFormatIfRequired(textureOptions) {
      const format = textureOptions.format;
      if (converters[format]) {
        const convertFunction = converters[format].convertFunction;
        const levelBuffers = textureOptions.resource;
        for (let i = 0; i < levelBuffers.length; i++) {
          levelBuffers[i] = convertFunction(levelBuffers[i]);
        }
        textureOptions.format = converters[format].convertedFormat;
      }
    }
    function convertRGBtoRGBA(levelBuffer) {
      const pixelCount = levelBuffer.byteLength / 3;
      const levelBufferWithAlpha = new Uint32Array(pixelCount);
      for (let i = 0; i < pixelCount; ++i) {
        levelBufferWithAlpha[i] = levelBuffer[i * 3] + (levelBuffer[i * 3 + 1] << 8) + (levelBuffer[i * 3 + 2] << 16) + 4278190080;
      }
      return new Uint8Array(levelBufferWithAlpha.buffer);
    }

    function createLevelBuffersFromKTX(ktxTexture) {
      const levelBuffers = [];
      for (let i = 0; i < ktxTexture.numLevels; i++) {
        const imageData = ktxTexture.getImageData(i, 0, 0);
        const levelBuffer = new Uint8Array(imageData.byteLength);
        levelBuffer.set(imageData);
        levelBuffers.push(levelBuffer);
      }
      return levelBuffers;
    }

    const glFormatToGPUFormatMap = {
      6408: "rgba8unorm",
      32856: "bgra8unorm",
      //
      32857: "rgb10a2unorm",
      33189: "depth16unorm",
      33190: "depth24plus",
      33321: "r8unorm",
      33323: "rg8unorm",
      33325: "r16float",
      33326: "r32float",
      33327: "rg16float",
      33328: "rg32float",
      33329: "r8sint",
      33330: "r8uint",
      33331: "r16sint",
      33332: "r16uint",
      33333: "r32sint",
      33334: "r32uint",
      33335: "rg8sint",
      33336: "rg8uint",
      33337: "rg16sint",
      33338: "rg16uint",
      33339: "rg32sint",
      33340: "rg32uint",
      33778: "bc2-rgba-unorm",
      33779: "bc3-rgba-unorm",
      34836: "rgba32float",
      34842: "rgba16float",
      35056: "depth24plus-stencil8",
      35898: "rg11b10ufloat",
      35901: "rgb9e5ufloat",
      35907: "rgba8unorm-srgb",
      // bgra8unorm-srgb
      36012: "depth32float",
      36013: "depth32float-stencil8",
      36168: "stencil8",
      36208: "rgba32uint",
      36214: "rgba16uint",
      36220: "rgba8uint",
      36226: "rgba32sint",
      36232: "rgba16sint",
      36238: "rgba8sint",
      36492: "bc7-rgba-unorm",
      36756: "r8snorm",
      36757: "rg8snorm",
      36759: "rgba8snorm",
      37496: "etc2-rgba8unorm",
      37808: "astc-4x4-unorm"
    };
    function glFormatToGPUFormat(glInternalFormat) {
      const format = glFormatToGPUFormatMap[glInternalFormat];
      if (format) {
        return format;
      }
      throw new Error(\`Unsupported glInternalFormat: \${glInternalFormat}\`);
    }

    const vkFormatToGPUFormatMap = {
      23: "rgb8unorm",
      // VK_FORMAT_R8G8B8_UNORM
      37: "rgba8unorm",
      // VK_FORMAT_R8G8B8A8_UNORM
      43: "rgba8unorm-srgb"
      // VK_FORMAT_R8G8B8A8_SRGB
      // TODO add more!
    };
    function vkFormatToGPUFormat(vkFormat) {
      const format = vkFormatToGPUFormatMap[vkFormat];
      if (format) {
        return format;
      }
      throw new Error(\`Unsupported VkFormat: \${vkFormat}\`);
    }

    function getTextureFormatFromKTXTexture(ktxTexture) {
      if (ktxTexture.classId === 2) {
        return vkFormatToGPUFormat(ktxTexture.vkFormat);
      }
      return glFormatToGPUFormat(ktxTexture.glInternalformat);
    }

    const gpuFormatToBasisTranscoderFormatMap = {
      "bc3-rgba-unorm": "BC3_RGBA",
      "bc7-rgba-unorm": "BC7_M5_RGBA",
      "etc2-rgba8unorm": "ETC2_RGBA",
      "astc-4x4-unorm": "ASTC_4x4_RGBA",
      // Uncompressed
      rgba8unorm: "RGBA32",
      rg11b10ufloat: "R11F_G11F_B10F"
    };
    function gpuFormatToKTXBasisTranscoderFormat(transcoderFormat) {
      const format = gpuFormatToBasisTranscoderFormatMap[transcoderFormat];
      if (format) {
        return format;
      }
      throw new Error(\`Unsupported transcoderFormat: \${transcoderFormat}\`);
    }

    const settings = {
      jsUrl: "",
      wasmUrl: ""
    };
    let basisTranscoderFormat;
    let basisTranscodedTextureFormat;
    let ktxPromise;
    async function getKTX() {
      if (!ktxPromise) {
        const absoluteJsUrl = new URL(settings.jsUrl, location.origin).href;
        const absoluteWasmUrl = new URL(settings.wasmUrl, location.origin).href;
        importScripts(absoluteJsUrl);
        ktxPromise = new Promise((resolve) => {
          LIBKTX({
            locateFile: (_file) => absoluteWasmUrl
          }).then((libktx) => {
            resolve(libktx);
          });
        });
      }
      return ktxPromise;
    }
    async function fetchKTXTexture(url, ktx) {
      const ktx2Response = await fetch(url);
      if (ktx2Response.ok) {
        const ktx2ArrayBuffer = await ktx2Response.arrayBuffer();
        return new ktx.ktxTexture(new Uint8Array(ktx2ArrayBuffer));
      }
      throw new Error(\`Failed to load KTX(2) texture: \${url}\`);
    }
    const preferredTranscodedFormat = [
      "bc7-rgba-unorm",
      "astc-4x4-unorm",
      "etc2-rgba8unorm",
      "bc3-rgba-unorm",
      "rgba8unorm"
    ];
    async function load(url) {
      const ktx = await getKTX();
      const ktxTexture = await fetchKTXTexture(url, ktx);
      let format;
      if (ktxTexture.needsTranscoding) {
        format = basisTranscodedTextureFormat;
        const transcodeFormat = ktx.TranscodeTarget[basisTranscoderFormat];
        const result = ktxTexture.transcodeBasis(transcodeFormat, 0);
        if (result !== ktx.ErrorCode.SUCCESS) {
          throw new Error("Unable to transcode basis texture.");
        }
      } else {
        format = getTextureFormatFromKTXTexture(ktxTexture);
      }
      const levelBuffers = createLevelBuffersFromKTX(ktxTexture);
      const textureOptions = {
        width: ktxTexture.baseWidth,
        height: ktxTexture.baseHeight,
        format,
        mipLevelCount: ktxTexture.numLevels,
        resource: levelBuffers,
        alphaMode: "no-premultiply-alpha"
      };
      convertFormatIfRequired(textureOptions);
      return textureOptions;
    }
    async function init(jsUrl, wasmUrl, supportedTextures) {
      if (jsUrl)
        settings.jsUrl = jsUrl;
      if (wasmUrl)
        settings.wasmUrl = wasmUrl;
      basisTranscodedTextureFormat = preferredTranscodedFormat.filter((format) => supportedTextures.includes(format))[0];
      basisTranscoderFormat = gpuFormatToKTXBasisTranscoderFormat(basisTranscodedTextureFormat);
      await getKTX();
    }
    const messageHandlers = {
      init: async (data) => {
        const { jsUrl, wasmUrl, supportedTextures } = data;
        await init(jsUrl, wasmUrl, supportedTextures);
      },
      load: async (data) => {
        try {
          const textureOptions = await load(data.url);
          return {
            type: "load",
            url: data.url,
            success: true,
            textureOptions,
            transferables: textureOptions.resource?.map((arr) => arr.buffer)
          };
        } catch (e) {
          throw e;
        }
      }
    };
    self.onmessage = async (messageEvent) => {
      const message = messageEvent.data;
      const response = await messageHandlers[message.type]?.(message);
      if (response) {
        self.postMessage(response, response.transferables);
      }
    };

})();
`], {
                type: "application/javascript"
            }));
        this.worker = new Worker(Z4)
    }
}
AC.revokeObjectURL = function J() {
    if (Z4)
        URL.revokeObjectURL(Z4),
            Z4 = null
}
    ;
var tW = {
    jsUrl: "https://files.pixijs.download/transcoders/ktx/libktx.js",
    wasmUrl: "https://files.pixijs.download/transcoders/ktx/libktx.wasm"
};
var eW, QR = {};
function Ac(J) {
    if (!eW)
        eW = new AC().worker,
            eW.onmessage = (Q) => {
                let { success: Z, url: $, textureOptions: q } = Q.data;
                QR[$](q)
            }
            ,
            eW.postMessage({
                type: "init",
                jsUrl: tW.jsUrl,
                wasmUrl: tW.wasmUrl,
                supportedTextures: J
            });
    return eW
}
function EC(J, Q) {
    let Z = Ac(Q);
    return new Promise(($) => {
        QR[J] = $,
            Z.postMessage({
                type: "load",
                url: J
            })
    }
    )
}
var ZR = {
    extension: {
        type: R.LoadParser,
        priority: X7.High,
        name: "loadKTX2"
    },
    name: "loadKTX2",
    id: "ktx2",
    test(J) {
        return O7(J, ".ktx2")
    },
    async load(J, Q, Z) {
        let $ = await p9()
            , q = await EC(J, $)
            , K = new H9(q);
        return RJ(K, Z, J)
    },
    async unload(J) {
        if (Array.isArray(J))
            J.forEach((Q) => Q.destroy(!0));
        else
            J.destroy(!0)
    }
};
w0();
BQ();
w0();
var $4 = ["basis", "bc7", "bc6h", "astc", "etc2", "bc5", "bc4", "bc3", "bc2", "bc1", "eac"]
    , KR = {
        extension: R.ResolveParser,
        test: (J) => O7(J, [".ktx", ".ktx2", ".dds"]),
        parse: (J) => {
            let Q, Z = J.split(".");
            if (Z.length > 2) {
                let $ = Z[Z.length - 2];
                if ($4.includes($))
                    Q = $
            } else
                Q = Z[Z.length - 1];
            return {
                resolution: parseFloat(AJ.RETINA_PREFIX.exec(J)?.[1] ?? "1"),
                format: Q,
                src: J
            }
        }
    };
var MC, VR = {
    extension: {
        type: R.DetectionParser,
        priority: 2
    },
    test: async () => {
        if (await m9())
            return !0;
        if (g9())
            return !0;
        return !1
    }
    ,
    add: async (J) => {
        let Q = await J4();
        return MC = Ec(Q),
            [...MC, ...J]
    }
    ,
    remove: async (J) => {
        if (MC)
            return J.filter((Q) => !(Q in MC));
        return J
    }
};
function Ec(J) {
    let Q = ["basis"]
        , Z = {};
    return J.forEach(($) => {
        let q = $.split("-")[0];
        if (q && !Z[q])
            Z[q] = !0,
                Q.push(q)
    }
    ),
        Q.sort(($, q) => {
            let K = $4.indexOf($)
                , V = $4.indexOf(q);
            if (K === -1)
                return 1;
            if (V === -1)
                return -1;
            return K - V
        }
        ),
        Q
}
VJ();
aQ();
var hc = new E6
    , vG = class J {
        cull(Q, Z, $ = !0) {
            this._cullRecursive(Q, Z, $)
        }
        _cullRecursive(Q, Z, $ = !0) {
            if (Q.cullable && Q.measurable && Q.includeInBuild) {
                let q = Q.cullArea ?? D9(Q, $, hc);
                Q.culled = q.x >= Z.x + Z.width || q.y >= Z.y + Z.height || q.x + q.width <= Z.x || q.y + q.height <= Z.y
            } else
                Q.culled = !1;
            if (!Q.cullableChildren || Q.culled || !Q.renderable || !Q.measurable || !Q.includeInBuild)
                return;
            for (let q = 0; q < Q.children.length; q++)
                this._cullRecursive(Q.children[q], Z, $)
        }
    }
    ;
vG.shared = new vG;
var _C = vG;
w0();
class RC {
    static init(J) {
        this._renderRef = this.render.bind(this),
            this.render = () => {
                let Q = J?.culler?.updateTransform !== !0;
                _C.shared.cull(this.stage, this.renderer.screen, Q),
                    this.renderer.render({
                        container: this.stage
                    })
            }
    }
    static destroy() {
        this.render = this._renderRef
    }
}
RC.extension = {
    priority: 10,
    type: R.Application,
    name: "culler"
};
uY();
LF();
M6();
ew();
dX();
var Jb = uG();
var { DOMImplementation: xd, XMLSerializer: gd } = Jb
    , Qb = eR().DOMParser;
fX();
vV();
EV();
o1();
xX();
a1();
MV();
_V();
w0();
lJ();
Z5();
_7();
z9();
var l$ = `in vec2 aPosition;
out vec2 vTextureCoord;

uniform vec4 uInputSize;
uniform vec4 uOutputFrame;
uniform vec4 uOutputTexture;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;
    
    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (uOutputFrame.zw * uInputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;
var gC = `
in vec2 vTextureCoord;

out vec4 finalColor;

uniform float uAlpha;
uniform sampler2D uTexture;

void main()
{
    finalColor =  texture(uTexture, vTextureCoord) * uAlpha;
}
`;
var XH = `struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct AlphaUniforms {
  uAlpha:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> alphaUniforms : AlphaUniforms;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}

@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {
 
    var sample = textureSample(uTexture, uSampler, uv);
    
    return sample * alphaUniforms.uAlpha;
}`;
var cd = class J extends _J {
    constructor(Q) {
        Q = {
            ...J.defaultOptions,
            ...Q
        };
        let Z = B7.from({
            vertex: {
                source: XH,
                entryPoint: "mainVertex"
            },
            fragment: {
                source: XH,
                entryPoint: "mainFragment"
            }
        })
            , $ = j7.from({
                vertex: l$,
                fragment: gC,
                name: "alpha-filter"
            })
            , { alpha: q, ...K } = Q
            , V = new Y6({
                uAlpha: {
                    value: q,
                    type: "f32"
                }
            });
        super({
            ...K,
            gpuProgram: Z,
            glProgram: $,
            resources: {
                alphaUniforms: V
            }
        })
    }
    get alpha() {
        return this.resources.alphaUniforms.uniforms.uAlpha
    }
    set alpha(Q) {
        this.resources.alphaUniforms.uniforms.uAlpha = Q
    }
}
    ;
cd.defaultOptions = {
    alpha: 1
};
E5();
$5();
O6();
z9();
E5();
$5();
z9();
lJ();
var U4 = {
    5: [0.153388, 0.221461, 0.250301],
    7: [0.071303, 0.131514, 0.189879, 0.214607],
    9: [0.028532, 0.067234, 0.124009, 0.179044, 0.20236],
    11: [0.0093, 0.028002, 0.065984, 0.121703, 0.175713, 0.198596],
    13: [0.002406, 0.009255, 0.027867, 0.065666, 0.121117, 0.174868, 0.197641],
    15: [0.000489, 0.002403, 0.009246, 0.02784, 0.065602, 0.120999, 0.174697, 0.197448]
};
var dd = ["in vec2 vBlurTexCoords[%size%];", "uniform sampler2D uTexture;", "out vec4 finalColor;", "void main(void)", "{", "    finalColor = vec4(0.0);", "    %blur%", "}"].join(`
`);
function mC(J) {
    let Q = U4[J], Z = Q.length, $ = dd, q = "", K = "finalColor += texture(uTexture, vBlurTexCoords[%index%]) * %value%;", V;
    for (let z = 0; z < J; z++) {
        let W = K.replace("%index%", z.toString());
        if (V = z,
            z >= Z)
            V = J - z - 1;
        W = W.replace("%value%", Q[V].toString()),
            q += W,
            q += `
`
    }
    return $ = $.replace("%blur%", q),
        $ = $.replace("%size%", J.toString()),
        $
}
function cC(J, Q) {
    let Z = Math.ceil(J / 2), $ = `
    in vec2 aPosition;

    uniform float uStrength;

    out vec2 vBlurTexCoords[%size%];

    uniform vec4 uInputSize;
    uniform vec4 uOutputFrame;
    uniform vec4 uOutputTexture;

    vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;

    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

    vec2 filterTextureCoord( void )
    {
        return aPosition * (uOutputFrame.zw * uInputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        float pixelStrength = uInputSize.%dimension% * uStrength;

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`, q = "", K;
    if (Q)
        K = "vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * pixelStrength, 0.0);";
    else
        K = "vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * pixelStrength);";
    for (let V = 0; V < J; V++) {
        let z = K.replace("%index%", V.toString());
        z = z.replace("%sampleIndex%", `${V - (Z - 1)}.0`),
            q += z,
            q += `
`
    }
    return $ = $.replace("%blur%", q),
        $ = $.replace("%size%", J.toString()),
        $ = $.replace("%dimension%", Q ? "z" : "w"),
        $
}
function dC(J, Q) {
    let Z = cC(Q, J)
        , $ = mC(Q);
    return j7.from({
        vertex: Z,
        fragment: $,
        name: `blur-${J ? "horizontal" : "vertical"}-pass-filter`
    })
}
Z5();
var pC = `

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct BlurUniforms {
  uStrength:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> blurUniforms : BlurUniforms;


struct VSOutput {
    @builtin(position) position: vec4<f32>,
    %blur-struct%
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}


@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {

  let filteredCord = filterTextureCoord(aPosition);

  let pixelStrength = gfu.uInputSize.%dimension% * blurUniforms.uStrength;

  return VSOutput(
   filterVertexPosition(aPosition),
    %blur-vertex-out%
  );
}

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  %blur-fragment-in%
) -> @location(0) vec4<f32> {

    var   finalColor = vec4(0.0);

    %blur-sampling%

    return finalColor;
}`;
function uC(J, Q) {
    let Z = U4[Q]
        , $ = Z.length
        , q = []
        , K = []
        , V = [];
    for (let U = 0; U < Q; U++) {
        if (q[U] = `@location(${U}) offset${U}: vec2<f32>,`,
            J)
            K[U] = `filteredCord + vec2(${U - $ + 1} * pixelStrength, 0.0),`;
        else
            K[U] = `filteredCord + vec2(0.0, ${U - $ + 1} * pixelStrength),`;
        let N = U < $ ? U : Q - U - 1
            , j = Z[N].toString();
        V[U] = `finalColor += textureSample(uTexture, uSampler, offset${U}) * ${j};`
    }
    let z = q.join(`
`)
        , W = K.join(`
`)
        , H = V.join(`
`)
        , Y = pC.replace("%blur-struct%", z).replace("%blur-vertex-out%", W).replace("%blur-fragment-in%", z).replace("%blur-sampling%", H).replace("%dimension%", J ? "z" : "w");
    return B7.from({
        vertex: {
            source: Y,
            entryPoint: "mainVertex"
        },
        fragment: {
            source: Y,
            entryPoint: "mainFragment"
        }
    })
}
var Zb = class J extends _J {
    constructor(Q) {
        Q = {
            ...J.defaultOptions,
            ...Q
        };
        let Z = dC(Q.horizontal, Q.kernelSize)
            , $ = uC(Q.horizontal, Q.kernelSize);
        super({
            glProgram: Z,
            gpuProgram: $,
            resources: {
                blurUniforms: {
                    uStrength: {
                        value: 0,
                        type: "f32"
                    }
                }
            },
            ...Q
        });
        this.horizontal = Q.horizontal,
            this._quality = 0,
            this.quality = Q.quality,
            this.blur = Q.strength,
            this._uniforms = this.resources.blurUniforms.uniforms
    }
    apply(Q, Z, $, q) {
        if (this._uniforms.uStrength = this.strength / this.passes,
            this.passes === 1)
            Q.applyFilter(this, Z, $, q);
        else {
            let K = m6.getSameSizeTexture(Z)
                , V = Z
                , z = K;
            this._state.blend = !1;
            let W = Q.renderer.type === W7.WEBGPU;
            for (let H = 0; H < this.passes - 1; H++) {
                Q.applyFilter(this, V, z, H === 0 ? !0 : W);
                let Y = z;
                z = V,
                    V = Y
            }
            this._state.blend = !0,
                Q.applyFilter(this, V, $, q),
                m6.returnTexture(K)
        }
    }
    get blur() {
        return this.strength
    }
    set blur(Q) {
        this.padding = 1 + Math.abs(Q) * 2,
            this.strength = Q
    }
    get quality() {
        return this._quality
    }
    set quality(Q) {
        this._quality = Q,
            this.passes = Q
    }
}
    ;
Zb.defaultOptions = {
    strength: 8,
    quality: 4,
    kernelSize: 5
};
var N4 = Zb;
class SZ extends _J {
    constructor(...J) {
        let Q = J[0] ?? {};
        if (typeof Q === "number") {
            if (c0(Y8, "BlurFilter constructor params are now options object. See params: { strength, quality, resolution, kernelSize }"),
                Q = {
                    strength: Q
                },
                J[1] !== void 0)
                Q.quality = J[1];
            if (J[2] !== void 0)
                Q.resolution = J[2] || "inherit";
            if (J[3] !== void 0)
                Q.kernelSize = J[3]
        }
        Q = {
            ...N4.defaultOptions,
            ...Q
        };
        let { strength: Z, strengthX: $, strengthY: q, quality: K, ...V } = Q;
        super({
            ...V,
            compatibleRenderers: W7.BOTH,
            resources: {}
        });
        this._repeatEdgePixels = !1,
            this.blurXFilter = new N4({
                horizontal: !0,
                ...Q
            }),
            this.blurYFilter = new N4({
                horizontal: !1,
                ...Q
            }),
            this.quality = K,
            this.strengthX = $ ?? Z,
            this.strengthY = q ?? Z,
            this.repeatEdgePixels = !1
    }
    apply(J, Q, Z, $) {
        let q = Math.abs(this.blurXFilter.strength)
            , K = Math.abs(this.blurYFilter.strength);
        if (q && K) {
            let V = m6.getSameSizeTexture(Q);
            this.blurXFilter.blendMode = "normal",
                this.blurXFilter.apply(J, Q, V, !0),
                this.blurYFilter.blendMode = this.blendMode,
                this.blurYFilter.apply(J, V, Z, $),
                m6.returnTexture(V)
        } else if (K)
            this.blurYFilter.blendMode = this.blendMode,
                this.blurYFilter.apply(J, Q, Z, $);
        else
            this.blurXFilter.blendMode = this.blendMode,
                this.blurXFilter.apply(J, Q, Z, $)
    }
    updatePadding() {
        if (this._repeatEdgePixels)
            this.padding = 0;
        else
            this.padding = Math.max(Math.abs(this.blurXFilter.blur), Math.abs(this.blurYFilter.blur)) * 2
    }
    get strength() {
        if (this.strengthX !== this.strengthY)
            throw new Error("BlurFilter's strengthX and strengthY are different");
        return this.strengthX
    }
    set strength(J) {
        this.blurXFilter.blur = this.blurYFilter.blur = J,
            this.updatePadding()
    }
    get quality() {
        return this.blurXFilter.quality
    }
    set quality(J) {
        this.blurXFilter.quality = this.blurYFilter.quality = J
    }
    get strengthX() {
        return this.blurXFilter.blur
    }
    set strengthX(J) {
        this.blurXFilter.blur = J,
            this.updatePadding()
    }
    get strengthY() {
        return this.blurYFilter.blur
    }
    set strengthY(J) {
        this.blurYFilter.blur = J,
            this.updatePadding()
    }
    get blur() {
        return c0("8.3.0", "BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),
            this.strength
    }
    set blur(J) {
        c0("8.3.0", "BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),
            this.strength = J
    }
    get blurX() {
        return c0("8.3.0", "BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),
            this.strengthX
    }
    set blurX(J) {
        c0("8.3.0", "BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),
            this.strengthX = J
    }
    get blurY() {
        return c0("8.3.0", "BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),
            this.strengthY
    }
    set blurY(J) {
        c0("8.3.0", "BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),
            this.strengthY = J
    }
    get repeatEdgePixels() {
        return this._repeatEdgePixels
    }
    set repeatEdgePixels(J) {
        this._repeatEdgePixels = J,
            this.updatePadding()
    }
}
SZ.defaultOptions = {
    strength: 8,
    quality: 4,
    kernelSize: 5
};
T7();
lJ();
Z5();
_7();
z9();
Z6();
cJ();
lJ();
Z5();
_7();
kQ();
O6();
z9();
lJ();
Z5();
_7();
z9();
var lC = `
in vec2 vTextureCoord;
in vec4 vColor;

out vec4 finalColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uTexture;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture(uTexture, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) *  uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    finalColor = color;
}
`;
var UH = `

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct NoiseUniforms {
  uNoise:f32,
  uSeed:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> noiseUniforms : NoiseUniforms;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}
  
@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
  return VSOutput(
   filterVertexPosition(aPosition),
   filterTextureCoord(aPosition)
  );
}

fn rand(co:vec2<f32>) -> f32
{
  return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}



@fragment
fn mainFragment(
  @location(0) uv: vec2<f32>,
  @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {

    var pixelPosition =  globalTextureCoord(position.xy);// / (getSize());//-  gfu.uOutputFrame.xy);
  
    
    var sample = textureSample(uTexture, uSampler, uv);
    var randomValue =  rand(pixelPosition.xy * noiseUniforms.uSeed);
    var diff = (randomValue - 0.5) * noiseUniforms.uNoise;
  
    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (sample.a > 0.0) {
      sample.r /= sample.a;
      sample.g /= sample.a;
      sample.b /= sample.a;
    }

    sample.r += diff;
    sample.g += diff;
    sample.b += diff;

    // Premultiply alpha again.
    sample.r *= sample.a;
    sample.g *= sample.a;
    sample.b *= sample.a;
    
    return sample;
}`;
var pd = class J extends _J {
    constructor(Q = {}) {
        Q = {
            ...J.defaultOptions,
            ...Q
        };
        let Z = B7.from({
            vertex: {
                source: UH,
                entryPoint: "mainVertex"
            },
            fragment: {
                source: UH,
                entryPoint: "mainFragment"
            }
        })
            , $ = j7.from({
                vertex: l$,
                fragment: lC,
                name: "noise-filter"
            })
            , { noise: q, seed: K, ...V } = Q;
        super({
            ...V,
            gpuProgram: Z,
            glProgram: $,
            resources: {
                noiseUniforms: new Y6({
                    uNoise: {
                        value: 1,
                        type: "f32"
                    },
                    uSeed: {
                        value: 1,
                        type: "f32"
                    }
                })
            }
        });
        this.noise = q,
            this.seed = K ?? Math.random()
    }
    get noise() {
        return this.resources.noiseUniforms.uniforms.uNoise
    }
    set noise(Q) {
        this.resources.noiseUniforms.uniforms.uNoise = Q
    }
    get seed() {
        return this.resources.noiseUniforms.uniforms.uSeed
    }
    set seed(Q) {
        this.resources.noiseUniforms.uniforms.uSeed = Q
    }
}
    ;
pd.defaultOptions = {
    noise: 0.5
};
z9();
x1();
Pw();
Ew();
Fj();
Cj();
Ij();
Lj();
p1();
Z6();
UV();
$$();
Lz();
WQ();
cJ();
function NH(J, Q, Z, $, q, K, V, z) {
    let W = V - Z
        , H = z - $
        , Y = q - Z
        , U = K - $
        , N = J - Z
        , j = Q - $
        , k = W * W + H * H
        , L = W * Y + H * U
        , F = W * N + H * j
        , P = Y * Y + U * U
        , M = Y * N + U * j
        , v = 1 / (k * P - L * L)
        , E = (P * F - L * M) * v
        , n = (k * M - L * F) * v;
    return E >= 0 && n >= 0 && E + n < 1
}
JN();
QN();
ZN();
E7();
qN();
Lz();
E7();
zJ();
UQ();
E9();
var Wb = class J {
    constructor(Q) {
        this._tick = () => {
            this.timeout = setTimeout(this._processQueue, 0)
        }
            ,
            this._processQueue = () => {
                let { queue: Z } = this
                    , $ = 0;
                while (Z.length && $ < J.uploadsPerFrame) {
                    let q = Z.shift();
                    this.uploadQueueItem(q),
                        $++
                }
                if (Z.length)
                    n6.system.addOnce(this._tick, this, jJ.UTILITY);
                else
                    this._resolve()
            }
            ,
            this.renderer = Q,
            this.queue = [],
            this.resolves = []
    }
    getQueue() {
        return [...this.queue]
    }
    add(Q) {
        let Z = Array.isArray(Q) ? Q : [Q];
        for (let $ of Z)
            if ($ instanceof m8)
                this._addContainer($);
            else
                this.resolveQueueItem($, this.queue);
        return this
    }
    _addContainer(Q) {
        this.resolveQueueItem(Q, this.queue);
        for (let Z of Q.children)
            this._addContainer(Z)
    }
    upload(Q) {
        if (Q)
            this.add(Q);
        return new Promise((Z) => {
            if (this.queue.length)
                this.resolves.push(Z),
                    this.dedupeQueue(),
                    n6.system.addOnce(this._tick, this, jJ.UTILITY);
            else
                Z()
        }
        )
    }
    dedupeQueue() {
        let Q = Object.create(null)
            , Z = 0;
        for (let $ = 0; $ < this.queue.length; $++) {
            let q = this.queue[$];
            if (!Q[q.uid])
                Q[q.uid] = !0,
                    this.queue[Z++] = q
        }
        this.queue.length = Z
    }
    _resolve() {
        let { resolves: Q } = this
            , Z = Q.slice(0);
        Q.length = 0;
        for (let $ of Z)
            $()
    }
}
    ;
Wb.uploadsPerFrame = 4;
var oC = Wb;
n7();
W6();
zJ();
yz();
IZ();
IQ();
q5();
W6();
O6();
_5();
AQ();
class X9 extends JJ {
    constructor(...J) {
        let Q = J[0];
        if (Q instanceof uJ) {
            if (c0(Y8, "Mesh: use new Mesh({ geometry, shader }) instead"),
                Q = {
                    geometry: Q,
                    shader: J[1]
                },
                J[3])
                c0(Y8, "Mesh: drawMode argument has been removed, use geometry.topology instead"),
                    Q.geometry.topology = J[3]
        }
        let { geometry: Z, shader: $, texture: q, roundPixels: K, state: V, ...z } = Q;
        super({
            label: "Mesh",
            ...z
        });
        this.renderPipeId = "mesh",
            this._shader = null,
            this.allowChildren = !1,
            this.shader = $ ?? null,
            this.texture = q ?? $?.texture ?? _0.WHITE,
            this.state = V ?? U7.for2d(),
            this._geometry = Z,
            this._geometry.on("update", this.onViewUpdate, this),
            this.roundPixels = K ?? !1
    }
    get material() {
        return c0(Y8, "mesh.material property has been removed, use mesh.shader instead"),
            this._shader
    }
    set shader(J) {
        if (this._shader === J)
            return;
        this._shader = J,
            this.onViewUpdate()
    }
    get shader() {
        return this._shader
    }
    set geometry(J) {
        if (this._geometry === J)
            return;
        this._geometry?.off("update", this.onViewUpdate, this),
            J.on("update", this.onViewUpdate, this),
            this._geometry = J,
            this.onViewUpdate()
    }
    get geometry() {
        return this._geometry
    }
    set texture(J) {
        J || (J = _0.EMPTY);
        let Q = this._texture;
        if (Q === J)
            return;
        if (Q && Q.dynamic)
            Q.off("update", this.onViewUpdate, this);
        if (J.dynamic)
            J.on("update", this.onViewUpdate, this);
        if (this.shader)
            this.shader.texture = J;
        this._texture = J,
            this.onViewUpdate()
    }
    get texture() {
        return this._texture
    }
    get batched() {
        if (this._shader)
            return !1;
        if ((this.state.data & 12) !== 0)
            return !1;
        if (this._geometry instanceof C5) {
            if (this._geometry.batchMode === "auto")
                return this._geometry.positions.length / 2 <= 100;
            return this._geometry.batchMode === "batch"
        }
        return !1
    }
    get bounds() {
        return this._geometry.bounds
    }
    updateBounds() {
        this._bounds = this._geometry.bounds
    }
    containsPoint(J) {
        let { x: Q, y: Z } = J;
        if (!this.bounds.containsPoint(Q, Z))
            return !1;
        let $ = this.geometry.getBuffer("aPosition").data
            , q = this.geometry.topology === "triangle-strip" ? 3 : 1;
        if (this.geometry.getIndex()) {
            let K = this.geometry.getIndex().data
                , V = K.length;
            for (let z = 0; z + 2 < V; z += q) {
                let W = K[z] * 2
                    , H = K[z + 1] * 2
                    , Y = K[z + 2] * 2;
                if (NH(Q, Z, $[W], $[W + 1], $[H], $[H + 1], $[Y], $[Y + 1]))
                    return !0
            }
        } else {
            let K = $.length / 2;
            for (let V = 0; V + 2 < K; V += q) {
                let z = V * 2
                    , W = (V + 1) * 2
                    , H = (V + 2) * 2;
                if (NH(Q, Z, $[z], $[z + 1], $[W], $[W + 1], $[H], $[H + 1]))
                    return !0
            }
        }
        return !1
    }
    destroy(J) {
        if (super.destroy(J),
            typeof J === "boolean" ? J : J?.texture) {
            let Z = typeof J === "boolean" ? J : J?.textureSource;
            this._texture.destroy(Z)
        }
        this._geometry?.off("update", this.onViewUpdate, this),
            this._texture = null,
            this._geometry = null,
            this._shader = null,
            this._gpuData = null
    }
}
kQ();
W6();
UQ();
E9();
kQ();
class o$ extends WJ {
    constructor(...J) {
        let Q = J[0];
        if (Array.isArray(J[0]))
            Q = {
                textures: J[0],
                autoUpdate: J[1]
            };
        let { animationSpeed: Z = 1, autoPlay: $ = !1, autoUpdate: q = !0, loop: K = !0, onComplete: V = null, onFrameChange: z = null, onLoop: W = null, textures: H, updateAnchor: Y = !1, ...U } = Q
            , [N] = H;
        super({
            ...U,
            texture: N instanceof _0 ? N : N.texture
        });
        if (this._textures = null,
            this._durations = null,
            this._autoUpdate = q,
            this._isConnectedToTicker = !1,
            this.animationSpeed = Z,
            this.loop = K,
            this.updateAnchor = Y,
            this.onComplete = V,
            this.onFrameChange = z,
            this.onLoop = W,
            this._currentTime = 0,
            this._playing = !1,
            this._previousFrame = null,
            this.textures = H,
            $)
            this.play()
    }
    stop() {
        if (!this._playing)
            return;
        if (this._playing = !1,
            this._autoUpdate && this._isConnectedToTicker)
            n6.shared.remove(this.update, this),
                this._isConnectedToTicker = !1
    }
    play() {
        if (this._playing)
            return;
        if (this._playing = !0,
            this._autoUpdate && !this._isConnectedToTicker)
            n6.shared.add(this.update, this, jJ.HIGH),
                this._isConnectedToTicker = !0
    }
    gotoAndStop(J) {
        this.stop(),
            this.currentFrame = J
    }
    gotoAndPlay(J) {
        this.currentFrame = J,
            this.play()
    }
    update(J) {
        if (!this._playing)
            return;
        let Q = J.deltaTime
            , Z = this.animationSpeed * Q
            , $ = this.currentFrame;
        if (this._durations !== null) {
            let q = this._currentTime % 1 * this._durations[this.currentFrame];
            q += Z / 60 * 1000;
            while (q < 0)
                this._currentTime--,
                    q += this._durations[this.currentFrame];
            let K = Math.sign(this.animationSpeed * Q);
            this._currentTime = Math.floor(this._currentTime);
            while (q >= this._durations[this.currentFrame])
                q -= this._durations[this.currentFrame] * K,
                    this._currentTime += K;
            this._currentTime += q / this._durations[this.currentFrame]
        } else
            this._currentTime += Z;
        if (this._currentTime < 0 && !this.loop) {
            if (this.gotoAndStop(0),
                this.onComplete)
                this.onComplete()
        } else if (this._currentTime >= this._textures.length && !this.loop) {
            if (this.gotoAndStop(this._textures.length - 1),
                this.onComplete)
                this.onComplete()
        } else if ($ !== this.currentFrame) {
            if (this.loop && this.onLoop) {
                if (this.animationSpeed > 0 && this.currentFrame < $ || this.animationSpeed < 0 && this.currentFrame > $)
                    this.onLoop()
            }
            this._updateTexture()
        }
    }
    _updateTexture() {
        let J = this.currentFrame;
        if (this._previousFrame === J)
            return;
        if (this._previousFrame = J,
            this.texture = this._textures[J],
            this.updateAnchor && this.texture.defaultAnchor)
            this.anchor.copyFrom(this.texture.defaultAnchor);
        if (this.onFrameChange)
            this.onFrameChange(this.currentFrame)
    }
    destroy(J = !1) {
        if (typeof J === "boolean" ? J : J?.texture) {
            let Z = typeof J === "boolean" ? J : J?.textureSource;
            this._textures.forEach(($) => {
                if (this.texture !== $)
                    $.destroy(Z)
            }
            )
        }
        this._textures = [],
            this._durations = null,
            this.stop(),
            super.destroy(J),
            this.onComplete = null,
            this.onFrameChange = null,
            this.onLoop = null
    }
    static fromFrames(J) {
        let Q = [];
        for (let Z = 0; Z < J.length; ++Z)
            Q.push(_0.from(J[Z]));
        return new o$(Q)
    }
    static fromImages(J) {
        let Q = [];
        for (let Z = 0; Z < J.length; ++Z)
            Q.push(_0.from(J[Z]));
        return new o$(Q)
    }
    get totalFrames() {
        return this._textures.length
    }
    get textures() {
        return this._textures
    }
    set textures(J) {
        if (J[0] instanceof _0)
            this._textures = J,
                this._durations = null;
        else {
            this._textures = [],
                this._durations = [];
            for (let Q = 0; Q < J.length; Q++)
                this._textures.push(J[Q].texture),
                    this._durations.push(J[Q].time)
        }
        this._previousFrame = null,
            this.gotoAndStop(0),
            this._updateTexture()
    }
    get currentFrame() {
        let J = Math.floor(this._currentTime) % this._textures.length;
        if (J < 0)
            J += this._textures.length;
        return J
    }
    set currentFrame(J) {
        if (J < 0 || J > this.totalFrames - 1)
            throw new Error(`[AnimatedSprite]: Invalid frame index value ${J}, expected to be between 0 and totalFrames ${this.totalFrames}.`);
        let Q = this.currentFrame;
        if (this._currentTime = J,
            Q !== this.currentFrame)
            this._updateTexture()
    }
    get playing() {
        return this._playing
    }
    get autoUpdate() {
        return this._autoUpdate
    }
    set autoUpdate(J) {
        if (J !== this._autoUpdate) {
            if (this._autoUpdate = J,
                !this._autoUpdate && this._isConnectedToTicker)
                n6.shared.remove(this.update, this),
                    this._isConnectedToTicker = !1;
            else if (this._autoUpdate && !this._isConnectedToTicker && this._playing)
                n6.shared.add(this.update, this),
                    this._isConnectedToTicker = !0
        }
    }
}
t5();
WQ();
W6();
O6();
B6();
Z6();
WQ();
class wH {
    constructor({ matrix: J, observer: Q } = {}) {
        this.dirty = !0,
            this._matrix = J ?? new f0,
            this.observer = Q,
            this.position = new g6(this, 0, 0),
            this.scale = new g6(this, 1, 1),
            this.pivot = new g6(this, 0, 0),
            this.skew = new g6(this, 0, 0),
            this._rotation = 0,
            this._cx = 1,
            this._sx = 0,
            this._cy = 0,
            this._sy = 1
    }
    get matrix() {
        let J = this._matrix;
        if (!this.dirty)
            return J;
        return J.a = this._cx * this.scale.x,
            J.b = this._sx * this.scale.x,
            J.c = this._cy * this.scale.y,
            J.d = this._sy * this.scale.y,
            J.tx = this.position.x - (this.pivot.x * J.a + this.pivot.y * J.c),
            J.ty = this.position.y - (this.pivot.x * J.b + this.pivot.y * J.d),
            this.dirty = !1,
            J
    }
    _onUpdate(J) {
        if (this.dirty = !0,
            J === this.skew)
            this.updateSkew();
        this.observer?._onUpdate(this)
    }
    updateSkew() {
        this._cx = Math.cos(this._rotation + this.skew.y),
            this._sx = Math.sin(this._rotation + this.skew.y),
            this._cy = -Math.sin(this._rotation - this.skew.x),
            this._sy = Math.cos(this._rotation - this.skew.x),
            this.dirty = !0
    }
    toString() {
        return `[pixi.js/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`
    }
    setFromMatrix(J) {
        J.decompose(this),
            this.dirty = !0
    }
    get rotation() {
        return this._rotation
    }
    set rotation(J) {
        if (this._rotation !== J)
            this._rotation = J,
                this._onUpdate(this.skew)
    }
}
_5();
var Hb = class J extends JJ {
    constructor(...Q) {
        let Z = Q[0] || {};
        if (Z instanceof _0)
            Z = {
                texture: Z
            };
        if (Q.length > 1)
            c0(Y8, "use new TilingSprite({ texture, width:100, height:100 }) instead"),
                Z.width = Q[1],
                Z.height = Q[2];
        Z = {
            ...J.defaultOptions,
            ...Z
        };
        let { texture: $, anchor: q, tilePosition: K, tileScale: V, tileRotation: z, width: W, height: H, applyAnchorToTexture: Y, roundPixels: U, ...N } = Z ?? {};
        super({
            label: "TilingSprite",
            ...N
        });
        if (this.renderPipeId = "tilingSprite",
            this.batched = !0,
            this.allowChildren = !1,
            this._anchor = new g6({
                _onUpdate: () => {
                    this.onViewUpdate()
                }
            }),
            this.applyAnchorToTexture = Y,
            this.texture = $,
            this._width = W ?? $.width,
            this._height = H ?? $.height,
            this._tileTransform = new wH({
                observer: {
                    _onUpdate: () => this.onViewUpdate()
                }
            }),
            q)
            this.anchor = q;
        this.tilePosition = K,
            this.tileScale = V,
            this.tileRotation = z,
            this.roundPixels = U ?? !1
    }
    static from(Q, Z = {}) {
        if (typeof Q === "string")
            return new J({
                texture: H6.get(Q),
                ...Z
            });
        return new J({
            texture: Q,
            ...Z
        })
    }
    get uvRespectAnchor() {
        return m0("uvRespectAnchor is deprecated, please use applyAnchorToTexture instead"),
            this.applyAnchorToTexture
    }
    set uvRespectAnchor(Q) {
        m0("uvRespectAnchor is deprecated, please use applyAnchorToTexture instead"),
            this.applyAnchorToTexture = Q
    }
    get clampMargin() {
        return this._texture.textureMatrix.clampMargin
    }
    set clampMargin(Q) {
        this._texture.textureMatrix.clampMargin = Q
    }
    get anchor() {
        return this._anchor
    }
    set anchor(Q) {
        typeof Q === "number" ? this._anchor.set(Q) : this._anchor.copyFrom(Q)
    }
    get tilePosition() {
        return this._tileTransform.position
    }
    set tilePosition(Q) {
        this._tileTransform.position.copyFrom(Q)
    }
    get tileScale() {
        return this._tileTransform.scale
    }
    set tileScale(Q) {
        typeof Q === "number" ? this._tileTransform.scale.set(Q) : this._tileTransform.scale.copyFrom(Q)
    }
    set tileRotation(Q) {
        this._tileTransform.rotation = Q
    }
    get tileRotation() {
        return this._tileTransform.rotation
    }
    get tileTransform() {
        return this._tileTransform
    }
    set texture(Q) {
        Q || (Q = _0.EMPTY);
        let Z = this._texture;
        if (Z === Q)
            return;
        if (Z && Z.dynamic)
            Z.off("update", this.onViewUpdate, this);
        if (Q.dynamic)
            Q.on("update", this.onViewUpdate, this);
        this._texture = Q,
            this.onViewUpdate()
    }
    get texture() {
        return this._texture
    }
    set width(Q) {
        this._width = Q,
            this.onViewUpdate()
    }
    get width() {
        return this._width
    }
    set height(Q) {
        this._height = Q,
            this.onViewUpdate()
    }
    get height() {
        return this._height
    }
    setSize(Q, Z) {
        if (typeof Q === "object")
            Z = Q.height ?? Q.width,
                Q = Q.width;
        this._width = Q,
            this._height = Z ?? Q,
            this.onViewUpdate()
    }
    getSize(Q) {
        return Q || (Q = {}),
            Q.width = this._width,
            Q.height = this._height,
            Q
    }
    updateBounds() {
        let Q = this._bounds
            , Z = this._anchor
            , $ = this._width
            , q = this._height;
        Q.minX = -Z._x * $,
            Q.maxX = Q.minX + $,
            Q.minY = -Z._y * q,
            Q.maxY = Q.minY + q
    }
    containsPoint(Q) {
        let Z = this._width
            , $ = this._height
            , q = -Z * this._anchor._x
            , K = 0;
        if (Q.x >= q && Q.x <= q + Z) {
            if (K = -$ * this._anchor._y,
                Q.y >= K && Q.y <= K + $)
                return !0
        }
        return !1
    }
    destroy(Q = !1) {
        if (super.destroy(Q),
            this._anchor = null,
            this._tileTransform = null,
            this._bounds = null,
            typeof Q === "boolean" ? Q : Q?.texture) {
            let $ = typeof Q === "boolean" ? Q : Q?.textureSource;
            this._texture.destroy($)
        }
        this._texture = null
    }
}
    ;
Hb.defaultOptions = {
    texture: _0.EMPTY,
    anchor: {
        x: 0,
        y: 0
    },
    tilePosition: {
        x: 0,
        y: 0
    },
    tileScale: {
        x: 1,
        y: 1
    },
    tileRotation: 0,
    applyAnchorToTexture: !1
};
var TZ = Hb;
A9();
WQ();
O6();
_5();
class vQ extends JJ {
    constructor(J, Q) {
        let { text: Z, resolution: $, style: q, anchor: K, width: V, height: z, roundPixels: W, ...H } = J;
        super({
            ...H
        });
        if (this.batched = !0,
            this._resolution = null,
            this._autoResolution = !0,
            this._didTextUpdate = !0,
            this._styleClass = Q,
            this.text = Z ?? "",
            this.style = q,
            this.resolution = $ ?? null,
            this.allowChildren = !1,
            this._anchor = new g6({
                _onUpdate: () => {
                    this.onViewUpdate()
                }
            }),
            K)
            this.anchor = K;
        if (this.roundPixels = W ?? !1,
            V !== void 0)
            this.width = V;
        if (z !== void 0)
            this.height = z
    }
    get anchor() {
        return this._anchor
    }
    set anchor(J) {
        typeof J === "number" ? this._anchor.set(J) : this._anchor.copyFrom(J)
    }
    set text(J) {
        if (J = J.toString(),
            this._text === J)
            return;
        this._text = J,
            this.onViewUpdate()
    }
    get text() {
        return this._text
    }
    set resolution(J) {
        this._autoResolution = J === null,
            this._resolution = J,
            this.onViewUpdate()
    }
    get resolution() {
        return this._resolution
    }
    get style() {
        return this._style
    }
    set style(J) {
        if (J || (J = {}),
            this._style?.off("update", this.onViewUpdate, this),
            J instanceof this._styleClass)
            this._style = J;
        else
            this._style = new this._styleClass(J);
        this._style.on("update", this.onViewUpdate, this),
            this.onViewUpdate()
    }
    get width() {
        return Math.abs(this.scale.x) * this.bounds.width
    }
    set width(J) {
        this._setWidth(J, this.bounds.width)
    }
    get height() {
        return Math.abs(this.scale.y) * this.bounds.height
    }
    set height(J) {
        this._setHeight(J, this.bounds.height)
    }
    getSize(J) {
        return J || (J = {}),
            J.width = Math.abs(this.scale.x) * this.bounds.width,
            J.height = Math.abs(this.scale.y) * this.bounds.height,
            J
    }
    setSize(J, Q) {
        if (typeof J === "object")
            Q = J.height ?? J.width,
                J = J.width;
        else
            Q ?? (Q = J);
        J !== void 0 && this._setWidth(J, this.bounds.width),
            Q !== void 0 && this._setHeight(Q, this.bounds.height)
    }
    containsPoint(J) {
        let Q = this.bounds.width
            , Z = this.bounds.height
            , $ = -Q * this.anchor.x
            , q = 0;
        if (J.x >= $ && J.x <= $ + Q) {
            if (q = -Z * this.anchor.y,
                J.y >= q && J.y <= q + Z)
                return !0
        }
        return !1
    }
    onViewUpdate() {
        if (!this.didViewUpdate)
            this._didTextUpdate = !0;
        super.onViewUpdate()
    }
    destroy(J = !1) {
        if (super.destroy(J),
            this.owner = null,
            this._bounds = null,
            this._anchor = null,
            typeof J === "boolean" ? J : J?.style)
            this._style.destroy(J);
        this._style = null,
            this._text = null
    }
}
function yZ(J, Q) {
    let Z = J[0] ?? {};
    if (typeof Z === "string" || J[1])
        c0(Y8, `use new ${Q}({ text: "hi!", style }) instead`),
            Z = {
                text: Z,
                style: J[1]
            };
    return Z
}
Tz();
h9();
y5();
class sJ extends vQ {
    constructor(...J) {
        let Q = yZ(J, "Text");
        super(Q, s6);
        if (this.renderPipeId = "text",
            Q.textureStyle)
            this.textureStyle = Q.textureStyle instanceof o7 ? Q.textureStyle : new o7(Q.textureStyle)
    }
    updateBounds() {
        let J = this._bounds
            , Q = this._anchor
            , Z = 0
            , $ = 0;
        if (this._style.trim) {
            let { frame: q, canvasAndContext: K } = DQ.getCanvasAndContext({
                text: this.text,
                style: this._style,
                resolution: 1
            });
            DQ.returnCanvasAndContext(K),
                Z = q.width,
                $ = q.height
        } else {
            let q = C7.measureText(this._text, this._style);
            Z = q.width,
                $ = q.height
        }
        J.minX = -Q._x * Z,
            J.maxX = J.minX + Z,
            J.minY = -Q._y * $,
            J.maxY = J.minY + $
    }
}
class jH extends oC {
    resolveQueueItem(J, Q) {
        if (J instanceof m8)
            this.resolveContainerQueueItem(J, Q);
        else if (J instanceof $6 || J instanceof _0)
            Q.push(J.source);
        else if (J instanceof f7)
            Q.push(J);
        return null
    }
    resolveContainerQueueItem(J, Q) {
        if (J instanceof WJ || J instanceof TZ || J instanceof X9)
            Q.push(J.texture.source);
        else if (J instanceof sJ)
            Q.push(J);
        else if (J instanceof w6)
            Q.push(J.context);
        else if (J instanceof o$)
            J.textures.forEach((Z) => {
                if (Z.source)
                    Q.push(Z.source);
                else
                    Q.push(Z.texture.source)
            }
            )
    }
    resolveGraphicsContextQueueItem(J) {
        this.renderer.graphicsContext.getGpuContext(J);
        let { instructions: Q } = J;
        for (let Z of Q)
            if (Z.action === "texture") {
                let { image: $ } = Z.data;
                return $.source
            } else if (Z.action === "fill") {
                let { texture: $ } = Z.data.style;
                return $.source
            }
        return null
    }
}
w0();
n7();
IZ();
B6();
y5();
R$();
class n$ extends vQ {
    constructor(...J) {
        var Q;
        let Z = yZ(J, "BitmapText");
        Z.style ?? (Z.style = Z.style || {}),
            (Q = Z.style).fill ?? (Q.fill = 16777215);
        super(Z, s6);
        this.renderPipeId = "bitmapText"
    }
    updateBounds() {
        let J = this._bounds
            , Q = this._anchor
            , Z = K9.measureText(this.text, this._style)
            , $ = Z.scale
            , q = Z.offsetY * $
            , K = Z.width * $
            , V = Z.height * $
            , z = this._style._stroke;
        if (z)
            K += z.width,
                V += z.width;
        J.minX = -Q._x * K,
            J.maxX = J.minX + K,
            J.minY = -Q._y * (V + q),
            J.maxY = J.minY + V
    }
    set resolution(J) {
        if (J !== null)
            m0("[BitmapText] dynamically updating the resolution is not supported. Resolution should be managed by the BitmapFont.")
    }
    get resolution() {
        return this._resolution
    }
}
A9();
B6();
y5();
T7();
function nC(J) {
    let { _stroke: Q, _fill: Z } = J
        , q = [`div { ${[`color: ${E8.shared.setValue(Z.color).toHex()}`, `font-size: ${J.fontSize}px`, `font-family: ${J.fontFamily}`, `font-weight: ${J.fontWeight}`, `font-style: ${J.fontStyle}`, `font-variant: ${J.fontVariant}`, `letter-spacing: ${J.letterSpacing}px`, `text-align: ${J.align}`, `padding: ${J.padding}px`, `white-space: ${J.whiteSpace === "pre" && J.wordWrap ? "pre-wrap" : J.whiteSpace}`, ...J.lineHeight ? [`line-height: ${J.lineHeight}px`] : [], ...J.wordWrap ? [`word-wrap: ${J.breakWords ? "break-all" : "break-word"}`, `max-width: ${J.wordWrapWidth}px`] : [], ...Q ? [Nb(Q)] : [], ...J.dropShadow ? [Ub(J.dropShadow)] : [], ...J.cssOverrides].join(";")} }`];
    return rd(J.tagStyles, q),
        q.join(" ")
}
function Ub(J) {
    let Q = E8.shared.setValue(J.color).setAlpha(J.alpha).toHexa()
        , Z = Math.round(Math.cos(J.angle) * J.distance)
        , $ = Math.round(Math.sin(J.angle) * J.distance)
        , q = `${Z}px ${$}px`;
    if (J.blur > 0)
        return `text-shadow: ${q} ${J.blur}px ${Q}`;
    return `text-shadow: ${q} ${Q}`
}
function Nb(J) {
    return [`-webkit-text-stroke-width: ${J.width}px`, `-webkit-text-stroke-color: ${E8.shared.setValue(J.color).toHex()}`, `text-stroke-width: ${J.width}px`, `text-stroke-color: ${E8.shared.setValue(J.color).toHex()}`, "paint-order: stroke"].join(";")
}
var Yb = {
    fontSize: "font-size: {{VALUE}}px",
    fontFamily: "font-family: {{VALUE}}",
    fontWeight: "font-weight: {{VALUE}}",
    fontStyle: "font-style: {{VALUE}}",
    fontVariant: "font-variant: {{VALUE}}",
    letterSpacing: "letter-spacing: {{VALUE}}px",
    align: "text-align: {{VALUE}}",
    padding: "padding: {{VALUE}}px",
    whiteSpace: "white-space: {{VALUE}}",
    lineHeight: "line-height: {{VALUE}}px",
    wordWrapWidth: "max-width: {{VALUE}}px"
}
    , Xb = {
        fill: (J) => `color: ${E8.shared.setValue(J).toHex()}`,
        breakWords: (J) => `word-wrap: ${J ? "break-all" : "break-word"}`,
        stroke: Nb,
        dropShadow: Ub
    };
function rd(J, Q) {
    for (let Z in J) {
        let $ = J[Z]
            , q = [];
        for (let K in $)
            if (Xb[K])
                q.push(Xb[K]($[K]));
            else if (Yb[K])
                q.push(Yb[K].replace("{{VALUE}}", $[K]));
        Q.push(`${Z} { ${q.join(";")} }`)
    }
}
class w4 extends s6 {
    constructor(J = {}) {
        super(J);
        this._cssOverrides = [],
            this.cssOverrides = J.cssOverrides ?? [],
            this.tagStyles = J.tagStyles ?? {}
    }
    set cssOverrides(J) {
        this._cssOverrides = J instanceof Array ? J : [J],
            this.update()
    }
    get cssOverrides() {
        return this._cssOverrides
    }
    update() {
        this._cssStyle = null,
            super.update()
    }
    clone() {
        return new w4({
            align: this.align,
            breakWords: this.breakWords,
            dropShadow: this.dropShadow ? {
                ...this.dropShadow
            } : null,
            fill: this._fill,
            fontFamily: this.fontFamily,
            fontSize: this.fontSize,
            fontStyle: this.fontStyle,
            fontVariant: this.fontVariant,
            fontWeight: this.fontWeight,
            letterSpacing: this.letterSpacing,
            lineHeight: this.lineHeight,
            padding: this.padding,
            stroke: this._stroke,
            whiteSpace: this.whiteSpace,
            wordWrap: this.wordWrap,
            wordWrapWidth: this.wordWrapWidth,
            cssOverrides: this.cssOverrides,
            tagStyles: {
                ...this.tagStyles
            }
        })
    }
    get cssStyle() {
        if (!this._cssStyle)
            this._cssStyle = nC(this);
        return this._cssStyle
    }
    addOverride(...J) {
        let Q = J.filter((Z) => !this.cssOverrides.includes(Z));
        if (Q.length > 0)
            this.cssOverrides.push(...Q),
                this.update()
    }
    removeOverride(...J) {
        let Q = J.filter((Z) => this.cssOverrides.includes(Z));
        if (Q.length > 0)
            this.cssOverrides = this.cssOverrides.filter((Z) => !Q.includes(Z)),
                this.update()
    }
    set fill(J) {
        if (typeof J !== "string" && typeof J !== "number")
            m0("[HTMLTextStyle] only color fill is not supported by HTMLText");
        super.fill = J
    }
    set stroke(J) {
        if (J && typeof J !== "string" && typeof J !== "number")
            m0("[HTMLTextStyle] only color stroke is not supported by HTMLText");
        super.stroke = J
    }
}
dz();
class BH extends vQ {
    constructor(...J) {
        let Q = yZ(J, "HtmlText");
        super(Q, w4);
        if (this.renderPipeId = "htmlText",
            Q.textureStyle)
            this.textureStyle = Q.textureStyle instanceof o7 ? Q.textureStyle : new o7(Q.textureStyle)
    }
    updateBounds() {
        let J = this._bounds
            , Q = this._anchor
            , Z = hq(this.text, this._style)
            , { width: $, height: q } = Z;
        J.minX = -Q._x * $,
            J.maxX = J.minX + $,
            J.minY = -Q._y * q,
            J.maxY = J.minY + q
    }
    get text() {
        return this._text
    }
    set text(J) {
        let Q = this._sanitiseText(J.toString());
        super.text = Q
    }
    _sanitiseText(J) {
        return this._removeInvalidHtmlTags(J.replace(/<br>/gi, "<br/>").replace(/<hr>/gi, "<hr/>").replace(/&nbsp;/gi, "&#160;"))
    }
    _removeInvalidHtmlTags(J) {
        let Q = /<[^>]*?(?=<|$)/g;
        return J.replace(Q, "")
    }
}
class kH extends jH {
    uploadQueueItem(J) {
        if (J instanceof $6)
            this.uploadTextureSource(J);
        else if (J instanceof sJ)
            this.uploadText(J);
        else if (J instanceof BH)
            this.uploadHTMLText(J);
        else if (J instanceof n$)
            this.uploadBitmapText(J);
        else if (J instanceof f7)
            this.uploadGraphicsContext(J)
    }
    uploadTextureSource(J) {
        this.renderer.texture.initSource(J)
    }
    uploadText(J) {
        this.renderer.renderPipes.text.initGpuText(J)
    }
    uploadBitmapText(J) {
        this.renderer.renderPipes.bitmapText.initGpuText(J)
    }
    uploadHTMLText(J) {
        this.renderer.renderPipes.htmlText.initGpuText(J)
    }
    uploadGraphicsContext(J) {
        this.renderer.graphicsContext.getGpuContext(J);
        let { instructions: Q } = J;
        for (let Z of Q)
            if (Z.action === "texture") {
                let { image: $ } = Z.data;
                this.uploadTextureSource($.source)
            } else if (Z.action === "fill") {
                let { texture: $ } = Z.data.style;
                this.uploadTextureSource($.source)
            }
        return null
    }
}
class sC extends kH {
    destroy() {
        clearTimeout(this.timeout),
            this.renderer = null,
            this.queue = null,
            this.resolves = null
    }
}
sC.extension = {
    type: [R.WebGLSystem, R.WebGPUSystem],
    name: "prepare"
};
vB();
dV();
q2();
zq();
zj();
W2();
Bj();
U2();
K2();
eV();
$U();
v9();
u2();
f2();
h2();
x2();
m2();
c2();
i2();
O$();
I$();
t2();
DZ();
S9();
iz();
iX();
Gj();
aX();
Pj();
jV();
Qq();
Zq();
rX();
Dj();
Qq();
Zq();
SB();
TB();
yB();
MZ();
hB();
mB();
gB();
dB();
pB();
uB();
lB();
eB();
oB();
tB();
Jk();
Qk();
$k();
Uq();
lJ();
qk();
Ok();
Dk();
Kk();
SW();
BW();
Hk();
kk();
j2();
cV();
Xk();
Nk();
jk();
yW();
k2();
O2();
L2();
G2();
D2();
MW();
rB();
iB();
Pk();
Fk();
_k();
Ek();
AW();
Rk();
sk();
vk();
Tk();
hW();
fk();
mk();
dk();
uk();
ok();
gk();
nk();
ak();
nj();
sj();
zB();
ij();
aj();
rj();
tj();
ej();
VB();
WB();
HB();
XB();
wB();
jB();
BB();
R9();
Z5();
kB();
YW();
KB();
E2();
M2();
$B();
b2();
S2();
y2();
CB();
OB();
kW();
EB();
LB();
GB();
FW();
DB();
AB();
_B();
Ej();
Mj();
b9();
IK();
Q9();
mV();
Rj();
vj();
O6();
var wb = {
    POINTS: "point-list",
    LINES: "line-list",
    LINE_STRIP: "line-strip",
    TRIANGLES: "triangle-list",
    TRIANGLE_STRIP: "triangle-strip"
}
    , jb = new Proxy(wb, {
        get(J, Q) {
            return c0(Y8, `DRAW_MODES.${Q} is deprecated, use '${wb[Q]}' instead`),
                J[Q]
        }
    });
IQ();
VU();
H2();
LQ();
X2();
zU();
IV();
Sj();
NB();
KW();
CW();
Tj();
_2();
k5();
JU();
HW();
_7();
UW();
ZU();
wW();
XW();
hj();
OQ();
k$();
q5();
T$();
WW();
sz();
LZ();
O6();
var CH = ((J) => {
    return J.CLAMP = "clamp-to-edge",
        J.REPEAT = "repeat",
        J.MIRRORED_REPEAT = "mirror-repeat",
        J
}
)(CH || {})
    , Bb = new Proxy(CH, {
        get(J, Q) {
            return c0(Y8, `DRAW_MODES.${Q} is deprecated, use '${CH[Q]}' instead`),
                J[Q]
        }
    })
    , OH = ((J) => {
        return J.NEAREST = "nearest",
            J.LINEAR = "linear",
            J
    }
    )(OH || {})
    , kb = new Proxy(OH, {
        get(J, Q) {
            return c0(Y8, `DRAW_MODES.${Q} is deprecated, use '${OH[Q]}' instead`),
                J[Q]
        }
    });
dj();
bj();
GV();
$Z();
qZ();
n7();
xV();
W6();
uj();
PV();
E5();
A9();
p1();
zW();
eX();
C$();
oj();
$5();
VJ();
O6();
aQ();
d1();
Aw();
HQ();
rY();
eY();
QX();
qX();
VX();
HX();
CV();
NX();
jX();
kX();
OX();
zJ();
Wj();
_5();
GX();
Hj();
wj();
AV();
XX();
rz();
O6();
XQ();
az();
kV();
BV();
Xj();
Nj();
RB();
kZ();
Zj();
Qz();
Fz();
zN();
Gz();
HN();
XN();
YU();
wU();
BU();
FU();
PU();
AU();
$z();
jZ();
Pq();
yz();
IZ();
kq();
TU();
Ez();
wN();
jN();
kN();
Mz();
eU();
IN();
FN();
CN();
RU();
bz();
MU();
UU();
Hz();
B6();
zJ();
var Up = class J extends m8 {
    constructor(Q = {}) {
        Q = {
            ...J.defaultOptions,
            ...Q
        };
        super();
        this.renderLayerChildren = [],
            this.sortableChildren = Q.sortableChildren,
            this.sortFunction = Q.sortFunction
    }
    attach(...Q) {
        for (let Z = 0; Z < Q.length; Z++) {
            let $ = Q[Z];
            if ($.parentRenderLayer) {
                if ($.parentRenderLayer === this)
                    continue;
                $.parentRenderLayer.detach($)
            }
            this.renderLayerChildren.push($),
                $.parentRenderLayer = this;
            let q = this.renderGroup || this.parentRenderGroup;
            if (q)
                q.structureDidChange = !0
        }
        return Q[0]
    }
    detach(...Q) {
        for (let Z = 0; Z < Q.length; Z++) {
            let $ = Q[Z]
                , q = this.renderLayerChildren.indexOf($);
            if (q !== -1)
                this.renderLayerChildren.splice(q, 1);
            $.parentRenderLayer = null;
            let K = this.renderGroup || this.parentRenderGroup;
            if (K)
                K.structureDidChange = !0
        }
        return Q[0]
    }
    detachAll() {
        let Q = this.renderLayerChildren;
        for (let Z = 0; Z < Q.length; Z++)
            Q[Z].parentRenderLayer = null;
        this.renderLayerChildren.length = 0
    }
    collectRenderables(Q, Z, $) {
        let q = this.renderLayerChildren
            , K = q.length;
        if (this.sortableChildren)
            this.sortRenderLayerChildren();
        for (let V = 0; V < K; V++) {
            if (!q[V].parent)
                m0("Container must be added to both layer and scene graph. Layers only handle render order - the scene graph is required for transforms (addChild)", q[V]);
            q[V].collectRenderables(Q, Z, this)
        }
    }
    sortRenderLayerChildren() {
        this.renderLayerChildren.sort(this.sortFunction)
    }
    _getGlobalBoundsRecursive(Q, Z, $) {
        if (!Q)
            return;
        let q = this.renderLayerChildren;
        for (let K = 0; K < q.length; K++)
            q[K]._getGlobalBoundsRecursive(!0, Z, this)
    }
}
    ;
Up.defaultOptions = {
    sortableChildren: !1,
    sortFunction: (J, Q) => J.zIndex - Q.zIndex
};
W6();
XQ();
mq();
function iC(J, Q, Z, $) {
    let q = Z.buffers[0]
        , K = q.data
        , { verticesX: V, verticesY: z } = Z
        , W = J / (V - 1)
        , H = Q / (z - 1)
        , Y = 0
        , U = $[0]
        , N = $[1]
        , j = $[2]
        , k = $[3]
        , L = $[4]
        , F = $[5]
        , P = $[6]
        , M = $[7]
        , v = $[8];
    for (let E = 0; E < K.length; E += 2) {
        let n = Y % V * W
            , u = (Y / V | 0) * H
            , b = U * n + N * u + j
            , i = k * n + L * u + F
            , g = P * n + M * u + v;
        K[E] = b / g,
            K[E + 1] = i / g,
            Y++
    }
    q.update()
}
function Ob(J, Q) {
    let Z = Q[0]
        , $ = Q[1]
        , q = Q[2]
        , K = Q[3]
        , V = Q[4]
        , z = Q[5]
        , W = Q[6]
        , H = Q[7]
        , Y = Q[8];
    return J[0] = V * Y - z * H,
        J[1] = q * H - $ * Y,
        J[2] = $ * z - q * V,
        J[3] = z * W - K * Y,
        J[4] = Z * Y - q * W,
        J[5] = q * K - Z * z,
        J[6] = K * H - V * W,
        J[7] = $ * W - Z * H,
        J[8] = Z * V - $ * K,
        J
}
function Ib(J, Q, Z) {
    let $ = Q[0]
        , q = Q[1]
        , K = Q[2]
        , V = Q[3]
        , z = Q[4]
        , W = Q[5]
        , H = Q[6]
        , Y = Q[7]
        , U = Q[8]
        , N = Z[0]
        , j = Z[1]
        , k = Z[2]
        , L = Z[3]
        , F = Z[4]
        , P = Z[5]
        , M = Z[6]
        , v = Z[7]
        , E = Z[8];
    return J[0] = N * $ + j * V + k * H,
        J[1] = N * q + j * z + k * Y,
        J[2] = N * K + j * W + k * U,
        J[3] = L * $ + F * V + P * H,
        J[4] = L * q + F * z + P * Y,
        J[5] = L * K + F * W + P * U,
        J[6] = M * $ + v * V + E * H,
        J[7] = M * q + v * z + E * Y,
        J[8] = M * K + v * W + E * U,
        J
}
function Np(J, Q, Z) {
    let $ = Z[0]
        , q = Z[1]
        , K = Z[2];
    return J[0] = Q[0] * $ + Q[1] * q + Q[2] * K,
        J[1] = Q[3] * $ + Q[4] * q + Q[5] * K,
        J[2] = Q[6] * $ + Q[7] * q + Q[8] * K,
        J
}
var wp = [0, 0, 0, 0, 0, 0, 0, 0, 0]
    , jp = [0, 0, 0]
    , aC = [0, 0, 0];
function Cb(J, Q, Z, $, q, K, V, z, W) {
    let H = wp;
    H[0] = Q,
        H[1] = $,
        H[2] = K,
        H[3] = Z,
        H[4] = q,
        H[5] = V,
        H[6] = 1,
        H[7] = 1,
        H[8] = 1;
    let Y = Ob(J, H);
    aC[0] = z,
        aC[1] = W,
        aC[2] = 1;
    let U = Np(jp, Y, aC)
        , N = J;
    return J[0] = U[0],
        J[1] = 0,
        J[2] = 0,
        J[3] = 0,
        J[4] = U[1],
        J[5] = 0,
        J[6] = 0,
        J[7] = 0,
        J[8] = U[2],
        Ib(J, N, H)
}
var Bp = [0, 0, 0, 0, 0, 0, 0, 0, 0]
    , kp = [0, 0, 0, 0, 0, 0, 0, 0, 0];
function rC(J, Q, Z, $, q, K, V, z, W, H, Y, U, N, j, k, L, F) {
    let P = Cb(Bp, Q, Z, K, V, H, Y, j, k)
        , M = Cb(kp, $, q, z, W, U, N, L, F);
    return Ib(J, Ob(P, P), M)
}
class IH extends v$ {
    constructor(J) {
        super(J);
        this._projectionMatrix = [0, 0, 0, 0, 0, 0, 0, 0, 0];
        let { width: Q, height: Z } = J;
        this.corners = [0, 0, Q, 0, Q, Z, 0, Z]
    }
    setCorners(J, Q, Z, $, q, K, V, z) {
        let W = this.corners;
        W[0] = J,
            W[1] = Q,
            W[2] = Z,
            W[3] = $,
            W[4] = q,
            W[5] = K,
            W[6] = V,
            W[7] = z,
            this.updateProjection()
    }
    updateProjection() {
        let { width: J, height: Q } = this
            , Z = this.corners
            , $ = rC(this._projectionMatrix, 0, 0, Z[0], Z[1], J, 0, Z[2], Z[3], J, Q, Z[4], Z[5], 0, Q, Z[6], Z[7]);
        iC(J, Q, this, $)
    }
}
var Cp = class J extends X9 {
    constructor(Q) {
        Q = {
            ...J.defaultOptions,
            ...Q
        };
        let { texture: Z, verticesX: $, verticesY: q, ...K } = Q
            , V = new IH(J5({
                width: Z.width,
                height: Z.height,
                verticesX: $,
                verticesY: q
            }));
        super(J5({
            ...K,
            geometry: V
        }));
        this._texture = Z,
            this.geometry.setCorners(Q.x0, Q.y0, Q.x1, Q.y1, Q.x2, Q.y2, Q.x3, Q.y3)
    }
    textureUpdated() {
        let Q = this.geometry;
        if (!Q)
            return;
        let { width: Z, height: $ } = this.texture;
        if (Q.width !== Z || Q.height !== $)
            Q.width = Z,
                Q.height = $,
                Q.updateProjection()
    }
    set texture(Q) {
        if (this._texture === Q)
            return;
        super.texture = Q,
            this.textureUpdated()
    }
    get texture() {
        return this._texture
    }
    setCorners(Q, Z, $, q, K, V, z, W) {
        this.geometry.setCorners(Q, Z, $, q, K, V, z, W)
    }
}
    ;
Cp.defaultOptions = {
    texture: _0.WHITE,
    verticesX: 10,
    verticesY: 10,
    x0: 0,
    y0: 0,
    x1: 100,
    y1: 0,
    x2: 100,
    y2: 100,
    x3: 0,
    y3: 100
};
XQ();
mq();
mq();
XQ();
AQ();
var Lb = class J extends C5 {
    constructor(Q) {
        let { width: Z, points: $, textureScale: q } = {
            ...J.defaultOptions,
            ...Q
        };
        super({
            positions: new Float32Array($.length * 4),
            uvs: new Float32Array($.length * 4),
            indices: new Uint32Array(($.length - 1) * 6)
        });
        this.points = $,
            this._width = Z,
            this.textureScale = q,
            this._build()
    }
    get width() {
        return this._width
    }
    _build() {
        let Q = this.points;
        if (!Q)
            return;
        let Z = this.getBuffer("aPosition")
            , $ = this.getBuffer("aUV")
            , q = this.getIndex();
        if (Q.length < 1)
            return;
        if (Z.data.length / 4 !== Q.length)
            Z.data = new Float32Array(Q.length * 4),
                $.data = new Float32Array(Q.length * 4),
                q.data = new Uint16Array((Q.length - 1) * 6);
        let K = $.data
            , V = q.data;
        K[0] = 0,
            K[1] = 0,
            K[2] = 0,
            K[3] = 1;
        let z = 0
            , W = Q[0]
            , H = this._width * this.textureScale
            , Y = Q.length;
        for (let N = 0; N < Y; N++) {
            let j = N * 4;
            if (this.textureScale > 0) {
                let k = W.x - Q[N].x
                    , L = W.y - Q[N].y
                    , F = Math.sqrt(k * k + L * L);
                W = Q[N],
                    z += F / H
            } else
                z = N / (Y - 1);
            K[j] = z,
                K[j + 1] = 0,
                K[j + 2] = z,
                K[j + 3] = 1
        }
        let U = 0;
        for (let N = 0; N < Y - 1; N++) {
            let j = N * 2;
            V[U++] = j,
                V[U++] = j + 1,
                V[U++] = j + 2,
                V[U++] = j + 2,
                V[U++] = j + 1,
                V[U++] = j + 3
        }
        $.update(),
            q.update(),
            this.updateVertices()
    }
    updateVertices() {
        let Q = this.points;
        if (Q.length < 1)
            return;
        let Z = Q[0], $, q = 0, K = 0, V = this.buffers[0].data, z = Q.length, W = this.textureScale > 0 ? this.textureScale * this._width / 2 : this._width / 2;
        for (let H = 0; H < z; H++) {
            let Y = Q[H]
                , U = H * 4;
            if (H < Q.length - 1)
                $ = Q[H + 1];
            else
                $ = Y;
            K = -($.x - Z.x),
                q = $.y - Z.y;
            let N = (1 - H / (z - 1)) * 10;
            if (N > 1)
                N = 1;
            let j = Math.sqrt(q * q + K * K);
            if (j < 0.000001)
                q = 0,
                    K = 0;
            else
                q /= j,
                    K /= j,
                    q *= W,
                    K *= W;
            V[U] = Y.x + q,
                V[U + 1] = Y.y + K,
                V[U + 2] = Y.x - q,
                V[U + 3] = Y.y - K,
                Z = Y
        }
        this.buffers[0].update()
    }
    update() {
        if (this.textureScale > 0)
            this._build();
        else
            this.updateVertices()
    }
}
    ;
Lb.defaultOptions = {
    width: 200,
    points: [],
    textureScale: 0
};
var tC = Lb;
var Op = class J extends X9 {
    constructor(Q) {
        let { texture: Z, points: $, textureScale: q, ...K } = {
            ...J.defaultOptions,
            ...Q
        }
            , V = new tC(J5({
                width: Z.height,
                points: $,
                textureScale: q
            }));
        if (q > 0)
            Z.source.style.addressMode = "repeat";
        super(J5({
            ...K,
            texture: Z,
            geometry: V
        }));
        this.autoUpdate = !0,
            this.onRender = this._render
    }
    _render() {
        let Q = this.geometry;
        if (this.autoUpdate || Q._width !== this.texture.height)
            Q._width = this.texture.height,
                Q.update()
    }
}
    ;
Op.defaultOptions = {
    textureScale: 0
};
XQ();
AQ();
bB();
Kj();
Oq();
AQ();
yU();
fU();
sU();
nU();
iU();
T7();
W6();
CV();
AV();
var Ip = class J {
    constructor(Q) {
        if (Q instanceof _0)
            this.texture = Q,
                H$(this, J.defaultOptions, {});
        else {
            let Z = {
                ...J.defaultOptions,
                ...Q
            };
            H$(this, Z, {})
        }
    }
    get alpha() {
        return this._alpha
    }
    set alpha(Q) {
        this._alpha = Math.min(Math.max(Q, 0), 1),
            this._updateColor()
    }
    get tint() {
        return YQ(this._tint)
    }
    set tint(Q) {
        this._tint = E8.shared.setValue(Q ?? 16777215).toBgrNumber(),
            this._updateColor()
    }
    _updateColor() {
        this.color = this._tint + ((this._alpha * 255 | 0) << 24)
    }
}
    ;
Ip.defaultOptions = {
    anchorX: 0,
    anchorY: 0,
    x: 0,
    y: 0,
    scaleX: 1,
    scaleY: 1,
    rotation: 0,
    tint: 16777215,
    alpha: 1
};
mU();
VJ();
_5();
var LH = {
    vertex: {
        attributeName: "aVertex",
        format: "float32x2",
        code: `
            const texture = p.texture;
            const sx = p.scaleX;
            const sy = p.scaleY;
            const ax = p.anchorX;
            const ay = p.anchorY;
            const trim = texture.trim;
            const orig = texture.orig;

            if (trim)
            {
                w1 = trim.x - (ax * orig.width);
                w0 = w1 + trim.width;

                h1 = trim.y - (ay * orig.height);
                h0 = h1 + trim.height;
            }
            else
            {
                w1 = -ax * (orig.width);
                w0 = w1 + orig.width;

                h1 = -ay * (orig.height);
                h0 = h1 + orig.height;
            }

            f32v[offset] = w1 * sx;
            f32v[offset + 1] = h1 * sy;

            f32v[offset + stride] = w0 * sx;
            f32v[offset + stride + 1] = h1 * sy;

            f32v[offset + (stride * 2)] = w0 * sx;
            f32v[offset + (stride * 2) + 1] = h0 * sy;

            f32v[offset + (stride * 3)] = w1 * sx;
            f32v[offset + (stride * 3) + 1] = h0 * sy;
        `,
        dynamic: !1
    },
    position: {
        attributeName: "aPosition",
        format: "float32x2",
        code: `
            var x = p.x;
            var y = p.y;

            f32v[offset] = x;
            f32v[offset + 1] = y;

            f32v[offset + stride] = x;
            f32v[offset + stride + 1] = y;

            f32v[offset + (stride * 2)] = x;
            f32v[offset + (stride * 2) + 1] = y;

            f32v[offset + (stride * 3)] = x;
            f32v[offset + (stride * 3) + 1] = y;
        `,
        dynamic: !0
    },
    rotation: {
        attributeName: "aRotation",
        format: "float32",
        code: `
            var rotation = p.rotation;

            f32v[offset] = rotation;
            f32v[offset + stride] = rotation;
            f32v[offset + (stride * 2)] = rotation;
            f32v[offset + (stride * 3)] = rotation;
        `,
        dynamic: !1
    },
    uvs: {
        attributeName: "aUV",
        format: "float32x2",
        code: `
            var uvs = p.texture.uvs;

            f32v[offset] = uvs.x0;
            f32v[offset + 1] = uvs.y0;

            f32v[offset + stride] = uvs.x1;
            f32v[offset + stride + 1] = uvs.y1;

            f32v[offset + (stride * 2)] = uvs.x2;
            f32v[offset + (stride * 2) + 1] = uvs.y2;

            f32v[offset + (stride * 3)] = uvs.x3;
            f32v[offset + (stride * 3) + 1] = uvs.y3;
        `,
        dynamic: !1
    },
    color: {
        attributeName: "aColor",
        format: "unorm8x4",
        code: `
            const c = p.color;

            u32v[offset] = c;
            u32v[offset + stride] = c;
            u32v[offset + (stride * 2)] = c;
            u32v[offset + (stride * 3)] = c;
        `,
        dynamic: !1
    }
};
var Lp = new E6(0, 0, 0, 0)
    , Fp = class J extends JJ {
        constructor(Q = {}) {
            Q = {
                ...J.defaultOptions,
                ...Q,
                dynamicProperties: {
                    ...J.defaultOptions.dynamicProperties,
                    ...Q?.dynamicProperties
                }
            };
            let { dynamicProperties: Z, shader: $, roundPixels: q, texture: K, particles: V, ...z } = Q;
            super({
                label: "ParticleContainer",
                ...z
            });
            this.renderPipeId = "particle",
                this.batched = !1,
                this._childrenDirty = !1,
                this.texture = K || null,
                this.shader = $,
                this._properties = {};
            for (let W in LH) {
                let H = LH[W]
                    , Y = Z[W];
                this._properties[W] = {
                    ...H,
                    dynamic: Y
                }
            }
            this.allowChildren = !0,
                this.roundPixels = q ?? !1,
                this.particleChildren = V ?? []
        }
        addParticle(...Q) {
            for (let Z = 0; Z < Q.length; Z++)
                this.particleChildren.push(Q[Z]);
            return this.onViewUpdate(),
                Q[0]
        }
        removeParticle(...Q) {
            let Z = !1;
            for (let $ = 0; $ < Q.length; $++) {
                let q = this.particleChildren.indexOf(Q[$]);
                if (q > -1)
                    this.particleChildren.splice(q, 1),
                        Z = !0
            }
            if (Z)
                this.onViewUpdate();
            return Q[0]
        }
        update() {
            this._childrenDirty = !0
        }
        onViewUpdate() {
            this._childrenDirty = !0,
                super.onViewUpdate()
        }
        get bounds() {
            return Lp
        }
        updateBounds() { }
        destroy(Q = !1) {
            if (super.destroy(Q),
                typeof Q === "boolean" ? Q : Q?.texture) {
                let $ = typeof Q === "boolean" ? Q : Q?.textureSource
                    , q = this.texture ?? this.particleChildren[0]?.texture;
                if (q)
                    q.destroy($)
            }
            this.texture = null,
                this.shader?.destroy()
        }
        removeParticles(Q, Z) {
            Q ?? (Q = 0),
                Z ?? (Z = this.particleChildren.length);
            let $ = this.particleChildren.splice(Q, Z - Q);
            return this.onViewUpdate(),
                $
        }
        removeParticleAt(Q) {
            let Z = this.particleChildren.splice(Q, 1);
            return this.onViewUpdate(),
                Z[0]
        }
        addParticleAt(Q, Z) {
            return this.particleChildren.splice(Z, 0, Q),
                this.onViewUpdate(),
                Q
        }
        addChild(...Q) {
            throw new Error("ParticleContainer.addChild() is not available. Please use ParticleContainer.addParticle()")
        }
        removeChild(...Q) {
            throw new Error("ParticleContainer.removeChild() is not available. Please use ParticleContainer.removeParticle()")
        }
        removeChildren(Q, Z) {
            throw new Error("ParticleContainer.removeChildren() is not available. Please use ParticleContainer.removeParticles()")
        }
        removeChildAt(Q) {
            throw new Error("ParticleContainer.removeChildAt() is not available. Please use ParticleContainer.removeParticleAt()")
        }
        getChildAt(Q) {
            throw new Error("ParticleContainer.getChildAt() is not available. Please use ParticleContainer.getParticleAt()")
        }
        setChildIndex(Q, Z) {
            throw new Error("ParticleContainer.setChildIndex() is not available. Please use ParticleContainer.setParticleIndex()")
        }
        getChildIndex(Q) {
            throw new Error("ParticleContainer.getChildIndex() is not available. Please use ParticleContainer.getParticleIndex()")
        }
        addChildAt(Q, Z) {
            throw new Error("ParticleContainer.addChildAt() is not available. Please use ParticleContainer.addParticleAt()")
        }
        swapChildren(Q, Z) {
            throw new Error("ParticleContainer.swapChildren() is not available. Please use ParticleContainer.swapParticles()")
        }
        reparentChild(...Q) {
            throw new Error("ParticleContainer.reparentChild() is not available with the particle container")
        }
        reparentChildAt(Q, Z) {
            throw new Error("ParticleContainer.reparentChildAt() is not available with the particle container")
        }
    }
    ;
Fp.defaultOptions = {
    dynamicProperties: {
        vertex: !1,
        position: !0,
        rotation: !1,
        uvs: !1,
        color: !1
    },
    roundPixels: !1
};
Bz();
oU();
hU();
gU();
lz();
WQ();
W6();
O6();
_5();
lz();
var Gp = class J extends JJ {
    constructor(Q) {
        if (Q instanceof _0)
            Q = {
                texture: Q
            };
        let { width: Z, height: $, anchor: q, leftWidth: K, rightWidth: V, topHeight: z, bottomHeight: W, texture: H, roundPixels: Y, ...U } = Q;
        super({
            label: "NineSliceSprite",
            ...U
        });
        if (this.renderPipeId = "nineSliceSprite",
            this.batched = !0,
            this._leftWidth = K ?? H?.defaultBorders?.left ?? V9.defaultOptions.leftWidth,
            this._topHeight = z ?? H?.defaultBorders?.top ?? V9.defaultOptions.topHeight,
            this._rightWidth = V ?? H?.defaultBorders?.right ?? V9.defaultOptions.rightWidth,
            this._bottomHeight = W ?? H?.defaultBorders?.bottom ?? V9.defaultOptions.bottomHeight,
            this._width = Z ?? H.width ?? V9.defaultOptions.width,
            this._height = $ ?? H.height ?? V9.defaultOptions.height,
            this.allowChildren = !1,
            this.texture = H ?? J.defaultOptions.texture,
            this.roundPixels = Y ?? !1,
            this._anchor = new g6({
                _onUpdate: () => {
                    this.onViewUpdate()
                }
            }),
            q)
            this.anchor = q;
        else if (this.texture.defaultAnchor)
            this.anchor = this.texture.defaultAnchor
    }
    get anchor() {
        return this._anchor
    }
    set anchor(Q) {
        typeof Q === "number" ? this._anchor.set(Q) : this._anchor.copyFrom(Q)
    }
    get width() {
        return this._width
    }
    set width(Q) {
        this._width = Q,
            this.onViewUpdate()
    }
    get height() {
        return this._height
    }
    set height(Q) {
        this._height = Q,
            this.onViewUpdate()
    }
    setSize(Q, Z) {
        if (typeof Q === "object")
            Z = Q.height ?? Q.width,
                Q = Q.width;
        this._width = Q,
            this._height = Z ?? Q,
            this.onViewUpdate()
    }
    getSize(Q) {
        return Q || (Q = {}),
            Q.width = this._width,
            Q.height = this._height,
            Q
    }
    get leftWidth() {
        return this._leftWidth
    }
    set leftWidth(Q) {
        this._leftWidth = Q,
            this.onViewUpdate()
    }
    get topHeight() {
        return this._topHeight
    }
    set topHeight(Q) {
        this._topHeight = Q,
            this.onViewUpdate()
    }
    get rightWidth() {
        return this._rightWidth
    }
    set rightWidth(Q) {
        this._rightWidth = Q,
            this.onViewUpdate()
    }
    get bottomHeight() {
        return this._bottomHeight
    }
    set bottomHeight(Q) {
        this._bottomHeight = Q,
            this.onViewUpdate()
    }
    get texture() {
        return this._texture
    }
    set texture(Q) {
        Q || (Q = _0.EMPTY);
        let Z = this._texture;
        if (Z === Q)
            return;
        if (Z && Z.dynamic)
            Z.off("update", this.onViewUpdate, this);
        if (Q.dynamic)
            Q.on("update", this.onViewUpdate, this);
        this._texture = Q,
            this.onViewUpdate()
    }
    get originalWidth() {
        return this._texture.width
    }
    get originalHeight() {
        return this._texture.height
    }
    destroy(Q) {
        if (super.destroy(Q),
            typeof Q === "boolean" ? Q : Q?.texture) {
            let $ = typeof Q === "boolean" ? Q : Q?.textureSource;
            this._texture.destroy($)
        }
        this._texture = null
    }
    updateBounds() {
        let Q = this._bounds
            , Z = this._anchor
            , $ = this._width
            , q = this._height;
        Q.minX = -Z._x * $,
            Q.maxX = Q.minX + $,
            Q.minY = -Z._y * q,
            Q.maxY = Q.minY + q
    }
}
    ;
Gp.defaultOptions = {
    texture: _0.EMPTY
};
Gw();
Yw();
Xw();
Lw();
Bw();
Uw();
ww();
Cw();
A$();
kQ();
jj();
hz();
R$();
cN();
fN();
zJ();
h9();
R$();
Tq();
function eC(J) {
    let { text: Q, style: Z, chars: $ } = J
        , q = Z
        , K = K9.getFont(Q, q)
        , V = C7.graphemeSegmenter(Q)
        , z = GZ(V, q, K, !0)
        , W = z.scale
        , H = []
        , Y = []
        , U = []
        , N = 0;
    for (let j of z.lines) {
        if (j.chars.length === 0)
            continue;
        let k = new m8({
            label: "line"
        });
        k.y = N,
            U.push(k);
        let L = new m8({
            label: "word"
        })
            , F = 0;
        for (let P = 0; P < j.chars.length; P++) {
            let M = j.chars[P];
            if (!M)
                continue;
            if (!K.chars[M])
                continue;
            let E = M === " ", n = P === j.chars.length - 1, u;
            if ($.length > 0)
                u = $.shift(),
                    u.text = M,
                    u.style = q,
                    u.label = `char-${M}`,
                    u.x = j.charPositions[P] * W - j.charPositions[F] * W;
            else
                u = new n$({
                    text: M,
                    style: q,
                    label: `char-${M}`,
                    x: j.charPositions[P] * W - j.charPositions[F] * W
                });
            if (!E)
                H.push(u),
                    L.addChild(u);
            if (E || n) {
                if (L.children.length > 0)
                    L.x = j.charPositions[F] * W,
                        Y.push(L),
                        k.addChild(L),
                        L = new m8({
                            label: "word"
                        }),
                        F = P + 1
            }
        }
        N += K.lineHeight * W
    }
    return {
        chars: H,
        lines: U,
        words: Y
    }
}
Tq();
xN();
dN();
pN();
mz();
Vw();
nN();
eN();
Qw();
$w();
iN();
rN();
Kw();
dz();
zJ();
y5();
class s$ extends m8 {
    constructor(J) {
        let { text: Q, style: Z, autoSplit: $, lineAnchor: q, wordAnchor: K, charAnchor: V, ...z } = J;
        super(z);
        this._dirty = !1,
            this._canReuseChars = !1,
            this.chars = [],
            this.words = [],
            this.lines = [],
            this._originalText = Q,
            this._autoSplit = $,
            this._lineAnchor = q,
            this._wordAnchor = K,
            this._charAnchor = V,
            this.style = Z
    }
    split() {
        let J = this.splitFn();
        this.chars = J.chars,
            this.words = J.words,
            this.lines = J.lines,
            this.addChild(...this.lines),
            this.charAnchor = this._charAnchor,
            this.wordAnchor = this._wordAnchor,
            this.lineAnchor = this._lineAnchor,
            this._dirty = !1,
            this._canReuseChars = !0
    }
    get text() {
        return this._originalText
    }
    set text(J) {
        this._originalText = J,
            this.lines.forEach((Q) => Q.destroy({
                children: !0
            })),
            this.lines.length = 0,
            this.words.length = 0,
            this.chars.length = 0,
            this._canReuseChars = !1,
            this.onTextUpdate()
    }
    _setOrigin(J, Q, Z) {
        let $;
        if (typeof J === "number")
            $ = {
                x: J,
                y: J
            };
        else
            $ = {
                x: J.x,
                y: J.y
            };
        Q.forEach((q) => {
            let K = q.getLocalBounds()
                , V = K.minX + K.width * $.x
                , z = K.minY + K.height * $.y;
            q.origin.set(V, z)
        }
        ),
            this[Z] = J
    }
    get lineAnchor() {
        return this._lineAnchor
    }
    set lineAnchor(J) {
        this._setOrigin(J, this.lines, "_lineAnchor")
    }
    get wordAnchor() {
        return this._wordAnchor
    }
    set wordAnchor(J) {
        this._setOrigin(J, this.words, "_wordAnchor")
    }
    get charAnchor() {
        return this._charAnchor
    }
    set charAnchor(J) {
        this._setOrigin(J, this.chars, "_charAnchor")
    }
    get style() {
        return this._style
    }
    set style(J) {
        J || (J = {}),
            this._style = new s6(J),
            this.words.forEach((Q) => Q.destroy()),
            this.words.length = 0,
            this.lines.forEach((Q) => Q.destroy()),
            this.lines.length = 0,
            this._canReuseChars = !0,
            this.onTextUpdate()
    }
    onTextUpdate() {
        if (this._dirty = !0,
            this._autoSplit)
            this.split()
    }
    destroy(J) {
        if (super.destroy(J),
            this.chars = [],
            this.words = [],
            this.lines = [],
            typeof J === "boolean" ? J : J?.style)
            this._style.destroy(J);
        this._style = null,
            this._originalText = ""
    }
}
y5();
var Pp = class J extends s$ {
    constructor(Q) {
        let Z = {
            ...J.defaultOptions,
            ...Q
        };
        super(Z)
    }
    static from(Q, Z) {
        let $ = {
            ...J.defaultOptions,
            ...Z,
            text: Q.text,
            style: new s6(Q.style)
        };
        return new J({
            ...$
        })
    }
    splitFn() {
        return eC({
            text: this._originalText,
            style: this._style,
            chars: this._canReuseChars ? this.chars : []
        })
    }
}
    ;
Pp.defaultOptions = {
    autoSplit: !0,
    lineAnchor: 0,
    wordAnchor: 0,
    charAnchor: 0
};
y5();
Z6();
zJ();
h9();
function Dp(J, Q, Z) {
    switch (J) {
        case "center":
            return (Z - Q) / 2;
        case "right":
            return Z - Q;
        case "left":
        default:
            return 0
    }
}
function Fb(J) {
    return J === "\r" || J === `
` || J === `\r
`
}
function Ap(J, Q, Z) {
    let $ = []
        , q = Q.lines[0]
        , K = ""
        , V = []
        , z = 0;
    return Z.wordWrap = !1,
        J.forEach((W) => {
            let H = /^\s*$/.test(W)
                , Y = Fb(W)
                , U = K.length === 0 && H;
            if (H && !Y && U)
                return;
            if (!Y)
                K += W;
            let N = C7.measureText(W, Z);
            if (V.push({
                char: W,
                metric: N
            }),
                K.length >= q.length)
                $.push({
                    line: K,
                    chars: V,
                    width: V.reduce((j, k) => j + k.metric.width, 0)
                }),
                    V = [],
                    K = "",
                    z++,
                    q = Q.lines[z]
        }
        ),
        $
}
function JO(J) {
    let { text: Q, style: Z, chars: $ } = J
        , q = Z
        , K = C7.measureText(Q, q)
        , V = C7.graphemeSegmenter(Q)
        , z = Ap(V, K, q.clone())
        , W = q.align
        , H = K.lineWidths.reduce((F, P) => Math.max(F, P), 0)
        , Y = []
        , U = []
        , N = []
        , j = 0
        , k = q.stroke?.width || 0
        , L = q.dropShadow?.distance || 0;
    return z.forEach((F, P) => {
        let M = new m8({
            label: `line-${P}`
        });
        M.y = j,
            U.push(M);
        let v = K.lineWidths[P]
            , E = Dp(W, v, H)
            , n = new m8({
                label: "word"
            });
        if (n.x = E,
            F.chars.forEach((u, b) => {
                if (u.metric.width === 0)
                    return;
                if (Fb(u.char)) {
                    E += u.metric.width - k;
                    return
                }
                if (u.char === " ") {
                    if (n.children.length > 0)
                        N.push(n),
                            M.addChild(n);
                    E += u.metric.width + q.letterSpacing - k,
                        n = new m8({
                            label: "word"
                        }),
                        n.x = E
                } else {
                    let i;
                    if ($.length > 0)
                        i = $.shift(),
                            i.text = u.char,
                            i.style = q,
                            i.setFromMatrix(f0.IDENTITY),
                            i.x = E - n.x - L * b;
                    else
                        i = new sJ({
                            text: u.char,
                            style: q,
                            x: E - n.x - L * b
                        });
                    Y.push(i),
                        n.addChild(i),
                        E += u.metric.width + q.letterSpacing - k
                }
            }
            ),
            n.children.length > 0)
            N.push(n),
                M.addChild(n);
        j += K.lineHeight
    }
    ),
    {
        chars: Y,
        lines: U,
        words: N
    }
}
var Ep = class J extends s$ {
    constructor(Q) {
        let Z = {
            ...J.defaultOptions,
            ...Q
        };
        super(Z)
    }
    static from(Q, Z) {
        let $ = {
            ...J.defaultOptions,
            ...Z,
            text: Q.text,
            style: new s6(Q.style)
        };
        return new J({
            ...$
        })
    }
    splitFn() {
        return JO({
            text: this._originalText,
            style: this._style,
            chars: this._canReuseChars ? this.chars : []
        })
    }
}
    ;
Ep.defaultOptions = {
    autoSplit: !0,
    lineAnchor: 0,
    wordAnchor: 0,
    charAnchor: 0
};
aU();
Tz();
h9();
rU();
MN();
vq();
Sz();
yN();
bN();
TN();
y5();
PN();
vz();
Cz();
_5();
dU();
uU();
lU();
lX();
nX();
UQ();
E9();
AX();
hV();
_X();
lN();
nz();
EN();
ez();
mj();
wV();
l7();
fV();
gV();
JW();
O6();
kQ();
B6();
LX();
wQ();
NV();
s5();
fj();
Wz();
bX();
SX();
TX();
yX();
t5();
Q5();
BQ();
U$();
TV();
uX();
e1();
T7();
uY();
l1();
mX();
gX();
M6();
ew();
dX();
fX();
vV();
EV();
o1();
xX();
a1();
MV();
_V();
Cj();
Ij();
Lj();
z9();
x1();
Pw();
Ew();
Fj();
p1();
Z6();
UV();
$$();
Lz();
WQ();
cJ();
JN();
QN();
ZN();
E7();
qN();
vB();
dV();
q2();
zq();
zj();
W2();
Bj();
U2();
K2();
eV();
$U();
v9();
u2();
f2();
h2();
x2();
m2();
c2();
i2();
O$();
I$();
t2();
DZ();
S9();
iz();
iX();
Gj();
aX();
Pj();
jV();
rX();
Dj();
Qq();
Zq();
SB();
TB();
yB();
MZ();
hB();
mB();
gB();
dB();
pB();
uB();
lB();
eB();
oB();
tB();
Jk();
Qk();
$k();
Uq();
lJ();
qk();
Ok();
Dk();
Kk();
SW();
BW();
Hk();
kk();
j2();
cV();
Xk();
Nk();
jk();
yW();
k2();
O2();
L2();
G2();
D2();
MW();
rB();
iB();
Pk();
Fk();
_k();
Ek();
AW();
Rk();
sk();
vk();
Tk();
hW();
fk();
mk();
dk();
uk();
ok();
gk();
nk();
ak();
nj();
sj();
zB();
ij();
aj();
rj();
tj();
ej();
VB();
WB();
HB();
XB();
wB();
jB();
BB();
R9();
Z5();
kB();
YW();
KB();
E2();
M2();
$B();
b2();
S2();
y2();
CB();
OB();
kW();
EB();
LB();
GB();
FW();
DB();
AB();
_B();
Ej();
Mj();
b9();
IK();
Q9();
mV();
Rj();
vj();
IQ();
VU();
H2();
LQ();
X2();
zU();
IV();
Sj();
NB();
KW();
CW();
Tj();
_2();
k5();
JU();
HW();
_7();
UW();
ZU();
wW();
XW();
hj();
OQ();
k$();
q5();
T$();
WW();
sz();
LZ();
dj();
bj();
GV();
$Z();
qZ();
n7();
xV();
W6();
uj();
PV();
E5();
A9();
zW();
eX();
C$();
oj();
$5();
dU();
uU();
lU();
VJ();
aQ();
d1();
Aw();
HQ();
rY();
eY();
QX();
qX();
VX();
HX();
CV();
NX();
jX();
kX();
OX();
zJ();
Wj();
GX();
Hj();
wj();
AV();
XX();
rz();
XQ();
az();
kV();
BV();
Xj();
Nj();
RB();
kZ();
Zj();
Qz();
Fz();
zN();
Gz();
HN();
XN();
YU();
wU();
BU();
FU();
PU();
AU();
$z();
jZ();
Pq();
yz();
IZ();
kq();
TU();
Ez();
wN();
jN();
kN();
Mz();
eU();
IN();
FN();
CN();
RU();
bz();
MU();
UU();
Hz();
mq();
bB();
Kj();
Oq();
AQ();
yU();
fU();
sU();
nU();
iU();
mU();
Bz();
oU();
hU();
gU();
lz();
Gw();
Yw();
Xw();
Lw();
Bw();
Uw();
ww();
Cw();
A$();
kQ();
jj();
hz();
R$();
cN();
fN();
Tq();
xN();
dN();
pN();
mz();
Vw();
nN();
eN();
Qw();
$w();
iN();
rN();
Kw();
dz();
aU();
Tz();
h9();
rU();
MN();
vq();
Sz();
yN();
bN();
TN();
y5();
PN();
vz();
Cz();
_5();
lX();
nX();
UQ();
E9();
AX();
hV();
_X();
lN();
nz();
EN();
ez();
wJ();
mj();
wV();
l7();
fV();
gV();
JW();
O6();
B6();
LX();
wQ();
NV();
s5();
fj();
Wz();
e0.add(HG, YG);
class Gb {
    listeners = {};
    initialized = !1;
    room = null;
    systemMessageCache = [];
    CACHE_SIZE = 10;
    initialize(J) {
        if (this.initialized)
            return;
        if (this.room = J,
            this.systemMessageCache = [],
            J) {
            let Q = {
                onPlayerChat: J.onPlayerChat,
                onTeamGoal: J.onTeamGoal,
                onPlayerBallKick: J.onPlayerBallKick,
                onGamePauseChange: J.onGamePauseChange,
                onPlayerChatIndicatorChange: J.onPlayerChatIndicatorChange,
                onGameEnd: J.onGameEnd,
                onTimeIsUp: J.onTimeIsUp,
                onAfterStadiumChange: J.onAfterStadiumChange,
                onGameStart: J.onGameStart,
                onAfterGameStart: J.onAfterGameStart,
                onPlayerTeamChange: J.onPlayerTeamChange,
                onAfterPlayerJoin: J.onAfterPlayerJoin,
                onAfterPlayerLeave: J.onAfterPlayerLeave
            };
            J.onPlayerChat = (Z, $) => {
                if (this.emit("playerChat", {
                    playerId: Z,
                    message: $
                }),
                    typeof Q.onPlayerChat === "function")
                    try {
                        Q.onPlayerChat(Z, $)
                    } catch (q) { }
            }
                ,
                J.onPlayerTeamChange = (Z, $, q) => {
                    if (this.emit("playerTeamChange", {
                        playerId: Z,
                        teamId: $,
                        oldTeamId: q
                    }),
                        typeof Q.onPlayerTeamChange === "function")
                        try {
                            Q.onPlayerTeamChange(Z, $, q)
                        } catch (K) { }
                }
                ,
                J.onTeamGoal = (Z) => {
                    if (this.emit("teamGoal", {
                        teamId: Z
                    }),
                        typeof Q.onTeamGoal === "function")
                        try {
                            Q.onTeamGoal(Z)
                        } catch ($) { }
                }
                ,
                J.onPlayerBallKick = () => {
                    if (this.emit("playerBallKick", {}),
                        typeof Q.onPlayerBallKick === "function")
                        try {
                            Q.onPlayerBallKick()
                        } catch (Z) { }
                }
                ,
                J.onGamePauseChange = (Z, $) => {
                    if (this.emit("gamePauseChange", {
                        isPaused: Z,
                        byId: $
                    }),
                        typeof Q.onGamePauseChange === "function")
                        try {
                            Q.onGamePauseChange(Z, $)
                        } catch (q) { }
                }
                ,
                J.onPlayerChatIndicatorChange = (Z, $) => {
                    if (this.emit("playerChatIndicator", {
                        playerId: Z,
                        isTyping: $
                    }),
                        typeof Q.onPlayerChatIndicatorChange === "function")
                        try {
                            Q.onPlayerChatIndicatorChange(Z, $)
                        } catch (q) { }
                }
                ,
                J.onGameEnd = (Z) => {
                    if (this.emit("gameEnd", {
                        winningTeamId: Z
                    }),
                        typeof Q.onGameEnd === "function")
                        try {
                            Q.onGameEnd(Z)
                        } catch ($) { }
                }
                ,
                J.onTimeIsUp = () => {
                    if (this.emit("timeIsUp", {}),
                        typeof Q.onTimeIsUp === "function")
                        try {
                            Q.onTimeIsUp()
                        } catch (Z) { }
                }
                ,
                J.onAfterStadiumChange = (Z, $, q) => {
                    let K = Z.calculateChecksum ? Z.calculateChecksum() : null;
                    if (this.emit("stadiumChange", {
                        stadium: Z,
                        byId: $,
                        customData: q,
                        checksum: K
                    }),
                        typeof Q.onAfterStadiumChange === "function")
                        try {
                            Q.onAfterStadiumChange(Z, $, q)
                        } catch (V) { }
                }
                ,
                J.onAfterGameStart = (Z) => {
                    if (this.emit("gameStart", {
                        byId: Z
                    }),
                        J.gameState && J.gameState.stadium)
                        this.emit("stadiumChange", {
                            stadium: J.gameState.stadium,
                            byId: Z,
                            isGameStart: !0
                        });
                    if (typeof Q.onAfterGameStart === "function")
                        try {
                            Q.onAfterGameStart(Z)
                        } catch ($) { }
                }
                ,
                J.onAfterPlayerJoin = (Z) => {
                    let $ = `${Z.name} has joined.`;
                    if (this.emit("systemMessage", {
                        message: $
                    }),
                        this.emit("playerJoin", {
                            player: Z
                        }),
                        typeof Q.onAfterPlayerJoin === "function")
                        try {
                            Q.onAfterPlayerJoin(Z)
                        } catch (q) { }
                }
                ,
                J.onPlayerSyncChange = (Z, $, q) => {
                    this.emit("systemMessage", {
                        message: `Player ${J.getPlayer(Z).name} ${$ ? "out of Sync" : "back in Sync"}`
                    })
                }
                ,
                J.onAfterPlayerLeave = (Z, $, q, K, V) => {
                    let z = `${Z.name} has left.`;
                    if (q)
                        z = `${Z.name} has been banned by ${J.getPlayer(K).name} ${$ ? `${$}` : ""}.`;
                    else if ($ !== null)
                        z = `${Z.name} has been kicked by ${J.getPlayer(K).name} (${$ ? `${$}` : ""}).`;
                    if (this.emit("systemMessage", {
                        message: z
                    }),
                        this.emit("playerLeave", {
                            player: Z,
                            reason: $,
                            isBanned: q,
                            byId: K,
                            customData: V
                        }),
                        typeof Q.onAfterPlayerLeave === "function")
                        try {
                            Q.onAfterPlayerLeave(Z, $, q, K, V)
                        } catch (W) { }
                }
                ,
                this.initialized = !0
        }
    }
    cacheSystemMessage(J) {
        if (this.systemMessageCache.push(J),
            this.systemMessageCache.length > this.CACHE_SIZE)
            this.systemMessageCache.shift()
    }
    cleanup() {
        this.listeners = {},
            this.initialized = !1,
            this.room = null,
            this.systemMessageCache = []
    }
    on(J, Q) {
        if (!this.listeners[J])
            this.listeners[J] = [];
        if (this.listeners[J].push(Q),
            J === "systemMessage" && this.systemMessageCache.length > 0)
            setTimeout(() => {
                this.systemMessageCache.forEach((Z) => {
                    try {
                        Q(Z)
                    } catch ($) { }
                }
                )
            }
                , 0);
        return () => {
            if (this.listeners[J])
                this.listeners[J] = this.listeners[J].filter((Z) => Z !== Q)
        }
    }
    emit(J, Q) {
        if (!this.listeners[J])
            return;
        this.listeners[J].forEach((Z) => {
            try {
                Z(Q)
            } catch ($) { }
        }
        )
    }
    testDispatch(J, Q) {
        this.emit(J, Q)
    }
}
var v6 = new Gb;
function oG() {
    return {
        modifyPlayerData: async (J, Q, Z, $, q, K) => {
            let V = IE();
            if (!(await (await fetch("https://luxball.online/api/verifyJoinToken", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    accept: "",
                    "accept-language": "tr,en;q=0.9,en-GB;q=0.8,en-US;q=0.7",
                    "sec-ch-ua":
                        '" Not A;Brand";v="99", "Chromium";v="100", "Microsoft Edge";v="100"',
                    "sec-ch-ua-mobile": "?0",
                    "sec-ch-ua-platform": '"Windows"',
                    "sec-fetch-dest": "empty",
                    "sec-fetch-mode": "cors",
                    "sec-fetch-site": "same-site",
                    Referer: "https://luxball.online/",
                    "Referrer-Policy": "strict-origin-when-cross-origin",
                },
                body: JSON.stringify({
                    token: K,
                    username: Q
                }),
                credentials: "include"
            }).catch((e) => console.log(e))).json()).success || Q == "guest")
                return Q = "Guest-" + Math.floor(Math.random() * 1e4).toString().padStart(4, "0"),
                    [Q, Z, $];

            return [Q, Z, $]
        }
    }
}
function createRoom(Z) {
    return new Promise((resolve, reject) => {
        let V = Z?.roomSettings || {
            name: `${$}'s room`,
            password: "",
            maxPlayers: 10,
            showInRoomList: !0
        }
            , z = "luxball";

        if (Z?.joinToken)
            z = Z.joinToken;

        let W = oG();

        U1.Room.create({
            name: V.name,
            password: V.password,
            showInRoomList: V.showInRoomList,
            maxPlayerCount: V.maxPlayers,
            token: z
        }, {
            storage: {
                player_name: Z?.playerName || "Bot",
                avatar: null,
                geo: {
                    lat: Z?.geoLocation?.lat || 33,
                    lon: Z?.geoLocation?.lon || 35,
                    flag: Z?.geoLocation?.country || "US"
                }
            },
            config: W,
            onConnInfo: Z?.onConnInfo,
            onOpen: (H) => {
                v6.initialize(H),
                    T1(H),
                    resolve(H);
            }
            ,
            onClose: (H) => {
                console.log("Room closed.");
                if (Z?.onClose)
                    Z.onClose(H);
                v6.cleanup(),
                    T1(null)
            }
        })
    })
}
var nG = {
    audio: {
        ballVolume: 1,
        musicVolume: 0.8,
        lobbyMusicVolume: 0.8,
        voiceVolume: 1,
        chatVolume: 0,
        goalVolume: 1,
        goalPostVolume: 1
    },
    display: {
        extrapolation: 70,
        targetFPS: 66,
        renderingAPI: "auto",
        resolutionScale: "default",
        unlimitedFPS: !0,
        perfectPixels: !1,
        enableShadows: !0,
        enableShadowDrawings: !0,
        chatBubbles: !0,
        showOwnName: !1,
        showPlayerNames: !0,
        showAvatars: !0,
        showPlayerDecorator: !0,
        playerDecoratorColor: "#FFFFFF",
        playerDecoratorOpacity: 0.3,
        showPlayerDecoratorAll: !1,
        disableBottomBar: !1,
        antialiasing: "msaa"
    },
    keyboard: {
        up: ["KeyW", "ArrowUp"],
        down: ["KeyS", "ArrowDown"],
        left: ["KeyA", "ArrowLeft"],
        right: ["KeyD", "ArrowRight"],
        kick: ["Space", "KeyX"],
        zoomIn: ["Equal", "NumpadAdd"],
        zoomOut: ["Minus", "NumpadSubtract"],
        camera1: ["Digit1", "Numpad1"],
        camera2: ["Digit2", "Numpad2"],
        camera3: ["Digit3", "Numpad3"],
        camera4: ["Digit4", "Numpad4"],
        camera5: ["Digit5", "Numpad5"]
    }
}
    , tp = "audio_settings_changed"
    , ep = "keyboard_settings_changed"
    , Ju = (J, Q) => {
        if (typeof global !== "undefined") {
            let Z = new CustomEvent(tp, {
                detail: {
                    key: J,
                    value: Q
                }
            });
            global.dispatchEvent(Z)
        }
    }
    , Qu = () => {
        if (typeof global !== "undefined") {
            let J = new CustomEvent(ep);
            global.dispatchEvent(J)
        }
    }
    , Pb = n5({
        settings: nG,
        updateSettings: () => { }
        ,
        updateAudioSetting: () => { }
        ,
        updateDisplaySetting: () => { }
        ,
        updateKeyboardSetting: () => { }
    })
    , h5 = () => {
        return O9(Pb)
    }
    ;
function Db({ children: J }) {
    let [Q, Z] = C8(() => {
        let z = localStorage.getItem("gameSettings")
            , W = {
                ...nG
            };
        if (z)
            try {
                let H = JSON.parse(z);
                W = {
                    ...W,
                    audio: {
                        ...W.audio,
                        ...H.audio || {}
                    },
                    display: {
                        ...W.display,
                        ...H.display || {}
                    },
                    keyboard: {
                        ...W.keyboard,
                        ...H.keyboard || {}
                    }
                }
            } catch (H) {
                W = {
                    ...nG
                }
            }
        return W
    }
    );
    i0(() => {
        localStorage.setItem("gameSettings", JSON.stringify(Q))
    }
        , [Q]);
    let $ = (z) => {
        Z((W) => ({
            ...W,
            ...z
        }))
    }
        , q = (z, W) => {
            Z((H) => ({
                ...H,
                audio: {
                    ...H.audio,
                    [z]: W
                }
            })),
                Ju(z, W)
        }
        , K = (z, W) => {
            Z((H) => ({
                ...H,
                display: {
                    ...H.display,
                    [z]: W
                }
            }))
        }
        , V = (z, W, H) => {
            let Y = {
                ...Q.keyboard
            };
            Object.keys(Y).forEach((N) => {
                let j = N;
                if (j !== z)
                    Y[j] = Y[j].map((k, L) => k === H ? "" : k)
            }
            );
            let U = [...Y[z]];
            U[W] = H,
                Y[z] = U,
                Z((N) => ({
                    ...N,
                    keyboard: Y
                })),
                Qu()
        }
        ;
    return A(Pb.Provider, {
        value: {
            settings: Q,
            updateSettings: $,
            updateAudioSetting: q,
            updateDisplaySetting: K,
            updateKeyboardSetting: V
        },
        children: J
    })
}
var Ab = n5(void 0);
function Eb({ children: J }) {
    let [Q, Z] = C8(!1);
    return A(Ab.Provider, {
        value: {
            isGameMenuActive: Q,
            setGameMenuActive: Z
        },
        children: J
    })
}
function QO() {
    let J = O9(Ab);
    if (J === void 0)
        throw new Error("useGameMenu must be used within a GameMenuProvider");
    return J
}
var Zu = () => {
    let J = typeof navigator !== "undefined" && navigator.gpu !== void 0
        , Q = typeof global !== "undefined" && (typeof global.WebGLRenderingContext === "function" || typeof global.WebGLRenderingContext === "object");
    return {
        webgpu: J,
        webgl: Q
    }
}
    ;
function $u({ value: J, onChange: Q, onHover: Z }) {
    let [$, q] = C8(!1)
        , { webgpu: K, webgl: V } = Zu()
        , z = [{
            id: "auto",
            label: "Auto-detect",
            available: !0
        }, {
            id: "webgl",
            label: "WebGL",
            available: V
        }, {
            id: "webgpu",
            label: "WebGPU",
            available: K
        }]
        , W = z.find((H) => H.id === J) || z[0];
    return A("div", {
        class: "w-full p-2 flex items-center border-b border-gray-700 relative",
        onMouseEnter: Z,
        children: [A("div", {
            class: "w-1/3 text-white text-sm",
            children: "Rendering API"
        }), A("div", {
            class: "flex-grow",
            children: [A("div", {
                class: "bg-gray-800 p-2 flex justify-between items-center cursor-pointer",
                onClick: () => q(!$),
                children: [A("span", {
                    class: "text-white text-sm",
                    children: W.label
                }), A("span", {
                    class: "text-gray-400",
                    children: $ ? "▲" : "▼"
                })]
            }), $ && A("div", {
                class: "absolute z-20 bg-gray-800 border border-gray-700 w-64 mt-1 right-2",
                children: z.map((H) => H.available && A("div", {
                    class: `p-2 cursor-pointer ${J === H.id ? "bg-blue-600" : "hover:bg-gray-700"}`,
                    onClick: () => {
                        Q(H.id),
                            q(!1)
                    }
                    ,
                    children: A("span", {
                        class: "text-white text-sm",
                        children: H.label
                    })
                }, H.id))
            })]
        })]
    })
}
function a$({ label: J, value: Q, min: Z = 0, max: $ = 100, step: q = 1, onChange: K, onHover: V, unit: z = "", displayAsPercentage: W = !1 }) {
    let H = W ? Math.round(Q * 100) : Q
        , [Y, U] = C8(!1)
        , [N, j] = C8(!1)
        , k = n0(null)
        , L = u7((g) => {
            if (!k.current)
                return;
            let l = k.current.getBoundingClientRect()
                , o = (g.clientX - l.left) / l.width
                , F0 = Z + o * ($ - Z)
                , b0 = Math.round(F0 / q) * q
                , d0 = Math.max(Z, Math.min($, b0));
            K(d0)
        }
            , [Z, $, q, K])
        , F = u7(() => {
            j(!1),
                global.removeEventListener("mousemove", P),
                global.removeEventListener("mouseup", F)
        }
            , [])
        , P = u7((g) => {
            if (N)
                L(g)
        }
            , [N, L])
        , M = u7((g) => {
            if (!k.current)
                return;
            j(!0),
                L(g),
                global.addEventListener("mousemove", P),
                global.addEventListener("mouseup", F)
        }
            , [L])
        , v = u7((g) => {
            if (!k.current || !g.touches[0])
                return;
            g.preventDefault(),
                j(!0);
            let l = g.touches[0]
                , o = {
                    clientX: l.clientX,
                    clientY: l.clientY
                };
            L(o),
                global.addEventListener("touchmove", E),
                global.addEventListener("touchend", n)
        }
            , [L])
        , E = u7((g) => {
            if (!N || !g.touches[0])
                return;
            g.preventDefault();
            let l = g.touches[0]
                , o = {
                    clientX: l.clientX,
                    clientY: l.clientY
                };
            L(o)
        }
            , [N, L])
        , n = u7(() => {
            j(!1),
                global.removeEventListener("touchmove", E),
                global.removeEventListener("touchend", n)
        }
            , [])
        , u = () => {
            let g = Math.max(Z, Q - q);
            K(g)
        }
        , b = () => {
            let g = Math.min($, Q + q);
            K(g)
        }
        , i = `${(Q - Z) / ($ - Z) * 100}%`;
    return i0(() => {
        return () => {
            global.removeEventListener("mousemove", P),
                global.removeEventListener("mouseup", F),
                global.removeEventListener("touchmove", E),
                global.removeEventListener("touchend", n)
        }
    }
        , [P, F, E, n]),
        A("div", {
            class: "w-full p-2 flex items-center border-b border-gray-700",
            onMouseEnter: () => {
                if (U(!0),
                    V)
                    V()
            }
            ,
            onMouseLeave: () => U(!1),
            children: [A("div", {
                class: "w-1/3 text-white text-sm",
                children: J
            }), A("div", {
                class: "w-12 text-center text-gray-300 text-sm mr-2",
                children: [H, z]
            }), A("div", {
                class: "flex-grow flex items-center",
                children: [A("button", {
                    class: "bg-gray-700 hover:bg-gray-600 text-white w-6 h-6 flex items-center justify-center",
                    onClick: u,
                    children: A("span", {
                        children: "◄"
                    })
                }), A("div", {
                    ref: k,
                    class: `flex-grow mx-1 relative h-6 ${Y ? "bg-gray-700" : ""} ${N ? "cursor-grabbing" : "cursor-grab"}`,
                    onMouseDown: M,
                    onTouchStart: v,
                    children: [A("div", {
                        class: "absolute top-0 left-0 w-full h-full bg-gray-800"
                    }), A("div", {
                        class: `absolute top-0 left-0 h-full ${Y || N ? "bg-blue-500" : "bg-blue-600"}`,
                        style: {
                            width: i
                        }
                    }), A("div", {
                        class: "absolute top-0 h-full pointer-events-none transition-all duration-150",
                        style: {
                            left: i,
                            transform: "translateX(-50%)",
                            marginLeft: "1px"
                        },
                        children: A("div", {
                            class: `h-full ${Y || N ? "w-3" : "w-2"} bg-white rounded-sm shadow-md transition-all duration-150`,
                            style: {
                                transform: Y || N ? "scaleY(1.2)" : "scaleY(1)"
                            }
                        })
                    }), A("input", {
                        type: "range",
                        min: Z,
                        max: $,
                        step: q,
                        value: Q,
                        onChange: (g) => K(parseFloat(g.target.value)),
                        onInput: (g) => K(parseFloat(g.target.value)),
                        class: "absolute top-0 left-0 w-full h-full opacity-0 cursor-pointer z-10",
                        style: {
                            WebkitAppearance: "none",
                            appearance: "none"
                        },
                        onFocus: () => U(!0),
                        onBlur: () => U(!1)
                    })]
                }), A("button", {
                    class: "bg-gray-700 hover:bg-gray-600 text-white w-6 h-6 flex items-center justify-center",
                    onClick: b,
                    children: A("span", {
                        children: "►"
                    })
                })]
            })]
        })
}
var _b;
((V) => {
    V.TEAMS = "TEAMS";
    V.DISPLAY = "DISPLAY";
    V.AUDIO = "AUDIO";
    V.KEYBOARD = "KEYBOARD";
    V.CONTROLLER = "CONTROLLER";
    V.SOCIAL = "SOCIAL"
}
)(_b ||= {});
function Rb({ API: J, isVisible: Q, onClose: Z }) {
    let [$, q] = C8([])
        , [K, V] = C8(new Map)
        , [z, W] = C8(null)
        , [H, Y] = C8("TEAMS")
        , [U, N] = C8(null)
        , [j, k] = C8(3)
        , [L, F] = C8(3)
        , [P, M] = C8("Classic")
        , [v, E] = C8(!1)
        , [n, u] = C8(!1)
        , { room: b } = qJ()
        , { setGameMenuActive: i } = QO()
        , g = b?.currentPlayer?.isAdmin || b?.isHost
        , l = !g || n
        , o = n0(null)
        , [F0, b0] = C8(null)
        , [d0, H8] = C8({
            visible: !1,
            x: 0,
            y: 0,
            player: null
        })
        , [E0, v0] = C8({
            visible: !1,
            type: null,
            player: null
        })
        , G6 = () => {
            Y("TEAMS"),
                Z()
        }
        ;
    i0(() => {
        if (!Q)
            return;
        let a = (q0) => {
            if (q0.key === "Escape")
                q0.preventDefault(),
                    q0.stopPropagation(),
                    G6()
        }
            ;
        return global.addEventListener("keydown", a, !0),
            () => {
                global.removeEventListener("keydown", a, !0)
            }
    }
        , [Q]),
        i0(() => {
            let a = document.createElement("link");
            return a.rel = "stylesheet",
                a.href = "https://cdn.jsdelivr.net/gh/lipis/flag-icons@7.3.2/css/flag-icons.min.css",
                document.head.appendChild(a),
                () => {
                    if (document.head.contains(a))
                        document.head.removeChild(a)
                }
        }
            , []),
        i0(() => {
            if (typeof global !== "undefined")
                global.isGameMenuOpen = Q;
            return i(Q),
                () => {
                    if (typeof global !== "undefined")
                        global.isGameMenuOpen = !1;
                    i(!1)
                }
        }
            , [Q, i]),
        i0(() => {
            if (Q && b)
                I8()
        }
            , [Q, b]),
        i0(() => { }
            , [$]);
    let I8 = () => {
        if (!b)
            return;
        let a = b.gameState != null;
        if (u((q0) => q0 !== a ? a : q0),
            b.players) {
            let q0 = Array.isArray(b.players) ? [...b.players] : [];
            q((H0) => {
                if (H0.length !== q0.length)
                    return q0;
                for (let p0 = 0; p0 < H0.length; p0++)
                    if (H0[p0].id !== q0[p0]?.id || H0[p0].name !== q0[p0]?.name || H0[p0].team.id !== q0[p0]?.team.id)
                        return q0;
                return H0
            }
            )
        }
        E((q0) => {
            let H0 = b.state.teamsLocked || !1;
            return q0 !== H0 ? H0 : q0
        }
        ),
            k((q0) => {
                let H0 = b.timeLimit || 3;
                return q0 !== H0 ? H0 : q0
            }
            ),
            F((q0) => {
                let H0 = b.scoreLimit || 3;
                return q0 !== H0 ? H0 : q0
            }
            ),
            M((q0) => {
                let H0 = b.stadium?.name || "Classic";
                return q0 !== H0 ? H0 : q0
            }
            )
    }
        , x0 = async () => {
            if (!b)
                return;
            if (I8(),
                b.players) {
                let a = Array.isArray(b.players) ? [...b.players] : []
                    , q0 = new Map(K);
                for (let H0 of a)
                    if (!q0.has(H0.name)) {
                        let p0 = await U8(H0.name);
                        if (p0)
                            q0.set(H0.name, p0)
                    }
                if (q0.size !== K.size)
                    V(q0)
            }
        }
        , U8 = async (a) => {
            if (a === "Guest" || a.toLowerCase().startsWith("guest-"))
                return null;
            try {
                let q0 = await fetch("https://luxball.online/api/getPlayerInfo", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        accept: "",
                        "accept-language": "tr,en;q=0.9,en-GB;q=0.8,en-US;q=0.7",
                        "sec-ch-ua":
                            '" Not A;Brand";v="99", "Chromium";v="100", "Microsoft Edge";v="100"',
                        "sec-ch-ua-mobile": "?0",
                        "sec-ch-ua-platform": '"Windows"',
                        "sec-fetch-dest": "empty",
                        "sec-fetch-mode": "cors",
                        "sec-fetch-site": "same-site",
                        Referer: "https://luxball.online/",
                        "Referrer-Policy": "strict-origin-when-cross-origin",
                    },
                    body: JSON.stringify({
                        username: a
                    })
                }).catch((e) => console.log(e));
                if (!q0.ok)
                    return null;
                let H0 = await q0.json();
                if (H0.success && H0.data)
                    return {
                        rank: H0.data.rank || "Player",
                        profileAvatar: H0.data.profileAvatar || "/_Limey/img/avatars/avatar_default.png",
                        profileBanner: H0.data.profileBanner || "/_Limey/img/banners/default-banner.png"
                    };
                return null
            } catch (q0) {
                return null
            }
        }
        ;
    i0(() => {
        if (b) {
            x0().catch(console.error);
            let a = (j8) => {
                V((k8) => {
                    let W8 = new Map(k8);
                    return W8.delete(j8.name),
                        W8
                }
                ),
                    q((k8) => {
                        return k8.filter((P6) => P6.id !== j8.id)
                    }
                    )
            }
                , q0 = () => {
                    u(!0)
                }
                , H0 = () => {
                    u(!1)
                }
                , p0 = () => {
                    t8()
                }
                , w8 = (j8) => {
                    E(j8)
                }
                , y8 = [];
            if (y8.push(v6.on("playerJoin", async (j8) => {
                if (j8.player) {
                    let k8 = await U8(j8.player.name);
                    if (k8)
                        V((W8) => new Map(W8).set(j8.player.name, k8));
                    q((W8) => {
                        return [...W8, j8.player]
                    }
                    )
                }
            }
            )),
                y8.push(v6.on("playerLeave", (j8) => {
                    if (j8.player)
                        V((k8) => {
                            let W8 = new Map(k8);
                            return W8.delete(j8.player.name),
                                W8
                        }
                        ),
                            q((k8) => {
                                return k8.filter((P6) => P6.id !== j8.player.id)
                            }
                            )
                }
                )),
                y8.push(v6.on("playerTeamChange", (j8) => {
                    if (j8.playerId !== void 0 && j8.teamId !== void 0)
                        q((k8) => {
                            return k8.map((P6) => {
                                if (P6.id === j8.playerId) {
                                    let g7 = "#808080";
                                    if (j8.teamId === 1)
                                        g7 = "#ef4444";
                                    else if (j8.teamId === 2)
                                        g7 = "#3b82f6";
                                    if (j8.teamId === 0)
                                        return {
                                            ...P6,
                                            team: {
                                                id: 0,
                                                color: "#808080"
                                            }
                                        };
                                    return {
                                        ...P6,
                                        team: {
                                            id: j8.teamId,
                                            color: g7
                                        }
                                    }
                                }
                                return P6
                            }
                            )
                        }
                        ),
                            setTimeout(() => {
                                q((k8) => {
                                    return [...k8]
                                }
                                )
                            }
                                , 50),
                            setTimeout(() => {
                                if (b && b.players)
                                    q(Array.isArray(b.players) ? [...b.players] : [])
                            }
                                , 100)
                }
                )),
                b.onGameStart)
                b.onGameStart = q0;
            if (b.onGameStop)
                b.onGameStop = H0;
            if (b.onStadiumChange)
                b.onStadiumChange = p0;
            if (b.onTeamsLock)
                b.onTeamsLock = w8;
            return () => {
                if (y8.forEach((j8) => j8()),
                    b.onGameStart)
                    b.onGameStart = null;
                if (b.onGameStop)
                    b.onGameStop = null;
                if (b.onStadiumChange)
                    b.onStadiumChange = null;
                if (b.onTeamsLock)
                    b.onTeamsLock = null
            }
        }
    }
        , [b]);
    let t8 = () => {
        if (!b)
            return;
        if (b.players)
            q(Array.isArray(b.players) ? b.players : []);
        let a = b.gameState != null;
        u(a),
            E(b.state.teamsLocked || !1),
            k(b.timeLimit || 3),
            F(b.scoreLimit || 3),
            M(b.stadium?.name || "Classic")
    }
        ;
    if (!Q)
        return null;
    let o8 = $.filter((a) => a.team?.id === 1)
        , c8 = $.filter((a) => a.team?.id === 2)
        , _8 = $.filter((a) => !a.team || a.team.id === 0)
        , R6 = (a, q0) => {
            if (!g)
                return;
            try {
                a.dataTransfer.setData("text/plain", q0.id.toString()),
                    a.dataTransfer.effectAllowed = "move",
                    W(q0.id)
            } catch (H0) { }
        }
        , n8 = (a) => {
            a.preventDefault(),
                a.dataTransfer.dropEffect = "move"
        }
        , q6 = (a, q0) => {
            if (a.preventDefault(),
                a.stopPropagation(),
                !g || !b)
                return;
            try {
                let H0 = a.dataTransfer.getData("text/plain")
                    , p0 = parseInt(H0);
                if (!isNaN(p0))
                    b.setPlayerTeam(p0, q0),
                        W(null),
                        x0()
            } catch (H0) { }
        }
        , K6 = (a, q0) => {
            W(null)
        }
        , k6 = () => {
            if (b && g)
                b.autoTeams(),
                    x0()
        }
        , y6 = () => {
            if (b && g)
                b.randTeams(),
                    x0()
        }
        , S6 = () => {
            if (b && g)
                b.lockTeams(),
                    E(!v),
                    setTimeout(() => x0(), 100)
        }
        , J8 = () => {
            if (b && g)
                b.resetTeam(1),
                    b.resetTeam(2),
                    x0()
        }
        , L0 = () => {
            if (b && g && !n)
                b.startGame(),
                    x0()
        }
        , d8 = () => {
            if (b && g && n)
                b.stopGame(),
                    x0()
        }
        , d6 = () => {
            if (b && g && n)
                b.pauseGame()
        }
        , K8 = () => {
            if (b && g && !n) {
                if (o.current)
                    o.current.click()
            }
        }
        , h8 = (a) => {
            if (!g || !b || !J)
                return;
            let q0 = a.target.files[0];
            if (!q0)
                return;
            let H0 = q0.name.toLowerCase();
            if (!(H0.endsWith(".hbs") || H0.endsWith(".json"))) {
                alert("Please select a valid stadium file (.hbs or .json)");
                return
            }
            let w8 = new FileReader;
            w8.onload = function () {
                try {
                    let y8 = w8.result
                        , j8 = J.Utils.parseStadium(y8);
                    if (j8)
                        b.setCurrentStadium(j8),
                            M(j8.name || "Custom Stadium"),
                            x0();
                    else
                        alert("Failed to parse stadium file. Please check the file format.")
                } catch (y8) {
                    alert("Error loading stadium file. Please check that the file is valid.")
                }
            }
                ,
                w8.onerror = function () {
                    alert("Error reading file. Please try again.")
                }
                ,
                w8.readAsText(q0),
                a.target.value = ""
        }
        , O0 = (a) => {
            let q0 = parseInt(a.target.value);
            if (b && g && !n)
                b.setTimeLimit(q0),
                    k(q0)
        }
        , h0 = (a) => {
            let q0 = parseInt(a.target.value);
            if (b && g && !n)
                b.setScoreLimit(q0),
                    F(q0)
        }
        , R8 = (a, q0) => {
            if (!g)
                return;
            a.preventDefault(),
                a.stopPropagation(),
                H8({
                    visible: !0,
                    x: a.clientX,
                    y: a.clientY,
                    player: q0
                })
        }
        ;
    i0(() => {
        let a = () => {
            H8((q0) => ({
                ...q0,
                visible: !1
            }))
        }
            ;
        if (d0.visible)
            document.addEventListener("click", a),
                document.addEventListener("contextmenu", a);
        return () => {
            document.removeEventListener("click", a),
                document.removeEventListener("contextmenu", a)
        }
    }
        , [d0.visible]);
    let X6 = (a) => {
        if (b && g && a.id !== b.currentPlayer?.id)
            b.setPlayerAdmin(a.id, !0);
        H8((q0) => ({
            ...q0,
            visible: !1
        }))
    }
        , k0 = (a) => {
            if (b && g && a.id !== b.currentPlayer?.id)
                b.setPlayerAdmin(a.id, !1);
            H8((q0) => ({
                ...q0,
                visible: !1
            }))
        }
        , U6 = (a) => {
            if (b && g && a.id !== b.currentPlayer?.id)
                v0({
                    visible: !0,
                    type: "kick",
                    player: a
                });
            H8((q0) => ({
                ...q0,
                visible: !1
            }))
        }
        , V8 = (a) => {
            if (b && g && a.id !== b.currentPlayer?.id)
                v0({
                    visible: !0,
                    type: "ban",
                    player: a
                });
            H8((q0) => ({
                ...q0,
                visible: !1
            }))
        }
        , o0 = (a) => {
            if (!b || !E0.player)
                return;
            let q0 = E0.player
                , H0 = a.trim() || "No reason provided";
            if (E0.type === "kick")
                b.kickPlayer(q0.id, H0, !1);
            else if (E0.type === "ban")
                b.kickPlayer(q0.id, H0, !0);
            v0({
                visible: !1,
                type: null,
                player: null
            })
        }
        , C0 = () => {
            let [a, q0] = C8("");
            if (!E0.visible || !E0.player)
                return null;
            let { player: H0, type: p0 } = E0
                , w8 = p0 === "kick" ? "Kick" : "Ban"
                , y8 = p0 === "kick" ? "orange" : "red"
                , j8 = (W8) => {
                    W8.preventDefault(),
                        o0(a),
                        q0("")
                }
                , k8 = () => {
                    v0({
                        visible: !1,
                        type: null,
                        player: null
                    }),
                        q0("")
                }
                ;
            return A("div", {
                className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",
                children: A("div", {
                    className: "bg-slate-800 rounded-lg p-6 w-96 shadow-xl border border-slate-600",
                    children: [A("div", {
                        className: "flex items-center gap-3 mb-4",
                        children: [A("span", {
                            className: "text-2xl",
                            children: p0 === "kick" ? "⚠️" : "\uD83D\uDEAB"
                        }), A("div", {
                            children: [A("h2", {
                                className: "text-xl font-bold text-white",
                                children: [w8, " Player"]
                            }), A("p", {
                                className: "text-slate-300 text-sm",
                                children: [p0 === "kick" ? "Removing" : "Permanently banning", " ", A("span", {
                                    className: "font-medium",
                                    children: H0.name
                                })]
                            })]
                        })]
                    }), A("form", {
                        onSubmit: j8,
                        children: [A("div", {
                            className: "mb-6",
                            children: [A("label", {
                                className: "block text-slate-300 text-sm font-medium mb-2",
                                children: "Reason (optional)"
                            }), A("textarea", {
                                value: a,
                                onChange: (W8) => q0(W8.target.value),
                                className: "w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white placeholder-slate-400 focus:outline-none focus:border-blue-500 resize-none",
                                placeholder: `Enter reason for ${p0}...`,
                                rows: 3,
                                maxLength: 100
                            }), A("div", {
                                className: "text-xs text-slate-400 mt-1",
                                children: [a.length, "/100 characters"]
                            })]
                        }), p0 === "ban" && A("div", {
                            className: "mb-4 p-3 bg-red-900/20 border border-red-500/30 rounded",
                            children: [A("div", {
                                className: "flex items-center gap-2 text-red-400 text-sm",
                                children: [A("span", {
                                    children: "⚠️"
                                }), A("span", {
                                    className: "font-medium",
                                    children: "Warning:"
                                })]
                            }), A("p", {
                                className: "text-red-300 text-sm mt-1",
                                children: "This will permanently ban the player from the room."
                            })]
                        }), A("div", {
                            className: "flex gap-3",
                            children: [A("button", {
                                type: "button",
                                onClick: k8,
                                className: "flex-1 px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded transition-colors",
                                children: "Cancel"
                            }), A("button", {
                                type: "submit",
                                className: `flex-1 px-4 py-2 ${y8 === "orange" ? "bg-orange-600 hover:bg-orange-500" : "bg-red-600 hover:bg-red-500"} text-white font-medium rounded transition-colors`,
                                children: [w8, " Player"]
                            })]
                        })]
                    })]
                })
            })
        }
        , K0 = () => {
            if (!d0.visible || !d0.player || !g)
                return null;
            let a = d0.player
                , q0 = a.id === b?.currentPlayer?.id;
            return A("div", {
                className: "fixed z-50 bg-slate-800 border border-slate-600 rounded-lg shadow-xl py-2 min-w-[150px]",
                style: {
                    left: `${d0.x}px`,
                    top: `${d0.y}px`
                },
                children: [A("div", {
                    className: "px-3 py-2 text-slate-300 text-xs font-medium border-b border-slate-600",
                    children: a.name
                }), !q0 && A(GJ, {
                    children: [!a.isAdmin ? A("button", {
                        onClick: () => X6(a),
                        className: "w-full px-3 py-2 text-left text-white hover:bg-slate-700 flex items-center gap-2",
                        children: [A("span", {
                            className: "text-yellow-400",
                            children: "\uD83D\uDC51"
                        }), "Give Admin"]
                    }) : A("button", {
                        onClick: () => k0(a),
                        className: "w-full px-3 py-2 text-left text-yellow-400 hover:bg-slate-700 flex items-center gap-2",
                        children: [A("span", {
                            className: "text-gray-400",
                            children: "\uD83D\uDC51"
                        }), "Remove Admin"]
                    }), A("button", {
                        onClick: () => U6(a),
                        className: "w-full px-3 py-2 text-left text-orange-400 hover:bg-slate-700 flex items-center gap-2",
                        children: [A("span", {
                            children: "⚠️"
                        }), "Kick Player"]
                    }), A("button", {
                        onClick: () => V8(a),
                        className: "w-full px-3 py-2 text-left text-red-400 hover:bg-slate-700 flex items-center gap-2",
                        children: [A("span", {
                            children: "\uD83D\uDEAB"
                        }), "Ban Player"]
                    })]
                }), q0 && A("div", {
                    className: "px-3 py-2 text-slate-500 text-sm",
                    children: "Cannot perform actions on yourself"
                })]
            })
        }
        , J0 = (a) => {
            let q0 = K.get(a.name)?.profileBanner || "/_Limey/img/banners/default-banner.png";
            return A("div", {
                draggable: g,
                onDragStart: (H0) => R6(H0, a),
                onDragEnd: (H0) => K6(H0, a),
                onContextMenu: (H0) => R8(H0, a),
                className: "flex items-center w-full h-16 mb-1.5 cursor-move group hover:transform hover:scale-105 transition-all duration-200",
                children: [A("div", {
                    className: "flex-shrink-0 mr-1",
                    children: A("img", {
                        src: K.get(a.name)?.profileAvatar || "/_Limey/img/avatars/avatar_default.png",
                        alt: `${a.name}'s avatar`,
                        className: "w-12 h-12 rounded border-2 border-gray-600",
                        onError: (H0) => {
                            H0.target.src = "/_Limey/img/avatars/avatar_default.png"
                        }
                    })
                }), A("div", {
                    className: "flex-1 relative h-16 cursor-move",
                    style: {
                        clipPath: "polygon(0 0, calc(100% - 6px) 0, 100% 6px, 100% 100%, 6px 100%, 0 calc(100% - 6px))"
                    },
                    children: [A("div", {
                        className: "absolute inset-0 h-10",
                        style: {
                            backgroundImage: `url(${q0})`,
                            backgroundSize: "cover",
                            backgroundPosition: "center",
                            backgroundRepeat: "no-repeat",
                            clipPath: "polygon(0 0, calc(100% - 6px) 0, 100% 6px, 100% 40px, 6px 40px, 0 calc(40px - 6px))"
                        },
                        children: A("div", {
                            className: `absolute inset-0 border-2 ${a.team.id === 1 ? "border-red-500" : a.team.id === 2 ? "border-blue-500" : "border-gray-500"}`,
                            style: {
                                clipPath: "polygon(0 0, calc(100% - 6px) 0, 100% 6px, 100% 40px, 6px 40px, 0 calc(40px - 6px))"
                            }
                        })
                    }), A("div", {
                        className: `absolute bottom-0 left-0 right-0 h-6 bg-gradient-to-r ${a.team.id === 1 ? "from-red-900/90 to-red-800/90" : a.team.id === 2 ? "from-blue-900/90 to-blue-800/90" : "from-gray-900/90 to-gray-800/90"} flex items-center justify-between px-2`,
                        style: {
                            clipPath: "polygon(0 0, calc(100% - 6px) 0, 100% 6px, 100% 100%, 6px 100%, 0 calc(100% - 6px))"
                        },
                        children: [A("div", {
                            className: "flex items-center gap-1.5",
                            children: [A("span", {
                                className: `text-xs font-medium ${a.team.id === 1 ? "text-red-300" : a.team.id === 2 ? "text-blue-300" : "text-gray-300"}`,
                                children: a.name
                            }), K.get(a.name)?.rank && K.get(a.name)?.rank !== "Player" && A("span", {
                                className: "text-xs text-purple-400 font-medium",
                                children: ["[", K.get(a.name)?.rank, "]"]
                            }), a.isAdmin && A("span", {
                                className: "text-xs text-yellow-400 font-medium",
                                children: "ADMIN"
                            })]
                        }), A("div", {
                            className: "flex items-center gap-1.5",
                            children: [a.flag && A("span", {
                                className: `fi fi-${a.flag.toLowerCase()}`,
                                style: {
                                    width: "14px",
                                    height: "10px"
                                },
                                title: a.flag.toUpperCase()
                            }), A("div", {
                                className: `w-1.5 h-1.5 rounded-full ${a.ping <= 50 ? "bg-green-400" : a.ping <= 100 ? "bg-yellow-400" : "bg-red-400"}`
                            }), A("span", {
                                className: "text-xs text-gray-300",
                                children: [a.ping, "ms"]
                            })]
                        })]
                    }), g && a.id !== b?.currentPlayer?.id && A("div", {
                        className: "absolute top-0.5 right-0.5 text-slate-400 text-xs opacity-0 group-hover:opacity-100 transition-opacity",
                        children: "⋮"
                    })]
                })]
            }, a.id)
        }
        , V0 = (a) => {
            if (b && (!v || g))
                b.setPlayerTeam(b.currentPlayerId, a),
                    x0()
        }
        , t = () => {
            return A("div", {
                className: "flex flex-col h-full overflow-hidden",
                children: [A("div", {
                    className: "flex flex-col items-center mb-3 edge-flex-fix flex-shrink-0",
                    children: [A("h3", {
                        className: "text-white text-lg font-bold mb-2 text-center",
                        children: "Teams"
                    }), A("div", {
                        className: "flex gap-1.5 mb-3 justify-center flex-wrap edge-flex-fix",
                        children: [A("button", {
                            className: `bg-slate-700 hover:bg-slate-600 text-white py-1.5 px-3 rounded text-xs flex items-center edge-flex-fix edge-flex-center transition-colors ${l ? "opacity-50 cursor-not-allowed" : ""}`,
                            onClick: k6,
                            disabled: l,
                            children: [A("span", {
                                className: "mr-1.5",
                                children: "↔"
                            }), " Auto-assign"]
                        }), A("button", {
                            className: `bg-slate-700 hover:bg-slate-600 text-white py-1.5 px-3 rounded text-xs flex items-center edge-flex-fix edge-flex-center transition-colors ${l ? "opacity-50 cursor-not-allowed" : ""}`,
                            onClick: y6,
                            disabled: l,
                            children: [A("span", {
                                className: "mr-1.5",
                                children: "\uD83C\uDFB2"
                            }), " Random"]
                        }), A("button", {
                            className: `${v ? "bg-red-700 hover:bg-red-600" : "bg-slate-700 hover:bg-slate-600"} text-white py-1.5 px-3 rounded text-xs flex items-center edge-flex-fix edge-flex-center transition-colors ${l ? "opacity-50 cursor-not-allowed" : ""}`,
                            onClick: S6,
                            disabled: l,
                            children: [A("span", {
                                className: "mr-1.5",
                                children: v ? "\uD83D\uDD12" : "\uD83D\uDD13"
                            }), " ", v ? "Locked" : "Lock"]
                        }), A("button", {
                            className: `bg-slate-700 hover:bg-slate-600 text-white py-1.5 px-3 rounded text-xs flex items-center edge-flex-fix edge-flex-center transition-colors ${l ? "opacity-50 cursor-not-allowed" : ""}`,
                            onClick: J8,
                            disabled: l,
                            children: [A("span", {
                                className: "mr-1.5",
                                children: "↻"
                            }), " Reset"]
                        })]
                    }), A("div", {
                        className: "grid grid-cols-3 gap-4 w-full max-w-5xl mb-4 flex-1 overflow-hidden",
                        children: [A("div", {
                            className: "flex flex-col",
                            children: [A("div", {
                                className: "bg-gradient-to-r from-red-700 to-red-600 gradient-fallback-red text-white font-bold py-2 px-3 rounded-t text-center edge-flex-fix edge-flex-between shadow-lg",
                                children: A("div", {
                                    className: "flex items-center justify-between w-full",
                                    children: [A("span", {
                                        className: "text-sm font-bold",
                                        children: "RED TEAM"
                                    }), A("button", {
                                        className: "text-white px-2 py-0.5 rounded bg-red-800 hover:bg-red-700 text-xs transition-colors",
                                        onClick: () => V0(1),
                                        disabled: v && !g,
                                        children: "JOIN"
                                    })]
                                })
                            }), A("div", {
                                className: "bg-slate-800 flex-1 edge-flex-grow p-3 rounded-b border-2 border-red-500/30 shadow-xl team-scroll",
                                style: {
                                    maxHeight: "450px",
                                    overflowY: o8.length > 6 ? "auto" : "visible",
                                    scrollbarWidth: "thin",
                                    scrollbarColor: "rgba(255,255,255,0.3) transparent"
                                },
                                onDragOver: (p0) => p0.preventDefault(),
                                onDrop: (p0) => {
                                    p0.preventDefault(),
                                        q6(p0, 1)
                                }
                                ,
                                children: o8.length === 0 ? A("div", {
                                    className: "flex items-center justify-center edge-flex-fix edge-flex-center h-16 text-gray-400 text-xs",
                                    children: "No players"
                                }) : o8.map(J0)
                            })]
                        }), A("div", {
                            className: "flex flex-col",
                            children: [A("div", {
                                className: "bg-gradient-to-r from-gray-700 to-gray-600 gradient-fallback-gray text-white font-bold py-2 px-3 rounded-t text-center shadow-lg",
                                children: A("span", {
                                    className: "text-sm font-bold",
                                    children: "SPECTATORS"
                                })
                            }), A("div", {
                                className: "bg-slate-800 flex-1 edge-flex-grow p-3 rounded-b border-2 border-gray-500/30 shadow-xl spectators-scroll",
                                style: {
                                    maxHeight: "450px",
                                    overflowY: _8.length > 6 ? "auto" : "visible",
                                    scrollbarWidth: "thin",
                                    scrollbarColor: "rgba(255,255,255,0.3) transparent"
                                },
                                onDragOver: (p0) => p0.preventDefault(),
                                onDrop: (p0) => {
                                    p0.preventDefault(),
                                        q6(p0, 0)
                                }
                                ,
                                children: _8.length === 0 ? A("div", {
                                    className: "flex items-center justify-center edge-flex-fix edge-flex-center h-16 text-gray-400 text-xs",
                                    children: "No spectators"
                                }) : _8.map(J0)
                            })]
                        }), A("div", {
                            className: "flex flex-col",
                            children: [A("div", {
                                className: "bg-gradient-to-r from-blue-700 to-blue-600 gradient-fallback-blue text-white font-bold py-2 px-3 rounded-t text-center edge-flex-fix edge-flex-between shadow-lg",
                                children: A("div", {
                                    className: "flex items-center justify-between w-full",
                                    children: [A("button", {
                                        className: "text-white px-2 py-0.5 rounded bg-blue-800 hover:bg-blue-700 text-xs transition-colors",
                                        onClick: () => V0(2),
                                        disabled: v && !g,
                                        children: "JOIN"
                                    }), A("span", {
                                        className: "text-sm font-bold",
                                        children: "BLUE TEAM"
                                    })]
                                })
                            }), A("div", {
                                className: "bg-slate-800 flex-1 edge-flex-grow p-3 rounded-b border-2 border-blue-500/30 shadow-xl team-scroll",
                                style: {
                                    maxHeight: "450px",
                                    overflowY: c8.length > 6 ? "auto" : "visible",
                                    scrollbarWidth: "thin",
                                    scrollbarColor: "rgba(255,255,255,0.3) transparent"
                                },
                                onDragOver: (p0) => p0.preventDefault(),
                                onDrop: (p0) => {
                                    p0.preventDefault(),
                                        q6(p0, 2)
                                }
                                ,
                                children: c8.length === 0 ? A("div", {
                                    className: "flex items-center justify-center edge-flex-fix edge-flex-center h-16 text-gray-400 text-xs",
                                    children: "No players"
                                }) : c8.map(J0)
                            })]
                        })]
                    })]
                }), A("div", {
                    className: "flex flex-col items-center mb-3 flex-shrink-0",
                    children: [A("h3", {
                        className: "text-white text-base font-bold mb-2",
                        children: "Game Settings"
                    }), A("div", {
                        className: "bg-slate-800 rounded p-3 w-full max-w-lg shadow-xl border border-slate-600/50",
                        children: [A("div", {
                            className: "flex items-center mb-2",
                            children: [A("span", {
                                className: "text-white mr-3 w-20 text-xs font-medium",
                                children: "Stadium"
                            }), A("div", {
                                className: "flex flex-1",
                                children: [A("span", {
                                    className: `bg-slate-700 text-white py-1.5 px-3 rounded-l flex-grow text-xs ${P !== "Classic" ? "text-yellow-300" : ""}`,
                                    children: P
                                }), A("button", {
                                    className: "bg-blue-600 hover:bg-blue-500 text-white py-1.5 px-3 rounded-r text-xs transition-colors",
                                    onClick: K8,
                                    disabled: l,
                                    children: "Pick"
                                })]
                            })]
                        }), A("div", {
                            className: "flex items-center mb-2",
                            children: [A("span", {
                                className: "text-white mr-3 w-20 text-xs font-medium",
                                children: "Time limit"
                            }), A("select", {
                                value: j,
                                onChange: O0,
                                disabled: l,
                                className: "bg-slate-700 text-white py-1.5 px-3 rounded flex-1 text-xs",
                                children: [...Array(15)].map((p0, w8) => A("option", {
                                    value: w8,
                                    children: w8
                                }, w8))
                            })]
                        }), A("div", {
                            className: "flex items-center",
                            children: [A("span", {
                                className: "text-white mr-3 w-20 text-xs font-medium",
                                children: "Score limit"
                            }), A("select", {
                                value: L,
                                onChange: h0,
                                disabled: l,
                                className: "bg-slate-700 text-white py-1.5 px-3 rounded flex-1 text-xs",
                                children: [...Array(15)].map((p0, w8) => A("option", {
                                    value: w8,
                                    children: w8
                                }, w8))
                            })]
                        })]
                    })]
                }), A("div", {
                    className: "flex flex-col items-center edge-flex-fix flex-shrink-0 mb-4",
                    children: [A("h4", {
                        className: "text-white text-base font-bold mb-2",
                        children: "Game Controls"
                    }), A("div", {
                        className: "bg-slate-800 rounded p-4 w-full max-w-sm flex justify-center edge-flex-fix edge-flex-center shadow-xl border border-slate-600/50",
                        children: n ? A("div", {
                            className: "flex gap-3 edge-flex-fix",
                            children: [A("button", {
                                className: "bg-red-600 hover:bg-red-500 text-white py-2 px-4 rounded flex items-center edge-flex-fix edge-flex-center transition-colors shadow-lg text-sm",
                                onClick: d8,
                                disabled: !g,
                                children: [A("span", {
                                    className: "mr-1.5",
                                    children: "■"
                                }), " Stop"]
                            }), A("button", {
                                className: "bg-yellow-600 hover:bg-yellow-500 text-white py-2 px-4 rounded flex items-center edge-flex-fix edge-flex-center transition-colors shadow-lg text-sm",
                                onClick: d6,
                                disabled: !g,
                                children: [A("span", {
                                    className: "mr-1.5",
                                    children: "⏸️"
                                }), " Pause (P)"]
                            })]
                        }) : A("button", {
                            className: "bg-green-600 hover:bg-green-500 text-white py-2 px-6 rounded flex items-center edge-flex-fix edge-flex-center transition-colors shadow-lg text-sm",
                            onClick: L0,
                            disabled: !g,
                            children: [A("span", {
                                className: "mr-1.5",
                                children: "▶"
                            }), " Start game"]
                        })
                    })]
                })]
            })
        }
        , c = () => {
            switch (U) {
                case "extrapolation":
                    return {
                        title: "Extrapolation",
                        description: "Adjusts the prediction time for smoother gameplay. Higher values reduce visual lag but may cause more prediction errors. Lower values are more accurate but may appear less smooth."
                    };
                case "extrapolation-clone":
                    return {
                        title: "Extrapolation Clone View",
                        description: `When enabled, shows a transparent clone of players at their extrapolated positions instead of updating your position. 

This helps visualize how far ahead the game is predicting movement.`
                    };
                case "fps":
                    return {
                        title: "Frame Rate",
                        description: "Controls how many frames per second the game renders. Higher values provide smoother animation but require more processing power. The default of 66 FPS provides optimal smoothness while maintaining compatibility with most displays."
                    };
                case "unlimited-fps":
                    return {
                        title: "Unlimited FPS",
                        description: "When enabled, the game will render at the highest frame rate your device can handle, without any limits. This may provide smoother gameplay on high-end devices but may cause higher power consumption and heat generation."
                    };
                case "resolution-scale":
                    return {
                        title: "Resolution Scale",
                        description: "Adjusts the rendering resolution relative to the native screen resolution. 'Default' uses the device's pixel ratio. Lower values (e.g., 0.5) render at half resolution, improving performance but reducing sharpness."
                    };
                case "rendering-api":
                    return {
                        title: "Rendering API",
                        description: `Choose which graphics API to use for rendering:

• Auto: Automatically selects the best available API
• WebGL: Standard web graphics API with wide compatibility
• WebGPU: Next-generation graphics API with better performance but limited browser support

NOTE: You must rejoin the room for changes to take effect.`
                    };
                case "perfect-pixels":
                    return {
                        title: "Perfect Pixels",
                        description: "Using GPU lines instead of modified thick lines, this can improve performance."
                    };
                case "show-player-names":
                    return {
                        title: "Show Player Names",
                        description: "Toggle the visibility of player names above their characters. When disabled, no player names will be shown, regardless of other name settings."
                    };
                case "show-own-name":
                    return {
                        title: "Show Own Name",
                        description: "Toggle the visibility of your own name above your character. Note: This setting has no effect if 'Show Player Names' is disabled."
                    };
                case "show-avatars":
                    return {
                        title: "Show Avatars",
                        description: "Toggle the visibility of player avatars (emoji/text) displayed within player discs. Use the /avatar command in chat to change your avatar (e.g., /avatar \uD83D\uDE80)."
                    };
                case "show-player-decorator":
                    return {
                        title: "Show Player Decorator",
                        description: "Toggle the visibility of player decorator (circle around player)"
                    };
                case "decorator-color":
                    return {
                        title: "Decorator Color",
                        description: "Choose the color of the circle drawn around players."
                    };
                case "decorator-opacity":
                    return {
                        title: "Decorator Opacity",
                        description: "Adjust opacity of the decorator circle. 0 is invisible, 1 is fully opaque."
                    };
                case "decorator-all":
                    return {
                        title: "Decorator For All Players",
                        description: "When enabled, draw the decorator circle around all players; otherwise only around yourself."
                    };
                case "disable-bottom-bar":
                    return {
                        title: "Disable Bottom Bar",
                        description: "Hide the gray glassy chat bar that appears at the bottom of the screen. This will make the entire bottom bar invisible while keeping chat functionality accessible via keyboard shortcuts."
                    };
                case "chat-bubbles":
                    return {
                        title: "Chat Bubbles",
                        description: "Toggle the visibility of chat message bubbles that appear above players when they send messages. When disabled, chat messages will only appear in the chat bar at the bottom of the screen."
                    };
                default:
                    return {
                        title: "Display Settings",
                        description: "Adjust visual settings to optimize game performance and appearance."
                    }
            }
        }
        , X0 = () => {
            let a = c()
                , { settings: q0, updateDisplaySetting: H0 } = h5()
                , p0 = q0.display.extrapolationCloneView || !1
                , w8 = (t0) => {
                    H0("extrapolation", t0)
                }
                , y8 = (t0) => {
                    H0("extrapolationCloneView", t0)
                }
                , j8 = (t0) => {
                    if (t0 !== q0.display.renderingAPI) {
                        if (H0("renderingAPI", t0),
                            typeof global !== "undefined")
                            setTimeout(() => {
                                alert("Rendering API changed. You need to rejoin the room for this change to take effect.")
                            }
                                , 100)
                    } else
                        H0("renderingAPI", t0)
                }
                , k8 = (t0) => {
                    H0("resolutionScale", t0)
                }
                , W8 = (t0) => {
                    if (H0("unlimitedFPS", t0),
                        t0)
                        H0("targetFPS", 0);
                    else
                        H0("targetFPS", 60)
                }
                , P6 = (t0) => {
                    H0("perfectPixels", t0)
                }
                , g7 = (t0) => {
                    H0("showPlayerNames", t0)
                }
                , j9 = (t0) => {
                    H0("showOwnName", t0)
                }
                , Z0 = (t0) => {
                    H0("showAvatars", t0)
                }
                , G0 = (t0) => {
                    H0("showPlayerDecorator", t0)
                }
                , z8 = (t0) => {
                    H0("playerDecoratorColor", t0)
                }
                , Z8 = (t0) => {
                    let e8 = Math.max(0, Math.min(1, t0));
                    H0("playerDecoratorOpacity", e8)
                }
                , G8 = (t0) => {
                    H0("showPlayerDecoratorAll", t0)
                }
                ;
            return A("div", {
                class: "flex h-full",
                children: [A("div", {
                    class: "w-[70%] pr-6 overflow-y-auto",
                    style: {
                        maxHeight: "calc(100vh - 200px)",
                        scrollbarWidth: "thin",
                        scrollbarColor: "rgba(255,255,255,0.3) transparent"
                    },
                    children: [A(r$, {
                        label: "PERFORMANCE"
                    }), A("div", {
                        class: "bg-black bg-opacity-30 p-1 rounded mb-4",
                        children: [A(a$, {
                            label: "Extrapolation",
                            value: q0.display.extrapolation,
                            min: 0,
                            max: 200,
                            step: 1,
                            onChange: w8,
                            onHover: () => N("extrapolation"),
                            unit: "ms"
                        }), A("div", {
                            class: "w-full p-2 flex items-center justify-between border-b border-gray-700",
                            onMouseEnter: () => N("extrapolation-clone"),
                            children: [A("div", {
                                class: "w-1/3 text-white text-sm",
                                children: "Extrapolation Clone View"
                            }), A("div", {
                                class: "w-6 h-6 flex items-center justify-center bg-gray-800 cursor-pointer",
                                onClick: () => y8(!p0),
                                children: A("div", {
                                    class: `w-5 h-5 border flex items-center justify-center ${p0 ? "bg-blue-600 border-blue-400" : "bg-gray-700 border-gray-600"}`,
                                    children: p0 && A("span", {
                                        class: "text-white text-xs",
                                        children: "✓"
                                    })
                                })
                            })]
                        }), A("div", {
                            class: "w-full p-2 flex items-center justify-between border-b border-gray-700",
                            onMouseEnter: () => N("unlimited-fps"),
                            children: [A("div", {
                                class: "w-1/3 text-white text-sm",
                                children: "Unlimited FPS"
                            }), A("div", {
                                class: "w-6 h-6 flex items-center justify-center bg-gray-800 cursor-pointer",
                                onClick: () => W8(!q0.display.unlimitedFPS),
                                children: A("div", {
                                    class: `w-5 h-5 border flex items-center justify-center ${q0.display.unlimitedFPS ? "bg-blue-600 border-blue-400" : "bg-gray-700 border-gray-600"}`,
                                    children: q0.display.unlimitedFPS && A("span", {
                                        class: "text-white text-xs",
                                        children: "✓"
                                    })
                                })
                            })]
                        }), !q0.display.unlimitedFPS && A(a$, {
                            label: "Frame Rate",
                            value: q0.display.targetFPS || 60,
                            min: 30,
                            max: 240,
                            step: 1,
                            onChange: (t0) => H0("targetFPS", t0),
                            onHover: () => N("fps"),
                            unit: " FPS"
                        })]
                    }), A(r$, {
                        label: "RENDERING"
                    }), A("div", {
                        class: "bg-black bg-opacity-30 p-1 rounded mb-4",
                        children: [A($u, {
                            value: q0.display.renderingAPI,
                            onChange: j8,
                            onHover: () => N("rendering-api")
                        }), A("div", {
                            class: "w-full p-2 flex items-center border-b border-gray-700 relative",
                            onMouseEnter: () => N("antialiasing"),
                            children: [A("div", {
                                class: "w-1/3 text-white text-sm",
                                children: "Antialiasing"
                            }), A("div", {
                                class: "flex-grow",
                                children: A("div", {
                                    class: "bg-gray-800 p-2 flex justify-between items-center",
                                    children: A("select", {
                                        class: "bg-gray-800 text-white text-sm w-full outline-none",
                                        value: q0.display.antialiasing || "msaa",
                                        onChange: (t0) => H0("antialiasing", t0.target.value),
                                        children: [A("option", {
                                            value: "off",
                                            children: "Off"
                                        }), A("option", {
                                            value: "msaa",
                                            children: "MSAA (Multi Sampling)"
                                        }), A("option", {
                                            value: "fxaa",
                                            children: "FXAA (Fast Approximate)"
                                        })]
                                    })
                                })
                            })]
                        }), A(qu, {
                            value: q0.display.resolutionScale || 1,
                            onChange: k8,
                            onHover: () => N("resolution-scale")
                        }), A("div", {
                            class: "w-full p-2 flex items-center justify-between border-b border-gray-700",
                            onMouseEnter: () => N("perfect-pixels"),
                            children: [A("div", {
                                class: "w-1/3 text-white text-sm",
                                children: "Perfect Pixels"
                            }), A("div", {
                                class: "w-6 h-6 flex items-center justify-center bg-gray-800 cursor-pointer",
                                onClick: () => P6(!q0.display.perfectPixels),
                                children: A("div", {
                                    class: `w-5 h-5 border flex items-center justify-center ${q0.display.perfectPixels ? "bg-blue-600 border-blue-400" : "bg-gray-700 border-gray-600"}`,
                                    children: q0.display.perfectPixels && A("span", {
                                        class: "text-white text-xs",
                                        children: "✓"
                                    })
                                })
                            })]
                        }), A("div", {
                            class: "w-full p-2 flex items-center justify-between border-b border-gray-700",
                            onMouseEnter: () => N("shadow-drawings"),
                            children: [A("div", {
                                class: "w-1/3 text-white text-sm",
                                children: "Shadow Drawings"
                            }), A("div", {
                                class: "w-6 h-6 flex items-center justify-center bg-gray-800 cursor-pointer",
                                onClick: () => H0("enableShadowDrawings", !(q0.display.enableShadowDrawings ?? !0)),
                                children: A("div", {
                                    class: `w-5 h-5 border flex items-center justify-center ${q0.display.enableShadowDrawings ?? !0 ? "bg-blue-600 border-blue-400" : "bg-gray-700 border-gray-600"}`,
                                    children: (q0.display.enableShadowDrawings ?? !0) && A("span", {
                                        class: "text-white text-xs",
                                        children: "✓"
                                    })
                                })
                            })]
                        }), A("div", {
                            class: "w-full p-2 flex items-center justify-between border-b border-gray-700",
                            onMouseEnter: () => N("show-player-names"),
                            children: [A("div", {
                                class: "w-1/3 text-white text-sm",
                                children: "Show Player Names"
                            }), A("div", {
                                class: "w-6 h-6 flex items-center justify-center bg-gray-800 cursor-pointer",
                                onClick: () => g7(!q0.display.showPlayerNames),
                                children: A("div", {
                                    class: `w-5 h-5 border flex items-center justify-center ${q0.display.showPlayerNames ? "bg-blue-600 border-blue-400" : "bg-gray-700 border-gray-600"}`,
                                    children: q0.display.showPlayerNames && A("span", {
                                        class: "text-white text-xs",
                                        children: "✓"
                                    })
                                })
                            })]
                        }), A("div", {
                            class: "w-full p-2 flex items-center justify-between border-b border-gray-700",
                            onMouseEnter: () => N("show-own-name"),
                            children: [A("div", {
                                class: "w-1/3 text-white text-sm",
                                children: "Show Own Name"
                            }), A("div", {
                                class: "w-6 h-6 flex items-center justify-center bg-gray-800 cursor-pointer",
                                onClick: () => j9(!q0.display.showOwnName),
                                children: A("div", {
                                    class: `w-5 h-5 border flex items-center justify-center ${q0.display.showOwnName ? "bg-blue-600 border-blue-400" : "bg-gray-700 border-gray-600"}`,
                                    children: q0.display.showOwnName && A("span", {
                                        class: "text-white text-xs",
                                        children: "✓"
                                    })
                                })
                            })]
                        }), A("div", {
                            class: "w-full p-2 flex items-center justify-between border-b border-gray-700",
                            onMouseEnter: () => N("show-avatars"),
                            children: [A("div", {
                                class: "w-1/3 text-white text-sm",
                                children: "Show Avatars"
                            }), A("div", {
                                class: "w-6 h-6 flex items-center justify-center bg-gray-800 cursor-pointer",
                                onClick: () => Z0(!q0.display.showAvatars),
                                children: A("div", {
                                    class: `w-5 h-5 border flex items-center justify-center ${q0.display.showAvatars ? "bg-blue-600 border-blue-400" : "bg-gray-700 border-gray-600"}`,
                                    children: q0.display.showAvatars && A("span", {
                                        class: "text-white text-xs",
                                        children: "✓"
                                    })
                                })
                            })]
                        }), A("div", {
                            class: "w-full p-2 flex items-center justify-between border-b border-gray-700",
                            onMouseEnter: () => N("show-player-decorator"),
                            children: [A("div", {
                                class: "w-1/3 text-white text-sm",
                                children: "Show Player Decorator"
                            }), A("div", {
                                class: "w-6 h-6 flex items-center justify-center bg-gray-800 cursor-pointer",
                                onClick: () => G0(!q0.display.showPlayerDecorator),
                                children: A("div", {
                                    class: `w-5 h-5 border flex items-center justify-center ${q0.display.showPlayerDecorator ? "bg-blue-600 border-blue-400" : "bg-gray-700 border-gray-600"}`,
                                    children: q0.display.showPlayerDecorator && A("span", {
                                        class: "text-white text-xs",
                                        children: "✓"
                                    })
                                })
                            })]
                        }), A("div", {
                            class: "w-full p-2 flex items-center justify-between border-b border-gray-700",
                            onMouseEnter: () => N("decorator-color"),
                            children: [A("div", {
                                class: "w-1/3 text-white text-sm",
                                children: "Decorator Color"
                            }), A("div", {
                                class: "flex items-center gap-2",
                                children: A("input", {
                                    type: "color",
                                    value: q0.display.playerDecoratorColor || "#FFFFFF",
                                    onInput: (t0) => z8(t0.target.value),
                                    class: "w-8 h-6 bg-gray-800 border border-gray-600 cursor-pointer"
                                })
                            })]
                        }), A(a$, {
                            label: "Decorator Opacity",
                            value: q0.display.playerDecoratorOpacity ?? 0.3,
                            min: 0,
                            max: 1,
                            step: 0.01,
                            onChange: Z8,
                            onHover: () => N("decorator-opacity")
                        }), A("div", {
                            class: "w-full p-2 flex items-center justify-between border-b border-gray-700",
                            onMouseEnter: () => N("decorator-all"),
                            children: [A("div", {
                                class: "w-1/3 text-white text-sm",
                                children: "Decorator For All Players"
                            }), A("div", {
                                class: "w-6 h-6 flex items-center justify-center bg-gray-800 cursor-pointer",
                                onClick: () => G8(!q0.display.showPlayerDecoratorAll),
                                children: A("div", {
                                    class: `w-5 h-5 border flex items-center justify-center ${q0.display.showPlayerDecoratorAll ? "bg-blue-600 border-blue-400" : "bg-gray-700 border-gray-600"}`,
                                    children: (q0.display.showPlayerDecoratorAll || !1) && A("span", {
                                        class: "text-white text-xs",
                                        children: "✓"
                                    })
                                })
                            })]
                        })]
                    }), A(r$, {
                        label: "CHAT"
                    }), A("div", {
                        class: "bg-black bg-opacity-30 p-1 rounded mb-4",
                        children: [A("div", {
                            class: "w-full p-2 flex items-center justify-between border-b border-gray-700",
                            onMouseEnter: () => N("disable-bottom-bar"),
                            children: [A("div", {
                                class: "w-1/3 text-white text-sm",
                                children: "Disable Bottom Bar"
                            }), A("div", {
                                class: "w-6 h-6 flex items-center justify-center bg-gray-800 cursor-pointer",
                                onClick: () => H0("disableBottomBar", !(q0.display.disableBottomBar ?? !0)),
                                children: A("div", {
                                    class: `w-5 h-5 border flex items-center justify-center ${q0.display.disableBottomBar ?? !0 ? "bg-blue-600 border-blue-400" : "bg-gray-700 border-gray-600"}`,
                                    children: (q0.display.disableBottomBar ?? !0) && A("span", {
                                        class: "text-white text-xs",
                                        children: "✓"
                                    })
                                })
                            })]
                        }), A("div", {
                            class: "w-full p-2 flex items-center justify-between border-b border-gray-700",
                            onMouseEnter: () => N("chat-bubbles"),
                            children: [A("div", {
                                class: "w-1/3 text-white text-sm",
                                children: "Chat Bubbles"
                            }), A("div", {
                                class: "w-6 h-6 flex items-center justify-center bg-gray-800 cursor-pointer",
                                onClick: () => H0("chatBubbles", !(q0.display.chatBubbles ?? !0)),
                                children: A("div", {
                                    class: `w-5 h-5 border flex items-center justify-center ${q0.display.chatBubbles ?? !0 ? "bg-blue-600 border-blue-400" : "bg-gray-700 border-gray-600"}`,
                                    children: (q0.display.chatBubbles ?? !0) && A("span", {
                                        class: "text-white text-xs",
                                        children: "✓"
                                    })
                                })
                            })]
                        })]
                    }), A("div", {
                        class: "h-8"
                    })]
                }), A("div", {
                    class: "w-[30%] bg-white bg-opacity-5 rounded p-6 overflow-y-auto",
                    style: {
                        maxHeight: "calc(100vh - 200px)",
                        scrollbarWidth: "thin",
                        scrollbarColor: "rgba(255,255,255,0.3) transparent"
                    },
                    children: [A("h2", {
                        class: "text-xl font-bold text-white mb-4",
                        children: a.title
                    }), A("p", {
                        class: "text-gray-300 text-sm whitespace-pre-wrap",
                        children: a.description
                    })]
                })]
            })
        }
        , A0 = () => {
            let { settings: a, updateAudioSetting: q0 } = h5();
            return A("div", {
                class: "flex h-full",
                children: [A("div", {
                    class: "w-[70%] pr-6 overflow-y-auto",
                    style: {
                        maxHeight: "calc(100vh - 200px)",
                        scrollbarWidth: "thin",
                        scrollbarColor: "rgba(255,255,255,0.3) transparent"
                    },
                    children: [A(r$, {
                        label: "SOUND EFFECTS"
                    }), A("div", {
                        class: "bg-black bg-opacity-30 p-1 rounded mb-4",
                        children: [A(a$, {
                            label: "Ball Volume",
                            value: a.audio.ballVolume,
                            min: 0,
                            max: 1,
                            step: 0.01,
                            onChange: (H0) => q0("ballVolume", H0),
                            displayAsPercentage: !0,
                            unit: "",
                            onHover: () => N("ball-volume")
                        }), A(a$, {
                            label: "Goal Post Sound",
                            value: a.audio.goalPostVolume ?? a.audio.ballVolume,
                            min: 0,
                            max: 1,
                            step: 0.01,
                            onChange: (H0) => q0("goalPostVolume", H0),
                            displayAsPercentage: !0,
                            unit: "",
                            onHover: () => N("goal-post-volume")
                        }), A(a$, {
                            label: "Chat Volume",
                            value: a.audio.chatVolume || 0,
                            min: 0,
                            max: 1,
                            step: 0.01,
                            onChange: (H0) => q0("chatVolume", H0),
                            displayAsPercentage: !0,
                            unit: "",
                            onHover: () => N("chat-volume")
                        }), A(a$, {
                            label: "Goal Score Volume",
                            value: a.audio.goalVolume,
                            min: 0,
                            max: 1,
                            step: 0.01,
                            onChange: (H0) => q0("goalVolume", H0),
                            displayAsPercentage: !0,
                            unit: "",
                            onHover: () => N("goal-volume")
                        })]
                    }), A("div", {
                        class: "h-8"
                    })]
                }), A("div", {
                    class: "w-[30%] bg-white bg-opacity-5 rounded p-6 overflow-y-auto",
                    style: {
                        maxHeight: "calc(100vh - 200px)",
                        scrollbarWidth: "thin",
                        scrollbarColor: "rgba(255,255,255,0.3) transparent"
                    },
                    children: [A("h2", {
                        class: "text-xl font-bold text-white mb-4",
                        children: "Audio Settings"
                    }), A("p", {
                        class: "text-gray-300 text-sm",
                        children: U === "ball-volume" ? "Controls the volume of in-game ball sounds like kicks and goals." : U === "chat-volume" ? "Controls the volume of chat notification sounds when players send messages." : U === "goal-volume" ? "Controls the volume of goal score celebration sounds when goals are scored." : "Adjust volume levels for game sounds to enhance your experience."
                    })]
                })]
            })
        }
        ;
    function B0({ label: a, action: q0, bindIndex: H0, currentKey: p0, onKeyChange: w8, onHover: y8 }) {
        let j8 = (W8) => {
            if (!W8)
                return "NONE";
            let P6 = {
                Space: "SPACE",
                ArrowUp: "↑",
                ArrowDown: "↓",
                ArrowLeft: "←",
                ArrowRight: "→",
                ShiftLeft: "L-SHIFT",
                ShiftRight: "R-SHIFT",
                ControlLeft: "L-CTRL",
                ControlRight: "R-CTRL",
                AltLeft: "L-ALT",
                AltRight: "R-ALT",
                Enter: "ENTER",
                Backspace: "BACKSPACE",
                CapsLock: "CAPS",
                Tab: "TAB",
                Escape: "ESC"
            };
            if (W8.startsWith("Key"))
                return W8.replace("Key", "");
            if (W8.startsWith("Digit"))
                return W8.replace("Digit", "");
            return P6[W8] || W8
        }
            , k8 = (W8) => {
                W8.preventDefault(),
                    W8.stopPropagation(),
                    b0({
                        action: q0,
                        bindIndex: H0
                    })
            }
            ;
        return A("div", {
            className: "flex items-center justify-center",
            children: A("button", {
                className: "w-20 h-10 flex items-center justify-center bg-gray-700 border border-gray-600 text-gray-200 hover:bg-gray-600",
                onClick: k8,
                onMouseDown: k8,
                onMouseEnter: y8,
                children: j8(p0)
            })
        })
    }
    function N0({ label: a, action: q0, primaryKey: H0, secondaryKey: p0, onKeyChange: w8, onHover: y8 }) {
        return A("div", {
            class: "w-full p-2 flex items-center border-b border-gray-700",
            onMouseEnter: y8,
            children: [A("div", {
                class: "w-1/3 text-white text-sm",
                children: a
            }), A("div", {
                class: "flex-grow flex items-center justify-around gap-4",
                children: [A(B0, {
                    label: `Primary ${a}`,
                    action: q0,
                    bindIndex: 0,
                    currentKey: H0,
                    onKeyChange: w8
                }), A(B0, {
                    label: `Secondary ${a}`,
                    action: q0,
                    bindIndex: 1,
                    currentKey: p0,
                    onKeyChange: w8
                })]
            })]
        })
    }
    function R0({ activeKeybind: a, onClose: q0, onKeyChange: H0 }) {
        if (i0(() => {
            if (!a)
                return;
            let p0 = (w8) => {
                if (w8.preventDefault(),
                    w8.stopPropagation(),
                    w8.code === "Tab")
                    return;
                if (w8.code === "Escape") {
                    q0();
                    return
                }
                H0(a.action, a.bindIndex, w8.code),
                    q0()
            }
                ;
            return global.addEventListener("keydown", p0, !0),
                () => {
                    global.removeEventListener("keydown", p0, !0)
                }
        }
            , [a, q0, H0]),
            !a)
            return null;
        return A("div", {
            className: "fixed inset-0 flex items-center justify-center z-50",
            children: [A("div", {
                className: "absolute inset-0 bg-black bg-opacity-70",
                onClick: q0
            }), A("div", {
                className: "bg-gray-800 border-2 border-blue-500 p-4 rounded-md z-10 w-96",
                children: [A("div", {
                    className: "text-white text-lg font-bold mb-4 text-center",
                    children: "Press any key"
                }), A("div", {
                    className: "bg-blue-600 text-white text-center py-8 mb-4 rounded",
                    children: "LISTENING FOR KEY INPUT"
                }), A("div", {
                    className: "text-gray-400 text-sm mb-4 text-center",
                    children: "Press Escape to cancel"
                }), A("button", {
                    className: "w-full bg-gray-700 hover:bg-gray-600 text-white py-2 rounded",
                    onClick: q0,
                    children: "Cancel"
                })]
            })]
        })
    }
    let $8 = () => {
        let { settings: a, updateKeyboardSetting: q0 } = h5()
            , H0 = (y8, j8, k8) => {
                q0(y8, j8, k8)
            }
            , w8 = (() => {
                switch (U) {
                    case "move-up":
                        return {
                            title: "Move Forward",
                            description: "Keys used to move your player forward/upward on the field."
                        };
                    case "move-down":
                        return {
                            title: "Move Backward",
                            description: "Keys used to move your player backward/downward on the field."
                        };
                    case "move-left":
                        return {
                            title: "Move Left",
                            description: "Keys used to move your player to the left on the field."
                        };
                    case "move-right":
                        return {
                            title: "Move Right",
                            description: "Keys used to move your player to the right on the field."
                        };
                    case "kick":
                        return {
                            title: "Kick",
                            description: "Keys used to kick the ball."
                        };
                    case "zoom-in":
                        return {
                            title: "Zoom In",
                            description: "Keys used to zoom the camera closer to the action."
                        };
                    case "zoom-out":
                        return {
                            title: "Zoom Out",
                            description: "Keys used to zoom the camera further away from the action."
                        };
                    case "camera-1":
                        return {
                            title: "Camera View 1",
                            description: "Switch to camera view 1 - Follow your player closely."
                        };
                    case "camera-2":
                        return {
                            title: "Camera View 2",
                            description: "Switch to camera view 2 - Follow your player with medium distance."
                        };
                    case "camera-3":
                        return {
                            title: "Camera View 3",
                            description: "Switch to camera view 3 - Follow your player with far distance."
                        };
                    case "camera-4":
                        return {
                            title: "Camera View 4",
                            description: "Switch to camera view 4 - Show the entire field."
                        };
                    case "camera-5":
                        return {
                            title: "Camera View 5",
                            description: "Switch to camera view 5 - Free camera mode."
                        };
                    default:
                        return {
                            title: "Keyboard Controls",
                            description: "Configure your keyboard controls for movement and actions. Click on a key binding to change it. Press any key when prompted to set a new binding."
                        }
                }
            }
            )();
        return A("div", {
            class: "flex h-full",
            children: [A("div", {
                class: "w-[70%] pr-6 overflow-y-auto",
                style: {
                    maxHeight: "calc(100vh - 200px)",
                    scrollbarWidth: "thin",
                    scrollbarColor: "rgba(255,255,255,0.3) transparent"
                },
                onWheel: (y8) => {
                    y8.stopPropagation()
                }
                ,
                children: [A(r$, {
                    label: "MOVEMENT"
                }), A("div", {
                    class: "bg-black bg-opacity-30 p-1 rounded mb-4",
                    children: [A(N0, {
                        label: "Forward",
                        action: "up",
                        primaryKey: a.keyboard.up[0],
                        secondaryKey: a.keyboard.up[1],
                        onKeyChange: H0,
                        onHover: () => N("move-up")
                    }), A(N0, {
                        label: "Back",
                        action: "down",
                        primaryKey: a.keyboard.down[0],
                        secondaryKey: a.keyboard.down[1],
                        onKeyChange: H0,
                        onHover: () => N("move-down")
                    }), A(N0, {
                        label: "Left",
                        action: "left",
                        primaryKey: a.keyboard.left[0],
                        secondaryKey: a.keyboard.left[1],
                        onKeyChange: H0,
                        onHover: () => N("move-left")
                    }), A(N0, {
                        label: "Right",
                        action: "right",
                        primaryKey: a.keyboard.right[0],
                        secondaryKey: a.keyboard.right[1],
                        onKeyChange: H0,
                        onHover: () => N("move-right")
                    })]
                }), A(r$, {
                    label: "ACTIONS"
                }), A("div", {
                    class: "bg-black bg-opacity-30 p-1 rounded mb-4",
                    children: A(N0, {
                        label: "Kick",
                        action: "kick",
                        primaryKey: a.keyboard.kick[0],
                        secondaryKey: a.keyboard.kick[1],
                        onKeyChange: H0,
                        onHover: () => N("kick")
                    })
                }), A(r$, {
                    label: "CAMERA CONTROLS"
                }), A("div", {
                    class: "bg-black bg-opacity-30 p-1 rounded mb-4",
                    children: [A(N0, {
                        label: "Zoom In",
                        action: "zoomIn",
                        primaryKey: a.keyboard.zoomIn[0],
                        secondaryKey: a.keyboard.zoomIn[1],
                        onKeyChange: H0,
                        onHover: () => N("zoom-in")
                    }), A(N0, {
                        label: "Zoom Out",
                        action: "zoomOut",
                        primaryKey: a.keyboard.zoomOut[0],
                        secondaryKey: a.keyboard.zoomOut[1],
                        onKeyChange: H0,
                        onHover: () => N("zoom-out")
                    }), A(N0, {
                        label: "Camera 1",
                        action: "camera1",
                        primaryKey: a.keyboard.camera1[0],
                        secondaryKey: a.keyboard.camera1[1],
                        onKeyChange: H0,
                        onHover: () => N("camera-1")
                    }), A(N0, {
                        label: "Camera 2",
                        action: "camera2",
                        primaryKey: a.keyboard.camera2[0],
                        secondaryKey: a.keyboard.camera2[1],
                        onKeyChange: H0,
                        onHover: () => N("camera-2")
                    }), A(N0, {
                        label: "Camera 3",
                        action: "camera3",
                        primaryKey: a.keyboard.camera3[0],
                        secondaryKey: a.keyboard.camera3[1],
                        onKeyChange: H0,
                        onHover: () => N("camera-3")
                    }), A(N0, {
                        label: "Camera 4",
                        action: "camera4",
                        primaryKey: a.keyboard.camera4[0],
                        secondaryKey: a.keyboard.camera4[1],
                        onKeyChange: H0,
                        onHover: () => N("camera-4")
                    }), A(N0, {
                        label: "Camera 5",
                        action: "camera5",
                        primaryKey: a.keyboard.camera5[0],
                        secondaryKey: a.keyboard.camera5[1],
                        onKeyChange: H0,
                        onHover: () => N("camera-5")
                    })]
                }), A("div", {
                    class: "h-8"
                })]
            }), A("div", {
                class: "w-[30%] bg-white bg-opacity-5 rounded p-6 overflow-y-auto",
                style: {
                    maxHeight: "calc(100vh - 200px)",
                    scrollbarWidth: "thin",
                    scrollbarColor: "rgba(255,255,255,0.3) transparent"
                },
                children: [A("h2", {
                    class: "text-xl font-bold text-white mb-4",
                    children: w8.title
                }), A("p", {
                    class: "text-gray-300 text-sm whitespace-pre-wrap",
                    children: w8.description
                })]
            }), A(R0, {
                activeKeybind: F0,
                onClose: () => b0(null),
                onKeyChange: H0
            })]
        })
    }
        , N8 = () => {
            switch (H) {
                case "TEAMS":
                    return t();
                case "DISPLAY":
                    return X0();
                case "AUDIO":
                    return A0();
                case "KEYBOARD":
                    return $8();
                default:
                    return A("div", {
                        class: "text-white text-center py-12",
                        children: [H, " settings coming soon."]
                    })
            }
        }
        ;
    return i0(() => {
        let a = document.createElement("style");
        return a.textContent = `
      .game-menu-scroll::-webkit-scrollbar {
        width: 8px;
      }
      .game-menu-scroll::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
      }
      .game-menu-scroll::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 4px;
      }
      .game-menu-scroll::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.5);
      }
      .team-scroll::-webkit-scrollbar {
        width: 6px;
      }
      .team-scroll::-webkit-scrollbar-track {
        background: transparent;
      }
      .team-scroll::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.2);
        border-radius: 3px;
      }
      .team-scroll::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.4);
      }
    `,
            document.head.appendChild(a),
            () => {
                if (document.head.contains(a))
                    document.head.removeChild(a)
            }
    }
        , []),
        A("div", {
            className: "fixed inset-0 z-40",
            children: [A("div", {
                className: "w-full h-full select-none flex flex-col bg-gradient-to-br from-[#1a1e4d] to-[#2a2f5a]",
                children: [A("div", {
                    className: "flex items-center justify-between p-4 bg-[#121621] flex-shrink-0",
                    children: [A("div", {
                        className: "text-3xl font-bold text-white uppercase tracking-wider",
                        children: "SETTINGS"
                    }), A("div", {
                        className: "flex items-center gap-3",
                        children: [A("button", {
                            onClick: () => {
                                if (b)
                                    b.leave(),
                                        global.location.href = "/"
                            }
                            ,
                            className: "text-red-400 hover:text-red-300 p-2 font-medium transition-colors",
                            children: "LEAVE GAME"
                        }), A("button", {
                            onClick: G6,
                            className: "text-gray-400 hover:text-white p-2",
                            children: "✕ CLOSE"
                        })]
                    })]
                }), A("div", {
                    className: "flex bg-[#121621] px-4 pt-2 flex-shrink-0",
                    children: Object.values(_b).map((a) => A("div", {
                        className: `px-4 py-2 uppercase font-bold cursor-pointer ${H === a ? "text-white border-b-2 border-white" : "text-gray-400 border-b-2 border-transparent hover:text-gray-200"}`,
                        onClick: () => Y(a),
                        children: a
                    }, a))
                }), A("div", {
                    className: "flex-1 overflow-hidden p-4 relative",
                    children: [A("div", {
                        className: "h-full overflow-auto game-menu-scroll",
                        style: {
                            scrollbarWidth: "thin",
                            scrollbarColor: "rgba(255,255,255,0.3) transparent"
                        },
                        children: N8()
                    }), H === "DISPLAY" && A("div", {
                        className: "absolute bottom-6 right-6 flex z-10",
                        children: [A(Mb, {
                            label: "RESTORE DEFAULTS",
                            onClick: () => { }
                        }), A(Mb, {
                            label: "BACK",
                            onClick: G6
                        })]
                    })]
                })]
            }), A(K0, {}), A(C0, {}), A("input", {
                ref: o,
                type: "file",
                accept: ".hbs,.json",
                style: {
                    display: "none"
                },
                onChange: h8
            })]
        })
}
function qu({ value: J, onChange: Q, onHover: Z }) {
    let [$, q] = C8(!1)
        , K = [{
            id: "default",
            label: "Default (Native)"
        }, {
            id: 1,
            label: "1x"
        }, {
            id: 0.75,
            label: "0.75x"
        }, {
            id: 0.5,
            label: "0.5x"
        }, {
            id: 0.25,
            label: "0.25x"
        }]
        , V = K.find((z) => z.id === J) || K.find((z) => z.id === 1) || K[0];
    return A("div", {
        class: "w-full p-2 flex items-center border-b border-gray-700 relative",
        onMouseEnter: Z,
        children: [A("div", {
            class: "w-1/3 text-white text-sm",
            children: "Resolution Scale"
        }), A("div", {
            class: "flex-grow",
            children: [A("div", {
                class: "bg-gray-800 p-2 flex justify-between items-center cursor-pointer",
                onClick: () => q(!$),
                children: [A("span", {
                    class: "text-white text-sm",
                    children: V.label
                }), A("span", {
                    class: "text-gray-400",
                    children: $ ? "▲" : "▼"
                })]
            }), $ && A("div", {
                class: "absolute z-20 bg-gray-800 border border-gray-700 w-64 mt-1 right-2",
                children: K.map((z) => A("div", {
                    class: `p-2 cursor-pointer ${J === z.id ? "bg-blue-600" : "hover:bg-gray-700"}`,
                    onClick: () => {
                        Q(z.id),
                            q(!1)
                    }
                    ,
                    children: A("span", {
                        class: "text-white text-sm",
                        children: z.label
                    })
                }, z.id))
            })]
        })]
    })
}
var r$ = ({ label: J }) => A("div", {
    class: "bg-black bg-opacity-30 px-4 py-2 text-white font-bold mb-2 mt-4 flex items-center uppercase text-sm tracking-wider",
    children: [A("div", {
        class: "border-r-2 border-yellow-500 h-4 mr-2"
    }), " ", J]
})
    , Mb = ({ label: J, onClick: Q }) => A("button", {
        class: "bg-blue-600 bg-opacity-70 text-white px-4 py-1 rounded text-sm ml-2 hover:bg-opacity-100 transition-colors",
        onClick: Q,
        children: J
    });
var bb = n5({
    isChatFocused: !1,
    activateChat: () => { }
    ,
    deactivateChat: () => { }
    ,
    toggleChat: () => { }
    ,
    sendMessage: () => { }
    ,
    inputRef: null,
    setInputRef: () => { }
    ,
    chatHeight: 200,
    setChatHeight: () => { }
    ,
    gameMovementFactor: 1
})
    , ZO = () => O9(bb)
    , vb = ({ children: J }) => {
        let { room: Q } = qJ()
            , [Z, $] = C8(!1)
            , [q, K] = C8(null)
            , [V, z] = C8(200)
            , [W, H] = C8(0.75)
            , Y = () => {
                if ($(!0),
                    Q)
                    Q.sendChatIndicator(!0);
                if (q?.current)
                    q.current.disabled = !1,
                        q.current.focus(),
                        setTimeout(() => {
                            if (q?.current)
                                q.current.focus()
                        }
                            , 0),
                        setTimeout(() => {
                            if (q?.current)
                                q.current.focus()
                        }
                            , 50)
            }
            , U = () => {
                if (q?.current)
                    q.current.blur();
                if (Q)
                    Q.sendChatIndicator(!1);
                $(!1),
                    document.body.focus()
            }
            , N = () => {
                if (Z)
                    U();
                else
                    Y()
            }
            , j = (F) => {
                if (!F.trim() || !Q)
                    return;
                try {
                    if (Q.sendChat)
                        Q.sendChat(F);
                    if (Q)
                        Q.sendChatIndicator(0);
                    if (q?.current)
                        setTimeout(() => {
                            if (q.current) {
                                q.current.focus();
                                let P = q.current.value.length;
                                q.current.setSelectionRange(P, P)
                            }
                        }
                            , 50)
                } catch (P) { }
            }
            , k = (F) => {
                K(F)
            }
            ;
        i0(() => {
            return global.chatIsFocused = Z,
                global.toggleChatFocus = N,
                () => {
                    global.chatIsFocused = !1,
                        global.toggleChatFocus = void 0
                }
        }
            , [Z]),
            i0(() => {
                let F = (P) => {
                    if (P.key === "Tab") {
                        let M = document.activeElement
                            , v = M?.tagName.toLowerCase();
                        if (!(v === "input" || v === "textarea" || v === "select") || M !== q?.current) {
                            P.preventDefault(),
                                Y();
                            return
                        }
                    }
                    if (P.key === "Enter" && !Z) {
                        let v = document.activeElement?.tagName.toLowerCase();
                        if (v !== "input" && v !== "textarea") {
                            P.preventDefault(),
                                Y();
                            return
                        }
                    }
                    if (P.key === "Tab") {
                        P.preventDefault(),
                            N();
                        return
                    }
                }
                    ;
                return document.addEventListener("keydown", F),
                    () => {
                        document.removeEventListener("keydown", F)
                    }
            }
                , [Z, Y, N, q]);
        let L = {
            isChatFocused: Z,
            activateChat: Y,
            deactivateChat: U,
            toggleChat: N,
            sendMessage: j,
            inputRef: q,
            setInputRef: k,
            chatHeight: V,
            setChatHeight: z,
            gameMovementFactor: W
        };
        return A(bb.Provider, {
            value: L,
            children: J
        })
    }
    ;
class Sb {
    roomInstance;
    keyState = 0;
    keyMap = new Map;
    constructor(J, Q) {
        this.roomInstance = J;
        if (Q)
            this.keyMap = Q
    }
    updateState() {
        this.roomInstance?.setKeyState(this.keyState, !0)
    }
    updateKeyMap(J) {
        this.keyMap = J
    }
    pressKey(J) {
        let Q = this.keyMap.get(J);
        if (!Q)
            return;
        let Z = this.keyState | Q;
        if (Z !== this.keyState)
            this.keyState = Z,
                this.updateState()
    }
    releaseKey(J) {
        let Q = this.keyMap.get(J);
        if (!Q)
            return;
        let Z = this.keyState & ~Q;
        if (Z !== this.keyState)
            this.keyState = Z,
                this.updateState()
    }
    reset() {
        if (this.keyState === 0)
            return;
        this.keyState = 0,
            this.updateState()
    }
    cleanup() { }
}
function Tb() {
    let { room: J } = qJ()
        , { isChatFocused: Q, toggleChat: Z } = ZO()
        , { settings: $ } = h5()
        , { isGameMenuActive: q } = QO()
        , K = n0(null)
        , V = n0(new Set)
        , z = u7(() => {
            let N = new Map;
            if ($.keyboard.up[0])
                N.set($.keyboard.up[0], 1);
            if ($.keyboard.up[1])
                N.set($.keyboard.up[1], 1);
            if ($.keyboard.down[0])
                N.set($.keyboard.down[0], 2);
            if ($.keyboard.down[1])
                N.set($.keyboard.down[1], 2);
            if ($.keyboard.left[0])
                N.set($.keyboard.left[0], 4);
            if ($.keyboard.left[1])
                N.set($.keyboard.left[1], 4);
            if ($.keyboard.right[0])
                N.set($.keyboard.right[0], 8);
            if ($.keyboard.right[1])
                N.set($.keyboard.right[1], 8);
            if ($.keyboard.kick[0])
                N.set($.keyboard.kick[0], 16);
            if ($.keyboard.kick[1])
                N.set($.keyboard.kick[1], 16);
            return N
        }
            , [$.keyboard]);
    i0(() => {
        if (K.current) {
            let N = z();
            K.current.updateKeyMap(N)
        }
    }
        , [$.keyboard, z]);
    let W = u7((N) => {
        if (Q || q)
            return;
        let { code: j } = N;
        if (j === "Tab") {
            N.preventDefault(),
                V.current.forEach((k) => {
                    K.current?.releaseKey(k)
                }
                ),
                V.current.clear(),
                K.current?.reset(),
                Z?.();
            return
        }
        if (K.current?.updateKeyMap && z().has(j))
            N.preventDefault(),
                V.current.add(j),
                K.current?.pressKey(j)
    }
        , [Q, q, Z, z])
        , H = u7((N) => {
            if (Q || q)
                return;
            let { code: j } = N;
            if (z().has(j))
                V.current.delete(j),
                    K.current?.releaseKey(j)
        }
            , [Q, q, z]);
    i0(() => {
        if (Q || q)
            V.current.forEach((N) => {
                K.current?.releaseKey(N)
            }
            ),
                V.current.clear(),
                K.current?.reset()
    }
        , [Q, q]);
    let Y = n0(null)
        , U = u7(() => {
            if (Y.current)
                global.clearTimeout(Y.current);
            Y.current = global.setTimeout(() => {
                if (document.hidden)
                    K.current?.reset();
                Y.current = null
            }
                , 16)
        }
            , []);
    return i0(() => {
        let N = () => {
            if (K.current) {
                let j = z();
                K.current.updateKeyMap(j)
            }
        }
            ;
        return global.addEventListener("keyboard_settings_changed", N),
            () => {
                global.removeEventListener("keyboard_settings_changed", N)
            }
    }
        , [z]),
        i0(() => {
            let N = z();
            return K.current = J ? new Sb(J, N) : null,
                () => {
                    if (K.current)
                        K.current.cleanup(),
                            K.current.reset(),
                            K.current = null
                }
        }
            , [J, z]),
        i0(() => {
            if (!J)
                return;
            return document.addEventListener("keydown", W, {
                capture: !0,
                passive: !1
            }),
                document.addEventListener("keyup", H, {
                    capture: !0
                }),
                document.addEventListener("visibilitychange", U),
                () => {
                    if (Y.current)
                        global.clearTimeout(Y.current);
                    document.removeEventListener("keydown", W, {
                        capture: !0
                    }),
                        document.removeEventListener("keyup", H, {
                            capture: !0
                        }),
                        document.removeEventListener("visibilitychange", U)
                }
        }
            , [J, W, H, U]),
        null
}
function yb() {
    let { room: J } = qJ()
        , [Q, Z] = C8({
            redScore: 0,
            blueScore: 0,
            timeElapsed: 0,
            timeLimit: 0,
            scoreLimit: 0
        })
        , $ = n0(0)
        , q = u7(() => {
            if (!J?.gameState)
                return;
            let W = J.gameState, H;
            if (W.teams) {
                let Y = W.teams
                    , U = Y.find((j) => j.id === 1 || j.name?.toLowerCase() === "red")
                    , N = Y.find((j) => j.id === 2 || j.name?.toLowerCase() === "blue");
                H = {
                    redScore: U?.score || 0,
                    blueScore: N?.score || 0,
                    timeElapsed: W.time || W.timeElapsed || 0,
                    timeLimit: W.timeLimit || 0,
                    scoreLimit: W.scoreLimit || 0
                }
            } else if (W)
                H = {
                    redScore: W.redScore || 0,
                    blueScore: W.blueScore || 0,
                    timeElapsed: W.timeElapsed || 0,
                    timeLimit: W.timeLimit || 0,
                    scoreLimit: W.scoreLimit || 0
                };
            if (H)
                Z((Y) => {
                    if (JSON.stringify(H) !== JSON.stringify(Y))
                        return H;
                    return Y
                }
                )
        }
            , [J]);
    i0(() => {
        if (!J)
            return;
        q();
        let W = [];
        W.push(v6.on("teamGoal", q), v6.on("gameStart", q), v6.on("gameEnd", q), v6.on("stadiumChange", q));
        let H = setInterval(() => {
            if (J?.gameState) {
                let Y = J.gameState.time || J.gameState.timeElapsed || 0;
                if (Y !== $.current)
                    $.current = Y,
                        q()
            }
        }
            , 100);
        return () => {
            W.forEach((Y) => Y()),
                clearInterval(H)
        }
    }
        , [J, q]);
    let K = pQ(() => {
        let W = Math.floor(Q.timeElapsed / 60)
            , H = Math.floor(Q.timeElapsed % 60);
        return `${W.toString().padStart(2, "0")}:${H.toString().padStart(2, "0")}`
    }
        , [Q.timeElapsed])
        , V = pQ(() => {
            if (!Q.timeLimit)
                return !1;
            let W = Q.timeLimit * 60;
            return W > 0 && Q.timeElapsed > W
        }
            , [Q.timeLimit, Q.timeElapsed])
        , z = pQ(() => {
            if (!Q.timeLimit)
                return 0;
            let W = Q.timeLimit * 60;
            return Math.min(100, Q.timeElapsed / W * 100)
        }
            , [Q.timeLimit, Q.timeElapsed]);
    return A("div", {
        className: "fixed top-0 left-0 w-full flex justify-center z-30 select-none",
        children: A("div", {
            className: "flex items-center justify-between bg-gray-800 bg-opacity-90 text-white px-6 py-2 rounded-b-md shadow-md min-w-[400px] font-sans",
            children: [A("div", {
                className: "flex items-center",
                children: [A("div", {
                    className: "flex items-center mr-3",
                    children: [A("div", {
                        className: "w-6 h-6 bg-red-500 rounded-full mr-2"
                    }), A("span", {
                        className: "text-2xl font-bold",
                        children: Q.redScore
                    })]
                }), A("span", {
                    className: "text-2xl font-bold mx-2",
                    children: "-"
                }), A("div", {
                    className: "flex items-center ml-3",
                    children: [A("span", {
                        className: "text-2xl font-bold",
                        children: Q.blueScore
                    }), A("div", {
                        className: "w-6 h-6 bg-blue-500 rounded-full ml-2"
                    })]
                })]
            }), A("div", {
                className: "flex items-center",
                children: A("div", {
                    className: `text-2xl font-mono font-extrabold tabular-nums tracking-tight ${V ? "text-orange-400 animate-pulse" : "text-white drop-shadow-md"}`,
                    children: [V && A("span", {
                        className: "mr-3 text-orange-400 font-sans text-lg font-semibold",
                        children: "OVERTIME!"
                    }), A("span", {
                        className: Q.timeLimit > 0 && Q.timeElapsed >= Q.timeLimit * 60 - 10 ? "animate-pulse" : "",
                        children: K
                    })]
                })
            })]
        })
    })
}
var Ku = ({ onEmojiSelect: J, visible: Q }) => {
    let Z = {
        smileys: ["\uD83D\uDE00", "\uD83D\uDE03", "\uD83D\uDE04", "\uD83D\uDE01", "\uD83D\uDE06", "\uD83D\uDE05", "\uD83D\uDE02", "\uD83E\uDD23", "\uD83D\uDE0A", "\uD83D\uDE07", "\uD83D\uDE42", "\uD83D\uDE43", "\uD83D\uDE09", "\uD83D\uDE0C", "\uD83D\uDE0D", "\uD83E\uDD70", "\uD83D\uDE18"],
        gestures: ["\uD83D\uDC4D", "\uD83D\uDC4E", "\uD83D\uDC4C", "✌️", "\uD83E\uDD1E", "\uD83E\uDD1F", "\uD83E\uDD18", "\uD83E\uDD19", "\uD83D\uDC48", "\uD83D\uDC49", "\uD83D\uDC46", "\uD83D\uDC47", "\uD83D\uDC4B", "\uD83E\uDD1A", "\uD83D\uDD90️", "✋", "\uD83D\uDD96"],
        activities: ["\uD83C\uDFAE", "\uD83C\uDFAF", "\uD83C\uDFB2", "\uD83E\uDDE9", "\uD83C\uDFAD", "\uD83C\uDFA8", "\uD83C\uDFAC", "\uD83C\uDFA4", "\uD83C\uDFA7", "\uD83C\uDFBC", "\uD83C\uDFB9", "\uD83E\uDD41", "\uD83C\uDFB7", "\uD83C\uDFBA", "\uD83C\uDFB8", "\uD83C\uDFBB", "\uD83C\uDFAC"],
        objects: ["\uD83D\uDC8E", "\uD83D\uDD2E", "\uD83C\uDF81", "\uD83C\uDF88", "\uD83C\uDF8A", "\uD83C\uDF89", "\uD83E\uDDF8", "\uD83E\uDE84", "\uD83D\uDCB0", "\uD83D\uDCA3", "\uD83E\uDDF2", "⚡", "\uD83D\uDD25", "\uD83D\uDCA5", "❄️", "\uD83C\uDF1F", "✨"]
    }
        , [$, q] = C8("smileys");
    if (!Q)
        return null;
    return A("div", {
        className: "absolute bottom-14 left-0 bg-gray-800 bg-opacity-90 border border-gray-700 rounded-md p-2 shadow-lg z-50 w-72",
        children: [A("div", {
            className: "flex mb-2 border-b border-gray-700 pb-2",
            children: [A("button", {
                onClick: () => q("smileys"),
                className: `mr-2 p-1 ${$ === "smileys" ? "bg-gray-700 rounded" : ""}`,
                children: "\uD83D\uDE00"
            }), A("button", {
                onClick: () => q("gestures"),
                className: `mr-2 p-1 ${$ === "gestures" ? "bg-gray-700 rounded" : ""}`,
                children: "\uD83D\uDC4D"
            }), A("button", {
                onClick: () => q("activities"),
                className: `mr-2 p-1 ${$ === "activities" ? "bg-gray-700 rounded" : ""}`,
                children: "\uD83C\uDFAE"
            }), A("button", {
                onClick: () => q("objects"),
                className: `mr-2 p-1 ${$ === "objects" ? "bg-gray-700 rounded" : ""}`,
                children: "\uD83D\uDC8E"
            })]
        }), A("div", {
            className: "grid grid-cols-8 gap-1",
            children: Z[$].map((K, V) => A("button", {
                onClick: () => J(K),
                className: "hover:bg-gray-700 p-1 rounded text-lg transition-colors",
                children: K
            }, V))
        })]
    })
}
    , Vu = `
  .hide-scrollbar::-webkit-scrollbar {
    display: none;
  }
  .hide-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  
  /* Message styling */
  .chat-message {
    opacity: 1;
    transition: opacity 0.3s ease-out, transform 0.3s ease-out;
  }
  
  /* When not focused, make old messages transparent but maintain their position */
  .chat-not-focused .chat-message {
    opacity: 0.1; /* Very faint but not completely gone */
    transform: scale(0.95); /* Slightly smaller */
  }
  
  /* Only show recent messages at full opacity when not focused */
  .chat-not-focused .chat-message.recent {
    opacity: 1;
    transform: scale(1);
    animation: fadeIn 0.3s ease-out forwards;
  }
  
  /* Animation for messages */
  @keyframes fadeIn {
    0% { opacity: 0; transform: translateY(10px); }
    100% { opacity: 1; transform: translateY(0); }
  }
`;
function fb() {
    let { room: J } = qJ()
        , { isChatFocused: Q, activateChat: Z, deactivateChat: $, toggleChat: q, sendMessage: K, inputRef: V, setInputRef: z, chatHeight: W, setChatHeight: H, gameMovementFactor: Y } = ZO()
        , { settings: U } = h5()
        , [N, j] = C8([])
        , [k, L] = C8(0)
        , [F, P] = C8(null)
        , [M, v] = C8(!1)
        , [E, n] = C8("")
        , u = n0("")
        , b = n0(null)
        , i = n0(null)
        , g = n0(null)
        , l = n0([])
        , o = n0(null)
        , F0 = n0(!1)
        , b0 = n0(null)
        , d0 = n0(Q)
        , [H8, E0] = C8([])
        , v0 = n0([])
        , [G6, I8] = C8("")
        , x0 = n0(null)
        , U8 = u7(() => {
            if (x0.current) {
                let O0 = x0.current;
                O0.scrollTop = O0.scrollHeight
            }
            if (b.current)
                b.current.scrollIntoView({
                    behavior: "auto"
                })
        }
            , [])
        , t8 = u7((O0) => {
            let h0 = requestAnimationFrame(O0);
            return v0.current.push(h0),
                h0
        }
            , [])
        , o8 = u7((O0) => {
            cancelAnimationFrame(O0),
                v0.current = v0.current.filter((h0) => h0 !== O0)
        }
            , []);
    i0(() => {
        if (d0.current = Q,
            Q) {
            L(0),
                U8();
            let O0 = setTimeout(() => {
                if (i.current) {
                    i.current.focus();
                    let h0 = i.current.value.length;
                    if (h0 > 0)
                        i.current.setSelectionRange(h0, h0);
                    if (z)
                        z({
                            current: i.current
                        })
                }
            }
                , 50);
            l.current.push(O0)
        } else
            v(!1);
        return () => {
            l.current.forEach((O0) => clearTimeout(O0)),
                l.current = []
        }
    }
        , [Q, U8]),
        i0(() => {
            let O0 = setInterval(() => {
                let h0 = Date.now();
                E0((R8) => R8.filter((X6) => h0 - X6 < 1e4))
            }
                , 1e4);
            return o.current = O0,
                () => {
                    if (o.current)
                        clearInterval(o.current),
                            o.current = null
                }
        }
            , []);
    let c8 = u7(() => {
        l.current.forEach((O0) => {
            clearTimeout(O0)
        }
        ),
            l.current = [],
            v0.current.forEach((O0) => {
                cancelAnimationFrame(O0)
            }
            ),
            v0.current = []
    }
        , []);
    i0(() => {
        return () => {
            if (c8(),
                b0.current)
                clearTimeout(b0.current),
                    b0.current = null;
            if (o.current)
                clearInterval(o.current),
                    o.current = null
        }
    }
        , []),
        i0(() => {
            if (i.current)
                z(i)
        }
            , []);
    let _8 = () => {
        if (c8(),
            Z(),
            global.chatIsFocused = !0,
            t8(() => {
                if (i.current) {
                    let O0 = i.current.value.length;
                    i.current.setSelectionRange(O0, O0)
                }
            }
            ),
            J)
            try {
                J.sendChatIndicator?.(1)
            } catch (O0) { }
    }
        , R6 = () => {
            global.chatIsFocused = !1,
                J?.sendChatIndicator(0)
        }
        ;
    i0(() => {
        let O0 = (h0) => {
            if (Q && g.current && !g.current.contains(h0.target))
                v(!1),
                    global.chatIsFocused = !1,
                    $()
        }
            ;
        return document.addEventListener("mousedown", O0),
            () => {
                document.removeEventListener("mousedown", O0)
            }
    }
        , [Q, $]),
        i0(() => {
            if (!J)
                return;
            try {
                let o0 = J.getPlayer(J.currentPlayerId);
                if (o0 && o0.name)
                    I8(o0.name)
            } catch (o0) { }
            let O0 = (o0) => {
                if (o0.playerId === J.currentPlayerId)
                    return;
                let C0 = `Player ${o0.playerId}`;
                try {
                    let J0 = J.getPlayer(o0.playerId);
                    if (J0 && J0.name)
                        C0 = J0.name
                } catch (J0) { }
                let K0 = {
                    id: Date.now(),
                    playerId: o0.playerId,
                    playerName: C0,
                    message: o0.message,
                    timestamp: new Date
                };
                if (j((J0) => [...J0, K0]),
                    !d0.current)
                    L((J0) => J0 + 1)
            }
                , h0 = (o0) => {
                    let C0 = {
                        id: Date.now(),
                        playerId: "system",
                        playerName: "[SYSTEM]",
                        message: o0.message,
                        timestamp: new Date,
                        isSystem: !0
                    };
                    if (j((K0) => [...K0, C0]),
                        !d0.current)
                        L((K0) => K0 + 1)
                }
                , R8 = v6.on("playerChat", O0)
                , X6 = v6.on("systemMessage", h0);
            global.toggleChatFocus = () => {
                if (Q)
                    $();
                else
                    Z()
            }
                ;
            let k0 = (o0) => {
                if (o0.key === "Tab")
                    if (o0.preventDefault(),
                        Q && document.activeElement === i.current)
                        $();
                    else
                        Z()
            }
                , U6 = (o0) => {
                    if (o0.key === "Escape" && document.activeElement === i.current)
                        v(!1),
                            $()
                }
                , V8 = (o0) => {
                    if (o0.key === "Enter" && !Q) {
                        let C0 = document.activeElement?.tagName.toLowerCase();
                        if (C0 !== "input" && C0 !== "textarea")
                            o0.preventDefault(),
                                Z()
                    }
                }
                ;
            return global.addEventListener("keydown", k0),
                global.addEventListener("keydown", U6),
                global.addEventListener("keydown", V8),
                () => {
                    R8(),
                        X6(),
                        global.removeEventListener("keydown", k0),
                        global.removeEventListener("keydown", U6),
                        global.removeEventListener("keydown", V8),
                        global.toggleChatFocus = void 0,
                        global.chatIsFocused = !1
                }
        }
            , [J, Q, H8]),
        i0(() => {
            if (b.current)
                b.current.scrollIntoView()
        }
            , []),
        i0(() => {
            return global.currentChatHeight = 200,
                () => {
                    global.currentChatHeight = 0
                }
        }
            , []);
    let n8 = (O0) => {
        O0.stopPropagation(),
            d6()
    }
        , q6 = (O0) => {
            if (i.current) {
                let h0 = i.current
                    , R8 = h0.selectionStart || 0
                    , X6 = h0.selectionEnd || 0
                    , k0 = h0.value
                    , U6 = k0.substring(0, R8) + O0 + k0.substring(X6);
                h0.value = U6,
                    u.current = U6,
                    n(U6);
                let V8 = R8 + O0.length;
                t8(() => {
                    h0.focus(),
                        h0.setSelectionRange(V8, V8)
                }
                )
            }
            v(!1)
        }
        , K6 = (O0) => {
            if (O0.preventDefault(),
                O0.stopPropagation(),
                v((h0) => !h0),
                !M) {
                let h0 = setTimeout(() => {
                    if (i.current)
                        i.current.focus()
                }
                    , 10);
                l.current.push(h0)
            }
        }
        , k6 = (O0) => {
            if (u.current = O0.target.value,
                n(O0.target.value),
                O0.target.value && !F0.current) {
                if (F0.current = !0,
                    J)
                    J.sendChatIndicator(!0)
            } else if (!O0.target.value && F0.current) {
                if (F0.current = !1,
                    J)
                    J.sendChatIndicator(!1)
            }
            if (b0.current)
                clearTimeout(b0.current);
            if (O0.target.value)
                b0.current = setTimeout(() => {
                    if (F0.current = !1,
                        J)
                        J.sendChatIndicator(!1)
                }
                    , 3000)
        }
        , y6 = () => {
            let O0 = u.current.trim();
            if (!O0)
                return;
            if (S6(O0),
                i.current)
                i.current.value = "",
                    u.current = "";
            if (t8(() => {
                n("")
            }
            ),
                b0.current)
                clearTimeout(b0.current);
            if (J)
                J.sendChatIndicator(!1);
            $(),
                v(!1)
        }
        , S6 = (O0) => {
            if (!J || !O0.trim())
                return;
            try {
                if (O0.startsWith("/")) {
                    let X6 = O0.split(" ")
                        , k0 = X6[0].toLowerCase();
                    if (k0 === "/avatar")
                        if (X6.length >= 2) {
                            let V8 = X6.slice(1).join(" ").substring(0, 2);
                            try {
                                J.setAvatar(V8);
                                let o0 = {
                                    id: Date.now(),
                                    playerId: "system",
                                    playerName: "[SYSTEM]",
                                    message: `Avatar set to: ${V8 || "default"}`,
                                    timestamp: new Date,
                                    isSystem: !0
                                };
                                j((C0) => [...C0, o0]);
                                return
                            } catch (o0) {
                                let C0 = {
                                    id: Date.now(),
                                    playerId: "system",
                                    playerName: "[SYSTEM]",
                                    message: "Error: Could not change avatar",
                                    timestamp: new Date,
                                    isSystem: !0
                                };
                                j((K0) => [...K0, C0]);
                                return
                            }
                        } else {
                            let V8 = {
                                id: Date.now(),
                                playerId: "system",
                                playerName: "[SYSTEM]",
                                message: "Usage: /avatar XX (where XX is your avatar, max 2 characters)",
                                timestamp: new Date,
                                isSystem: !0
                            };
                            j((o0) => [...o0, V8]);
                            return
                        }
                    let U6 = {
                        id: Date.now(),
                        playerId: "system",
                        playerName: "[SYSTEM]",
                        message: `Unknown command: ${k0}. Available commands: /avatar`,
                        timestamp: new Date,
                        isSystem: !0
                    };
                    j((V8) => [...V8, U6]);
                    return
                }
                let R8 = {
                    id: Date.now(),
                    playerId: J.currentPlayerId || "0",
                    playerName: G6 || "You",
                    message: O0,
                    timestamp: new Date
                };
                if (j((X6) => [...X6, R8]),
                    J.sendChat(O0),
                    !d0.current)
                    L((X6) => X6 + 1);
                if (d0.current)
                    queueMicrotask(() => {
                        U8()
                    }
                    )
            } catch (h0) { }
        }
        , J8 = (O0) => {
            switch (O0.stopPropagation(),
            O0.key) {
                case "Tab":
                    O0.preventDefault(),
                        $();
                    break;
                case "Enter":
                    if (!O0.shiftKey) {
                        O0.preventDefault();
                        let h0 = i.current?.value || "";
                        if (h0.trim())
                            u.current = h0,
                                y6()
                    }
                    break;
                case "Escape":
                    if (O0.preventDefault(),
                        M)
                        v(!1);
                    else
                        $();
                    break
            }
        }
        ;
    i0(() => {
        let O0 = (h0) => {
            if (!d0.current)
                return;
            if (h0.key === "Enter" && !h0.shiftKey) {
                if (document.activeElement === i.current) {
                    h0.preventDefault(),
                        h0.stopPropagation();
                    let X6 = i.current?.value || "";
                    if (X6.trim())
                        u.current = X6,
                            y6()
                }
            }
        }
            ;
        return document.addEventListener("keydown", O0, !0),
            () => {
                document.removeEventListener("keydown", O0, !0)
            }
    }
        , [Q]);
    let L0 = (O0) => {
        O0.stopPropagation(),
            Z(),
            setTimeout(() => {
                if (i.current)
                    i.current.focus(),
                        i.current.disabled = !1
            }
                , 10)
    }
        , d8 = (O0) => {
            O0.preventDefault(),
                O0.stopPropagation(),
                y6()
        }
        , d6 = () => {
            if (Q && i.current)
                setTimeout(() => {
                    if (i.current) {
                        i.current.focus();
                        let O0 = i.current.value.length;
                        if (O0 > 0)
                            i.current.setSelectionRange(O0, O0);
                        u.current = i.current.value
                    }
                }
                    , 10)
        }
        , K8 = (O0) => {
            O0.preventDefault(),
                O0.stopPropagation(),
                d6()
        }
        , h8 = (O0) => {
            O0.preventDefault(),
                O0.stopPropagation(),
                d6()
        }
        ;
    return i0(() => {
        if (Q)
            U8()
    }
        , [N, Q, U8]),
        i0(() => {
            if (N.length > 0)
                U8()
        }
            , [U8, N.length]),
        A("div", {
            className: "fixed bottom-0 left-0 right-0 z-40",
            style: {
                pointerEvents: "none"
            },
            children: [!U.display.disableBottomBar && A("div", {
                className: "bg-black bg-opacity-30 border-t border-white border-opacity-20 shadow-2xl",
                style: {
                    height: "200px",
                    minHeight: "200px",
                    pointerEvents: "none"
                }
            }), A("div", {
                ref: g,
                className: "flex flex-col cursor-pointer overflow-hidden absolute bottom-0 left-0",
                style: {
                    width: "400px",
                    height: "200px",
                    maxWidth: "400px",
                    resize: "none",
                    minWidth: "250px",
                    margin: "0 16px",
                    backgroundColor: Q ? "rgba(0, 0, 0, 0.2)" : "transparent",
                    boxShadow: Q ? "0 0 10px rgba(0, 0, 0, 0.3)" : "none",
                    backdropFilter: Q ? "blur(5px)" : "none",
                    borderTopLeftRadius: "8px",
                    borderTopRightRadius: "8px",
                    pointerEvents: "auto"
                },
                onClick: L0,
                children: [A("style", {
                    children: Vu
                }), A("div", {
                    ref: x0,
                    className: `flex-1 overflow-y-auto p-3 space-y-2 cursor-pointer ${Q ? "bg-gray-900 bg-opacity-20 scrollbar-thin scrollbar-thumb-gray-700 scrollbar-track-transparent" : "chat-not-focused hide-scrollbar"}`,
                    onClick: L0,
                    children: [N.length === 0 ? A("div", {
                        className: "text-white text-center italic text-sm mt-4 cursor-pointer",
                        onClick: h8,
                        children: "No messages yet. Click to start chatting."
                    }) : A(GJ, {
                        children: [N.map((O0) => {
                            let h0 = Date.now() - O0.timestamp.getTime() < 5000;
                            return A("div", {
                                className: `text-white text-sm break-words chat-message ${h0 ? "recent" : ""}`,
                                children: O0.isSystem ? A("div", {
                                    style: {
                                        color: "rgb(255, 255, 0)"
                                    },
                                    children: [A("span", {
                                        className: "font-bold",
                                        children: O0.playerName
                                    }), A("span", {
                                        style: {
                                            color: "rgb(255, 255, 0)"
                                        },
                                        children: [" ", O0.message]
                                    })]
                                }) : A(GJ, {
                                    children: [A("span", {
                                        className: "font-bold text-white",
                                        children: O0.playerName
                                    }), A("span", {
                                        className: "text-white",
                                        children: " : "
                                    }), O0.message]
                                })
                            }, O0.id)
                        }
                        ), A("div", {
                            ref: b,
                            className: "h-0 w-full"
                        })]
                    }), !Q && N.length > 0 && k > 0 && A("div", {
                        className: "text-white text-center font-bold text-md mt-4 animate-pulse",
                        children: [k, " new ", k === 1 ? "message" : "messages", "!"]
                    })]
                }), A("div", {
                    className: `p-2 flex cursor-pointer relative ${Q ? "bg-black bg-opacity-20 border-t border-white border-opacity-10" : "bg-black bg-opacity-10"}`,
                    onClick: (O0) => {
                        O0.stopPropagation(),
                            d6()
                    }
                    ,
                    children: [A(Ku, {
                        onEmojiSelect: q6,
                        visible: M && Q
                    }), A("button", {
                        type: "button",
                        onClick: K6,
                        className: `${Q ? "bg-gray-700 hover:bg-gray-600" : "bg-transparent"} text-white px-2 rounded-l-md transition-all duration-300`,
                        children: A("span", {
                            role: "img",
                            "aria-label": "emoji",
                            className: "text-lg",
                            children: "\uD83D\uDE0A"
                        })
                    }), A("input", {
                        ref: i,
                        type: "text",
                        defaultValue: "",
                        onChange: k6,
                        onKeyDown: J8,
                        onFocus: _8,
                        onBlur: R6,
                        onClick: n8,
                        placeholder: Q ? "Type message and press Enter to send..." : "Click or press Tab to chat",
                        className: `flex-1 ${Q ? "bg-gray-900 bg-opacity-50 border-gray-600" : "bg-gray-900 bg-opacity-30 border-gray-700"} text-white placeholder-gray-400 px-3 py-1 border-l focus:outline-none cursor-text transition-all duration-300`,
                        autoComplete: "off",
                        id: "chat-input",
                        disabled: !1
                    }), A("button", {
                        type: "button",
                        onClick: () => {
                            global.isGameMenuOpen = !global.isGameMenuOpen,
                                global.dispatchEvent(new CustomEvent("toggleGameMenu"))
                        }
                        ,
                        className: `${Q ? "bg-gray-700 hover:bg-gray-600" : "bg-transparent"} text-white px-2 border-l border-gray-700 transition-all duration-300`,
                        title: "Open Game Menu",
                        children: A("svg", {
                            xmlns: "http://www.w3.org/2000/svg",
                            className: "h-5 w-5",
                            fill: "none",
                            viewBox: "0 0 24 24",
                            stroke: "currentColor",
                            children: A("path", {
                                strokeLinecap: "round",
                                strokeLinejoin: "round",
                                strokeWidth: 2,
                                d: "M4 6h16M4 12h16M4 18h16"
                            })
                        })
                    }), A("button", {
                        type: "button",
                        onClick: d8,
                        disabled: !u.current.trim(),
                        className: `${Q ? "bg-indigo-600 bg-opacity-80 hover:bg-indigo-700" : "bg-transparent"} disabled:bg-gray-700 text-white px-3 border-l border-gray-700 rounded-r-md transition-all duration-300`,
                        children: A("svg", {
                            xmlns: "http://www.w3.org/2000/svg",
                            className: "h-5 w-5",
                            viewBox: "0 0 20 20",
                            fill: "currentColor",
                            children: A("path", {
                                fillRule: "evenodd",
                                d: "M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 1.414L10.586 9H7a1 1 0 100 2h3.586l-1.293 1.293a1 1 0 101.414 1.414l3-3a1 1 0 000-1.414z",
                                clipRule: "evenodd"
                            })
                        })
                    })]
                })]
            })]
        })
}
var c6 = (J) => { }
    , zu = 1
    , Y7 = global.__soundManagerCache ||= {
        kick: null,
        score: null,
        chat: null,
        shtanga: null,
        initialized: !1
    };
function hb() {
    let J = n0(null)
        , Q = n0(null)
        , Z = n0(null)
        , $ = n0(null)
        , q = qJ()
        , { settings: K } = h5()
        , V = n0(K.audio.ballVolume)
        , z = n0(K.audio.goalVolume)
        , W = n0(K.audio.chatVolume || 0)
        , H = n0(K.audio.goalPostVolume ?? K.audio.ballVolume);
    return i0(() => {
        if (c6("Volume settings changed, updating audio elements"),
            V.current = K.audio.ballVolume,
            z.current = K.audio.goalVolume,
            W.current = K.audio.chatVolume || 0,
            H.current = K.audio.goalPostVolume ?? K.audio.ballVolume,
            J.current)
            J.current.volume = K.audio.ballVolume,
                c6("Updated kick sound volume to " + K.audio.ballVolume);
        if ($.current)
            $.current.volume = H.current,
                c6("Updated shtanga sound volume to " + H.current);
        if (Q.current)
            Q.current.volume = K.audio.goalVolume,
                c6("Updated score sound volume to " + K.audio.goalVolume);
        if (Z.current)
            Z.current.volume = K.audio.chatVolume || 0,
                c6("Updated chat sound volume to " + (K.audio.chatVolume || 0))
    }
        , [K.audio.ballVolume, K.audio.goalVolume, K.audio.chatVolume, K.audio.goalPostVolume]),
        i0(() => {
            let Y = (U) => {
                let { key: N, value: j } = U.detail;
                if (c6(`Received audio setting change event: ${N} = ${j}`),
                    N === "ballVolume") {
                    if (V.current = j,
                        J.current)
                        J.current.volume = j;
                    if ($.current)
                        $.current.volume = j;
                    if (Y7.kick)
                        Y7.kick.volume = j;
                    if (Y7.shtanga)
                        Y7.shtanga.volume = j;
                    c6("Updated kick sound volume to " + j)
                } else if (N === "goalVolume") {
                    if (z.current = j,
                        Q.current)
                        Q.current.volume = j;
                    if (Y7.score)
                        Y7.score.volume = j;
                    c6("Updated goal sound volume to " + j)
                } else if (N === "goalPostVolume") {
                    if (H.current = j,
                        $.current)
                        $.current.volume = j;
                    if (Y7.shtanga)
                        Y7.shtanga.volume = j;
                    c6("Updated goal post sound volume to " + j)
                } else if (N === "chatVolume") {
                    if (W.current = j,
                        Z.current)
                        Z.current.volume = j;
                    if (Y7.chat)
                        Y7.chat.volume = j;
                    c6("Updated chat sound volume to " + j)
                }
            }
                ;
            return global.addEventListener("audio_settings_changed", Y),
                () => {
                    global.removeEventListener("audio_settings_changed", Y)
                }
        }
            , []),
        i0(() => {
            c6("Setting up EventManager listeners");
            let Y = () => {
                if (c6("EventManager chat event received, playing sound"),
                    Z.current)
                    try {
                        if (Z.current.volume = W.current,
                            !Z.current.paused)
                            Z.current.pause(),
                                Z.current.currentTime = 0;
                        else
                            Z.current.currentTime = 0;
                        Z.current.play().catch((N) => {
                            c6("Browser blocked chat sound (user interaction needed)")
                        }
                        )
                    } catch (N) { }
                else
                    c6("Chat sound not available for EventManager event")
            }
                , U = v6.on("playerChat", Y);
            return () => {
                U()
            }
        }
            , []),
        i0(() => {
            if (c6("Initializing audio (once)"),
                !Y7.initialized) {
                let Y = {
                    kick: 0,
                    score: 0,
                    chat: 0
                }
                    , U = new Audio("/_Limey/sounds/kick.wav")
                    , N = new Audio("/_Limey/sounds/score.mp3")
                    , j = new Audio("/_Limey/sounds/chat.mp3")
                    , k = new Audio("/_Limey/sounds/shtanga_3.wav");
                U.preload = "auto",
                    N.preload = "auto",
                    j.preload = "auto",
                    k.preload = "auto",
                    U.volume = V.current,
                    N.volume = z.current,
                    j.volume = W.current,
                    k.volume = H.current,
                    U.addEventListener("loadeddata", () => c6("Kick sound loaded successfully"), {
                        once: !0
                    }),
                    N.addEventListener("loadeddata", () => c6("Goal sound loaded successfully"), {
                        once: !0
                    }),
                    j.addEventListener("loadeddata", () => c6("Chat sound loaded successfully"), {
                        once: !0
                    }),
                    k.addEventListener("loadeddata", () => c6("Shtanga sound loaded successfully"), {
                        once: !0
                    }),
                    U.addEventListener("error", (L) => {
                        if (Y.kick++,
                            Y.kick > 2)
                            ;
                        else
                            c6("Initial error loading kick sound (expected behavior)")
                    }
                    ),
                    N.addEventListener("error", (L) => {
                        if (Y.score++,
                            Y.score > 2)
                            ;
                        else
                            c6("Initial error loading goal sound (expected behavior)")
                    }
                    ),
                    j.addEventListener("error", (L) => {
                        if (Y.chat++,
                            Y.chat > 2)
                            ;
                        else
                            c6("Initial error loading chat sound (expected behavior)")
                    }
                    ),
                    k.addEventListener("error", (L) => {
                        if (Y.kick++,
                            Y.kick > 2)
                            ;
                        else
                            c6("Initial error loading shtanga sound (expected behavior)")
                    }
                    ),
                    Y7.kick = U,
                    Y7.score = N,
                    Y7.chat = j,
                    Y7.shtanga = k,
                    Y7.initialized = !0;
                try {
                    U.load(),
                        N.load(),
                        j.load(),
                        k.load()
                } catch (L) { }
            }
            return J.current = Y7.kick,
                Q.current = Y7.score,
                Z.current = Y7.chat,
                $.current = Y7.shtanga,
                () => {
                    if (Y7.kick)
                        Y7.kick.pause();
                    if (Y7.score)
                        Y7.score.pause();
                    if (Y7.chat)
                        Y7.chat.pause()
                }
        }
            , []),
        i0(() => {
            let Y = (k) => {
                let L = Q.current;
                if (!L)
                    return;
                try {
                    if (L.volume = z.current,
                        !L.paused)
                        L.pause();
                    L.currentTime = 0,
                        L.play().catch(() => c6("Browser blocked goal sound (user interaction needed)"))
                } catch (F) { }
            }
                , U = () => {
                    let k = J.current;
                    if (!k)
                        return;
                    try {
                        if (k.volume = V.current,
                            !k.paused)
                            k.pause();
                        k.currentTime = 0,
                            k.play().catch(() => c6("Browser blocked kick sound (user interaction needed)"))
                    } catch (L) { }
                }
                , N = v6.on("teamGoal", Y)
                , j = v6.on("playerBallKick", U);
            return () => {
                N(),
                    j()
            }
        }
            , []),
        i0(() => {
            let Y = q.room;
            if (!Y)
                return;
            let U = Y.onCollisionDiscVsDisc;
            return Y.onCollisionDiscVsDisc = function (N, j, k, L, F) {
                try {
                    let P = Y?.gameState?.physicsState?.discs || []
                        , M = P[N]
                        , v = P[k]
                        , E = M && typeof M.cGroup === "number" ? M.cGroup : 0
                        , n = M && typeof M.cMask === "number" ? M.cMask : 0
                        , u = v && typeof v.cGroup === "number" ? v.cGroup : 0
                        , b = v && typeof v.cMask === "number" ? v.cMask : 0
                        , i = (E & b) !== 0 && (u & n) !== 0
                        , g = M && (M.kick === !0 || M.kick === 1 || typeof M.kickback === "number" && M.kickback > 0 || N === 0)
                        , l = v && (v.kick === !0 || v.kick === 1 || typeof v.kickback === "number" && v.kickback > 0 || k === 0)
                        , o = M && M.invMass === 0
                        , F0 = v && v.invMass === 0
                        , b0 = i && g && F0
                        , d0 = i && l && o
                        , H8 = 0;
                    if (M && (N === 0 || g) && M.speed) {
                        let E0 = typeof M.speed.x === "number" ? M.speed.x : 0
                            , v0 = typeof M.speed.y === "number" ? M.speed.y : 0;
                        H8 = Math.max(H8, Math.hypot(E0, v0))
                    }
                    if (v && (k === 0 || l) && v.speed) {
                        let E0 = typeof v.speed.x === "number" ? v.speed.x : 0
                            , v0 = typeof v.speed.y === "number" ? v.speed.y : 0;
                        H8 = Math.max(H8, Math.hypot(E0, v0))
                    }
                    if ((b0 || d0) && H8 >= zu && $.current) {
                        let E0 = $.current;
                        try {
                            if (E0.volume = H.current,
                                !E0.paused)
                                E0.pause();
                            E0.currentTime = 0,
                                E0.play().catch(() => c6("Browser blocked shtanga sound (user interaction needed)"))
                        } catch (v0) { }
                    }
                } catch (P) { }
                if (typeof U === "function")
                    try {
                        U(N, j, k, L, F)
                    } catch { }
            }
                ,
                () => {
                    if (Y && typeof U === "function")
                        Y.onCollisionDiscVsDisc = U
                }
        }
            , [q.room]),
        i0(() => {
            let Y = !1
                , U = () => {
                    if (Y)
                        return;
                    c6("Attempting to unlock audio context");
                    let j = new Audio("data:audio/mp3;base64,SUQzBAAAAAABEVRYWFgAAAAtAAADY29tbWVudABCaWdTb3VuZEJhbmsuY29tIC8gTGFTb25vdGhlcXVlLm9yZwBURU5DAAAAHQAAA1N3aXRjaCBQbHVzIMKpIE5DSCBTb2Z0d2FyZQBUSVQyAAAABgAAAzIyMzUAVFNTRQAAAA8AAANMYXZmNTcuODMuMTAwAAAAAAAAAAAAAAD/80DEAAAAA0gAAAAATEFNRTMuMTAwVVVVVVVVVVVVVUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQsRbAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQMSkAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV");
                    j.volume = 0,
                        j.onplay = () => {
                            if (c6("Audio context unlocked successfully"),
                                Y = !0,
                                J.current)
                                J.current.load();
                            if (Q.current)
                                Q.current.load();
                            if (Z.current)
                                Z.current.load()
                        }
                        ,
                        j.onerror = (k) => {
                            c6("Silent sound failed to play, audio might be locked: " + k),
                                Y = !1
                        }
                        ,
                        j.play().catch((k) => {
                            c6("Silent sound failed to play, audio might require user interaction first: " + k)
                        }
                        )
                }
                ;
            U();
            let N = () => {
                if (U(),
                    Y)
                    document.removeEventListener("click", N)
            }
                ;
            return document.addEventListener("click", N),
                () => {
                    document.removeEventListener("click", N)
                }
        }
            , []),
        null
}
var dD = {}
    , T4 = []
    , tS = 100;
function Bl() {
    if (T4.length > 0) {
        let J = T4.pop();
        return J?.clear(),
            J
    }
    return new w6
}
function kl(J) {
    if (T4.length < tS)
        J.clear(),
            T4.push(J);
    else
        J.destroy(!0)
}
async function EI(J) {
    if (dD[J])
        return dD[J];
    try {
        let Q = await d9.load(J);
        return dD[J] = Q,
            Q
    } catch (Q) {
        throw Q
    }
}
function x7(J, Q) {
    if (!J)
        return;
    try {
        if (typeof J.destroy === "function")
            J.destroy(Q)
    } catch (Z) { }
}
var Cl = {
    position: "absolute",
    top: 0,
    left: 0,
    width: "100%",
    height: "100%",
    overflow: "hidden",
    background: "#000000"
}
    , Ol = {
        position: "absolute",
        top: "50%",
        left: "50%",
        transform: "translate(-50%, -50%)",
        color: "white",
        fontFamily: "Arial",
        fontSize: "16px",
        textAlign: "center"
    }
    , aS = {
        fontFamily: "Arial, Helvetica, sans-serif",
        fontSize: 30,
        fontStyle: "normal",
        fontWeight: "bold",
        fill: "#FFFFFF",
        lineCap: "round",
        lineJoin: "round",
        stroke: {
            color: "#000000",
            width: 3,
            join: "round"
        }
    }
    , sD = -8
    , Il = 16;
function pD(J) {
    let Q = sD / Il;
    return J + J * Q
}
var rS = 6;
var uD = 4;
function Ll() {
    try {
        let J = global.ballSpinMultiplier;
        if (J === void 0 || J === null)
            return uD;
        let Q = typeof J === "number" ? J : parseFloat(J);
        return Number.isFinite(Q) ? Q : uD
    } catch {
        return uD
    }
}
var lD = 1.4
    , oD = 0.25
    , nD = 6
    , A8 = (J) => { }
    , F6 = {
        STADIUM_BACKGROUND_DEEP: -101,
        STADIUM_BACKGROUND: -100,
        STADIUM_GRASS: -99,
        STADIUM_CONCRETE: -98,
        STADIUM_FIELD_ELEMENTS: -90,
        SEGMENTS: -50,
        SHADOWS: 9,
        DECORATORS: 3,
        NAMES: 4,
        DISCS_BALL: 10,
        DISCS_REGULAR: 11,
        CLONES: 15,
        PLAYERS: 20,
        JOINTS: 21,
        AVATARS: 22,
        CHAT_BUBBLES: 22,
        LOCATION_INDICATORS: 50
    };
function Fl({ fps: J }) {
    let [Q, Z] = C8(0);
    return i0(() => {
        let $ = performance.now(), q, K = () => {
            let V = performance.now();
            if (V - $ >= 500) {
                if ("memory" in performance) {
                    let z = performance.memory;
                    Z(Math.round(z.usedJSHeapSize / 1048576))
                }
                $ = V
            }
            q = requestAnimationFrame(K)
        }
            ;
        return q = requestAnimationFrame(K),
            () => {
                cancelAnimationFrame(q)
            }
    }
        , []),
        A("div", {
            style: {
                position: "absolute",
                bottom: "10px",
                right: "10px",
                backgroundColor: "rgba(0, 0, 0, 0.7)",
                color: "white",
                padding: "8px",
                borderRadius: "4px",
                fontFamily: "monospace",
                fontSize: "12px",
                zIndex: 1000
            },
            children: [A("div", {
                children: ["FPS: ", J]
            }), A("div", {
                children: ["Heap: ", Q, "MB"]
            })]
        })
}
function eS({ API: J }) {
    let [Q, Z] = C8(null)
        , $ = n0(null)
        , [q, K] = C8("Loading textures...")
        , [V, z] = C8(!1)
        , { settings: W } = h5()
        , { room: H } = qJ()
        , Y = n0(null)
        , U = n0(null)
        , N = n0(Date.now())
        , j = n0(!1)
        , k = n0(null)
        , L = n0(new Map)
        , F = n0(new Map)
        , P = n0(1)
        , M = n0(null)
        , v = n0(0)
        , E = n0(null)
        , n = n0(null)
        , u = n0(new Map)
        , b = n0(new Map)
        , i = n0(null)
        , g = n0(new Map)
        , l = n0(new Map)
        , o = n0(new Map)
        , F0 = n0(new Map)
        , [b0, d0] = C8(0)
        , H8 = n0(0)
        , E0 = n0(Date.now())
        , v0 = n0(null)
        , G6 = n0(null)
        , I8 = n0(null)
        , x0 = n0(null)
        , U8 = n0(null)
        , t8 = n0(null)
        , o8 = n0(null)
        , c8 = n0(null)
        , _8 = n0(null)
        , R6 = n0(!1)
        , n8 = n0(0)
        , q6 = n0(null)
        , K6 = n0(new Map)
        , k6 = n0(new Map);
    i0(() => {
        (async () => {
            try {
                K("Loading grass texture...");
                let K0 = await EI("/_Limey/img/grass-5.png");
                v0.current = K0,
                    A8("Grass texture loaded"),
                    K("Loading concrete textures...");
                let J0 = await EI("/_Limey/img/concrete2.png");
                G6.current = J0,
                    A8("Concrete texture loaded");
                let V0 = await EI("/_Limey/img/concrete.png");
                I8.current = V0,
                    A8("Concrete2 texture loaded"),
                    K("Textures loaded, initializing renderer..."),
                    z(!0),
                    A8("All textures loaded successfully")
            } catch (K0) {
                K("Error loading textures. Using fallback graphics."),
                    z(!0)
            }
        }
        )()
    }
        , []),
        i0(() => {
            return () => {
                if (v0.current = null,
                    G6.current = null,
                    I8.current = null,
                    x0.current)
                    x7(x0.current, !0),
                        x0.current = null;
                if (U8.current)
                    x7(U8.current, !0),
                        U8.current = null;
                if (t8.current)
                    x7(t8.current, !0),
                        t8.current = null
            }
        }
            , []),
        i0(() => {
            if (!V)
                return;
            if (!$.current) {
                A8("Container ref not available");
                return
            }
            return (async () => {
                try {
                    K("Initializing renderer...");
                    let K0 = new mW
                        , J0 = W.display.resolutionScale
                        , V0 = J0 === "default" || J0 === void 0 ? global.devicePixelRatio || 1 : J0;
                    A8(`Initializing with resolution scale: ${J0}, targetResolution: ${V0}`);
                    let c = (W.display.antialiasing || "msaa") === "msaa";
                    if (await K0.init({
                        background: "#000000",
                        resizeTo: global,
                        antialias: c,
                        resolution: V0,
                        preference: W.display.renderingAPI === "auto" ? void 0 : W.display.renderingAPI
                    }),
                        "context" in K0.renderer)
                        K0.renderer.context.preserveDrawingBuffer = !1;
                    K0.ticker.stop(),
                        Z(K0),
                        U.current = K0;
                    try {
                        if ((W.display.antialiasing || "msaa") === "fxaa") {
                            let R0 = await Promise.resolve().then(() => (iS(),
                                sS))
                                , N8 = new (R0.FXAAFilter || R0.default);
                            K0.stage.filters = [N8],
                                A8("FXAA filter applied")
                        } else
                            K0.stage.filters = []
                    } catch (N0) { }
                    if ($.current) {
                        if ($.current.innerHTML = "",
                            K0.canvas)
                            $.current.appendChild(K0.canvas),
                                requestAnimationFrame(() => {
                                    if ($.current && K0.canvas) {
                                        let N0 = $.current.clientWidth || global.innerWidth
                                            , R0 = $.current.clientHeight || global.innerHeight;
                                        if (K0.canvas.style.width = `${N0}px`,
                                            K0.canvas.style.height = `${R0}px`,
                                            K0.renderer.resize(N0, R0),
                                            k.current) {
                                            let N8 = (global.currentChatHeight || 200) * 0.3;
                                            k.current.position.set(K0.screen.width / 2, K0.screen.height / 2 - N8)
                                        }
                                        K0.render(),
                                            A8(`Initial canvas sizing applied: ${N0}x${R0}`)
                                    }
                                }
                                ),
                                setTimeout(() => {
                                    if ($.current && K0.canvas) {
                                        let N0 = $.current.clientWidth || global.innerWidth
                                            , R0 = $.current.clientHeight || global.innerHeight
                                            , $8 = parseInt(K0.canvas.style.width) || K0.canvas.width
                                            , N8 = parseInt(K0.canvas.style.height) || K0.canvas.height;
                                        if ($8 !== N0 || N8 !== R0) {
                                            if (K0.canvas.style.width = `${N0}px`,
                                                K0.canvas.style.height = `${R0}px`,
                                                K0.renderer.resize(N0, R0),
                                                k.current) {
                                                let q0 = (global.currentChatHeight || 200) * 0.3;
                                                k.current.position.set(K0.screen.width / 2, K0.screen.height / 2 - q0)
                                            }
                                            K0.render(),
                                                A8(`Fallback canvas sizing applied: ${N0}x${R0}`)
                                        }
                                    }
                                }
                                    , 100)
                    }
                    let X0 = new m8;
                    X0.sortableChildren = !0,
                        X0.center = {
                            x: 0,
                            y: 0
                        };
                    let B0 = (global.currentChatHeight || 200) * 0.3;
                    if (X0.position.set(K0.screen.width / 2, K0.screen.height / 2 - B0),
                        K0.stage.addChild(X0),
                        k.current = X0,
                        H && H.currentPlayerId)
                        M.current = H.currentPlayerId;
                    if (H) {
                        if (H.gameState)
                            K("Drawing stadium..."),
                                L0(H.gameState.stadium),
                                d8(H.gameState.stadium)
                    }
                    v.current = W.display.extrapolation,
                        K(""),
                        A8("BetterRenderer initialized")
                } catch (K0) {
                    K("Error initializing renderer. Please refresh the page.")
                }
            }
            )(),
                () => {
                    if (L.current.forEach((K0) => {
                        x7(K0, !0)
                    }
                    ),
                        L.current.clear(),
                        F.current.forEach((K0) => {
                            x7(K0, !0)
                        }
                        ),
                        F.current.clear(),
                        u.current.forEach((K0) => {
                            x7(K0.draw, {
                                children: !0
                            })
                        }
                        ),
                        u.current.clear(),
                        b.current.forEach((K0) => {
                            x7(K0, !0)
                        }
                        ),
                        b.current.clear(),
                        g.current.forEach((K0) => {
                            x7(K0, !0)
                        }
                        ),
                        g.current.clear(),
                        F0.current.forEach((K0) => {
                            x7(K0.draw, !0)
                        }
                        ),
                        F0.current.clear(),
                        i.current)
                        x7(i.current, !0),
                            i.current = null;
                    if (c8.current) {
                        try {
                            if (k.current)
                                k.current.removeChild(c8.current)
                        } catch { }
                        x7(c8.current, !0),
                            c8.current = null
                    }
                    if (o8.current = null,
                        R6.current = !1,
                        n8.current = 0,
                        _8.current) {
                        try {
                            if (k.current)
                                k.current.removeChild(_8.current)
                        } catch { }
                        x7(_8.current, !0),
                            _8.current = null
                    }
                    if (E.current)
                        x7(E.current, {
                            children: !1
                        }),
                            E.current = null;
                    if (n.current)
                        x7(n.current, !0),
                            n.current = null;
                    if (k6.current.forEach((K0) => {
                        if (k.current)
                            k.current.removeChild(K0);
                        x7(K0, !0)
                    }
                    ),
                        k6.current.clear(),
                        k.current)
                        x7(k.current, {
                            children: !0
                        }),
                            k.current = null;
                    if (U.current)
                        U.current.stage.eventMode = "none",
                            d9.unloadBundle("__pixiTemp"),
                            U.current.destroy(!0, {
                                children: !0,
                                texture: !0
                            }),
                            U.current = null,
                            Z(null),
                            A8("Renderer destroyed with all resources");
                    j.current = !1
                }
        }
            , [V, W.display.resolutionScale, W.display.renderingAPI, W.display.perfectPixels, W.display.antialiasing]);
    function y6(C0) {
        let K0 = global.currentChatHeight || 200
            , J0 = C0.screen.height - K0;
        return {
            width: C0.screen.width,
            height: J0,
            viewWidth: C0.screen.width / P.current,
            viewHeight: J0 / P.current
        }
    }
    function S6(C0, K0, J0) {
        if (!k.current || !K0 || !K0.stadium)
            return;
        let V0 = k.current, t = K0.stadium, { viewWidth: c, viewHeight: X0 } = y6(C0), B0 = H?.currentPlayer?.disc, N0, R0, $8;
        if (B0 && t.cameraFollow === 1)
            $8 = B0.pos,
                N0 = $8.x,
                R0 = $8.y,
                A8("Camera: DIRECT player focus");
        else {
            let a = K0.physicsState?.discs?.[0];
            if (!a || !a.pos)
                return;
            if ($8 = a.pos,
                N0 = $8.x,
                R0 = $8.y,
                B0 && B0.pos) {
                let q0 = B0.pos;
                N0 = 0.5 * (N0 + q0.x),
                    R0 = 0.5 * (R0 + q0.y);
                let H0 = 0.5 * c
                    , p0 = 0.5 * X0
                    , w8 = q0.x - H0 + 50
                    , y8 = q0.y - p0 + 50
                    , j8 = q0.x + H0 - 50
                    , k8 = q0.y + p0 - 50;
                if (N0 > j8)
                    N0 = j8;
                else if (N0 < w8)
                    N0 = w8;
                if (R0 > k8)
                    R0 = k8;
                else if (R0 < y8)
                    R0 = y8
            }
        }
        let N8 = 60 * J0;
        if (N8 > 1)
            N8 = 1;
        if (N8 *= 0.04,
            !V0.center.x && !V0.center.y)
            V0.center.x = N0,
                V0.center.y = R0;
        else
            V0.center.x += (N0 - V0.center.x) * N8,
                V0.center.y += (R0 - V0.center.y) * N8;
        if (V0.center.x && t.width) {
            if (c > 2 * t.width)
                V0.center.x = 0;
            else if (V0.center.x + 0.5 * c > t.width)
                V0.center.x = t.width - 0.5 * c;
            else if (V0.center.x - 0.5 * c < -t.width)
                V0.center.x = -t.width + 0.5 * c;
            if (X0 > 2 * t.height)
                V0.center.y = 0;
            else if (V0.center.y + 0.5 * X0 > t.height)
                V0.center.y = t.height - 0.5 * X0;
            else if (V0.center.y - 0.5 * X0 < -t.height)
                V0.center.y = -t.height + 0.5 * X0
        }
        if (V0.center.x * 0 !== 0)
            V0.center.x = 0;
        if (V0.center.y * 0 !== 0)
            V0.center.y = 0;
        V0.pivot.set(V0.center.x, V0.center.y)
    }
    function J8(C0) {
        if (C0 = Math.max(0.3, C0),
            P.current = C0,
            k.current)
            k.current.scale.set(C0, C0)
    }
    i0(() => {
        let C0 = {
            camera1: {
                zoom: 2,
                cameraFollow: 1
            },
            camera2: {
                zoom: 1.5,
                cameraFollow: 1
            },
            camera3: {
                zoom: 1,
                cameraFollow: 0
            },
            camera4: {
                zoom: 0.7,
                cameraFollow: 0
            },
            camera5: {
                zoom: 0.4,
                cameraFollow: 0
            }
        };
        function K0(t) {
            if (global.isGameMenuOpen || global.chatIsFocused)
                return;
            let c = t.target;
            if (c && (c.closest(".keyboard-settings-scroll") || c.closest('[class*="overflow"]') || c.closest(".menu") || c.closest(".modal")))
                return;
            t.preventDefault();
            let X0 = -t.deltaY * 0.001;
            J8(P.current + X0)
        }
        let J0 = new Map;
        if (W.keyboard.zoomIn[0])
            J0.set(W.keyboard.zoomIn[0], "zoomIn");
        if (W.keyboard.zoomIn[1])
            J0.set(W.keyboard.zoomIn[1], "zoomIn");
        if (W.keyboard.zoomOut[0])
            J0.set(W.keyboard.zoomOut[0], "zoomOut");
        if (W.keyboard.zoomOut[1])
            J0.set(W.keyboard.zoomOut[1], "zoomOut");
        if (W.keyboard.camera1[0])
            J0.set(W.keyboard.camera1[0], "camera1");
        if (W.keyboard.camera1[1])
            J0.set(W.keyboard.camera1[1], "camera1");
        if (W.keyboard.camera2[0])
            J0.set(W.keyboard.camera2[0], "camera2");
        if (W.keyboard.camera2[1])
            J0.set(W.keyboard.camera2[1], "camera2");
        if (W.keyboard.camera3[0])
            J0.set(W.keyboard.camera3[0], "camera3");
        if (W.keyboard.camera3[1])
            J0.set(W.keyboard.camera3[1], "camera3");
        if (W.keyboard.camera4[0])
            J0.set(W.keyboard.camera4[0], "camera4");
        if (W.keyboard.camera4[1])
            J0.set(W.keyboard.camera4[1], "camera4");
        if (W.keyboard.camera5[0])
            J0.set(W.keyboard.camera5[0], "camera5");
        if (W.keyboard.camera5[1])
            J0.set(W.keyboard.camera5[1], "camera5");
        function V0(t) {
            if (global.chatIsFocused || global.isGameMenuOpen)
                return;
            let c = J0.get(t.code);
            if (!c)
                return;
            if (t.preventDefault(),
                c === "zoomIn")
                J8(P.current + 0.1);
            else if (c === "zoomOut")
                J8(P.current - 0.1);
            else if (C0[c]) {
                let X0 = C0[c];
                if (X0.zoom !== void 0)
                    J8(X0.zoom);
                if (X0.cameraFollow !== void 0 && H?.currentGameState?.stadium)
                    H.currentGameState.stadium.cameraFollow = X0.cameraFollow,
                        A8(`Camera mode changed to ${c} (follow: ${X0.cameraFollow}, zoom: ${X0.zoom})`)
            }
        }
        return document.addEventListener("wheel", K0, {
            passive: !1
        }),
            document.addEventListener("keydown", V0),
            () => {
                document.removeEventListener("wheel", K0),
                    document.removeEventListener("keydown", V0)
            }
    }
        , [W.keyboard, H]),
        i0(() => {
            let C0 = () => {
                if (!U.current || !k.current)
                    return;
                let V0 = $.current?.clientWidth || global.innerWidth
                    , t = $.current?.clientHeight || global.innerHeight
                    , c = W.display.resolutionScale
                    , X0 = c === "default" || c === void 0 ? global.devicePixelRatio || 1 : c;
                if (U.current.renderer.resolution = X0,
                    U.current.canvas)
                    U.current.canvas.style.width = `${V0}px`,
                        U.current.canvas.style.height = `${t}px`;
                U.current.renderer.resize(V0, t);
                let B0 = (global.currentChatHeight || 200) * 0.3;
                k.current.position.set(U.current.screen.width / 2, U.current.screen.height / 2 - B0),
                    U.current.render(),
                    A8("Viewport position, size, and resolution updated after resize")
            }
                , K0 = null;
            if ($.current)
                K0 = new ResizeObserver((V0) => {
                    requestAnimationFrame(C0)
                }
                ),
                    K0.observe($.current);
            let J0 = () => {
                requestAnimationFrame(C0)
            }
                ;
            return global.addEventListener("resize", J0),
                requestAnimationFrame(C0),
                () => {
                    if (K0)
                        K0.disconnect();
                    global.removeEventListener("resize", J0)
                }
        }
            , [W.display.resolutionScale]),
        i0(() => {
            if (!U.current || !$.current)
                return;
            let C0 = $.current.clientWidth
                , K0 = $.current.clientHeight
                , J0 = W.display.resolutionScale
                , V0 = J0 === "default" || J0 === void 0 ? global.devicePixelRatio || 1 : J0;
            if (U.current.renderer.resolution = V0,
                U.current.canvas)
                U.current.canvas.style.width = `${C0}px`,
                    U.current.canvas.style.height = `${K0}px`;
            if (U.current.renderer.resize(C0, K0),
                k.current) {
                let c = (global.currentChatHeight || 200) * 0.3;
                k.current.position.set(U.current.screen.width / 2, U.current.screen.height / 2 - c)
            }
            U.current.render(),
                A8(`Canvas size and resolution updated for resolution scale: ${W.display.resolutionScale}`)
        }
            , [W.display.resolutionScale]);
    function L0(C0) {
        if (A8("Drawing stadium"),
            !C0 || !U.current || !k.current) {
            A8("Cannot draw stadium - stadium or app is not initialized");
            return
        }
        if (!V) {
            A8("Cannot draw stadium - textures not loaded yet");
            return
        }
        try {
            let K0 = C0.bgColor || 1735225
                , J0 = W.display.perfectPixels;
            U.current.renderer.background.color = K0;
            let V0;
            if (typeof K0 === "number")
                V0 = "#" + K0.toString(16).padStart(6, "0");
            else if (typeof K0 === "string" && K0.startsWith("#"))
                V0 = K0;
            else
                V0 = "#1A7A39";
            if ($.current)
                $.current.style.backgroundColor = V0;
            document.body.style.backgroundColor = V0;
            let t = 0
                , c = 0;
            if (C0.bounds) {
                if (Array.isArray(C0.bounds) && C0.bounds.length >= 4)
                    t = Math.abs(C0.bounds[2] - C0.bounds[0]),
                        c = Math.abs(C0.bounds[3] - C0.bounds[1]);
                else if (C0.bounds.width && C0.bounds.height)
                    t = C0.bounds.width,
                        c = C0.bounds.height
            } else if (C0.bgWidth && C0.bgHeight)
                t = C0.bgWidth * 2,
                    c = C0.bgHeight * 2;
            let X0 = C0.bgCornerRadius || 0
                , A0 = C0.bgType || 0;
            if (x0.current)
                k.current.removeChild(x0.current),
                    x0.current.destroy(),
                    x0.current = null;
            if (U8.current)
                k.current.removeChild(U8.current),
                    U8.current.destroy(),
                    U8.current = null;
            if (t8.current)
                k.current.removeChild(t8.current),
                    t8.current.destroy(),
                    t8.current = null;
            let B0 = new w6;
            B0.zIndex = F6.STADIUM_BACKGROUND,
                k.current.addChild(B0),
                i.current = B0;
            let N0 = t > 0 && c > 0;
            if (A0 === 1)
                if (N0) {
                    if (v0.current) {
                        let a = new TZ({
                            texture: v0.current,
                            width: t,
                            height: c
                        });
                        a.position.set(-t / 2, -c / 2),
                            a.alpha = 1,
                            a.zIndex = F6.STADIUM_GRASS;
                        try {
                            a.tileTransform?.scale.set(2, 2)
                        } catch { }
                        let q0 = new w6;
                        if (X0 > 0)
                            q0.roundRect(-t / 2, -c / 2, t, c, X0).fill(16777215);
                        else
                            q0.rect(-t / 2, -c / 2, t, c).fill(16777215);
                        k.current.addChild(q0),
                            a.mask = q0,
                            k.current.addChild(a),
                            x0.current = a,
                            A8("Grass texture applied to stadium")
                    } else
                        A8("Grass texture not available, using solid background");
                    if (B0.setStrokeStyle({
                        width: 3,
                        color: 13100733,
                        cap: "round",
                        join: "round",
                        alignment: 0.5,
                        pixelLine: J0
                    }),
                        X0 > 0)
                        B0.roundRect(-t / 2, -c / 2, t, c, X0).stroke();
                    else
                        B0.rect(-t / 2, -c / 2, t, c).stroke();
                    let R0 = new w6;
                    R0.zIndex = F6.STADIUM_FIELD_ELEMENTS,
                        R0.label = "centerLine",
                        k.current.addChild(R0),
                        R0.setStrokeStyle({
                            width: 3,
                            color: 13100733,
                            cap: "round",
                            join: "round",
                            alignment: 0.5,
                            pixelLine: J0
                        }),
                        R0.moveTo(0, -c / 2).lineTo(0, c / 2).stroke();
                    let $8 = new w6;
                    $8.zIndex = F6.STADIUM_FIELD_ELEMENTS,
                        $8.label = "centerCircle",
                        k.current.addChild($8),
                        $8.setStrokeStyle({
                            width: 3,
                            color: 13100733,
                            cap: "round",
                            join: "round",
                            alignment: 0.5,
                            pixelLine: J0
                        });
                    let N8 = C0.bgKickOffRadius || 60;
                    $8.circle(0, 0, N8).stroke()
                } else
                    B0.fill(K0);
            else if (A0 === 2) {
                if (I8.current) {
                    let R0 = new TZ({
                        texture: I8.current,
                        width: 40000,
                        height: 40000
                    });
                    R0.position.set(-20000, -20000),
                        R0.zIndex = F6.STADIUM_BACKGROUND_DEEP;
                    try {
                        R0.tileTransform?.scale.set(2, 2)
                    } catch { }
                    k.current.addChild(R0),
                        t8.current = R0,
                        A8("Concrete2 texture applied to stadium background")
                } else
                    A8("Concrete2 texture not available, using solid background");
                if (N0) {
                    let R0 = new w6;
                    if (R0.zIndex = F6.STADIUM_BACKGROUND,
                        k.current.addChild(R0),
                        i.current = R0,
                        R0.setStrokeStyle({
                            width: 3,
                            color: 15322222,
                            cap: "round",
                            join: "round",
                            alignment: 0.5,
                            pixelLine: J0
                        }),
                        X0 > 0)
                        R0.roundRect(-t / 2, -c / 2, t, c, X0).stroke();
                    else
                        R0.rect(-t / 2, -c / 2, t, c).stroke();
                    if (G6.current) {
                        let W8 = new TZ({
                            texture: G6.current,
                            width: t,
                            height: c
                        });
                        W8.position.set(-t / 2, -c / 2),
                            W8.zIndex = F6.STADIUM_CONCRETE;
                        try {
                            W8.tileTransform?.scale.set(2, 2)
                        } catch { }
                        if (X0 > 0) {
                            let P6 = new w6;
                            P6.roundRect(-t / 2, -c / 2, t, c, X0).fill(16777215),
                                k.current.addChild(P6),
                                W8.mask = P6
                        }
                        k.current.addChild(W8),
                            U8.current = W8,
                            A8("Concrete texture applied to stadium field")
                    } else
                        A8("Concrete texture not available, using solid field");
                    let $8 = C0.bgGoalLine || 170
                        , N8 = C0.bgKickOffRadius || 60
                        , a = t / 2 - $8;
                    if ($8 < X0)
                        a = 0;
                    let q0 = new w6;
                    q0.zIndex = F6.STADIUM_FIELD_ELEMENTS,
                        q0.label = "centerLine",
                        k.current.addChild(q0),
                        q0.setStrokeStyle({
                            width: 3,
                            color: 15322222,
                            cap: "round",
                            join: "round",
                            alignment: 0.5,
                            pixelLine: J0
                        });
                    let H0 = 15
                        , p0 = 15
                        , w8 = -c / 2
                        , y8 = !0;
                    while (w8 < c / 2) {
                        if (y8) {
                            let W8 = Math.min(w8 + H0, c / 2);
                            q0.moveTo(0, w8).lineTo(0, W8)
                        }
                        w8 += y8 ? H0 : p0,
                            y8 = !y8
                    }
                    if (q0.stroke(),
                        a !== 0) {
                        let W8 = new w6;
                        W8.zIndex = F6.STADIUM_FIELD_ELEMENTS,
                            W8.label = "blueGoalLine",
                            k.current.addChild(W8),
                            W8.setStrokeStyle({
                                width: 3,
                                color: 8760563,
                                cap: "round",
                                join: "round",
                                alignment: 0.5,
                                pixelLine: J0
                            }),
                            W8.moveTo(a, -c / 2).lineTo(a, c / 2).stroke()
                    }
                    let j8 = new w6;
                    if (j8.zIndex = F6.STADIUM_FIELD_ELEMENTS,
                        j8.label = "blueArc",
                        k.current.addChild(j8),
                        j8.setStrokeStyle({
                            width: 3,
                            color: 8760563,
                            cap: "round",
                            join: "round",
                            alignment: 0.5,
                            pixelLine: J0
                        }),
                        j8.arc(0, 0, N8, -Math.PI / 2, Math.PI / 2, !1).stroke(),
                        a !== 0) {
                        let W8 = new w6;
                        W8.zIndex = F6.STADIUM_FIELD_ELEMENTS,
                            W8.label = "redGoalLine",
                            k.current.addChild(W8),
                            W8.setStrokeStyle({
                                width: 3,
                                color: 14780791,
                                cap: "round",
                                join: "round",
                                alignment: 0.5,
                                pixelLine: J0
                            }),
                            W8.moveTo(-a, -c / 2).lineTo(-a, c / 2).stroke()
                    }
                    let k8 = new w6;
                    if (k8.zIndex = F6.STADIUM_FIELD_ELEMENTS,
                        k8.label = "redArc",
                        k.current.addChild(k8),
                        k8.setStrokeStyle({
                            width: 3,
                            color: 14780791,
                            cap: "round",
                            join: "round",
                            alignment: 0.5,
                            pixelLine: J0
                        }),
                        k8.arc(0, 0, N8, -Math.PI / 2, Math.PI / 2, !0).stroke(),
                        C0.bgGoalPenalty && C0.bgGoalPenalty > 0) {
                        let W8 = new w6;
                        W8.zIndex = F6.STADIUM_FIELD_ELEMENTS,
                            W8.label = "bluePenalty",
                            k.current.addChild(W8),
                            W8.setStrokeStyle({
                                width: 2,
                                color: 8760563,
                                cap: "round",
                                join: "round",
                                alignment: 0.5,
                                pixelLine: J0
                            });
                        let P6 = C0.bgGoalPenalty
                            , g7 = Math.min(c / 3, 240)
                            , j9 = a - P6
                            , Z0 = -g7 / 2;
                        W8.rect(j9, Z0, P6, g7).stroke();
                        let G0 = new w6;
                        G0.zIndex = F6.STADIUM_FIELD_ELEMENTS,
                            G0.label = "redPenalty",
                            k.current.addChild(G0),
                            G0.setStrokeStyle({
                                width: 2,
                                color: 14780791,
                                cap: "round",
                                join: "round",
                                alignment: 0.5,
                                pixelLine: J0
                            }),
                            G0.rect(-a, Z0, P6, g7).stroke()
                    }
                }
            } else if (N0)
                if (X0 > 0)
                    B0.roundRect(-t / 2, -c / 2, t, c, X0).fill(K0).stroke();
                else
                    B0.rect(-t / 2, -c / 2, t, c).fill(K0).stroke();
            k.current.sortChildren()
        } catch (K0) {
            if (U.current)
                U.current.renderer.background.color = 0;
            if ($.current)
                $.current.style.backgroundColor = "#000000";
            document.body.style.backgroundColor = "#000000"
        }
    }
    function d8(C0) {
        if (!C0) {
            A8("Cannot draw segments - stadium is null or undefined");
            return
        }
        if (!k.current || !U.current) {
            A8("Cannot draw segments - viewport or app is not initialized");
            return
        }
        if (E.current) {
            if (k.current.removeChild(E.current),
                E.current.children)
                E.current.children.forEach((J0) => {
                    if (J0 instanceof w6)
                        kl(J0)
                }
                );
            x7(E.current, {
                children: !1
            }),
                E.current = null
        }
        let K0 = new m8;
        if (K0.zIndex = F6.SEGMENTS,
            k.current.addChild(K0),
            E.current = K0,
            C0.segments.forEach((J0) => {
                if (!J0.vis)
                    return;
                let V0 = J.Utils.numberToColor(J0.color)
                    , t = J0.v0.pos
                    , c = J0.v1.pos
                    , X0 = Bl()
                    , A0 = J0.arcCenter;
                if (!A0)
                    X0.moveTo(t.x, t.y).lineTo(c.x, c.y).stroke({
                        width: 3,
                        color: V0,
                        pixelLine: W.display.perfectPixels
                    });
                else {
                    let B0 = t.x - A0.x
                        , N0 = t.y - A0.y
                        , R0 = Math.sqrt(B0 * B0 + N0 * N0)
                        , $8 = Math.atan2(N0, B0)
                        , N8 = Math.atan2(c.y - A0.y, c.x - A0.x);
                    X0.arc(A0.x, A0.y, R0, $8, N8).stroke({
                        width: 3,
                        color: V0,
                        pixelLine: W.display.perfectPixels
                    })
                }
                K0.addChild(X0)
            }
            ),
            k.current)
            k.current.sortChildren();
        A8("Stadium segments drawn using object pooling")
    }
    function d6(C0) {
        if (!C0)
            return;
        if (!k.current) {
            A8("Cannot draw joints - viewport is not initialized");
            return
        }
        let { joints: K0, discs: J0 } = C0;
        if (!K0 || !K0.length) {
            if (n.current && !n.current.destroyed)
                try {
                    n.current.clear()
                } catch (B0) {
                    A8(`Error clearing joints graphics: ${B0}`)
                }
            return
        }
        if (!J0) {
            A8("Cannot draw joints - discs not available");
            return
        }
        if (!n.current) {
            let B0 = new w6;
            B0.zIndex = F6.JOINTS,
                k.current.addChild(B0),
                n.current = B0
        }
        let V0 = n.current;
        if (!V0)
            return;
        if (V0.destroyed) {
            A8("Joints graphics object destroyed, recreating...");
            try {
                if (k.current && k.current.children.includes(V0))
                    k.current.removeChild(V0);
                let B0 = new w6;
                B0.zIndex = F6.JOINTS,
                    k.current.addChild(B0),
                    n.current = B0,
                    A8("Successfully recreated joints graphics")
            } catch (B0) {
                A8(`Failed to recreate joints graphics: ${B0}`);
                return
            }
        }
        let t = n.current;
        if (!t || t.destroyed) {
            A8("Graphics object still invalid after recreation attempts");
            return
        }
        try {
            t.clear()
        } catch (B0) {
            A8(`Error clearing joints graphics: ${B0}`);
            return
        }
        let c = !1
            , X0 = !1
            , A0 = {
                width: 2,
                alpha: 1,
                pixelLine: W.display.perfectPixels
            };
        for (let B0 = 0; B0 < K0.length; B0++) {
            let N0 = K0[B0];
            if (!c && N0.color < 0)
                continue;
            let R0 = J0[N0.d0]
                , $8 = J0[N0.d1];
            if (!R0 || !$8 || !R0.pos || !$8.pos)
                continue;
            let N8;
            if (N0.color < 0)
                N8 = 24672;
            else
                try {
                    N8 = J.Utils.numberToColor(N0.color)
                } catch (a) {
                    N8 = 24672
                }
            t.moveTo(R0.pos.x, R0.pos.y).lineTo($8.pos.x, $8.pos.y).stroke({
                ...A0,
                color: N8
            }),
                X0 = !0
        }
        if (X0)
            A8(`Drew ${K0.length} joints`)
    }
    function K8(C0, K0) {
        if (!C0 || !H || !J || !U.current || !k.current)
            return;
        try {
            let J0 = H?.gameState?.stadium
                , V0 = null;
            if (J0 && typeof J0.ballType === "number") {
                if (J0.ballType === 1)
                    V0 = "/_Limey/img/ball_small.png";
                else if (J0.ballType === 2)
                    V0 = "/_Limey/img/basketball.png";
                else if (J0.ballType === 3)
                    V0 = "/_Limey/img/beachball.png"
            }
            let t = !!V0;
            if (!t && c8.current && k.current) {
                try {
                    k.current.removeChild(c8.current)
                } catch { }
                x7(c8.current, !0),
                    c8.current = null
            }
            if (t && V0 !== q6.current)
                o8.current = null,
                    R6.current = !1;
            if (t && V0 && !o8.current && !R6.current)
                R6.current = !0,
                    EI(V0).then((X0) => {
                        if (o8.current = X0,
                            q6.current = V0,
                            R6.current = !1,
                            c8.current)
                            try {
                                c8.current.texture = X0
                            } catch { }
                    }
                    ).catch((X0) => {
                        R6.current = !1
                    }
                    );
            let c = new Set;
            if (C0.forEach((X0, A0) => {
                if (!X0 || !k.current)
                    return;
                if (X0.playerId !== null && X0.playerId !== void 0)
                    return;
                if (A0 === 0 && t) {
                    if (o8.current) {
                        let R0 = X0.id || `disc_${A0}`
                            , $8 = L.current.get(R0);
                        if ($8) {
                            try {
                                k.current.removeChild($8)
                            } catch { }
                            L.current.delete(R0)
                        }
                        if (!c8.current) {
                            let N8 = new WJ(o8.current);
                            N8.anchor.set(0.5),
                                N8.zIndex = F6.DISCS_BALL,
                                N8.rotation = n8.current || 0,
                                k.current.addChild(N8),
                                c8.current = N8
                        }
                        if (c8.current) {
                            let N8 = Math.max(1, (X0.radius || 10) * 2);
                            if (c8.current.position.set(X0.pos?.x || 0, X0.pos?.y || 0),
                                c8.current.width = N8,
                                c8.current.height = N8,
                                W.display.enableShadows && (W.display.enableShadowDrawings ?? !0)) {
                                if (!_8.current) {
                                    let P6 = new w6;
                                    P6.zIndex = F6.SHADOWS;
                                    try {
                                        P6.blendMode = (void 0)?.MULTIPLY ?? P6.blendMode
                                    } catch { }
                                    try {
                                        let g7 = new SZ(nD);
                                        try {
                                            g7.quality = 2
                                        } catch { }
                                        P6.filters = [g7]
                                    } catch { }
                                    k.current.addChild(P6),
                                        _8.current = P6
                                }
                                let k8 = (X0.radius || 10) * lD
                                    , W8 = Math.max(0, Math.min(1, oD));
                                _8.current.clear(),
                                    _8.current.circle(0, 0, k8).fill({
                                        color: 0,
                                        alpha: W8
                                    }),
                                    _8.current.position.set(X0.pos?.x || 0, X0.pos?.y || 0)
                            } else if (_8.current && k.current) {
                                try {
                                    k.current.removeChild(_8.current)
                                } catch { }
                                x7(_8.current, !0),
                                    _8.current = null
                            }
                            let a = X0.speed && typeof X0.speed.x === "number" ? X0.speed.x : 0
                                , q0 = X0.speed && typeof X0.speed.y === "number" ? X0.speed.y : 0
                                , H0 = Math.hypot(a, q0)
                                , p0 = X0.radius || 10
                                , w8 = p0 > 0 ? H0 / p0 * Ll() : 0
                                , y8 = typeof K0 === "number" ? K0 : 1 / (Y.current?.maxFPS || 60) || 0.016666666666666666
                                , j8 = 0;
                            if (a !== 0)
                                j8 = Math.sign(a);
                            else if (q0 !== 0)
                                j8 = q0 >= 0 ? 1 : -1;
                            else
                                j8 = 0;
                            n8.current += w8 * y8 * j8,
                                c8.current.rotation = n8.current
                        }
                        return
                    }
                }
                if (A0 === 0 && (!t || !o8.current)) {
                    if (W.display.enableShadows && (W.display.enableShadowDrawings ?? !0)) {
                        if (!_8.current) {
                            let N8 = new w6;
                            N8.zIndex = F6.SHADOWS;
                            try {
                                N8.blendMode = (void 0)?.MULTIPLY ?? N8.blendMode
                            } catch { }
                            try {
                                let a = new SZ(nD);
                                try {
                                    a.quality = 2
                                } catch { }
                                N8.filters = [a]
                            } catch { }
                            k.current.addChild(N8),
                                _8.current = N8
                        }
                        let R0 = (X0.radius || 10) * lD
                            , $8 = Math.max(0, Math.min(1, oD));
                        _8.current.clear(),
                            _8.current.circle(0, 0, R0).fill({
                                color: 0,
                                alpha: $8
                            }),
                            _8.current.position.set(X0.pos?.x || 0, X0.pos?.y || 0)
                    } else if (_8.current && k.current) {
                        try {
                            k.current.removeChild(_8.current)
                        } catch { }
                        x7(_8.current, !0),
                            _8.current = null
                    }
                }
                let B0 = X0.id || `disc_${A0}`;
                c.add(B0);
                let N0 = L.current.get(B0);
                try {
                    if (!N0) {
                        N0 = new w6;
                        let R0 = 16777215
                            , $8 = (X0.color | 0) === -1;
                        try {
                            if (!$8)
                                R0 = J.Utils.numberToColor(X0.color)
                        } catch (N8) { }
                        if ($8)
                            N0.circle(0, 0, X0.radius).stroke({
                                width: 2,
                                color: 0,
                                pixelLine: W.display.perfectPixels
                            });
                        else
                            N0.circle(0, 0, X0.radius).fill({
                                color: R0
                            }).stroke({
                                width: 2,
                                color: 0,
                                pixelLine: W.display.perfectPixels
                            });
                        N0.zIndex = A0 === 0 ? F6.DISCS_BALL : F6.DISCS_REGULAR,
                            k.current.addChild(N0),
                            L.current.set(B0, N0),
                            N0._currentRadius = X0.radius,
                            N0._currentColor = R0,
                            N0._isTransparent = $8
                    } else {
                        let R0 = (X0.color | 0) === -1
                            , $8 = 16777215;
                        try {
                            if (!R0)
                                $8 = J.Utils.numberToColor(X0.color)
                        } catch (N8) { }
                        if (N0._currentRadius !== X0.radius || N0._currentColor !== $8 || N0._isTransparent !== R0) {
                            if (N0.clear(),
                                R0)
                                N0.circle(0, 0, X0.radius).stroke({
                                    width: 2,
                                    color: 0,
                                    pixelLine: W.display.perfectPixels
                                });
                            else
                                N0.circle(0, 0, X0.radius).fill({
                                    color: $8
                                }).stroke({
                                    width: 2,
                                    color: 0,
                                    pixelLine: W.display.perfectPixels
                                });
                            N0._currentRadius = X0.radius,
                                N0._currentColor = $8,
                                N0._isTransparent = R0
                        }
                    }
                    if (X0.pos)
                        N0.position.set(X0.pos.x, X0.pos.y)
                } catch (R0) {
                    if (N0 && k.current)
                        try {
                            k.current.removeChild(N0),
                                L.current.delete(B0)
                        } catch ($8) { }
                }
            }
            ),
                L.current.forEach((X0, A0) => {
                    if (!c.has(A0) && k.current)
                        try {
                            k.current.removeChild(X0),
                                L.current.delete(A0)
                        } catch (B0) {
                            L.current.delete(A0)
                        }
                }
                ),
                k.current)
                k.current.sortChildren()
        } catch (J0) {
            if (k.current)
                try {
                    L.current.forEach((V0, t) => {
                        k.current?.removeChild(V0)
                    }
                    ),
                        L.current.clear()
                } catch (V0) { }
        }
    }
    function h8(C0) {
        if (!C0 || !H || !J || !k.current)
            return;
        try {
            let K0 = C0.gameState?.physicsState?.discs || []
                , J0 = new Set;
            if (K0.forEach((V0) => {
                if (!V0 || !k.current || V0.playerId === null || V0.playerId === void 0)
                    return;
                let t = V0.playerId;
                J0.add(t);
                let c = t === H.currentPlayerId, X0 = C0.players?.find((R0) => R0.id === t) || H.players?.find((R0) => R0.id === t), A0 = X0?.isKicking || !1, B0;
                try {
                    if (X0 && X0.team)
                        B0 = X0.team.id ? J.Utils.numberToColor(X0.team.color) : J.Utils.numberToColor(V0.color);
                    else
                        B0 = J.Utils.numberToColor(V0.color)
                } catch (R0) {
                    B0 = 16777215
                }
                let N0 = F.current.get(t);
                if (!N0)
                    N0 = new w6,
                        N0.circle(0, 0, V0.radius).fill({
                            color: B0
                        }).stroke({
                            width: 2,
                            color: A0 ? 16777215 : 0,
                            pixelLine: W.display.perfectPixels
                        }),
                        N0.zIndex = F6.PLAYERS,
                        k.current.addChild(N0),
                        F.current.set(t, N0),
                        N0.chatBubble = null,
                        N0.shadow = null,
                        N0._currentRadius = V0.radius,
                        N0._isKicking = A0,
                        N0._teamColor = B0;
                else if (N0._currentRadius !== V0.radius || N0._isKicking !== A0 || N0._teamColor !== B0)
                    N0.clear(),
                        N0.circle(0, 0, V0.radius).fill({
                            color: B0
                        }).stroke({
                            width: 2,
                            color: A0 ? 16777215 : 0,
                            pixelLine: W.display.perfectPixels
                        }),
                        N0._currentRadius = V0.radius,
                        N0._isKicking = A0,
                        N0._teamColor = B0;
                if (V0.pos)
                    N0.position.set(V0.pos.x, V0.pos.y);
                try {
                    if (!W.display.enableShadows || !(W.display.enableShadowDrawings ?? !0)) {
                        if (N0.shadow && k.current) {
                            try {
                                k.current.removeChild(N0.shadow)
                            } catch { }
                            N0.shadow = null
                        }
                        return
                    }
                    let R0 = k.current;
                    if (!N0.shadow) {
                        let p0 = new w6;
                        p0.zIndex = F6.SHADOWS;
                        try {
                            p0.blendMode = (void 0)?.MULTIPLY ?? p0.blendMode
                        } catch { }
                        let w8 = nD;
                        try {
                            let y8 = new SZ(w8);
                            if (y8 && typeof y8 === "object") {
                                try {
                                    y8.quality = 2
                                } catch { }
                                p0.filters = [y8]
                            }
                        } catch { }
                        R0.addChild(p0),
                            N0.shadow = p0
                    }
                    let $8 = N0.shadow;
                    $8.clear();
                    let a = (V0.radius || 15) * lD
                        , q0 = a
                        , H0 = Math.max(0, Math.min(1, oD));
                    if ($8.circle(0, 0, a).fill({
                        color: 0,
                        alpha: H0
                    }),
                        V0.pos)
                        $8.position.set(V0.pos.x, V0.pos.y)
                } catch { }
            }
            ),
                F.current.forEach((V0, t) => {
                    if (!J0.has(t) && k.current)
                        try {
                            if (k.current.removeChild(V0),
                                V0.chatBubble)
                                k.current.removeChild(V0.chatBubble);
                            if (V0.shadow)
                                k.current.removeChild(V0.shadow);
                            F.current.delete(t)
                        } catch (c) {
                            F.current.delete(t)
                        }
                }
                ),
                k.current)
                k.current.sortChildren()
        } catch (K0) {
            if (k.current)
                try {
                    F.current.forEach((J0, V0) => {
                        k.current?.removeChild(J0)
                    }
                    ),
                        F.current.clear()
                } catch (J0) { }
        }
    }
    function O0(C0) {
        if (!C0 || !H || !J || !k.current)
            return;
        let K0 = k.current;
        try {
            if (!W.display.showPlayerNames) {
                u.current.forEach((t) => {
                    try {
                        if (t.draw)
                            K0.removeChild(t.draw),
                                t.draw.destroy()
                    } catch (c) { }
                }
                ),
                    u.current.clear();
                return
            }
            let J0 = C0.players || []
                , V0 = new Set;
            J0.forEach((t) => {
                try {
                    if (!t || t.id === null || t.id === void 0 || !t.disc)
                        return;
                    if (t.id === H.currentPlayerId && !W.display.showOwnName)
                        return;
                    V0.add(t.id);
                    let X0 = u.current.get(t.id);
                    if (!X0)
                        try {
                            let A0 = new sJ({
                                text: t.name || `Player ${t.id}`,
                                style: new s6(aS)
                            });
                            A0.anchor.set(0.5, 0),
                                A0.scale.set(0.5),
                                A0.position.set(0, t.disc.radius + sD);
                            let B0 = new m8;
                            B0.position.set(t.disc.pos.x, t.disc.pos.y + pD(t.disc.radius)),
                                B0.zIndex = F6.NAMES,
                                B0.addChild(A0),
                                K0.addChild(B0),
                                u.current.set(t.id, {
                                    draw: B0,
                                    text: A0
                                })
                        } catch (A0) { }
                    else
                        try {
                            if (t.disc.pos && X0.draw)
                                X0.draw.position.set(t.disc.pos.x, t.disc.pos.y + pD(t.disc.radius))
                        } catch (A0) {
                            try {
                                if (X0.draw)
                                    K0.removeChild(X0.draw);
                                let B0 = new sJ({
                                    text: t.name || `Player ${t.id}`,
                                    style: new s6(aS)
                                });
                                B0.anchor.set(0.5, 0),
                                    B0.scale.set(0.5),
                                    B0.position.set(0, t.disc.radius + sD);
                                let N0 = new m8;
                                N0.position.set(t.disc.pos.x, t.disc.pos.y + pD(t.disc.radius)),
                                    N0.zIndex = F6.NAMES,
                                    N0.addChild(B0),
                                    K0.addChild(N0),
                                    u.current.set(t.id, {
                                        draw: N0,
                                        text: B0
                                    })
                            } catch (B0) {
                                u.current.delete(t.id)
                            }
                        }
                } catch (c) { }
            }
            ),
                u.current.forEach((t, c) => {
                    if (!V0.has(c)) {
                        try {
                            if (t.draw)
                                K0.removeChild(t.draw),
                                    t.draw.destroy()
                        } catch (X0) { }
                        u.current.delete(c)
                    }
                }
                )
        } catch (J0) {
            try {
                u.current.forEach((V0) => {
                    try {
                        if (V0.draw)
                            K0.removeChild(V0.draw)
                    } catch (t) { }
                }
                ),
                    u.current.clear()
            } catch (V0) { }
        }
    }
    function h0(C0) {
        if (!C0 || !H || !J || !k.current)
            return;
        let K0 = k.current;
        try {
            let J0 = C0.players || []
                , V0 = new Set;
            J0.forEach((t) => {
                try {
                    if (!t || t.id === null || t.id === void 0 || !t.disc)
                        return;
                    V0.add(t.id);
                    let c = t.avatar || t.avatarNumber || "\uD83D\uDC64";
                    if (!c)
                        return;
                    let X0 = "#FFFFFF";
                    try {
                        if (H.teamColors && t.team && t.team.id !== void 0) {
                            let B0 = H.teamColors[t.team.id];
                            if (B0 && B0.text !== void 0)
                                X0 = J.Utils.numberToColor(B0.text)
                        } else if (t.team && t.team.color !== void 0)
                            X0 = J.Utils.numberToColor(t.team.color)
                    } catch (B0) {
                        X0 = "#FFFFFF"
                    }
                    if (typeof X0 !== "string" || !X0.startsWith("#"))
                        X0 = "#FFFFFF";
                    let A0 = F0.current.get(t.id);
                    if (!A0)
                        try {
                            let N0 = new sJ({
                                text: c,
                                style: new s6({
                                    fontFamily: ["Arial Black", "Arial Bold", "Gadget", "sans-serif"],
                                    fontSize: 20,
                                    align: "center",
                                    fontWeight: "900",
                                    stroke: {
                                        color: "#000000",
                                        width: 2
                                    },
                                    fill: X0
                                })
                            });
                            N0.resolution = 2,
                                N0.anchor.set(0.5),
                                N0.x = t.disc.pos.x,
                                N0.y = t.disc.pos.y;
                            let R0 = Math.max(0.6, Math.min(2.5, (t.disc.radius || 15) / 15));
                            N0.scale.set(R0),
                                N0.zIndex = F6.AVATARS,
                                K0.addChild(N0),
                                F0.current.set(t.id, {
                                    draw: N0
                                })
                        } catch (B0) { }
                    else
                        try {
                            if (t.disc.pos && A0.draw) {
                                if (A0.draw.x = t.disc.pos.x,
                                    A0.draw.y = t.disc.pos.y,
                                    A0.draw.text !== c)
                                    A0.draw.text = c;
                                if (A0.draw.style.fill !== X0)
                                    A0.draw.style.fill = X0;
                                let B0 = Math.max(0.6, Math.min(2.5, (t.disc.radius || 15) / 15));
                                if (A0.draw.scale.x !== B0 || A0.draw.scale.y !== B0)
                                    A0.draw.scale.set(B0)
                            }
                        } catch (B0) {
                            try {
                                if (A0.draw)
                                    K0.removeChild(A0.draw);
                                let R0 = new sJ({
                                    text: c,
                                    style: new s6({
                                        fontFamily: ["Arial Black", "Arial Bold", "Gadget", "sans-serif"],
                                        fontSize: 20,
                                        align: "center",
                                        fontWeight: "900",
                                        stroke: {
                                            color: "#000000",
                                            width: 2
                                        },
                                        fill: X0
                                    })
                                });
                                R0.resolution = 2,
                                    R0.anchor.set(0.5),
                                    R0.x = t.disc.pos.x,
                                    R0.y = t.disc.pos.y;
                                let $8 = Math.max(0.6, Math.min(2.5, (t.disc.radius || 15) / 15));
                                R0.scale.set($8),
                                    R0.zIndex = F6.AVATARS,
                                    K0.addChild(R0),
                                    F0.current.set(t.id, {
                                        draw: R0
                                    })
                            } catch (N0) {
                                F0.current.delete(t.id)
                            }
                        }
                } catch (c) { }
            }
            ),
                F0.current.forEach((t, c) => {
                    if (!V0.has(c)) {
                        try {
                            if (t.draw)
                                K0.removeChild(t.draw),
                                    t.draw.destroy()
                        } catch (X0) { }
                        F0.current.delete(c)
                    }
                }
                )
        } catch (J0) {
            try {
                F0.current.forEach((V0) => {
                    try {
                        if (V0.draw)
                            K0.removeChild(V0.draw)
                    } catch (t) { }
                }
                ),
                    F0.current.clear()
            } catch (V0) { }
        }
    }
    function R8(C0) {
        if (!C0 || !H || !J || !k.current)
            return;
        if (!W.display.showPlayerDecorator) {
            b.current.forEach((J0) => {
                try {
                    k.current?.removeChild(J0),
                        J0.destroy()
                } catch (V0) { }
            }
            ),
                b.current.clear();
            return
        }
        let K0 = k.current;
        try {
            let J0 = C0.players || []
                , V0 = new Set;
            J0.forEach((t) => {
                if (!t || !t.disc)
                    return;
                let c = t.id
                    , X0 = c === H.currentPlayerId
                    , A0 = W.display.showPlayerDecoratorAll || !1;
                if (!X0 && !A0)
                    return;
                V0.add(c);
                try {
                    let B0 = b.current.get(c);
                    if (!B0)
                        B0 = new w6,
                            B0.zIndex = F6.DECORATORS,
                            K0.addChild(B0),
                            b.current.set(c, B0);
                    try {
                        B0.clear()
                    } catch (N8) {
                        K0.removeChild(B0),
                            B0 = new w6,
                            B0.zIndex = F6.DECORATORS,
                            K0.addChild(B0),
                            b.current.set(c, B0)
                    }
                    let N0 = t.disc.radius + 10
                        , R0 = W.display.playerDecoratorColor || "#FFFFFF";
                    if (typeof R0 === "string") {
                        try {
                            R0 = R0.replace("#", "")
                        } catch { }
                        try {
                            R0 = parseInt(R0, 16)
                        } catch {
                            R0 = 16777215
                        }
                    }
                    let $8 = Math.max(0, Math.min(1, W.display.playerDecoratorOpacity ?? 0.3));
                    if (B0.circle(0, 0, N0).stroke({
                        width: 3,
                        color: R0 ?? 16777215,
                        alpha: $8,
                        pixelLine: W.display.perfectPixels
                    }),
                        t.disc.pos)
                        B0.position.set(t.disc.pos.x, t.disc.pos.y)
                } catch (B0) {
                    try {
                        let N0 = b.current.get(c);
                        if (N0)
                            K0.removeChild(N0),
                                b.current.delete(c)
                    } catch (N0) { }
                }
            }
            ),
                b.current.forEach((t, c) => {
                    if (!V0.has(c)) {
                        try {
                            K0.removeChild(t),
                                t.destroy()
                        } catch (X0) { }
                        b.current.delete(c)
                    }
                }
                )
        } catch (J0) {
            try {
                b.current.forEach((V0) => {
                    try {
                        K0.removeChild(V0)
                    } catch (t) { }
                }
                ),
                    b.current.clear()
            } catch (V0) { }
        }
    }
    function X6(C0) {
        if (!C0 || !H || !J || !k.current)
            return;
        try {
            let K0 = C0.gameState?.physicsState?.discs || []
                , J0 = new Set;
            if (K0.forEach((V0) => {
                if (!V0 || !k.current || V0.playerId === null || V0.playerId === void 0)
                    return;
                let t = V0.playerId;
                J0.add(t);
                let c = C0.players?.find((N0) => N0.id === t) || H.players?.find((N0) => N0.id === t), X0 = c?.isKicking || !1, A0;
                try {
                    if (c && c.team)
                        A0 = c.team.id ? J.Utils.numberToColor(c.team.color) : J.Utils.numberToColor(V0.color);
                    else
                        A0 = J.Utils.numberToColor(V0.color)
                } catch (N0) {
                    A0 = 16777215
                }
                let B0 = g.current.get(t);
                if (!B0)
                    B0 = new w6,
                        B0.circle(0, 0, V0.radius).fill({
                            color: A0,
                            alpha: 0.3
                        }).stroke({
                            width: 2,
                            color: X0 ? 16777215 : 0,
                            alpha: 0.3,
                            pixelLine: W.display.perfectPixels
                        }),
                        B0.zIndex = F6.CLONES,
                        k.current.addChild(B0),
                        g.current.set(t, B0),
                        B0._currentRadius = V0.radius,
                        B0._isKicking = X0,
                        B0._teamColor = A0;
                else if (B0._currentRadius !== V0.radius || B0._isKicking !== X0 || B0._teamColor !== A0)
                    B0.clear(),
                        B0.circle(0, 0, V0.radius).fill({
                            color: A0,
                            alpha: 0.3
                        }).stroke({
                            width: 2,
                            color: X0 ? 16777215 : 0,
                            alpha: 0.3,
                            pixelLine: W.display.perfectPixels
                        }),
                        B0._currentRadius = V0.radius,
                        B0._isKicking = X0,
                        B0._teamColor = A0;
                if (V0.pos)
                    B0.position.set(V0.pos.x, V0.pos.y)
            }
            ),
                g.current.forEach((V0, t) => {
                    if (!J0.has(t) && k.current)
                        try {
                            k.current.removeChild(V0),
                                g.current.delete(t)
                        } catch (c) {
                            g.current.delete(t)
                        }
                }
                ),
                k.current)
                k.current.sortChildren()
        } catch (K0) {
            if (k.current)
                try {
                    g.current.forEach((J0, V0) => {
                        k.current?.removeChild(J0)
                    }
                    ),
                        g.current.clear()
                } catch (J0) { }
        }
    }
    i0(() => {
        if (!U.current || !H || j.current)
            return;
        A8("Initializing rendering ticker");
        let C0 = n6.shared;
        C0.autoStart = !1,
            C0.add(k0);
        let K0 = W.display.unlimitedFPS ? 0 : W.display.targetFPS;
        return C0.maxFPS = K0,
            Y.current = C0,
            j.current = !0,
            C0.start(),
            A8("Ticker started"),
            () => {
                if (Y.current) {
                    if (Y.current.remove(k0),
                        Y.current.count === 0)
                        Y.current.stop();
                    Y.current = null,
                        j.current = !1,
                        A8("Ticker cleanup completed")
                }
            }
    }
        , [Q, H]),
        i0(() => {
            v.current = W.display.extrapolation,
                A8(`Extrapolation updated to: ${W.display.extrapolation}`)
        }
            , [W.display.extrapolation]),
        i0(() => {
            if (!W.display.extrapolationCloneView && k.current)
                try {
                    g.current.forEach((K0, J0) => {
                        if (k.current)
                            k.current.removeChild(K0)
                    }
                    ),
                        g.current.clear(),
                        A8("Clone graphics cleaned up - extrapolation clone view disabled")
                } catch (K0) { }
        }
            , [W.display.extrapolationCloneView]),
        i0(() => {
            if (Y.current) {
                let C0 = W.display.unlimitedFPS ? 0 : W.display.targetFPS;
                Y.current.maxFPS = C0,
                    A8(`FPS updated to: ${W.display.unlimitedFPS ? "unlimited" : W.display.targetFPS}`)
            }
        }
            , [W.display.unlimitedFPS, W.display.targetFPS]),
        i0(() => {
            let K0 = setInterval(() => {
                if ("memory" in performance) {
                    let J0 = performance.memory;
                    if (J0.usedJSHeapSize / J0.jsHeapSizeLimit > 0.8) {
                        A8("Memory usage high, triggering cleanup"),
                            d9.unloadBundle("__pixiTemp");
                        while (T4.length > tS / 2) {
                            let V0 = T4.pop();
                            if (V0)
                                x7(V0, !0)
                        }
                        if (n.current && n.current.destroyed)
                            try {
                                if (k.current && k.current.children.includes(n.current))
                                    k.current.removeChild(n.current);
                                n.current = null
                            } catch (V0) {
                                A8(`Error cleaning up invalid joints graphics during memory cleanup: ${V0}`)
                            }
                    }
                }
            }
                , 30000);
            return () => {
                clearInterval(K0)
            }
        }
            , []);
    function k0() {
        if (!H || !U.current)
            return;
        try {
            let C0 = Date.now();
            if (H8.current++,
                C0 - E0.current >= 1000) {
                let t = Math.round(H8.current * 1000 / (C0 - E0.current));
                d0(t),
                    H8.current = 0,
                    E0.current = C0
            }
            if (!H.gameState)
                return;
            let K0 = W.display.extrapolationCloneView ? !0 : !1;
            if (K0) {
                let t = H.extrapolate(v.current, !0);
                if (t.gameState.physicsState?.discs)
                    X6(t)
            }
            let J0 = H.extrapolate(K0 ? 0 : v.current, !0);
            if (!J0.gameState)
                return;
            let V0 = (C0 - N.current) / 1000;
            if (N.current = C0,
                S6(U.current, J0.gameState, V0),
                J0.gameState.physicsState?.discs) {
                if (K8(J0.gameState.physicsState.discs, V0),
                    J0.gameState.physicsState.joints && J0.gameState.physicsState.joints.length > 0)
                    d6(J0.gameState.physicsState);
                else if (n.current && !n.current.destroyed)
                    try {
                        n.current.clear()
                    } catch (X0) {
                        A8(`Error clearing joints graphics in update loop: ${X0}`)
                    }
                else if (n.current && n.current.destroyed)
                    n.current = null;
                h8(J0),
                    R8(J0),
                    O0(J0),
                    h0(J0);
                let t = U.current.screen.width / P.current
                    , c = U.current.screen.height / P.current;
                o0(J0, t, c),
                    F.current.forEach((X0, A0) => {
                        if (X0.chatBubble && X0.position)
                            X0.chatBubble.position.set(X0.position.x, X0.position.y)
                    }
                    ),
                    l.current.forEach((X0, A0) => {
                        let B0 = H?.getPlayer(A0);
                        if (!B0 || !B0.disc || !B0.disc.pos)
                            return;
                        let N0 = F.current.get(A0)
                            , R0 = N0 && N0.position ? N0.position.x : B0.disc.pos.x
                            , $8 = N0 && N0.position ? N0.position.y : B0.disc.pos.y;
                        X0.position.set(R0, $8 - (B0.disc.radius || 15) - rS)
                    }
                    )
            }
            U.current.render()
        } catch (C0) { }
    }
    i0(() => {
        if (!H)
            return;
        let C0 = {}
            , K0 = v6.on("gameStart", ({ byId: J0 }) => {
                if (A8("Game start event received, checking textures before drawing stadium"),
                    H.gameState && H.gameState.stadium && V) {
                    if (k.current)
                        k.current.children.filter((t) => t.zIndex <= F6.SEGMENTS).forEach((t) => {
                            if (k.current?.removeChild(t),
                                "destroy" in t)
                                t.destroy()
                        }
                        );
                    i.current = null,
                        E.current = null;
                    try {
                        u.current.forEach((V0) => {
                            if (V0.draw && k.current)
                                k.current.removeChild(V0.draw),
                                    V0.draw.destroy()
                        }
                        ),
                            u.current.clear(),
                            A8("Cleared player names to force redraw on game start")
                    } catch (V0) { }
                    L0(H.gameState.stadium),
                        d8(H.gameState.stadium),
                        A8("Stadium redrawn after game start")
                } else if (!V)
                    A8("Game start event received but textures not loaded yet - stadium will be drawn when textures are ready")
            }
            );
        return C0.gameStart = K0,
            () => {
                if (C0.gameStart)
                    C0.gameStart()
            }
    }
        , [H, V, W.display]),
        i0(() => {
            if (V && H && H.gameState && H.gameState.stadium && k.current) {
                if (!k.current.children.some((K0) => K0.zIndex <= F6.SEGMENTS))
                    A8("Textures loaded and game state available - drawing stadium"),
                        L0(H.gameState.stadium),
                        d8(H.gameState.stadium)
            }
        }
            , [V, H?.gameState?.stadium]),
        i0(() => {
            if (!Q || !H)
                return;
            A8("Setting up game event listeners");
            let C0 = v6.on("playerChatIndicator", (J0) => {
                A8(`Chat indicator change for player ${J0.playerId}, isTyping: ${J0.isTyping}`),
                    U6(J0.playerId, J0.isTyping)
            }
            )
                , K0 = v6.on("playerChat", ({ playerId: J0, message: V0 }) => {
                    try {
                        if (!W.display.chatBubbles)
                            return;
                        if (!k.current)
                            return;
                        let t = H?.getPlayer(J0);
                        if (!t || !t.disc || !t.disc.pos)
                            return;
                        let c = l.current.get(J0);
                        if (!c)
                            c = new m8,
                                c.zIndex = F6.CHAT_BUBBLES,
                                k.current.addChild(c),
                                l.current.set(J0, c);
                        try {
                            (c.children ? [...c.children] : []).forEach((W8) => {
                                try {
                                    c.removeChild(W8)
                                } catch { }
                                try {
                                    W8.destroy?.()
                                } catch { }
                            }
                            )
                        } catch { }
                        let X0 = (V0 || "").toString()
                            , A0 = X0.length > 20 ? X0.slice(0, 20) + "…" : X0
                            , B0 = new s6({
                                fontFamily: ["Arial, Helvetica, sans-serif"],
                                fontSize: 12,
                                fill: "#000000"
                            })
                            , N0 = new sJ({
                                text: A0,
                                style: B0
                            });
                        N0.resolution = 2,
                            N0.x = 8,
                            N0.y = 5;
                        let R0 = 12
                            , $8 = 8
                            , N8 = Math.max(24, N0.width + R0)
                            , a = Math.max(18, N0.height + $8)
                            , q0 = new w6;
                        q0.roundRect(0, 0, N8, a, 8).fill({
                            color: 16777215,
                            alpha: 0.95
                        }),
                            q0.poly([N8 * 0.5 - 6, a, N8 * 0.5 + 6, a, N8 * 0.5, a + 6]).fill({
                                color: 16777215,
                                alpha: 0.95
                            }),
                            c.pivot.set(N8 / 2, a + 6);
                        let H0 = F.current.get(J0)
                            , p0 = H0 && H0.position ? H0.position.x : t.disc.pos.x
                            , w8 = H0 && H0.position ? H0.position.y : t.disc.pos.y;
                        c.position.set(p0, w8 - (t.disc.radius || 15) - rS),
                            c.addChild(q0),
                            c.addChild(N0);
                        let y8 = o.current.get(J0);
                        if (y8)
                            try {
                                clearTimeout(y8)
                            } catch { }
                        let j8 = setTimeout(() => {
                            try {
                                if (c && k.current)
                                    k.current.removeChild(c),
                                        l.current.delete(J0)
                            } catch { }
                            o.current.delete(J0)
                        }
                            , 3000);
                        o.current.set(J0, j8)
                    } catch (t) { }
                }
                );
            return () => {
                A8("Cleaning up event listeners"),
                    C0(),
                    K0(),
                    K6.current.forEach((J0) => {
                        clearInterval(J0)
                    }
                    ),
                    K6.current.clear(),
                    o.current.forEach((J0) => {
                        try {
                            clearTimeout(J0)
                        } catch { }
                    }
                    ),
                    o.current.clear()
            }
        }
            , [Q, H, W.display.chatBubbles]),
        i0(() => {
            if (!W.display.chatBubbles)
                try {
                    l.current.forEach((K0) => {
                        try {
                            if (k.current)
                                k.current.removeChild(K0)
                        } catch { }
                    }
                    ),
                        l.current.clear(),
                        o.current.forEach((K0) => {
                            try {
                                clearTimeout(K0)
                            } catch { }
                        }
                        ),
                        o.current.clear()
                } catch { }
        }
            , [W.display.chatBubbles]);
    function U6(C0, K0) {
        if (!k.current)
            return;
        let J0 = F.current.get(C0)
            , V0 = H?.getPlayer(C0);
        if (!J0 || !V0 || !V0.disc)
            return;
        if (K6.current.has(C0))
            clearInterval(K6.current.get(C0)),
                K6.current.delete(C0);
        let t = 20
            , c = 10
            , X0 = 5
            , A0 = 5
            , B0 = -(V0.disc.radius + c + A0 + X0);
        if (!J0.chatBubble) {
            let R0 = new w6;
            R0.zIndex = F6.CHAT_BUBBLES,
                k.current.addChild(R0),
                J0.chatBubble = R0
        }
        let N0 = J0.chatBubble;
        if (K0) {
            let R0 = 0
                , $8 = () => {
                    if (!N0 || !V0.disc)
                        return;
                    N0.clear(),
                        N0.roundRect(-t / 2, B0, t, c, 5).fill({
                            color: 16777215
                        }),
                        N0.poly([-A0, B0 + c, 0, B0 + c + A0, A0, B0 + c]).fill({
                            color: 16777215
                        });
                    let a = 1.5
                        , q0 = 4
                        , H0 = B0 + c / 2;
                    [{
                        x: -q0,
                        y: H0
                    }, {
                        x: 0,
                        y: H0
                    }, {
                        x: q0,
                        y: H0
                    }].forEach((w8, y8) => {
                        if ((y8 + R0) % 3 < 2)
                            N0.circle(w8.x, w8.y, a).fill({
                                color: 0
                            })
                    }
                    ),
                        N0.position.set(V0.disc.pos.x, V0.disc.pos.y)
                }
                ;
            $8();
            let N8 = setInterval(() => {
                R0 = (R0 + 1) % 3,
                    $8()
            }
                , 200);
            K6.current.set(C0, N8)
        } else
            N0.clear()
    }
    function V8(C0, K0, J0, V0, t) {
        if (!k.current || !C0)
            return;
        let c = k.current
            , X0 = 0.5 * V0 - 25
            , A0 = 0.5 * t - 25
            , B0 = C0.x - c.center.x
            , N0 = C0.y - c.center.y
            , R0 = c.center.x + Math.max(-X0, Math.min(X0, B0))
            , $8 = c.center.y + Math.max(-A0, Math.min(A0, N0))
            , N8 = C0.x - R0
            , a = C0.y - $8;
        if (N8 * N8 + a * a <= 900) {
            let w8 = k6.current.get(J0);
            if (w8)
                w8.visible = !1;
            return
        }
        let H0 = k6.current.get(J0);
        if (!H0)
            H0 = new w6,
                H0.zIndex = F6.LOCATION_INDICATORS,
                c.addChild(H0),
                k6.current.set(J0, H0);
        H0.clear(),
            H0.visible = !0;
        let p0 = Math.atan2(a, N8);
        H0.position.set(R0, $8),
            H0.rotation = p0,
            H0.poly([17, 2, 2, 9, 2, -5]).fill({
                color: 0,
                alpha: 0.5
            }),
            H0.poly([13, -2, -2, 5, -2, -9]).fill({
                color: K0,
                alpha: 1
            })
    }
    function o0(C0, K0, J0) {
        if (!C0?.gameState?.physicsState?.discs || !k.current)
            return;
        let V0 = C0.gameState.physicsState.discs
            , t = C0.players || []
            , c = new Set;
        try {
            if (V0[0] && V0[0].pos) {
                let X0 = J.Utils.numberToColor(V0[0].color);
                V8(V0[0].pos, X0, "ball", K0, J0),
                    c.add("ball")
            }
            t.forEach((X0) => {
                if (!X0 || !X0.disc || !X0.disc.pos)
                    return;
                try {
                    let A0;
                    if (X0.team && X0.team.color !== void 0)
                        A0 = J.Utils.numberToColor(X0.team.color);
                    else
                        A0 = J.Utils.numberToColor(X0.disc.color);
                    let B0 = `player_${X0.id}`;
                    V8(X0.disc.pos, A0, B0, K0, J0),
                        c.add(B0)
                } catch (A0) { }
            }
            ),
                k6.current.forEach((X0, A0) => {
                    if (!c.has(A0))
                        X0.visible = !1
                }
                )
        } catch (X0) { }
    }
    return A(GJ, {
        children: [A("div", {
            style: Cl,
            ref: $
        }), (!Q || !V) && A("div", {
            style: Ol,
            children: [A("div", {
                children: "Loading..."
            }), A("div", {
                children: q || "Initializing..."
            })]
        }), A(Fl, {
            fps: b0
        })]
    })
}
var Gl = `
    .game-text-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        pointer-events: none;
        z-index: 30; /* Below GameMenu (z-40) but same as Scoreboard */
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: 'Impact', 'Charcoal', sans-serif;
        text-align: center;
        opacity: 0;
        transform: scale(0.8);
        transition: opacity 0.3s ease, transform 0.3s ease, filter 0.3s ease;
    }
    
    .game-text-overlay.paused {
        filter: grayscale(70%);
    }
    
    .game-text-overlay.show {
        opacity: 1;
        transform: scale(1);
    }
    
    .game-text-overlay.slide-from-left {
        transform: translateX(-100vw) scale(1);
    }
    
    .game-text-overlay.slide-from-right {
        transform: translateX(100vw) scale(1);
    }
    
    .game-text-overlay.slide-from-left.show {
        transform: translateX(0) scale(1);
    }
    
    .game-text-overlay.slide-from-right.show {
        transform: translateX(0) scale(1);
    }
    
    .game-text-overlay.slide-to-left {
        transform: translateX(-100vw) scale(0.9);
    }
    
    .game-text-overlay.slide-to-right {
        transform: translateX(100vw) scale(0.9);
    }
    
    .game-text {
        font-size: 4rem; /* Reduced from 6rem */
        font-weight: bold;
        text-shadow: 4px 4px 8px rgba(0, 0, 0, 0.8);
        line-height: 1.2;
        padding: 20px;
        animation: pulse 0.5s ease-in-out;
    }
    
    .game-text.pause-text {
        font-size: 3rem; /* Smaller for pause text */
        color: #FFFFFF;
        animation: none;
    }
    
    .game-text.red-team {
        color: #FF4136;
    }
    
    .game-text.blue-team {
        color: #0074D9;
    }
    
    .game-text.neutral {
        color: #FFFFFF;
    }
    
    .game-text.time-up {
        color: #FFDC00;
    }
    
    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }
    
    @media (max-width: 768px) {
        .game-text {
            font-size: 2.5rem; /* Reduced from 3rem */
        }
        .game-text.pause-text {
            font-size: 2rem;
        }
    }
    
    @media (max-width: 480px) {
        .game-text {
            font-size: 1.5rem; /* Reduced from 2rem */
        }
        .game-text.pause-text {
            font-size: 1.2rem;
        }
    }
`;
function JT() {
    let { room: J } = qJ()
        , [Q, Z] = C8({
            text: "",
            type: "",
            animationClass: "",
            isShowing: !1
        })
        , [$, q] = C8(!1)
        , K = n0(null)
        , V = n0(null)
        , z = n0(null)
        , W = n0(Q);
    i0(() => {
        W.current = Q
    }
        , [Q]),
        i0(() => {
            let j = document.createElement("style");
            return j.id = "game-text-overlay-styles",
                j.textContent = Gl,
                document.head.appendChild(j),
                () => {
                    let k = document.getElementById("game-text-overlay-styles");
                    if (k)
                        document.head.removeChild(k)
                }
        }
            , []),
        i0(() => {
            if (!J)
                return;
            let k = setInterval(() => {
                let L = W.current;
                if (J.gameState && J.gameState.pauseGameTickCounter > 0) {
                    if (L.type === "pause" || L.type === "" || !L.isShowing)
                        if (J.gameState.pauseGameTickCounter === 120)
                            Z({
                                text: "GAME PAUSED",
                                type: "pause",
                                animationClass: "",
                                isShowing: !0
                            });
                        else {
                            let F = Math.ceil(J.gameState.pauseGameTickCounter / 30);
                            Z({
                                text: `RESUMING IN ${F}...`,
                                type: "pause",
                                animationClass: "",
                                isShowing: !0
                            })
                        }
                } else if (L.type === "pause" && L.isShowing)
                    Z({
                        text: "",
                        type: "",
                        animationClass: "",
                        isShowing: !1
                    }),
                        q(!1)
            }
                , 50);
            return () => {
                clearInterval(k)
            }
        }
            , [J]);
    let H = (j, k, L = 3000) => {
        if (K.current)
            clearTimeout(K.current);
        if (V.current)
            clearTimeout(V.current);
        let F = "";
        if (k === "red-team")
            F = "slide-from-left";
        else if (k === "blue-team")
            F = "slide-from-right";
        if (Z({
            text: j,
            type: k,
            animationClass: F,
            isShowing: !1
        }),
            K.current = setTimeout(() => {
                Z((P) => {
                    return {
                        ...P,
                        isShowing: !0
                    }
                }
                )
            }
                , 20),
            L !== 1 / 0)
            V.current = setTimeout(() => {
                let P = "";
                if (k === "red-team")
                    P = "slide-to-right";
                else if (k === "blue-team")
                    P = "slide-to-left";
                Z((M) => ({
                    ...M,
                    isShowing: !1,
                    animationClass: `${M.animationClass} ${P}`.trim()
                }))
            }
                , L)
    }
        , Y = () => {
            if (K.current)
                clearTimeout(K.current);
            if (V.current)
                clearTimeout(V.current);
            Z((j) => ({
                ...j,
                isShowing: !1,
                animationClass: ""
            }))
        }
        ;
    i0(() => {
        if (!J)
            return;
        let j = (M) => {
            if ($)
                return;
            let v = M.teamId === 1 ? "RED TEAM SCORES!" : "BLUE TEAM SCORES!"
                , E = M.teamId === 1 ? "red-team" : "blue-team";
            H(v, E, 3000)
        }
            , k = (M) => {
                if (J?.gameState?.time === 0 && J?.gameState?.timeLimit > 0)
                    return;
                let v, E;
                if (M.winningTeamId === 1)
                    v = "RED TEAM WINS!",
                        E = "red-team";
                else if (M.winningTeamId === 2)
                    v = "BLUE TEAM WINS!",
                        E = "blue-team";
                else
                    v = "GAME OVER!",
                        E = "neutral";
                H(v, E, 4000)
            }
            , L = () => {
                if ($)
                    return;
                H("TIME IS UP!", "time-up", 3000),
                    setTimeout(() => {
                        let M = J?.gameState?.redScore || 0, v = J?.gameState?.blueScore || 0, E, n;
                        if (M > v)
                            E = "RED TEAM WINS!",
                                n = "red-team";
                        else if (v > M)
                            E = "BLUE TEAM WINS!",
                                n = "blue-team";
                        else
                            E = "IT'S A DRAW!",
                                n = "neutral";
                        H(E, n, 4000)
                    }
                        , 3500)
            }
            , F = (M) => {
                q(M.isPaused)
            }
            , P = [v6.on("teamGoal", j), v6.on("gameEnd", k), v6.on("timeIsUp", L), v6.on("gamePauseChange", F)];
        return () => {
            if (P.forEach((M) => M()),
                K.current)
                clearTimeout(K.current);
            if (V.current)
                clearTimeout(V.current)
        }
    }
        , [J, $]);
    let U = ["game-text-overlay", Q.animationClass, Q.isShowing ? "show" : "", $ ? "paused" : ""].join(" ").trim()
        , N = ["game-text", Q.type === "pause" ? "pause-text" : Q.type].join(" ").trim();
    return A("div", {
        class: U,
        children: A("div", {
            class: N,
            children: Q.text
        })
    })
}
var yJ = {
    TryingReverseConnection: -1,
    ConnectingToMaster: 0,
    ConnectingToPeer: 1,
    AwaitingState: 2,
    Active: 3,
    ConnectionFailed: 4
}
    , Pl = {
        [yJ.TryingReverseConnection]: "Trying reverse connection...",
        [yJ.ConnectingToMaster]: "Connecting to master server...",
        [yJ.ConnectingToPeer]: "Connecting to peer...",
        [yJ.AwaitingState]: "Awaiting room state...",
        [yJ.Active]: "Connected",
        [yJ.ConnectionFailed]: "Connection failed"
    };
function QT({ connectionState: J, customErrorMessage: Q }) {
    let Z = Q || Pl[J] || "Connecting..."
        , $ = J === yJ.Active
        , q = J === yJ.ConnectionFailed;
    return A("div", {
        className: "fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50",
        children: A("div", {
            className: "bg-gray-800 rounded-lg p-8 text-center max-w-md mx-4 border border-gray-600",
            children: [A("div", {
                className: "mb-4",
                children: [!q && !$ && A("div", {
                    className: "animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"
                }), q && A("div", {
                    className: "text-red-500 text-4xl mb-4",
                    children: "⚠️"
                }), $ && A("div", {
                    className: "text-green-500 text-4xl mb-4",
                    children: "✅"
                })]
            }), A("h2", {
                className: "text-xl font-bold text-white mb-2",
                children: "Connection Status"
            }), A("p", {
                className: "text-gray-300",
                children: Z
            }), q && A("div", {
                className: "mt-4 space-y-2",
                children: Q && Q.includes("not logged in") ? A("button", {
                    className: "w-full px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",
                    onClick: () => global.location.href = "/",
                    children: "Back to Lobby"
                }) : A("button", {
                    className: "w-full px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",
                    onClick: () => global.location.reload(),
                    children: "Retry"
                })
            })]
        })
    })
}
function ZT({ reason: J, onRetry: Q, onBackToLobby: Z }) {
    let $ = (U) => {
        if (!U)
            return "Room was closed";
        if (typeof U === "string")
            return U;
        if (U && typeof U === "object" && U.message)
            return U.message;
        if (U && typeof U === "object" && typeof U.toString === "function")
            try {
                return U.toString()
            } catch (N) {
                return "Room was closed unexpectedly"
            }
        return "Room was closed unexpectedly"
    }
        , q = (U) => {
            if (!U)
                return "\uD83D\uDEAA";
            let N = "";
            if (typeof U === "string")
                N = U;
            else if (U && typeof U === "object" && U.message)
                N = U.message;
            else if (U && typeof U === "object" && typeof U.toString === "function")
                try {
                    N = U.toString()
                } catch (j) {
                    N = ""
                }
            if (N.toLowerCase().includes("banned"))
                return "\uD83D\uDD28";
            if (N.toLowerCase().includes("kicked"))
                return "\uD83D\uDC62";
            return "\uD83D\uDEAA"
        }
        , K = (U) => {
            if (!U)
                return "Room Closed";
            let N = "";
            if (typeof U === "string")
                N = U;
            else if (U && typeof U === "object" && U.message)
                N = U.message;
            else if (U && typeof U === "object" && typeof U.toString === "function")
                try {
                    N = U.toString()
                } catch (j) {
                    N = ""
                }
            if (N.toLowerCase().includes("banned"))
                return "Banned from Room";
            if (N.toLowerCase().includes("kicked"))
                return "Kicked from Room";
            return "Room Closed"
        }
        , V = (U) => {
            if (!U)
                return !0;
            let N = "";
            if (typeof U === "string")
                N = U;
            else if (U && typeof U === "object" && U.message)
                N = U.message;
            else if (U && typeof U === "object" && typeof U.toString === "function")
                try {
                    N = U.toString()
                } catch (j) {
                    N = ""
                }
            if (N.toLowerCase().includes("banned"))
                return !1;
            return !0
        }
        , z = $(J)
        , W = q(J)
        , H = K(J)
        , Y = V(J);
    return A("div", {
        className: "fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50",
        children: A("div", {
            className: "bg-gray-800 rounded-lg p-8 text-center max-w-md mx-4 border border-gray-600",
            children: [A("div", {
                className: "mb-4",
                children: A("div", {
                    className: "text-red-500 text-4xl mb-4",
                    children: W
                })
            }), A("h2", {
                className: "text-xl font-bold text-white mb-2",
                children: H
            }), A("p", {
                className: "text-gray-300 mb-4",
                children: z
            }), A("div", {
                className: `flex gap-3 mt-6 ${!Y ? "justify-center" : ""}`,
                children: [Y && A("button", {
                    className: "flex-1 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",
                    onClick: Q,
                    children: "Try Again"
                }), A("button", {
                    className: `px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors ${Y ? "flex-1" : "px-8"}`,
                    onClick: Z,
                    children: "Back to Lobby"
                })]
            })]
        })
    })
}
var KT = n5({
    user: null,
    isAuthenticated: !1,
    refreshNow: async () => { }
    ,
    logout: async () => { }
})
    , Dl = 300000
    , Al = 60000
    , $T = "lastTokenUpdate";
async function El() {
    try {
        let J = await fetch("https://luxball.online/api/userInfo", {
            headers: {
                "Content-Type": "application/json",
                accept: "",
                "accept-language": "tr,en;q=0.9,en-GB;q=0.8,en-US;q=0.7",
                "sec-ch-ua":
                    '" Not A;Brand";v="99", "Chromium";v="100", "Microsoft Edge";v="100"',
                "sec-ch-ua-mobile": "?0",
                "sec-ch-ua-platform": '"Windows"',
                "sec-fetch-dest": "empty",
                "sec-fetch-mode": "cors",
                "sec-fetch-site": "same-site",
                Referer: "https://luxball.online/",
                "Referrer-Policy": "strict-origin-when-cross-origin",
            },
            credentials: "include"
        }).catch((e) => console.log(e));
        if (!J.ok)
            return null;
        return (await J.json())?.user ?? null
    } catch {
        return null
    }
}
async function qT() {
    if (!localStorage.getItem("lastTokenUpdate"))
        return !1;
    let Q = Date.now()
        , Z = parseInt(localStorage.getItem($T) || "0", 10);
    if (Q - Z < Dl)
        return !1;
    try {
        if ((await fetch("https://luxball.online/api/updateToken", {
            headers: {
                accept: "",
                "accept-language": "tr,en;q=0.9,en-GB;q=0.8,en-US;q=0.7",
                "sec-ch-ua":
                    '" Not A;Brand";v="99", "Chromium";v="100", "Microsoft Edge";v="100"',
                "sec-ch-ua-mobile": "?0",
                "sec-ch-ua-platform": '"Windows"',
                "sec-fetch-dest": "empty",
                "sec-fetch-mode": "cors",
                "sec-fetch-site": "same-site",
                Referer: "https://luxball.online/",
                "Referrer-Policy": "strict-origin-when-cross-origin",
            },
            method: "GET",
            credentials: "include"
        }).catch((e) => console.log(e))).ok)
            return localStorage.setItem($T, String(Q)),
                !0
    } catch ($) { }
    return !1
}
function VT({ children: J }) {
    let [Q, Z] = C8(null)
        , $ = n0(null)
        , q = !!Q;
    i0(() => {
        $.current = Q
    }
        , [Q]);
    let K = async () => {
        let W = await El();
        Z(W)
    }
        ;
    i0(() => {
        let W = !1;
        (async () => {
            if (W)
                return;
            await K();
            let Y = await qT();
            if (!W && Y)
                await K()
        }
        )();
        let H = setInterval(async () => {
            if (await qT())
                await K()
        }
            , Al);
        return () => {
            W = !0,
                clearInterval(H)
        }
    }
        , []);
    let V = async () => {
        try {
            if ((await fetch("https://luxball.online/api/logout", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    accept: "",
                    "accept-language": "tr,en;q=0.9,en-GB;q=0.8,en-US;q=0.7",
                    "sec-ch-ua":
                        '" Not A;Brand";v="99", "Chromium";v="100", "Microsoft Edge";v="100"',
                    "sec-ch-ua-mobile": "?0",
                    "sec-ch-ua-platform": '"Windows"',
                    "sec-fetch-dest": "empty",
                    "sec-fetch-mode": "cors",
                    "sec-fetch-site": "same-site",
                    Referer: "https://luxball.online/",
                    "Referrer-Policy": "strict-origin-when-cross-origin",
                },
                credentials: "include"
            }).catch((e) => console.log(e))).ok)
                Z(null),
                    global.location.href = "/login"
        } catch { }
    }
        , z = pQ(() => ({
            user: Q,
            isAuthenticated: q,
            refreshNow: K,
            logout: V
        }), [Q, q]);
    return A(KT.Provider, {
        value: z,
        children: J
    })
}
var zT = () => O9(KT);
class WT {
    state = {};
    listeners = new Map;
    get(J) {
        return this.state[J]
    }
    set(J, Q) {
        this.state[J] = Q,
            this.notify(J, Q)
    }
    update(J, Q) {
        let Z = this.get(J)
            , $ = Q(Z);
        this.set(J, $)
    }
    init(J, Q) {
        if (!(J in this.state))
            this.state[J] = Q
    }
    subscribe(J, Q) {
        if (!this.listeners.has(J))
            this.listeners.set(J, new Set);
        return this.listeners.get(J).add(Q),
            () => {
                let Z = this.listeners.get(J);
                if (Z) {
                    if (Z.delete(Q),
                        Z.size === 0)
                        this.listeners.delete(J)
                }
            }
    }
    notify(J, Q) {
        let Z = this.listeners.get(J);
        if (Z)
            Z.forEach(($) => $(Q, J))
    }
}
var MI = new WT
    , Ml = n5(null);
function HT({ children: J }) {
    return A(Ml.Provider, {
        value: MI,
        children: J
    })
}
MI.init("user", null);
MI.init("theme", !0);
MI.init("isAuthenticated", !1);
global.JSON5 = XT.default;
global.pako = HE;
var /*iD = global.location.pathname.split("/").filter(Boolean)
  , qY = iD.length > 1 ? iD[iD.length - 1] : null
  , _l = new URLSearchParams(global.location.search)
  , YT = _l.get("createRoom") === "true"
  , */U1 = OE()
    , _I = {
        getItem: (J) => {
            try {
                if (typeof global !== "undefined" && global.localStorage)
                    return global.localStorage.getItem(J)
            } catch (Q) {
                try {
                    if (typeof global !== "undefined" && global.sessionStorage)
                        return global.sessionStorage.getItem(J + "_fallback")
                } catch (Z) { }
            }
            return null
        }
        ,
        setItem: (J, Q) => {
            try {
                if (typeof global !== "undefined" && global.localStorage)
                    return global.localStorage.setItem(J, Q),
                        !0
            } catch (Z) {
                try {
                    if (typeof global !== "undefined" && global.sessionStorage)
                        return global.sessionStorage.setItem(J + "_fallback", Q),
                            !0
                } catch ($) { }
            }
            return !1
        }
        ,
        removeItem: (J) => {
            try {
                if (typeof global !== "undefined" && global.localStorage)
                    return global.localStorage.removeItem(J),
                        !0
            } catch (Q) {
                try {
                    if (typeof global !== "undefined" && global.sessionStorage)
                        return global.sessionStorage.removeItem(J + "_fallback"),
                            !0
                } catch (Z) { }
            }
            return !1
        }
    };
function Rl() {
    try {
        let J = _I.getItem("luxball_room_settings");
        if (J)
            return _I.removeItem("luxball_room_settings"),
                JSON.parse(J);
        return null
    } catch (J) {
        return null
    }
}
function bl() {
    try {
        let J = _I.getItem("luxball_geo");
        return J ? JSON.parse(J) : null
    } catch (J) {
        return null
    }
}
function vl(J) {
    try {
        _I.setItem("luxball_geo", JSON.stringify(J))
    } catch (Q) { }
}
async function Sl() {
    try {
        let J = await fetch("https://luxball.online/api/geo", {
            headers: {
                "Content-Type": "application/json",
                accept: "",
                "accept-language": "tr,en;q=0.9,en-GB;q=0.8,en-US;q=0.7",
                "sec-ch-ua":
                    '" Not A;Brand";v="99", "Chromium";v="100", "Microsoft Edge";v="100"',
                "sec-ch-ua-mobile": "?0",
                "sec-ch-ua-platform": '"Windows"',
                "sec-fetch-dest": "empty",
                "sec-fetch-mode": "cors",
                "sec-fetch-site": "same-site",
                Referer: "https://luxball.online/",
                "Referrer-Policy": "strict-origin-when-cross-origin",
            },
        }).catch((e) => console.log(e));
        if (!J.ok)
            throw new Error(`HTTP ${J.status}`);
        let Q = await J.json();
        if (Q.error)
            throw new Error(Q.error);
        return Q
    } catch (J) {
        return null
    }
}
async function Tl(J) {
    try {
        let [Q, Z] = await U1.Utils.generateAuth()
            , $ = await fetch("https://luxball.online/api/createJoinToken", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    accept: "",
                    "accept-language": "tr,en;q=0.9,en-GB;q=0.8,en-US;q=0.7",
                    "sec-ch-ua":
                        '" Not A;Brand";v="99", "Chromium";v="100", "Microsoft Edge";v="100"',
                    "sec-ch-ua-mobile": "?0",
                    "sec-ch-ua-platform": '"Windows"',
                    "sec-fetch-dest": "empty",
                    "sec-fetch-mode": "cors",
                    "sec-fetch-site": "same-site",
                    Referer: "https://luxball.online/",
                    "Referrer-Policy": "strict-origin-when-cross-origin",
                },
                body: JSON.stringify({
                    roomId: J,
                    authObject: Z
                }),
                credentials: "include"
            }).catch((e) => console.log(e));
        if (!$.ok) {
            let K = await $.json();
            throw new Error(K.message || `HTTP ${$.status}`)
        }
        let q = await $.json();
        if (!q.success)
            throw new Error(q.error || "Failed to create join token");
        return Z
    } catch (Q) {
        throw Q
    }
}
async function yl() {
    let J = bl();
    if (J)
        return J;
    let Q = await Sl();
    if (Q)
        return vl(Q),
            Q;
    return null
}
function fl() {
    let [J, Q] = C8(!1)
        , [Z, $] = C8(null)
        , [q, K] = C8(yJ.ConnectingToMaster)
        , [V, z] = C8(!1)
        , [W, H] = C8(null)
        , [Y, U] = C8(!1)
        , [N, j] = C8(!1)
        , k = n0(!1)
        , { room: L } = qJ()
        , { refreshNow: F, isAuthenticated: P, user: M } = zT()
        , v = n0(P);
    i0(() => {
        if (v.current = P,
            P && Z && Z.includes("not logged in"))
            $(null),
                K(yJ.ConnectingToMaster)
    }
        , [P, Z]);
    let E = q === yJ.Active
        , n = L?.isHost || !1
        , u = (l, o) => {
            if (K(l),
                l === yJ.Active)
                z(!0)
        }
        , b = (l) => {
            if (l === void 0 || l === null)
                H({
                    message: "Room closed"
                });
            else
                H(l);
            U(!0)
        }
        ;
    i0(() => {
        if (!L)
            return;
        let l = L.gameState != null;
        j(l);
        let o = [];
        o.push(v6.on("gameStart", ({ byId: b0 }) => {
            j(!0)
        }
        ));
        let F0 = L.onGameStop;
        return L.onGameStop = () => {
            if (j(!1),
                typeof F0 === "function")
                try {
                    F0()
                } catch (b0) { }
        }
            ,
            () => {
                o.forEach((b0) => b0()),
                    L.onGameStop = F0
            }
    }
        , [L]);
    let i = () => {
        U(!1),
            H(null),
            z(!1),
            K(yJ.ConnectingToMaster),
            global.location.reload()
    }
        , g = () => {
            global.location.href = "/"
        }
        ;
    return i0(() => {
        (async () => {
            try {
                if (!k.current)
                    k.current = !0,
                        setTimeout(async () => {
                            try {
                                let o = M
                                    , F0 = parseInt(localStorage.getItem("lastTokenUpdate") || "0", 10)
                                    , b0 = Date.now();
                                if (F0 > 0 && b0 - F0 >= 300000)
                                    try {
                                        if ((await fetch("https://luxball.online/api/updateToken", {
                                            headers: {
                                                accept: "",
                                                "accept-language": "tr,en;q=0.9,en-GB;q=0.8,en-US;q=0.7",
                                                "sec-ch-ua":
                                                    '" Not A;Brand";v="99", "Chromium";v="100", "Microsoft Edge";v="100"',
                                                "sec-ch-ua-mobile": "?0",
                                                "sec-ch-ua-platform": '"Windows"',
                                                "sec-fetch-dest": "empty",
                                                "sec-fetch-mode": "cors",
                                                "sec-fetch-site": "same-site",
                                                Referer: "https://luxball.online/",
                                                "Referrer-Policy": "strict-origin-when-cross-origin",
                                            },
                                            method: "GET",
                                            credentials: "include"
                                        }).catch((e) => console.log(e))).ok)
                                            localStorage.setItem("lastTokenUpdate", String(b0))
                                    } catch (v0) { }
                                if (o)
                                    ;
                                else
                                    try {
                                        if (v.current) {
                                            let v0 = await fetch("https://luxball.online/api/userInfo", {
                                                headers: {
                                                    "Content-Type": "application/json",
                                                    accept: "",
                                                    "accept-language": "tr,en;q=0.9,en-GB;q=0.8,en-US;q=0.7",
                                                    "sec-ch-ua":
                                                        '" Not A;Brand";v="99", "Chromium";v="100", "Microsoft Edge";v="100"',
                                                    "sec-ch-ua-mobile": "?0",
                                                    "sec-ch-ua-platform": '"Windows"',
                                                    "sec-fetch-dest": "empty",
                                                    "sec-fetch-mode": "cors",
                                                    "sec-fetch-site": "same-site",
                                                    Referer: "https://luxball.online/",
                                                    "Referrer-Policy": "strict-origin-when-cross-origin",
                                                },
                                                credentials: "include"
                                            }).catch((e) => console.log(e));
                                            if (v0.ok)
                                                o = (await v0.json())?.user || null
                                        }
                                    } catch (v0) { }
                                let H8 = o?.username || "Guest"
                                    , E0 = await yl();
                                if (YT) {
                                    let v0 = Rl();
                                    await FH(null, U1, {
                                        createRoom: !0,
                                        playerName: H8,
                                        onConnInfo: u,
                                        onClose: b,
                                        geoLocation: E0 || void 0,
                                        roomSettings: v0 || {
                                            name: `${H8}'s Room`,
                                            password: "",
                                            maxPlayers: 10,
                                            showInRoomList: !0
                                        }
                                    })
                                } else if (qY) {
                                    let v0 = sessionStorage.getItem("roomPassword") || "";
                                    if (v0)
                                        sessionStorage.removeItem("roomPassword");
                                    try {
                                        if (v.current) {
                                            await F(),
                                                K(yJ.ConnectingToMaster);
                                            let G6 = await Tl(qY);
                                            await FH(qY, U1, {
                                                createRoom: !1,
                                                playerName: H8,
                                                roomPassword: v0,
                                                joinToken: G6.x,
                                                authObject: G6,
                                                geoLocation: E0 || void 0,
                                                onConnInfo: u,
                                                onClose: b
                                            })
                                        } else
                                            throw new Error("User not authenticated - proceeding as guest")
                                    } catch (G6) {
                                        try {
                                            await FH(qY, U1, {
                                                createRoom: !1,
                                                playerName: o?.username || "Guest",
                                                roomPassword: v0,
                                                geoLocation: E0 || void 0,
                                                onConnInfo: u,
                                                onClose: b
                                            })
                                        } catch (I8) {
                                            K(yJ.ConnectionFailed),
                                                $("Failed to join room. Please try again.");
                                            return
                                        }
                                    }
                                } else
                                    await FH(null, U1, {
                                        createRoom: !0,
                                        playerName: H8,
                                        onConnInfo: u,
                                        onClose: b,
                                        geoLocation: E0 || void 0,
                                        roomSettings: {
                                            name: `${H8}'s Room`,
                                            password: "",
                                            maxPlayers: 10,
                                            showInRoomList: !0
                                        }
                                    })
                            } catch (o) {
                                $(o instanceof Error ? o.message : "Failed to initialize room")
                            }
                        }
                            , 100)
            } catch (o) {
                $(o instanceof Error ? o.message : "Failed to create/join room")
            }
        }
        )()
    }
        , [qY, YT, F, M, P]),
        i0(() => {
            let l = (o) => {
                if (o.key === "Escape" && (E || n || V) && !Y) {
                    if (N)
                        Q((F0) => !F0)
                }
            }
                ;
            return global.addEventListener("keydown", l),
                () => global.removeEventListener("keydown", l)
        }
            , [E, n, V, Y, N]),
        A("div", {
            id: "game-container",
            children: [A(eS, {
                API: U1
            }), !E && !n && !V && A(QT, {
                connectionState: q,
                customErrorMessage: Z || void 0
            }), Y && A(ZT, {
                reason: W,
                onRetry: i,
                onBackToLobby: g
            }), (E || n || V) && !Y && A(GJ, {
                children: A("div", {
                    style: {
                        position: "relative",
                        zIndex: 5
                    },
                    children: [A(Rb, {
                        API: U1,
                        isVisible: J || !N,
                        onClose: () => Q(!1)
                    }), A(fb, {}), N && A(GJ, {
                        children: [A(yb, {}), A(hb, {}), A(JT, {})]
                    })]
                })
            })]
        })
}
function UT() {
    return A(VT, {
        children: A(FE, {
            children: A(vb, {
                children: A(Db, {
                    children: A(Eb, {
                        children: [A(Tb, {}), A(fl, {})]
                    })
                })
            })
        })
    })
}

export default createRoom;